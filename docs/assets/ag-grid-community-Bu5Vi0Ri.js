var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});var __defProp2=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=__name((obj,key,value)=>key in obj?__defProp2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,"__defNormalProp"),__spreadValues=__name((a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},"__spreadValues"),__spreadProps=__name((a,b)=>__defProps(a,__getOwnPropDescs(b)),"__spreadProps"),__objRest=__name((source,exclude)=>{var target={};for(var prop in source)__hasOwnProp.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(source!=null&&__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(source))exclude.indexOf(prop)<0&&__propIsEnum.call(source,prop)&&(target[prop]=source[prop]);return target},"__objRest"),__export=__name((target,all)=>{for(var name in all)__defProp2(target,name,{get:all[name],enumerable:!0})},"__export"),__decorateClass=__name((decorators,target,key,kind)=>{for(var result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1,decorator;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp2(target,key,result),result},"__decorateClass"),__decorateParam=__name((index,decorator)=>(target,key)=>decorator(target,key,index),"__decorateParam"),generic_exports={};__export(generic_exports,{attrToBoolean:()=>attrToBoolean,attrToNumber:()=>attrToNumber,attrToString:()=>attrToString,defaultComparator:()=>defaultComparator,exists:()=>exists,jsonEquals:()=>jsonEquals,makeNull:()=>makeNull,missing:()=>missing,missingOrEmpty:()=>missingOrEmpty,toStringOrNull:()=>toStringOrNull,values:()=>values});function makeNull(value){return value==null||value===""?null:value}__name(makeNull,"makeNull");function exists(value,allowEmptyString=!1){return value!=null&&(value!==""||allowEmptyString)}__name(exists,"exists");function missing(value){return!exists(value)}__name(missing,"missing");function missingOrEmpty(value){return value==null||value.length===0}__name(missingOrEmpty,"missingOrEmpty");function toStringOrNull(value){return value!=null&&typeof value.toString=="function"?value.toString():null}__name(toStringOrNull,"toStringOrNull");function attrToNumber(value){if(value===void 0)return;if(value===null||value==="")return null;if(typeof value=="number")return isNaN(value)?void 0:value;const valueParsed=parseInt(value,10);return isNaN(valueParsed)?void 0:valueParsed}__name(attrToNumber,"attrToNumber");function attrToBoolean(value){if(value!==void 0)return value===null||value===""?!1:typeof value=="boolean"?value:/true/i.test(value)}__name(attrToBoolean,"attrToBoolean");function attrToString(value){if(!(value==null||value===""))return value}__name(attrToString,"attrToString");function jsonEquals(val1,val2){const val1Json=val1?JSON.stringify(val1):null,val2Json=val2?JSON.stringify(val2):null;return val1Json===val2Json}__name(jsonEquals,"jsonEquals");function defaultComparator(valueA,valueB,accentedCompare=!1){const valueAMissing=valueA==null,valueBMissing=valueB==null;if(valueA&&valueA.toNumber&&(valueA=valueA.toNumber()),valueB&&valueB.toNumber&&(valueB=valueB.toNumber()),valueAMissing&&valueBMissing)return 0;if(valueAMissing)return-1;if(valueBMissing)return 1;function doQuickCompare(a,b){return a>b?1:a<b?-1:0}if(__name(doQuickCompare,"doQuickCompare"),typeof valueA!="string"||!accentedCompare)return doQuickCompare(valueA,valueB);try{return valueA.localeCompare(valueB)}catch{return doQuickCompare(valueA,valueB)}}__name(defaultComparator,"defaultComparator");function values(object){if(object instanceof Set||object instanceof Map){const arr=[];return object.forEach(value=>arr.push(value)),arr}return Object.values(object)}__name(values,"values");var _a,ColumnKeyCreator=(_a=class{constructor(){this.existingKeys={}}addExistingKeys(keys2){for(let i=0;i<keys2.length;i++)this.existingKeys[keys2[i]]=!0}getUniqueKey(colId,colField){colId=toStringOrNull(colId);let count=0;for(;;){let idToTry;if(colId?(idToTry=colId,count!==0&&(idToTry+="_"+count)):colField?(idToTry=colField,count!==0&&(idToTry+="_"+count)):idToTry=count,!this.existingKeys[idToTry])return this.existingKeys[idToTry]=!0,String(idToTry);count++}}},__name(_a,"ColumnKeyCreator"),_a),object_exports={};__export(object_exports,{cloneObject:()=>cloneObject,deepCloneDefinition:()=>deepCloneDefinition,getAllValuesInObject:()=>getAllValuesInObject,getValueUsingField:()=>getValueUsingField,isNonNullObject:()=>isNonNullObject,iterateObject:()=>iterateObject,mergeDeep:()=>mergeDeep,removeAllReferences:()=>removeAllReferences});function iterateObject(object,callback){if(object!=null){if(Array.isArray(object)){for(let i=0;i<object.length;i++)callback(i.toString(),object[i]);return}for(const[key,value]of Object.entries(object))callback(key,value)}}__name(iterateObject,"iterateObject");function cloneObject(object){const copy={},keys2=Object.keys(object);for(let i=0;i<keys2.length;i++){const key=keys2[i],value=object[key];copy[key]=value}return copy}__name(cloneObject,"cloneObject");function deepCloneDefinition(object,keysToSkip){if(!object)return;const obj=object,res={};return Object.keys(obj).forEach(key=>{if(keysToSkip&&keysToSkip.indexOf(key)>=0)return;const value=obj[key];isNonNullObject(value)&&value.constructor===Object?res[key]=deepCloneDefinition(value):res[key]=value}),res}__name(deepCloneDefinition,"deepCloneDefinition");function getAllValuesInObject(obj){if(!obj)return[];const anyObject=Object;if(typeof anyObject.values=="function")return anyObject.values(obj);const ret=[];for(const key in obj)obj.hasOwnProperty(key)&&obj.propertyIsEnumerable(key)&&ret.push(obj[key]);return ret}__name(getAllValuesInObject,"getAllValuesInObject");function mergeDeep(dest,source,copyUndefined=!0,makeCopyOfSimpleObjects=!1){exists(source)&&iterateObject(source,(key,sourceValue)=>{let destValue=dest[key];destValue!==sourceValue&&(makeCopyOfSimpleObjects&&destValue==null&&sourceValue!=null&&typeof sourceValue=="object"&&sourceValue.constructor===Object&&(destValue={},dest[key]=destValue),isNonNullObject(sourceValue)&&isNonNullObject(destValue)&&!Array.isArray(destValue)?mergeDeep(destValue,sourceValue,copyUndefined,makeCopyOfSimpleObjects):(copyUndefined||sourceValue!==void 0)&&(dest[key]=sourceValue))})}__name(mergeDeep,"mergeDeep");function getValueUsingField(data,field,fieldContainsDots){if(!field||!data)return;if(!fieldContainsDots)return data[field];const fields=field.split(".");let currentObject=data;for(let i=0;i<fields.length;i++){if(currentObject==null)return;currentObject=currentObject[fields[i]]}return currentObject}__name(getValueUsingField,"getValueUsingField");function removeAllReferences(obj,preserveKeys=[],preDestroyLink){Object.keys(obj).forEach(key=>{typeof obj[key]=="object"&&!preserveKeys.includes(key)&&(obj[key]=void 0)});const proto=Object.getPrototypeOf(obj),properties={},msgFunc=__name(key=>`AG Grid: Grid API function ${key}() cannot be called as the grid has been destroyed.
    It is recommended to remove local references to the grid api. Alternatively, check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
    To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${preDestroyLink}`,"msgFunc");Object.getOwnPropertyNames(proto).forEach(key=>{if(typeof proto[key]=="function"&&!preserveKeys.includes(key)){const func=__name(()=>{console.warn(msgFunc(key))},"func");properties[key]={value:func,writable:!0}}}),Object.defineProperties(obj,properties)}__name(removeAllReferences,"removeAllReferences");function isNonNullObject(value){return typeof value=="object"&&value!==null}__name(isNonNullObject,"isNonNullObject");var function_exports={};__export(function_exports,{compose:()=>compose,debounce:()=>debounce,doOnce:()=>doOnce,errorOnce:()=>errorOnce,executeAfter:()=>executeAfter,executeInAWhile:()=>executeInAWhile,executeNextVMTurn:()=>executeNextVMTurn,getFunctionName:()=>getFunctionName,isFunction:()=>isFunction,noop:()=>noop,throttle:()=>throttle,waitUntil:()=>waitUntil,warnOnce:()=>warnOnce});var doOnceFlags={};function doOnce(func,key){doOnceFlags[key]||(func(),doOnceFlags[key]=!0)}__name(doOnce,"doOnce");function warnOnce(msg){doOnce(()=>console.warn("AG Grid: "+msg),msg)}__name(warnOnce,"warnOnce");function errorOnce(msg){doOnce(()=>console.error("AG Grid: "+msg),msg)}__name(errorOnce,"errorOnce");function getFunctionName(funcConstructor){if(funcConstructor.name)return funcConstructor.name;const matches=/function\s+([^\(]+)/.exec(funcConstructor.toString());return matches&&matches.length===2?matches[1].trim():null}__name(getFunctionName,"getFunctionName");function isFunction(val){return!!(val&&val.constructor&&val.call&&val.apply)}__name(isFunction,"isFunction");function executeInAWhile(funcs){executeAfter(funcs,400)}__name(executeInAWhile,"executeInAWhile");var executeNextVMTurnFuncs=[],executeNextVMTurnPending=!1;function executeNextVMTurn(func){executeNextVMTurnFuncs.push(func),!executeNextVMTurnPending&&(executeNextVMTurnPending=!0,window.setTimeout(()=>{const funcsCopy=executeNextVMTurnFuncs.slice();executeNextVMTurnFuncs.length=0,executeNextVMTurnPending=!1,funcsCopy.forEach(func2=>func2())},0))}__name(executeNextVMTurn,"executeNextVMTurn");function executeAfter(funcs,milliseconds=0){funcs.length>0&&window.setTimeout(()=>funcs.forEach(func=>func()),milliseconds)}__name(executeAfter,"executeAfter");function debounce(func,delay){let timeout;return function(...args){const context=this;window.clearTimeout(timeout),timeout=window.setTimeout(function(){func.apply(context,args)},delay)}}__name(debounce,"debounce");function throttle(func,wait){let previousCall=0;return function(...args){const context=this,currentCall=new Date().getTime();currentCall-previousCall<wait||(previousCall=currentCall,func.apply(context,args))}}__name(throttle,"throttle");function waitUntil(condition,callback,timeout=100,timeoutMessage){const timeStamp=new Date().getTime();let interval=null,executed=!1;const internalCallback=__name(()=>{const reachedTimeout=new Date().getTime()-timeStamp>timeout;(condition()||reachedTimeout)&&(callback(),executed=!0,interval!=null&&(window.clearInterval(interval),interval=null),reachedTimeout&&timeoutMessage&&console.warn(timeoutMessage))},"internalCallback");internalCallback(),executed||(interval=window.setInterval(internalCallback,10))}__name(waitUntil,"waitUntil");function compose(...fns){return arg=>fns.reduce((composed,f)=>f(composed),arg)}__name(compose,"compose");var noop=__name(()=>{},"noop"),ModuleNames=(ModuleNames2=>(ModuleNames2.CommunityCoreModule="@ag-grid-community/core",ModuleNames2.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",ModuleNames2.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",ModuleNames2.CsvExportModule="@ag-grid-community/csv-export",ModuleNames2.EnterpriseCoreModule="@ag-grid-enterprise/core",ModuleNames2.RowGroupingModule="@ag-grid-enterprise/row-grouping",ModuleNames2.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",ModuleNames2.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",ModuleNames2.MenuModule="@ag-grid-enterprise/menu",ModuleNames2.SetFilterModule="@ag-grid-enterprise/set-filter",ModuleNames2.MultiFilterModule="@ag-grid-enterprise/multi-filter",ModuleNames2.StatusBarModule="@ag-grid-enterprise/status-bar",ModuleNames2.SideBarModule="@ag-grid-enterprise/side-bar",ModuleNames2.RangeSelectionModule="@ag-grid-enterprise/range-selection",ModuleNames2.MasterDetailModule="@ag-grid-enterprise/master-detail",ModuleNames2.RichSelectModule="@ag-grid-enterprise/rich-select",ModuleNames2.GridChartsModule="@ag-grid-enterprise/charts",ModuleNames2.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",ModuleNames2.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",ModuleNames2.ExcelExportModule="@ag-grid-enterprise/excel-export",ModuleNames2.ClipboardModule="@ag-grid-enterprise/clipboard",ModuleNames2.SparklinesModule="@ag-grid-enterprise/sparklines",ModuleNames2.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",ModuleNames2.AngularModule="@ag-grid-community/angular",ModuleNames2.ReactModule="@ag-grid-community/react",ModuleNames2.VueModule="@ag-grid-community/vue",ModuleNames2))(ModuleNames||{}),_a2,_ModuleRegistry=(_a2=class{static register(module){_a2.__register(module,!0,void 0)}static registerModules(modules){_a2.__registerModules(modules,!0,void 0)}static __register(module,moduleBased,gridId){_a2.runVersionChecks(module),gridId!==void 0?(_a2.areGridScopedModules=!0,_a2.gridModulesMap[gridId]===void 0&&(_a2.gridModulesMap[gridId]={}),_a2.gridModulesMap[gridId][module.moduleName]=module):_a2.globalModulesMap[module.moduleName]=module,_a2.setModuleBased(moduleBased)}static __unRegisterGridModules(gridId){delete _a2.gridModulesMap[gridId]}static __registerModules(modules,moduleBased,gridId){_a2.setModuleBased(moduleBased),modules&&modules.forEach(module=>_a2.__register(module,moduleBased,gridId))}static isValidModuleVersion(module){const[moduleMajor,moduleMinor]=module.version.split(".")||[],[currentModuleMajor,currentModuleMinor]=_a2.currentModuleVersion.split(".")||[];return moduleMajor===currentModuleMajor&&moduleMinor===currentModuleMinor}static runVersionChecks(module){if(_a2.currentModuleVersion||(_a2.currentModuleVersion=module.version),module.version?_a2.isValidModuleVersion(module)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${module.moduleName}' is version ${module.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${module.moduleName}' is incompatible. Please update all modules to the same version.`),module.validate){const result=module.validate();result.isValid||console.error(`AG Grid: ${result.message}`)}}static setModuleBased(moduleBased){_a2.moduleBased===void 0?_a2.moduleBased=moduleBased:_a2.moduleBased!==moduleBased&&doOnce(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){_a2.isBundled=!0}static __assertRegistered(moduleName,reason,gridId){var _a273;if(this.__isRegistered(moduleName,gridId))return!0;const warningKey=reason+moduleName;let warningMessage;if(_a2.isBundled)warningMessage=`AG Grid: unable to use ${reason} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:
        
        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>
        
For more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(_a2.moduleBased||_a2.moduleBased===void 0){let modName=(_a273=Object.entries(ModuleNames).find(([k,v])=>v===moduleName))==null?void 0:_a273[0];warningMessage=`AG Grid: unable to use ${reason} as the ${modName} is not registered${_a2.areGridScopedModules?` for gridId: ${gridId}`:""}. Check if you have registered the module:
           
    import { ModuleRegistry } from '@ag-grid-community/core';
    import { ${modName} } from '${moduleName}';
    
    ModuleRegistry.registerModules([ ${modName} ]);

For more info see: https://www.ag-grid.com/javascript-grid/modules/`}else warningMessage=`AG Grid: unable to use ${reason} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:
            
    import 'ag-grid-enterprise';
            
For more info see: https://www.ag-grid.com/javascript-grid/packages/`;return doOnce(()=>{console.warn(warningMessage)},warningKey),!1}static __warnEnterpriseChartDisabled(chartType){const warningKey="ag-charts-enterprise"+":"+chartType,warningMessage=`AG Grid: the '${chartType}' chart type is not supported in AG Charts Community as 'ag-grid-charts-enterprise' or '@ag-grid-enterprise/charts-enterprise' hasn't been loaded. See https://www.ag-grid.com/javascript-data-grid/integrated-charts-installation/ for more details.`;doOnce(()=>{console.warn(warningMessage)},warningKey)}static __isRegistered(moduleName,gridId){var _a273;return!!_a2.globalModulesMap[moduleName]||!!((_a273=_a2.gridModulesMap[gridId])!=null&&_a273[moduleName])}static __getRegisteredModules(gridId){return[...values(_a2.globalModulesMap),...values(_a2.gridModulesMap[gridId]||{})]}static __getGridRegisteredModules(gridId){var _a273;return values((_a273=_a2.gridModulesMap[gridId])!=null?_a273:{})||[]}static __isPackageBased(){return!_a2.moduleBased}},__name(_a2,"_ModuleRegistry"),_a2);_ModuleRegistry.globalModulesMap={};_ModuleRegistry.gridModulesMap={};_ModuleRegistry.areGridScopedModules=!1;var ModuleRegistry=_ModuleRegistry,_a3,Context=(_a3=class{constructor(params,logger){if(this.beanWrappers={},this.destroyed=!1,!params||!params.beanClasses)return;this.contextParams=params,this.logger=logger,this.logger.log(">> creating ag-Application Context"),this.createBeans();const beanInstances=this.getBeanInstances();this.wireBeans(beanInstances),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return values(this.beanWrappers).map(beanEntry=>beanEntry.beanInstance)}createBean(bean,afterPreCreateCallback){if(!bean)throw Error("Can't wire to bean since it is null");return this.wireBeans([bean],afterPreCreateCallback),bean}wireBeans(beanInstances,afterPreCreateCallback){this.autoWireBeans(beanInstances),this.methodWireBeans(beanInstances),this.callLifeCycleMethods(beanInstances,"preConstructMethods"),exists(afterPreCreateCallback)&&beanInstances.forEach(afterPreCreateCallback),this.callLifeCycleMethods(beanInstances,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),iterateObject(this.beanWrappers,(key,beanEntry)=>{let constructorParamsMeta;beanEntry.bean.__agBeanMetaData&&beanEntry.bean.__agBeanMetaData.autowireMethods&&beanEntry.bean.__agBeanMetaData.autowireMethods.agConstructor&&(constructorParamsMeta=beanEntry.bean.__agBeanMetaData.autowireMethods.agConstructor);const constructorParams=this.getBeansForParameters(constructorParamsMeta,beanEntry.bean.name),newInstance=new(beanEntry.bean.bind.apply(beanEntry.bean,[null,...constructorParams]));beanEntry.beanInstance=newInstance});const createdBeanNames=Object.keys(this.beanWrappers).join(", ");this.logger.log(`created beans: ${createdBeanNames}`)}createBeanWrapper(BeanClass){const metaData=BeanClass.__agBeanMetaData;if(!metaData){let beanName;BeanClass.prototype.constructor?beanName=getFunctionName(BeanClass.prototype.constructor):beanName=""+BeanClass,console.error(`Context item ${beanName} is not a bean`);return}const beanEntry={bean:BeanClass,beanInstance:null,beanName:metaData.beanName};this.beanWrappers[metaData.beanName]=beanEntry}autoWireBeans(beanInstances){beanInstances.forEach(beanInstance=>{this.forEachMetaDataInHierarchy(beanInstance,(metaData,beanName)=>{const attributes=metaData.agClassAttributes;attributes&&attributes.forEach(attribute=>{const otherBean=this.lookupBeanInstance(beanName,attribute.beanName,attribute.optional);beanInstance[attribute.attributeName]=otherBean})})})}methodWireBeans(beanInstances){beanInstances.forEach(beanInstance=>{this.forEachMetaDataInHierarchy(beanInstance,(metaData,beanName)=>{iterateObject(metaData.autowireMethods,(methodName,wireParams)=>{if(methodName==="agConstructor")return;const initParams=this.getBeansForParameters(wireParams,beanName);beanInstance[methodName].apply(beanInstance,initParams)})})})}forEachMetaDataInHierarchy(beanInstance,callback){let prototype=Object.getPrototypeOf(beanInstance);for(;prototype!=null;){const constructor=prototype.constructor;if(constructor.hasOwnProperty("__agBeanMetaData")){const metaData=constructor.__agBeanMetaData,beanName=this.getBeanName(constructor);callback(metaData,beanName)}prototype=Object.getPrototypeOf(prototype)}}getBeanName(constructor){if(constructor.__agBeanMetaData&&constructor.__agBeanMetaData.beanName)return constructor.__agBeanMetaData.beanName;const constructorString=constructor.toString();return constructorString.substring(9,constructorString.indexOf("("))}getBeansForParameters(parameters,beanName){const beansList=[];return parameters&&iterateObject(parameters,(paramIndex,otherBeanName)=>{const otherBean=this.lookupBeanInstance(beanName,otherBeanName);beansList[Number(paramIndex)]=otherBean}),beansList}lookupBeanInstance(wiringBean,beanName,optional=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${beanName} is used after the grid is destroyed!`),null;if(beanName==="context")return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(beanName))return this.contextParams.providedBeanInstances[beanName];const beanEntry=this.beanWrappers[beanName];return beanEntry?beanEntry.beanInstance:(optional||console.error(`AG Grid: unable to find bean reference ${beanName} while initialising ${wiringBean}`),null)}callLifeCycleMethods(beanInstances,lifeCycleMethod){beanInstances.forEach(beanInstance=>this.callLifeCycleMethodsOnBean(beanInstance,lifeCycleMethod))}callLifeCycleMethodsOnBean(beanInstance,lifeCycleMethod,methodToIgnore){const allMethods={};this.forEachMetaDataInHierarchy(beanInstance,metaData=>{const methods=metaData[lifeCycleMethod];methods&&methods.forEach(methodName=>{methodName!=methodToIgnore&&(allMethods[methodName]=!0)})}),Object.keys(allMethods).forEach(methodName=>beanInstance[methodName]())}getBean(name){return this.lookupBeanInstance("getBean",name,!0)}destroy(){if(this.destroyed)return;this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");const beanInstances=this.getBeanInstances();this.destroyBeans(beanInstances),this.contextParams.providedBeanInstances=null,ModuleRegistry.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(bean){bean&&this.destroyBeans([bean])}destroyBeans(beans){return beans?(beans.forEach(bean=>{this.callLifeCycleMethodsOnBean(bean,"preDestroyMethods","destroy");const beanAny=bean;typeof beanAny.destroy=="function"&&beanAny.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}},__name(_a3,"Context"),_a3);function PreConstruct(target,methodName,descriptor){const props=getOrCreateProps(target.constructor);props.preConstructMethods||(props.preConstructMethods=[]),props.preConstructMethods.push(methodName)}__name(PreConstruct,"PreConstruct");function PostConstruct(target,methodName,descriptor){const props=getOrCreateProps(target.constructor);props.postConstructMethods||(props.postConstructMethods=[]),props.postConstructMethods.push(methodName)}__name(PostConstruct,"PostConstruct");function PreDestroy(target,methodName,descriptor){const props=getOrCreateProps(target.constructor);props.preDestroyMethods||(props.preDestroyMethods=[]),props.preDestroyMethods.push(methodName)}__name(PreDestroy,"PreDestroy");function Bean(beanName){return classConstructor=>{const props=getOrCreateProps(classConstructor);props.beanName=beanName}}__name(Bean,"Bean");function Autowired(name){return(target,propertyKey,descriptor)=>{autowiredFunc(target,name,!1,target,propertyKey,null)}}__name(Autowired,"Autowired");function Optional(name){return(target,propertyKey,descriptor)=>{autowiredFunc(target,name,!0,target,propertyKey,null)}}__name(Optional,"Optional");function autowiredFunc(target,name,optional,classPrototype,methodOrAttributeName,index){if(name===null){console.error("AG Grid: Autowired name should not be null");return}if(typeof index=="number"){console.error("AG Grid: Autowired should be on an attribute");return}const props=getOrCreateProps(target.constructor);props.agClassAttributes||(props.agClassAttributes=[]),props.agClassAttributes.push({attributeName:methodOrAttributeName,beanName:name,optional})}__name(autowiredFunc,"autowiredFunc");function Qualifier(name){return(classPrototype,methodOrAttributeName,index)=>{const constructor=typeof classPrototype=="function"?classPrototype:classPrototype.constructor;let props;if(typeof index=="number"){let methodName;methodOrAttributeName?(props=getOrCreateProps(constructor),methodName=methodOrAttributeName):(props=getOrCreateProps(constructor),methodName="agConstructor"),props.autowireMethods||(props.autowireMethods={}),props.autowireMethods[methodName]||(props.autowireMethods[methodName]={}),props.autowireMethods[methodName][index]=name}}}__name(Qualifier,"Qualifier");function getOrCreateProps(target){return target.hasOwnProperty("__agBeanMetaData")||(target.__agBeanMetaData={}),target.__agBeanMetaData}__name(getOrCreateProps,"getOrCreateProps");var _a4,EventService=(_a4=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(gridOptionsService,frameworkOverrides,globalEventListener=null,globalSyncEventListener=null){if(this.frameworkOverrides=frameworkOverrides,this.gridOptionsService=gridOptionsService,globalEventListener){const async=gridOptionsService.useAsyncEvents();this.addGlobalListener(globalEventListener,async)}globalSyncEventListener&&this.addGlobalListener(globalSyncEventListener,!1)}setFrameworkOverrides(frameworkOverrides){this.frameworkOverrides=frameworkOverrides}getListeners(eventType,async,autoCreateListenerCollection){const listenerMap=async?this.allAsyncListeners:this.allSyncListeners;let listeners=listenerMap.get(eventType);return!listeners&&autoCreateListenerCollection&&(listeners=new Set,listenerMap.set(eventType,listeners)),listeners}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(eventType,listener,async=!1){this.getListeners(eventType,async,!0).add(listener)}removeEventListener(eventType,listener,async=!1){const listeners=this.getListeners(eventType,async,!1);listeners&&(listeners.delete(listener),listeners.size===0&&(async?this.allAsyncListeners:this.allSyncListeners).delete(eventType))}addGlobalListener(listener,async=!1){(async?this.globalAsyncListeners:this.globalSyncListeners).add(listener)}removeGlobalListener(listener,async=!1){(async?this.globalAsyncListeners:this.globalSyncListeners).delete(listener)}dispatchEvent(event){let agEvent=event;this.gridOptionsService&&this.gridOptionsService.addGridCommonParams(agEvent),this.dispatchToListeners(agEvent,!0),this.dispatchToListeners(agEvent,!1),this.firedEvents[agEvent.type]=!0}dispatchEventOnce(event){this.firedEvents[event.type]||this.dispatchEvent(event)}dispatchToListeners(event,async){var _a273;const eventType=event.type;if(async&&"event"in event){const browserEvent=event.event;browserEvent instanceof Event&&(event.eventPath=browserEvent.composedPath())}const processEventListeners=__name((listeners2,originalListeners2)=>listeners2.forEach(listener=>{if(!originalListeners2.has(listener))return;const callback=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>listener(event)):()=>listener(event);async?this.dispatchAsync(callback):callback()}),"processEventListeners"),originalListeners=(_a273=this.getListeners(eventType,async,!1))!=null?_a273:new Set,listeners=new Set(originalListeners);listeners.size>0&&processEventListeners(listeners,originalListeners),new Set(async?this.globalAsyncListeners:this.globalSyncListeners).forEach(listener=>{const callback=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>listener(eventType,event)):()=>listener(eventType,event);async?this.dispatchAsync(callback):callback()})}dispatchAsync(func){this.asyncFunctionsQueue.push(func),this.scheduled||(this.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)}),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const queueCopy=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],queueCopy.forEach(func=>func())}},__name(_a4,"EventService"),_a4);__decorateClass([__decorateParam(0,Qualifier("gridOptionsService")),__decorateParam(1,Qualifier("frameworkOverrides")),__decorateParam(2,Qualifier("globalEventListener")),__decorateParam(3,Qualifier("globalSyncEventListener"))],EventService.prototype,"setBeans",1);EventService=__decorateClass([Bean("eventService")],EventService);var _a5,FrameworkEventListenerService=(_a5=class{constructor(frameworkOverrides){this.frameworkOverrides=frameworkOverrides,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(userListener){let listener=userListener;return this.frameworkOverrides.shouldWrapOutgoing&&(listener=__name(event=>{this.frameworkOverrides.wrapOutgoing(()=>userListener(event))},"listener"),this.wrappedListeners.set(userListener,listener)),listener}wrapGlobal(userListener){let listener=userListener;return this.frameworkOverrides.shouldWrapOutgoing&&(listener=__name((eventType,event)=>{this.frameworkOverrides.wrapOutgoing(()=>userListener(eventType,event))},"listener"),this.wrappedGlobalListeners.set(userListener,listener)),listener}unwrap(userListener){var _a273;return(_a273=this.wrappedListeners.get(userListener))!=null?_a273:userListener}unwrapGlobal(userListener){var _a273;return(_a273=this.wrappedGlobalListeners.get(userListener))!=null?_a273:userListener}},__name(_a5,"FrameworkEventListenerService"),_a5),COL_DEF_DEFAULTS={resizable:!0,sortable:!0},instanceIdSequence=0;function getNextColInstanceId(){return instanceIdSequence++}__name(getNextColInstanceId,"getNextColInstanceId");var _a6,_Column=(_a6=class{constructor(colDef,userProvidedColDef,colId,primary){this.instanceId=getNextColInstanceId(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new EventService,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=colDef,this.userProvidedColDef=userProvidedColDef,this.colId=colId,this.primary=primary,this.setState(colDef)}getInstanceId(){return this.instanceId}setState(colDef){colDef.sort!==void 0?(colDef.sort==="asc"||colDef.sort==="desc")&&(this.sort=colDef.sort):(colDef.initialSort==="asc"||colDef.initialSort==="desc")&&(this.sort=colDef.initialSort);const sortIndex=colDef.sortIndex,initialSortIndex=colDef.initialSortIndex;sortIndex!==void 0?sortIndex!==null&&(this.sortIndex=sortIndex):initialSortIndex!==null&&(this.sortIndex=initialSortIndex);const hide=colDef.hide,initialHide=colDef.initialHide;hide!==void 0?this.visible=!hide:this.visible=!initialHide,colDef.pinned!==void 0?this.setPinned(colDef.pinned):this.setPinned(colDef.initialPinned);const flex=colDef.flex,initialFlex=colDef.initialFlex;flex!==void 0?this.flex=flex:initialFlex!==void 0&&(this.flex=initialFlex)}setColDef(colDef,userProvidedColDef,source){this.colDef=colDef,this.userProvidedColDef=userProvidedColDef,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged",source))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(parent){this.parent=parent}getParent(){return this.parent}setOriginalParent(originalParent){this.originalParent=originalParent}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const suppressDotNotation=this.gridOptionsService.get("suppressFieldDotNotation");this.fieldContainsDots=exists(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!suppressDotNotation,this.tooltipFieldContainsDots=exists(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!suppressDotNotation}initMinAndMaxWidths(){const colDef=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(colDef),this.maxWidth=this.columnUtils.calculateColMaxWidth(colDef)}initTooltip(){this.tooltipEnabled=exists(this.colDef.tooltipField)||exists(this.colDef.tooltipValueGetter)||exists(this.colDef.tooltipComponent)}resetActualWidth(source){const initialWidth=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(initialWidth,source,!0)}isEmptyGroup(){return!1}isRowGroupDisplayed(colId){if(missing(this.colDef)||missing(this.colDef.showRowGroup))return!1;const showingAllGroups=this.colDef.showRowGroup===!0,showingThisGroup=this.colDef.showRowGroup===colId;return showingAllGroups||showingThisGroup}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}addEventListener(eventType,userListener){var _a273,_b;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new FrameworkEventListenerService(this.frameworkOverrides));const listener=(_b=(_a273=this.frameworkEventListenerService)==null?void 0:_a273.wrap(userListener))!=null?_b:userListener;this.eventService.addEventListener(eventType,listener)}removeEventListener(eventType,userListener){var _a273,_b;const listener=(_b=(_a273=this.frameworkEventListenerService)==null?void 0:_a273.unwrap(userListener))!=null?_b:userListener;this.eventService.removeEventListener(eventType,listener)}createColumnFunctionCallbackParams(rowNode){return this.gridOptionsService.addGridCommonParams({node:rowNode,data:rowNode.data,column:this,colDef:this.colDef})}isSuppressNavigable(rowNode){if(typeof this.colDef.suppressNavigable=="boolean")return this.colDef.suppressNavigable;if(typeof this.colDef.suppressNavigable=="function"){const params=this.createColumnFunctionCallbackParams(rowNode),userFunc=this.colDef.suppressNavigable;return userFunc(params)}return!1}isCellEditable(rowNode){return rowNode.group&&!this.gridOptionsService.get("enableGroupEdit")?!1:this.isColumnFunc(rowNode,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(rowNode){return this.isColumnFunc(rowNode,this.colDef.rowDrag)}isDndSource(rowNode){return this.isColumnFunc(rowNode,this.colDef.dndSource)}isCellCheckboxSelection(rowNode){return this.isColumnFunc(rowNode,this.colDef.checkboxSelection)}isSuppressPaste(rowNode){return this.isColumnFunc(rowNode,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(key){var _a273;return(_a273=this.colDef[key])!=null?_a273:COL_DEF_DEFAULTS[key]}isColumnFunc(rowNode,value){if(typeof value=="boolean")return value;if(typeof value=="function"){const params=this.createColumnFunctionCallbackParams(rowNode);return value(params)}return!1}setMoving(moving,source){this.moving=moving,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",source))}createColumnEvent(type,source){return this.gridOptionsService.addGridCommonParams({type,column:this,columns:[this],source})}isMoving(){return this.moving}getSort(){return this.sort}setSort(sort,source){this.sort!==sort&&(this.sort=sort,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",source))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(visible,source){this.menuVisible!==visible&&(this.menuVisible=visible,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",source)))}isMenuVisible(){return this.menuVisible}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return missing(this.sort)}isSorting(){return exists(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(sortOrder){this.sortIndex=sortOrder,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(aggFunc){this.aggFunc=aggFunc,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(left,source){this.oldLeft=this.left,this.left!==left&&(this.left=left,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",source)))}isFilterActive(){return this.filterActive}setFilterActive(active,source,additionalEventAttributes){this.filterActive!==active&&(this.filterActive=active,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",source)));const filterChangedEvent=this.createColumnEvent("filterChanged",source);additionalEventAttributes&&mergeDeep(filterChangedEvent,additionalEventAttributes),this.eventService.dispatchEvent(filterChangedEvent)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(pinned){pinned===!0||pinned==="left"?this.pinned="left":pinned==="right"?this.pinned="right":this.pinned=null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(firstRightPinned,source){this.firstRightPinned!==firstRightPinned&&(this.firstRightPinned=firstRightPinned,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",source)))}setLastLeftPinned(lastLeftPinned,source){this.lastLeftPinned!==lastLeftPinned&&(this.lastLeftPinned=lastLeftPinned,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",source)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(visible,source){const newValue=visible===!0;this.visible!==newValue&&(this.visible=newValue,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",source))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const colDef=this.getColDef();return!colDef.suppressSpanHeaderHeight&&!colDef.autoHeaderHeight}getColumnGroupPaddingInfo(){let parent=this.getParent();if(!parent||!parent.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const numberOfParents=parent.getPaddingLevel()+1;let isSpanningTotal=!0;for(;parent;){if(!parent.isPadding()){isSpanningTotal=!1;break}parent=parent.getParent()}return{numberOfParents,isSpanningTotal}}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(height){const changed=height!==this.autoHeaderHeight;return this.autoHeaderHeight=height,changed}createBaseColDefParams(rowNode){return this.gridOptionsService.addGridCommonParams({node:rowNode,data:rowNode.data,colDef:this.colDef,column:this})}getColSpan(rowNode){if(missing(this.colDef.colSpan))return 1;const params=this.createBaseColDefParams(rowNode),colSpan=this.colDef.colSpan(params);return Math.max(colSpan,1)}getRowSpan(rowNode){if(missing(this.colDef.rowSpan))return 1;const params=this.createBaseColDefParams(rowNode),rowSpan=this.colDef.rowSpan(params);return Math.max(rowSpan,1)}setActualWidth(actualWidth,source,silent=!1){this.minWidth!=null&&(actualWidth=Math.max(actualWidth,this.minWidth)),this.maxWidth!=null&&(actualWidth=Math.min(actualWidth,this.maxWidth)),this.actualWidth!==actualWidth&&(this.actualWidth=actualWidth,this.flex&&source!=="flex"&&source!=="gridInitializing"&&(this.flex=null),silent||this.fireColumnWidthChangedEvent(source)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(source){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",source))}isGreaterThanMax(width){return this.maxWidth!=null?width>this.maxWidth:!1}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(flex){this.flex!==flex&&(this.flex=flex),this.dispatchStateUpdatedEvent("flex")}setMinimum(source){exists(this.minWidth)&&this.setActualWidth(this.minWidth,source)}setRowGroupActive(rowGroup,source){this.rowGroupActive!==rowGroup&&(this.rowGroupActive=rowGroup,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",source))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(pivot,source){this.pivotActive!==pivot&&(this.pivotActive=pivot,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",source))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(value,source){this.aggregationActive!==value&&(this.aggregationActive=value,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",source)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}getMenuTabs(defaultValues){warnOnce("As of v31.1, 'getMenuTabs' is deprecated. Use 'getColDef().menuTabs ?? defaultValues' instead.");let menuTabs=this.getColDef().menuTabs;return menuTabs==null&&(menuTabs=defaultValues),menuTabs}dispatchStateUpdatedEvent(key){this.eventService.dispatchEvent({type:_a6.EVENT_STATE_UPDATED,key})}},__name(_a6,"_Column"),_a6);_Column.EVENT_MOVING_CHANGED="movingChanged";_Column.EVENT_LEFT_CHANGED="leftChanged";_Column.EVENT_WIDTH_CHANGED="widthChanged";_Column.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged";_Column.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged";_Column.EVENT_VISIBLE_CHANGED="visibleChanged";_Column.EVENT_FILTER_CHANGED="filterChanged";_Column.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged";_Column.EVENT_SORT_CHANGED="sortChanged";_Column.EVENT_COL_DEF_CHANGED="colDefChanged";_Column.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged";_Column.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged";_Column.EVENT_PIVOT_CHANGED="columnPivotChanged";_Column.EVENT_VALUE_CHANGED="columnValueChanged";_Column.EVENT_STATE_UPDATED="columnStateUpdated";__decorateClass([Autowired("gridOptionsService")],_Column.prototype,"gridOptionsService",2);__decorateClass([Autowired("columnUtils")],_Column.prototype,"columnUtils",2);__decorateClass([Autowired("columnHoverService")],_Column.prototype,"columnHoverService",2);__decorateClass([Autowired("frameworkOverrides")],_Column.prototype,"frameworkOverrides",2);__decorateClass([PostConstruct],_Column.prototype,"initialise",1);var Column=_Column,_a7,_ProvidedColumnGroup=(_a7=class{constructor(colGroupDef,groupId,padding,level){this.localEventService=new EventService,this.expandable=!1,this.instanceId=getNextColInstanceId(),this.expandableListenerRemoveCallback=null,this.colGroupDef=colGroupDef,this.groupId=groupId,this.expanded=!!colGroupDef&&!!colGroupDef.openByDefault,this.padding=padding,this.level=level}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(colGroupDef,level){this.colGroupDef=colGroupDef,this.level=level,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(originalParent){this.originalParent=originalParent}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(child=>child.isVisible()):!1}isPadding(){return this.padding}setExpanded(expanded){this.expanded=expanded===void 0?!1:expanded;const event={type:_a7.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(event)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(children){this.children=children}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const result=[];return this.addLeafColumns(result),result}addLeafColumns(leafColumns){this.children&&this.children.forEach(child=>{child instanceof Column?leafColumns.push(child):child instanceof _a7&&child.addLeafColumns(leafColumns)})}getColumnGroupShow(){const colGroupDef=this.colGroupDef;if(colGroupDef)return colGroupDef.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const listener=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(col=>col.addEventListener("visibleChanged",listener)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(col=>col.removeEventListener("visibleChanged",listener)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let atLeastOneShowingWhenOpen=!1,atLeastOneShowingWhenClosed=!1,atLeastOneChangeable=!1;const children=this.findChildrenRemovingPadding();for(let i=0,j=children.length;i<j;i++){const abstractColumn=children[i];if(!abstractColumn.isVisible())continue;const headerGroupShow=abstractColumn.getColumnGroupShow();headerGroupShow==="open"?(atLeastOneShowingWhenOpen=!0,atLeastOneChangeable=!0):headerGroupShow==="closed"?(atLeastOneShowingWhenClosed=!0,atLeastOneChangeable=!0):(atLeastOneShowingWhenOpen=!0,atLeastOneShowingWhenClosed=!0)}const expandable=atLeastOneShowingWhenOpen&&atLeastOneShowingWhenClosed&&atLeastOneChangeable;if(this.expandable!==expandable){this.expandable=expandable;const event={type:_a7.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(event)}}findChildrenRemovingPadding(){const res=[],process=__name(items=>{items.forEach(item=>{item instanceof _a7&&item.isPadding()?process(item.children):res.push(item)})},"process");return process(this.children),res}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(eventType,listener){this.localEventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.localEventService.removeEventListener(eventType,listener)}},__name(_a7,"_ProvidedColumnGroup"),_a7);_ProvidedColumnGroup.EVENT_EXPANDED_CHANGED="expandedChanged";_ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED="expandableChanged";__decorateClass([PreDestroy],_ProvidedColumnGroup.prototype,"destroy",1);var ProvidedColumnGroup=_ProvidedColumnGroup,DefaultColumnTypes={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},event_exports={};__export(event_exports,{addSafePassiveEventListener:()=>addSafePassiveEventListener,createEventPath:()=>createEventPath,getCtrlForEventTarget:()=>getCtrlForEventTarget,getEventPath:()=>getEventPath,isElementInEventPath:()=>isElementInEventPath,isEventSupported:()=>isEventSupported,isStopPropagationForAgGrid:()=>isStopPropagationForAgGrid,stopPropagationForAgGrid:()=>stopPropagationForAgGrid});var array_exports={};__export(array_exports,{areEqual:()=>areEqual,existsAndNotEmpty:()=>existsAndNotEmpty,flatten:()=>flatten,forEachReverse:()=>forEachReverse,includes:()=>includes,insertArrayIntoArray:()=>insertArrayIntoArray,insertIntoArray:()=>insertIntoArray,last:()=>last,moveInArray:()=>moveInArray,pushAll:()=>pushAll,removeAllFromArray:()=>removeAllFromArray,removeAllFromUnorderedArray:()=>removeAllFromUnorderedArray,removeFromArray:()=>removeFromArray,removeFromUnorderedArray:()=>removeFromUnorderedArray,removeRepeatsFromArray:()=>removeRepeatsFromArray,shallowCompare:()=>shallowCompare,sortNumerically:()=>sortNumerically,toStrings:()=>toStrings});function existsAndNotEmpty(value){return value!=null&&value.length>0}__name(existsAndNotEmpty,"existsAndNotEmpty");function last(arr){if(!(!arr||!arr.length))return arr[arr.length-1]}__name(last,"last");function areEqual(a,b,comparator){return a==null&&b==null?!0:a!=null&&b!=null&&a.length===b.length&&a.every((value,index)=>comparator?comparator(value,b[index]):b[index]===value)}__name(areEqual,"areEqual");function shallowCompare(arr1,arr2){return areEqual(arr1,arr2)}__name(shallowCompare,"shallowCompare");function sortNumerically(array){return array.sort((a,b)=>a-b)}__name(sortNumerically,"sortNumerically");function removeRepeatsFromArray(array,object){if(array)for(let index=array.length-2;index>=0;index--){const thisOneMatches=array[index]===object,nextOneMatches=array[index+1]===object;thisOneMatches&&nextOneMatches&&array.splice(index+1,1)}}__name(removeRepeatsFromArray,"removeRepeatsFromArray");function removeFromUnorderedArray(array,object){const index=array.indexOf(object);index>=0&&(array[index]=array[array.length-1],array.pop())}__name(removeFromUnorderedArray,"removeFromUnorderedArray");function removeFromArray(array,object){const index=array.indexOf(object);index>=0&&array.splice(index,1)}__name(removeFromArray,"removeFromArray");function removeAllFromUnorderedArray(array,toRemove){for(let i=0;i<toRemove.length;i++)removeFromUnorderedArray(array,toRemove[i])}__name(removeAllFromUnorderedArray,"removeAllFromUnorderedArray");function removeAllFromArray(array,toRemove){for(let i=0;i<toRemove.length;i++)removeFromArray(array,toRemove[i])}__name(removeAllFromArray,"removeAllFromArray");function insertIntoArray(array,object,toIndex){array.splice(toIndex,0,object)}__name(insertIntoArray,"insertIntoArray");function insertArrayIntoArray(dest,src,toIndex){if(!(dest==null||src==null))for(let i=src.length-1;i>=0;i--){const item=src[i];insertIntoArray(dest,item,toIndex)}}__name(insertArrayIntoArray,"insertArrayIntoArray");function moveInArray(array,objectsToMove,toIndex){removeAllFromArray(array,objectsToMove),objectsToMove.slice().reverse().forEach(obj=>insertIntoArray(array,obj,toIndex))}__name(moveInArray,"moveInArray");function includes(array,value){return array.indexOf(value)>-1}__name(includes,"includes");function flatten(arrayOfArrays){return[].concat.apply([],arrayOfArrays)}__name(flatten,"flatten");function pushAll(target,source){source==null||target==null||source.forEach(value=>target.push(value))}__name(pushAll,"pushAll");function toStrings(array){return array.map(toStringOrNull)}__name(toStrings,"toStrings");function forEachReverse(list,action){if(list!=null)for(let i=list.length-1;i>=0;i--)action(list[i],i)}__name(forEachReverse,"forEachReverse");var AG_GRID_STOP_PROPAGATION="__ag_Grid_Stop_Propagation",PASSIVE_EVENTS=["touchstart","touchend","touchmove","touchcancel","scroll"],supports={};function stopPropagationForAgGrid(event){event[AG_GRID_STOP_PROPAGATION]=!0}__name(stopPropagationForAgGrid,"stopPropagationForAgGrid");function isStopPropagationForAgGrid(event){return event[AG_GRID_STOP_PROPAGATION]===!0}__name(isStopPropagationForAgGrid,"isStopPropagationForAgGrid");var isEventSupported=(()=>{const tags={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return __name(eventName=>{if(typeof supports[eventName]=="boolean")return supports[eventName];const el=document.createElement(tags[eventName]||"div");return eventName="on"+eventName,supports[eventName]=eventName in el},"eventChecker")})();function getCtrlForEventTarget(gridOptionsService,eventTarget,type){let sourceElement=eventTarget;for(;sourceElement;){const renderedComp=gridOptionsService.getDomData(sourceElement,type);if(renderedComp)return renderedComp;sourceElement=sourceElement.parentElement}return null}__name(getCtrlForEventTarget,"getCtrlForEventTarget");function isElementInEventPath(element,event){return!event||!element?!1:getEventPath(event).indexOf(element)>=0}__name(isElementInEventPath,"isElementInEventPath");function createEventPath(event){const res=[];let pointer=event.target;for(;pointer;)res.push(pointer),pointer=pointer.parentElement;return res}__name(createEventPath,"createEventPath");function getEventPath(event){const eventNoType=event;return eventNoType.path?eventNoType.path:eventNoType.composedPath?eventNoType.composedPath():createEventPath(eventNoType)}__name(getEventPath,"getEventPath");function addSafePassiveEventListener(frameworkOverrides,eElement,event,listener){const options=includes(PASSIVE_EVENTS,event)?{passive:!0}:void 0;frameworkOverrides&&frameworkOverrides.addEventListener&&frameworkOverrides.addEventListener(eElement,event,listener,options)}__name(addSafePassiveEventListener,"addSafePassiveEventListener");var _a8,_BeanStub=(_a8=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.lastChangeSetIdLookup={},this.propertyListenerId=0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){this.destroyFunctions.forEach(func=>func()),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:_a8.EVENT_DESTROYED})}addEventListener(eventType,listener){this.localEventService||(this.localEventService=new EventService),this.localEventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.localEventService&&this.localEventService.removeEventListener(eventType,listener)}dispatchEvent(event){this.localEventService&&this.localEventService.dispatchEvent(event)}addManagedListener(object,event,listener){if(this.destroyed)return;object instanceof HTMLElement?addSafePassiveEventListener(this.getFrameworkOverrides(),object,event,listener):object.addEventListener(event,listener);const destroyFunc=__name(()=>(object.removeEventListener(event,listener),this.destroyFunctions=this.destroyFunctions.filter(fn=>fn!==destroyFunc),null),"destroyFunc");return this.destroyFunctions.push(destroyFunc),destroyFunc}setupGridOptionListener(event,listener){this.gridOptionsService.addEventListener(event,listener);const destroyFunc=__name(()=>(this.gridOptionsService.removeEventListener(event,listener),this.destroyFunctions=this.destroyFunctions.filter(fn=>fn!==destroyFunc),null),"destroyFunc");return this.destroyFunctions.push(destroyFunc),destroyFunc}addManagedPropertyListener(event,listener){return this.destroyed?()=>null:this.setupGridOptionListener(event,listener)}addManagedPropertyListeners(events,listener){if(this.destroyed)return;const eventsKey=events.join("-")+this.propertyListenerId++,wrappedListener=__name(event=>{if(event.changeSet){if(event.changeSet&&event.changeSet.id===this.lastChangeSetIdLookup[eventsKey])return;this.lastChangeSetIdLookup[eventsKey]=event.changeSet.id}const propertiesChangeEvent={type:"gridPropertyChanged",changeSet:event.changeSet,source:event.source};listener(propertiesChangeEvent)},"wrappedListener");events.forEach(event=>this.setupGridOptionListener(event,wrappedListener))}addDestroyFunc(func){this.isAlive()?this.destroyFunctions.push(func):func()}createManagedBean(bean,context){const res=this.createBean(bean,context);return this.addDestroyFunc(this.destroyBean.bind(this,bean,context)),res}createBean(bean,context,afterPreCreateCallback){return(context||this.getContext()).createBean(bean,afterPreCreateCallback)}destroyBean(bean,context){return(context||this.getContext()).destroyBean(bean)}destroyBeans(beans,context){return beans&&beans.forEach(bean=>this.destroyBean(bean,context)),[]}},__name(_a8,"_BeanStub"),_a8);_BeanStub.EVENT_DESTROYED="destroyed";__decorateClass([Autowired("frameworkOverrides")],_BeanStub.prototype,"frameworkOverrides",2);__decorateClass([Autowired("context")],_BeanStub.prototype,"context",2);__decorateClass([Autowired("eventService")],_BeanStub.prototype,"eventService",2);__decorateClass([Autowired("gridOptionsService")],_BeanStub.prototype,"gridOptionsService",2);__decorateClass([Autowired("localeService")],_BeanStub.prototype,"localeService",2);__decorateClass([Autowired("environment")],_BeanStub.prototype,"environment",2);__decorateClass([PreDestroy],_BeanStub.prototype,"destroy",1);var BeanStub=_BeanStub,_a9,ColumnFactory=(_a9=class extends BeanStub{setBeans(loggerFactory){this.logger=loggerFactory.create("ColumnFactory")}createColumnTree(defs,primaryColumns,existingTree,source){const columnKeyCreator=new ColumnKeyCreator,{existingCols,existingGroups,existingColKeys}=this.extractExistingTreeData(existingTree);columnKeyCreator.addExistingKeys(existingColKeys);const unbalancedTree=this.recursivelyCreateColumns(defs,0,primaryColumns,existingCols,columnKeyCreator,existingGroups,source),treeDept=this.findMaxDept(unbalancedTree,0);this.logger.log("Number of levels for grouped columns is "+treeDept);const columnTree=this.balanceColumnTree(unbalancedTree,0,treeDept,columnKeyCreator),deptFirstCallback=__name((child,parent)=>{child instanceof ProvidedColumnGroup&&child.setupExpandable(),child.setOriginalParent(parent)},"deptFirstCallback");return this.columnUtils.depthFirstOriginalTreeSearch(null,columnTree,deptFirstCallback),{columnTree,treeDept}}extractExistingTreeData(existingTree){const existingCols=[],existingGroups=[],existingColKeys=[];return existingTree&&this.columnUtils.depthFirstOriginalTreeSearch(null,existingTree,item=>{if(item instanceof ProvidedColumnGroup){const group=item;existingGroups.push(group)}else{const col=item;existingColKeys.push(col.getId()),existingCols.push(col)}}),{existingCols,existingGroups,existingColKeys}}createForAutoGroups(autoGroupCols,gridBalancedTree){return autoGroupCols.map(col=>this.createAutoGroupTreeItem(gridBalancedTree,col))}createAutoGroupTreeItem(balancedColumnTree,column){const dept=this.findDepth(balancedColumnTree);let nextChild=column;for(let i=dept-1;i>=0;i--){const autoGroup=new ProvidedColumnGroup(null,`FAKE_PATH_${column.getId()}}_${i}`,!0,i);this.createBean(autoGroup),autoGroup.setChildren([nextChild]),nextChild.setOriginalParent(autoGroup),nextChild=autoGroup}return dept===0&&column.setOriginalParent(null),nextChild}findDepth(balancedColumnTree){let dept=0,pointer=balancedColumnTree;for(;pointer&&pointer[0]&&pointer[0]instanceof ProvidedColumnGroup;)dept++,pointer=pointer[0].getChildren();return dept}balanceColumnTree(unbalancedTree,currentDept,columnDept,columnKeyCreator){const result=[];for(let i=0;i<unbalancedTree.length;i++){const child=unbalancedTree[i];if(child instanceof ProvidedColumnGroup){const originalGroup=child,newChildren=this.balanceColumnTree(originalGroup.getChildren(),currentDept+1,columnDept,columnKeyCreator);originalGroup.setChildren(newChildren),result.push(originalGroup)}else{let firstPaddedGroup,currentPaddedGroup;for(let j=columnDept-1;j>=currentDept;j--){const newColId=columnKeyCreator.getUniqueKey(null,null),colGroupDefMerged=this.createMergedColGroupDef(null),paddedGroup=new ProvidedColumnGroup(colGroupDefMerged,newColId,!0,currentDept);this.createBean(paddedGroup),currentPaddedGroup&&currentPaddedGroup.setChildren([paddedGroup]),currentPaddedGroup=paddedGroup,firstPaddedGroup||(firstPaddedGroup=currentPaddedGroup)}if(firstPaddedGroup&&currentPaddedGroup)if(result.push(firstPaddedGroup),unbalancedTree.some(leaf=>leaf instanceof ProvidedColumnGroup)){currentPaddedGroup.setChildren([child]);continue}else{currentPaddedGroup.setChildren(unbalancedTree);break}result.push(child)}}return result}findMaxDept(treeChildren,dept){let maxDeptThisLevel=dept;for(let i=0;i<treeChildren.length;i++){const abstractColumn=treeChildren[i];if(abstractColumn instanceof ProvidedColumnGroup){const originalGroup=abstractColumn,newDept=this.findMaxDept(originalGroup.getChildren(),dept+1);maxDeptThisLevel<newDept&&(maxDeptThisLevel=newDept)}}return maxDeptThisLevel}recursivelyCreateColumns(defs,level,primaryColumns,existingColsCopy,columnKeyCreator,existingGroups,source){if(!defs)return[];const result=new Array(defs.length);for(let i=0;i<result.length;i++){const def=defs[i];this.isColumnGroup(def)?result[i]=this.createColumnGroup(primaryColumns,def,level,existingColsCopy,columnKeyCreator,existingGroups,source):result[i]=this.createColumn(primaryColumns,def,existingColsCopy,columnKeyCreator,source)}return result}createColumnGroup(primaryColumns,colGroupDef,level,existingColumns,columnKeyCreator,existingGroups,source){const colGroupDefMerged=this.createMergedColGroupDef(colGroupDef),groupId=columnKeyCreator.getUniqueKey(colGroupDefMerged.groupId||null,null),providedGroup=new ProvidedColumnGroup(colGroupDefMerged,groupId,!1,level);this.createBean(providedGroup);const existingGroupAndIndex=this.findExistingGroup(colGroupDef,existingGroups);existingGroupAndIndex&&existingGroups.splice(existingGroupAndIndex.idx,1);let existingGroup=existingGroupAndIndex==null?void 0:existingGroupAndIndex.group;existingGroup&&providedGroup.setExpanded(existingGroup.isExpanded());const children=this.recursivelyCreateColumns(colGroupDefMerged.children,level+1,primaryColumns,existingColumns,columnKeyCreator,existingGroups,source);return providedGroup.setChildren(children),providedGroup}createMergedColGroupDef(colGroupDef){const colGroupDefMerged={};return Object.assign(colGroupDefMerged,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(colGroupDefMerged,colGroupDef),colGroupDefMerged}createColumn(primaryColumns,colDef,existingColsCopy,columnKeyCreator,source){const existingColAndIndex=this.findExistingColumn(colDef,existingColsCopy);existingColAndIndex&&(existingColsCopy==null||existingColsCopy.splice(existingColAndIndex.idx,1));let column=existingColAndIndex==null?void 0:existingColAndIndex.column;if(column){const colDefMerged=this.addColumnDefaultAndTypes(colDef,column.getColId());column.setColDef(colDefMerged,colDef,source),this.applyColumnState(column,colDefMerged,source)}else{const colId=columnKeyCreator.getUniqueKey(colDef.colId,colDef.field),colDefMerged=this.addColumnDefaultAndTypes(colDef,colId);column=new Column(colDefMerged,colDef,colId,primaryColumns),this.context.createBean(column)}return this.dataTypeService.addColumnListeners(column),column}applyColumnState(column,colDef,source){const flex=attrToNumber(colDef.flex);if(flex!==void 0&&column.setFlex(flex),column.getFlex()<=0){const width=attrToNumber(colDef.width);if(width!=null)column.setActualWidth(width,source);else{const widthBeforeUpdate=column.getActualWidth();column.setActualWidth(widthBeforeUpdate,source)}}colDef.sort!==void 0&&(colDef.sort=="asc"||colDef.sort=="desc"?column.setSort(colDef.sort,source):column.setSort(void 0,source));const sortIndex=attrToNumber(colDef.sortIndex);sortIndex!==void 0&&column.setSortIndex(sortIndex);const hide=attrToBoolean(colDef.hide);hide!==void 0&&column.setVisible(!hide,source),colDef.pinned!==void 0&&column.setPinned(colDef.pinned)}findExistingColumn(newColDef,existingColsCopy){if(existingColsCopy)for(let i=0;i<existingColsCopy.length;i++){const def=existingColsCopy[i].getUserProvidedColDef();if(!def)continue;if(newColDef.colId!=null){if(existingColsCopy[i].getId()===newColDef.colId)return{idx:i,column:existingColsCopy[i]};continue}if(newColDef.field!=null){if(def.field===newColDef.field)return{idx:i,column:existingColsCopy[i]};continue}if(def===newColDef)return{idx:i,column:existingColsCopy[i]}}}findExistingGroup(newGroupDef,existingGroups){if(newGroupDef.groupId!=null)for(let i=0;i<existingGroups.length;i++){const existingGroup=existingGroups[i];if(existingGroup.getColGroupDef()&&existingGroup.getId()===newGroupDef.groupId)return{idx:i,group:existingGroup}}}addColumnDefaultAndTypes(colDef,colId){const res={},defaultColDef=this.gridOptionsService.get("defaultColDef");mergeDeep(res,defaultColDef,!1,!0);const columnType=this.dataTypeService.updateColDefAndGetColumnType(res,colDef,colId);columnType&&this.assignColumnTypes(columnType,res),mergeDeep(res,colDef,!1,!0);const autoGroupColDef=this.gridOptionsService.get("autoGroupColumnDef"),isSortingCoupled=this.gridOptionsService.isColumnsSortingCoupledToGroup();return colDef.rowGroup&&autoGroupColDef&&isSortingCoupled&&mergeDeep(res,{sort:autoGroupColDef.sort,initialSort:autoGroupColDef.initialSort},!1,!0),this.dataTypeService.validateColDef(res),res}assignColumnTypes(typeKeys,colDefMerged){if(!typeKeys.length)return;const allColumnTypes=Object.assign({},DefaultColumnTypes),userTypes=this.gridOptionsService.get("columnTypes")||{};iterateObject(userTypes,(key,value)=>{key in allColumnTypes?console.warn(`AG Grid: the column type '${key}' is a default column type and cannot be overridden.`):(value.type&&warnOnce("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),allColumnTypes[key]=value)}),typeKeys.forEach(t=>{const typeColDef=allColumnTypes[t.trim()];typeColDef?mergeDeep(colDefMerged,typeColDef,!1,!0):console.warn("AG Grid: colDef.type '"+t+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(abstractColDef){return abstractColDef.children!==void 0}},__name(_a9,"ColumnFactory"),_a9);__decorateClass([Autowired("columnUtils")],ColumnFactory.prototype,"columnUtils",2);__decorateClass([Autowired("dataTypeService")],ColumnFactory.prototype,"dataTypeService",2);__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],ColumnFactory.prototype,"setBeans",1);ColumnFactory=__decorateClass([Bean("columnFactory")],ColumnFactory);var _a10,_ColumnGroup=(_a10=class{constructor(providedColumnGroup,groupId,partId,pinned){this.displayedChildren=[],this.localEventService=new EventService,this.groupId=groupId,this.partId=partId,this.providedColumnGroup=providedColumnGroup,this.pinned=pinned}static createUniqueId(groupId,instanceId){return groupId+"_"+instanceId}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(parent){this.parent=parent}getUniqueId(){return _a10.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const allLeafColumns=this.getProvidedColumnGroup().getLeafColumns();return!allLeafColumns||allLeafColumns.length===0?!1:allLeafColumns.every(col=>col.isMoving())}checkLeft(){if(this.displayedChildren.forEach(child=>{child instanceof _a10&&child.checkLeft()}),this.displayedChildren.length>0)if(this.gridOptionsService.get("enableRtl")){const lastChildLeft=last(this.displayedChildren).getLeft();this.setLeft(lastChildLeft)}else{const firstChildLeft=this.displayedChildren[0].getLeft();this.setLeft(firstChildLeft)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(left){this.oldLeft=this.left,this.left!==left&&(this.left=left,this.localEventService.dispatchEvent(this.createAgEvent(_a10.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(type){return{type}}addEventListener(eventType,listener){this.localEventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.localEventService.removeEventListener(eventType,listener)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(wantedChild){let result=!1;return this.children.forEach(foundChild=>{wantedChild===foundChild&&(result=!0),foundChild instanceof _a10&&foundChild.isChildInThisGroupDeepSearch(wantedChild)&&(result=!0)}),result}getActualWidth(){let groupActualWidth=0;return this.displayedChildren&&this.displayedChildren.forEach(child=>{groupActualWidth+=child.getActualWidth()}),groupActualWidth}isResizable(){if(!this.displayedChildren)return!1;let result=!1;return this.displayedChildren.forEach(child=>{child.isResizable()&&(result=!0)}),result}getMinWidth(){let result=0;return this.displayedChildren.forEach(groupChild=>{result+=groupChild.getMinWidth()||0}),result}addChild(child){this.children||(this.children=[]),this.children.push(child)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const result=[];return this.addLeafColumns(result),result}getDisplayedLeafColumns(){const result=[];return this.addDisplayedLeafColumns(result),result}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(expanded){this.providedColumnGroup.setExpanded(expanded)}addDisplayedLeafColumns(leafColumns){this.displayedChildren.forEach(child=>{child instanceof Column?leafColumns.push(child):child instanceof _a10&&child.addDisplayedLeafColumns(leafColumns)})}addLeafColumns(leafColumns){this.children.forEach(child=>{child instanceof Column?leafColumns.push(child):child instanceof _a10&&child.addLeafColumns(leafColumns)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const parent=this.getParent();return!this.isPadding()||!parent||!parent.isPadding()?0:1+parent.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let parentWithExpansion=this;for(;parentWithExpansion!=null&&parentWithExpansion.isPadding();)parentWithExpansion=parentWithExpansion.getParent();if(!(parentWithExpansion?parentWithExpansion.providedColumnGroup.isExpandable():!1)){this.displayedChildren=this.children,this.localEventService.dispatchEvent(this.createAgEvent(_a10.EVENT_DISPLAYED_CHILDREN_CHANGED));return}this.children.forEach(child=>{if(child instanceof _a10&&(!child.displayedChildren||!child.displayedChildren.length))return;switch(child.getColumnGroupShow()){case"open":parentWithExpansion.providedColumnGroup.isExpanded()&&this.displayedChildren.push(child);break;case"closed":parentWithExpansion.providedColumnGroup.isExpanded()||this.displayedChildren.push(child);break;default:this.displayedChildren.push(child);break}}),this.localEventService.dispatchEvent(this.createAgEvent(_a10.EVENT_DISPLAYED_CHILDREN_CHANGED))}},__name(_a10,"_ColumnGroup"),_a10);_ColumnGroup.EVENT_LEFT_CHANGED="leftChanged";_ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged";__decorateClass([Autowired("gridOptionsService")],_ColumnGroup.prototype,"gridOptionsService",2);var ColumnGroup=_ColumnGroup,_a11,Events=(_a11=class{},__name(_a11,"Events"),_a11);Events.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged";Events.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded";Events.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged";Events.EVENT_PIVOT_MAX_COLUMNS_EXCEEDED="pivotMaxColumnsExceeded";Events.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged";Events.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll";Events.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged";Events.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged";Events.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged";Events.EVENT_COLUMN_MOVED="columnMoved";Events.EVENT_COLUMN_VISIBLE="columnVisible";Events.EVENT_COLUMN_PINNED="columnPinned";Events.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened";Events.EVENT_COLUMN_RESIZED="columnResized";Events.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged";Events.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED="suppressMovableColumns";Events.EVENT_SUPPRESS_MENU_HIDE_CHANGED="suppressMenuHide";Events.EVENT_SUPPRESS_FIELD_DOT_NOTATION="suppressFieldDotNotation";Events.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged";Events.EVENT_COLUMN_HEADER_MOUSE_OVER="columnHeaderMouseOver";Events.EVENT_COLUMN_HEADER_MOUSE_LEAVE="columnHeaderMouseLeave";Events.EVENT_COLUMN_HEADER_CLICKED="columnHeaderClicked";Events.EVENT_COLUMN_HEADER_CONTEXT_MENU="columnHeaderContextMenu";Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed";Events.EVENT_ROW_GROUP_OPENED="rowGroupOpened";Events.EVENT_ROW_DATA_UPDATED="rowDataUpdated";Events.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged";Events.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged";Events.EVENT_CHART_CREATED="chartCreated";Events.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged";Events.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged";Events.EVENT_CHART_DESTROYED="chartDestroyed";Events.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged";Events.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged";Events.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart";Events.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd";Events.EVENT_MODEL_UPDATED="modelUpdated";Events.EVENT_CUT_START="cutStart";Events.EVENT_CUT_END="cutEnd";Events.EVENT_PASTE_START="pasteStart";Events.EVENT_PASTE_END="pasteEnd";Events.EVENT_FILL_START="fillStart";Events.EVENT_FILL_END="fillEnd";Events.EVENT_RANGE_DELETE_START="rangeDeleteStart";Events.EVENT_RANGE_DELETE_END="rangeDeleteEnd";Events.EVENT_UNDO_STARTED="undoStarted";Events.EVENT_UNDO_ENDED="undoEnded";Events.EVENT_REDO_STARTED="redoStarted";Events.EVENT_REDO_ENDED="redoEnded";Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart";Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd";Events.EVENT_CELL_CLICKED="cellClicked";Events.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked";Events.EVENT_CELL_MOUSE_DOWN="cellMouseDown";Events.EVENT_CELL_CONTEXT_MENU="cellContextMenu";Events.EVENT_CELL_VALUE_CHANGED="cellValueChanged";Events.EVENT_CELL_EDIT_REQUEST="cellEditRequest";Events.EVENT_ROW_VALUE_CHANGED="rowValueChanged";Events.EVENT_CELL_FOCUSED="cellFocused";Events.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared";Events.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused";Events.EVENT_ROW_SELECTED="rowSelected";Events.EVENT_SELECTION_CHANGED="selectionChanged";Events.EVENT_TOOLTIP_SHOW="tooltipShow";Events.EVENT_TOOLTIP_HIDE="tooltipHide";Events.EVENT_CELL_KEY_DOWN="cellKeyDown";Events.EVENT_CELL_MOUSE_OVER="cellMouseOver";Events.EVENT_CELL_MOUSE_OUT="cellMouseOut";Events.EVENT_FILTER_CHANGED="filterChanged";Events.EVENT_FILTER_MODIFIED="filterModified";Events.EVENT_FILTER_OPENED="filterOpened";Events.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED="advancedFilterBuilderVisibleChanged";Events.EVENT_SORT_CHANGED="sortChanged";Events.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved";Events.EVENT_ROW_CLICKED="rowClicked";Events.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked";Events.EVENT_GRID_READY="gridReady";Events.EVENT_GRID_PRE_DESTROYED="gridPreDestroyed";Events.EVENT_GRID_SIZE_CHANGED="gridSizeChanged";Events.EVENT_VIEWPORT_CHANGED="viewportChanged";Events.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged";Events.EVENT_FIRST_DATA_RENDERED="firstDataRendered";Events.EVENT_DRAG_STARTED="dragStarted";Events.EVENT_DRAG_STOPPED="dragStopped";Events.EVENT_CHECKBOX_CHANGED="checkboxChanged";Events.EVENT_ROW_EDITING_STARTED="rowEditingStarted";Events.EVENT_ROW_EDITING_STOPPED="rowEditingStopped";Events.EVENT_CELL_EDITING_STARTED="cellEditingStarted";Events.EVENT_CELL_EDITING_STOPPED="cellEditingStopped";Events.EVENT_BODY_SCROLL="bodyScroll";Events.EVENT_BODY_SCROLL_END="bodyScrollEnd";Events.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged";Events.EVENT_PAGINATION_CHANGED="paginationChanged";Events.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged";Events.EVENT_STORE_REFRESHED="storeRefreshed";Events.EVENT_STATE_UPDATED="stateUpdated";Events.EVENT_COLUMN_MENU_VISIBLE_CHANGED="columnMenuVisibleChanged";Events.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged";Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED="columnContainerWidthChanged";Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged";Events.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged";Events.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged";Events.EVENT_FLASH_CELLS="flashCells";Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged";Events.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged";Events.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged";Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged";Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged";Events.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged";Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged";Events.EVENT_ROW_DRAG_ENTER="rowDragEnter";Events.EVENT_ROW_DRAG_MOVE="rowDragMove";Events.EVENT_ROW_DRAG_LEAVE="rowDragLeave";Events.EVENT_ROW_DRAG_END="rowDragEnd";Events.EVENT_GRID_STYLES_CHANGED="gridStylesChanged";Events.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest";Events.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest";Events.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest";Events.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest";Events.EVENT_STORE_UPDATED="storeUpdated";Events.EVENT_FILTER_DESTROYED="filterDestroyed";Events.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";Events.EVENT_ROW_COUNT_READY="rowCountReady";Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged";Events.EVENT_DATA_TYPES_INFERRED="dataTypesInferred";Events.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged";Events.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected";Events.EVENT_SIDE_BAR_UPDATED="sideBarUpdated";var ALWAYS_SYNC_GLOBAL_EVENTS=new Set([Events.EVENT_GRID_PRE_DESTROYED]),_a12,GroupInstanceIdCreator=(_a12=class{constructor(){this.existingIds={}}getInstanceIdForKey(key){const lastResult=this.existingIds[key];let result;return typeof lastResult!="number"?result=0:result=lastResult+1,this.existingIds[key]=result,result}},__name(_a12,"GroupInstanceIdCreator"),_a12),GROUP_AUTO_COLUMN_ID="ag-Grid-AutoColumn",_a13,AutoGroupColService=(_a13=class extends BeanStub{createAutoGroupColumns(rowGroupColumns){const groupAutoColumns=[],doingTreeData=this.gridOptionsService.get("treeData");let doingMultiAutoColumn=this.gridOptionsService.isGroupMultiAutoColumn();return doingTreeData&&doingMultiAutoColumn&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),doingMultiAutoColumn=!1),doingMultiAutoColumn?rowGroupColumns.forEach((rowGroupCol,index)=>{groupAutoColumns.push(this.createOneAutoGroupColumn(rowGroupCol,index))}):groupAutoColumns.push(this.createOneAutoGroupColumn()),groupAutoColumns}updateAutoGroupColumns(autoGroupColumns,source){autoGroupColumns.forEach((column,index)=>this.updateOneAutoGroupColumn(column,index,source))}createOneAutoGroupColumn(rowGroupCol,index){let colId;rowGroupCol?colId=`${GROUP_AUTO_COLUMN_ID}-${rowGroupCol.getId()}`:colId=GROUP_AUTO_COLUMN_ID;const colDef=this.createAutoGroupColDef(colId,rowGroupCol,index);colDef.colId=colId;const newCol=new Column(colDef,null,colId,!0);return this.context.createBean(newCol),newCol}updateOneAutoGroupColumn(colToUpdate,index,source){const oldColDef=colToUpdate.getColDef(),underlyingColId=typeof oldColDef.showRowGroup=="string"?oldColDef.showRowGroup:void 0,underlyingColumn=underlyingColId!=null?this.columnModel.getPrimaryColumn(underlyingColId):void 0,colDef=this.createAutoGroupColDef(colToUpdate.getId(),underlyingColumn??void 0,index);colToUpdate.setColDef(colDef,null,source),this.columnFactory.applyColumnState(colToUpdate,colDef,source)}createAutoGroupColDef(colId,underlyingColumn,index){let res=this.createBaseColDef(underlyingColumn);const autoGroupColumnDef=this.gridOptionsService.get("autoGroupColumnDef");mergeDeep(res,autoGroupColumnDef),res=this.columnFactory.addColumnDefaultAndTypes(res,colId),this.gridOptionsService.get("treeData")||missing(res.field)&&missing(res.valueGetter)&&missing(res.filterValueGetter)&&res.filter!=="agGroupColumnFilter"&&(res.filter=!1),index&&index>0&&(res.headerCheckboxSelection=!1);const isSortingCoupled=this.gridOptionsService.isColumnsSortingCoupledToGroup(),hasOwnData=res.valueGetter||res.field!=null;return isSortingCoupled&&!hasOwnData&&(res.sortIndex=void 0,res.initialSort=void 0),res}createBaseColDef(rowGroupCol){const userDef=this.gridOptionsService.get("autoGroupColumnDef"),res={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(userDef&&(userDef.cellRenderer||userDef.cellRendererSelector)||(res.cellRenderer="agGroupCellRenderer"),rowGroupCol){const colDef=rowGroupCol.getColDef();Object.assign(res,{headerName:this.columnModel.getDisplayNameForColumn(rowGroupCol,"header"),headerValueGetter:colDef.headerValueGetter}),colDef.cellRenderer&&Object.assign(res,{cellRendererParams:{innerRenderer:colDef.cellRenderer,innerRendererParams:colDef.cellRendererParams}}),res.showRowGroup=rowGroupCol.getColId()}else res.showRowGroup=!0;return res}},__name(_a13,"AutoGroupColService"),_a13);__decorateClass([Autowired("columnModel")],AutoGroupColService.prototype,"columnModel",2);__decorateClass([Autowired("columnFactory")],AutoGroupColService.prototype,"columnFactory",2);AutoGroupColService=__decorateClass([Bean("autoGroupColService")],AutoGroupColService);var string_exports={};__export(string_exports,{camelCaseToHumanText:()=>camelCaseToHumanText,camelCaseToHyphenated:()=>camelCaseToHyphenated,capitalise:()=>capitalise,escapeString:()=>escapeString,utf8_encode:()=>utf8_encode});var reUnescapedHtml=/[&<>"']/g,HTML_ESCAPES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function utf8_encode(s){const stringFromCharCode=String.fromCharCode;function ucs2decode(string){const output=[];if(!string)return[];const len=string.length;let counter=0,value,extra;for(;counter<len;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<len?(extra=string.charCodeAt(counter++),(extra&64512)==56320?output.push(((value&1023)<<10)+(extra&1023)+65536):(output.push(value),counter--)):output.push(value);return output}__name(ucs2decode,"ucs2decode");function checkScalarValue(point){if(point>=55296&&point<=57343)throw Error("Lone surrogate U+"+point.toString(16).toUpperCase()+" is not a scalar value")}__name(checkScalarValue,"checkScalarValue");function createByte(point,shift){return stringFromCharCode(point>>shift&63|128)}__name(createByte,"createByte");function encodeCodePoint(point){if(point>=0&&point<=31&&point!==10)return`_x${point.toString(16).toUpperCase().padStart(4,"0")}_`;if(!(point&4294967168))return stringFromCharCode(point);let symbol="";return point&4294965248?point&4294901760?point&4292870144||(symbol=stringFromCharCode(point>>18&7|240),symbol+=createByte(point,12),symbol+=createByte(point,6)):(checkScalarValue(point),symbol=stringFromCharCode(point>>12&15|224),symbol+=createByte(point,6)):symbol=stringFromCharCode(point>>6&31|192),symbol+=stringFromCharCode(point&63|128),symbol}__name(encodeCodePoint,"encodeCodePoint");const codePoints=ucs2decode(s),length=codePoints.length;let index=-1,codePoint,byteString="";for(;++index<length;)codePoint=codePoints[index],byteString+=encodeCodePoint(codePoint);return byteString}__name(utf8_encode,"utf8_encode");function capitalise(str){return str[0].toUpperCase()+str.substring(1).toLowerCase()}__name(capitalise,"capitalise");function escapeString(toEscape,skipEscapingHtmlChars){if(toEscape==null)return null;const stringResult=toEscape.toString().toString();return skipEscapingHtmlChars?stringResult:stringResult.replace(reUnescapedHtml,chr=>HTML_ESCAPES[chr])}__name(escapeString,"escapeString");function camelCaseToHumanText(camelCase){if(!camelCase||camelCase==null)return null;const rex=/([a-z])([A-Z])/g,rexCaps=/([A-Z]+)([A-Z])([a-z])/g;return camelCase.replace(rex,"$1 $2").replace(rexCaps,"$1 $2$3").replace(/\./g," ").split(" ").map(word=>word.substring(0,1).toUpperCase()+(word.length>1?word.substring(1,word.length):"")).join(" ")}__name(camelCaseToHumanText,"camelCaseToHumanText");function camelCaseToHyphenated(camelCase){return camelCase.replace(/[A-Z]/g,s=>`-${s.toLocaleLowerCase()}`)}__name(camelCaseToHyphenated,"camelCaseToHyphenated");var map_exports={};__export(map_exports,{convertToMap:()=>convertToMap,keys:()=>keys,mapById:()=>mapById});function convertToMap(arr){const map=new Map;return arr.forEach(pair=>map.set(pair[0],pair[1])),map}__name(convertToMap,"convertToMap");function mapById(arr,callback){const map=new Map;return arr.forEach(item=>map.set(callback(item),item)),map}__name(mapById,"mapById");function keys(map){const arr=[];return map.forEach((_2,key)=>arr.push(key)),arr}__name(keys,"keys");var _a14,ColumnModel=(_a14=class extends BeanStub{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.changeEventsDispatching=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gridOptionsService.get("suppressColumnVirtualisation");const pivotMode=this.gridOptionsService.get("pivotMode");this.isPivotSettingAllowed(pivotMode)&&(this.pivotMode=pivotMode),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],event=>this.buildAutoGroupColumns(convertSourceType(event.source))),this.addManagedPropertyListener("autoGroupColumnDef",event=>this.onAutoGroupColumnDefChanged(convertSourceType(event.source))),this.addManagedPropertyListeners(["defaultColDef","columnTypes","suppressFieldDotNotation"],event=>this.onSharedColDefChanged(convertSourceType(event.source))),this.addManagedPropertyListener("pivotMode",event=>this.setPivotMode(this.gridOptionsService.get("pivotMode"),convertSourceType(event.source))),this.addManagedListener(this.eventService,Events.EVENT_FIRST_DATA_RENDERED,()=>this.onFirstDataRendered())}buildAutoGroupColumns(source){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns(source))}onAutoGroupColumnDefChanged(source){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,source)}onSharedColDefChanged(source){this.gridColumns&&(this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,source),this.createColumnsFromColumnDefs(!0,source))}setColumnDefs(columnDefs,source){const colsPreviouslyExisted=!!this.columnDefs;this.columnDefs=columnDefs,this.createColumnsFromColumnDefs(colsPreviouslyExisted,source)}recreateColumnDefs(source){this.onSharedColDefChanged(source)}destroyOldColumns(oldTree,newTree){const oldObjectsById={};if(!oldTree)return;this.columnUtils.depthFirstOriginalTreeSearch(null,oldTree,child=>{oldObjectsById[child.getInstanceId()]=child}),newTree&&this.columnUtils.depthFirstOriginalTreeSearch(null,newTree,child=>{oldObjectsById[child.getInstanceId()]=null});const colsToDestroy=Object.values(oldObjectsById).filter(item=>item!=null);this.destroyBeans(colsToDestroy)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(colsPreviouslyExisted,source){const dispatchEventsFunc=colsPreviouslyExisted?this.compareColumnStatesAndDispatchEvents(source):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const oldPrimaryColumns=this.primaryColumns,oldPrimaryTree=this.primaryColumnTree,balancedTreeResult=this.columnFactory.createColumnTree(this.columnDefs,!0,oldPrimaryTree,source);this.destroyOldColumns(this.primaryColumnTree,balancedTreeResult.columnTree),this.primaryColumnTree=balancedTreeResult.columnTree,this.primaryHeaderRowCount=balancedTreeResult.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(col=>this.primaryColumnsMap[col.getId()]=col),this.extractRowGroupColumns(source,oldPrimaryColumns),this.extractPivotColumns(source,oldPrimaryColumns),this.extractValueColumns(source,oldPrimaryColumns),this.ready=!0;const gridColsNotProcessed=this.gridColsArePrimary===void 0;(this.gridColsArePrimary||gridColsNotProcessed||this.autoGroupsNeedBuilding)&&(this.updateGridColumns(),colsPreviouslyExisted&&this.gridColsArePrimary&&!this.gridOptionsService.get("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(source),this.checkViewportColumns()),this.dispatchEverythingChanged(source),this.changeEventsDispatching=!0,dispatchEventsFunc&&dispatchEventsFunc(),this.changeEventsDispatching=!1,this.dispatchNewColumnsLoaded(source)}shouldRowModelIgnoreRefresh(){return this.changeEventsDispatching}dispatchNewColumnsLoaded(source){const newColumnsLoadedEvent={type:Events.EVENT_NEW_COLUMNS_LOADED,source};this.eventService.dispatchEvent(newColumnsLoadedEvent),source==="gridInitializing"&&this.onColumnsReady()}dispatchEverythingChanged(source){const eventEverythingChanged={type:Events.EVENT_COLUMN_EVERYTHING_CHANGED,source};this.eventService.dispatchEvent(eventEverythingChanged)}orderGridColumnsLikePrimary(){const primaryColumns=this.primaryColumns;if(!primaryColumns)return;const primaryColsOrdered=primaryColumns.filter(col=>this.gridColumns.indexOf(col)>=0),otherCols=this.gridColumns.filter(col=>primaryColsOrdered.indexOf(col)<0);this.gridColumns=[...otherCols,...primaryColsOrdered],this.gridColumns=this.placeLockedColumns(this.gridColumns)}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gridOptionsService.get("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}getDisplayedColumnsStartingAt(column){let currentColumn=column;const columns=[];for(;currentColumn!=null;)columns.push(currentColumn),currentColumn=this.getDisplayedColAfter(currentColumn);return columns}checkViewportColumns(afterScroll=!1){if(this.displayedColumnsCenter==null||!this.extractViewport())return;const event={type:Events.EVENT_VIRTUAL_COLUMNS_CHANGED,afterScroll};this.eventService.dispatchEvent(event)}setViewportPosition(scrollWidth,scrollPosition,afterScroll=!1){(scrollWidth!==this.scrollWidth||scrollPosition!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=scrollWidth,this.scrollPosition=scrollPosition,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns(afterScroll))}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(pivot){return pivot&&this.gridOptionsService.get("treeData")?(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1):!0}setPivotMode(pivotMode,source){if(pivotMode===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode)||(this.pivotMode=pivotMode,!this.gridColumns))return;this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(source);const event={type:Events.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(event)}getSecondaryPivotColumn(pivotKeys,valueColKey){if(missing(this.secondaryColumns))return null;const valueColumnToFind=this.getPrimaryColumn(valueColKey);let foundColumn=null;return this.secondaryColumns.forEach(column=>{const thisPivotKeys=column.getColDef().pivotKeys,pivotValueColumn=column.getColDef().pivotValueColumn;areEqual(thisPivotKeys,pivotKeys)&&pivotValueColumn===valueColumnToFind&&(foundColumn=column)}),foundColumn}setBeans(loggerFactory){this.logger=loggerFactory.create("columnModel")}setFirstRightAndLastLeftPinned(source){let lastLeft,firstRight;this.gridOptionsService.get("enableRtl")?(lastLeft=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,firstRight=this.displayedColumnsRight?last(this.displayedColumnsRight):null):(lastLeft=this.displayedColumnsLeft?last(this.displayedColumnsLeft):null,firstRight=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(column=>{column.setLastLeftPinned(column===lastLeft,source),column.setFirstRightPinned(column===firstRight,source)})}autoSizeColumns(params){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeColumns(params));return}const{columns,skipHeader,skipHeaderGroups,stopAtGroup,source="api"}=params;this.animationFrameService.flushAllFrames();const columnsAutosized=[];let changesThisTimeAround=-1;const shouldSkipHeader=skipHeader??this.gridOptionsService.get("skipHeaderOnAutoSize"),shouldSkipHeaderGroups=skipHeaderGroups??shouldSkipHeader;for(;changesThisTimeAround!==0;)changesThisTimeAround=0,this.actionOnGridColumns(columns,column=>{if(columnsAutosized.indexOf(column)>=0)return!1;const preferredWidth=this.autoWidthCalculator.getPreferredWidthForColumn(column,shouldSkipHeader);if(preferredWidth>0){const newWidth=this.normaliseColumnWidth(column,preferredWidth);column.setActualWidth(newWidth,source),columnsAutosized.push(column),changesThisTimeAround++}return!0},source);shouldSkipHeaderGroups||this.autoSizeColumnGroupsByColumns(columns,source,stopAtGroup),this.dispatchColumnResizedEvent(columnsAutosized,!0,"autosizeColumns")}dispatchColumnResizedEvent(columns,finished,source,flexColumns=null){if(columns&&columns.length){const event={type:Events.EVENT_COLUMN_RESIZED,columns,column:columns.length===1?columns[0]:null,flexColumns,finished,source};this.eventService.dispatchEvent(event)}}dispatchColumnChangedEvent(type,columns,source){const event={type,columns,column:columns&&columns.length==1?columns[0]:null,source};this.eventService.dispatchEvent(event)}dispatchColumnMovedEvent(params){const{movedColumns,source,toIndex,finished}=params,event={type:Events.EVENT_COLUMN_MOVED,columns:movedColumns,column:movedColumns&&movedColumns.length===1?movedColumns[0]:null,toIndex,finished,source};this.eventService.dispatchEvent(event)}dispatchColumnPinnedEvent(changedColumns,source){if(!changedColumns.length)return;const column=changedColumns.length===1?changedColumns[0]:null,pinned=this.getCommonValue(changedColumns,col=>col.getPinned()),event={type:Events.EVENT_COLUMN_PINNED,pinned:pinned??null,columns:changedColumns,column,source};this.eventService.dispatchEvent(event)}dispatchColumnVisibleEvent(changedColumns,source){if(!changedColumns.length)return;const column=changedColumns.length===1?changedColumns[0]:null,visible=this.getCommonValue(changedColumns,col=>col.isVisible()),event={type:Events.EVENT_COLUMN_VISIBLE,visible,columns:changedColumns,column,source};this.eventService.dispatchEvent(event)}autoSizeColumn(key,source,skipHeader){key&&this.autoSizeColumns({columns:[key],skipHeader,skipHeaderGroups:!0,source})}autoSizeColumnGroupsByColumns(keys2,source,stopAtGroup){const columnGroups=new Set;this.getGridColumns(keys2).forEach(col=>{let parent=col.getParent();for(;parent&&parent!=stopAtGroup;)parent.isPadding()||columnGroups.add(parent),parent=parent.getParent()});let headerGroupCtrl;const resizedColumns=[];for(const columnGroup of columnGroups){for(const headerContainerCtrl of this.ctrlsService.getHeaderRowContainerCtrls())if(headerGroupCtrl=headerContainerCtrl.getHeaderCtrlForColumn(columnGroup),headerGroupCtrl)break;headerGroupCtrl&&headerGroupCtrl.resizeLeafColumnsToFit(source)}return resizedColumns}autoSizeAllColumns(source,skipHeader){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(source,skipHeader));return}const allDisplayedColumns=this.getAllDisplayedColumns();this.autoSizeColumns({columns:allDisplayedColumns,skipHeader,source})}getColumnsFromTree(rootColumns){const result=[],recursiveFindColumns=__name(childColumns=>{for(let i=0;i<childColumns.length;i++){const child=childColumns[i];child instanceof Column?result.push(child):child instanceof ProvidedColumnGroup&&recursiveFindColumns(child.getChildren())}},"recursiveFindColumns");return recursiveFindColumns(rootColumns),result}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(column){return this.getAllDisplayedColumns().indexOf(column)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(rowNode){return this.colSpanActive?this.getDisplayedColumnsForRow(rowNode,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(rowNode){return this.colSpanActive?this.getDisplayedColumnsForRow(rowNode,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(rowNode,displayedColumns,filterCallback,emptySpaceBeforeColumn){const result=[];let lastConsideredCol=null;for(let i=0;i<displayedColumns.length;i++){const col=displayedColumns[i],maxAllowedColSpan=displayedColumns.length-i,colSpan=Math.min(col.getColSpan(rowNode),maxAllowedColSpan),columnsToCheckFilter=[col];if(colSpan>1){const colsToRemove=colSpan-1;for(let j=1;j<=colsToRemove;j++)columnsToCheckFilter.push(displayedColumns[i+j]);i+=colsToRemove}let filterPasses;filterCallback?(filterPasses=!1,columnsToCheckFilter.forEach(colForFilter=>{filterCallback(colForFilter)&&(filterPasses=!0)})):filterPasses=!0,filterPasses&&(result.length===0&&lastConsideredCol&&(emptySpaceBeforeColumn&&emptySpaceBeforeColumn(col))&&result.push(lastConsideredCol),result.push(col)),lastConsideredCol=col}return result}getViewportCenterColumnsForRow(rowNode){if(!this.colSpanActive)return this.viewportColumnsCenter;const emptySpaceBeforeColumn=__name(col=>{const left=col.getLeft();return exists(left)&&left>this.viewportLeft},"emptySpaceBeforeColumn"),filterCallback=this.isColumnVirtualisationSuppressed()?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(rowNode,this.displayedColumnsCenter,filterCallback,emptySpaceBeforeColumn)}isColumnAtEdge(col,edge){const allColumns=this.getAllDisplayedColumns();if(!allColumns.length)return!1;const isFirst=edge==="first";let columnToCompare;if(col instanceof ColumnGroup){const leafColumns=col.getDisplayedLeafColumns();if(!leafColumns.length)return!1;columnToCompare=isFirst?leafColumns[0]:last(leafColumns)}else columnToCompare=col;return(isFirst?allColumns[0]:last(allColumns))===columnToCompare}getAriaColumnIndex(col){let targetColumn;return col instanceof ColumnGroup?targetColumn=col.getLeafColumns()[0]:targetColumn=col,this.ariaOrderColumns.indexOf(targetColumn)+1}isColumnInHeaderViewport(col){return col.isAutoHeaderHeight()?!0:this.isColumnInRowViewport(col)}isColumnInRowViewport(col){if(col.isAutoHeight())return!0;const columnLeft=col.getLeft()||0,columnRight=columnLeft+col.getActualWidth(),leftBounds=this.viewportLeft-200,rightBounds=this.viewportRight+200,columnToMuchLeft=columnLeft<leftBounds&&columnRight<leftBounds,columnToMuchRight=columnLeft>rightBounds&&columnRight>rightBounds;return!columnToMuchLeft&&!columnToMuchRight}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(keys2,masterList,actionIsAdd,columnCallback,eventType,source){if(!keys2||missingOrEmpty(keys2))return;let atLeastOne=!1;if(keys2.forEach(key=>{if(!key)return;const columnToAdd=this.getPrimaryColumn(key);if(columnToAdd){if(actionIsAdd){if(masterList.indexOf(columnToAdd)>=0)return;masterList.push(columnToAdd)}else{if(masterList.indexOf(columnToAdd)<0)return;removeFromArray(masterList,columnToAdd)}columnCallback(columnToAdd),atLeastOne=!0}}),!atLeastOne)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(source);const event={type:eventType,columns:masterList,column:masterList.length===1?masterList[0]:null,source};this.eventService.dispatchEvent(event)}setRowGroupColumns(colKeys,source){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(colKeys,this.rowGroupColumns,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),source)}setRowGroupActive(active,column,source){active!==column.isRowGroupActive()&&(column.setRowGroupActive(active,source),active&&!this.gridOptionsService.get("suppressRowGroupHidesColumns")&&this.setColumnsVisible([column],!1,source),!active&&!this.gridOptionsService.get("suppressMakeColumnVisibleAfterUnGroup")&&this.setColumnsVisible([column],!0,source))}addRowGroupColumns(keys2,source){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(keys2,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),Events.EVENT_COLUMN_ROW_GROUP_CHANGED,source)}removeRowGroupColumns(keys2,source){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(keys2,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),Events.EVENT_COLUMN_ROW_GROUP_CHANGED,source)}addPivotColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.pivotColumns,!0,column=>column.setPivotActive(!0,source),Events.EVENT_COLUMN_PIVOT_CHANGED,source)}setPivotColumns(colKeys,source){this.setPrimaryColumnList(colKeys,this.pivotColumns,Events.EVENT_COLUMN_PIVOT_CHANGED,!0,(added,column)=>{column.setPivotActive(added,source)},source)}removePivotColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.pivotColumns,!1,column=>column.setPivotActive(!1,source),Events.EVENT_COLUMN_PIVOT_CHANGED,source)}setPrimaryColumnList(colKeys,masterList,eventName,detectOrderChange,columnCallback,source){if(!this.gridColumns)return;const changes=new Map;masterList.forEach((col,idx)=>changes.set(col,idx)),masterList.length=0,exists(colKeys)&&colKeys.forEach(key=>{const column=this.getPrimaryColumn(key);column&&masterList.push(column)}),masterList.forEach((col,idx)=>{const oldIndex=changes.get(col);if(oldIndex===void 0){changes.set(col,0);return}detectOrderChange&&oldIndex!==idx||changes.delete(col)}),(this.primaryColumns||[]).forEach(column=>{const added=masterList.indexOf(column)>=0;columnCallback(added,column)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(source),this.dispatchColumnChangedEvent(eventName,[...changes.keys()],source)}setValueColumns(colKeys,source){this.setPrimaryColumnList(colKeys,this.valueColumns,Events.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),source)}setValueActive(active,column,source){if(active!==column.isValueActive()&&(column.setValueActive(active,source),active&&!column.getAggFunc())){const initialAggFunc=this.aggFuncService.getDefaultAggFunc(column);column.setAggFunc(initialAggFunc)}}addValueColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.valueColumns,!0,this.setValueActive.bind(this,!0),Events.EVENT_COLUMN_VALUE_CHANGED,source)}removeValueColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.valueColumns,!1,this.setValueActive.bind(this,!1),Events.EVENT_COLUMN_VALUE_CHANGED,source)}normaliseColumnWidth(column,newWidth){const minWidth=column.getMinWidth();exists(minWidth)&&newWidth<minWidth&&(newWidth=minWidth);const maxWidth=column.getMaxWidth();return exists(maxWidth)&&column.isGreaterThanMax(newWidth)&&(newWidth=maxWidth),newWidth}getPrimaryOrGridColumn(key){return this.getPrimaryColumn(key)||this.getGridColumn(key)}setColumnWidths(columnWidths,shiftKey,finished,source){const sets=[];columnWidths.forEach(columnWidth=>{const col=this.getPrimaryOrGridColumn(columnWidth.key);if(!col)return;if(sets.push({width:columnWidth.newWidth,ratios:[1],columns:[col]}),this.gridOptionsService.get("colResizeDefault")==="shift"&&(shiftKey=!shiftKey),shiftKey){const otherCol=this.getDisplayedColAfter(col);if(!otherCol)return;const widthDiff=col.getActualWidth()-columnWidth.newWidth,otherColWidth=otherCol.getActualWidth()+widthDiff;sets.push({width:otherColWidth,ratios:[1],columns:[otherCol]})}}),sets.length!==0&&this.resizeColumnSets({resizeSets:sets,finished,source})}checkMinAndMaxWidthsForSet(columnResizeSet){const{columns,width}=columnResizeSet;let minWidthAccumulated=0,maxWidthAccumulated=0,maxWidthActive=!0;columns.forEach(col=>{const minWidth=col.getMinWidth();minWidthAccumulated+=minWidth||0;const maxWidth=col.getMaxWidth();exists(maxWidth)&&maxWidth>0?maxWidthAccumulated+=maxWidth:maxWidthActive=!1});const minWidthPasses=width>=minWidthAccumulated,maxWidthPasses=!maxWidthActive||width<=maxWidthAccumulated;return minWidthPasses&&maxWidthPasses}resizeColumnSets(params){const{resizeSets,finished,source}=params;if(!(!resizeSets||resizeSets.every(columnResizeSet=>this.checkMinAndMaxWidthsForSet(columnResizeSet)))){if(finished){const columns=resizeSets&&resizeSets.length>0?resizeSets[0].columns:null;this.dispatchColumnResizedEvent(columns,finished,source)}return}const changedCols=[],allResizedCols=[];resizeSets.forEach(set=>{const{width,columns,ratios}=set,newWidths={},finishedCols={};columns.forEach(col=>allResizedCols.push(col));let finishedColsGrew=!0,loopCount=0;for(;finishedColsGrew;){if(loopCount++,loopCount>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}finishedColsGrew=!1;const subsetCols=[];let subsetRatioTotal=0,pixelsToDistribute=width;columns.forEach((col,index)=>{if(finishedCols[col.getId()])pixelsToDistribute-=newWidths[col.getId()];else{subsetCols.push(col);const ratioThisCol=ratios[index];subsetRatioTotal+=ratioThisCol}});const ratioScale=1/subsetRatioTotal;subsetCols.forEach((col,index)=>{const lastCol=index===subsetCols.length-1;let colNewWidth;lastCol?colNewWidth=pixelsToDistribute:(colNewWidth=Math.round(ratios[index]*width*ratioScale),pixelsToDistribute-=colNewWidth);const minWidth=col.getMinWidth(),maxWidth=col.getMaxWidth();exists(minWidth)&&colNewWidth<minWidth?(colNewWidth=minWidth,finishedCols[col.getId()]=!0,finishedColsGrew=!0):exists(maxWidth)&&maxWidth>0&&colNewWidth>maxWidth&&(colNewWidth=maxWidth,finishedCols[col.getId()]=!0,finishedColsGrew=!0),newWidths[col.getId()]=colNewWidth})}columns.forEach(col=>{const newWidth=newWidths[col.getId()];col.getActualWidth()!==newWidth&&(col.setActualWidth(newWidth,source),changedCols.push(col))})});const atLeastOneColChanged=changedCols.length>0;let flexedCols=[];atLeastOneColChanged&&(flexedCols=this.refreshFlexedColumns({resizingCols:allResizedCols,skipSetLeft:!0}),this.setLeftValues(source),this.updateBodyWidths(),this.checkViewportColumns());const colsForEvent=allResizedCols.concat(flexedCols);(atLeastOneColChanged||finished)&&this.dispatchColumnResizedEvent(colsForEvent,finished,source,flexedCols)}setColumnAggFunc(key,aggFunc,source){if(!key)return;const column=this.getPrimaryColumn(key);column&&(column.setAggFunc(aggFunc),this.dispatchColumnChangedEvent(Events.EVENT_COLUMN_VALUE_CHANGED,[column],source))}moveRowGroupColumn(fromIndex,toIndex,source){if(this.isRowGroupEmpty())return;const column=this.rowGroupColumns[fromIndex],impactedColumns=this.rowGroupColumns.slice(fromIndex,toIndex);this.rowGroupColumns.splice(fromIndex,1),this.rowGroupColumns.splice(toIndex,0,column);const event={type:Events.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:impactedColumns,column:impactedColumns.length===1?impactedColumns[0]:null,source};this.eventService.dispatchEvent(event)}moveColumns(columnsToMoveKeys,toIndex,source,finished=!0){if(!this.gridColumns)return;if(this.columnAnimationService.start(),toIndex>this.gridColumns.length-columnsToMoveKeys.length){console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+toIndex),console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");return}const movedColumns=this.getGridColumns(columnsToMoveKeys);this.doesMovePassRules(movedColumns,toIndex)&&(moveInArray(this.gridColumns,movedColumns,toIndex),this.updateDisplayedColumns(source),this.dispatchColumnMovedEvent({movedColumns,source,toIndex,finished}),this.columnAnimationService.finish())}doesMovePassRules(columnsToMove,toIndex){const proposedColumnOrder=this.getProposedColumnOrder(columnsToMove,toIndex);return this.doesOrderPassRules(proposedColumnOrder)}doesOrderPassRules(gridOrder){return!(!this.doesMovePassMarryChildren(gridOrder)||!this.doesMovePassLockedPositions(gridOrder))}getProposedColumnOrder(columnsToMove,toIndex){const proposedColumnOrder=this.gridColumns.slice();return moveInArray(proposedColumnOrder,columnsToMove,toIndex),proposedColumnOrder}sortColumnsLikeGridColumns(cols){!cols||cols.length<=1||cols.filter(c=>this.gridColumns.indexOf(c)<0).length>0||cols.sort((a,b)=>{const indexA=this.gridColumns.indexOf(a),indexB=this.gridColumns.indexOf(b);return indexA-indexB})}doesMovePassLockedPositions(proposedColumnOrder){let lastPlacement=0,rulePassed=!0;const lockPositionToPlacement=__name(position=>position?position===!0||position==="left"?0:2:1,"lockPositionToPlacement");return proposedColumnOrder.forEach(col=>{const placement=lockPositionToPlacement(col.getColDef().lockPosition);placement<lastPlacement&&(rulePassed=!1),lastPlacement=placement}),rulePassed}doesMovePassMarryChildren(allColumnsCopy){let rulePassed=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,child=>{if(!(child instanceof ProvidedColumnGroup))return;const columnGroup=child,colGroupDef=columnGroup.getColGroupDef();if(!(colGroupDef&&colGroupDef.marryChildren))return;const newIndexes=[];columnGroup.getLeafColumns().forEach(col=>{const newColIndex=allColumnsCopy.indexOf(col);newIndexes.push(newColIndex)});const maxIndex=Math.max.apply(Math,newIndexes),minIndex=Math.min.apply(Math,newIndexes),spread=maxIndex-minIndex,maxSpread=columnGroup.getLeafColumns().length-1;spread>maxSpread&&(rulePassed=!1)}),rulePassed}moveColumnByIndex(fromIndex,toIndex,source){if(!this.gridColumns)return;const column=this.gridColumns[fromIndex];this.moveColumns([column],toIndex,source)}getColumnDefs(){if(!this.primaryColumns)return;const cols=this.primaryColumns.slice();return this.gridColsArePrimary?cols.sort((a,b)=>this.gridColumns.indexOf(a)-this.gridColumns.indexOf(b)):this.lastPrimaryOrder&&cols.sort((a,b)=>this.lastPrimaryOrder.indexOf(a)-this.lastPrimaryOrder.indexOf(b)),this.columnDefFactory.buildColumnDefs(cols,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(pinned){switch(pinned){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const newBodyWidth=this.getWidthOfColsInList(this.displayedColumnsCenter),newLeftWidth=this.getWidthOfColsInList(this.displayedColumnsLeft),newRightWidth=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==newBodyWidth,this.bodyWidth!==newBodyWidth||this.leftWidth!==newLeftWidth||this.rightWidth!==newRightWidth){this.bodyWidth=newBodyWidth,this.leftWidth=newLeftWidth,this.rightWidth=newRightWidth;const evt={type:Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED};this.eventService.dispatchEvent(evt);const event={type:Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(event)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getDisplayedColumns(type){switch(type){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns:null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns:null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){var _a273;return(_a273=this.gridColumns)!=null?_a273:[]}isEmpty(){return missingOrEmpty(this.gridColumns)}isRowGroupEmpty(){return missingOrEmpty(this.rowGroupColumns)}setColumnsVisible(keys2,visible=!1,source){this.applyColumnState({state:keys2.map(key=>({colId:typeof key=="string"?key:key.getColId(),hide:!visible}))},source)}setColumnsPinned(keys2,pinned,source){if(!this.gridColumns)return;if(this.gridOptionsService.isDomLayout("print")){console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");return}this.columnAnimationService.start();let actualPinned;pinned===!0||pinned==="left"?actualPinned="left":pinned==="right"?actualPinned="right":actualPinned=null,this.actionOnGridColumns(keys2,col=>col.getPinned()!==actualPinned?(col.setPinned(actualPinned),!0):!1,source,()=>({type:Events.EVENT_COLUMN_PINNED,pinned:actualPinned,column:null,columns:null,source})),this.columnAnimationService.finish()}actionOnGridColumns(keys2,action,source,createEvent){if(missingOrEmpty(keys2))return;const updatedColumns=[];if(keys2.forEach(key=>{if(!key)return;const column=this.getGridColumn(key);if(!column)return;action(column)!==!1&&updatedColumns.push(column)}),!!updatedColumns.length&&(this.updateDisplayedColumns(source),exists(createEvent)&&createEvent)){const event=createEvent();event.columns=updatedColumns,event.column=updatedColumns.length===1?updatedColumns[0]:null,this.eventService.dispatchEvent(event)}}getDisplayedColBefore(col){const allDisplayedColumns=this.getAllDisplayedColumns(),oldIndex=allDisplayedColumns.indexOf(col);return oldIndex>0?allDisplayedColumns[oldIndex-1]:null}getDisplayedColAfter(col){const allDisplayedColumns=this.getAllDisplayedColumns(),oldIndex=allDisplayedColumns.indexOf(col);return oldIndex<allDisplayedColumns.length-1?allDisplayedColumns[oldIndex+1]:null}getDisplayedGroupAfter(columnGroup){return this.getDisplayedGroupAtDirection(columnGroup,"After")}getDisplayedGroupBefore(columnGroup){return this.getDisplayedGroupAtDirection(columnGroup,"Before")}getDisplayedGroupAtDirection(columnGroup,direction){const requiredLevel=columnGroup.getProvidedColumnGroup().getLevel()+columnGroup.getPaddingLevel(),colGroupLeafColumns=columnGroup.getDisplayedLeafColumns(),col=direction==="After"?last(colGroupLeafColumns):colGroupLeafColumns[0],getDisplayColMethod=`getDisplayedCol${direction}`;for(;;){const column=this[getDisplayColMethod](col);if(!column)return null;const groupPointer=this.getColumnGroupAtLevel(column,requiredLevel);if(groupPointer!==columnGroup)return groupPointer}}getColumnGroupAtLevel(column,level){let groupPointer=column.getParent(),originalGroupLevel,groupPointerLevel;for(;originalGroupLevel=groupPointer.getProvidedColumnGroup().getLevel(),groupPointerLevel=groupPointer.getPaddingLevel(),!(originalGroupLevel+groupPointerLevel<=level);)groupPointer=groupPointer.getParent();return groupPointer}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(column){const rowGroupIndex=column.isRowGroupActive()?this.rowGroupColumns.indexOf(column):null,pivotIndex=column.isPivotActive()?this.pivotColumns.indexOf(column):null,aggFunc=column.isValueActive()?column.getAggFunc():null,sort=column.getSort()!=null?column.getSort():null,sortIndex=column.getSortIndex()!=null?column.getSortIndex():null,flex=column.getFlex()!=null&&column.getFlex()>0?column.getFlex():null;return{colId:column.getColId(),width:column.getActualWidth(),hide:!column.isVisible(),pinned:column.getPinned(),sort,sortIndex,aggFunc,rowGroup:column.isRowGroupActive(),rowGroupIndex,pivot:column.isPivotActive(),pivotIndex,flex}}getColumnState(){if(missing(this.primaryColumns)||!this.isAlive())return[];const res=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(res),res}orderColumnStateList(columnStateList){const colIdToGridIndexMap=convertToMap(this.gridColumns.map((col,index)=>[col.getColId(),index]));columnStateList.sort((itemA,itemB)=>{const posA=colIdToGridIndexMap.has(itemA.colId)?colIdToGridIndexMap.get(itemA.colId):-1,posB=colIdToGridIndexMap.has(itemB.colId)?colIdToGridIndexMap.get(itemB.colId):-1;return posA-posB})}resetColumnState(source){if(missingOrEmpty(this.primaryColumns))return;const primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),columnStates=[];let letRowGroupIndex=1e3,letPivotIndex=1e3,colsToProcess=[];this.groupAutoColumns&&(colsToProcess=colsToProcess.concat(this.groupAutoColumns)),primaryColumns&&(colsToProcess=colsToProcess.concat(primaryColumns)),colsToProcess.forEach(column=>{const stateItem=this.getColumnStateFromColDef(column);missing(stateItem.rowGroupIndex)&&stateItem.rowGroup&&(stateItem.rowGroupIndex=letRowGroupIndex++),missing(stateItem.pivotIndex)&&stateItem.pivot&&(stateItem.pivotIndex=letPivotIndex++),columnStates.push(stateItem)}),this.applyColumnState({state:columnStates,applyOrder:!0},source)}getColumnStateFromColDef(column){const getValueOrNull=__name((a,b)=>a??b??null,"getValueOrNull"),colDef=column.getColDef(),sort=getValueOrNull(colDef.sort,colDef.initialSort),sortIndex=getValueOrNull(colDef.sortIndex,colDef.initialSortIndex),hide=getValueOrNull(colDef.hide,colDef.initialHide),pinned=getValueOrNull(colDef.pinned,colDef.initialPinned),width=getValueOrNull(colDef.width,colDef.initialWidth),flex=getValueOrNull(colDef.flex,colDef.initialFlex);let rowGroupIndex=getValueOrNull(colDef.rowGroupIndex,colDef.initialRowGroupIndex),rowGroup=getValueOrNull(colDef.rowGroup,colDef.initialRowGroup);rowGroupIndex==null&&(rowGroup==null||rowGroup==!1)&&(rowGroupIndex=null,rowGroup=null);let pivotIndex=getValueOrNull(colDef.pivotIndex,colDef.initialPivotIndex),pivot=getValueOrNull(colDef.pivot,colDef.initialPivot);pivotIndex==null&&(pivot==null||pivot==!1)&&(pivotIndex=null,pivot=null);const aggFunc=getValueOrNull(colDef.aggFunc,colDef.initialAggFunc);return{colId:column.getColId(),sort,sortIndex,hide,pinned,width,flex,rowGroup,rowGroupIndex,pivot,pivotIndex,aggFunc}}applyColumnState(params,source){if(missingOrEmpty(this.primaryColumns))return!1;if(params&&params.state&&!params.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const applyStates=__name((states,existingColumns,getById)=>{const dispatchEventsFunc=this.compareColumnStatesAndDispatchEvents(source);this.autoGroupsNeedBuilding=!0;const columnsWithNoState=existingColumns.slice(),rowGroupIndexes={},pivotIndexes={},autoGroupColumnStates=[],unmatchedAndAutoStates2=[];let unmatchedCount2=0;const previousRowGroupCols=this.rowGroupColumns.slice(),previousPivotCols=this.pivotColumns.slice();states.forEach(state=>{const colId=state.colId||"";if(colId.startsWith(GROUP_AUTO_COLUMN_ID)){autoGroupColumnStates.push(state),unmatchedAndAutoStates2.push(state);return}const column=getById(colId);column?(this.syncColumnWithStateItem(column,state,params.defaultState,rowGroupIndexes,pivotIndexes,!1,source),removeFromArray(columnsWithNoState,column)):(unmatchedAndAutoStates2.push(state),unmatchedCount2+=1)});const applyDefaultsFunc=__name(col=>this.syncColumnWithStateItem(col,null,params.defaultState,rowGroupIndexes,pivotIndexes,!1,source),"applyDefaultsFunc");columnsWithNoState.forEach(applyDefaultsFunc);const comparator=__name((indexes,oldList,colA,colB)=>{const indexA=indexes[colA.getId()],indexB=indexes[colB.getId()],aHasIndex=indexA!=null,bHasIndex=indexB!=null;if(aHasIndex&&bHasIndex)return indexA-indexB;if(aHasIndex)return-1;if(bHasIndex)return 1;const oldIndexA=oldList.indexOf(colA),oldIndexB=oldList.indexOf(colB),aHasOldIndex=oldIndexA>=0,bHasOldIndex=oldIndexB>=0;return aHasOldIndex&&bHasOldIndex?oldIndexA-oldIndexB:aHasOldIndex?-1:1},"comparator");this.rowGroupColumns.sort(comparator.bind(this,rowGroupIndexes,previousRowGroupCols)),this.pivotColumns.sort(comparator.bind(this,pivotIndexes,previousPivotCols)),this.updateGridColumns();const autoGroupColsCopy=this.groupAutoColumns?this.groupAutoColumns.slice():[];return autoGroupColumnStates.forEach(stateItem=>{const autoCol=this.getAutoColumn(stateItem.colId);removeFromArray(autoGroupColsCopy,autoCol),this.syncColumnWithStateItem(autoCol,stateItem,params.defaultState,null,null,!0,source)}),autoGroupColsCopy.forEach(applyDefaultsFunc),this.applyOrderAfterApplyState(params),this.updateDisplayedColumns(source),this.dispatchEverythingChanged(source),dispatchEventsFunc(),{unmatchedAndAutoStates:unmatchedAndAutoStates2,unmatchedCount:unmatchedCount2}},"applyStates");this.columnAnimationService.start();let{unmatchedAndAutoStates,unmatchedCount}=applyStates(params.state||[],this.primaryColumns||[],id=>this.getPrimaryColumn(id));return(unmatchedAndAutoStates.length>0||exists(params.defaultState))&&(unmatchedCount=applyStates(unmatchedAndAutoStates,this.secondaryColumns||[],id=>this.getSecondaryColumn(id)).unmatchedCount),this.columnAnimationService.finish(),unmatchedCount===0}applyOrderAfterApplyState(params){if(!params.applyOrder||!params.state)return;let newOrder=[];const processedColIds={};params.state.forEach(item=>{if(!item.colId||processedColIds[item.colId])return;const col=this.gridColumnsMap[item.colId];col&&(newOrder.push(col),processedColIds[item.colId]=!0)});let autoGroupInsertIndex=0;if(this.gridColumns.forEach(col=>{const colId=col.getColId();if(processedColIds[colId]!=null)return;colId.startsWith(GROUP_AUTO_COLUMN_ID)?insertIntoArray(newOrder,col,autoGroupInsertIndex++):newOrder.push(col)}),newOrder=this.placeLockedColumns(newOrder),!this.doesMovePassMarryChildren(newOrder)){console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");return}this.gridColumns=newOrder}compareColumnStatesAndDispatchEvents(source){const startState={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},columnStateBefore=this.getColumnState(),columnStateBeforeMap={};return columnStateBefore.forEach(col=>{columnStateBeforeMap[col.colId]=col}),()=>{const colsForState=this.getPrimaryAndSecondaryAndAutoColumns(),dispatchWhenListsDifferent=__name((eventType,colsBefore,colsAfter,idMapper)=>{const beforeList=colsBefore.map(idMapper),afterList=colsAfter.map(idMapper);if(areEqual(beforeList,afterList))return;const changes=new Set(colsBefore);colsAfter.forEach(id=>{changes.delete(id)||changes.add(id)});const changesArr=[...changes],event={type:eventType,columns:changesArr,column:changesArr.length===1?changesArr[0]:null,source};this.eventService.dispatchEvent(event)},"dispatchWhenListsDifferent"),getChangedColumns=__name(changedPredicate=>{const changedColumns2=[];return colsForState.forEach(column=>{const colStateBefore=columnStateBeforeMap[column.getColId()];colStateBefore&&changedPredicate(colStateBefore,column)&&changedColumns2.push(column)}),changedColumns2},"getChangedColumns"),columnIdMapper=__name(c=>c.getColId(),"columnIdMapper");dispatchWhenListsDifferent(Events.EVENT_COLUMN_ROW_GROUP_CHANGED,startState.rowGroupColumns,this.rowGroupColumns,columnIdMapper),dispatchWhenListsDifferent(Events.EVENT_COLUMN_PIVOT_CHANGED,startState.pivotColumns,this.pivotColumns,columnIdMapper);const changedValues=getChangedColumns(__name((cs,c)=>{const oldActive=cs.aggFunc!=null,activeChanged=oldActive!=c.isValueActive(),aggFuncChanged=oldActive&&cs.aggFunc!=c.getAggFunc();return activeChanged||aggFuncChanged},"valueChangePredicate"));changedValues.length>0&&this.dispatchColumnChangedEvent(Events.EVENT_COLUMN_VALUE_CHANGED,changedValues,source);const resizeChangePredicate=__name((cs,c)=>cs.width!=c.getActualWidth(),"resizeChangePredicate");this.dispatchColumnResizedEvent(getChangedColumns(resizeChangePredicate),!0,source);const pinnedChangePredicate=__name((cs,c)=>cs.pinned!=c.getPinned(),"pinnedChangePredicate");this.dispatchColumnPinnedEvent(getChangedColumns(pinnedChangePredicate),source);const visibilityChangePredicate=__name((cs,c)=>cs.hide==c.isVisible(),"visibilityChangePredicate");this.dispatchColumnVisibleEvent(getChangedColumns(visibilityChangePredicate),source);const changedColumns=getChangedColumns(__name((cs,c)=>cs.sort!=c.getSort()||cs.sortIndex!=c.getSortIndex(),"sortChangePredicate"));changedColumns.length>0&&this.sortController.dispatchSortChangedEvents(source,changedColumns),this.normaliseColumnMovedEventForColumnState(columnStateBefore,source)}}getCommonValue(cols,valueGetter){if(!cols||cols.length==0)return;const firstValue=valueGetter(cols[0]);for(let i=1;i<cols.length;i++)if(firstValue!==valueGetter(cols[i]))return;return firstValue}normaliseColumnMovedEventForColumnState(colStateBefore,source){const colStateAfter=this.getColumnState(),colStateAfterMapped={};colStateAfter.forEach(s=>colStateAfterMapped[s.colId]=s);const colsIntersectIds={};colStateBefore.forEach(s=>{colStateAfterMapped[s.colId]&&(colsIntersectIds[s.colId]=!0)});const beforeFiltered=colStateBefore.filter(c=>colsIntersectIds[c.colId]),afterFiltered=colStateAfter.filter(c=>colsIntersectIds[c.colId]),movedColumns=[];afterFiltered.forEach((csAfter,index)=>{const csBefore=beforeFiltered&&beforeFiltered[index];if(csBefore&&csBefore.colId!==csAfter.colId){const gridCol=this.getGridColumn(csBefore.colId);gridCol&&movedColumns.push(gridCol)}}),movedColumns.length&&this.dispatchColumnMovedEvent({movedColumns,source,finished:!0})}syncColumnWithStateItem(column,stateItem,defaultState,rowGroupIndexes,pivotIndexes,autoCol,source){if(!column)return;const getValue=__name((key1,key2)=>{const obj={value1:void 0,value2:void 0};let calculated=!1;return stateItem&&(stateItem[key1]!==void 0&&(obj.value1=stateItem[key1],calculated=!0),exists(key2)&&stateItem[key2]!==void 0&&(obj.value2=stateItem[key2],calculated=!0)),!calculated&&defaultState&&(defaultState[key1]!==void 0&&(obj.value1=defaultState[key1]),exists(key2)&&defaultState[key2]!==void 0&&(obj.value2=defaultState[key2])),obj},"getValue"),hide=getValue("hide").value1;hide!==void 0&&column.setVisible(!hide,source);const pinned=getValue("pinned").value1;pinned!==void 0&&column.setPinned(pinned);const minColWidth=this.columnUtils.calculateColMinWidth(column.getColDef()),flex=getValue("flex").value1;if(flex!==void 0&&column.setFlex(flex),flex==null){const width=getValue("width").value1;width!=null&&minColWidth!=null&&width>=minColWidth&&column.setActualWidth(width,source)}const sort=getValue("sort").value1;sort!==void 0&&(sort==="desc"||sort==="asc"?column.setSort(sort,source):column.setSort(void 0,source));const sortIndex=getValue("sortIndex").value1;if(sortIndex!==void 0&&column.setSortIndex(sortIndex),autoCol||!column.isPrimary())return;const aggFunc=getValue("aggFunc").value1;aggFunc!==void 0&&(typeof aggFunc=="string"?(column.setAggFunc(aggFunc),column.isValueActive()||(column.setValueActive(!0,source),this.valueColumns.push(column))):(exists(aggFunc)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),column.isValueActive()&&(column.setValueActive(!1,source),removeFromArray(this.valueColumns,column))));const{value1:rowGroup,value2:rowGroupIndex}=getValue("rowGroup","rowGroupIndex");(rowGroup!==void 0||rowGroupIndex!==void 0)&&(typeof rowGroupIndex=="number"||rowGroup?(column.isRowGroupActive()||(column.setRowGroupActive(!0,source),this.rowGroupColumns.push(column)),rowGroupIndexes&&typeof rowGroupIndex=="number"&&(rowGroupIndexes[column.getId()]=rowGroupIndex)):column.isRowGroupActive()&&(column.setRowGroupActive(!1,source),removeFromArray(this.rowGroupColumns,column)));const{value1:pivot,value2:pivotIndex}=getValue("pivot","pivotIndex");(pivot!==void 0||pivotIndex!==void 0)&&(typeof pivotIndex=="number"||pivot?(column.isPivotActive()||(column.setPivotActive(!0,source),this.pivotColumns.push(column)),pivotIndexes&&typeof pivotIndex=="number"&&(pivotIndexes[column.getId()]=pivotIndex)):column.isPivotActive()&&(column.setPivotActive(!1,source),removeFromArray(this.pivotColumns,column)))}getGridColumns(keys2){return this.getColumns(keys2,this.getGridColumn.bind(this))}getColumns(keys2,columnLookupCallback){const foundColumns=[];return keys2&&keys2.forEach(key=>{const column=columnLookupCallback(key);column&&foundColumns.push(column)}),foundColumns}getColumnWithValidation(key){if(key==null)return null;const column=this.getGridColumn(key);return column||console.warn("AG Grid: could not find column "+key),column}getPrimaryColumn(key){return this.primaryColumns?this.getColumn(key,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(key){return this.getColumn(key,this.gridColumns,this.gridColumnsMap)}lookupGridColumn(key){return this.gridColumnsMap[key]}getSecondaryColumn(key){return this.secondaryColumns?this.getColumn(key,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(key,columnList,columnMap){if(!key||!columnMap)return null;if(typeof key=="string"&&columnMap[key])return columnMap[key];for(let i=0;i<columnList.length;i++)if(this.columnsMatch(columnList[i],key))return columnList[i];return this.getAutoColumn(key)}getSourceColumnsForGroupColumn(groupCol){const sourceColumnId=groupCol.getColDef().showRowGroup;if(!sourceColumnId)return null;if(sourceColumnId===!0)return this.rowGroupColumns.slice(0);const column=this.getPrimaryColumn(sourceColumnId);return column?[column]:null}getAutoColumn(key){return!this.groupAutoColumns||!exists(this.groupAutoColumns)||missing(this.groupAutoColumns)?null:this.groupAutoColumns.find(groupCol=>this.columnsMatch(groupCol,key))||null}columnsMatch(column,key){const columnMatches=column===key,colDefMatches=column.getColDef()===key,idMatches=column.getColId()==key;return columnMatches||colDefMatches||idMatches}getDisplayNameForColumn(column,location,includeAggFunc=!1){if(!column)return null;const headerName=this.getHeaderName(column.getColDef(),column,null,null,location);return includeAggFunc?this.wrapHeaderNameWithAggFunc(column,headerName):headerName}getDisplayNameForProvidedColumnGroup(columnGroup,providedColumnGroup,location){const colGroupDef=providedColumnGroup?providedColumnGroup.getColGroupDef():null;return colGroupDef?this.getHeaderName(colGroupDef,null,columnGroup,providedColumnGroup,location):null}getDisplayNameForColumnGroup(columnGroup,location){return this.getDisplayNameForProvidedColumnGroup(columnGroup,columnGroup.getProvidedColumnGroup(),location)}getHeaderName(colDef,column,columnGroup,providedColumnGroup,location){const headerValueGetter=colDef.headerValueGetter;if(headerValueGetter){const params=this.gridOptionsService.addGridCommonParams({colDef,column,columnGroup,providedColumnGroup,location});return typeof headerValueGetter=="function"?headerValueGetter(params):typeof headerValueGetter=="string"?this.expressionService.evaluate(headerValueGetter,params):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}else{if(colDef.headerName!=null)return colDef.headerName;if(colDef.field)return camelCaseToHumanText(colDef.field)}return""}wrapHeaderNameWithAggFunc(column,headerName){if(this.gridOptionsService.get("suppressAggFuncInHeader"))return headerName;const pivotValueColumn=column.getColDef().pivotValueColumn,pivotActiveOnThisColumn=exists(pivotValueColumn);let aggFunc=null,aggFuncFound;if(pivotActiveOnThisColumn){const isCollapsedHeaderEnabled=this.gridOptionsService.get("removePivotHeaderRowWhenSingleValueColumn")&&this.valueColumns.length===1,isTotalColumn=column.getColDef().pivotTotalColumnIds!==void 0;if(isCollapsedHeaderEnabled&&!isTotalColumn)return headerName;aggFunc=pivotValueColumn?pivotValueColumn.getAggFunc():null,aggFuncFound=!0}else{const measureActive=column.isValueActive(),aggregationPresent=this.pivotMode||!this.isRowGroupEmpty();measureActive&&aggregationPresent?(aggFunc=column.getAggFunc(),aggFuncFound=!0):aggFuncFound=!1}if(aggFuncFound){const aggFuncString=typeof aggFunc=="string"?aggFunc:"func";return`${this.localeService.getLocaleTextFunc()(aggFuncString,aggFuncString)}(${headerName})`}return headerName}getColumnGroup(colId,partId){if(!colId)return null;if(colId instanceof ColumnGroup)return colId;const allColumnGroups=this.getAllDisplayedTrees(),checkPartId=typeof partId=="number";let result=null;return this.columnUtils.depthFirstAllColumnTreeSearch(allColumnGroups,child=>{if(child instanceof ColumnGroup){const columnGroup=child;let matched;checkPartId?matched=colId===columnGroup.getGroupId()&&partId===columnGroup.getPartId():matched=colId===columnGroup.getGroupId(),matched&&(result=columnGroup)}}),result}isReady(){return this.ready}extractValueColumns(source,oldPrimaryColumns){this.valueColumns=this.extractColumns(oldPrimaryColumns,this.valueColumns,(col,flag)=>col.setValueActive(flag,source),()=>{},()=>{},colDef=>{const aggFunc=colDef.aggFunc;if(aggFunc===null||aggFunc==="")return null;if(aggFunc!==void 0)return!!aggFunc},colDef=>colDef.initialAggFunc!=null&&colDef.initialAggFunc!=""),this.valueColumns.forEach(col=>{const colDef=col.getColDef();colDef.aggFunc!=null&&colDef.aggFunc!=""?col.setAggFunc(colDef.aggFunc):col.getAggFunc()||col.setAggFunc(colDef.initialAggFunc)})}extractRowGroupColumns(source,oldPrimaryColumns){this.rowGroupColumns=this.extractColumns(oldPrimaryColumns,this.rowGroupColumns,(col,flag)=>col.setRowGroupActive(flag,source),colDef=>colDef.rowGroupIndex,colDef=>colDef.initialRowGroupIndex,colDef=>colDef.rowGroup,colDef=>colDef.initialRowGroup)}extractColumns(oldPrimaryColumns=[],previousCols=[],setFlagFunc,getIndexFunc,getInitialIndexFunc,getValueFunc,getInitialValueFunc){const colsWithIndex=[],colsWithValue=[];(this.primaryColumns||[]).forEach(col=>{const colIsNew=oldPrimaryColumns.indexOf(col)<0,colDef=col.getColDef(),value=attrToBoolean(getValueFunc(colDef)),initialValue=attrToBoolean(getInitialValueFunc(colDef)),index=attrToNumber(getIndexFunc(colDef)),initialIndex=attrToNumber(getInitialIndexFunc(colDef));let include;value!==void 0?include=value:index!==void 0?index===null?include=!1:include=index>=0:colIsNew?initialValue!==void 0?include=initialValue:initialIndex!==void 0?include=initialIndex!=null&&initialIndex>=0:include=!1:include=previousCols.indexOf(col)>=0,include&&((colIsNew?index!=null||initialIndex!=null:index!=null)?colsWithIndex.push(col):colsWithValue.push(col))});const getIndexForCol=__name(col=>{const index=getIndexFunc(col.getColDef()),defaultIndex=getInitialIndexFunc(col.getColDef());return index??defaultIndex},"getIndexForCol");colsWithIndex.sort((colA,colB)=>{const indexA=getIndexForCol(colA),indexB=getIndexForCol(colB);return indexA===indexB?0:indexA<indexB?-1:1});const res=[].concat(colsWithIndex);return previousCols.forEach(col=>{colsWithValue.indexOf(col)>=0&&res.push(col)}),colsWithValue.forEach(col=>{res.indexOf(col)<0&&res.push(col)}),previousCols.forEach(col=>{res.indexOf(col)<0&&setFlagFunc(col,!1)}),res.forEach(col=>{previousCols.indexOf(col)<0&&setFlagFunc(col,!0)}),res}extractPivotColumns(source,oldPrimaryColumns){this.pivotColumns=this.extractColumns(oldPrimaryColumns,this.pivotColumns,(col,flag)=>col.setPivotActive(flag,source),colDef=>colDef.pivotIndex,colDef=>colDef.initialPivotIndex,colDef=>colDef.pivot,colDef=>colDef.initialPivot)}resetColumnGroupState(source){if(!this.primaryColumnTree)return;const stateItems=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,child=>{if(child instanceof ProvidedColumnGroup){const colGroupDef=child.getColGroupDef(),groupState={groupId:child.getGroupId(),open:colGroupDef?colGroupDef.openByDefault:void 0};stateItems.push(groupState)}}),this.setColumnGroupState(stateItems,source)}getColumnGroupState(){const columnGroupState=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,node=>{node instanceof ProvidedColumnGroup&&columnGroupState.push({groupId:node.getGroupId(),open:node.isExpanded()})}),columnGroupState}setColumnGroupState(stateItems,source){if(!this.gridBalancedTree)return;this.columnAnimationService.start();const impactedGroups=[];if(stateItems.forEach(stateItem=>{const groupKey=stateItem.groupId,newValue=stateItem.open,providedColumnGroup=this.getProvidedColumnGroup(groupKey);providedColumnGroup&&providedColumnGroup.isExpanded()!==newValue&&(this.logger.log("columnGroupOpened("+providedColumnGroup.getGroupId()+","+newValue+")"),providedColumnGroup.setExpanded(newValue),impactedGroups.push(providedColumnGroup))}),this.updateGroupsAndDisplayedColumns(source),this.setFirstRightAndLastLeftPinned(source),impactedGroups.length){const event={type:Events.EVENT_COLUMN_GROUP_OPENED,columnGroup:ProvidedColumnGroup.length===1?impactedGroups[0]:void 0,columnGroups:impactedGroups};this.eventService.dispatchEvent(event)}this.columnAnimationService.finish()}setColumnGroupOpened(key,newValue,source){let keyAsString;key instanceof ProvidedColumnGroup?keyAsString=key.getId():keyAsString=key||"",this.setColumnGroupState([{groupId:keyAsString,open:newValue}],source)}getProvidedColumnGroup(key){typeof key!="string"&&console.error("AG Grid: group key must be a string");let res=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,node=>{node instanceof ProvidedColumnGroup&&node.getId()===key&&(res=node)}),res}calculateColumnsForDisplay(){let columnsForDisplay;return this.pivotMode&&missing(this.secondaryColumns)?columnsForDisplay=this.gridColumns.filter(column=>{const isAutoGroupCol=this.groupAutoColumns&&includes(this.groupAutoColumns,column),isValueCol=this.valueColumns&&includes(this.valueColumns,column);return isAutoGroupCol||isValueCol}):columnsForDisplay=this.gridColumns.filter(column=>this.groupAutoColumns&&includes(this.groupAutoColumns,column)||column.isVisible()),columnsForDisplay}checkColSpanActiveInCols(columns){let result=!1;return columns.forEach(col=>{exists(col.getColDef().colSpan)&&(result=!0)}),result}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};const checkFunc=__name(col=>{const colDef=col.getColDef(),underlyingColumn=colDef.showRowGroup;colDef&&exists(underlyingColumn)&&(this.groupDisplayColumns.push(col),typeof underlyingColumn=="string"?this.groupDisplayColumnsMap[underlyingColumn]=col:underlyingColumn===!0&&this.getRowGroupColumns().forEach(rowGroupCol=>{this.groupDisplayColumnsMap[rowGroupCol.getId()]=col}))},"checkFunc");this.gridColumns.forEach(checkFunc)}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(rowGroupColumnId){return this.groupDisplayColumnsMap[rowGroupColumnId]}updateDisplayedColumns(source){const columnsForDisplay=this.calculateColumnsForDisplay();this.buildDisplayedTrees(columnsForDisplay),this.updateGroupsAndDisplayedColumns(source),this.setFirstRightAndLastLeftPinned(source)}isSecondaryColumnsPresent(){return exists(this.secondaryColumns)}setSecondaryColumns(colDefs,source){if(!this.gridColumns)return;const newColsPresent=colDefs;if(!(!newColsPresent&&missing(this.secondaryColumns))){if(newColsPresent){this.processSecondaryColumnDefinitions(colDefs);const balancedTreeResult=this.columnFactory.createColumnTree(colDefs,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0,source);this.destroyOldColumns(this.secondaryBalancedTree,balancedTreeResult.columnTree),this.secondaryBalancedTree=balancedTreeResult.columnTree,this.secondaryHeaderRowCount=balancedTreeResult.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(col=>this.secondaryColumnsMap[col.getId()]=col),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(source)}}processSecondaryColumnDefinitions(colDefs){const columnCallback=this.gridOptionsService.get("processPivotResultColDef"),groupCallback=this.gridOptionsService.get("processPivotResultColGroupDef");if(!columnCallback&&!groupCallback)return;const searchForColDefs=__name(colDefs2=>{colDefs2.forEach(abstractColDef=>{if(exists(abstractColDef.children)){const colGroupDef=abstractColDef;groupCallback&&groupCallback(colGroupDef),searchForColDefs(colGroupDef.children)}else columnCallback&&columnCallback(abstractColDef)})},"searchForColDefs");colDefs&&searchForColDefs(colDefs)}updateGridColumns(){const prevGridCols=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.createGroupAutoColumnsIfNeeded()){const groupAutoColsMap=convertToMap(this.groupAutoColumns.map(col=>[col,!0]));this.lastPrimaryOrder&&(this.lastPrimaryOrder=this.lastPrimaryOrder.filter(col=>!groupAutoColsMap.has(col)),this.lastPrimaryOrder=[...this.groupAutoColumns,...this.lastPrimaryOrder]),this.lastSecondaryOrder&&(this.lastSecondaryOrder=this.lastSecondaryOrder.filter(col=>!groupAutoColsMap.has(col)),this.lastSecondaryOrder=[...this.groupAutoColumns,...this.lastSecondaryOrder])}let sortOrderToRecover;if(this.secondaryColumns&&this.secondaryBalancedTree){const hasSameColumns=this.secondaryColumns.some(col=>this.gridColumnsMap[col.getColId()]!==void 0);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,hasSameColumns&&(sortOrderToRecover=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,sortOrderToRecover=this.lastPrimaryOrder);if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(sortOrderToRecover),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(col=>this.gridColumnsMap[col.getId()]=col),this.setAutoHeightActive(),!areEqual(prevGridCols,this.gridBalancedTree)){const event={type:Events.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(event)}}setAutoHeightActive(){this.autoHeightActive=this.gridColumns.filter(col=>col.isAutoHeight()).length>0,this.autoHeightActive&&(this.autoHeightActiveAtLeastOnce=!0,this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide")||warnOnce("autoHeight columns only work with Client Side Row Model and Server Side Row Model."))}orderGridColsLike(colsOrder){if(missing(colsOrder))return;const lastOrderMapped=convertToMap(colsOrder.map((col,index)=>[col,index]));let noColsFound=!0;if(this.gridColumns.forEach(col=>{lastOrderMapped.has(col)&&(noColsFound=!1)}),noColsFound)return;const gridColsMap=convertToMap(this.gridColumns.map(col=>[col,!0])),oldColsOrdered=colsOrder.filter(col=>gridColsMap.has(col)),oldColsMap=convertToMap(oldColsOrdered.map(col=>[col,!0])),newColsOrdered=this.gridColumns.filter(col=>!oldColsMap.has(col)),newGridColumns=oldColsOrdered.slice();newColsOrdered.forEach(newCol=>{let parent=newCol.getOriginalParent();if(!parent){newGridColumns.push(newCol);return}const siblings=[];for(;!siblings.length&&parent;)parent.getLeafColumns().forEach(leafCol=>{const presentInNewGriColumns=newGridColumns.indexOf(leafCol)>=0,noYetInSiblings=siblings.indexOf(leafCol)<0;presentInNewGriColumns&&noYetInSiblings&&siblings.push(leafCol)}),parent=parent.getOriginalParent();if(!siblings.length){newGridColumns.push(newCol);return}const indexes=siblings.map(col=>newGridColumns.indexOf(col)),lastIndex=Math.max(...indexes);insertIntoArray(newGridColumns,newCol,lastIndex+1)}),this.gridColumns=newGridColumns}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var _a273;let columnsForQuickFilter=(_a273=this.isPivotMode()?this.secondaryColumns:this.primaryColumns)!=null?_a273:[];this.groupAutoColumns&&(columnsForQuickFilter=columnsForQuickFilter.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gridOptionsService.get("includeHiddenColumnsInQuickFilter")?columnsForQuickFilter:columnsForQuickFilter.filter(col=>col.isVisible()||col.isRowGroupActive())}placeLockedColumns(cols){const left=[],normal=[],right=[];return cols.forEach(col=>{const position=col.getColDef().lockPosition;position==="right"?right.push(col):position==="left"||position===!0?left.push(col):normal.push(col)}),[...left,...normal,...right]}addAutoGroupToGridColumns(){if(missing(this.groupAutoColumns)){this.destroyOldColumns(this.groupAutoColsBalancedTree),this.groupAutoColsBalancedTree=null;return}this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const newAutoColsTree=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,newAutoColsTree),this.groupAutoColsBalancedTree=newAutoColsTree,this.gridBalancedTree=newAutoColsTree.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.ariaOrderColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(source){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(source),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const event={type:Events.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(event)}deriveDisplayedColumns(source){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinColumnsAriaOrder(),this.joinDisplayedColumns(),this.setLeftValues(source),this.displayedAutoHeightCols=this.displayedColumns.filter(col=>col.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinColumnsAriaOrder(){const allColumns=this.getAllGridColumns(),pinnedLeft=[],center=[],pinnedRight=[];for(const col of allColumns){const pinned=col.getPinned();pinned?pinned===!0||pinned==="left"?pinnedLeft.push(col):pinnedRight.push(col):center.push(col)}this.ariaOrderColumns=pinnedLeft.concat(center).concat(pinnedRight)}joinDisplayedColumns(){this.gridOptionsService.get("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(source){this.setLeftValuesOfColumns(source),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(source){if(!this.primaryColumns)return;const allColumns=this.getPrimaryAndSecondaryAndAutoColumns().slice(0),doingRtl=this.gridOptionsService.get("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(columns=>{if(doingRtl){let left=this.getWidthOfColsInList(columns);columns.forEach(column=>{left-=column.getActualWidth(),column.setLeft(left,source)})}else{let left=0;columns.forEach(column=>{column.setLeft(left,source),left+=column.getActualWidth()})}removeAllFromUnorderedArray(allColumns,columns)}),allColumns.forEach(column=>{column.setLeft(null,source)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(columns=>{columns.forEach(column=>{column instanceof ColumnGroup&&column.checkLeft()})})}derivedDisplayedColumnsFromDisplayedTree(tree,columns){columns.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(tree,child=>{child instanceof Column&&columns.push(child)})}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}extractViewportColumns(){this.isColumnVirtualisationSuppressed()?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(type,dept){let result;switch(type){case"left":result=this.viewportRowLeft[dept];break;case"right":result=this.viewportRowRight[dept];break;default:result=this.viewportRowCenter[dept];break}return missing(result)&&(result=[]),result}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const virtualColIds={};this.headerViewportColumns.forEach(col=>virtualColIds[col.getId()]=!0);const testGroup=__name((children,result,dept)=>{let returnValue=!1;for(let i=0;i<children.length;i++){const child=children[i];let addThisItem=!1;if(child instanceof Column)addThisItem=virtualColIds[child.getId()]===!0;else{const displayedChildren=child.getDisplayedChildren();displayedChildren&&(addThisItem=testGroup(displayedChildren,result,dept+1))}addThisItem&&(returnValue=!0,result[dept]||(result[dept]=[]),result[dept].push(child))}return returnValue},"testGroup");testGroup(this.displayedTreeLeft,this.viewportRowLeft,0),testGroup(this.displayedTreeRight,this.viewportRowRight,0),testGroup(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){const hashColumn=__name(c=>`${c.getId()}-${c.getPinned()||"normal"}`,"hashColumn");this.extractViewportColumns();const newHash=this.viewportColumns.map(hashColumn).join("#"),changed=this.viewportColumnsHash!==newHash;return changed&&(this.viewportColumnsHash=newHash,this.calculateHeaderRows()),changed}refreshFlexedColumns(params={}){var _a273;const source=params.source?params.source:"flex";if(params.viewportWidth!=null&&(this.flexViewportWidth=params.viewportWidth),!this.flexViewportWidth)return[];let flexAfterDisplayIndex=-1;if(params.resizingCols){const allResizingCols=new Set(params.resizingCols);let displayedCols=this.displayedColumnsCenter;for(let i=displayedCols.length-1;i>=0;i--)if(allResizingCols.has(displayedCols[i])){flexAfterDisplayIndex=i;break}}let knownColumnsWidth=0,flexingColumns=[],minimumFlexedWidth=0,totalFlex=0;for(let i=0;i<this.displayedColumnsCenter.length;i++)this.displayedColumnsCenter[i].getFlex()&&i>flexAfterDisplayIndex?(flexingColumns.push(this.displayedColumnsCenter[i]),totalFlex+=this.displayedColumnsCenter[i].getFlex(),minimumFlexedWidth+=(_a273=this.displayedColumnsCenter[i].getMinWidth())!=null?_a273:0):knownColumnsWidth+=this.displayedColumnsCenter[i].getActualWidth();if(!flexingColumns.length)return[];let changedColumns=[];knownColumnsWidth+minimumFlexedWidth>this.flexViewportWidth&&(flexingColumns.forEach(col=>{var _a274;return col.setActualWidth((_a274=col.getMinWidth())!=null?_a274:0,source)}),changedColumns=flexingColumns,flexingColumns=[]);const flexingColumnSizes=[];let spaceForFlexingColumns;outer:for(;;){spaceForFlexingColumns=this.flexViewportWidth-knownColumnsWidth;const spacePerFlex=spaceForFlexingColumns/totalFlex;for(let i=0;i<flexingColumns.length;i++){const col=flexingColumns[i],widthByFlexRule=spacePerFlex*col.getFlex();let constrainedWidth=0;const minWidth=col.getMinWidth(),maxWidth=col.getMaxWidth();if(exists(minWidth)&&widthByFlexRule<minWidth?constrainedWidth=minWidth:exists(maxWidth)&&widthByFlexRule>maxWidth&&(constrainedWidth=maxWidth),constrainedWidth){col.setActualWidth(constrainedWidth,source),removeFromUnorderedArray(flexingColumns,col),totalFlex-=col.getFlex(),changedColumns.push(col),knownColumnsWidth+=col.getActualWidth();continue outer}flexingColumnSizes[i]=Math.round(widthByFlexRule)}break}let remainingSpace=spaceForFlexingColumns;return flexingColumns.forEach((col,i)=>{col.setActualWidth(Math.min(flexingColumnSizes[i],remainingSpace),source),changedColumns.push(col),remainingSpace-=flexingColumnSizes[i]}),params.skipSetLeft||this.setLeftValues(source),params.updateBodyWidths&&this.updateBodyWidths(),params.fireResizedEvent&&this.dispatchColumnResizedEvent(changedColumns,!0,source,flexingColumns),flexingColumns}sizeColumnsToFit(gridWidth,source="sizeColumnsToFit",silent,params){var _c,_d,_e,_f,_g;if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(gridWidth,source,silent,params));return}const limitsMap={};params&&((_c=params==null?void 0:params.columnLimits)==null||_c.forEach(_a273=>{var _b=_a273,{key}=_b,dimensions=__objRest(_b,["key"]);limitsMap[typeof key=="string"?key:key.getColId()]=dimensions}));const allDisplayedColumns=this.getAllDisplayedColumns(),doColumnsAlreadyFit=gridWidth===this.getWidthOfColsInList(allDisplayedColumns);if(gridWidth<=0||!allDisplayedColumns.length||doColumnsAlreadyFit)return;const colsToSpread=[],colsToNotSpread=[];allDisplayedColumns.forEach(column=>{column.getColDef().suppressSizeToFit===!0?colsToNotSpread.push(column):colsToSpread.push(column)});const colsToDispatchEventFor=colsToSpread.slice(0);let finishedResizing=!1;const moveToNotSpread=__name(column=>{removeFromArray(colsToSpread,column),colsToNotSpread.push(column)},"moveToNotSpread");for(colsToSpread.forEach(column=>{var _a273,_b;column.resetActualWidth(source);const widthOverride=limitsMap==null?void 0:limitsMap[column.getId()],minOverride=(_a273=widthOverride==null?void 0:widthOverride.minWidth)!=null?_a273:params==null?void 0:params.defaultMinWidth,maxOverride=(_b=widthOverride==null?void 0:widthOverride.maxWidth)!=null?_b:params==null?void 0:params.defaultMaxWidth,colWidth=column.getActualWidth();typeof minOverride=="number"&&colWidth<minOverride?column.setActualWidth(minOverride,source,!0):typeof maxOverride=="number"&&colWidth>maxOverride&&column.setActualWidth(maxOverride,source,!0)});!finishedResizing;){finishedResizing=!0;const availablePixels=gridWidth-this.getWidthOfColsInList(colsToNotSpread);if(availablePixels<=0)colsToSpread.forEach(column=>{var _a273,_b;const widthOverride=(_b=(_a273=limitsMap==null?void 0:limitsMap[column.getId()])==null?void 0:_a273.minWidth)!=null?_b:params==null?void 0:params.defaultMinWidth;if(typeof widthOverride=="number"){column.setActualWidth(widthOverride,source,!0);return}column.setMinimum(source)});else{const scale=availablePixels/this.getWidthOfColsInList(colsToSpread);let pixelsForLastCol=availablePixels;for(let i=colsToSpread.length-1;i>=0;i--){const column=colsToSpread[i],widthOverride=limitsMap==null?void 0:limitsMap[column.getId()],minOverride=(_d=widthOverride==null?void 0:widthOverride.minWidth)!=null?_d:params==null?void 0:params.defaultMinWidth,maxOverride=(_e=widthOverride==null?void 0:widthOverride.maxWidth)!=null?_e:params==null?void 0:params.defaultMaxWidth,colMinWidth=(_f=column.getMinWidth())!=null?_f:0,colMaxWidth=(_g=column.getMaxWidth())!=null?_g:Number.MAX_VALUE,minWidth=typeof minOverride=="number"&&minOverride>colMinWidth?minOverride:column.getMinWidth(),maxWidth=typeof maxOverride=="number"&&maxOverride<colMaxWidth?maxOverride:column.getMaxWidth();let newWidth=Math.round(column.getActualWidth()*scale);exists(minWidth)&&newWidth<minWidth?(newWidth=minWidth,moveToNotSpread(column),finishedResizing=!1):exists(maxWidth)&&newWidth>maxWidth?(newWidth=maxWidth,moveToNotSpread(column),finishedResizing=!1):i===0&&(newWidth=pixelsForLastCol),column.setActualWidth(newWidth,source,!0),pixelsForLastCol-=newWidth}}}colsToDispatchEventFor.forEach(col=>{col.fireColumnWidthChangedEvent(source)}),this.setLeftValues(source),this.updateBodyWidths(),!silent&&this.dispatchColumnResizedEvent(colsToDispatchEventFor,!0,source)}buildDisplayedTrees(visibleColumns){const leftVisibleColumns=[],rightVisibleColumns=[],centerVisibleColumns=[];visibleColumns.forEach(column=>{switch(column.getPinned()){case"left":leftVisibleColumns.push(column);break;case"right":rightVisibleColumns.push(column);break;default:centerVisibleColumns.push(column);break}});const groupInstanceIdCreator=new GroupInstanceIdCreator;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(leftVisibleColumns,groupInstanceIdCreator,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(rightVisibleColumns,groupInstanceIdCreator,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(centerVisibleColumns,groupInstanceIdCreator,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const func=__name(child=>{this.displayedColumnsAndGroupsMap[child.getUniqueId()]=child},"func");this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,func),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,func),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,func)}isDisplayed(item){return this.displayedColumnsAndGroupsMap[item.getUniqueId()]===item}updateOpenClosedVisibilityInColumnGroups(){const allColumnGroups=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(allColumnGroups,child=>{child instanceof ColumnGroup&&child.calculateDisplayedColumns()})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const forceRecreateAutoGroups=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const groupFullWidthRow=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),suppressAutoColumn=this.pivotMode?this.gridOptionsService.get("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.gridOptionsService.get("treeData"))&&!suppressAutoColumn&&!groupFullWidthRow){const newAutoGroupCols=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(newAutoGroupCols,this.groupAutoColumns)||forceRecreateAutoGroups)return this.groupAutoColumns=newAutoGroupCols,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){return this.gridOptionsService.get("groupDisplayType")==="custom"?!0:this.gridOptionsService.get("treeDataDisplayType")==="custom"}autoColsEqual(colsA,colsB){return areEqual(colsA,colsB,(a,b)=>a.getColId()===b.getColId())}getWidthOfColsInList(columnList){return columnList.reduce((width,col)=>width+col.getActualWidth(),0)}getFirstDisplayedColumn(){const isRtl=this.gridOptionsService.get("enableRtl"),queryOrder=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];isRtl&&queryOrder.reverse();for(let i=0;i<queryOrder.length;i++){const container=this[queryOrder[i]]();if(container.length)return isRtl?last(container):container[0]}return null}setColumnHeaderHeight(col,height){if(col.setAutoHeaderHeight(height)){const event={type:Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:col,columns:[col],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(event)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const defaultHeight=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),displayedHeights=this.getAllDisplayedColumns().filter(col=>col.isAutoHeaderHeight()).map(col=>col.getAutoHeaderHeight()||0);return Math.max(defaultHeight,...displayedHeights)}getHeaderHeight(){var _a273;return(_a273=this.gridOptionsService.get("headerHeight"))!=null?_a273:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var _a273;return(_a273=this.gridOptionsService.get("floatingFiltersHeight"))!=null?_a273:this.getHeaderHeight()}getGroupHeaderHeight(){var _a273;return(_a273=this.gridOptionsService.get("groupHeaderHeight"))!=null?_a273:this.getHeaderHeight()}getPivotHeaderHeight(){var _a273;return(_a273=this.gridOptionsService.get("pivotHeaderHeight"))!=null?_a273:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var _a273;return(_a273=this.gridOptionsService.get("pivotGroupHeaderHeight"))!=null?_a273:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(resizeOperation=>resizeOperation()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(column,source){const userColDef=column.getUserProvidedColDef();if(!userColDef)return!1;const newColDef=this.columnFactory.addColumnDefaultAndTypes(userColDef,column.getColId());return column.setColDef(newColDef,userColDef,source),!0}isColumnGroupingLocked(column){const groupLockGroupColumns=this.gridOptionsService.get("groupLockGroupColumns");if(!column.isRowGroupActive()||groupLockGroupColumns===0)return!1;if(groupLockGroupColumns===-1)return!0;const colIndex=this.rowGroupColumns.findIndex(groupCol=>groupCol.getColId()===column.getColId());return groupLockGroupColumns>colIndex}generateColumnStateForRowGroupAndPivotIndexes(updatedRowGroupColumnState,updatedPivotColumnState){let existingColumnStateUpdates={};const orderColumns=__name((updatedColumnState,colList,enableProp,initialEnableProp,indexProp,initialIndexProp)=>{if(!colList.length||!this.primaryColumns)return[];const updatedColIdArray=Object.keys(updatedColumnState),updatedColIds=new Set(updatedColIdArray),newColIds=new Set(updatedColIdArray),allColIds=new Set(colList.map(column=>{const colId=column.getColId();return newColIds.delete(colId),colId}).concat(updatedColIdArray)),colIdsInOriginalOrder=[],originalOrderMap={};let orderIndex=0;for(let i=0;i<this.primaryColumns.length;i++){const colId=this.primaryColumns[i].getColId();allColIds.has(colId)&&(colIdsInOriginalOrder.push(colId),originalOrderMap[colId]=orderIndex++)}let index=1e3,hasAddedNewCols=!1,lastIndex=0;const processPrecedingNewCols=__name(colId=>{const originalOrderIndex=originalOrderMap[colId];for(let i=lastIndex;i<originalOrderIndex;i++){const newColId=colIdsInOriginalOrder[i];newColIds.has(newColId)&&(updatedColumnState[newColId][indexProp]=index++,newColIds.delete(newColId))}lastIndex=originalOrderIndex},"processPrecedingNewCols");colList.forEach(column=>{const colId=column.getColId();if(updatedColIds.has(colId))processPrecedingNewCols(colId),updatedColumnState[colId][indexProp]=index++;else{const colDef=column.getColDef();(colDef[indexProp]===null||colDef[indexProp]===void 0&&colDef[initialIndexProp]==null)&&(hasAddedNewCols||(colDef[enableProp]||colDef[enableProp]===void 0&&colDef[initialEnableProp]?processPrecedingNewCols(colId):(newColIds.forEach(newColId=>{updatedColumnState[newColId][indexProp]=index+originalOrderMap[newColId]}),index+=colIdsInOriginalOrder.length,hasAddedNewCols=!0)),existingColumnStateUpdates[colId]||(existingColumnStateUpdates[colId]={colId}),existingColumnStateUpdates[colId][indexProp]=index++)}})},"orderColumns");return orderColumns(updatedRowGroupColumnState,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),orderColumns(updatedPivotColumnState,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(existingColumnStateUpdates)}onColumnsReady(){const autoSizeStrategy=this.gridOptionsService.get("autoSizeStrategy");if(!autoSizeStrategy)return;const{type}=autoSizeStrategy;setTimeout(()=>{if(type==="fitGridWidth"){const{columnLimits:propColumnLimits,defaultMinWidth,defaultMaxWidth}=autoSizeStrategy,columnLimits=propColumnLimits==null?void 0:propColumnLimits.map(({colId:key,minWidth,maxWidth})=>({key,minWidth,maxWidth}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth,defaultMaxWidth,columnLimits})}else type==="fitProvidedWidth"&&this.sizeColumnsToFit(autoSizeStrategy.width,"sizeColumnsToFit")})}onFirstDataRendered(){const autoSizeStrategy=this.gridOptionsService.get("autoSizeStrategy");if((autoSizeStrategy==null?void 0:autoSizeStrategy.type)!=="fitCellContents")return;const{colIds:columns,skipHeader}=autoSizeStrategy;setTimeout(()=>{columns?this.autoSizeColumns({columns,skipHeader,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",skipHeader)})}},__name(_a14,"ColumnModel"),_a14);__decorateClass([Autowired("expressionService")],ColumnModel.prototype,"expressionService",2);__decorateClass([Autowired("columnFactory")],ColumnModel.prototype,"columnFactory",2);__decorateClass([Autowired("displayedGroupCreator")],ColumnModel.prototype,"displayedGroupCreator",2);__decorateClass([Autowired("ctrlsService")],ColumnModel.prototype,"ctrlsService",2);__decorateClass([Autowired("autoWidthCalculator")],ColumnModel.prototype,"autoWidthCalculator",2);__decorateClass([Autowired("columnUtils")],ColumnModel.prototype,"columnUtils",2);__decorateClass([Autowired("columnAnimationService")],ColumnModel.prototype,"columnAnimationService",2);__decorateClass([Autowired("autoGroupColService")],ColumnModel.prototype,"autoGroupColService",2);__decorateClass([Optional("aggFuncService")],ColumnModel.prototype,"aggFuncService",2);__decorateClass([Optional("valueCache")],ColumnModel.prototype,"valueCache",2);__decorateClass([Optional("animationFrameService")],ColumnModel.prototype,"animationFrameService",2);__decorateClass([Autowired("sortController")],ColumnModel.prototype,"sortController",2);__decorateClass([Autowired("columnDefFactory")],ColumnModel.prototype,"columnDefFactory",2);__decorateClass([PostConstruct],ColumnModel.prototype,"init",1);__decorateClass([PreDestroy],ColumnModel.prototype,"destroyColumns",1);__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],ColumnModel.prototype,"setBeans",1);ColumnModel=__decorateClass([Bean("columnModel")],ColumnModel);function convertSourceType(source){return source==="gridOptionsUpdated"?"gridOptionsChanged":source}__name(convertSourceType,"convertSourceType");var _a15,ColumnUtils=(_a15=class extends BeanStub{calculateColMinWidth(colDef){return colDef.minWidth!=null?colDef.minWidth:this.environment.getMinColWidth()}calculateColMaxWidth(colDef){return colDef.maxWidth!=null?colDef.maxWidth:Number.MAX_SAFE_INTEGER}calculateColInitialWidth(colDef){const minColWidth=this.calculateColMinWidth(colDef),maxColWidth=this.calculateColMaxWidth(colDef);let width;const colDefWidth=attrToNumber(colDef.width),colDefInitialWidth=attrToNumber(colDef.initialWidth);return colDefWidth!=null?width=colDefWidth:colDefInitialWidth!=null?width=colDefInitialWidth:width=200,Math.max(Math.min(width,maxColWidth),minColWidth)}getOriginalPathForColumn(column,originalBalancedTree){const result=[];let found=!1;const recursePath=__name((balancedColumnTree,dept)=>{for(let i=0;i<balancedColumnTree.length;i++){if(found)return;const node=balancedColumnTree[i];node instanceof ProvidedColumnGroup?(recursePath(node.getChildren(),dept+1),result[dept]=node):node===column&&(found=!0)}},"recursePath");return recursePath(originalBalancedTree,0),found?result:null}depthFirstOriginalTreeSearch(parent,tree,callback){tree&&tree.forEach(child=>{child instanceof ProvidedColumnGroup&&this.depthFirstOriginalTreeSearch(child,child.getChildren(),callback),callback(child,parent)})}depthFirstAllColumnTreeSearch(tree,callback){tree&&tree.forEach(child=>{child instanceof ColumnGroup&&this.depthFirstAllColumnTreeSearch(child.getChildren(),callback),callback(child)})}depthFirstDisplayedColumnTreeSearch(tree,callback){tree&&tree.forEach(child=>{child instanceof ColumnGroup&&this.depthFirstDisplayedColumnTreeSearch(child.getDisplayedChildren(),callback),callback(child)})}},__name(_a15,"ColumnUtils"),_a15);ColumnUtils=__decorateClass([Bean("columnUtils")],ColumnUtils);var _a16,DisplayedGroupCreator=(_a16=class extends BeanStub{createDisplayedGroups(sortedVisibleColumns,groupInstanceIdCreator,pinned,oldDisplayedGroups){const oldColumnsMapped=this.mapOldGroupsById(oldDisplayedGroups),topLevelResultCols=[];let groupsOrColsAtCurrentLevel=sortedVisibleColumns;for(;groupsOrColsAtCurrentLevel.length;){const currentlyIterating=groupsOrColsAtCurrentLevel;groupsOrColsAtCurrentLevel=[];let lastGroupedColIdx=0;const createGroupToIndex=__name(to=>{const from=lastGroupedColIdx;lastGroupedColIdx=to;const previousNode=currentlyIterating[from],previousNodeParent=(previousNode instanceof ColumnGroup?previousNode.getProvidedColumnGroup():previousNode).getOriginalParent();if(previousNodeParent==null){for(let i=from;i<to;i++)topLevelResultCols.push(currentlyIterating[i]);return}const newGroup=this.createColumnGroup(previousNodeParent,groupInstanceIdCreator,oldColumnsMapped,pinned);for(let i=from;i<to;i++)newGroup.addChild(currentlyIterating[i]);groupsOrColsAtCurrentLevel.push(newGroup)},"createGroupToIndex");for(let i=1;i<currentlyIterating.length;i++){const thisNode=currentlyIterating[i],thisNodeParent=(thisNode instanceof ColumnGroup?thisNode.getProvidedColumnGroup():thisNode).getOriginalParent(),previousNode=currentlyIterating[lastGroupedColIdx],previousNodeParent=(previousNode instanceof ColumnGroup?previousNode.getProvidedColumnGroup():previousNode).getOriginalParent();thisNodeParent!==previousNodeParent&&createGroupToIndex(i)}lastGroupedColIdx<currentlyIterating.length&&createGroupToIndex(currentlyIterating.length)}return this.setupParentsIntoColumns(topLevelResultCols,null),topLevelResultCols}createColumnGroup(providedGroup,groupInstanceIdCreator,oldColumnsMapped,pinned){const groupId=providedGroup.getGroupId(),instanceId=groupInstanceIdCreator.getInstanceIdForKey(groupId),uniqueId=ColumnGroup.createUniqueId(groupId,instanceId);let columnGroup=oldColumnsMapped[uniqueId];return columnGroup&&columnGroup.getProvidedColumnGroup()!==providedGroup&&(columnGroup=null),exists(columnGroup)?columnGroup.reset():(columnGroup=new ColumnGroup(providedGroup,groupId,instanceId,pinned),this.context.createBean(columnGroup)),columnGroup}mapOldGroupsById(displayedGroups){const result={},recursive=__name(columnsOrGroups=>{columnsOrGroups.forEach(columnOrGroup=>{if(columnOrGroup instanceof ColumnGroup){const columnGroup=columnOrGroup;result[columnOrGroup.getUniqueId()]=columnGroup,recursive(columnGroup.getChildren())}})},"recursive");return displayedGroups&&recursive(displayedGroups),result}setupParentsIntoColumns(columnsOrGroups,parent){columnsOrGroups.forEach(columnsOrGroup=>{if(columnsOrGroup.setParent(parent),columnsOrGroup instanceof ColumnGroup){const columnGroup=columnsOrGroup;this.setupParentsIntoColumns(columnGroup.getChildren(),columnGroup)}})}},__name(_a16,"DisplayedGroupCreator"),_a16);DisplayedGroupCreator=__decorateClass([Bean("displayedGroupCreator")],DisplayedGroupCreator);var INITIAL_GRID_OPTION_KEYS={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,excludeHiddenColumnsFromQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,enableChartToolPanelsButton:!0,suppressChartToolPanelsButton:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressParentsInRowNodes:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,suppressAggAtRootLevel:!0,removePivotHeaderRowWhenSingleValueColumn:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,functionsPassive:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0},_a17,_PropertyKeys=(_a17=class{},__name(_a17,"_PropertyKeys"),_a17);_PropertyKeys.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode"];_PropertyKeys.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy"];_PropertyKeys.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"];_PropertyKeys.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"];_PropertyKeys.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilterAllLevels","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents"];_PropertyKeys.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher"];_PropertyKeys.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems"];_PropertyKeys.FUNCTION_PROPERTIES=[..._PropertyKeys.FUNCTIONAL_PROPERTIES,..._PropertyKeys.CALLBACK_PROPERTIES];_PropertyKeys.ALL_PROPERTIES=[..._PropertyKeys.ARRAY_PROPERTIES,..._PropertyKeys.OBJECT_PROPERTIES,..._PropertyKeys.STRING_PROPERTIES,..._PropertyKeys.NUMBER_PROPERTIES,..._PropertyKeys.FUNCTION_PROPERTIES,..._PropertyKeys.BOOLEAN_PROPERTIES];var PropertyKeys=_PropertyKeys,_a18,_ComponentUtil=(_a18=class{static getCallbackForEvent(eventName){return!eventName||eventName.length<2?eventName:"on"+eventName[0].toUpperCase()+eventName.substring(1)}static getGridOptionKeys(){return this.ALL_PROPERTIES_AND_CALLBACKS}static combineAttributesAndGridOptions(gridOptions,component){typeof gridOptions!="object"&&(gridOptions={});const mergedOptions=__spreadValues({},gridOptions);return _a18.getGridOptionKeys().forEach(key=>{const value=component[key];typeof value<"u"&&value!==_a18.VUE_OMITTED_PROPERTY&&(mergedOptions[key]=value)}),mergedOptions}static processOnChange(changes,api){if(!changes)return;const gridChanges={};let hasChanges=!1;if(Object.keys(changes).filter(key=>_a18.ALL_PROPERTIES_AND_CALLBACKS_SET.has(key)).forEach(key=>{gridChanges[key]=changes[key],hasChanges=!0}),!hasChanges)return;api.__internalUpdateGridOptions(gridChanges);const event={type:Events.EVENT_COMPONENT_STATE_CHANGED};iterateObject(gridChanges,(key,value)=>{event[key]=value}),api.dispatchEvent(event)}},__name(_a18,"_ComponentUtil"),_a18);_ComponentUtil.EVENTS=values(Events);_ComponentUtil.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY";_ComponentUtil.EXCLUDED_INTERNAL_EVENTS=[Events.EVENT_SCROLLBAR_WIDTH_CHANGED,Events.EVENT_CHECKBOX_CHANGED,Events.EVENT_HEIGHT_SCALE_CHANGED,Events.EVENT_BODY_HEIGHT_CHANGED,Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,Events.EVENT_SCROLL_VISIBILITY_CHANGED,Events.EVENT_COLUMN_HOVER_CHANGED,Events.EVENT_FLASH_CELLS,Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,Events.EVENT_DISPLAYED_ROWS_CHANGED,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,Events.EVENT_STORE_UPDATED,Events.EVENT_COLUMN_PANEL_ITEM_DRAG_START,Events.EVENT_COLUMN_PANEL_ITEM_DRAG_END,Events.EVENT_FILL_START,Events.EVENT_FILL_END,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,Events.EVENT_FULL_WIDTH_ROW_FOCUSED,Events.EVENT_HEADER_HEIGHT_CHANGED,Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,Events.EVENT_CELL_FOCUS_CLEARED,Events.EVENT_GRID_STYLES_CHANGED,Events.EVENT_FILTER_DESTROYED,Events.EVENT_ROW_DATA_UPDATE_STARTED,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,Events.EVENT_DATA_TYPES_INFERRED,Events.EVENT_FIELD_VALUE_CHANGED,Events.EVENT_FIELD_PICKER_VALUE_SELECTED,Events.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,Events.EVENT_SUPPRESS_MENU_HIDE_CHANGED,Events.EVENT_SUPPRESS_FIELD_DOT_NOTATION,Events.EVENT_ROW_COUNT_READY,Events.EVENT_SIDE_BAR_UPDATED];_ComponentUtil.PUBLIC_EVENTS=_ComponentUtil.EVENTS.filter(e=>!includes(_ComponentUtil.EXCLUDED_INTERNAL_EVENTS,e));_ComponentUtil.EVENT_CALLBACKS=_ComponentUtil.EVENTS.map(event=>_ComponentUtil.getCallbackForEvent(event));_ComponentUtil.STRING_PROPERTIES=PropertyKeys.STRING_PROPERTIES;_ComponentUtil.OBJECT_PROPERTIES=PropertyKeys.OBJECT_PROPERTIES;_ComponentUtil.ARRAY_PROPERTIES=PropertyKeys.ARRAY_PROPERTIES;_ComponentUtil.NUMBER_PROPERTIES=PropertyKeys.NUMBER_PROPERTIES;_ComponentUtil.BOOLEAN_PROPERTIES=PropertyKeys.BOOLEAN_PROPERTIES;_ComponentUtil.FUNCTION_PROPERTIES=PropertyKeys.FUNCTION_PROPERTIES;_ComponentUtil.ALL_PROPERTIES=PropertyKeys.ALL_PROPERTIES;_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS=[..._ComponentUtil.ALL_PROPERTIES,..._ComponentUtil.EVENT_CALLBACKS];_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS);var ComponentUtil=_ComponentUtil,_a19,AgStackComponentsRegistry=(_a19=class extends BeanStub{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(components){components&&components.forEach(componentMeta=>this.addComponent(componentMeta))}addComponent(componentMeta){const classUpperCase=componentMeta.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[classUpperCase]=componentMeta.componentClass}getComponentClass(htmlTag){return this.componentsMappedByName[htmlTag]}},__name(_a19,"AgStackComponentsRegistry"),_a19);AgStackComponentsRegistry=__decorateClass([Bean("agStackComponentsRegistry")],AgStackComponentsRegistry);var aria_exports={};__export(aria_exports,{getAriaCheckboxStateName:()=>getAriaCheckboxStateName,getAriaLabel:()=>getAriaLabel,getAriaLevel:()=>getAriaLevel,getAriaPosInSet:()=>getAriaPosInSet,getAriaSortState:()=>getAriaSortState,removeAriaExpanded:()=>removeAriaExpanded,removeAriaSort:()=>removeAriaSort,setAriaActiveDescendant:()=>setAriaActiveDescendant,setAriaAtomic:()=>setAriaAtomic,setAriaChecked:()=>setAriaChecked,setAriaColCount:()=>setAriaColCount,setAriaColIndex:()=>setAriaColIndex,setAriaColSpan:()=>setAriaColSpan,setAriaControls:()=>setAriaControls,setAriaDescribedBy:()=>setAriaDescribedBy,setAriaDisabled:()=>setAriaDisabled,setAriaExpanded:()=>setAriaExpanded,setAriaHidden:()=>setAriaHidden,setAriaLabel:()=>setAriaLabel,setAriaLabelledBy:()=>setAriaLabelledBy,setAriaLevel:()=>setAriaLevel,setAriaLive:()=>setAriaLive,setAriaMultiSelectable:()=>setAriaMultiSelectable,setAriaPosInSet:()=>setAriaPosInSet,setAriaRelevant:()=>setAriaRelevant,setAriaRole:()=>setAriaRole,setAriaRowCount:()=>setAriaRowCount,setAriaRowIndex:()=>setAriaRowIndex,setAriaSelected:()=>setAriaSelected,setAriaSetSize:()=>setAriaSetSize,setAriaSort:()=>setAriaSort});function toggleAriaAttribute(element,attribute,value){value==null||typeof value=="string"&&value==""?removeAriaAttribute(element,attribute):setAriaAttribute(element,attribute,value)}__name(toggleAriaAttribute,"toggleAriaAttribute");function setAriaAttribute(element,attribute,value){element.setAttribute(ariaAttributeName(attribute),value.toString())}__name(setAriaAttribute,"setAriaAttribute");function removeAriaAttribute(element,attribute){element.removeAttribute(ariaAttributeName(attribute))}__name(removeAriaAttribute,"removeAriaAttribute");function ariaAttributeName(attribute){return`aria-${attribute}`}__name(ariaAttributeName,"ariaAttributeName");function setAriaRole(element,role){role?element.setAttribute("role",role):element.removeAttribute("role")}__name(setAriaRole,"setAriaRole");function getAriaSortState(sortDirection){let sort;return sortDirection==="asc"?sort="ascending":sortDirection==="desc"?sort="descending":sortDirection==="mixed"?sort="other":sort="none",sort}__name(getAriaSortState,"getAriaSortState");function getAriaLevel(element){return parseInt(element.getAttribute("aria-level"),10)}__name(getAriaLevel,"getAriaLevel");function getAriaPosInSet(element){return parseInt(element.getAttribute("aria-posinset"),10)}__name(getAriaPosInSet,"getAriaPosInSet");function getAriaLabel(element){return element.getAttribute("aria-label")}__name(getAriaLabel,"getAriaLabel");function setAriaLabel(element,label){toggleAriaAttribute(element,"label",label)}__name(setAriaLabel,"setAriaLabel");function setAriaLabelledBy(element,labelledBy){toggleAriaAttribute(element,"labelledby",labelledBy)}__name(setAriaLabelledBy,"setAriaLabelledBy");function setAriaDescribedBy(element,describedby){toggleAriaAttribute(element,"describedby",describedby)}__name(setAriaDescribedBy,"setAriaDescribedBy");function setAriaLive(element,live){toggleAriaAttribute(element,"live",live)}__name(setAriaLive,"setAriaLive");function setAriaAtomic(element,atomic){toggleAriaAttribute(element,"atomic",atomic)}__name(setAriaAtomic,"setAriaAtomic");function setAriaRelevant(element,relevant){toggleAriaAttribute(element,"relevant",relevant)}__name(setAriaRelevant,"setAriaRelevant");function setAriaLevel(element,level){toggleAriaAttribute(element,"level",level)}__name(setAriaLevel,"setAriaLevel");function setAriaDisabled(element,disabled){toggleAriaAttribute(element,"disabled",disabled)}__name(setAriaDisabled,"setAriaDisabled");function setAriaHidden(element,hidden){toggleAriaAttribute(element,"hidden",hidden)}__name(setAriaHidden,"setAriaHidden");function setAriaActiveDescendant(element,descendantId){toggleAriaAttribute(element,"activedescendant",descendantId)}__name(setAriaActiveDescendant,"setAriaActiveDescendant");function setAriaExpanded(element,expanded){setAriaAttribute(element,"expanded",expanded)}__name(setAriaExpanded,"setAriaExpanded");function removeAriaExpanded(element){removeAriaAttribute(element,"expanded")}__name(removeAriaExpanded,"removeAriaExpanded");function setAriaSetSize(element,setsize){setAriaAttribute(element,"setsize",setsize)}__name(setAriaSetSize,"setAriaSetSize");function setAriaPosInSet(element,position){setAriaAttribute(element,"posinset",position)}__name(setAriaPosInSet,"setAriaPosInSet");function setAriaMultiSelectable(element,multiSelectable){setAriaAttribute(element,"multiselectable",multiSelectable)}__name(setAriaMultiSelectable,"setAriaMultiSelectable");function setAriaRowCount(element,rowCount){setAriaAttribute(element,"rowcount",rowCount)}__name(setAriaRowCount,"setAriaRowCount");function setAriaRowIndex(element,rowIndex){setAriaAttribute(element,"rowindex",rowIndex)}__name(setAriaRowIndex,"setAriaRowIndex");function setAriaColCount(element,colCount){setAriaAttribute(element,"colcount",colCount)}__name(setAriaColCount,"setAriaColCount");function setAriaColIndex(element,colIndex){setAriaAttribute(element,"colindex",colIndex)}__name(setAriaColIndex,"setAriaColIndex");function setAriaColSpan(element,colSpan){setAriaAttribute(element,"colspan",colSpan)}__name(setAriaColSpan,"setAriaColSpan");function setAriaSort(element,sort){setAriaAttribute(element,"sort",sort)}__name(setAriaSort,"setAriaSort");function removeAriaSort(element){removeAriaAttribute(element,"sort")}__name(removeAriaSort,"removeAriaSort");function setAriaSelected(element,selected){toggleAriaAttribute(element,"selected",selected)}__name(setAriaSelected,"setAriaSelected");function setAriaChecked(element,checked){setAriaAttribute(element,"checked",checked===void 0?"mixed":checked)}__name(setAriaChecked,"setAriaChecked");function setAriaControls(controllerElement,controlledElement){toggleAriaAttribute(controllerElement,"controls",controlledElement.id),setAriaLabelledBy(controlledElement,controllerElement.id)}__name(setAriaControls,"setAriaControls");function getAriaCheckboxStateName(translate,state){return state===void 0?translate("ariaIndeterminate","indeterminate"):state===!0?translate("ariaChecked","checked"):translate("ariaUnchecked","unchecked")}__name(getAriaCheckboxStateName,"getAriaCheckboxStateName");var browser_exports={};__export(browser_exports,{browserSupportsPreventScroll:()=>browserSupportsPreventScroll,getBodyHeight:()=>getBodyHeight,getBodyWidth:()=>getBodyWidth,getMaxDivHeight:()=>getMaxDivHeight,getSafariVersion:()=>getSafariVersion,getScrollbarWidth:()=>getScrollbarWidth,getTabIndex:()=>getTabIndex,isBrowserChrome:()=>isBrowserChrome,isBrowserFirefox:()=>isBrowserFirefox,isBrowserSafari:()=>isBrowserSafari,isIOSUserAgent:()=>isIOSUserAgent,isInvisibleScrollbar:()=>isInvisibleScrollbar,isMacOsUserAgent:()=>isMacOsUserAgent});var isSafari,safariVersion,isChrome,isFirefox,isMacOs,isIOS,invisibleScrollbar,browserScrollbarWidth;function isBrowserSafari(){return isSafari===void 0&&(isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),isSafari}__name(isBrowserSafari,"isBrowserSafari");function getSafariVersion(){if(safariVersion===void 0)if(isBrowserSafari()){const versionMatch=navigator.userAgent.match(/version\/(\d+)/i);versionMatch&&(safariVersion=versionMatch[1]!=null?parseFloat(versionMatch[1]):0)}else safariVersion=0;return safariVersion}__name(getSafariVersion,"getSafariVersion");function isBrowserChrome(){if(isChrome===void 0){const win=window;isChrome=!!win.chrome&&(!!win.chrome.webstore||!!win.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return isChrome}__name(isBrowserChrome,"isBrowserChrome");function isBrowserFirefox(){return isFirefox===void 0&&(isFirefox=/(firefox)/i.test(navigator.userAgent)),isFirefox}__name(isBrowserFirefox,"isBrowserFirefox");function isMacOsUserAgent(){return isMacOs===void 0&&(isMacOs=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),isMacOs}__name(isMacOsUserAgent,"isMacOsUserAgent");function isIOSUserAgent(){return isIOS===void 0&&(isIOS=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),isIOS}__name(isIOSUserAgent,"isIOSUserAgent");function browserSupportsPreventScroll(){return!isBrowserSafari()||getSafariVersion()>=15}__name(browserSupportsPreventScroll,"browserSupportsPreventScroll");function getTabIndex(el){if(!el)return null;const numberTabIndex=el.tabIndex,tabIndex=el.getAttribute("tabIndex");return numberTabIndex===-1&&(tabIndex===null||tabIndex===""&&!isBrowserFirefox())?null:numberTabIndex.toString()}__name(getTabIndex,"getTabIndex");function getMaxDivHeight(){if(!document.body)return-1;let res=1e6;const testUpTo=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,div=document.createElement("div");for(document.body.appendChild(div);;){const test=res*2;if(div.style.height=test+"px",test>testUpTo||div.clientHeight!==test)break;res=test}return document.body.removeChild(div),res}__name(getMaxDivHeight,"getMaxDivHeight");function getBodyWidth(){var _a273,_b,_c;return(_c=(_a273=document.body)==null?void 0:_a273.clientWidth)!=null?_c:window.innerHeight||((_b=document.documentElement)==null?void 0:_b.clientWidth)||-1}__name(getBodyWidth,"getBodyWidth");function getBodyHeight(){var _a273,_b,_c;return(_c=(_a273=document.body)==null?void 0:_a273.clientHeight)!=null?_c:window.innerHeight||((_b=document.documentElement)==null?void 0:_b.clientHeight)||-1}__name(getBodyHeight,"getBodyHeight");function getScrollbarWidth(){return browserScrollbarWidth==null&&initScrollbarWidthAndVisibility(),browserScrollbarWidth}__name(getScrollbarWidth,"getScrollbarWidth");function initScrollbarWidthAndVisibility(){const body=document.body,div=document.createElement("div");div.style.width=div.style.height="100px",div.style.opacity="0",div.style.overflow="scroll",div.style.msOverflowStyle="scrollbar",div.style.position="absolute",body.appendChild(div);let width=div.offsetWidth-div.clientWidth;width===0&&div.clientWidth===0&&(width=null),div.parentNode&&div.parentNode.removeChild(div),width!=null&&(browserScrollbarWidth=width,invisibleScrollbar=width===0)}__name(initScrollbarWidthAndVisibility,"initScrollbarWidthAndVisibility");function isInvisibleScrollbar(){return invisibleScrollbar==null&&initScrollbarWidthAndVisibility(),invisibleScrollbar}__name(isInvisibleScrollbar,"isInvisibleScrollbar");var date_exports={};__export(date_exports,{dateToFormattedString:()=>dateToFormattedString,parseDateTimeFromString:()=>parseDateTimeFromString,serialiseDate:()=>serialiseDate});var number_exports={};__export(number_exports,{cleanNumber:()=>cleanNumber,createArrayOfNumbers:()=>createArrayOfNumbers,decToHex:()=>decToHex,formatNumberCommas:()=>formatNumberCommas,formatNumberTwoDecimalPlacesAndCommas:()=>formatNumberTwoDecimalPlacesAndCommas,padStartWidthZeros:()=>padStartWidthZeros,sum:()=>sum});function padStartWidthZeros(value,totalStringSize){return value.toString().padStart(totalStringSize,"0")}__name(padStartWidthZeros,"padStartWidthZeros");function createArrayOfNumbers(first,last2){const result=[];for(let i=first;i<=last2;i++)result.push(i);return result}__name(createArrayOfNumbers,"createArrayOfNumbers");function cleanNumber(value){return typeof value=="string"&&(value=parseInt(value,10)),typeof value=="number"?Math.floor(value):null}__name(cleanNumber,"cleanNumber");function decToHex(number,bytes){let hex="";for(let i=0;i<bytes;i++)hex+=String.fromCharCode(number&255),number>>>=8;return hex}__name(decToHex,"decToHex");function formatNumberTwoDecimalPlacesAndCommas(value,thousandSeparator,decimalSeparator){return typeof value!="number"?"":formatNumberCommas(Math.round(value*100)/100,thousandSeparator,decimalSeparator)}__name(formatNumberTwoDecimalPlacesAndCommas,"formatNumberTwoDecimalPlacesAndCommas");function formatNumberCommas(value,thousandSeparator,decimalSeparator){return typeof value!="number"?"":value.toString().replace(".",decimalSeparator).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${thousandSeparator}`)}__name(formatNumberCommas,"formatNumberCommas");function sum(values2){return values2==null?null:values2.reduce((total,value)=>total+value,0)}__name(sum,"sum");function serialiseDate(date,includeTime=!0,separator="-"){if(!date)return null;let serialised=[date.getFullYear(),date.getMonth()+1,date.getDate()].map(part=>padStartWidthZeros(part,2)).join(separator);return includeTime&&(serialised+=" "+[date.getHours(),date.getMinutes(),date.getSeconds()].map(part=>padStartWidthZeros(part,2)).join(":")),serialised}__name(serialiseDate,"serialiseDate");var calculateOrdinal=__name(value=>{if(value>3&&value<21)return"th";switch(value%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},"calculateOrdinal");function dateToFormattedString(date,format="YYYY-MM-DD"){const fullYear=padStartWidthZeros(date.getFullYear(),4),months=["January","February","March","April","May","June","July","August","September","October","November","December"],days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],replace={YYYY:()=>fullYear.slice(fullYear.length-4,fullYear.length),YY:()=>fullYear.slice(fullYear.length-2,fullYear.length),Y:()=>`${date.getFullYear()}`,MMMM:()=>months[date.getMonth()],MMM:()=>months[date.getMonth()].slice(0,3),MM:()=>padStartWidthZeros(date.getMonth()+1,2),Mo:()=>`${date.getMonth()+1}${calculateOrdinal(date.getMonth()+1)}`,M:()=>`${date.getMonth()+1}`,Do:()=>`${date.getDate()}${calculateOrdinal(date.getDate())}`,DD:()=>padStartWidthZeros(date.getDate(),2),D:()=>`${date.getDate()}`,dddd:()=>days[date.getDay()],ddd:()=>days[date.getDay()].slice(0,3),dd:()=>days[date.getDay()].slice(0,2),do:()=>`${date.getDay()}${calculateOrdinal(date.getDay())}`,d:()=>`${date.getDay()}`},regexp=new RegExp(Object.keys(replace).join("|"),"g");return format.replace(regexp,match=>match in replace?replace[match]():match)}__name(dateToFormattedString,"dateToFormattedString");function parseDateTimeFromString(value){if(!value)return null;const[dateStr,timeStr]=value.split(" ");if(!dateStr)return null;const fields=dateStr.split("-").map(f=>parseInt(f,10));if(fields.filter(f=>!isNaN(f)).length!==3)return null;const[year,month,day]=fields,date=new Date(year,month-1,day);if(date.getFullYear()!==year||date.getMonth()!==month-1||date.getDate()!==day)return null;if(!timeStr||timeStr==="00:00:00")return date;const[hours,minutes,seconds]=timeStr.split(":").map(part=>parseInt(part,10));return hours>=0&&hours<24&&date.setHours(hours),minutes>=0&&minutes<60&&date.setMinutes(minutes),seconds>=0&&seconds<60&&date.setSeconds(seconds),date}__name(parseDateTimeFromString,"parseDateTimeFromString");var dom_exports={};__export(dom_exports,{FOCUSABLE_EXCLUDE:()=>FOCUSABLE_EXCLUDE,FOCUSABLE_SELECTOR:()=>FOCUSABLE_SELECTOR,addOrRemoveAttribute:()=>addOrRemoveAttribute,addStylesToElement:()=>addStylesToElement,bindCellRendererToHtmlElement:()=>bindCellRendererToHtmlElement,clearElement:()=>clearElement,copyNodeList:()=>copyNodeList,ensureDomOrder:()=>ensureDomOrder,formatSize:()=>formatSize,getAbsoluteHeight:()=>getAbsoluteHeight,getAbsoluteWidth:()=>getAbsoluteWidth,getElementRectWithOffset:()=>getElementRectWithOffset,getElementSize:()=>getElementSize,getInnerHeight:()=>getInnerHeight,getInnerWidth:()=>getInnerWidth,getScrollLeft:()=>getScrollLeft,insertWithDomOrder:()=>insertWithDomOrder,isElementChildOfClass:()=>isElementChildOfClass,isFocusableFormField:()=>isFocusableFormField,isHorizontalScrollShowing:()=>isHorizontalScrollShowing,isInDOM:()=>isInDOM,isNodeOrElement:()=>isNodeOrElement,isRtlNegativeScroll:()=>isRtlNegativeScroll,isVerticalScrollShowing:()=>isVerticalScrollShowing,isVisible:()=>isVisible,iterateNamedNodeMap:()=>iterateNamedNodeMap,loadTemplate:()=>loadTemplate,nodeListForEach:()=>nodeListForEach,radioCssClass:()=>radioCssClass,removeFromParent:()=>removeFromParent,setDisabled:()=>setDisabled,setDisplayed:()=>setDisplayed,setDomChildOrder:()=>setDomChildOrder,setElementHeight:()=>setElementHeight,setElementWidth:()=>setElementWidth,setFixedHeight:()=>setFixedHeight,setFixedWidth:()=>setFixedWidth,setScrollLeft:()=>setScrollLeft,setVisible:()=>setVisible});var rtlNegativeScroll;function radioCssClass(element,elementClass,otherElementClass){const parent=element.parentElement;let sibling=parent&&parent.firstChild;for(;sibling;)elementClass&&sibling.classList.toggle(elementClass,sibling===element),otherElementClass&&sibling.classList.toggle(otherElementClass,sibling!==element),sibling=sibling.nextSibling}__name(radioCssClass,"radioCssClass");var FOCUSABLE_SELECTOR="[tabindex], input, select, button, textarea, [href]",FOCUSABLE_EXCLUDE="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function isFocusableFormField(element){const matches=Element.prototype.matches||Element.prototype.msMatchesSelector,isFocusable=matches.call(element,"input, select, button, textarea"),isNotFocusable=matches.call(element,FOCUSABLE_EXCLUDE),isElementVisible=isVisible(element);return isFocusable&&!isNotFocusable&&isElementVisible}__name(isFocusableFormField,"isFocusableFormField");function setDisplayed(element,displayed,options={}){const{skipAriaHidden}=options;element.classList.toggle("ag-hidden",!displayed),skipAriaHidden||setAriaHidden(element,!displayed)}__name(setDisplayed,"setDisplayed");function setVisible(element,visible,options={}){const{skipAriaHidden}=options;element.classList.toggle("ag-invisible",!visible),skipAriaHidden||setAriaHidden(element,!visible)}__name(setVisible,"setVisible");function setDisabled(element,disabled){const attributeName="disabled",addOrRemoveDisabledAttribute=disabled?e=>e.setAttribute(attributeName,""):e=>e.removeAttribute(attributeName);addOrRemoveDisabledAttribute(element),nodeListForEach(element.querySelectorAll("input"),input=>addOrRemoveDisabledAttribute(input))}__name(setDisabled,"setDisabled");function isElementChildOfClass(element,cls,maxNest){let counter=0;for(;element;){if(element.classList.contains(cls))return!0;if(element=element.parentElement,typeof maxNest=="number"){if(++counter>maxNest)break}else if(element===maxNest)break}return!1}__name(isElementChildOfClass,"isElementChildOfClass");function getElementSize(el){const{height,width,borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth,paddingTop,paddingRight,paddingBottom,paddingLeft,marginTop,marginRight,marginBottom,marginLeft,boxSizing}=window.getComputedStyle(el);return{height:parseFloat(height||"0"),width:parseFloat(width||"0"),borderTopWidth:parseFloat(borderTopWidth||"0"),borderRightWidth:parseFloat(borderRightWidth||"0"),borderBottomWidth:parseFloat(borderBottomWidth||"0"),borderLeftWidth:parseFloat(borderLeftWidth||"0"),paddingTop:parseFloat(paddingTop||"0"),paddingRight:parseFloat(paddingRight||"0"),paddingBottom:parseFloat(paddingBottom||"0"),paddingLeft:parseFloat(paddingLeft||"0"),marginTop:parseFloat(marginTop||"0"),marginRight:parseFloat(marginRight||"0"),marginBottom:parseFloat(marginBottom||"0"),marginLeft:parseFloat(marginLeft||"0"),boxSizing}}__name(getElementSize,"getElementSize");function getInnerHeight(el){const size=getElementSize(el);return size.boxSizing==="border-box"?size.height-size.paddingTop-size.paddingBottom:size.height}__name(getInnerHeight,"getInnerHeight");function getInnerWidth(el){const size=getElementSize(el);return size.boxSizing==="border-box"?size.width-size.paddingLeft-size.paddingRight:size.width}__name(getInnerWidth,"getInnerWidth");function getAbsoluteHeight(el){const size=getElementSize(el),marginRight=size.marginBottom+size.marginTop;return Math.ceil(el.offsetHeight+marginRight)}__name(getAbsoluteHeight,"getAbsoluteHeight");function getAbsoluteWidth(el){const size=getElementSize(el),marginWidth=size.marginLeft+size.marginRight;return Math.ceil(el.offsetWidth+marginWidth)}__name(getAbsoluteWidth,"getAbsoluteWidth");function getElementRectWithOffset(el){const offsetElementRect=el.getBoundingClientRect(),{borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth}=getElementSize(el);return{top:offsetElementRect.top+(borderTopWidth||0),left:offsetElementRect.left+(borderLeftWidth||0),right:offsetElementRect.right+(borderRightWidth||0),bottom:offsetElementRect.bottom+(borderBottomWidth||0)}}__name(getElementRectWithOffset,"getElementRectWithOffset");function isRtlNegativeScroll(){if(typeof rtlNegativeScroll=="boolean")return rtlNegativeScroll;const template=document.createElement("div");return template.style.direction="rtl",template.style.width="1px",template.style.height="1px",template.style.position="fixed",template.style.top="0px",template.style.overflow="hidden",template.dir="rtl",template.innerHTML=`<div style="width: 2px">
            <span style="display: inline-block; width: 1px"></span>
            <span style="display: inline-block; width: 1px"></span>
        </div>`,document.body.appendChild(template),template.scrollLeft=1,rtlNegativeScroll=Math.floor(template.scrollLeft)===0,document.body.removeChild(template),rtlNegativeScroll}__name(isRtlNegativeScroll,"isRtlNegativeScroll");function getScrollLeft(element,rtl){let scrollLeft=element.scrollLeft;return rtl&&(scrollLeft=Math.abs(scrollLeft),isBrowserChrome()&&!isRtlNegativeScroll()&&(scrollLeft=element.scrollWidth-element.clientWidth-scrollLeft)),scrollLeft}__name(getScrollLeft,"getScrollLeft");function setScrollLeft(element,value,rtl){rtl&&(isRtlNegativeScroll()?value*=-1:(isBrowserSafari()||isBrowserChrome())&&(value=element.scrollWidth-element.clientWidth-value)),element.scrollLeft=value}__name(setScrollLeft,"setScrollLeft");function clearElement(el){for(;el&&el.firstChild;)el.removeChild(el.firstChild)}__name(clearElement,"clearElement");function removeFromParent(node){node&&node.parentNode&&node.parentNode.removeChild(node)}__name(removeFromParent,"removeFromParent");function isInDOM(element){return!!element.offsetParent}__name(isInDOM,"isInDOM");function isVisible(element){const el=element;return el.checkVisibility?el.checkVisibility({checkVisibilityCSS:!0}):!(!isInDOM(element)||window.getComputedStyle(element).visibility!=="visible")}__name(isVisible,"isVisible");function loadTemplate(template){const tempDiv=document.createElement("div");return tempDiv.innerHTML=(template||"").trim(),tempDiv.firstChild}__name(loadTemplate,"loadTemplate");function ensureDomOrder(eContainer,eChild,eChildBefore){eChildBefore&&eChildBefore.nextSibling===eChild||(eChildBefore?eChildBefore.nextSibling?eContainer.insertBefore(eChild,eChildBefore.nextSibling):eContainer.appendChild(eChild):eContainer.firstChild&&eContainer.firstChild!==eChild&&eContainer.insertAdjacentElement("afterbegin",eChild))}__name(ensureDomOrder,"ensureDomOrder");function setDomChildOrder(eContainer,orderedChildren){for(let i=0;i<orderedChildren.length;i++){const correctCellAtIndex=orderedChildren[i],actualCellAtIndex=eContainer.children[i];actualCellAtIndex!==correctCellAtIndex&&eContainer.insertBefore(correctCellAtIndex,actualCellAtIndex)}}__name(setDomChildOrder,"setDomChildOrder");function insertWithDomOrder(eContainer,eToInsert,eChildBefore){eChildBefore?eChildBefore.insertAdjacentElement("afterend",eToInsert):eContainer.firstChild?eContainer.insertAdjacentElement("afterbegin",eToInsert):eContainer.appendChild(eToInsert)}__name(insertWithDomOrder,"insertWithDomOrder");function addStylesToElement(eElement,styles){if(styles)for(const[key,value]of Object.entries(styles)){if(!key||!key.length||value==null)continue;const parsedKey=camelCaseToHyphenated(key),valueAsString=value.toString(),parsedValue=valueAsString.replace(/\s*!important/g,""),priority=parsedValue.length!=valueAsString.length?"important":void 0;eElement.style.setProperty(parsedKey,parsedValue,priority)}}__name(addStylesToElement,"addStylesToElement");function isHorizontalScrollShowing(element){return element.clientWidth<element.scrollWidth}__name(isHorizontalScrollShowing,"isHorizontalScrollShowing");function isVerticalScrollShowing(element){return element.clientHeight<element.scrollHeight}__name(isVerticalScrollShowing,"isVerticalScrollShowing");function setElementWidth(element,width){width==="flex"?(element.style.removeProperty("width"),element.style.removeProperty("minWidth"),element.style.removeProperty("maxWidth"),element.style.flex="1 1 auto"):setFixedWidth(element,width)}__name(setElementWidth,"setElementWidth");function setFixedWidth(element,width){width=formatSize(width),element.style.width=width.toString(),element.style.maxWidth=width.toString(),element.style.minWidth=width.toString()}__name(setFixedWidth,"setFixedWidth");function setElementHeight(element,height){height==="flex"?(element.style.removeProperty("height"),element.style.removeProperty("minHeight"),element.style.removeProperty("maxHeight"),element.style.flex="1 1 auto"):setFixedHeight(element,height)}__name(setElementHeight,"setElementHeight");function setFixedHeight(element,height){height=formatSize(height),element.style.height=height.toString(),element.style.maxHeight=height.toString(),element.style.minHeight=height.toString()}__name(setFixedHeight,"setFixedHeight");function formatSize(size){return typeof size=="number"?`${size}px`:size}__name(formatSize,"formatSize");function isNodeOrElement(o){return o instanceof Node||o instanceof HTMLElement}__name(isNodeOrElement,"isNodeOrElement");function copyNodeList(nodeList){if(nodeList==null)return[];const result=[];return nodeListForEach(nodeList,node=>result.push(node)),result}__name(copyNodeList,"copyNodeList");function iterateNamedNodeMap(map,callback){if(map)for(let i=0;i<map.length;i++){const attr=map[i];callback(attr.name,attr.value)}}__name(iterateNamedNodeMap,"iterateNamedNodeMap");function addOrRemoveAttribute(element,name,value){value==null?element.removeAttribute(name):element.setAttribute(name,value.toString())}__name(addOrRemoveAttribute,"addOrRemoveAttribute");function nodeListForEach(nodeList,action){if(nodeList!=null)for(let i=0;i<nodeList.length;i++)action(nodeList[i])}__name(nodeListForEach,"nodeListForEach");function bindCellRendererToHtmlElement(cellRendererPromise,eTarget){cellRendererPromise.then(cellRenderer=>{const gui=cellRenderer.getGui();gui!=null&&(typeof gui=="object"?eTarget.appendChild(gui):eTarget.innerHTML=gui)})}__name(bindCellRendererToHtmlElement,"bindCellRendererToHtmlElement");var fuzzyMatch_exports={};__export(fuzzyMatch_exports,{fuzzyCheckStrings:()=>fuzzyCheckStrings,fuzzySuggestions:()=>fuzzySuggestions});function fuzzyCheckStrings(inputValues,validValues,allSuggestions){const fuzzyMatches={},invalidInputs=inputValues.filter(inputValue=>!validValues.some(validValue=>validValue===inputValue));return invalidInputs.length>0&&invalidInputs.forEach(invalidInput=>fuzzyMatches[invalidInput]=fuzzySuggestions(invalidInput,allSuggestions).values),fuzzyMatches}__name(fuzzyCheckStrings,"fuzzyCheckStrings");function fuzzySuggestions(inputValue,allSuggestions,hideIrrelevant,filterByPercentageOfBestMatch){let thisSuggestions=allSuggestions.map((text,idx)=>({value:text,relevance:stringWeightedDistances(inputValue.toLowerCase(),text.toLocaleLowerCase()),idx}));if(thisSuggestions.sort((a,b)=>b.relevance-a.relevance),hideIrrelevant&&(thisSuggestions=thisSuggestions.filter(suggestion=>suggestion.relevance!==0)),thisSuggestions.length>0&&filterByPercentageOfBestMatch&&filterByPercentageOfBestMatch>0){const limit=thisSuggestions[0].relevance*filterByPercentageOfBestMatch;thisSuggestions=thisSuggestions.filter(suggestion=>limit-suggestion.relevance<0)}const values2=[],indices=[];for(const suggestion of thisSuggestions)values2.push(suggestion.value),indices.push(suggestion.idx);return{values:values2,indices}}__name(fuzzySuggestions,"fuzzySuggestions");function stringWeightedDistances(str1,str2){const a=str1.replace(/\s/g,""),b=str2.replace(/\s/g,"");let weight=0,lastIndex=-1;for(let i=0;i<a.length;i++){const idx=b.indexOf(a[i],lastIndex+1);idx!==-1&&(lastIndex=idx,weight+=100-lastIndex*100/1e4*100)}return weight}__name(stringWeightedDistances,"stringWeightedDistances");var icon_exports={};__export(icon_exports,{createIcon:()=>createIcon,createIconNoSpan:()=>createIconNoSpan,iconNameClassMap:()=>iconNameClassMap});var iconNameClassMap={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus"};function createIcon(iconName,gridOptionsService,column){const iconContents=createIconNoSpan(iconName,gridOptionsService,column);if(iconContents){const{className}=iconContents;if(typeof className=="string"&&className.indexOf("ag-icon")>-1||typeof className=="object"&&className["ag-icon"])return iconContents}const eResult=document.createElement("span");return eResult.appendChild(iconContents),eResult}__name(createIcon,"createIcon");function createIconNoSpan(iconName,gridOptionsService,column,forceCreate){let userProvidedIcon=null;const icons=column&&column.getColDef().icons;if(icons&&(userProvidedIcon=icons[iconName]),gridOptionsService&&!userProvidedIcon){const optionsIcons=gridOptionsService.get("icons");optionsIcons&&(userProvidedIcon=optionsIcons[iconName])}if(userProvidedIcon){let rendererResult;if(typeof userProvidedIcon=="function")rendererResult=userProvidedIcon();else if(typeof userProvidedIcon=="string")rendererResult=userProvidedIcon;else throw new Error("icon from grid options needs to be a string or a function");if(typeof rendererResult=="string")return loadTemplate(rendererResult);if(isNodeOrElement(rendererResult))return rendererResult;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}else{const span=document.createElement("span");let cssClass=iconNameClassMap[iconName];return cssClass||(forceCreate?cssClass=iconName:(console.warn(`AG Grid: Did not find icon ${iconName}`),cssClass="")),span.setAttribute("class",`ag-icon ag-icon-${cssClass}`),span.setAttribute("unselectable","on"),setAriaRole(span,"presentation"),span}}__name(createIconNoSpan,"createIconNoSpan");var keyboard_exports={};__export(keyboard_exports,{isDeleteKey:()=>isDeleteKey,isEventFromPrintableCharacter:()=>isEventFromPrintableCharacter,isUserSuppressingHeaderKeyboardEvent:()=>isUserSuppressingHeaderKeyboardEvent,isUserSuppressingKeyboardEvent:()=>isUserSuppressingKeyboardEvent,normaliseQwertyAzerty:()=>normaliseQwertyAzerty});var _a20,KeyCode=(_a20=class{},__name(_a20,"KeyCode"),_a20);KeyCode.BACKSPACE="Backspace";KeyCode.TAB="Tab";KeyCode.ENTER="Enter";KeyCode.ESCAPE="Escape";KeyCode.SPACE=" ";KeyCode.LEFT="ArrowLeft";KeyCode.UP="ArrowUp";KeyCode.RIGHT="ArrowRight";KeyCode.DOWN="ArrowDown";KeyCode.DELETE="Delete";KeyCode.F2="F2";KeyCode.PAGE_UP="PageUp";KeyCode.PAGE_DOWN="PageDown";KeyCode.PAGE_HOME="Home";KeyCode.PAGE_END="End";KeyCode.A="KeyA";KeyCode.C="KeyC";KeyCode.D="KeyD";KeyCode.V="KeyV";KeyCode.X="KeyX";KeyCode.Y="KeyY";KeyCode.Z="KeyZ";var A_KEYCODE=65,C_KEYCODE=67,V_KEYCODE=86,D_KEYCODE=68,Z_KEYCODE=90,Y_KEYCODE=89;function isEventFromPrintableCharacter(event){return event.altKey||event.ctrlKey||event.metaKey?!1:event.key.length===1}__name(isEventFromPrintableCharacter,"isEventFromPrintableCharacter");function isUserSuppressingKeyboardEvent(gridOptionsService,keyboardEvent,rowNode,column,editing){const colDefFunc=column?column.getColDef().suppressKeyboardEvent:void 0;if(!colDefFunc)return!1;const params=gridOptionsService.addGridCommonParams({event:keyboardEvent,editing,column,node:rowNode,data:rowNode.data,colDef:column.getColDef()});return!!(colDefFunc&&colDefFunc(params))}__name(isUserSuppressingKeyboardEvent,"isUserSuppressingKeyboardEvent");function isUserSuppressingHeaderKeyboardEvent(gridOptionsService,keyboardEvent,headerRowIndex,column){const colDef=column.getDefinition(),colDefFunc=colDef&&colDef.suppressHeaderKeyboardEvent;if(!exists(colDefFunc))return!1;const params=gridOptionsService.addGridCommonParams({colDef,column,headerRowIndex,event:keyboardEvent});return!!colDefFunc(params)}__name(isUserSuppressingHeaderKeyboardEvent,"isUserSuppressingHeaderKeyboardEvent");function normaliseQwertyAzerty(keyboardEvent){const{keyCode}=keyboardEvent;let code;switch(keyCode){case A_KEYCODE:code=KeyCode.A;break;case C_KEYCODE:code=KeyCode.C;break;case V_KEYCODE:code=KeyCode.V;break;case D_KEYCODE:code=KeyCode.D;break;case Z_KEYCODE:code=KeyCode.Z;break;case Y_KEYCODE:code=KeyCode.Y;break;default:code=keyboardEvent.code}return code}__name(normaliseQwertyAzerty,"normaliseQwertyAzerty");function isDeleteKey(key,alwaysReturnFalseOnBackspace=!1){return key===KeyCode.DELETE?!0:!alwaysReturnFalseOnBackspace&&key===KeyCode.BACKSPACE?isMacOsUserAgent():!1}__name(isDeleteKey,"isDeleteKey");var mouse_exports={};__export(mouse_exports,{areEventsNear:()=>areEventsNear});function areEventsNear(e1,e2,pixelCount){if(pixelCount===0)return!1;const diffX=Math.abs(e1.clientX-e2.clientX),diffY=Math.abs(e1.clientY-e2.clientY);return Math.max(diffX,diffY)<=pixelCount}__name(areEventsNear,"areEventsNear");var rowNode_exports={};__export(rowNode_exports,{sortRowNodesByOrder:()=>sortRowNodesByOrder});function sortRowNodesByOrder(rowNodes,rowNodeOrder){if(!rowNodes)return!1;const comparator=__name((nodeA,nodeB)=>{const positionA=rowNodeOrder[nodeA.id],positionB=rowNodeOrder[nodeB.id],aHasIndex=positionA!==void 0,bHasIndex=positionB!==void 0,bothNodesAreUserNodes=aHasIndex&&bHasIndex,bothNodesAreFillerNodes=!aHasIndex&&!bHasIndex;return bothNodesAreUserNodes?positionA-positionB:bothNodesAreFillerNodes?nodeA.__objectId-nodeB.__objectId:aHasIndex?1:-1},"comparator");let rowNodeA,rowNodeB,atLeastOneOutOfOrder=!1;for(let i=0;i<rowNodes.length-1;i++)if(rowNodeA=rowNodes[i],rowNodeB=rowNodes[i+1],comparator(rowNodeA,rowNodeB)>0){atLeastOneOutOfOrder=!0;break}return atLeastOneOutOfOrder?(rowNodes.sort(comparator),!0):!1}__name(sortRowNodesByOrder,"sortRowNodesByOrder");var set_exports={};__export(set_exports,{convertToSet:()=>convertToSet});function convertToSet(list){const set=new Set;return list.forEach(x=>set.add(x)),set}__name(convertToSet,"convertToSet");var utils=__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},aria_exports),array_exports),browser_exports),date_exports),dom_exports),event_exports),function_exports),fuzzyMatch_exports),generic_exports),icon_exports),keyboard_exports),map_exports),mouse_exports),number_exports),object_exports),rowNode_exports),set_exports),string_exports),_=utils,_a21,NumberSequence=(_a21=class{constructor(initValue=0,step=1){this.nextValue=initValue,this.step=step}next(){const valToReturn=this.nextValue;return this.nextValue+=this.step,valToReturn}peek(){return this.nextValue}skip(count){this.nextValue+=count}},__name(_a21,"NumberSequence"),_a21),_a22,AgPromise=(_a22=class{constructor(callback){this.status=0,this.resolution=null,this.waiters=[],callback(value=>this.onDone(value),params=>this.onReject(params))}static all(promises){return new _a22(resolve=>{let remainingToResolve=promises.length;const combinedValues=new Array(remainingToResolve);promises.forEach((promise,index)=>{promise.then(value=>{combinedValues[index]=value,remainingToResolve--,remainingToResolve===0&&resolve(combinedValues)})})})}static resolve(value=null){return new _a22(resolve=>resolve(value))}then(func){return new _a22(resolve=>{this.status===1?resolve(func(this.resolution)):this.waiters.push(value=>resolve(func(value)))})}resolveNow(ifNotResolvedValue,ifResolved){return this.status===1?ifResolved(this.resolution):ifNotResolvedValue}onDone(value){this.status=1,this.resolution=value,this.waiters.forEach(waiter=>waiter(value))}onReject(params){console.warn("TBI")}},__name(_a22,"_AgPromise"),_a22),_a23,CssClassManager=(_a23=class{constructor(getGui){this.cssClassStates={},this.getGui=getGui}addCssClass(className){const list=(className||"").split(" ");if(list.length>1){list.forEach(cls=>this.addCssClass(cls));return}if(this.cssClassStates[className]!==!0&&className.length){const eGui=this.getGui();eGui&&eGui.classList.add(className),this.cssClassStates[className]=!0}}removeCssClass(className){const list=(className||"").split(" ");if(list.length>1){list.forEach(cls=>this.removeCssClass(cls));return}if(this.cssClassStates[className]!==!1&&className.length){const eGui=this.getGui();eGui&&eGui.classList.remove(className),this.cssClassStates[className]=!1}}containsCssClass(className){const eGui=this.getGui();return eGui?eGui.classList.contains(className):!1}addOrRemoveCssClass(className,addOrRemove){if(!className)return;if(className.indexOf(" ")>=0){const list=(className||"").split(" ");if(list.length>1){list.forEach(cls=>this.addOrRemoveCssClass(cls,addOrRemove));return}}if(this.cssClassStates[className]!==addOrRemove&&className.length){const eGui=this.getGui();eGui&&eGui.classList.toggle(className,addOrRemove),this.cssClassStates[className]=addOrRemove}}},__name(_a23,"CssClassManager"),_a23),_a24,_TooltipStateManager=(_a24=class extends BeanStub{constructor(parentComp,tooltipShowDelayOverride,tooltipHideDelayOverride,shouldDisplayTooltip){super(),this.parentComp=parentComp,this.tooltipShowDelayOverride=tooltipShowDelayOverride,this.tooltipHideDelayOverride=tooltipHideDelayOverride,this.shouldDisplayTooltip=shouldDisplayTooltip,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.INTERACTIVE_HIDE_DELAY=100,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}postConstruct(){this.gridOptionsService.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gridOptionsService.get("tooltipMouseTrack");const el=this.parentComp.getGui();this.tooltipTrigger===0&&(this.addManagedListener(el,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(el,"mouseleave",this.onMouseLeave.bind(this))),this.tooltipTrigger===1&&(this.addManagedListener(el,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(el,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(el,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(el,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(el,"keydown",this.onKeyDown.bind(this)))}getGridOptionsTooltipDelay(delayOption){const delay=this.gridOptionsService.get(delayOption);return delay<0&&warnOnce(`${delayOption} should not be lower than 0`),Math.max(200,delay)}getTooltipDelay(type){var _a273,_b;return type==="show"?(_a273=this.tooltipShowDelayOverride)!=null?_a273:this.getGridOptionsTooltipDelay("tooltipShowDelay"):(_b=this.tooltipHideDelayOverride)!=null?_b:this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const trigger=this.gridOptionsService.get("tooltipTrigger");return!trigger||trigger==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!isIOSUserAgent()&&(_a24.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){var _a273;const relatedTarget=e.relatedTarget,parentCompGui=this.parentComp.getGui(),tooltipGui=(_a273=this.tooltipComp)==null?void 0:_a273.getGui();this.isInteractingWithTooltip||parentCompGui.contains(relatedTarget)||this.interactionEnabled&&(tooltipGui!=null&&tooltipGui.contains(relatedTarget))||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(mouseEvent){if(this.state!=0||_a24.isLocked)return;let delay=0;mouseEvent&&(delay=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=mouseEvent||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),delay),this.state=1}isLastTooltipHiddenRecently(){const now=new Date().getTime(),then=_a24.lastTooltipHideTime;return now-then<this.SHOW_QUICK_TOOLTIP_DIFF}setToDoNothing(){this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const params=__spreadValues({},this.parentComp.getTooltipParams());if(!exists(params.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip()){this.setToDoNothing();return}this.state=2,this.tooltipInstanceCount++;const callback=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(params).newAgStackInstance().then(callback)}hideTooltip(forceHide){if(!forceHide&&this.isInteractingWithTooltip)return;this.tooltipComp&&(this.destroyTooltipComp(),_a24.lastTooltipHideTime=new Date().getTime());const event={type:Events.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(event),this.state=0}newTooltipComponentCallback(tooltipInstanceCopy,tooltipComp){if(this.state!==2||this.tooltipInstanceCount!==tooltipInstanceCopy){this.getContext().destroyBean(tooltipComp);return}const eGui=tooltipComp.getGui();this.tooltipComp=tooltipComp,eGui.classList.contains("ag-tooltip")||eGui.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&eGui.classList.add("ag-tooltip-animate"),this.interactionEnabled&&eGui.classList.add("ag-tooltip-interactive");const translate=this.localeService.getLocaleTextFunc(),addPopupRes=this.popupService.addPopup({eChild:eGui,ariaLabel:translate("ariaLabelTooltip","Tooltip")});addPopupRes&&(this.tooltipPopupDestroyFunc=addPopupRes.hideFunc),this.positionTooltip(),this.tooltipTrigger===1&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(this.tooltipTrigger===0?(this.tooltipMouseEnterListener=this.addManagedListener(eGui,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(eGui,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(eGui,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(eGui,"focusout",this.onTooltipFocusOut.bind(this))||null));const event={type:Events.EVENT_TOOLTIP_SHOW,tooltipGui:eGui,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(event),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isInteractingWithTooltip=!1,this.lockService()}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}onTooltipFocusOut(e){var _a273;const parentGui=this.parentComp.getGui(),tooltipGui=(_a273=this.tooltipComp)==null?void 0:_a273.getGui(),relatedTarget=e.relatedTarget;tooltipGui!=null&&tooltipGui.contains(relatedTarget)||(this.isInteractingWithTooltip=!1,parentGui.contains(relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const params={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(__spreadProps(__spreadValues({},params),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(__spreadProps(__spreadValues({},params),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const tooltipPopupDestroyFunc=this.tooltipPopupDestroyFunc,tooltipComp=this.tooltipComp,delay=this.tooltipTrigger===0?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout(()=>{tooltipPopupDestroyFunc(),this.getContext().destroyBean(tooltipComp)},delay),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(listener=>{listener&&listener()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){_a24.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},this.INTERACTIVE_HIDE_DELAY)}unlockService(){_a24.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},__name(_a24,"_TooltipStateManager"),_a24);_TooltipStateManager.isLocked=!1;__decorateClass([Autowired("popupService")],_TooltipStateManager.prototype,"popupService",2);__decorateClass([Autowired("userComponentFactory")],_TooltipStateManager.prototype,"userComponentFactory",2);__decorateClass([PostConstruct],_TooltipStateManager.prototype,"postConstruct",1);var TooltipStateManager=_TooltipStateManager,_a25,TooltipFeature=(_a25=class extends BeanStub{constructor(ctrl,beans){super(),this.ctrl=ctrl,beans&&(this.beans=beans)}postConstruct(){this.refreshToolTip()}setBrowserTooltip(tooltip){const name="title",eGui=this.ctrl.getGui();eGui&&(tooltip!=null&&tooltip!=""?eGui.setAttribute(name,tooltip):eGui.removeAttribute(name))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var _a273,_b,_c,_d;if(this.tooltipManager!=null)return;const parent={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new TooltipStateManager(parent,(_b=(_a273=this.ctrl).getTooltipShowDelayOverride)==null?void 0:_b.call(_a273),(_d=(_c=this.ctrl).getTooltipHideDelayOverride)==null?void 0:_d.call(_c),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gridOptionsService.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const ctrl=this.ctrl,column=ctrl.getColumn?ctrl.getColumn():void 0,colDef=ctrl.getColDef?ctrl.getColDef():void 0,rowNode=ctrl.getRowNode?ctrl.getRowNode():void 0;return{location:ctrl.getLocation(),colDef,column,rowIndex:ctrl.getRowIndex?ctrl.getRowIndex():void 0,node:rowNode,data:rowNode?rowNode.data:void 0,value:this.getTooltipText(),valueFormatted:ctrl.getValueFormatted?ctrl.getValueFormatted():void 0,hideTooltipCallback:()=>{var _a273;return(_a273=this.tooltipManager)==null?void 0:_a273.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}},__name(_a25,"TooltipFeature"),_a25);__decorateClass([Autowired("beans")],TooltipFeature.prototype,"beans",2);__decorateClass([PostConstruct],TooltipFeature.prototype,"postConstruct",1);var compIdSequence=new NumberSequence,_a26,_Component=(_a26=class extends BeanStub{constructor(template){super(),this.displayed=!0,this.visible=!0,this.compId=compIdSequence.next(),this.cssClassManager=new CssClassManager(()=>this.eGui),template&&this.setTemplate(template)}preConstructOnComponent(){this.usingBrowserTooltips=this.gridOptionsService.get("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(params){const{newTooltipText,showDelayOverride,hideDelayOverride,location,shouldDisplayTooltip}=params||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==newTooltipText&&(this.tooltipText=newTooltipText);const getTooltipValue=__name(()=>this.tooltipText,"getTooltipValue");newTooltipText!=null&&(this.tooltipFeature=this.createBean(new TooltipFeature({getTooltipValue,getGui:()=>this.getGui(),getLocation:()=>location??"UNKNOWN",getTooltipShowDelayOverride:showDelayOverride!=null?()=>showDelayOverride:void 0,getTooltipHideDelayOverride:hideDelayOverride!=null?()=>hideDelayOverride:void 0,shouldDisplayTooltip})))}createChildComponentsFromTags(parentNode,paramsMap){copyNodeList(parentNode.childNodes).forEach(childNode=>{if(!(childNode instanceof HTMLElement))return;const childComp=this.createComponentFromElement(childNode,childComp2=>{childComp2.getGui()&&this.copyAttributesFromNode(childNode,childComp2.getGui())},paramsMap);if(childComp){if(childComp.addItems&&childNode.children.length){this.createChildComponentsFromTags(childNode,paramsMap);const items=Array.prototype.slice.call(childNode.children);childComp.addItems(items)}this.swapComponentForNode(childComp,parentNode,childNode)}else childNode.childNodes&&this.createChildComponentsFromTags(childNode,paramsMap)})}createComponentFromElement(element,afterPreCreateCallback,paramsMap){const key=element.nodeName,componentParams=paramsMap?paramsMap[element.getAttribute("ref")]:void 0,ComponentClass=this.agStackComponentsRegistry.getComponentClass(key);if(ComponentClass){_a26.elementGettingCreated=element;const newComponent=new ComponentClass(componentParams);return newComponent.setParentComponent(this),this.createBean(newComponent,null,afterPreCreateCallback),newComponent}return null}copyAttributesFromNode(source,dest){iterateNamedNodeMap(source.attributes,(name,value)=>dest.setAttribute(name,value))}swapComponentForNode(newComponent,parentNode,childNode){const eComponent=newComponent.getGui();parentNode.replaceChild(eComponent,childNode),parentNode.insertBefore(document.createComment(childNode.nodeName),eComponent),this.addDestroyFunc(this.destroyBean.bind(this,newComponent)),this.swapInComponentForQuerySelectors(newComponent,childNode)}swapInComponentForQuerySelectors(newComponent,childNode){const thisNoType=this;this.iterateOverQuerySelectors(querySelector=>{thisNoType[querySelector.attributeName]===childNode&&(thisNoType[querySelector.attributeName]=newComponent)})}iterateOverQuerySelectors(action){let thisPrototype=Object.getPrototypeOf(this);for(;thisPrototype!=null;){const metaData=thisPrototype.__agComponentMetaData,currentProtoName=getFunctionName(thisPrototype.constructor);metaData&&metaData[currentProtoName]&&metaData[currentProtoName].querySelectors&&metaData[currentProtoName].querySelectors.forEach(querySelector=>action(querySelector)),thisPrototype=Object.getPrototypeOf(thisPrototype)}}activateTabIndex(elements){const tabIndex=this.gridOptionsService.get("tabIndex");elements||(elements=[]),elements.length||elements.push(this.getGui()),elements.forEach(el=>el.setAttribute("tabindex",tabIndex.toString()))}setTemplate(template,paramsMap){const eGui=loadTemplate(template);this.setTemplateFromElement(eGui,paramsMap)}setTemplateFromElement(element,paramsMap){this.eGui=element,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),paramsMap)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const thisNoType=this;this.iterateOverQuerySelectors(querySelector=>{const setResult=__name(result=>thisNoType[querySelector.attributeName]=result,"setResult");if(querySelector.refSelector&&this.getAttribute("ref")===querySelector.refSelector)setResult(this.eGui);else{const resultOfQuery=this.eGui.querySelector(querySelector.querySelector);resultOfQuery&&setResult(resultOfQuery.__agComponent||resultOfQuery)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(component){this.parentComponent=component}getParentComponent(){return this.parentComponent}setGui(eGui){this.eGui=eGui}queryForHtmlElement(cssSelector){return this.eGui.querySelector(cssSelector)}queryForHtmlInputElement(cssSelector){return this.eGui.querySelector(cssSelector)}appendChild(newChild,container){if(newChild!=null)if(container||(container=this.eGui),isNodeOrElement(newChild))container.appendChild(newChild);else{const childComponent=newChild;container.appendChild(childComponent.getGui())}}isDisplayed(){return this.displayed}setVisible(visible,options={}){if(visible!==this.visible){this.visible=visible;const{skipAriaHidden}=options;setVisible(this.eGui,visible,{skipAriaHidden})}}setDisplayed(displayed,options={}){if(displayed!==this.displayed){this.displayed=displayed;const{skipAriaHidden}=options;setDisplayed(this.eGui,displayed,{skipAriaHidden});const event={type:_a26.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(event)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const eGui=this.eGui;eGui&&eGui.__agComponent&&(eGui.__agComponent=void 0),super.destroy()}addGuiEventListener(event,listener,options){this.eGui.addEventListener(event,listener,options),this.addDestroyFunc(()=>this.eGui.removeEventListener(event,listener))}addCssClass(className){this.cssClassManager.addCssClass(className)}removeCssClass(className){this.cssClassManager.removeCssClass(className)}containsCssClass(className){return this.cssClassManager.containsCssClass(className)}addOrRemoveCssClass(className,addOrRemove){this.cssClassManager.addOrRemoveCssClass(className,addOrRemove)}getAttribute(key){const{eGui}=this;return eGui?eGui.getAttribute(key):null}getRefElement(refName){return this.queryForHtmlElement(`[ref="${refName}"]`)}},__name(_a26,"_Component"),_a26);_Component.EVENT_DISPLAYED_CHANGED="displayedChanged";__decorateClass([Autowired("agStackComponentsRegistry")],_Component.prototype,"agStackComponentsRegistry",2);__decorateClass([PreConstruct],_Component.prototype,"preConstructOnComponent",1);__decorateClass([PreConstruct],_Component.prototype,"createChildComponentsPreConstruct",1);var Component=_Component;function RefSelector(ref){return querySelectorFunc.bind(this,`[ref=${ref}]`,ref)}__name(RefSelector,"RefSelector");function querySelectorFunc(selector,refSelector,classPrototype,methodOrAttributeName,index){if(selector===null){console.error("AG Grid: QuerySelector selector should not be null");return}if(typeof index=="number"){console.error("AG Grid: QuerySelector should be on an attribute");return}addToObjectProps(classPrototype,"querySelectors",{attributeName:methodOrAttributeName,querySelector:selector,refSelector})}__name(querySelectorFunc,"querySelectorFunc");function addToObjectProps(target,key,value){const props=getOrCreateProps2(target,getFunctionName(target.constructor));props[key]||(props[key]=[]),props[key].push(value)}__name(addToObjectProps,"addToObjectProps");function getOrCreateProps2(target,instanceName){return target.__agComponentMetaData||(target.__agComponentMetaData={}),target.__agComponentMetaData[instanceName]||(target.__agComponentMetaData[instanceName]={}),target.__agComponentMetaData[instanceName]}__name(getOrCreateProps2,"getOrCreateProps2");var _a27,ReadOnlyFloatingFilter=(_a27=class extends Component{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(params){this.params=params;const displayName=this.columnModel.getDisplayNameForColumn(params.column,"header",!0),translate=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${displayName} ${translate("ariaFilterInput","Filter Input")}`)}onParentModelChanged(parentModel){if(parentModel==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(filterInstance=>{if(filterInstance.getModelAsString){const modelAsString=filterInstance.getModelAsString(parentModel);this.eFloatingFilterText.setValue(modelAsString)}})}onParamsUpdated(params){this.refresh(params)}refresh(params){this.init(params)}},__name(_a27,"ReadOnlyFloatingFilter"),_a27);__decorateClass([RefSelector("eFloatingFilterText")],ReadOnlyFloatingFilter.prototype,"eFloatingFilterText",2);__decorateClass([Autowired("columnModel")],ReadOnlyFloatingFilter.prototype,"columnModel",2);var _a28,DateCompWrapper=(_a28=class{constructor(context,userComponentFactory,dateComponentParams,eParent){this.alive=!0,this.context=context,this.eParent=eParent,userComponentFactory.getDateCompDetails(dateComponentParams).newAgStackInstance().then(dateComp=>{if(!this.alive){context.destroyBean(dateComp);return}this.dateComp=dateComp,dateComp&&(eParent.appendChild(dateComp.getGui()),dateComp.afterGuiAttached&&dateComp.afterGuiAttached(),this.tempValue&&dateComp.setDate(this.tempValue),this.disabled!=null&&this.setDateCompDisabled(this.disabled))})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(value){this.dateComp?this.dateComp.setDate(value):this.tempValue=value}setDisabled(disabled){this.dateComp?this.setDateCompDisabled(disabled):this.disabled=disabled}setDisplayed(displayed){setDisplayed(this.eParent,displayed)}setInputPlaceholder(placeholder){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(placeholder)}setInputAriaLabel(label){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(label)}afterGuiAttached(params){this.dateComp&&typeof this.dateComp.afterGuiAttached=="function"&&this.dateComp.afterGuiAttached(params)}updateParams(params){var _a273,_b;let hasRefreshed=!1;(_a273=this.dateComp)!=null&&_a273.refresh&&typeof this.dateComp.refresh=="function"&&this.dateComp.refresh(params)!==null&&(hasRefreshed=!0),!hasRefreshed&&((_b=this.dateComp)!=null&&_b.onParamsUpdated)&&typeof this.dateComp.onParamsUpdated=="function"&&this.dateComp.onParamsUpdated(params)!==null&&warnOnce("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}setDateCompDisabled(disabled){this.dateComp!=null&&this.dateComp.setDisabled!=null&&this.dateComp.setDisabled(disabled)}},__name(_a28,"DateCompWrapper"),_a28),_a29,OptionsFactory=(_a29=class{constructor(){this.customFilterOptions={}}init(params,defaultOptions){this.filterOptions=params.filterOptions||defaultOptions,this.mapCustomOptions(),this.selectDefaultItem(params)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(filterOption=>{if(typeof filterOption=="string")return;const requiredProperties=[["displayKey"],["displayName"],["predicate","test"]],propertyCheck=__name(keys2=>keys2.some(key=>filterOption[key]!=null)?!0:(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${keys2}'`),!1),"propertyCheck");if(!requiredProperties.every(propertyCheck)){this.filterOptions=this.filterOptions.filter(v=>v===filterOption)||[];return}this.customFilterOptions[filterOption.displayKey]=filterOption})}selectDefaultItem(params){if(params.defaultOption)this.defaultOption=params.defaultOption;else if(this.filterOptions.length>=1){const firstFilterOption=this.filterOptions[0];typeof firstFilterOption=="string"?this.defaultOption=firstFilterOption:firstFilterOption.displayKey?this.defaultOption=firstFilterOption.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(name){return this.customFilterOptions[name]}},__name(_a29,"OptionsFactory"),_a29),FILTER_LOCALE_TEXT={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},_a30,_ManagedFocusFeature=(_a30=class extends BeanStub{constructor(eFocusableElement,callbacks={}){super(),this.eFocusableElement=eFocusableElement,this.callbacks=callbacks,this.callbacks=__spreadValues({shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const nextRoot=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);nextRoot&&(nextRoot.focus(),e.preventDefault())}},callbacks)}postConstruct(){this.eFocusableElement.classList.add(_a30.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(eGui){this.addManagedListener(eGui,"keydown",e=>{if(!(e.defaultPrevented||isStopPropagationForAgGrid(e))){if(this.callbacks.shouldStopEventPropagation(e)){stopPropagationForAgGrid(e);return}e.key===KeyCode.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e)}})}},__name(_a30,"_ManagedFocusFeature"),_a30);_ManagedFocusFeature.FOCUS_MANAGED_CLASS="ag-focus-managed";__decorateClass([Autowired("focusService")],_ManagedFocusFeature.prototype,"focusService",2);__decorateClass([PostConstruct],_ManagedFocusFeature.prototype,"postConstruct",1);var ManagedFocusFeature=_ManagedFocusFeature,RESIZE_CONTAINER_STYLE="ag-resizer-wrapper",RESIZE_TEMPLATE=`<div class="${RESIZE_CONTAINER_STYLE}">
        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>
        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>
        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>
        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>
        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>
        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>
        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>
        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>
    </div>`,_a31,PositionableFeature=(_a31=class extends BeanStub{constructor(element,config){super(),this.element=element,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},config)}center(){const{clientHeight,clientWidth}=this.offsetParent,x=clientWidth/2-this.getWidth()/2,y=clientHeight/2-this.getHeight()/2;this.offsetElement(x,y)}initialisePosition(){if(this.positioned)return;const{centered,forcePopupParentAsOffsetParent,minWidth,width,minHeight,height,x,y}=this.config;this.offsetParent||this.setOffsetParent();let computedMinHeight=0,computedMinWidth=0;const isElementVisible=isVisible(this.element);if(isElementVisible){const boundaryEl=this.findBoundaryElement(),offsetParentComputedStyles=window.getComputedStyle(boundaryEl);if(offsetParentComputedStyles.minWidth!=null){const paddingWidth=boundaryEl.offsetWidth-this.element.offsetWidth;computedMinWidth=parseInt(offsetParentComputedStyles.minWidth,10)-paddingWidth}if(offsetParentComputedStyles.minHeight!=null){const paddingHeight=boundaryEl.offsetHeight-this.element.offsetHeight;computedMinHeight=parseInt(offsetParentComputedStyles.minHeight,10)-paddingHeight}}if(this.minHeight=minHeight||computedMinHeight,this.minWidth=minWidth||computedMinWidth,width&&this.setWidth(width),height&&this.setHeight(height),(!width||!height)&&this.refreshSize(),centered)this.center();else if(x||y)this.offsetElement(x,y);else if(isElementVisible&&forcePopupParentAsOffsetParent){let boundaryEl=this.boundaryEl,initialisedDuringPositioning=!0;if(boundaryEl||(boundaryEl=this.findBoundaryElement(),initialisedDuringPositioning=!1),boundaryEl){const top=parseFloat(boundaryEl.style.top),left=parseFloat(boundaryEl.style.left);initialisedDuringPositioning?this.offsetElement(isNaN(left)?0:left,isNaN(top)?0:top):this.setPosition(left,top)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(movable,moveElement){if(!this.config.popup||movable===this.movable)return;this.movable=movable;const params=this.moveElementDragListener||{eElement:moveElement,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};movable?(this.dragService.addDragSource(params),this.moveElementDragListener=params):(this.dragService.removeDragSource(params),this.moveElementDragListener=void 0)}setResizable(resizable){if(this.clearResizeListeners(),resizable?this.addResizers():this.removeResizers(),typeof resizable=="boolean"){if(resizable===!1)return;resizable={topLeft:resizable,top:resizable,topRight:resizable,right:resizable,bottomRight:resizable,bottom:resizable,bottomLeft:resizable,left:resizable}}Object.keys(resizable).forEach(side=>{const isSideResizable=!!resizable[side],resizerEl=this.getResizerElement(side),params={dragStartPixels:0,eElement:resizerEl,onDragStart:e=>this.onResizeStart(e,side),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,side)};(isSideResizable||!this.isAlive()&&!isSideResizable)&&(isSideResizable?(this.dragService.addDragSource(params),this.resizeListeners.push(params),resizerEl.style.pointerEvents="all"):resizerEl.style.pointerEvents="none",this.resizable[side]=isSideResizable)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height,width}=this.lastSize;width!==-1&&(this.element.style.width=`${width}px`),height!==-1&&(this.element.style.height=`${height}px`)}getHeight(){return this.element.offsetHeight}setHeight(height){const{popup}=this.config,eGui=this.element;let isPercent=!1;if(typeof height=="string"&&height.indexOf("%")!==-1)setFixedHeight(eGui,height),height=getAbsoluteHeight(eGui),isPercent=!0;else if(height=Math.max(this.minHeight,height),this.positioned){const availableHeight=this.getAvailableHeight();availableHeight&&height>availableHeight&&(height=availableHeight)}this.getHeight()!==height&&(isPercent?(eGui.style.maxHeight="unset",eGui.style.minHeight="unset"):popup?setFixedHeight(eGui,height):(eGui.style.height=`${height}px`,eGui.style.flex="0 0 auto",this.lastSize.height=typeof height=="number"?height:parseFloat(height)))}getAvailableHeight(){const{popup,forcePopupParentAsOffsetParent}=this.config;this.positioned||this.initialisePosition();const{clientHeight}=this.offsetParent;if(!clientHeight)return null;const elRect=this.element.getBoundingClientRect(),offsetParentRect=this.offsetParent.getBoundingClientRect(),yPosition=popup?this.position.y:elRect.top,parentTop=popup?0:offsetParentRect.top;let additionalHeight=0;if(forcePopupParentAsOffsetParent){const parentEl=this.element.parentElement;if(parentEl){const{bottom}=parentEl.getBoundingClientRect();additionalHeight=bottom-elRect.bottom}}return clientHeight+parentTop-yPosition-additionalHeight}getWidth(){return this.element.offsetWidth}setWidth(width){const eGui=this.element,{popup}=this.config;let isPercent=!1;if(typeof width=="string"&&width.indexOf("%")!==-1)setFixedWidth(eGui,width),width=getAbsoluteWidth(eGui),isPercent=!0;else if(this.positioned){width=Math.max(this.minWidth,width);const{clientWidth}=this.offsetParent,xPosition=popup?this.position.x:this.element.getBoundingClientRect().left;clientWidth&&width+xPosition>clientWidth&&(width=clientWidth-xPosition)}this.getWidth()!==width&&(isPercent?(eGui.style.maxWidth="unset",eGui.style.minWidth="unset"):this.config.popup?setFixedWidth(eGui,width):(eGui.style.width=`${width}px`,eGui.style.flex=" unset",this.lastSize.width=typeof width=="number"?width:parseFloat(width)))}offsetElement(x=0,y=0){const{forcePopupParentAsOffsetParent}=this.config,ePopup=forcePopupParentAsOffsetParent?this.boundaryEl:this.element;ePopup&&(this.popupService.positionPopup({ePopup,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x,y})}),this.setPosition(parseFloat(ePopup.style.left),parseFloat(ePopup.style.top)))}constrainSizeToAvailableHeight(constrain){if(!this.config.forcePopupParentAsOffsetParent)return;const applyMaxHeightToElement=__name(()=>{const availableHeight=this.getAvailableHeight();this.element.style.setProperty("max-height",`${availableHeight}px`)},"applyMaxHeightToElement");constrain?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),applyMaxHeightToElement):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(x,y){this.position.x=x,this.position.y=y}updateDragStartPosition(x,y){this.dragStartPosition={x,y}}calculateMouseMovement(params){const{e,isLeft,isTop,anywhereWithin,topBuffer}=params,xDiff=e.clientX-this.dragStartPosition.x,yDiff=e.clientY-this.dragStartPosition.y,movementX=this.shouldSkipX(e,!!isLeft,!!anywhereWithin,xDiff)?0:xDiff,movementY=this.shouldSkipY(e,!!isTop,topBuffer,yDiff)?0:yDiff;return{movementX,movementY}}shouldSkipX(e,isLeft,anywhereWithin,diff){const elRect=this.element.getBoundingClientRect(),parentRect=this.offsetParent.getBoundingClientRect(),boundaryElRect=this.boundaryEl.getBoundingClientRect(),xPosition=this.config.popup?this.position.x:elRect.left;let skipX=xPosition<=0&&parentRect.left>=e.clientX||parentRect.right<=e.clientX&&parentRect.right<=boundaryElRect.right;return skipX?!0:(isLeft?skipX=diff<0&&e.clientX>xPosition+parentRect.left||diff>0&&e.clientX<xPosition+parentRect.left:anywhereWithin?skipX=diff<0&&e.clientX>boundaryElRect.right||diff>0&&e.clientX<xPosition+parentRect.left:skipX=diff<0&&e.clientX>boundaryElRect.right||diff>0&&e.clientX<boundaryElRect.right,skipX)}shouldSkipY(e,isTop,topBuffer=0,diff){const elRect=this.element.getBoundingClientRect(),parentRect=this.offsetParent.getBoundingClientRect(),boundaryElRect=this.boundaryEl.getBoundingClientRect(),yPosition=this.config.popup?this.position.y:elRect.top;let skipY=yPosition<=0&&parentRect.top>=e.clientY||parentRect.bottom<=e.clientY&&parentRect.bottom<=boundaryElRect.bottom;return skipY?!0:(isTop?skipY=diff<0&&e.clientY>yPosition+parentRect.top+topBuffer||diff>0&&e.clientY<yPosition+parentRect.top:skipY=diff<0&&e.clientY>boundaryElRect.bottom||diff>0&&e.clientY<boundaryElRect.bottom,skipY)}createResizeMap(){const eGui=this.element;this.resizerMap={topLeft:{element:eGui.querySelector("[ref=eTopLeftResizer]")},top:{element:eGui.querySelector("[ref=eTopResizer]")},topRight:{element:eGui.querySelector("[ref=eTopRightResizer]")},right:{element:eGui.querySelector("[ref=eRightResizer]")},bottomRight:{element:eGui.querySelector("[ref=eBottomRightResizer]")},bottom:{element:eGui.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:eGui.querySelector("[ref=eBottomLeftResizer]")},left:{element:eGui.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const eGui=this.element;if(!eGui)return;const resizers=new DOMParser().parseFromString(RESIZE_TEMPLATE,"text/html").body;eGui.appendChild(resizers.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const resizerEl=this.element.querySelector(`.${RESIZE_CONTAINER_STYLE}`);resizerEl&&this.element.removeChild(resizerEl),this.resizersAdded=!1}getResizerElement(side){return this.resizerMap[side].element}onResizeStart(e,side){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!side.match(/top/i),isRight:!!side.match(/right/i),isBottom:!!side.match(/bottom/i),isLeft:!!side.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[side].element.classList.add("ag-active");const{popup,forcePopupParentAsOffsetParent}=this.config;!popup&&!forcePopupParentAsOffsetParent&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const parent=this.element.parentElement;return parent?Array.prototype.slice.call(parent.children).filter(el=>!el.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const siblings=this.getSiblings()||[];let height=0,width=0;for(let i=0;i<siblings.length;i++){const currentEl=siblings[i],isFlex=!!currentEl.style.flex&&currentEl.style.flex!=="0 0 auto";if(currentEl===this.element)continue;let nextHeight=this.minHeight||0,nextWidth=this.minWidth||0;if(isFlex){const computedStyle=window.getComputedStyle(currentEl);computedStyle.minHeight&&(nextHeight=parseInt(computedStyle.minHeight,10)),computedStyle.minWidth&&(nextWidth=parseInt(computedStyle.minWidth,10))}else nextHeight=currentEl.offsetHeight,nextWidth=currentEl.offsetWidth;height+=nextHeight,width+=nextWidth}return{height,width}}applySizeToSiblings(vertical){let containerToFlex=null;const siblings=this.getSiblings();if(siblings){for(let i=0;i<siblings.length;i++){const el=siblings[i];el!==containerToFlex&&(vertical?el.style.height=`${el.offsetHeight}px`:el.style.width=`${el.offsetWidth}px`,el.style.flex="0 0 auto",el===this.element&&(containerToFlex=siblings[i+1]))}containerToFlex&&(containerToFlex.style.removeProperty("height"),containerToFlex.style.removeProperty("min-height"),containerToFlex.style.removeProperty("max-height"),containerToFlex.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(value=>value)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup,forcePopupParentAsOffsetParent}=this.config,{isTop,isRight,isBottom,isLeft}=this.currentResizer,isHorizontal=isRight||isLeft,isVertical=isBottom||isTop,{movementX,movementY}=this.calculateMouseMovement({e,isLeft,isTop}),xPosition=this.position.x,yPosition=this.position.y;let offsetLeft=0,offsetTop=0;if(isHorizontal&&movementX){const direction=isLeft?-1:1,oldWidth=this.getWidth(),newWidth=oldWidth+movementX*direction;let skipWidth=!1;isLeft&&(offsetLeft=oldWidth-newWidth,(xPosition+offsetLeft<=0||newWidth<=this.minWidth)&&(skipWidth=!0,offsetLeft=0)),skipWidth||this.setWidth(newWidth)}if(isVertical&&movementY){const direction=isTop?-1:1,oldHeight=this.getHeight(),newHeight=oldHeight+movementY*direction;let skipHeight=!1;isTop?(offsetTop=oldHeight-newHeight,(yPosition+offsetTop<=0||newHeight<=this.minHeight)&&(skipHeight=!0,offsetTop=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&oldHeight<newHeight&&this.getMinSizeOfSiblings().height+newHeight>this.element.parentElement.offsetHeight&&(skipHeight=!0),skipHeight||this.setHeight(newHeight)}this.updateDragStartPosition(e.clientX,e.clientY),((popup||forcePopupParentAsOffsetParent)&&offsetLeft||offsetTop)&&this.offsetElement(xPosition+offsetLeft,yPosition+offsetTop)}onResizeEnd(e,side){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;const params={type:"resize"};this.element.classList.remove("ag-resizing"),this.resizerMap[side].element.classList.remove("ag-active"),this.dispatchEvent(params)}refreshSize(){const eGui=this.element;this.config.popup&&(this.config.width||this.setWidth(eGui.offsetWidth),this.config.height||this.setHeight(eGui.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x,y}=this.position;let topBuffer;this.config.calculateTopBuffer&&(topBuffer=this.config.calculateTopBuffer());const{movementX,movementY}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer});this.offsetElement(x+movementX,y+movementY),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let el=this.element;for(;el;){if(window.getComputedStyle(el).position!=="static")return el;el=el.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const params=this.resizeListeners.pop();this.dragService.removeDragSource(params)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},__name(_a31,"PositionableFeature"),_a31);__decorateClass([Autowired("popupService")],PositionableFeature.prototype,"popupService",2);__decorateClass([Autowired("resizeObserverService")],PositionableFeature.prototype,"resizeObserverService",2);__decorateClass([Autowired("dragService")],PositionableFeature.prototype,"dragService",2);var _a32,_ProvidedFilter=(_a32=class extends Component{constructor(filterNameKey){super(),this.filterNameKey=filterNameKey,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.buttonListeners=[]}postConstruct(){this.resetTemplate(),this.createManagedBean(new ManagedFocusFeature(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new PositionableFeature(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(paramsMap){let eGui=this.getGui();eGui&&eGui.removeEventListener("submit",this.onFormSubmit);const templateString=`
            <form class="ag-filter-wrapper">
                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">
                    ${this.createBodyTemplate()}
                </div>
            </form>`;this.setTemplate(templateString,paramsMap),eGui=this.getGui(),eGui&&eGui.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(params){this.setParams(params),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(params){this.providedFilterParams=params,this.applyActive=_a32.isUseApplyButton(params),this.resetButtonsPanel()}updateParams(params){this.providedFilterParams=params,this.applyActive=_a32.isUseApplyButton(params),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(){const{buttons}=this.providedFilterParams,hasButtons=buttons&&buttons.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(clearElement(this.eButtonsPanel),this.buttonListeners.forEach(destroyFunc=>destroyFunc==null?void 0:destroyFunc()),this.buttonListeners=[]):hasButtons&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!hasButtons){this.eButtonsPanel&&removeFromParent(this.eButtonsPanel);return}const fragment=document.createDocumentFragment(),addButton=__name(type=>{let text,clickListener;switch(type){case"apply":text=this.translate("applyFilter"),clickListener=__name(e=>this.onBtApply(!1,!1,e),"clickListener");break;case"clear":text=this.translate("clearFilter"),clickListener=__name(()=>this.onBtClear(),"clickListener");break;case"reset":text=this.translate("resetFilter"),clickListener=__name(()=>this.onBtReset(),"clickListener");break;case"cancel":text=this.translate("cancelFilter"),clickListener=__name(e=>{this.onBtCancel(e)},"clickListener");break;default:console.warn("AG Grid: Unknown button type specified");return}const button=loadTemplate(`<button
                    type="${type==="apply"?"submit":"button"}"
                    ref="${type}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${text}
                </button>`);this.buttonListeners.push(this.addManagedListener(button,"click",clickListener)),fragment.append(button)},"addButton");convertToSet(buttons).forEach(type=>addButton(type)),this.eButtonsPanel.append(fragment),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const debounceMs=_a32.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),debounceFunc=debounce(this.checkApplyDebounce.bind(this),debounceMs);this.onBtApplyDebounce=()=>{this.debouncePending=!0,debounceFunc()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(model){return(model!=null?this.setModelIntoUi(model):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(currentModel,afterUiUpdatedFunc){const afterAppliedFunc=__name(()=>{this.onUiChanged(!1,"prevent"),afterUiUpdatedFunc==null||afterUiUpdatedFunc()},"afterAppliedFunc");currentModel!=null?this.setModelIntoUi(currentModel).then(afterAppliedFunc):this.resetUiToDefaults().then(afterAppliedFunc)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(source="api"){const newModel=this.getModelFromUi();if(!this.isModelValid(newModel))return!1;const previousModel=this.appliedModel;return this.appliedModel=newModel,!this.areModelsEqual(previousModel,newModel)}isModelValid(model){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(afterFloatingFilter=!1,afterDataChange=!1,e){e&&e.preventDefault(),this.applyModel(afterDataChange?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter,afterDataChange,source:"columnFilter"});const{closeOnApply}=this.providedFilterParams;closeOnApply&&this.applyActive&&!afterFloatingFilter&&!afterDataChange&&this.close(e)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const keyboardEvent=e,key=keyboardEvent&&keyboardEvent.key;let params;(key==="Enter"||key==="Space")&&(params={keyboardEvent}),this.hidePopup(params),this.hidePopup=null}onUiChanged(fromFloatingFilter=!1,apply){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const isValid=this.isModelValid(this.getModelFromUi()),applyFilterButton=this.getRefElement("applyFilterButton");applyFilterButton&&setDisabled(applyFilterButton,!isValid)}fromFloatingFilter&&!apply||apply==="immediately"?this.onBtApply(fromFloatingFilter):(!this.applyActive&&!apply||apply==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(params){params&&(this.hidePopup=params.hidePopup),this.refreshFilterResizer(params==null?void 0:params.container)}refreshFilterResizer(containerType){if(!this.positionableFeature||containerType==="toolPanel")return;const isResizable=containerType==="floatingFilter"||containerType==="columnFilter",{positionableFeature,gridOptionsService}=this;isResizable?(positionableFeature.restoreLastSize(),positionableFeature.setResizable(gridOptionsService.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(params,debounceDefault){return _a32.isUseApplyButton(params)?(params.debounceMs!=null&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):params.debounceMs!=null?params.debounceMs:debounceDefault}static isUseApplyButton(params){return!!params.buttons&&params.buttons.indexOf("apply")>=0}refresh(newParams){return this.providedFilterParams=newParams,!0}destroy(){const eGui=this.getGui();eGui&&eGui.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(key){return this.localeService.getLocaleTextFunc()(key,FILTER_LOCALE_TEXT[key])}getCellValue(rowNode){return this.providedFilterParams.getValue(rowNode)}getPositionableElement(){return this.eFilterBody}},__name(_a32,"_ProvidedFilter"),_a32);__decorateClass([Autowired("rowModel")],_ProvidedFilter.prototype,"rowModel",2);__decorateClass([RefSelector("eFilterBody")],_ProvidedFilter.prototype,"eFilterBody",2);__decorateClass([PostConstruct],_ProvidedFilter.prototype,"postConstruct",1);var ProvidedFilter=_ProvidedFilter,_a33,AgAbstractLabel=(_a33=class extends Component{constructor(config,template){super(template),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=config||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator,label,labelWidth,labelAlignment,disabled}=this.config;disabled!=null&&this.setDisabled(disabled),labelSeparator!=null&&this.setLabelSeparator(labelSeparator),label!=null&&this.setLabel(label),labelWidth!=null&&this.setLabelWidth(labelWidth),this.setLabelAlignment(labelAlignment||this.labelAlignment),this.refreshLabel()}refreshLabel(){clearElement(this.eLabel),typeof this.label=="string"?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),this.label===""?(setDisplayed(this.eLabel,!1),setAriaRole(this.eLabel,"presentation")):(setDisplayed(this.eLabel,!0),setAriaRole(this.eLabel,null))}setLabelSeparator(labelSeparator){return this.labelSeparator===labelSeparator?this:(this.labelSeparator=labelSeparator,this.label!=null&&this.refreshLabel(),this)}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(label){return this.label===label?this:(this.label=label,this.refreshLabel(),this)}setLabelAlignment(alignment){const eGuiClassList=this.getGui().classList;return eGuiClassList.toggle("ag-label-align-left",alignment==="left"),eGuiClassList.toggle("ag-label-align-right",alignment==="right"),eGuiClassList.toggle("ag-label-align-top",alignment==="top"),this}setLabelEllipsis(hasEllipsis){return this.eLabel.classList.toggle("ag-label-ellipsis",hasEllipsis),this}setLabelWidth(width){return this.label==null?this:(setElementWidth(this.eLabel,width),this)}setDisabled(disabled){disabled=!!disabled;const element=this.getGui();return setDisabled(element,disabled),element.classList.toggle("ag-disabled",disabled),this.disabled=disabled,this}isDisabled(){return!!this.disabled}},__name(_a33,"AgAbstractLabel"),_a33);__decorateClass([PostConstruct],AgAbstractLabel.prototype,"postConstruct",1);var _a34,AgAbstractField=(_a34=class extends AgAbstractLabel{constructor(config,template,className){super(config,template),this.className=className}postConstruct(){super.postConstruct();const{width,value,onValueChange}=this.config;width!=null&&this.setWidth(width),value!=null&&this.setValue(value),onValueChange!=null&&this.onValueChange(onValueChange),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}refreshAriaLabelledBy(){const ariaEl=this.getAriaElement(),labelId=this.getLabelId();getAriaLabel(ariaEl)!==null?setAriaLabelledBy(ariaEl,""):setAriaLabelledBy(ariaEl,labelId??"")}setAriaLabel(label){return setAriaLabel(this.getAriaElement(),label),this.refreshAriaLabelledBy(),this}onValueChange(callbackFn){return this.addManagedListener(this,Events.EVENT_FIELD_VALUE_CHANGED,()=>callbackFn(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(width){return setFixedWidth(this.getGui(),width),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(value,silent){return this.value===value?this:(this.previousValue=this.value,this.value=value,silent||this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED}),this)}},__name(_a34,"AgAbstractField"),_a34),TEMPLATE=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,_a35,AgPickerField=(_a35=class extends AgAbstractField{constructor(config){if(super(config,(config==null?void 0:config.template)||TEMPLATE,config==null?void 0:config.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.ariaRole=config==null?void 0:config.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!config)return;const{pickerGap,maxPickerHeight,variableWidth,minPickerWidth,maxPickerWidth}=config;pickerGap!=null&&(this.pickerGap=pickerGap),this.variableWidth=!!variableWidth,maxPickerHeight!=null&&this.setPickerMaxHeight(maxPickerHeight),minPickerWidth!=null&&this.setPickerMinWidth(minPickerWidth),maxPickerWidth!=null&&this.setPickerMaxWidth(maxPickerWidth)}postConstruct(){super.postConstruct(),this.setupAria();const displayId=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",displayId);const ariaEl=this.getAriaElement();this.addManagedListener(ariaEl,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"mousedown",this.onLabelOrWrapperMouseDown.bind(this)),this.addManagedListener(this.eWrapper,"mousedown",this.onLabelOrWrapperMouseDown.bind(this));const{pickerIcon,inputWidth}=this.config;if(pickerIcon){const icon=createIconNoSpan(pickerIcon,this.gridOptionsService);icon&&this.eIcon.appendChild(icon)}inputWidth!=null&&this.setInputWidth(inputWidth)}setupAria(){const ariaEl=this.getAriaElement();ariaEl.setAttribute("tabindex",this.gridOptionsService.get("tabIndex").toString()),setAriaExpanded(ariaEl,!1),this.ariaRole&&setAriaRole(ariaEl,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const focusableEl=this.getFocusableElement();if(focusableEl!==this.eWrapper&&(e==null?void 0:e.target)===focusableEl)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case KeyCode.UP:case KeyCode.DOWN:case KeyCode.ENTER:case KeyCode.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case KeyCode.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const pickerGui=this.pickerComponent.getGui();pickerGui.addEventListener("focusin",this.onPickerFocusIn),pickerGui.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const eDocument=this.gridOptionsService.getDocument(),ePicker=this.pickerComponent.getGui();this.gridOptionsService.get("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,()=>{this.hidePicker()}));const translate=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey,pickerAriaLabelValue,modalPicker=!0}=this.config,popupParams={modal:modalPicker,eChild:ePicker,closeOnEsc:!0,closedCallback:()=>{const shouldRestoreFocus=eDocument.activeElement===eDocument.body;this.beforeHidePicker(),shouldRestoreFocus&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:translate(pickerAriaLabelKey,pickerAriaLabelValue)},addPopupRes=this.popupService.addPopup(popupParams),{maxPickerHeight,minPickerWidth,maxPickerWidth,variableWidth}=this;variableWidth?(minPickerWidth&&(ePicker.style.minWidth=minPickerWidth),ePicker.style.width=formatSize(getAbsoluteWidth(this.eWrapper)),maxPickerWidth&&(ePicker.style.maxWidth=maxPickerWidth)):setElementWidth(ePicker,maxPickerWidth??getAbsoluteWidth(this.eWrapper));const maxHeight=maxPickerHeight??`${getInnerHeight(this.popupService.getPopupParent())}px`;return ePicker.style.setProperty("max-height",maxHeight),ePicker.style.position="absolute",this.alignPickerToComponent(),addPopupRes.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType}=this.config,{pickerGap}=this,alignSide=this.gridOptionsService.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:pickerType,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide,keepWithinBounds:!0,nudgeY:pickerGap})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const pickerGui=this.pickerComponent.getGui();pickerGui.removeEventListener("focusin",this.onPickerFocusIn),pickerGui.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(expanded){if(!this.isAlive())return;const ariaEl=this.getAriaElement();setAriaExpanded(ariaEl,expanded),this.eWrapper.classList.toggle("ag-picker-expanded",expanded),this.eWrapper.classList.toggle("ag-picker-collapsed",!expanded)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var _a273;(_a273=this.pickerComponent)!=null&&_a273.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(focused){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",focused)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(width){return setElementWidth(this.eWrapper,width),this}getFocusableElement(){return this.eWrapper}setPickerGap(gap){return this.pickerGap=gap,this}setPickerMinWidth(width){return typeof width=="number"&&(width=`${width}px`),this.minPickerWidth=width??void 0,this}setPickerMaxWidth(width){return typeof width=="number"&&(width=`${width}px`),this.maxPickerWidth=width??void 0,this}setPickerMaxHeight(height){return typeof height=="number"&&(height=`${height}px`),this.maxPickerHeight=height??void 0,this}destroy(){this.hidePicker(),super.destroy()}},__name(_a35,"AgPickerField"),_a35);__decorateClass([Autowired("popupService")],AgPickerField.prototype,"popupService",2);__decorateClass([RefSelector("eLabel")],AgPickerField.prototype,"eLabel",2);__decorateClass([RefSelector("eWrapper")],AgPickerField.prototype,"eWrapper",2);__decorateClass([RefSelector("eDisplayField")],AgPickerField.prototype,"eDisplayField",2);__decorateClass([RefSelector("eIcon")],AgPickerField.prototype,"eIcon",2);var _a36,_AgList=(_a36=class extends Component{constructor(cssIdentifier="default",unFocusable=!1){super(`<div class="ag-list ag-${cssIdentifier}-list" role="listbox"></div>`),this.cssIdentifier=cssIdentifier,this.unFocusable=unFocusable,this.options=[],this.itemEls=[]}init(){const eGui=this.getGui();this.addManagedListener(eGui,"mouseleave",()=>this.clearHighlighted()),!this.unFocusable&&this.addManagedListener(eGui,"keydown",this.handleKeyDown.bind(this))}handleKeyDown(e){const key=e.key;switch(key){case KeyCode.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const pos=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(pos)}break;case KeyCode.DOWN:case KeyCode.UP:const isDown=key===KeyCode.DOWN;let itemToHighlight;if(e.preventDefault(),!this.highlightedEl)itemToHighlight=this.itemEls[isDown?0:this.itemEls.length-1];else{let nextPos=this.itemEls.indexOf(this.highlightedEl)+(isDown?1:-1);nextPos=Math.min(Math.max(nextPos,0),this.itemEls.length-1),itemToHighlight=this.itemEls[nextPos]}this.highlightItem(itemToHighlight);break}}addOptions(listOptions){return listOptions.forEach(listOption=>this.addOption(listOption)),this}addOption(listOption){const{value,text}=listOption,valueToRender=text||value;return this.options.push({value,text:valueToRender}),this.renderOption(value,valueToRender),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(itemEl=>{removeFromParent(itemEl)}),this.itemEls=[]}updateIndices(){const options=this.getGui().querySelectorAll(".ag-list-item");options.forEach((option,idx)=>{setAriaPosInSet(option,idx+1),setAriaSetSize(option,options.length)})}renderOption(value,text){const eDocument=this.gridOptionsService.getDocument(),itemEl=eDocument.createElement("div");setAriaRole(itemEl,"option"),itemEl.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const span=eDocument.createElement("span");itemEl.appendChild(span),span.innerText=text,this.unFocusable||(itemEl.tabIndex=-1),this.itemEls.push(itemEl),this.addManagedListener(itemEl,"mousemove",()=>this.highlightItem(itemEl)),this.addManagedListener(itemEl,"mousedown",e=>{e.preventDefault(),this.setValue(value)}),this.createManagedBean(new TooltipFeature({getTooltipValue:()=>text,getGui:()=>itemEl,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>span.scrollWidth>span.clientWidth})),this.getGui().appendChild(itemEl)}setValue(value,silent){if(this.value===value)return this.fireItemSelected(),this;if(value==null)return this.reset(silent),this;const idx=this.options.findIndex(option=>option.value===value);if(idx!==-1){const option=this.options[idx];this.value=option.value,this.displayValue=option.text,this.highlightItem(this.itemEls[idx]),silent||this.fireChangeEvent()}return this}setValueByIndex(idx){return this.setValue(this.options[idx].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const idx=this.options.findIndex(option=>option.value===this.value);idx!==-1&&this.highlightItem(this.itemEls[idx])}reset(silent){this.value=null,this.displayValue=null,this.clearHighlighted(),silent||this.fireChangeEvent()}highlightItem(el){if(!isVisible(el))return;this.clearHighlighted(),this.highlightedEl=el,this.highlightedEl.classList.add(_a36.ACTIVE_CLASS),setAriaSelected(this.highlightedEl,!0);const eGui=this.getGui(),rect=eGui.getBoundingClientRect(),currentTop=rect.top+eGui.scrollTop,height=rect.height,{offsetTop,offsetHeight}=el;(offsetTop+offsetHeight>currentTop+height||offsetTop<currentTop)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){!this.highlightedEl||!isVisible(this.highlightedEl)||(this.highlightedEl.classList.remove(_a36.ACTIVE_CLASS),setAriaSelected(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:_a36.EVENT_ITEM_SELECTED})}},__name(_a36,"_AgList"),_a36);_AgList.EVENT_ITEM_SELECTED="selectedItem";_AgList.ACTIVE_CLASS="ag-active-item";__decorateClass([PostConstruct],_AgList.prototype,"init",1);var AgList=_AgList,_a37,_AgSelect=(_a37=class extends AgPickerField{constructor(config){super(__spreadValues({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox"},config))}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gridOptionsService.get("tabIndex");const{options,value,placeholder}=this.config;options!=null&&this.addOptions(options),value!=null&&this.setValue(value,!0),placeholder&&value==null&&(this.eDisplayField.textContent=placeholder),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new AgList("select",!0)),this.listComponent.setParentComponent(this);const eListAriaEl=this.listComponent.getAriaElement(),listId=`ag-select-list-${this.listComponent.getCompId()}`;eListAriaEl.setAttribute("id",listId),setAriaControls(this.getAriaElement(),eListAriaEl),this.listComponent.addManagedListener(this.listComponent,AgList.EVENT_ITEM_SELECTED,()=>{this.hidePicker(),this.dispatchEvent({type:_a37.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,Events.EVENT_FIELD_VALUE_CHANGED,()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())})}createPickerComponent(){return this.listComponent}onKeyDown(e){var _a273;const{key}=e;key===KeyCode.TAB?this.hidePicker():!this.isPickerDisplayed||key!==KeyCode.ENTER&&key!==KeyCode.UP&&key!==KeyCode.DOWN?super.onKeyDown(e):(_a273=this.listComponent)==null||_a273.handleKeyDown(e)}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(options){return options.forEach(option=>this.addOption(option)),this}addOption(option){return this.listComponent.addOption(option),this}clearOptions(){var _a273;return(_a273=this.listComponent)==null||_a273.clearOptions(),this}setValue(value,silent,fromPicker){if(this.value===value||!this.listComponent)return this;if(fromPicker||this.listComponent.setValue(value,!0),this.listComponent.getValue()===this.getValue())return this;let displayValue=this.listComponent.getDisplayValue();return displayValue==null&&this.config.placeholder&&(displayValue=this.config.placeholder),this.eDisplayField.innerHTML=displayValue,this.setTooltip({newTooltipText:displayValue??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(value,silent)}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),super.destroy()}},__name(_a37,"_AgSelect"),_a37);_AgSelect.EVENT_ITEM_SELECTED="selectedItem";var AgSelect=_AgSelect,_a38,AgAbstractInputField=(_a38=class extends AgAbstractField{constructor(config,className,inputType="text",displayFieldTag="input"){super(config,`
            <div role="presentation">
                <div ref="eLabel" class="ag-input-field-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">
                    <${displayFieldTag} ref="eInput" class="ag-input-field-input"></${displayFieldTag}>
                </div>
            </div>`,className),this.inputType=inputType,this.displayFieldTag=displayFieldTag}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName,inputWidth}=this.config;inputName!=null&&this.setInputName(inputName),inputWidth!=null&&this.setInputWidth(inputWidth),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>this.setValue(e.target.value))}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(width){return setElementWidth(this.eWrapper,width),this}setInputName(name){return this.getInputElement().setAttribute("name",name),this}getFocusableElement(){return this.eInput}setMaxLength(length){const eInput=this.eInput;return eInput.maxLength=length,this}setInputPlaceholder(placeholder){return addOrRemoveAttribute(this.eInput,"placeholder",placeholder),this}setInputAriaLabel(label){return setAriaLabel(this.eInput,label),this.refreshAriaLabelledBy(),this}setDisabled(disabled){return setDisabled(this.eInput,disabled),super.setDisabled(disabled)}setAutoComplete(value){if(value===!0)addOrRemoveAttribute(this.eInput,"autocomplete",null);else{const autoCompleteValue=typeof value=="string"?value:"off";addOrRemoveAttribute(this.eInput,"autocomplete",autoCompleteValue)}return this}},__name(_a38,"AgAbstractInputField"),_a38);__decorateClass([RefSelector("eLabel")],AgAbstractInputField.prototype,"eLabel",2);__decorateClass([RefSelector("eWrapper")],AgAbstractInputField.prototype,"eWrapper",2);__decorateClass([RefSelector("eInput")],AgAbstractInputField.prototype,"eInput",2);var _a39,AgCheckbox=(_a39=class extends AgAbstractInputField{constructor(config,className="ag-checkbox",inputType="checkbox"){super(config,className,inputType),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly,passive}=this.config;typeof readOnly=="boolean"&&this.setReadOnly(readOnly),typeof passive=="boolean"&&this.setPassive(passive)}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(passive){this.passive=passive}isReadOnly(){return this.readOnly}setReadOnly(readOnly){this.eWrapper.classList.toggle("ag-disabled",readOnly),this.eInput.disabled=readOnly,this.readOnly=readOnly}setDisabled(disabled){return this.eWrapper.classList.toggle("ag-disabled",disabled),super.setDisabled(disabled)}toggle(){if(this.eInput.disabled)return;const previousValue=this.isSelected(),nextValue=this.getNextValue();this.passive?this.dispatchChange(nextValue,previousValue):this.setValue(nextValue)}getValue(){return this.isSelected()}setValue(value,silent){return this.refreshSelectedClass(value),this.setSelected(value,silent),this}setName(name){const input=this.getInputElement();return input.name=name,this}isSelected(){return this.selected}setSelected(selected,silent){this.isSelected()!==selected&&(this.previousValue=this.isSelected(),selected=this.selected=typeof selected=="boolean"?selected:void 0,this.eInput.checked=selected,this.eInput.indeterminate=selected===void 0,silent||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(selected,previousValue,event){this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED,selected,previousValue,event});const input=this.getInputElement(),checkboxChangedEvent={type:Events.EVENT_CHECKBOX_CHANGED,id:input.id,name:input.name,selected,previousValue};this.eventService.dispatchEvent(checkboxChangedEvent)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const previousValue=this.isSelected(),selected=this.selected=e.target.checked;this.refreshSelectedClass(selected),this.dispatchChange(selected,previousValue,e)}refreshSelectedClass(value){this.eWrapper.classList.toggle("ag-checked",value===!0),this.eWrapper.classList.toggle("ag-indeterminate",value==null)}},__name(_a39,"AgCheckbox"),_a39),_a40,AgRadioButton=(_a40=class extends AgCheckbox{constructor(config){super(config,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,Events.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(event){event.selected&&event.name&&this.eInput.name&&this.eInput.name===event.name&&event.id&&this.eInput.id!==event.id&&this.setValue(!1,!0)}},__name(_a40,"AgRadioButton"),_a40),_a41,SimpleFilterModelFormatter=(_a41=class{constructor(localeService,optionsFactory,valueFormatter){this.localeService=localeService,this.optionsFactory=optionsFactory,this.valueFormatter=valueFormatter}getModelAsString(model){if(!model)return null;const isCombined=model.operator!=null,translate=this.localeService.getLocaleTextFunc();if(isCombined){const combinedModel=model;let{conditions}=combinedModel;if(!conditions){const{condition1,condition2}=combinedModel;conditions=[condition1,condition2]}const customOptions=conditions.map(condition=>this.getModelAsString(condition)),joinOperatorTranslateKey=combinedModel.operator==="AND"?"andCondition":"orCondition";return customOptions.join(` ${translate(joinOperatorTranslateKey,FILTER_LOCALE_TEXT[joinOperatorTranslateKey])} `)}else{if(model.type===SimpleFilter.BLANK||model.type===SimpleFilter.NOT_BLANK)return translate(model.type,model.type);{const condition=model,customOption=this.optionsFactory.getCustomOption(condition.type),{displayKey,displayName,numberOfInputs}=customOption||{};return displayKey&&displayName&&numberOfInputs===0?(translate(displayKey,displayName),displayName):this.conditionToString(condition,customOption)}}}updateParams(params){this.optionsFactory=params.optionsFactory}formatValue(value){var _a273;return this.valueFormatter?(_a273=this.valueFormatter(value??null))!=null?_a273:"":String(value)}},__name(_a41,"SimpleFilterModelFormatter"),_a41),_a42,_SimpleFilter=(_a42=class extends ProvidedFilter{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(type){const customOpts=this.optionsFactory.getCustomOption(type);if(customOpts){const{numberOfInputs}=customOpts;return numberOfInputs??1}const zeroInputTypes=[_a42.EMPTY,_a42.NOT_BLANK,_a42.BLANK];return type&&zeroInputTypes.indexOf(type)>=0?0:type===_a42.IN_RANGE?2:1}onFloatingFilterChanged(type,value){this.setTypeFromFloatingFilter(type),this.setValueFromFloatingFilter(value),this.onUiChanged(!0)}setTypeFromFloatingFilter(type){this.eTypes.forEach((eType,position)=>{position===0?eType.setValue(type,!0):eType.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const conditions=this.getUiCompleteConditions();return conditions.length===0?null:this.maxNumConditions>1&&conditions.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:conditions[0],condition2:conditions[1],conditions}:conditions[0]}getConditionTypes(){return this.eTypes.map(eType=>eType.getValue())}getConditionType(position){return this.eTypes[position].getValue()}getJoinOperator(){return this.eJoinOperatorsOr.length===0?this.defaultJoinOperator:this.eJoinOperatorsOr[0].getValue()===!0?"OR":"AND"}areModelsEqual(a,b){if(!a&&!b)return!0;if(!a&&b||a&&!b)return!1;const aIsSimple=!a.operator,bIsSimple=!b.operator;if(!aIsSimple&&bIsSimple||aIsSimple&&!bIsSimple)return!1;let res;if(aIsSimple){const aSimple=a,bSimple=b;res=this.areSimpleModelsEqual(aSimple,bSimple)}else{const aCombined=a,bCombined=b;res=aCombined.operator===bCombined.operator&&areEqual(aCombined.conditions,bCombined.conditions,(aModel,bModel)=>this.areSimpleModelsEqual(aModel,bModel))}return res}shouldRefresh(newParams){var _a273,_b,_c;const model=this.getModel(),conditions=model?(_a273=model.conditions)!=null?_a273:[model]:null,newOptionsList=(_c=(_b=newParams.filterOptions)==null?void 0:_b.map(option=>typeof option=="string"?option:option.displayKey))!=null?_c:this.getDefaultFilterOptions();return!(!(!conditions||conditions.every(condition=>newOptionsList.find(option=>option===condition.type)!==void 0))||typeof newParams.maxNumConditions=="number"&&conditions&&conditions.length>newParams.maxNumConditions)}refresh(newParams){return!this.shouldRefresh(newParams)||!super.refresh(newParams)?!1:(this.setParams(newParams),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(model){if(model.operator){let combinedModel=model;combinedModel.conditions||(combinedModel.conditions=[combinedModel.condition1,combinedModel.condition2]);const numConditions=this.validateAndUpdateConditions(combinedModel.conditions),numPrevConditions=this.getNumConditions();if(numConditions<numPrevConditions)this.removeConditionsAndOperators(numConditions);else if(numConditions>numPrevConditions)for(let i=numPrevConditions;i<numConditions;i++)this.createJoinOperatorPanel(),this.createOption();const orChecked=combinedModel.operator==="OR";this.eJoinOperatorsAnd.forEach(eJoinOperatorAnd=>eJoinOperatorAnd.setValue(!orChecked,!0)),this.eJoinOperatorsOr.forEach(eJoinOperatorOr=>eJoinOperatorOr.setValue(orChecked,!0)),combinedModel.conditions.forEach((condition,position)=>{this.eTypes[position].setValue(condition.type,!0),this.setConditionIntoUi(condition,position)})}else{const simpleModel=model;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(simpleModel.type,!0),this.setConditionIntoUi(simpleModel,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),AgPromise.resolve()}validateAndUpdateConditions(conditions){let numConditions=conditions.length;return numConditions>this.maxNumConditions&&(conditions.splice(this.maxNumConditions),warnOnce('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),numConditions=this.maxNumConditions),numConditions}doesFilterPass(params){var _a273;const model=this.getModel();if(model==null)return!0;const{operator}=model,models=[];if(operator){const combinedModel=model;models.push(...(_a273=combinedModel.conditions)!=null?_a273:[])}else models.push(model);return models[operator&&operator==="OR"?"some":"every"](m=>this.individualConditionPasses(params,m))}setParams(params){super.setParams(params),this.setNumConditions(params),this.defaultJoinOperator=this.getDefaultJoinOperator(params.defaultJoinOperator),this.filterPlaceholder=params.filterPlaceholder,this.optionsFactory=new OptionsFactory,this.optionsFactory.init(params,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(params){var _a273,_b;params.suppressAndOrCondition!=null&&warnOnce('Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),params.alwaysShowBothConditions!=null&&warnOnce('Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),this.maxNumConditions=(_a273=params.maxNumConditions)!=null?_a273:params.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(warnOnce('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=(_b=params.numAlwaysVisibleConditions)!=null?_b:params.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(warnOnce('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(warnOnce('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const eType=this.createManagedBean(new AgSelect);this.eTypes.push(eType),eType.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(eType.getGui());const eConditionBody=this.createValueElement();this.eConditionBodies.push(eConditionBody),this.eFilterBody.appendChild(eConditionBody),this.putOptionsIntoDropdown(eType),this.resetType(eType);const position=this.getNumConditions()-1;this.forEachPositionInput(position,element=>this.resetInput(element)),this.addChangedListeners(eType,position)}createJoinOperatorPanel(){const eJoinOperatorPanel=document.createElement("div");this.eJoinOperatorPanels.push(eJoinOperatorPanel),eJoinOperatorPanel.classList.add("ag-filter-condition");const eJoinOperatorAnd=this.createJoinOperator(this.eJoinOperatorsAnd,eJoinOperatorPanel,"and"),eJoinOperatorOr=this.createJoinOperator(this.eJoinOperatorsOr,eJoinOperatorPanel,"or");this.eFilterBody.appendChild(eJoinOperatorPanel);const index=this.eJoinOperatorPanels.length-1,uniqueGroupId=this.joinOperatorId++;this.resetJoinOperatorAnd(eJoinOperatorAnd,index,uniqueGroupId),this.resetJoinOperatorOr(eJoinOperatorOr,index,uniqueGroupId),this.isReadOnly()||(eJoinOperatorAnd.onValueChange(this.listener),eJoinOperatorOr.onValueChange(this.listener))}createJoinOperator(eJoinOperators,eJoinOperatorPanel,andOr){const eJoinOperator=this.createManagedBean(new AgRadioButton);return eJoinOperators.push(eJoinOperator),eJoinOperator.addCssClass("ag-filter-condition-operator"),eJoinOperator.addCssClass(`ag-filter-condition-operator-${andOr}`),eJoinOperatorPanel.appendChild(eJoinOperator.getGui()),eJoinOperator}getDefaultJoinOperator(defaultJoinOperator){return defaultJoinOperator==="AND"||defaultJoinOperator==="OR"?defaultJoinOperator:"AND"}createFilterListOptions(){const filterOptions=this.optionsFactory.getFilterOptions();this.filterListOptions=filterOptions.map(option=>typeof option=="string"?this.createBoilerplateListOption(option):this.createCustomListOption(option))}putOptionsIntoDropdown(eType){this.filterListOptions.forEach(listOption=>{eType.addOption(listOption)}),eType.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(option){return{value:option,text:this.translate(option)}}createCustomListOption(option){const{displayKey}=option,customOption=this.optionsFactory.getCustomOption(option.displayKey);return{value:displayKey,text:customOption?this.localeService.getLocaleTextFunc()(customOption.displayKey,customOption.displayName):this.translate(displayKey)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const joinOperator=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,joinOperator)}updateNumConditions(){var _a273;let lastUiCompletePosition=-1,areAllConditionsUiComplete=!0;for(let position=0;position<this.getNumConditions();position++)this.isConditionUiComplete(position)?lastUiCompletePosition=position:areAllConditionsUiComplete=!1;if(this.shouldAddNewConditionAtEnd(areAllConditionsUiComplete))this.createJoinOperatorPanel(),this.createOption();else{const activePosition=(_a273=this.lastUiCompletePosition)!=null?_a273:this.getNumConditions()-2;if(lastUiCompletePosition<activePosition){this.removeConditionsAndOperators(activePosition+1);const removeStartPosition=lastUiCompletePosition+1,numConditionsToRemove=activePosition-removeStartPosition;numConditionsToRemove>0&&this.removeConditionsAndOperators(removeStartPosition,numConditionsToRemove),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=lastUiCompletePosition}updateConditionStatusesAndValues(lastUiCompletePosition,joinOperator){this.eTypes.forEach((eType,position)=>{const disabled=this.isConditionDisabled(position,lastUiCompletePosition);eType.setDisabled(disabled||this.filterListOptions.length<=1),position===1&&(setDisabled(this.eJoinOperatorPanels[0],disabled),this.eJoinOperatorsAnd[0].setDisabled(disabled),this.eJoinOperatorsOr[0].setDisabled(disabled))}),this.eConditionBodies.forEach((element,index)=>{setDisplayed(element,this.isConditionBodyVisible(index))});const orChecked=(joinOperator??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach((eJoinOperatorAnd,index)=>{eJoinOperatorAnd.setValue(!orChecked,!0)}),this.eJoinOperatorsOr.forEach((eJoinOperatorOr,index)=>{eJoinOperatorOr.setValue(orChecked,!0)}),this.forEachInput((element,index,position,numberOfInputs)=>{this.setElementDisplayed(element,index<numberOfInputs),this.setElementDisabled(element,this.isConditionDisabled(position,lastUiCompletePosition))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(areAllConditionsUiComplete){return areAllConditionsUiComplete&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(startPosition,deleteCount){if(startPosition>=this.getNumConditions())return;this.removeComponents(this.eTypes,startPosition,deleteCount),this.removeElements(this.eConditionBodies,startPosition,deleteCount),this.removeValueElements(startPosition,deleteCount);const joinOperatorIndex=Math.max(startPosition-1,0);this.removeElements(this.eJoinOperatorPanels,joinOperatorIndex,deleteCount),this.removeComponents(this.eJoinOperatorsAnd,joinOperatorIndex,deleteCount),this.removeComponents(this.eJoinOperatorsOr,joinOperatorIndex,deleteCount)}removeElements(elements,startPosition,deleteCount){this.removeItems(elements,startPosition,deleteCount).forEach(element=>removeFromParent(element))}removeComponents(components,startPosition,deleteCount){this.removeItems(components,startPosition,deleteCount).forEach(comp=>{removeFromParent(comp.getGui()),this.destroyBean(comp)})}removeItems(items,startPosition,deleteCount){return deleteCount==null?items.splice(startPosition):items.splice(startPosition,deleteCount)}afterGuiAttached(params){if(super.afterGuiAttached(params),this.resetPlaceholder(),!(params!=null&&params.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{const firstInput=this.getInputs(0)[0];if(!firstInput)return;firstInput instanceof AgAbstractInputField&&firstInput.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const appliedModel=this.getModel();this.resetUiToActiveModel(appliedModel);let lastUiCompletePosition=-1,updatedLastUiCompletePosition=-1,conditionsRemoved=!1;const joinOperator=this.getJoinOperator();for(let position=this.getNumConditions()-1;position>=0;position--)if(this.isConditionUiComplete(position))lastUiCompletePosition===-1&&(lastUiCompletePosition=position,updatedLastUiCompletePosition=position);else{const shouldRemovePositionAtEnd=position>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(position-1),positionBeforeLastUiCompletePosition=position<lastUiCompletePosition;(shouldRemovePositionAtEnd||positionBeforeLastUiCompletePosition)&&(this.removeConditionsAndOperators(position,1),conditionsRemoved=!0,positionBeforeLastUiCompletePosition&&updatedLastUiCompletePosition--)}let shouldUpdateConditionStatusesAndValues=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),shouldUpdateConditionStatusesAndValues=!0),this.shouldAddNewConditionAtEnd(updatedLastUiCompletePosition===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),shouldUpdateConditionStatusesAndValues=!0),shouldUpdateConditionStatusesAndValues&&this.updateConditionStatusesAndValues(updatedLastUiCompletePosition,joinOperator),conditionsRemoved&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=updatedLastUiCompletePosition}getPlaceholderText(defaultPlaceholder,position){let placeholder=this.translate(defaultPlaceholder);if(isFunction(this.filterPlaceholder)){const filterPlaceholderFn=this.filterPlaceholder,filterOptionKey=this.eTypes[position].getValue(),filterOption=this.translate(filterOptionKey);placeholder=filterPlaceholderFn({filterOptionKey,filterOption,placeholder})}else typeof this.filterPlaceholder=="string"&&(placeholder=this.filterPlaceholder);return placeholder}resetPlaceholder(){const globalTranslate=this.localeService.getLocaleTextFunc();this.forEachInput((element,index,position,numberOfInputs)=>{if(!(element instanceof AgAbstractInputField))return;const placeholder=index===0&&numberOfInputs>1?"inRangeStart":index===0?"filterOoo":"inRangeEnd",ariaLabel=index===0&&numberOfInputs>1?globalTranslate("ariaFilterFromValue","Filter from value"):index===0?globalTranslate("ariaFilterValue","Filter Value"):globalTranslate("ariaFilterToValue","Filter to Value");element.setInputPlaceholder(this.getPlaceholderText(placeholder,position)),element.setInputAriaLabel(ariaLabel)})}setElementValue(element,value,fromFloatingFilter){element instanceof AgAbstractInputField&&element.setValue(value!=null?String(value):null,!0)}setElementDisplayed(element,displayed){element instanceof Component&&setDisplayed(element.getGui(),displayed)}setElementDisabled(element,disabled){element instanceof Component&&setDisabled(element.getGui(),disabled)}attachElementOnChange(element,listener){element instanceof AgAbstractInputField&&element.onValueChange(listener)}forEachInput(cb){this.getConditionTypes().forEach((type,position)=>{this.forEachPositionTypeInput(position,type,cb)})}forEachPositionInput(position,cb){const type=this.getConditionType(position);this.forEachPositionTypeInput(position,type,cb)}forEachPositionTypeInput(position,type,cb){const numberOfInputs=this.getNumberOfInputs(type),inputs=this.getInputs(position);for(let index=0;index<inputs.length;index++){const input=inputs[index];input!=null&&cb(input,index,position,numberOfInputs)}}isConditionDisabled(position,lastUiCompletePosition){return this.isReadOnly()?!0:position===0?!1:position>lastUiCompletePosition+1}isConditionBodyVisible(position){const type=this.getConditionType(position);return this.getNumberOfInputs(type)>0}isConditionUiComplete(position){return!(position>=this.getNumConditions()||this.getConditionType(position)===_a42.EMPTY||this.getValues(position).some(v=>v==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const conditions=[];for(let position=0;position<this.getNumConditions();position++)this.isConditionUiComplete(position)&&conditions.push(this.createCondition(position));return conditions}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let i=this.getNumConditions();i<this.numAlwaysVisibleConditions;i++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(silent){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(eType=>this.resetType(eType)),this.eJoinOperatorsAnd.forEach((eJoinOperatorAnd,index)=>this.resetJoinOperatorAnd(eJoinOperatorAnd,index,this.joinOperatorId+index)),this.eJoinOperatorsOr.forEach((eJoinOperatorOr,index)=>this.resetJoinOperatorOr(eJoinOperatorOr,index,this.joinOperatorId+index)),this.joinOperatorId++,this.forEachInput(element=>this.resetInput(element)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,silent||this.onUiChanged(),AgPromise.resolve()}resetType(eType){const filteringLabel=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");eType.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(filteringLabel).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(eJoinOperatorAnd,index,uniqueGroupId){this.resetJoinOperator(eJoinOperatorAnd,index,this.isDefaultOperator("AND"),this.translate("andCondition"),uniqueGroupId)}resetJoinOperatorOr(eJoinOperatorOr,index,uniqueGroupId){this.resetJoinOperator(eJoinOperatorOr,index,this.isDefaultOperator("OR"),this.translate("orCondition"),uniqueGroupId)}resetJoinOperator(eJoinOperator,index,value,label,uniqueGroupId){this.updateJoinOperatorDisabled(eJoinOperator.setValue(value,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${uniqueGroupId}`).setLabel(label),index)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((eJoinOperator,index)=>this.updateJoinOperatorDisabled(eJoinOperator,index)),this.eJoinOperatorsOr.forEach((eJoinOperator,index)=>this.updateJoinOperatorDisabled(eJoinOperator,index))}updateJoinOperatorDisabled(eJoinOperator,index){eJoinOperator.setDisabled(this.isReadOnly()||index>0)}resetInput(element){this.setElementValue(element,null),this.setElementDisabled(element,this.isReadOnly())}setConditionIntoUi(model,position){const values2=this.mapValuesFromModel(model);this.forEachInput((element,index,elPosition,_2)=>{elPosition===position&&this.setElementValue(element,values2[index]!=null?values2[index]:null)})}setValueFromFloatingFilter(value){this.forEachInput((element,index,position,_2)=>{this.setElementValue(element,index===0&&position===0?value:null,!0)})}isDefaultOperator(operator){return operator===this.defaultJoinOperator}addChangedListeners(eType,position){this.isReadOnly()||(eType.onValueChange(this.listener),this.forEachPositionInput(position,element=>{this.attachElementOnChange(element,this.listener)}))}individualConditionPasses(params,filterModel){const cellValue=this.getCellValue(params.node),values2=this.mapValuesFromModel(filterModel),customFilterOption=this.optionsFactory.getCustomOption(filterModel.type),customFilterResult=this.evaluateCustomFilter(customFilterOption,values2,cellValue);return customFilterResult??(cellValue==null?this.evaluateNullValue(filterModel.type):this.evaluateNonNullValue(values2,cellValue,filterModel,params))}evaluateCustomFilter(customFilterOption,values2,cellValue){if(customFilterOption==null)return;const{predicate}=customFilterOption;if(predicate!=null&&!values2.some(v=>v==null))return predicate(values2,cellValue)}isBlank(cellValue){return cellValue==null||typeof cellValue=="string"&&cellValue.trim().length===0}hasInvalidInputs(){return!1}},__name(_a42,"_SimpleFilter"),_a42);_SimpleFilter.EMPTY="empty";_SimpleFilter.BLANK="blank";_SimpleFilter.NOT_BLANK="notBlank";_SimpleFilter.EQUALS="equals";_SimpleFilter.NOT_EQUAL="notEqual";_SimpleFilter.LESS_THAN="lessThan";_SimpleFilter.LESS_THAN_OR_EQUAL="lessThanOrEqual";_SimpleFilter.GREATER_THAN="greaterThan";_SimpleFilter.GREATER_THAN_OR_EQUAL="greaterThanOrEqual";_SimpleFilter.IN_RANGE="inRange";_SimpleFilter.CONTAINS="contains";_SimpleFilter.NOT_CONTAINS="notContains";_SimpleFilter.STARTS_WITH="startsWith";_SimpleFilter.ENDS_WITH="endsWith";var SimpleFilter=_SimpleFilter,_a43,ScalarFilter=(_a43=class extends SimpleFilter{setParams(params){super.setParams(params),this.scalarFilterParams=params}evaluateNullValue(filterType){switch(filterType){case _a43.EQUALS:case _a43.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case _a43.GREATER_THAN:case _a43.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case _a43.LESS_THAN:case _a43.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case _a43.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case _a43.BLANK:return!0;case _a43.NOT_BLANK:return!1}return!1}evaluateNonNullValue(values2,cellValue,filterModel){const comparator=this.comparator(),compareResult=values2[0]!=null?comparator(values2[0],cellValue):0;switch(filterModel.type){case _a43.EQUALS:return compareResult===0;case _a43.NOT_EQUAL:return compareResult!==0;case _a43.GREATER_THAN:return compareResult>0;case _a43.GREATER_THAN_OR_EQUAL:return compareResult>=0;case _a43.LESS_THAN:return compareResult<0;case _a43.LESS_THAN_OR_EQUAL:return compareResult<=0;case _a43.IN_RANGE:{const compareToResult=comparator(values2[1],cellValue);return this.scalarFilterParams.inRangeInclusive?compareResult>=0&&compareToResult<=0:compareResult>0&&compareToResult<0}case _a43.BLANK:return this.isBlank(cellValue);case _a43.NOT_BLANK:return!this.isBlank(cellValue);default:return console.warn('AG Grid: Unexpected type of filter "'+filterModel.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}},__name(_a43,"_ScalarFilter"),_a43),DEFAULT_MIN_YEAR=1e3,DEFAULT_MAX_YEAR=1/0,_a44,DateFilterModelFormatter=(_a44=class extends SimpleFilterModelFormatter{constructor(dateFilterParams,localeService,optionsFactory){super(localeService,optionsFactory),this.dateFilterParams=dateFilterParams}conditionToString(condition,options){const{type}=condition,{numberOfInputs}=options||{},isRange=type==SimpleFilter.IN_RANGE||numberOfInputs===2,dateFrom=parseDateTimeFromString(condition.dateFrom),dateTo=parseDateTimeFromString(condition.dateTo),format=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(isRange){const formattedFrom=dateFrom!==null?dateToFormattedString(dateFrom,format):"null",formattedTo=dateTo!==null?dateToFormattedString(dateTo,format):"null";return`${formattedFrom}-${formattedTo}`}return dateFrom!=null?dateToFormattedString(dateFrom,format):`${type}`}updateParams(params){super.updateParams(params),this.dateFilterParams=params.dateFilterParams}},__name(_a44,"DateFilterModelFormatter"),_a44),_a45,_DateFilter=(_a45=class extends ScalarFilter{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=DEFAULT_MIN_YEAR,this.maxValidYear=DEFAULT_MAX_YEAR,this.minValidDate=null,this.maxValidDate=null}afterGuiAttached(params){super.afterGuiAttached(params),this.dateConditionFromComps[0].afterGuiAttached(params)}mapValuesFromModel(filterModel){const{dateFrom,dateTo,type}=filterModel||{};return[dateFrom&&parseDateTimeFromString(dateFrom)||null,dateTo&&parseDateTimeFromString(dateTo)||null].slice(0,this.getNumberOfInputs(type))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(filterDate,cellValue){const cellAsDate=cellValue;return cellValue==null||cellAsDate<filterDate?-1:cellAsDate>filterDate?1:0}setParams(params){this.dateFilterParams=params,super.setParams(params);const yearParser=__name((param,fallback)=>{if(params[param]!=null)if(isNaN(params[param]))console.warn(`AG Grid: DateFilter ${param} is not a number`);else return params[param]==null?fallback:Number(params[param]);return fallback},"yearParser");this.minValidYear=yearParser("minValidYear",DEFAULT_MIN_YEAR),this.maxValidYear=yearParser("maxValidYear",DEFAULT_MAX_YEAR),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),params.minValidDate?this.minValidDate=params.minValidDate instanceof Date?params.minValidDate:parseDateTimeFromString(params.minValidDate):this.minValidDate=null,params.maxValidDate?this.maxValidDate=params.maxValidDate instanceof Date?params.maxValidDate:parseDateTimeFromString(params.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&console.warn("AG Grid: DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new DateFilterModelFormatter(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(element){const dateCompWrapper=new DateCompWrapper(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},element);return this.addDestroyFunc(()=>dateCompWrapper.destroy()),dateCompWrapper}setElementValue(element,value){element.setDate(value)}setElementDisplayed(element,displayed){element.setDisplayed(displayed)}setElementDisabled(element,disabled){element.setDisabled(disabled)}getDefaultFilterOptions(){return _a45.DEFAULT_FILTER_OPTIONS}createValueElement(){const eCondition=document.createElement("div");return eCondition.classList.add("ag-filter-body"),this.createFromToElement(eCondition,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(eCondition,this.eConditionPanelsTo,this.dateConditionToComps,"to"),eCondition}createFromToElement(eCondition,eConditionPanels,dateConditionComps,fromTo){const eConditionPanel=document.createElement("div");eConditionPanel.classList.add(`ag-filter-${fromTo}`),eConditionPanel.classList.add(`ag-filter-date-${fromTo}`),eConditionPanels.push(eConditionPanel),eCondition.appendChild(eConditionPanel),dateConditionComps.push(this.createDateCompWrapper(eConditionPanel))}removeValueElements(startPosition,deleteCount){this.removeDateComps(this.dateConditionFromComps,startPosition,deleteCount),this.removeDateComps(this.dateConditionToComps,startPosition,deleteCount),this.removeItems(this.eConditionPanelsFrom,startPosition,deleteCount),this.removeItems(this.eConditionPanelsTo,startPosition,deleteCount)}removeDateComps(components,startPosition,deleteCount){this.removeItems(components,startPosition,deleteCount).forEach(comp=>comp.destroy())}isValidDateValue(value){if(value===null)return!1;if(this.minValidDate){if(value<this.minValidDate)return!1}else if(value.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(value>this.maxValidDate)return!1}else if(value.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(position){if(!super.isConditionUiComplete(position))return!1;let valid=!0;return this.forEachInput((element,index,elPosition,numberOfInputs)=>{elPosition!==position||!valid||index>=numberOfInputs||(valid=valid&&this.isValidDateValue(element.getDate()))}),valid}areSimpleModelsEqual(aSimple,bSimple){return aSimple.dateFrom===bSimple.dateFrom&&aSimple.dateTo===bSimple.dateTo&&aSimple.type===bSimple.type}getFilterType(){return"date"}createCondition(position){const type=this.getConditionType(position),model={},values2=this.getValues(position);return values2.length>0&&(model.dateFrom=serialiseDate(values2[0])),values2.length>1&&(model.dateTo=serialiseDate(values2[1])),__spreadValues({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type},model)}resetPlaceholder(){const globalTranslate=this.localeService.getLocaleTextFunc(),placeholder=this.translate("dateFormatOoo"),ariaLabel=globalTranslate("ariaFilterValue","Filter Value");this.forEachInput(element=>{element.setInputPlaceholder(placeholder),element.setInputAriaLabel(ariaLabel)})}getInputs(position){return position>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[position],this.dateConditionToComps[position]]}getValues(position){const result=[];return this.forEachPositionInput(position,(element,index,_elPosition,numberOfInputs)=>{index<numberOfInputs&&result.push(element.getDate())}),result}translate(key){return key===ScalarFilter.LESS_THAN?super.translate("before"):key===ScalarFilter.GREATER_THAN?super.translate("after"):super.translate(key)}getModelAsString(model){var _a273;return(_a273=this.filterModelFormatter.getModelAsString(model))!=null?_a273:""}},__name(_a45,"_DateFilter"),_a45);_DateFilter.DEFAULT_FILTER_OPTIONS=[ScalarFilter.EQUALS,ScalarFilter.NOT_EQUAL,ScalarFilter.LESS_THAN,ScalarFilter.GREATER_THAN,ScalarFilter.IN_RANGE,ScalarFilter.BLANK,ScalarFilter.NOT_BLANK];__decorateClass([Autowired("userComponentFactory")],_DateFilter.prototype,"userComponentFactory",2);var DateFilter=_DateFilter,_a46,SimpleFloatingFilter=(_a46=class extends Component{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(event){return event&&event.afterFloatingFilter}isEventFromDataChange(event){return event==null?void 0:event.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(model){if(!model){this.lastType=this.optionsFactory.getDefaultOption();return}const isCombined=model.operator;let condition;isCombined?condition=model.conditions[0]:condition=model,this.lastType=condition.type}canWeEditAfterModelFromParentFilter(model){if(!model)return this.isTypeEditable(this.lastType);if(model.operator)return!1;const simpleModel=model;return this.isTypeEditable(simpleModel.type)}init(params){this.setSimpleParams(params,!1)}setSimpleParams(params,update=!0){this.optionsFactory=new OptionsFactory,this.optionsFactory.init(params.filterParams,this.getDefaultFilterOptions()),update||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!params.filterParams.readOnly;const editable=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(editable)}onParamsUpdated(params){this.refresh(params)}refresh(params){this.setSimpleParams(params)}doesFilterHaveSingleInput(filterType){const customFilterOption=this.optionsFactory.getCustomOption(filterType),{numberOfInputs}=customFilterOption||{};return numberOfInputs==null||numberOfInputs==1}isTypeEditable(type){const uneditableTypes=[SimpleFilter.IN_RANGE,SimpleFilter.EMPTY,SimpleFilter.BLANK,SimpleFilter.NOT_BLANK];return!!type&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(type)&&uneditableTypes.indexOf(type)<0}},__name(_a46,"SimpleFloatingFilter"),_a46),_a47,DateFloatingFilter=(_a47=class extends SimpleFloatingFilter{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>
                <div ref="eDateWrapper" style="display: flex;"></div>
            </div>`)}getDefaultFilterOptions(){return DateFilter.DEFAULT_FILTER_OPTIONS}init(params){super.init(params),this.params=params,this.filterParams=params.filterParams,this.createDateComponent(),this.filterModelFormatter=new DateFilterModelFormatter(this.filterParams,this.localeService,this.optionsFactory);const translate=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(translate("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(params){this.refresh(params)}refresh(params){super.refresh(params),this.params=params,this.filterParams=params.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(params.currentParentModel())}updateCompOnModelChange(model){const allowEditing=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(model);if(this.setEditable(allowEditing),allowEditing){if(model){const dateModel=model;this.dateComp.setDate(parseDateTimeFromString(dateModel.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(model)),this.dateComp.setDate(null)}setEditable(editable){setDisplayed(this.eDateWrapper,editable),setDisplayed(this.eReadOnlyText.getGui(),!editable)}onParentModelChanged(model,event){this.isEventFromFloatingFilter(event)||this.isEventFromDataChange(event)||(super.setLastTypeFromModel(model),this.updateCompOnModelChange(model))}onDateChanged(){const filterValueDate=this.dateComp.getDate(),filterValueText=serialiseDate(filterValueDate);this.params.parentFilterInstance(filterInstance=>{if(filterInstance){const date=parseDateTimeFromString(filterValueText);filterInstance.onFloatingFilterChanged(this.getLastType()||null,date)}})}getDateComponentParams(){const debounceMs=ProvidedFilter.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:debounce(this.onDateChanged.bind(this),debounceMs),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new DateCompWrapper(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const params=this.gridOptionsService.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(params)}getFilterModelFormatter(){return this.filterModelFormatter}},__name(_a47,"DateFloatingFilter"),_a47);__decorateClass([Autowired("userComponentFactory")],DateFloatingFilter.prototype,"userComponentFactory",2);__decorateClass([RefSelector("eReadOnlyText")],DateFloatingFilter.prototype,"eReadOnlyText",2);__decorateClass([RefSelector("eDateWrapper")],DateFloatingFilter.prototype,"eDateWrapper",2);var _a48,DefaultDateComponent=(_a48=class extends Component{constructor(){super(`
            <div class="ag-filter-filter">
                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(params){this.params=params,this.setParams(params);const eDocument=this.gridOptionsService.getDocument(),inputElement=this.eDateInput.getInputElement();this.addManagedListener(inputElement,"mousedown",()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||inputElement.focus()}),this.addManagedListener(inputElement,"input",e=>{e.target===eDocument.activeElement&&(this.eDateInput.isDisabled()||this.params.onDateChanged())})}setParams(params){const inputElement=this.eDateInput.getInputElement(),shouldUseBrowserDatePicker=this.shouldUseBrowserDatePicker(params);this.usingSafariDatePicker=shouldUseBrowserDatePicker&&isBrowserSafari(),inputElement.type=shouldUseBrowserDatePicker?"date":"text";const{minValidYear,maxValidYear,minValidDate,maxValidDate}=params.filterParams||{};if(minValidDate&&minValidYear&&warnOnce("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),maxValidDate&&maxValidYear&&warnOnce("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),minValidDate&&maxValidDate){const[parsedMinValidDate,parsedMaxValidDate]=[minValidDate,maxValidDate].map(v=>v instanceof Date?v:parseDateTimeFromString(v));parsedMinValidDate&&parsedMaxValidDate&&parsedMinValidDate.getTime()>parsedMaxValidDate.getTime()&&warnOnce("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}minValidDate?minValidDate instanceof Date?inputElement.min=dateToFormattedString(minValidDate):inputElement.min=minValidDate:minValidYear&&(inputElement.min=`${minValidYear}-01-01`),maxValidDate?maxValidDate instanceof Date?inputElement.max=dateToFormattedString(maxValidDate):inputElement.max=maxValidDate:maxValidYear&&(inputElement.max=`${maxValidYear}-12-31`)}onParamsUpdated(params){this.refresh(params)}refresh(params){this.params=params,this.setParams(params)}getDate(){return parseDateTimeFromString(this.eDateInput.getValue())}setDate(date){this.eDateInput.setValue(serialiseDate(date,!1))}setInputPlaceholder(placeholder){this.eDateInput.setInputPlaceholder(placeholder)}setDisabled(disabled){this.eDateInput.setDisabled(disabled)}afterGuiAttached(params){(!params||!params.suppressFocus)&&this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(params){return params.filterParams&&params.filterParams.browserDatePicker!=null?params.filterParams.browserDatePicker:isBrowserChrome()||isBrowserFirefox()||isBrowserSafari()&&getSafariVersion()>=14.1}},__name(_a48,"DefaultDateComponent"),_a48);__decorateClass([RefSelector("eDateInput")],DefaultDateComponent.prototype,"eDateInput",2);var _a49,AgInputTextField=(_a49=class extends AgAbstractInputField{constructor(config,className="ag-text-field",inputType="text"){super(config,className,inputType)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(value,silent){return this.eInput.value!==value&&(this.eInput.value=exists(value)?value:""),super.setValue(value,silent)}setStartValue(value){this.setValue(value,!0)}preventDisallowedCharacters(){const pattern=new RegExp(`[${this.config.allowedCharPattern}]`),preventCharacters=__name(event=>{isEventFromPrintableCharacter(event)&&event.key&&!pattern.test(event.key)&&event.preventDefault()},"preventCharacters");this.addManagedListener(this.eInput,"keydown",preventCharacters),this.addManagedListener(this.eInput,"paste",e=>{var _a273;const text=(_a273=e.clipboardData)==null?void 0:_a273.getData("text");text&&text.split("").some(c=>!pattern.test(c))&&e.preventDefault()})}},__name(_a49,"AgInputTextField"),_a49),_a50,AgInputNumberField=(_a50=class extends AgInputTextField{constructor(config){super(config,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const floatedValue=parseFloat(this.eInput.value),value=isNaN(floatedValue)?"":this.normalizeValue(floatedValue.toString());this.value!==value&&this.setValue(value)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any";const{precision,min,max,step}=this.config;typeof precision=="number"&&this.setPrecision(precision),typeof min=="number"&&this.setMin(min),typeof max=="number"&&this.setMax(max),typeof step=="number"&&this.setStep(step)}onWheel(e){document.activeElement===this.eInput&&e.preventDefault()}normalizeValue(value){if(value==="")return"";this.precision!=null&&(value=this.adjustPrecision(value));const val=parseFloat(value);return this.min!=null&&val<this.min?value=this.min.toString():this.max!=null&&val>this.max&&(value=this.max.toString()),value}adjustPrecision(value,isScientificNotation){if(this.precision==null)return value;if(isScientificNotation){const floatString=parseFloat(value).toFixed(this.precision);return parseFloat(floatString).toString()}const parts=String(value).split(".");if(parts.length>1){if(parts[1].length<=this.precision)return value;if(this.precision>0)return`${parts[0]}.${parts[1].slice(0,this.precision)}`}return parts[0]}setMin(min){return this.min===min?this:(this.min=min,addOrRemoveAttribute(this.eInput,"min",min),this)}setMax(max){return this.max===max?this:(this.max=max,addOrRemoveAttribute(this.eInput,"max",max),this)}setPrecision(precision){return this.precision=precision,this}setStep(step){return this.step===step?this:(this.step=step,addOrRemoveAttribute(this.eInput,"step",step),this)}setValue(value,silent){return this.setValueOrInputValue(v=>super.setValue(v,silent),()=>this,value)}setStartValue(value){return this.setValueOrInputValue(v=>super.setValue(v,!0),v=>{this.eInput.value=v},value)}setValueOrInputValue(setValueFunc,setInputValueOnlyFunc,value){if(exists(value)){let setInputValueOnly=this.isScientificNotation(value);if(setInputValueOnly&&this.eInput.validity.valid)return setValueFunc(value);if(!setInputValueOnly){value=this.adjustPrecision(value);const normalizedValue=this.normalizeValue(value);setInputValueOnly=value!=normalizedValue}if(setInputValueOnly)return setInputValueOnlyFunc(value)}return setValueFunc(value)}getValue(){if(!this.eInput.validity.valid)return;const inputValue=this.eInput.value;return this.isScientificNotation(inputValue)?this.adjustPrecision(inputValue,!0):super.getValue()}isScientificNotation(value){return typeof value=="string"&&value.includes("e")}},__name(_a50,"AgInputNumberField"),_a50),_a51,NumberFilterModelFormatter=(_a51=class extends SimpleFilterModelFormatter{conditionToString(condition,options){const{numberOfInputs}=options||{};return condition.type==SimpleFilter.IN_RANGE||numberOfInputs===2?`${this.formatValue(condition.filter)}-${this.formatValue(condition.filterTo)}`:condition.filter!=null?this.formatValue(condition.filter):`${condition.type}`}},__name(_a51,"NumberFilterModelFormatter"),_a51);function getAllowedCharPattern(filterParams){const{allowedCharPattern}=filterParams??{};return allowedCharPattern??null}__name(getAllowedCharPattern,"getAllowedCharPattern");var _a52,_NumberFilter=(_a52=class extends ScalarFilter{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(params){return this.numberFilterParams.allowedCharPattern!==params.allowedCharPattern?!1:super.refresh(params)}mapValuesFromModel(filterModel){const{filter,filterTo,type}=filterModel||{};return[this.processValue(filter),this.processValue(filterTo)].slice(0,this.getNumberOfInputs(type))}getDefaultDebounceMs(){return 500}comparator(){return(left,right)=>left===right?0:left<right?1:-1}setParams(params){this.numberFilterParams=params,super.setParams(params),this.filterModelFormatter=new NumberFilterModelFormatter(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return _a52.DEFAULT_FILTER_OPTIONS}setElementValue(element,value,fromFloatingFilter){const valueToSet=!fromFloatingFilter&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(value??null):value;super.setElementValue(element,valueToSet)}createValueElement(){const allowedCharPattern=getAllowedCharPattern(this.numberFilterParams),eCondition=document.createElement("div");return eCondition.classList.add("ag-filter-body"),setAriaRole(eCondition,"presentation"),this.createFromToElement(eCondition,this.eValuesFrom,"from",allowedCharPattern),this.createFromToElement(eCondition,this.eValuesTo,"to",allowedCharPattern),eCondition}createFromToElement(eCondition,eValues,fromTo,allowedCharPattern){const eValue=this.createManagedBean(allowedCharPattern?new AgInputTextField({allowedCharPattern}):new AgInputNumberField);eValue.addCssClass(`ag-filter-${fromTo}`),eValue.addCssClass("ag-filter-filter"),eValues.push(eValue),eCondition.appendChild(eValue.getGui())}removeValueElements(startPosition,deleteCount){this.removeComponents(this.eValuesFrom,startPosition,deleteCount),this.removeComponents(this.eValuesTo,startPosition,deleteCount)}getValues(position){const result=[];return this.forEachPositionInput(position,(element,index,_elPosition,numberOfInputs)=>{index<numberOfInputs&&result.push(this.processValue(this.stringToFloat(element.getValue())))}),result}areSimpleModelsEqual(aSimple,bSimple){return aSimple.filter===bSimple.filter&&aSimple.filterTo===bSimple.filterTo&&aSimple.type===bSimple.type}getFilterType(){return"number"}processValue(value){return value==null||isNaN(value)?null:value}stringToFloat(value){if(typeof value=="number")return value;let filterText=makeNull(value);return filterText!=null&&filterText.trim()===""&&(filterText=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(filterText):filterText==null||filterText.trim()==="-"?null:parseFloat(filterText)}createCondition(position){const type=this.getConditionType(position),model={filterType:this.getFilterType(),type},values2=this.getValues(position);return values2.length>0&&(model.filter=values2[0]),values2.length>1&&(model.filterTo=values2[1]),model}getInputs(position){return position>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[position],this.eValuesTo[position]]}getModelAsString(model){var _a273;return(_a273=this.filterModelFormatter.getModelAsString(model))!=null?_a273:""}hasInvalidInputs(){let invalidInputs=!1;return this.forEachInput(element=>{if(!element.getInputElement().validity.valid){invalidInputs=!0;return}}),invalidInputs}},__name(_a52,"_NumberFilter"),_a52);_NumberFilter.DEFAULT_FILTER_OPTIONS=[ScalarFilter.EQUALS,ScalarFilter.NOT_EQUAL,ScalarFilter.GREATER_THAN,ScalarFilter.GREATER_THAN_OR_EQUAL,ScalarFilter.LESS_THAN,ScalarFilter.LESS_THAN_OR_EQUAL,ScalarFilter.IN_RANGE,ScalarFilter.BLANK,ScalarFilter.NOT_BLANK];var NumberFilter=_NumberFilter,_a53,TextFilterModelFormatter=(_a53=class extends SimpleFilterModelFormatter{conditionToString(condition,options){const{numberOfInputs}=options||{};return condition.type==SimpleFilter.IN_RANGE||numberOfInputs===2?`${condition.filter}-${condition.filterTo}`:condition.filter!=null?`${condition.filter}`:`${condition.type}`}},__name(_a53,"TextFilterModelFormatter"),_a53),_a54,_TextFilter=(_a54=class extends SimpleFilter{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(value){const trimmedInput=value&&value.trim();return trimmedInput===""?value:trimmedInput}getDefaultDebounceMs(){return 500}setParams(params){this.textFilterParams=params,super.setParams(params),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?_a54.DEFAULT_FORMATTER:_a54.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new TextFilterModelFormatter(this.localeService,this.optionsFactory)}getTextMatcher(){const legacyComparator=this.textFilterParams.textCustomComparator;return legacyComparator?(_.warnOnce("textCustomComparator is deprecated, use textMatcher instead."),({filterOption,value,filterText})=>legacyComparator(filterOption,value,filterText)):this.textFilterParams.textMatcher||_a54.DEFAULT_MATCHER}createCondition(position){const type=this.getConditionType(position),model={filterType:this.getFilterType(),type},values2=this.getValuesWithSideEffects(position,!0);return values2.length>0&&(model.filter=values2[0]),values2.length>1&&(model.filterTo=values2[1]),model}getFilterType(){return"text"}areSimpleModelsEqual(aSimple,bSimple){return aSimple.filter===bSimple.filter&&aSimple.filterTo===bSimple.filterTo&&aSimple.type===bSimple.type}getInputs(position){return position>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[position],this.eValuesTo[position]]}getValues(position){return this.getValuesWithSideEffects(position,!1)}getValuesWithSideEffects(position,applySideEffects){const result=[];return this.forEachPositionInput(position,(element,index,_elPosition,numberOfInputs)=>{var _a273;if(index<numberOfInputs){let value=makeNull(element.getValue());applySideEffects&&this.textFilterParams.trimInput&&(value=(_a273=_a54.trimInput(value))!=null?_a273:null,element.setValue(value,!0)),result.push(value)}}),result}getDefaultFilterOptions(){return _a54.DEFAULT_FILTER_OPTIONS}createValueElement(){const eCondition=document.createElement("div");return eCondition.classList.add("ag-filter-body"),setAriaRole(eCondition,"presentation"),this.createFromToElement(eCondition,this.eValuesFrom,"from"),this.createFromToElement(eCondition,this.eValuesTo,"to"),eCondition}createFromToElement(eCondition,eValues,fromTo){const eValue=this.createManagedBean(new AgInputTextField);eValue.addCssClass(`ag-filter-${fromTo}`),eValue.addCssClass("ag-filter-filter"),eValues.push(eValue),eCondition.appendChild(eValue.getGui())}removeValueElements(startPosition,deleteCount){this.removeComponents(this.eValuesFrom,startPosition,deleteCount),this.removeComponents(this.eValuesTo,startPosition,deleteCount)}mapValuesFromModel(filterModel){const{filter,filterTo,type}=filterModel||{};return[filter||null,filterTo||null].slice(0,this.getNumberOfInputs(type))}evaluateNullValue(filterType){const filterTypesAllowNulls=[SimpleFilter.NOT_EQUAL,SimpleFilter.NOT_CONTAINS,SimpleFilter.BLANK];return filterType?filterTypesAllowNulls.indexOf(filterType)>=0:!1}evaluateNonNullValue(values2,cellValue,filterModel,params){const formattedValues=values2.map(v=>this.formatter(v))||[],cellValueFormatted=this.formatter(cellValue),{api,colDef,column,columnApi,context,textFormatter}=this.textFilterParams;if(filterModel.type===SimpleFilter.BLANK)return this.isBlank(cellValue);if(filterModel.type===SimpleFilter.NOT_BLANK)return!this.isBlank(cellValue);const matcherParams={api,colDef,column,columnApi,context,node:params.node,data:params.data,filterOption:filterModel.type,value:cellValueFormatted,textFormatter};return formattedValues.some(v=>this.matcher(__spreadProps(__spreadValues({},matcherParams),{filterText:v})))}getModelAsString(model){var _a273;return(_a273=this.filterModelFormatter.getModelAsString(model))!=null?_a273:""}},__name(_a54,"_TextFilter"),_a54);_TextFilter.DEFAULT_FILTER_OPTIONS=[SimpleFilter.CONTAINS,SimpleFilter.NOT_CONTAINS,SimpleFilter.EQUALS,SimpleFilter.NOT_EQUAL,SimpleFilter.STARTS_WITH,SimpleFilter.ENDS_WITH,SimpleFilter.BLANK,SimpleFilter.NOT_BLANK];_TextFilter.DEFAULT_FORMATTER=from=>from;_TextFilter.DEFAULT_LOWERCASE_FORMATTER=from=>from==null?null:from.toString().toLowerCase();_TextFilter.DEFAULT_MATCHER=({filterOption,value,filterText})=>{if(filterText==null)return!1;switch(filterOption){case _TextFilter.CONTAINS:return value.indexOf(filterText)>=0;case _TextFilter.NOT_CONTAINS:return value.indexOf(filterText)<0;case _TextFilter.EQUALS:return value===filterText;case _TextFilter.NOT_EQUAL:return value!=filterText;case _TextFilter.STARTS_WITH:return value.indexOf(filterText)===0;case _TextFilter.ENDS_WITH:const index=value.lastIndexOf(filterText);return index>=0&&index===value.length-filterText.length;default:return!1}};var TextFilter=_TextFilter,_a55,FloatingFilterTextInputService=(_a55=class extends BeanStub{constructor(params){super(),this.params=params,this.valueChangedListener=()=>{}}setupGui(parentElement){var _a273;this.eFloatingFilterTextInput=this.createManagedBean(new AgInputTextField((_a273=this.params)==null?void 0:_a273.config));const eInput=this.eFloatingFilterTextInput.getGui();parentElement.appendChild(eInput),this.addManagedListener(eInput,"input",e=>this.valueChangedListener(e)),this.addManagedListener(eInput,"keydown",e=>this.valueChangedListener(e))}setEditable(editable){this.eFloatingFilterTextInput.setDisabled(!editable)}setAutoComplete(autoComplete){this.eFloatingFilterTextInput.setAutoComplete(autoComplete)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(value,silent){this.eFloatingFilterTextInput.setValue(value,silent)}setValueChangedListener(listener){this.valueChangedListener=listener}setParams(params){this.setAriaLabel(params.ariaLabel),params.autoComplete!==void 0&&this.setAutoComplete(params.autoComplete)}setAriaLabel(ariaLabel){this.eFloatingFilterTextInput.setInputAriaLabel(ariaLabel)}},__name(_a55,"FloatingFilterTextInputService"),_a55),_a56,TextInputFloatingFilter=(_a56=class extends SimpleFloatingFilter{postConstruct(){this.setTemplate(`
            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>
        `)}getDefaultDebounceMs(){return 500}onParentModelChanged(model,event){this.isEventFromFloatingFilter(event)||this.isEventFromDataChange(event)||(this.setLastTypeFromModel(model),this.setEditable(this.canWeEditAfterModelFromParentFilter(model)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(model)))}init(params){this.setupFloatingFilterInputService(params),super.init(params),this.setTextInputParams(params)}setupFloatingFilterInputService(params){this.floatingFilterInputService=this.createFloatingFilterInputService(params),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(params){var _a273;this.params=params;const autoComplete=(_a273=params.browserAutoComplete)!=null?_a273:!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(params),autoComplete}),this.applyActive=ProvidedFilter.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const debounceMs=ProvidedFilter.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),toDebounce=debounce(this.syncUpWithParentFilter.bind(this),debounceMs);this.floatingFilterInputService.setValueChangedListener(toDebounce)}}onParamsUpdated(params){this.refresh(params)}refresh(params){super.refresh(params),this.setTextInputParams(params)}recreateFloatingFilterInputService(params){const value=this.floatingFilterInputService.getValue();clearElement(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(params),this.floatingFilterInputService.setValue(value,!0)}getAriaLabel(params){const displayName=this.columnModel.getDisplayNameForColumn(params.column,"header",!0),translate=this.localeService.getLocaleTextFunc();return`${displayName} ${translate("ariaFilterInput","Filter Input")}`}syncUpWithParentFilter(e){const isEnterKey=e.key===KeyCode.ENTER;if(this.applyActive&&!isEnterKey)return;let value=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(value=TextFilter.trimInput(value),this.floatingFilterInputService.setValue(value,!0)),this.params.parentFilterInstance(filterInstance=>{filterInstance&&filterInstance.onFloatingFilterChanged(this.getLastType()||null,value||null)})}setEditable(editable){this.floatingFilterInputService.setEditable(editable)}},__name(_a56,"TextInputFloatingFilter"),_a56);__decorateClass([Autowired("columnModel")],TextInputFloatingFilter.prototype,"columnModel",2);__decorateClass([RefSelector("eFloatingFilterInputContainer")],TextInputFloatingFilter.prototype,"eFloatingFilterInputContainer",2);__decorateClass([PostConstruct],TextInputFloatingFilter.prototype,"postConstruct",1);var _a57,FloatingFilterNumberInputService=(_a57=class extends BeanStub{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(parentElement){this.eFloatingFilterNumberInput=this.createManagedBean(new AgInputNumberField),this.eFloatingFilterTextInput=this.createManagedBean(new AgInputTextField),this.eFloatingFilterTextInput.setDisabled(!0);const eNumberInput=this.eFloatingFilterNumberInput.getGui(),eTextInput=this.eFloatingFilterTextInput.getGui();parentElement.appendChild(eNumberInput),parentElement.appendChild(eTextInput),this.setupListeners(eNumberInput,e=>this.valueChangedListener(e)),this.setupListeners(eTextInput,e=>this.valueChangedListener(e))}setEditable(editable){this.numberInputActive=editable,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(autoComplete){this.eFloatingFilterNumberInput.setAutoComplete(autoComplete),this.eFloatingFilterTextInput.setAutoComplete(autoComplete)}getValue(){return this.getActiveInputElement().getValue()}setValue(value,silent){this.getActiveInputElement().setValue(value,silent)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(listener){this.valueChangedListener=listener}setupListeners(element,listener){this.addManagedListener(element,"input",listener),this.addManagedListener(element,"keydown",listener)}setParams(params){this.setAriaLabel(params.ariaLabel),params.autoComplete!==void 0&&this.setAutoComplete(params.autoComplete)}setAriaLabel(ariaLabel){this.eFloatingFilterNumberInput.setInputAriaLabel(ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(ariaLabel)}},__name(_a57,"FloatingFilterNumberInputService"),_a57),_a58,NumberFloatingFilter=(_a58=class extends TextInputFloatingFilter{init(params){var _a273;super.init(params),this.filterModelFormatter=new NumberFilterModelFormatter(this.localeService,this.optionsFactory,(_a273=params.filterParams)==null?void 0:_a273.numberFormatter)}onParamsUpdated(params){this.refresh(params)}refresh(params){getAllowedCharPattern(params.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(params),super.refresh(params),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return NumberFilter.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(params){return this.allowedCharPattern=getAllowedCharPattern(params.filterParams),this.allowedCharPattern?this.createManagedBean(new FloatingFilterTextInputService({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new FloatingFilterNumberInputService)}},__name(_a58,"NumberFloatingFilter"),_a58),_a59,TextFloatingFilter=(_a59=class extends TextInputFloatingFilter{init(params){super.init(params),this.filterModelFormatter=new TextFilterModelFormatter(this.localeService,this.optionsFactory)}onParamsUpdated(params){this.refresh(params)}refresh(params){super.refresh(params),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return TextFilter.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new FloatingFilterTextInputService)}},__name(_a59,"TextFloatingFilter"),_a59),_a60,_TouchListener=(_a60=class{constructor(eElement,preventMouseClick=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new EventService,this.eElement=eElement,this.preventMouseClick=preventMouseClick;const startListener=this.onTouchStart.bind(this),moveListener=this.onTouchMove.bind(this),endListener=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",startListener,{passive:!0}),this.eElement.addEventListener("touchmove",moveListener,{passive:!0}),this.eElement.addEventListener("touchend",endListener,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",startListener,{passive:!0}),this.eElement.removeEventListener("touchmove",moveListener,{passive:!0}),this.eElement.removeEventListener("touchend",endListener,{passive:!1})})}getActiveTouch(touchList){for(let i=0;i<touchList.length;i++)if(touchList[i].identifier===this.touchStart.identifier)return touchList[i];return null}addEventListener(eventType,listener){this.eventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.eventService.removeEventListener(eventType,listener)}onTouchStart(touchEvent){if(this.touching)return;this.touchStart=touchEvent.touches[0],this.touching=!0,this.moved=!1;const touchStartCopy=this.touchStart;window.setTimeout(()=>{const touchesMatch=this.touchStart===touchStartCopy;if(this.touching&&touchesMatch&&!this.moved){this.moved=!0;const event={type:_a60.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent};this.eventService.dispatchEvent(event)}},500)}onTouchMove(touchEvent){if(!this.touching)return;const touch=this.getActiveTouch(touchEvent.touches);if(!touch)return;!areEventsNear(touch,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(touchEvent){if(this.touching){if(!this.moved){const event={type:_a60.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(event),this.checkForDoubleTap()}this.preventMouseClick&&touchEvent.cancelable&&touchEvent.preventDefault(),this.touching=!1}}checkForDoubleTap(){const now=new Date().getTime();if(this.lastTapTime&&this.lastTapTime>0)if(now-this.lastTapTime>_a60.DOUBLE_TAP_MILLIS){const event={type:_a60.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(event),this.lastTapTime=null}else this.lastTapTime=now;else this.lastTapTime=now}destroy(){this.destroyFuncs.forEach(func=>func())}},__name(_a60,"_TouchListener"),_a60);_TouchListener.EVENT_TAP="tap";_TouchListener.EVENT_DOUBLE_TAP="doubleTap";_TouchListener.EVENT_LONG_TAP="longTap";_TouchListener.DOUBLE_TAP_MILLIS=500;var TouchListener=_TouchListener,_a61,_SortIndicatorComp=(_a61=class extends Component{constructor(skipTemplate){super(),skipTemplate||this.setTemplate(_a61.TEMPLATE)}attachCustomElements(eSortOrder,eSortAsc,eSortDesc,eSortMixed,eSortNone){this.eSortOrder=eSortOrder,this.eSortAsc=eSortAsc,this.eSortDesc=eSortDesc,this.eSortMixed=eSortMixed,this.eSortNone=eSortNone}setupSort(column,suppressOrder=!1){this.column=column,this.suppressOrder=suppressOrder,this.setupMultiSortIndicator(),this.column.isSortable()&&(this.addInIcon("sortAscending",this.eSortAsc,column),this.addInIcon("sortDescending",this.eSortDesc,column),this.addInIcon("sortUnSort",this.eSortNone,column),this.addManagedPropertyListener("unSortIcon",()=>this.updateIcons()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.updateIcons()),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(iconName,eParent,column){if(eParent==null)return;const eIcon=createIconNoSpan(iconName,this.gridOptionsService,column);eIcon&&eParent.appendChild(eIcon)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const sortDirection=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const isAscending=sortDirection==="asc";setDisplayed(this.eSortAsc,isAscending,{skipAriaHidden:!0})}if(this.eSortDesc){const isDescending=sortDirection==="desc";setDisplayed(this.eSortDesc,isDescending,{skipAriaHidden:!0})}if(this.eSortNone){const alwaysHideNoSort=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.get("unSortIcon"),isNone=sortDirection==null;setDisplayed(this.eSortNone,!alwaysHideNoSort&&isNone,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const isColumnShowingRowGroup=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&isColumnShowingRowGroup&&(this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const isMixedSort=this.sortController.getDisplaySortForColumn(this.column)==="mixed";setDisplayed(this.eSortMixed,isMixedSort,{skipAriaHidden:!0})}}updateSortOrder(){var _a273;if(!this.eSortOrder)return;const allColumnsWithSorting=this.sortController.getColumnsWithSortingOrdered(),indexThisCol=(_a273=this.sortController.getDisplaySortIndexForColumn(this.column))!=null?_a273:-1,moreThanOneColSorting=allColumnsWithSorting.some(col=>{var _a274;return(_a274=this.sortController.getDisplaySortIndexForColumn(col))!=null?_a274:!1}),showIndex=indexThisCol>=0&&moreThanOneColSorting;setDisplayed(this.eSortOrder,showIndex,{skipAriaHidden:!0}),indexThisCol>=0?this.eSortOrder.textContent=(indexThisCol+1).toString():clearElement(this.eSortOrder)}},__name(_a61,"_SortIndicatorComp"),_a61);_SortIndicatorComp.TEMPLATE=`<span class="ag-sort-indicator-container">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>
        </span>`;__decorateClass([RefSelector("eSortOrder")],_SortIndicatorComp.prototype,"eSortOrder",2);__decorateClass([RefSelector("eSortAsc")],_SortIndicatorComp.prototype,"eSortAsc",2);__decorateClass([RefSelector("eSortDesc")],_SortIndicatorComp.prototype,"eSortDesc",2);__decorateClass([RefSelector("eSortMixed")],_SortIndicatorComp.prototype,"eSortMixed",2);__decorateClass([RefSelector("eSortNone")],_SortIndicatorComp.prototype,"eSortNone",2);__decorateClass([Autowired("columnModel")],_SortIndicatorComp.prototype,"columnModel",2);__decorateClass([Autowired("sortController")],_SortIndicatorComp.prototype,"sortController",2);var SortIndicatorComp=_SortIndicatorComp,_a62,_HeaderComp=(_a62=class extends Component{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(params){return this.params=params,this.workOutTemplate()!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||this.workOutSort()!=this.currentSort||this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide?!1:(this.setDisplayName(params),!0)}workOutTemplate(){var _a273;let template=(_a273=this.params.template)!=null?_a273:_a62.TEMPLATE;return template=template&&template.trim?template.trim():template,template}init(params){this.params=params,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(params)}setDisplayName(params){if(this.currentDisplayName!=params.displayName){this.currentDisplayName=params.displayName;const displayNameSanitised=escapeString(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=displayNameSanitised)}}addInIcon(iconName,eParent,column){if(eParent==null)return;const eIcon=createIconNoSpan(iconName,this.gridOptionsService,column);eIcon&&eParent.appendChild(eIcon)}setupTap(){const{gridOptionsService}=this;if(gridOptionsService.get("suppressTouch"))return;const touchListener=new TouchListener(this.getGui(),!0),suppressMenuHide=this.shouldSuppressMenuHide(),tapMenuButton=suppressMenuHide&&exists(this.eMenu),menuTouchListener=tapMenuButton?new TouchListener(this.eMenu,!0):touchListener;if(this.params.enableMenu){const eventType=tapMenuButton?"EVENT_TAP":"EVENT_LONG_TAP",showMenuFn=__name(event=>this.params.showColumnMenuAfterMouseClick(event.touchStart),"showMenuFn");this.addManagedListener(menuTouchListener,TouchListener[eventType],showMenuFn)}if(this.params.enableSorting){const tapListener=__name(event=>{var _a273,_b;const target=event.touchStart.target;suppressMenuHide&&((_a273=this.eMenu)!=null&&_a273.contains(target)||(_b=this.eFilterButton)!=null&&_b.contains(target))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")},"tapListener");this.addManagedListener(touchListener,TouchListener.EVENT_TAP,tapListener)}if(this.params.enableFilterButton){const filterButtonTouchListener=new TouchListener(this.eFilterButton,!0);this.addManagedListener(filterButtonTouchListener,"tap",()=>this.params.showFilter(this.eFilterButton)),this.addDestroyFunc(()=>filterButtonTouchListener.destroy())}this.addDestroyFunc(()=>touchListener.destroy()),tapMenuButton&&this.addDestroyFunc(()=>menuTouchListener.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){removeFromParent(this.eMenu),this.eMenu=void 0;return}const isLegacyMenu=this.menuService.isLegacyMenuEnabled();this.addInIcon(isLegacyMenu?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!isLegacyMenu),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedListener(this.eMenu,"click",()=>this.params.showColumnMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(isFilterShortcut){var _a273,_b,_c,_d;const{column}=this.params,isLegacyMenuEnabled=this.menuService.isLegacyMenuEnabled();if(isFilterShortcut&&!isLegacyMenuEnabled){if(this.menuService.isFilterMenuInHeaderEnabled(column))return this.params.showFilter((_b=(_a273=this.eFilterButton)!=null?_a273:this.eMenu)!=null?_b:this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu((_d=(_c=this.eMenu)!=null?_c:this.eFilterButton)!=null?_d:this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new SortIndicatorComp(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListener(this.params.column,Column.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=new Date().getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",event=>{const moving=this.params.column.isMoving(),movedRecently=new Date().getTime()-this.lastMovingChanged<50;if(!(moving||movedRecently)){const multiSort=this.gridOptionsService.get("multiSortKey")==="ctrl"?event.ctrlKey||event.metaKey:event.shiftKey;this.params.progressSort(multiSort)}});const onSortingChanged=__name(()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const sourceColumns=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),isMultiSorting=!(sourceColumns==null?void 0:sourceColumns.every(sourceCol=>this.params.column.getSort()==sourceCol.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",isMultiSorting)}},"onSortingChanged");this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,onSortingChanged),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,onSortingChanged)}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedListener(this.eFilterButton,"click",()=>this.params.showFilter(this.eFilterButton)):this.eFilterButton=void 0}configureFilter(enabled,element,filterChangedCallback){if(!enabled)return removeFromParent(element),!1;const{column}=this.params;return this.addInIcon("filter",element,column),this.addManagedListener(column,Column.EVENT_FILTER_CHANGED,filterChangedCallback),filterChangedCallback(),!0}onFilterChangedIcon(){const filterPresent=this.params.column.isFilterActive();setDisplayed(this.eFilter,filterPresent,{skipAriaHidden:!0})}onFilterChangedButton(){const filterPresent=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",filterPresent)}getAnchorElementForMenu(isFilter){var _a273,_b,_c,_d;return isFilter?(_b=(_a273=this.eFilterButton)!=null?_a273:this.eMenu)!=null?_b:this.getGui():(_d=(_c=this.eMenu)!=null?_c:this.eFilterButton)!=null?_d:this.getGui()}},__name(_a62,"_HeaderComp"),_a62);_HeaderComp.TEMPLATE=`<div class="ag-cell-label-container" role="presentation">
            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>
            <span ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text"></span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>
                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>
            </div>
        </div>`;__decorateClass([Autowired("sortController")],_HeaderComp.prototype,"sortController",2);__decorateClass([Autowired("menuService")],_HeaderComp.prototype,"menuService",2);__decorateClass([Autowired("columnModel")],_HeaderComp.prototype,"columnModel",2);__decorateClass([RefSelector("eFilter")],_HeaderComp.prototype,"eFilter",2);__decorateClass([RefSelector("eFilterButton")],_HeaderComp.prototype,"eFilterButton",2);__decorateClass([RefSelector("eSortIndicator")],_HeaderComp.prototype,"eSortIndicator",2);__decorateClass([RefSelector("eMenu")],_HeaderComp.prototype,"eMenu",2);__decorateClass([RefSelector("eLabel")],_HeaderComp.prototype,"eLabel",2);__decorateClass([RefSelector("eText")],_HeaderComp.prototype,"eText",2);__decorateClass([RefSelector("eSortOrder")],_HeaderComp.prototype,"eSortOrder",2);__decorateClass([RefSelector("eSortAsc")],_HeaderComp.prototype,"eSortAsc",2);__decorateClass([RefSelector("eSortDesc")],_HeaderComp.prototype,"eSortDesc",2);__decorateClass([RefSelector("eSortMixed")],_HeaderComp.prototype,"eSortMixed",2);__decorateClass([RefSelector("eSortNone")],_HeaderComp.prototype,"eSortNone",2);var HeaderComp=_HeaderComp,_a63,_HeaderGroupComp=(_a63=class extends Component{constructor(){super(_a63.TEMPLATE)}destroy(){super.destroy()}init(params){this.params=params,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&warnOnce("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const expandAction=__name(event=>{if(isStopPropagationForAgGrid(event))return;const newExpandedValue=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),newExpandedValue,"uiColumnExpanded")},"expandAction");this.addTouchAndClickListeners(this.eCloseIcon,expandAction),this.addTouchAndClickListeners(this.eOpenIcon,expandAction);const stopPropagationAction=__name(event=>{stopPropagationForAgGrid(event)},"stopPropagationAction");this.addManagedListener(this.eCloseIcon,"dblclick",stopPropagationAction),this.addManagedListener(this.eOpenIcon,"dblclick",stopPropagationAction),this.addManagedListener(this.getGui(),"dblclick",expandAction),this.updateIconVisibility();const providedColumnGroup=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(providedColumnGroup,ProvidedColumnGroup.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(providedColumnGroup,ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(eElement,action){const touchListener=new TouchListener(eElement,!0);this.addManagedListener(touchListener,TouchListener.EVENT_TAP,action),this.addDestroyFunc(()=>touchListener.destroy()),this.addManagedListener(eElement,"click",action)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const expanded=this.params.columnGroup.isExpanded();setDisplayed(this.eOpenIcon,expanded),setDisplayed(this.eCloseIcon,!expanded)}else setDisplayed(this.eOpenIcon,!1),setDisplayed(this.eCloseIcon,!1)}addInIcon(iconName,refName){const eIcon=createIconNoSpan(iconName,this.gridOptionsService,null);eIcon&&this.getRefElement(refName).appendChild(eIcon)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable()){setDisplayed(this.eOpenIcon,!1),setDisplayed(this.eCloseIcon,!1);return}}setupLabel(){var _a273;const{displayName,columnGroup}=this.params;if(exists(displayName)){const displayNameSanitised=escapeString(displayName,!0);this.getRefElement("agLabel").textContent=displayNameSanitised}this.addOrRemoveCssClass("ag-sticky-label",!((_a273=columnGroup.getColGroupDef())!=null&&_a273.suppressStickyLabel))}},__name(_a63,"_HeaderGroupComp"),_a63);_HeaderGroupComp.TEMPLATE=`<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">
            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>
            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>
            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>
        </div>`;__decorateClass([Autowired("columnModel")],_HeaderGroupComp.prototype,"columnModel",2);__decorateClass([RefSelector("agOpened")],_HeaderGroupComp.prototype,"eOpenIcon",2);__decorateClass([RefSelector("agClosed")],_HeaderGroupComp.prototype,"eCloseIcon",2);var HeaderGroupComp=_HeaderGroupComp,_a64,PopupComponent=(_a64=class extends Component{isPopup(){return!0}setParentComponent(container){container.addCssClass("ag-has-popup"),super.setParentComponent(container)}destroy(){const parentComp=this.parentComponent;parentComp&&parentComp.isAlive()&&parentComp.getGui().classList.remove("ag-has-popup"),super.destroy()}},__name(_a64,"PopupComponent"),_a64),_a65,_LargeTextCellEditor=(_a65=class extends PopupComponent{constructor(){super(_a65.TEMPLATE)}init(params){this.params=params,this.focusAfterAttached=params.cellStartedEdit,this.eTextArea.setMaxLength(params.maxLength||200).setCols(params.cols||60).setRows(params.rows||10),exists(params.value,!0)&&this.eTextArea.setValue(params.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(event){const key=event.key;(key===KeyCode.LEFT||key===KeyCode.UP||key===KeyCode.RIGHT||key===KeyCode.DOWN||event.shiftKey&&key===KeyCode.ENTER)&&event.stopPropagation()}afterGuiAttached(){const translate=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(translate("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const value=this.eTextArea.getValue();return!exists(value)&&!exists(this.params.value)?this.params.value:this.params.parseValue(value)}},__name(_a65,"_LargeTextCellEditor"),_a65);_LargeTextCellEditor.TEMPLATE=`<div class="ag-large-text">
            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>
        </div>`;__decorateClass([RefSelector("eTextArea")],_LargeTextCellEditor.prototype,"eTextArea",2);var LargeTextCellEditor=_LargeTextCellEditor,_a66,SelectCellEditor=(_a66=class extends PopupComponent{constructor(){super(`<div class="ag-cell-edit-wrapper">
                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>
            </div>`),this.startedByEnter=!1}init(params){this.focusAfterAttached=params.cellStartedEdit;const{eSelect,valueFormatterService,gridOptionsService}=this,{values:values2,value,eventKey}=params;if(missing(values2)){console.warn("AG Grid: no values found for select cellEditor");return}this.startedByEnter=eventKey!=null?eventKey===KeyCode.ENTER:!1;let hasValue=!1;values2.forEach(currentValue=>{const option={value:currentValue},valueFormatted=valueFormatterService.formatValue(params.column,null,currentValue),valueFormattedExits=valueFormatted!=null;option.text=valueFormattedExits?valueFormatted:currentValue,eSelect.addOption(option),hasValue=hasValue||value===currentValue}),hasValue?eSelect.setValue(params.value,!0):params.values.length&&eSelect.setValue(params.values[0],!0);const{valueListGap,valueListMaxWidth,valueListMaxHeight}=params;valueListGap!=null&&eSelect.setPickerGap(valueListGap),valueListMaxHeight!=null&&eSelect.setPickerMaxHeight(valueListMaxHeight),valueListMaxWidth!=null&&eSelect.setPickerMaxWidth(valueListMaxWidth),gridOptionsService.get("editType")!=="fullRow"&&this.addManagedListener(this.eSelect,AgSelect.EVENT_ITEM_SELECTED,()=>params.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}},__name(_a66,"SelectCellEditor"),_a66);__decorateClass([Autowired("valueFormatterService")],SelectCellEditor.prototype,"valueFormatterService",2);__decorateClass([RefSelector("eSelect")],SelectCellEditor.prototype,"eSelect",2);var _a67,SimpleCellEditor=(_a67=class extends PopupComponent{constructor(cellEditorInput){super(`
            <div class="ag-cell-edit-wrapper">
                ${cellEditorInput.getTemplate()}
            </div>`),this.cellEditorInput=cellEditorInput}init(params){this.params=params;const eInput=this.eInput;this.cellEditorInput.init(eInput,params);let startValue;if(params.cellStartedEdit){this.focusAfterAttached=!0;const eventKey=params.eventKey;eventKey===KeyCode.BACKSPACE||params.eventKey===KeyCode.DELETE?startValue="":eventKey&&eventKey.length===1?startValue=eventKey:(startValue=this.cellEditorInput.getStartValue(),eventKey!==KeyCode.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,startValue=this.cellEditorInput.getStartValue();startValue!=null&&eInput.setStartValue(startValue),this.addManagedListener(eInput.getGui(),"keydown",event=>{const{key}=event;(key===KeyCode.PAGE_UP||key===KeyCode.PAGE_DOWN)&&event.preventDefault()})}afterGuiAttached(){var _a273,_b;const translate=this.localeService.getLocaleTextFunc(),eInput=this.eInput;if(eInput.setInputAriaLabel(translate("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;isBrowserSafari()||eInput.getFocusableElement().focus();const inputEl=eInput.getInputElement();this.highlightAllOnFocus?inputEl.select():(_b=(_a273=this.cellEditorInput).setCaret)==null||_b.call(_a273)}focusIn(){const eInput=this.eInput,focusEl=eInput.getFocusableElement(),inputEl=eInput.getInputElement();focusEl.focus(),inputEl.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},__name(_a67,"SimpleCellEditor"),_a67);__decorateClass([RefSelector("eInput")],SimpleCellEditor.prototype,"eInput",2);var _a68,TextCellEditorInput=(_a68=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(eInput,params){this.eInput=eInput,this.params=params,params.maxLength!=null&&eInput.setMaxLength(params.maxLength)}getValue(){const value=this.eInput.getValue();return!exists(value)&&!exists(this.params.value)?this.params.value:this.params.parseValue(value)}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const value=this.eInput.getValue(),len=exists(value)&&value.length||0;len&&this.eInput.getInputElement().setSelectionRange(len,len)}},__name(_a68,"TextCellEditorInput"),_a68),_a69,TextCellEditor=(_a69=class extends SimpleCellEditor{constructor(){super(new TextCellEditorInput)}},__name(_a69,"TextCellEditor"),_a69),ARROW_UP="↑",ARROW_DOWN="↓",_a70,AnimateShowChangeCellRenderer=(_a70=class extends Component{constructor(){super(),this.refreshCount=0;const template=document.createElement("span"),delta=document.createElement("span");delta.setAttribute("class","ag-value-change-delta");const value=document.createElement("span");value.setAttribute("class","ag-value-change-value"),template.appendChild(delta),template.appendChild(value),this.setTemplateFromElement(template)}init(params){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(params,!0)}showDelta(params,delta){const absDelta=Math.abs(delta),valueFormatted=params.formatValue(absDelta),valueToUse=exists(valueFormatted)?valueFormatted:absDelta,deltaUp=delta>=0;deltaUp?this.eDelta.textContent=ARROW_UP+valueToUse:this.eDelta.textContent=ARROW_DOWN+valueToUse,this.eDelta.classList.toggle("ag-value-change-delta-up",deltaUp),this.eDelta.classList.toggle("ag-value-change-delta-down",!deltaUp)}setTimerToRemoveDelta(){this.refreshCount++;const refreshCountCopy=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{refreshCountCopy===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),clearElement(this.eDelta)}refresh(params,isInitialRender=!1){const value=params.value;if(value===this.lastValue||(exists(params.valueFormatted)?this.eValue.textContent=params.valueFormatted:exists(params.value)?this.eValue.textContent=value:clearElement(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof value=="number"&&typeof this.lastValue=="number"){const delta=value-this.lastValue;this.showDelta(params,delta)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),isInitialRender||this.setTimerToRemoveDelta(),this.lastValue=value,!0}},__name(_a70,"AnimateShowChangeCellRenderer"),_a70);__decorateClass([Autowired("filterManager")],AnimateShowChangeCellRenderer.prototype,"filterManager",2);var _a71,AnimateSlideCellRenderer=(_a71=class extends Component{constructor(){super(),this.refreshCount=0;const template=document.createElement("span"),slide=document.createElement("span");slide.setAttribute("class","ag-value-slide-current"),template.appendChild(slide),this.setTemplateFromElement(template),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(params){this.refresh(params,!0)}addSlideAnimation(){this.refreshCount++;const refreshCountCopy=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const prevElement=document.createElement("span");prevElement.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=prevElement,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{refreshCountCopy===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{refreshCountCopy===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(params,isInitialRender=!1){let value=params.value;return missing(value)&&(value=""),value===this.lastValue||this.filterManager.isSuppressFlashingCellsBecauseFiltering()?!1:(isInitialRender||this.addSlideAnimation(),this.lastValue=value,exists(params.valueFormatted)?this.eCurrent.textContent=params.valueFormatted:exists(params.value)?this.eCurrent.textContent=value:clearElement(this.eCurrent),!0)}},__name(_a71,"AnimateSlideCellRenderer"),_a71);__decorateClass([Autowired("filterManager")],AnimateSlideCellRenderer.prototype,"filterManager",2);var _a72,_RowNode=(_a72=class{constructor(beans){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=_a72.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=beans}setData(data){this.setDataCommon(data,!1)}updateData(data){this.setDataCommon(data,!0)}setDataCommon(data,update){const oldData=this.data;this.data=data,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const event=this.createDataChangedEvent(data,oldData,update);this.dispatchLocalEvent(event)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(newData,oldData,update){return{type:_a72.EVENT_DATA_CHANGED,node:this,oldData,newData,update}}createLocalRowEvent(type){return{type,node:this}}getRowIndexString(){return this.rowPinned==="top"?"t-"+this.rowIndex:this.rowPinned==="bottom"?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const oldNode=new _a72(this.beans);return oldNode.id=this.id,oldNode.data=this.data,oldNode.__daemon=!0,oldNode.selected=this.selected,oldNode.level=this.level,oldNode}setDataAndId(data,id){const oldNode=exists(this.id)?this.createDaemonNode():null,oldData=this.data;this.data=data,this.updateDataOnDetailNode(),this.setId(id),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,oldNode);const event=this.createDataChangedEvent(data,oldData,!1);this.dispatchLocalEvent(event)}checkRowSelectable(){const isRowSelectableFunc=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(isRowSelectableFunc?isRowSelectableFunc(this):!0)}setRowSelectable(newVal,suppressSelectionUpdate){if(this.selectable!==newVal){if(this.selectable=newVal,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_SELECTABLE_CHANGED)),suppressSelectionUpdate)return;if(this.beans.gridOptionsService.get("groupSelectsChildren")){const selected=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:selected??!1,source:"selectableChanged"});return}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(id){const getRowIdFunc=this.beans.gridOptionsService.getCallback("getRowId");if(getRowIdFunc)if(this.data){const parentKeys=this.getGroupKeys(!0);this.id=getRowIdFunc({data:this.data,parentKeys:parentKeys.length>0?parentKeys:void 0,level:this.level}),this.id!==null&&typeof this.id=="string"&&this.id.startsWith(_a72.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${_a72.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),this.id!==null&&typeof this.id!="string"&&(this.id=""+this.id)}else this.id=void 0;else this.id=id}getGroupKeys(excludeSelf=!1){const keys2=[];let pointer=this;for(excludeSelf&&(pointer=pointer.parent);pointer&&pointer.level>=0;)keys2.push(pointer.key),pointer=pointer.parent;return keys2.reverse(),keys2}isPixelInRange(pixel){return!exists(this.rowTop)||!exists(this.rowHeight)?!1:pixel>=this.rowTop&&pixel<this.rowTop+this.rowHeight}setFirstChild(firstChild){this.firstChild!==firstChild&&(this.firstChild=firstChild,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(lastChild){this.lastChild!==lastChild&&(this.lastChild=lastChild,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(childIndex){this.childIndex!==childIndex&&(this.childIndex=childIndex,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(rowTop){this.oldRowTop=this.rowTop,this.rowTop!==rowTop&&(this.rowTop=rowTop,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_TOP_CHANGED)),this.setDisplayed(rowTop!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(displayed){this.displayed!==displayed&&(this.displayed=displayed,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_DISPLAYED_CHANGED)))}setDragging(dragging){this.dragging!==dragging&&(this.dragging=dragging,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_DRAGGING_CHANGED)))}setHighlighted(highlighted){highlighted!==this.highlighted&&(this.highlighted=highlighted,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_HIGHLIGHT_CHANGED)))}setHovered(hovered){this.hovered!==hovered&&(this.hovered=hovered)}isHovered(){return this.hovered}setAllChildrenCount(allChildrenCount){this.allChildrenCount!==allChildrenCount&&(this.allChildrenCount=allChildrenCount,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(master){this.master!==master&&(this.master&&!master&&(this.expanded=!1),this.master=master,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_MASTER_CHANGED)))}setGroup(group){this.group!==group&&(this.group&&!group&&(this.expanded=!1),this.group=group,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_GROUP_CHANGED)))}setRowHeight(rowHeight,estimated=!1){this.rowHeight=rowHeight,this.rowHeightEstimated=estimated,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(cellHeight,column){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[column.getId()]=cellHeight,cellHeight!=null&&(this.checkAutoHeightsDebounced==null&&(this.checkAutoHeightsDebounced=debounce(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let notAllPresent=!1,nonePresent=!0,newRowHeight=0;const autoHeights=this.__autoHeights;if(autoHeights==null||(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(col=>{let cellHeight=autoHeights[col.getId()];if(cellHeight==null)if(this.beans.columnModel.isColSpanActive()){let activeColsForRow=[];switch(col.getPinned()){case"left":activeColsForRow=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":activeColsForRow=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:activeColsForRow=this.beans.columnModel.getViewportCenterColumnsForRow(this);break}if(activeColsForRow.includes(col)){notAllPresent=!0;return}cellHeight=-1}else{notAllPresent=!0;return}else nonePresent=!1;cellHeight>newRowHeight&&(newRowHeight=cellHeight)}),notAllPresent)||((nonePresent||newRowHeight<10)&&(newRowHeight=this.beans.gridOptionsService.getRowHeightForNode(this).height),newRowHeight==this.rowHeight))return;this.setRowHeight(newRowHeight);const rowModel=this.beans.rowModel;rowModel.onRowHeightChangedDebounced&&rowModel.onRowHeightChangedDebounced()}setRowIndex(rowIndex){this.rowIndex!==rowIndex&&(this.rowIndex=rowIndex,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(uiLevel){this.uiLevel!==uiLevel&&(this.uiLevel=uiLevel,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_UI_LEVEL_CHANGED)))}setExpanded(expanded,e){if(this.expanded===expanded)return;this.expanded=expanded,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_EXPANDED_CHANGED));const event=Object.assign({},this.createGlobalRowEvent(Events.EVENT_ROW_GROUP_OPENED),{expanded,event:e||null});this.beans.rowNodeEventThrottle.dispatchExpanded(event),this.sibling&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(type){return this.beans.gridOptionsService.addGridCommonParams({type,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}dispatchLocalEvent(event){this.eventService&&this.eventService.dispatchEvent(event)}setDataValue(colKey,newValue,eventSource){const column=__name(()=>{var _a273;return typeof colKey!="string"?colKey:(_a273=this.beans.columnModel.getGridColumn(colKey))!=null?_a273:this.beans.columnModel.getPrimaryColumn(colKey)},"getColumnFromKey")(),oldValue=this.getValueFromValueService(column);if(this.beans.gridOptionsService.get("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(column,oldValue,newValue,eventSource),!1;const valueChanged=this.beans.valueService.setValue(this,column,newValue,eventSource);return this.dispatchCellChangedEvent(column,newValue,oldValue),this.checkRowSelectable(),valueChanged}getValueFromValueService(column){const lockedClosedGroup=this.leafGroup&&this.beans.columnModel.isPivotMode(),isOpenGroup=this.group&&this.expanded&&!this.footer&&!lockedClosedGroup,groupFootersEnabled=this.beans.gridOptionsService.getGroupIncludeFooter()({node:this}),groupAlwaysShowAggData=this.beans.gridOptionsService.get("groupSuppressBlankHeader"),ignoreAggData=isOpenGroup&&groupFootersEnabled&&!groupAlwaysShowAggData;return this.beans.valueService.getValue(column,this,!1,ignoreAggData)}dispatchEventForSaveValueReadOnly(column,oldValue,newValue,eventSource){const event=this.beans.gridOptionsService.addGridCommonParams({type:Events.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column,colDef:column.getColDef(),data:this.data,node:this,oldValue,newValue,value:newValue,source:eventSource});this.beans.eventService.dispatchEvent(event)}setGroupValue(colKey,newValue){const column=this.beans.columnModel.getGridColumn(colKey);missing(this.groupData)&&(this.groupData={});const columnId=column.getColId(),oldValue=this.groupData[columnId];oldValue!==newValue&&(this.groupData[columnId]=newValue,this.dispatchCellChangedEvent(column,newValue,oldValue))}setAggData(newAggData){const oldAggData=this.aggData;if(this.aggData=newAggData,this.eventService){const eventFunc=__name(colId=>{const value=this.aggData?this.aggData[colId]:void 0,oldValue=oldAggData?oldAggData[colId]:void 0;if(value===oldValue)return;const column=this.beans.columnModel.lookupGridColumn(colId);column&&this.dispatchCellChangedEvent(column,value,oldValue)},"eventFunc");for(const key in this.aggData)eventFunc(key);for(const key in newAggData)key in this.aggData||eventFunc(key)}}updateHasChildren(){let newValue=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){const isTreeData=this.beans.gridOptionsService.get("treeData"),isGroupFunc=this.beans.gridOptionsService.get("isServerSideGroup");newValue=!this.stub&&!this.footer&&(isTreeData?!!isGroupFunc&&isGroupFunc(this.data):!!this.group)}newValue!==this.__hasChildren&&(this.__hasChildren=!!newValue,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_a72.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&missingOrEmpty(this.childrenAfterGroup)}dispatchCellChangedEvent(column,newValue,oldValue){const cellChangedEvent={type:_a72.EVENT_CELL_CHANGED,node:this,column,newValue,oldValue};this.dispatchLocalEvent(cellChangedEvent)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.footer?!1:this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(callback){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(child=>child.depthFirstSearch(callback)),callback(this)}calculateSelectedFromChildren(){var _a273;let atLeastOneSelected=!1,atLeastOneDeSelected=!1,atLeastOneMixed=!1;if(!((_a273=this.childrenAfterGroup)!=null&&_a273.length))return this.selectable?this.selected:null;for(let i=0;i<this.childrenAfterGroup.length;i++){const child=this.childrenAfterGroup[i];let childState=child.isSelected();if(!child.selectable){const selectable=child.calculateSelectedFromChildren();if(selectable===null)continue;childState=selectable}switch(childState){case!0:atLeastOneSelected=!0;break;case!1:atLeastOneDeSelected=!0;break;default:atLeastOneMixed=!0;break}}if(!(atLeastOneMixed||atLeastOneSelected&&atLeastOneDeSelected))return atLeastOneSelected?!0:atLeastOneDeSelected?!1:this.selectable?this.selected:null}setSelectedInitialValue(selected){this.selected=selected}selectThisNode(newValue,e,source="api"){const selectionNotAllowed=!this.selectable&&newValue,selectionNotChanged=this.selected===newValue;if(selectionNotAllowed||selectionNotChanged)return!1;if(this.selected=newValue,this.eventService){this.dispatchLocalEvent(this.createLocalRowEvent(_a72.EVENT_ROW_SELECTED));const sibling=this.sibling;sibling&&sibling.footer&&sibling.dispatchLocalEvent(sibling.createLocalRowEvent(_a72.EVENT_ROW_SELECTED))}const event=__spreadProps(__spreadValues({},this.createGlobalRowEvent(Events.EVENT_ROW_SELECTED)),{event:e||null,source});return this.beans.eventService.dispatchEvent(event),!0}setSelected(newValue,clearSelection=!1,source="api"){if(typeof source=="boolean"){console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.");return}this.setSelectedParams({newValue,clearSelection,rangeSelect:!1,source})}setSelectedParams(params){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):this.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(__spreadProps(__spreadValues({},params),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return this.rowPinned==="top"||this.rowPinned==="bottom"}isParentOfNode(potentialParent){let parentNode=this.parent;for(;parentNode;){if(parentNode===potentialParent)return!0;parentNode=parentNode.parent}return!1}addEventListener(eventType,userListener){var _a273,_b;this.eventService||(this.eventService=new EventService),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new FrameworkEventListenerService(this.beans.frameworkOverrides));const listener=(_b=(_a273=this.frameworkEventListenerService)==null?void 0:_a273.wrap(userListener))!=null?_b:userListener;this.eventService.addEventListener(eventType,listener)}removeEventListener(eventType,userListener){var _a273,_b;if(!this.eventService)return;const listener=(_b=(_a273=this.frameworkEventListenerService)==null?void 0:_a273.unwrap(userListener))!=null?_b:userListener;this.eventService.removeEventListener(eventType,listener),this.eventService.noRegisteredListenersExist()&&(this.eventService=null)}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(_a72.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(_a72.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(rowGroupColumn){let currentRowNode=this,isCandidate=!0,foundFirstChildPath=!1,nodeToSwapIn=null;for(;isCandidate&&!foundFirstChildPath;){const parentRowNode=currentRowNode.parent;exists(parentRowNode)&&currentRowNode.firstChild?parentRowNode.rowGroupColumn===rowGroupColumn&&(foundFirstChildPath=!0,nodeToSwapIn=parentRowNode):isCandidate=!1,currentRowNode=parentRowNode}return foundFirstChildPath?nodeToSwapIn:null}isFullWidthCell(){if(this.detail)return!0;const isFullWidthCellFunc=this.beans.gridOptionsService.getCallback("isFullWidthRow");return isFullWidthCellFunc?isFullWidthCellFunc({rowNode:this}):!1}getRoute(){if(this.key==null)return;const res=[];let pointer=this;for(;pointer.key!=null;)res.push(pointer.key),pointer=pointer.parent;return res.reverse()}createFooter(){if(this.sibling)return;const ignoredProperties=new Set(["eventService","__objectId","sticky"]),footerNode=new _a72(this.beans);Object.keys(this).forEach(key=>{ignoredProperties.has(key)||(footerNode[key]=this[key])}),footerNode.footer=!0,footerNode.setRowTop(null),footerNode.setRowIndex(null),footerNode.oldRowTop=null,footerNode.id="rowGroupFooter_"+this.id,footerNode.sibling=this,this.sibling=footerNode}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}},__name(_a72,"_RowNode"),_a72);_RowNode.ID_PREFIX_ROW_GROUP="row-group-";_RowNode.ID_PREFIX_TOP_PINNED="t-";_RowNode.ID_PREFIX_BOTTOM_PINNED="b-";_RowNode.OBJECT_ID_SEQUENCE=0;_RowNode.EVENT_ROW_SELECTED="rowSelected";_RowNode.EVENT_DATA_CHANGED="dataChanged";_RowNode.EVENT_CELL_CHANGED="cellChanged";_RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged";_RowNode.EVENT_MASTER_CHANGED="masterChanged";_RowNode.EVENT_GROUP_CHANGED="groupChanged";_RowNode.EVENT_MOUSE_ENTER="mouseEnter";_RowNode.EVENT_MOUSE_LEAVE="mouseLeave";_RowNode.EVENT_HEIGHT_CHANGED="heightChanged";_RowNode.EVENT_TOP_CHANGED="topChanged";_RowNode.EVENT_DISPLAYED_CHANGED="displayedChanged";_RowNode.EVENT_FIRST_CHILD_CHANGED="firstChildChanged";_RowNode.EVENT_LAST_CHILD_CHANGED="lastChildChanged";_RowNode.EVENT_CHILD_INDEX_CHANGED="childIndexChanged";_RowNode.EVENT_ROW_INDEX_CHANGED="rowIndexChanged";_RowNode.EVENT_EXPANDED_CHANGED="expandedChanged";_RowNode.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged";_RowNode.EVENT_SELECTABLE_CHANGED="selectableChanged";_RowNode.EVENT_UI_LEVEL_CHANGED="uiLevelChanged";_RowNode.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged";_RowNode.EVENT_DRAGGING_CHANGED="draggingChanged";var RowNode=_RowNode,_a73,CheckboxSelectionComponent=(_a73=class extends Component{constructor(){super(`
            <div class="ag-selection-checkbox" role="presentation">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const translate=this.localeService.getLocaleTextFunc(),state=this.rowNode.isSelected(),stateName=getAriaCheckboxStateName(translate,state),[ariaKey,ariaLabel]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],translatedLabel=translate(ariaKey,ariaLabel);this.eCheckbox.setValue(state,!0),this.eCheckbox.setInputAriaLabel(`${translatedLabel} (${stateName})`)}onClicked(newValue,groupSelectsFiltered,event){return this.rowNode.setSelectedParams({newValue,rangeSelect:event.shiftKey,groupSelectsFiltered,event,source:"checkboxSelected"})}init(params){if(this.rowNode=params.rowNode,this.column=params.column,this.overrides=params.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",event=>{stopPropagationForAgGrid(event)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",event=>{stopPropagationForAgGrid(event);const groupSelectsFiltered=this.gridOptionsService.get("groupSelectsFiltered"),isSelected=this.eCheckbox.getValue();this.shouldHandleIndeterminateState(isSelected,groupSelectsFiltered)?this.onClicked(!0,groupSelectsFiltered,event||{})===0&&this.onClicked(!1,groupSelectsFiltered,event):isSelected?this.onClicked(!1,groupSelectsFiltered,event):this.onClicked(!0,groupSelectsFiltered,event||{})}),this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsService.get("isRowSelectable")||typeof this.getIsVisible()=="function"){const showOrHideSelectListener=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,showOrHideSelectListener),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,showOrHideSelectListener),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,showOrHideSelectListener),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(isSelected,groupSelectsFiltered){return groupSelectsFiltered&&(this.eCheckbox.getPreviousValue()===void 0||isSelected===void 0)&&this.gridOptionsService.isRowModelType("clientSide")}showOrHideSelect(){var _a273,_b,_c;let selectable=this.rowNode.selectable;const isVisible2=this.getIsVisible();if(selectable)if(typeof isVisible2=="function"){const extraParams=(_a273=this.overrides)==null?void 0:_a273.callbackParams;if(!this.column)selectable=isVisible2(__spreadProps(__spreadValues({},extraParams),{node:this.rowNode,data:this.rowNode.data}));else{const params=this.column.createColumnFunctionCallbackParams(this.rowNode);selectable=isVisible2(__spreadValues(__spreadValues({},extraParams),params))}}else selectable=isVisible2??!1;if((_b=this.column)==null?void 0:_b.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!selectable),this.setVisible(!0),this.setDisplayed(!0);return}if((_c=this.overrides)!=null&&_c.removeHidden){this.setDisplayed(selectable);return}this.setVisible(selectable)}getIsVisible(){var _a273,_b;return this.overrides?this.overrides.isVisible:(_b=(_a273=this.column)==null?void 0:_a273.getColDef())==null?void 0:_b.checkboxSelection}},__name(_a73,"CheckboxSelectionComponent"),_a73);__decorateClass([RefSelector("eCheckbox")],CheckboxSelectionComponent.prototype,"eCheckbox",2);__decorateClass([PostConstruct],CheckboxSelectionComponent.prototype,"postConstruct",1);var HorizontalDirection=(HorizontalDirection2=>(HorizontalDirection2[HorizontalDirection2.Left=0]="Left",HorizontalDirection2[HorizontalDirection2.Right=1]="Right",HorizontalDirection2))(HorizontalDirection||{}),_a74,DragAndDropService=(_a74=class extends BeanStub{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=createIcon("columnMovePin",this.gridOptionsService,null),this.eHideIcon=createIcon("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=createIcon("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=createIcon("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=createIcon("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=createIcon("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=createIcon("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=createIcon("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=createIcon("dropNotAllowed",this.gridOptionsService,null)}addDragSource(dragSource,allowTouch=!1){const params={eElement:dragSource.eElement,dragStartPixels:dragSource.dragStartPixels,onDragStart:this.onDragStart.bind(this,dragSource),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:allowTouch};this.dragSourceAndParamsList.push({params,dragSource}),this.dragService.addDragSource(params)}removeDragSource(dragSource){const sourceAndParams=this.dragSourceAndParamsList.find(item=>item.dragSource===dragSource);sourceAndParams&&(this.dragService.removeDragSource(sourceAndParams.params),removeFromArray(this.dragSourceAndParamsList,sourceAndParams))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(sourceAndParams=>this.dragService.removeDragSource(sourceAndParams.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(dragSource,mouseEvent){this.dragging=!0,this.dragSource=dragSource,this.eventLastTime=mouseEvent,this.dragItem=this.dragSource.getDragItem(),this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(mouseEvent){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const draggingEvent=this.createDropTargetEvent(this.lastDropTarget,mouseEvent,null,null,!1);this.lastDropTarget.onDragStop(draggingEvent)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(mouseEvent,fromNudge){var _a273,_b,_c,_d;const hDirection=this.getHorizontalDirection(mouseEvent),vDirection=this.getVerticalDirection(mouseEvent);this.eventLastTime=mouseEvent,this.positionGhost(mouseEvent);const validDropTargets=this.dropTargets.filter(target=>this.isMouseOnDropTarget(mouseEvent,target)),dropTarget=this.findCurrentDropTarget(mouseEvent,validDropTargets);if(dropTarget!==this.lastDropTarget)this.leaveLastTargetIfExists(mouseEvent,hDirection,vDirection,fromNudge),this.lastDropTarget!==null&&dropTarget===null&&((_b=(_a273=this.dragSource).onGridExit)==null||_b.call(_a273,this.dragItem)),this.lastDropTarget===null&&dropTarget!==null&&((_d=(_c=this.dragSource).onGridEnter)==null||_d.call(_c,this.dragItem)),this.enterDragTargetIfExists(dropTarget,mouseEvent,hDirection,vDirection,fromNudge),this.lastDropTarget=dropTarget;else if(dropTarget&&dropTarget.onDragging){const draggingEvent=this.createDropTargetEvent(dropTarget,mouseEvent,hDirection,vDirection,fromNudge);dropTarget.onDragging(draggingEvent)}}getAllContainersFromDropTarget(dropTarget){const secondaryContainers=dropTarget.getSecondaryContainers?dropTarget.getSecondaryContainers():null,containers=[[dropTarget.getContainer()]];return secondaryContainers?containers.concat(secondaryContainers):containers}allContainersIntersect(mouseEvent,containers){for(const container of containers){const rect=container.getBoundingClientRect();if(rect.width===0||rect.height===0)return!1;const horizontalFit=mouseEvent.clientX>=rect.left&&mouseEvent.clientX<rect.right,verticalFit=mouseEvent.clientY>=rect.top&&mouseEvent.clientY<rect.bottom;if(!horizontalFit||!verticalFit)return!1}return!0}isMouseOnDropTarget(mouseEvent,dropTarget){const allContainersFromDropTarget=this.getAllContainersFromDropTarget(dropTarget);let mouseOverTarget=!1;for(const currentContainers of allContainersFromDropTarget)if(this.allContainersIntersect(mouseEvent,currentContainers)){mouseOverTarget=!0;break}return dropTarget.targetContainsSource&&!dropTarget.getContainer().contains(this.dragSource.eElement)?!1:mouseOverTarget&&dropTarget.isInterestedIn(this.dragSource.type,this.dragSource.eElement)}findCurrentDropTarget(mouseEvent,validDropTargets){const len=validDropTargets.length;if(len===0)return null;if(len===1)return validDropTargets[0];const elementStack=this.gridOptionsService.getRootNode().elementsFromPoint(mouseEvent.clientX,mouseEvent.clientY);for(const el of elementStack)for(const dropTarget of validDropTargets)if(flatten(this.getAllContainersFromDropTarget(dropTarget)).indexOf(el)!==-1)return dropTarget;return null}enterDragTargetIfExists(dropTarget,mouseEvent,hDirection,vDirection,fromNudge){if(dropTarget){if(dropTarget.onDragEnter){const dragEnterEvent=this.createDropTargetEvent(dropTarget,mouseEvent,hDirection,vDirection,fromNudge);dropTarget.onDragEnter(dragEnterEvent)}this.setGhostIcon(dropTarget.getIconName?dropTarget.getIconName():null)}}leaveLastTargetIfExists(mouseEvent,hDirection,vDirection,fromNudge){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const dragLeaveEvent=this.createDropTargetEvent(this.lastDropTarget,mouseEvent,hDirection,vDirection,fromNudge);this.lastDropTarget.onDragLeave(dragLeaveEvent)}this.setGhostIcon(null)}}addDropTarget(dropTarget){this.dropTargets.push(dropTarget)}removeDropTarget(dropTarget){this.dropTargets=this.dropTargets.filter(target=>target.getContainer()!==dropTarget.getContainer())}hasExternalDropZones(){return this.dropTargets.some(zones=>zones.external)}findExternalZone(params){return this.dropTargets.filter(target=>target.external).find(zone=>zone.getContainer()===params.getContainer())||null}getHorizontalDirection(event){const clientX=this.eventLastTime&&this.eventLastTime.clientX,eClientX=event.clientX;return clientX===eClientX?null:clientX>eClientX?0:1}getVerticalDirection(event){const clientY=this.eventLastTime&&this.eventLastTime.clientY,eClientY=event.clientY;return clientY===eClientY?null:clientY>eClientY?0:1}createDropTargetEvent(dropTarget,event,hDirection,vDirection,fromNudge){const dropZoneTarget=dropTarget.getContainer(),rect=dropZoneTarget.getBoundingClientRect(),{gridApi:api,columnApi,dragItem,dragSource}=this,x=event.clientX-rect.left,y=event.clientY-rect.top;return{event,x,y,vDirection,hDirection,dragSource,fromNudge,dragItem,api,columnApi,dropZoneTarget}}positionGhost(event){const ghost=this.eGhost;if(!ghost)return;const ghostHeight=ghost.getBoundingClientRect().height,browserWidth=getBodyWidth()-2,browserHeight=getBodyHeight()-2,offsetParentSize=getElementRectWithOffset(ghost.offsetParent),{clientY,clientX}=event;let top=clientY-offsetParentSize.top-ghostHeight/2,left=clientX-offsetParentSize.left-10;const eDocument=this.gridOptionsService.getDocument(),win=eDocument.defaultView||window,windowScrollY=win.pageYOffset||eDocument.documentElement.scrollTop,windowScrollX=win.pageXOffset||eDocument.documentElement.scrollLeft;browserWidth>0&&left+ghost.clientWidth>browserWidth+windowScrollX&&(left=browserWidth+windowScrollX-ghost.clientWidth),left<0&&(left=0),browserHeight>0&&top+ghost.clientHeight>browserHeight+windowScrollY&&(top=browserHeight+windowScrollY-ghost.clientHeight),top<0&&(top=0),ghost.style.left=`${left}px`,ghost.style.top=`${top}px`}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=loadTemplate(DragAndDropService.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme}=this.environment.getTheme();theme&&this.eGhost.classList.add(theme),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const eText=this.eGhost.querySelector(".ag-dnd-ghost-label");let dragItemName=this.dragSource.dragItemName;isFunction(dragItemName)&&(dragItemName=dragItemName()),eText.innerHTML=escapeString(dragItemName)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const eDocument=this.gridOptionsService.getDocument();let rootNode=null,targetEl=null;try{rootNode=eDocument.fullscreenElement}catch{}finally{rootNode||(rootNode=this.gridOptionsService.getRootNode());const body=rootNode.querySelector("body");body?targetEl=body:rootNode instanceof ShadowRoot?targetEl=rootNode:rootNode instanceof Document?targetEl=rootNode==null?void 0:rootNode.documentElement:targetEl=rootNode}this.eGhostParent=targetEl,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(iconName,shake=!1){clearElement(this.eGhostIcon);let eIcon=null;switch(iconName||(iconName=this.dragSource.getDefaultIconName?this.dragSource.getDefaultIconName():DragAndDropService.ICON_NOT_ALLOWED),iconName){case DragAndDropService.ICON_PINNED:eIcon=this.ePinnedIcon;break;case DragAndDropService.ICON_MOVE:eIcon=this.eMoveIcon;break;case DragAndDropService.ICON_LEFT:eIcon=this.eLeftIcon;break;case DragAndDropService.ICON_RIGHT:eIcon=this.eRightIcon;break;case DragAndDropService.ICON_GROUP:eIcon=this.eGroupIcon;break;case DragAndDropService.ICON_AGGREGATE:eIcon=this.eAggregateIcon;break;case DragAndDropService.ICON_PIVOT:eIcon=this.ePivotIcon;break;case DragAndDropService.ICON_NOT_ALLOWED:eIcon=this.eDropNotAllowedIcon;break;case DragAndDropService.ICON_HIDE:eIcon=this.eHideIcon;break}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",shake),!(eIcon===this.eHideIcon&&this.gridOptionsService.get("suppressDragLeaveHidesColumns"))&&eIcon&&this.eGhostIcon.appendChild(eIcon)}},__name(_a74,"DragAndDropService"),_a74);DragAndDropService.ICON_PINNED="pinned";DragAndDropService.ICON_MOVE="move";DragAndDropService.ICON_LEFT="left";DragAndDropService.ICON_RIGHT="right";DragAndDropService.ICON_GROUP="group";DragAndDropService.ICON_AGGREGATE="aggregate";DragAndDropService.ICON_PIVOT="pivot";DragAndDropService.ICON_NOT_ALLOWED="notAllowed";DragAndDropService.ICON_HIDE="hide";DragAndDropService.GHOST_TEMPLATE=`<div class="ag-dnd-ghost ag-unselectable">
            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>
            <div class="ag-dnd-ghost-label"></div>
        </div>`;__decorateClass([Autowired("dragService")],DragAndDropService.prototype,"dragService",2);__decorateClass([Autowired("mouseEventService")],DragAndDropService.prototype,"mouseEventService",2);__decorateClass([Autowired("columnApi")],DragAndDropService.prototype,"columnApi",2);__decorateClass([Autowired("gridApi")],DragAndDropService.prototype,"gridApi",2);__decorateClass([PostConstruct],DragAndDropService.prototype,"init",1);__decorateClass([PreDestroy],DragAndDropService.prototype,"clearDragSourceParamsList",1);DragAndDropService=__decorateClass([Bean("dragAndDropService")],DragAndDropService);var _a75,RowDragComp=(_a75=class extends Component{constructor(cellValueFn,rowNode,column,customGui,dragStartPixels,suppressVisibilityChange){super(),this.cellValueFn=cellValueFn,this.rowNode=rowNode,this.column=column,this.customGui=customGui,this.dragStartPixels=dragStartPixels,this.suppressVisibilityChange=suppressVisibilityChange,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(createIconNoSpan("rowDrag",this.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const strategy=this.gridOptionsService.get("rowDragManaged")?new ManagedVisibilityStrategy(this,this.beans,this.rowNode,this.column):new NonManagedVisibilityStrategy(this,this.beans,this.rowNode,this.column);this.createManagedBean(strategy,this.beans.context)}}setDragElement(dragElement,dragStartPixels){this.setTemplateFromElement(dragElement),this.addDragSource(dragStartPixels)}getSelectedNodes(){if(!this.gridOptionsService.get("rowDragMultiRow"))return[this.rowNode];const selection=this.beans.selectionService.getSelectedNodes();return selection.indexOf(this.rowNode)!==-1?selection:[this.rowNode]}checkCompatibility(){const managed=this.gridOptionsService.get("rowDragManaged");this.gridOptionsService.get("treeData")&&managed&&warnOnce("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(column){if(column){const colDef=column.getColDef();if(colDef.rowDragText)return colDef.rowDragText}return this.gridOptionsService.get("rowDragText")}addDragSource(dragStartPixels=4){this.dragSource&&this.removeDragSource();const translate=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:this.getGui(),dragItemName:()=>{var _a273;const dragItem=this.getDragItem(),dragItemCount=((_a273=dragItem.rowNodes)==null?void 0:_a273.length)||1,rowDragText=this.getRowDragText(this.column);return rowDragText?rowDragText(dragItem,dragItemCount):dragItemCount===1?this.cellValueFn():`${dragItemCount} ${translate("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels,dragSourceDomDataKey:this.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}},__name(_a75,"RowDragComp"),_a75);__decorateClass([Autowired("beans")],RowDragComp.prototype,"beans",2);__decorateClass([PostConstruct],RowDragComp.prototype,"postConstruct",1);__decorateClass([PreDestroy],RowDragComp.prototype,"removeDragSource",1);var _a76,VisibilityStrategy=(_a76=class extends BeanStub{constructor(parent,rowNode,column){super(),this.parent=parent,this.rowNode=rowNode,this.column=column}setDisplayedOrVisible(neverDisplayed){const displayedOptions={skipAriaHidden:!0};if(neverDisplayed)this.parent.setDisplayed(!1,displayedOptions);else{let shown=!0,isShownSometimes=!1;this.column&&(shown=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),isShownSometimes=isFunction(this.column.getColDef().rowDrag)),isShownSometimes?(this.parent.setDisplayed(!0,displayedOptions),this.parent.setVisible(shown,displayedOptions)):(this.parent.setDisplayed(shown,displayedOptions),this.parent.setVisible(!0,displayedOptions))}}},__name(_a76,"VisibilityStrategy"),_a76),_a77,NonManagedVisibilityStrategy=(_a77=class extends VisibilityStrategy{constructor(parent,beans,rowNode,column){super(parent,rowNode,column),this.beans=beans}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const neverDisplayed=this.gridOptionsService.get("suppressRowDrag");this.setDisplayedOrVisible(neverDisplayed)}},__name(_a77,"NonManagedVisibilityStrategy"),_a77);__decorateClass([PostConstruct],NonManagedVisibilityStrategy.prototype,"postConstruct",1);var _a78,ManagedVisibilityStrategy=(_a78=class extends VisibilityStrategy{constructor(parent,beans,rowNode,column){super(parent,rowNode,column),this.beans=beans}postConstruct(){this.addManagedListener(this.beans.eventService,Events.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const rowDragFeature=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),shouldPreventRowMove=rowDragFeature&&rowDragFeature.shouldPreventRowMove(),suppressRowDrag=this.gridOptionsService.get("suppressRowDrag"),hasExternalDropZones=this.beans.dragAndDropService.hasExternalDropZones(),neverDisplayed=shouldPreventRowMove&&!hasExternalDropZones||suppressRowDrag;this.setDisplayedOrVisible(neverDisplayed)}},__name(_a78,"ManagedVisibilityStrategy"),_a78);__decorateClass([PostConstruct],ManagedVisibilityStrategy.prototype,"postConstruct",1);var _a79,GroupCellRendererCtrl=(_a79=class extends BeanStub{init(comp,eGui,eCheckbox,eExpanded,eContracted,compClass,params){var _a273,_b,_c,_d;this.params=params,this.eGui=eGui,this.eCheckbox=eCheckbox,this.eExpanded=eExpanded,this.eContracted=eContracted,this.comp=comp,this.compClass=compClass;const{node,value,colDef}=params,topLevelFooter=this.isTopLevelFooter();if(!topLevelFooter){if(this.isEmbeddedRowMismatch())return;if(node.footer&&this.gridOptionsService.get("groupHideOpenParents")){const showRowGroup=colDef&&colDef.showRowGroup,rowGroupColumnId=node.rowGroupColumn&&node.rowGroupColumn.getColId();if(showRowGroup!==rowGroupColumnId)return}}if(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),!topLevelFooter){const showingFooterTotal=params.node.footer&&params.node.rowGroupIndex===this.columnModel.getRowGroupColumns().findIndex(c=>{var _a274;return c.getColId()===((_a274=params.colDef)==null?void 0:_a274.showRowGroup)}),showOpenGroupValue=this.gridOptionsService.get("groupDisplayType")!="multipleColumns"||this.gridOptionsService.get("treeData")||this.gridOptionsService.get("showOpenedGroup")&&!params.node.footer&&(!params.node.group||params.node.rowGroupIndex!=null&&params.node.rowGroupIndex>this.columnModel.getRowGroupColumns().findIndex(c=>{var _a274;return c.getColId()===((_a274=params.colDef)==null?void 0:_a274.showRowGroup)})),leafWithValues=!node.group&&(((_a273=this.params.colDef)==null?void 0:_a273.field)||((_b=this.params.colDef)==null?void 0:_b.valueGetter)),isExpandable=this.isExpandable(),showPivotModeLeafValue=this.columnModel.isPivotMode()&&node.leafGroup&&((_c=node.rowGroupColumn)==null?void 0:_c.getColId())===((_d=params.column)==null?void 0:_d.getColDef().showRowGroup);if(!this.showingValueForOpenedParent&&!isExpandable&&!leafWithValues&&!showOpenGroupValue&&!showingFooterTotal&&!showPivotModeLeafValue)return}this.addExpandAndContract(),this.addFullWidthRowDraggerIfNeeded(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded()}getCellAriaRole(){var _a273,_b;const colDefAriaRole=(_a273=this.params.colDef)==null?void 0:_a273.cellAriaRole,columnColDefAriaRole=(_b=this.params.column)==null?void 0:_b.getColDef().cellAriaRole;return colDefAriaRole||columnColDefAriaRole||"gridcell"}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node,eGridCell}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable()){removeAriaExpanded(eGridCell);return}const listener=__name(()=>{setAriaExpanded(eGridCell,!!node.expanded)},"listener");this.expandListener=this.addManagedListener(node,RowNode.EVENT_EXPANDED_CHANGED,listener)||null,listener()}isTopLevelFooter(){if(!this.gridOptionsService.get("groupIncludeTotalFooter")||this.params.value!=null||this.params.node.level!=-1)return!1;const colDef=this.params.colDef;if(colDef==null||colDef.showRowGroup===!0)return!0;const rowGroupCols=this.columnModel.getRowGroupColumns();return!rowGroupCols||rowGroupCols.length===0?!0:rowGroupCols[0].getId()===colDef.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gridOptionsService.get("embedFullWidthRows"))return!1;const pinnedLeftCell=this.params.pinned==="left",pinnedRightCell=this.params.pinned==="right",bodyCell=!pinnedLeftCell&&!pinnedRightCell;return this.gridOptionsService.get("enableRtl")?this.columnModel.isPinningLeft()?!pinnedRightCell:!bodyCell:this.columnModel.isPinningLeft()?!pinnedLeftCell:!bodyCell}findDisplayedGroupNode(){const column=this.params.column,rowNode=this.params.node;if(this.showingValueForOpenedParent){let pointer=rowNode.parent;for(;pointer!=null;){if(pointer.rowGroupColumn&&column.isRowGroupDisplayed(pointer.rowGroupColumn.getId())){this.displayedGroupNode=pointer;break}pointer=pointer.parent}}missing(this.displayedGroupNode)&&(this.displayedGroupNode=rowNode)}setupShowingValueForOpenedParent(){const rowNode=this.params.node,column=this.params.column;if(!this.gridOptionsService.get("groupHideOpenParents")){this.showingValueForOpenedParent=!1;return}if(!rowNode.groupData){this.showingValueForOpenedParent=!1;return}if(rowNode.rowGroupColumn!=null){const keyOfGroupingColumn=rowNode.rowGroupColumn.getId();if(column.isRowGroupDisplayed(keyOfGroupingColumn)){this.showingValueForOpenedParent=!1;return}}const valPresent=rowNode.groupData[column.getId()]!=null;this.showingValueForOpenedParent=valPresent}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){var _a273;const paramsAdjusted=this.adjustParamsWithDetailsFromRelatedColumn(),innerCompDetails=this.getInnerCompDetails(paramsAdjusted),{valueFormatted,value}=paramsAdjusted;let valueWhenNoRenderer=valueFormatted;if(valueWhenNoRenderer==null){const isGroupColForNode=this.displayedGroupNode.rowGroupColumn&&((_a273=this.params.column)==null?void 0:_a273.isRowGroupDisplayed(this.displayedGroupNode.rowGroupColumn.getId()));this.displayedGroupNode.key===""&&this.displayedGroupNode.group&&isGroupColForNode?valueWhenNoRenderer=this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):valueWhenNoRenderer=value??null}this.comp.setInnerRenderer(innerCompDetails,valueWhenNoRenderer)}adjustParamsWithDetailsFromRelatedColumn(){const relatedColumn=this.displayedGroupNode.rowGroupColumn,column=this.params.column;if(!relatedColumn)return this.params;if(column!=null&&!column.isRowGroupDisplayed(relatedColumn.getId()))return this.params;const params=this.params,{value,node}=this.params,valueFormatted=this.valueFormatterService.formatValue(relatedColumn,node,value);return __spreadProps(__spreadValues({},params),{valueFormatted})}addFooterValue(){const footerValueGetter=this.params.footerValueGetter;let footerValue="";if(footerValueGetter){const paramsClone=cloneObject(this.params);paramsClone.value=this.params.value,typeof footerValueGetter=="function"?footerValue=footerValueGetter(paramsClone):typeof footerValueGetter=="string"?footerValue=this.expressionService.evaluate(footerValueGetter,paramsClone):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else footerValue=this.localeService.getLocaleTextFunc()("footerTotal","Total")+" "+(this.params.value!=null?this.params.value:"");const innerCompDetails=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(innerCompDetails,footerValue)}getInnerCompDetails(params){if(params.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),params);const innerCompDetails=this.userComponentFactory.getInnerRendererDetails(params,params),isGroupRowRenderer=__name(details=>details&&details.componentClass==this.compClass,"isGroupRowRenderer");if(innerCompDetails&&!isGroupRowRenderer(innerCompDetails))return innerCompDetails;const relatedColumn=this.displayedGroupNode.rowGroupColumn,relatedColDef=relatedColumn?relatedColumn.getColDef():void 0;if(!relatedColDef)return;const relatedCompDetails=this.userComponentFactory.getCellRendererDetails(relatedColDef,params);if(relatedCompDetails&&!isGroupRowRenderer(relatedCompDetails))return relatedCompDetails;if(isGroupRowRenderer(relatedCompDetails)&&relatedColDef.cellRendererParams&&relatedColDef.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(relatedColDef.cellRendererParams,params)}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const allChildrenCount=this.displayedGroupNode.allChildrenCount,countString=this.isShowRowGroupForThisRow()&&allChildrenCount!=null&&allChildrenCount>=0?`(${allChildrenCount})`:"";this.comp.setChildCount(countString)}isShowRowGroupForThisRow(){if(this.gridOptionsService.get("treeData"))return!0;const rowGroupColumn=this.displayedGroupNode.rowGroupColumn;if(!rowGroupColumn)return!1;const column=this.params.column;return column==null||column.isRowGroupDisplayed(rowGroupColumn.getId())}addExpandAndContract(){var _a273;const params=this.params,eExpandedIcon=createIconNoSpan("groupExpanded",this.gridOptionsService,null),eContractedIcon=createIconNoSpan("groupContracted",this.gridOptionsService,null);eExpandedIcon&&this.eExpanded.appendChild(eExpandedIcon),eContractedIcon&&this.eContracted.appendChild(eContractedIcon);const eGroupCell=params.eGridCell;!(((_a273=this.params.column)==null?void 0:_a273.isCellEditable(params.node))&&this.gridOptionsService.get("enableGroupEdit"))&&this.isExpandable()&&!params.suppressDoubleClickExpand&&this.addManagedListener(eGroupCell,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(eGroupCell,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(params.node,RowNode.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const expandableChangedListener=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED,expandableChangedListener),this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_MASTER_CHANGED,expandableChangedListener),this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_GROUP_CHANGED,expandableChangedListener),this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_HAS_CHILDREN_CHANGED,expandableChangedListener)}onExpandClicked(mouseEvent){isStopPropagationForAgGrid(mouseEvent)||(stopPropagationForAgGrid(mouseEvent),this.onExpandOrContract(mouseEvent))}onExpandOrContract(e){const rowNode=this.displayedGroupNode,nextExpandState=!rowNode.expanded;!nextExpandState&&rowNode.sticky&&this.scrollToStickyNode(rowNode),rowNode.setExpanded(nextExpandState,e)}scrollToStickyNode(rowNode){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(rowNode.rowTop-rowNode.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const rowNode=this.displayedGroupNode,reducedLeafNode=this.columnModel.isPivotMode()&&rowNode.leafGroup;if(!(rowNode.isExpandable()&&!rowNode.footer&&!reducedLeafNode))return!1;const column=this.params.column;return column!=null&&typeof column.getColDef().showRowGroup=="string"?this.isShowRowGroupForThisRow():!0}showExpandAndContractIcons(){const{params,displayedGroupNode:displayedGroup,columnModel}=this,{node}=params,isExpandable=this.isExpandable();if(isExpandable){const expanded=this.showingValueForOpenedParent?!0:node.expanded;this.comp.setExpandedDisplayed(expanded),this.comp.setContractedDisplayed(!expanded)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const pivotMode=columnModel.isPivotMode(),pivotModeAndLeafGroup=pivotMode&&displayedGroup.leafGroup,addExpandableCss=isExpandable&&!pivotModeAndLeafGroup,isTotalFooterNode=node.footer&&node.level===-1;this.comp.addOrRemoveCssClass("ag-cell-expandable",addExpandableCss),this.comp.addOrRemoveCssClass("ag-row-group",addExpandableCss),pivotMode?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",pivotModeAndLeafGroup):isTotalFooterNode||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!addExpandableCss)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const node=this.params.node;this.params.suppressPadding||(this.addManagedListener(node,RowNode.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gridOptionsService.get("groupHideOpenParents"))return;const params=this.params,rowNode=params.node,fullWithRow=!!params.colDef,treeData=this.gridOptionsService.get("treeData"),paddingCount=!fullWithRow||treeData||params.colDef.showRowGroup===!0?rowNode.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+paddingCount,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const rowDragComp=new RowDragComp(()=>this.params.value,this.params.node);this.createManagedBean(rowDragComp,this.context),this.eGui.insertAdjacentElement("afterbegin",rowDragComp.getGui())}isUserWantsSelected(){const paramsCheckbox=this.params.checkbox;return typeof paramsCheckbox=="function"||paramsCheckbox===!0}addCheckboxIfNeeded(){const rowNode=this.displayedGroupNode,checkboxNeeded=this.isUserWantsSelected()&&!rowNode.footer&&!rowNode.rowPinned&&!rowNode.detail;if(checkboxNeeded){const cbSelectionComponent=new CheckboxSelectionComponent;this.getContext().createBean(cbSelectionComponent),cbSelectionComponent.init({rowNode:this.params.node,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(cbSelectionComponent.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(cbSelectionComponent))}this.comp.setCheckboxVisible(checkboxNeeded)}onKeyDown(event){!(event.key===KeyCode.ENTER)||this.params.suppressEnterExpand||this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(event)}onCellDblClicked(mouseEvent){if(isStopPropagationForAgGrid(mouseEvent))return;isElementInEventPath(this.eExpanded,mouseEvent)||isElementInEventPath(this.eContracted,mouseEvent)||this.onExpandOrContract(mouseEvent)}},__name(_a79,"GroupCellRendererCtrl"),_a79);__decorateClass([Autowired("expressionService")],GroupCellRendererCtrl.prototype,"expressionService",2);__decorateClass([Autowired("valueFormatterService")],GroupCellRendererCtrl.prototype,"valueFormatterService",2);__decorateClass([Autowired("columnModel")],GroupCellRendererCtrl.prototype,"columnModel",2);__decorateClass([Autowired("userComponentFactory")],GroupCellRendererCtrl.prototype,"userComponentFactory",2);__decorateClass([Autowired("ctrlsService")],GroupCellRendererCtrl.prototype,"ctrlsService",2);var _a80,_GroupCellRenderer=(_a80=class extends Component{constructor(){super(_a80.TEMPLATE)}init(params){const compProxy={setInnerRenderer:(compDetails,valueToDisplay)=>this.setRenderDetails(compDetails,valueToDisplay),setChildCount:count=>this.eChildCount.textContent=count,addOrRemoveCssClass:(cssClass,value)=>this.addOrRemoveCssClass(cssClass,value),setContractedDisplayed:expanded=>setDisplayed(this.eContracted,expanded),setExpandedDisplayed:expanded=>setDisplayed(this.eExpanded,expanded),setCheckboxVisible:visible=>this.eCheckbox.classList.toggle("ag-invisible",!visible)},ctrl=this.createManagedBean(new GroupCellRendererCtrl),fullWidth=!params.colDef,eGui=this.getGui();ctrl.init(compProxy,eGui,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,params),fullWidth&&setAriaRole(eGui,ctrl.getCellAriaRole())}setRenderDetails(compDetails,valueToDisplay){if(compDetails){const componentPromise=compDetails.newAgStackInstance();if(!componentPromise)return;componentPromise.then(comp=>{if(!comp)return;const destroyComp=__name(()=>this.context.destroyBean(comp),"destroyComp");this.isAlive()?(this.eValue.appendChild(comp.getGui()),this.addDestroyFunc(destroyComp)):destroyComp()})}else this.eValue.innerText=valueToDisplay}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}},__name(_a80,"_GroupCellRenderer"),_a80);_GroupCellRenderer.TEMPLATE=`<span class="ag-cell-wrapper">
            <span class="ag-group-expanded" ref="eExpanded"></span>
            <span class="ag-group-contracted" ref="eContracted"></span>
            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>
            <span class="ag-group-value" ref="eValue"></span>
            <span class="ag-group-child-count" ref="eChildCount"></span>
        </span>`;__decorateClass([RefSelector("eExpanded")],_GroupCellRenderer.prototype,"eExpanded",2);__decorateClass([RefSelector("eContracted")],_GroupCellRenderer.prototype,"eContracted",2);__decorateClass([RefSelector("eCheckbox")],_GroupCellRenderer.prototype,"eCheckbox",2);__decorateClass([RefSelector("eValue")],_GroupCellRenderer.prototype,"eValue",2);__decorateClass([RefSelector("eChildCount")],_GroupCellRenderer.prototype,"eChildCount",2);var GroupCellRenderer=_GroupCellRenderer,_a81,_LoadingCellRenderer=(_a81=class extends Component{constructor(){super(_a81.TEMPLATE)}init(params){params.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const localeTextFunc=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=localeTextFunc("loadingError","ERR")}setupLoading(){const eLoadingIcon=createIconNoSpan("groupLoading",this.gridOptionsService,null);eLoadingIcon&&this.eLoadingIcon.appendChild(eLoadingIcon);const localeTextFunc=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=localeTextFunc("loadingOoo","Loading")}refresh(params){return!1}destroy(){super.destroy()}},__name(_a81,"_LoadingCellRenderer"),_a81);_LoadingCellRenderer.TEMPLATE=`<div class="ag-loading">
            <span class="ag-loading-icon" ref="eLoadingIcon"></span>
            <span class="ag-loading-text" ref="eLoadingText"></span>
        </div>`;__decorateClass([RefSelector("eLoadingIcon")],_LoadingCellRenderer.prototype,"eLoadingIcon",2);__decorateClass([RefSelector("eLoadingText")],_LoadingCellRenderer.prototype,"eLoadingText",2);var LoadingCellRenderer=_LoadingCellRenderer,_a82,_LoadingOverlayComponent=(_a82=class extends Component{constructor(){super()}destroy(){super.destroy()}init(params){const customTemplate=this.gridOptionsService.get("overlayLoadingTemplate");if(this.setTemplate(customTemplate??_a82.DEFAULT_LOADING_OVERLAY_TEMPLATE),!customTemplate){const localeTextFunc=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=localeTextFunc("loadingOoo","Loading...")})}}},__name(_a82,"_LoadingOverlayComponent"),_a82);_LoadingOverlayComponent.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>';var LoadingOverlayComponent=_LoadingOverlayComponent,_a83,_NoRowsOverlayComponent=(_a83=class extends Component{constructor(){super()}destroy(){super.destroy()}init(params){const customTemplate=this.gridOptionsService.get("overlayNoRowsTemplate");if(this.setTemplate(customTemplate??_a83.DEFAULT_NO_ROWS_TEMPLATE),!customTemplate){const localeTextFunc=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=localeTextFunc("noRowsToShow","No Rows To Show")})}}},__name(_a83,"_NoRowsOverlayComponent"),_a83);_NoRowsOverlayComponent.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center"></span>';var NoRowsOverlayComponent=_NoRowsOverlayComponent,_a84,TooltipComponent=(_a84=class extends PopupComponent{constructor(){super('<div class="ag-tooltip"></div>')}init(params){const{value}=params;this.getGui().textContent=escapeString(value,!0)}},__name(_a84,"TooltipComponent"),_a84),_a85,NumberCellEditorInput=(_a85=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(eInput,params){this.eInput=eInput,this.params=params,params.max!=null&&eInput.setMax(params.max),params.min!=null&&eInput.setMin(params.min),params.precision!=null&&eInput.setPrecision(params.precision),params.step!=null&&eInput.setStep(params.step);const inputEl=eInput.getInputElement();params.preventStepping?eInput.addManagedListener(inputEl,"keydown",this.preventStepping):params.showStepperButtons&&inputEl.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===KeyCode.UP||e.key===KeyCode.DOWN)&&e.preventDefault()}getValue(){const value=this.eInput.getValue();if(!exists(value)&&!exists(this.params.value))return this.params.value;let parsedValue=this.params.parseValue(value);if(parsedValue==null)return parsedValue;if(typeof parsedValue=="string"){if(parsedValue==="")return null;parsedValue=Number(parsedValue)}return isNaN(parsedValue)?null:parsedValue}getStartValue(){return this.params.value}},__name(_a85,"NumberCellEditorInput"),_a85),_a86,NumberCellEditor=(_a86=class extends SimpleCellEditor{constructor(){super(new NumberCellEditorInput)}},__name(_a86,"NumberCellEditor"),_a86),_a87,DateCellEditorInput=(_a87=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(eInput,params){this.eInput=eInput,this.params=params,params.min!=null&&eInput.setMin(params.min),params.max!=null&&eInput.setMax(params.max),params.step!=null&&eInput.setStep(params.step)}getValue(){const value=this.eInput.getDate();return!exists(value)&&!exists(this.params.value)?this.params.value:value??null}getStartValue(){const{value}=this.params;if(value instanceof Date)return serialiseDate(value,!1)}},__name(_a87,"DateCellEditorInput"),_a87),_a88,DateCellEditor=(_a88=class extends SimpleCellEditor{constructor(){super(new DateCellEditorInput)}},__name(_a88,"DateCellEditor"),_a88),_a89,DateStringCellEditorInput=(_a89=class{constructor(getDataTypeService){this.getDataTypeService=getDataTypeService}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(eInput,params){this.eInput=eInput,this.params=params,params.min!=null&&eInput.setMin(params.min),params.max!=null&&eInput.setMax(params.max),params.step!=null&&eInput.setStep(params.step)}getValue(){const value=this.formatDate(this.eInput.getDate());return!exists(value)&&!exists(this.params.value)?this.params.value:this.params.parseValue(value??"")}getStartValue(){var _a273,_b;return serialiseDate((_b=this.parseDate((_a273=this.params.value)!=null?_a273:void 0))!=null?_b:null,!1)}parseDate(value){return this.getDataTypeService().getDateParserFunction(this.params.column)(value)}formatDate(value){return this.getDataTypeService().getDateFormatterFunction(this.params.column)(value)}},__name(_a89,"DateStringCellEditorInput"),_a89),_a90,DateStringCellEditor=(_a90=class extends SimpleCellEditor{constructor(){super(new DateStringCellEditorInput(()=>this.dataTypeService))}},__name(_a90,"DateStringCellEditor"),_a90);__decorateClass([Autowired("dataTypeService")],DateStringCellEditor.prototype,"dataTypeService",2);var _a91,_CheckboxCellRenderer=(_a91=class extends Component{constructor(){super(_a91.TEMPLATE)}init(params){this.params=params,this.updateCheckbox(params);const inputEl=this.eCheckbox.getInputElement();inputEl.setAttribute("tabindex","-1"),setAriaLive(inputEl,"polite"),this.addManagedListener(inputEl,"click",event=>{if(stopPropagationForAgGrid(event),this.eCheckbox.isDisabled())return;const isSelected=this.eCheckbox.getValue();this.onCheckboxChanged(isSelected)}),this.addManagedListener(inputEl,"dblclick",event=>{stopPropagationForAgGrid(event)});const eDocument=this.gridOptionsService.getDocument();this.addManagedListener(this.params.eGridCell,"keydown",event=>{if(event.key===KeyCode.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===eDocument.activeElement&&this.eCheckbox.toggle();const isSelected=this.eCheckbox.getValue();this.onCheckboxChanged(isSelected),event.preventDefault()}})}refresh(params){return this.params=params,this.updateCheckbox(params),!0}updateCheckbox(params){var _a273,_b,_c;let isSelected,displayed=!0;if(params.node.group&&params.column){const colId=params.column.getColId();colId.startsWith(GROUP_AUTO_COLUMN_ID)?isSelected=params.value==null||params.value===""?void 0:params.value==="true":params.node.aggData&&params.node.aggData[colId]!==void 0?isSelected=(_a273=params.value)!=null?_a273:void 0:displayed=!1}else isSelected=(_b=params.value)!=null?_b:void 0;if(!displayed){this.eCheckbox.setDisplayed(!1);return}this.eCheckbox.setValue(isSelected);const disabled=params.disabled!=null?params.disabled:!((_c=params.column)!=null&&_c.isCellEditable(params.node));this.eCheckbox.setDisabled(disabled);const translate=this.localeService.getLocaleTextFunc(),stateName=getAriaCheckboxStateName(translate,isSelected),ariaLabel=disabled?stateName:`${translate("ariaToggleCellValue","Press SPACE to toggle cell value")} (${stateName})`;this.eCheckbox.setInputAriaLabel(ariaLabel)}onCheckboxChanged(isSelected){const{column,node,rowIndex,value}=this.params,eventStarted={type:Events.EVENT_CELL_EDITING_STARTED,column,colDef:column==null?void 0:column.getColDef(),data:node.data,node,rowIndex,rowPinned:node.rowPinned,value};this.eventService.dispatchEvent(eventStarted);const valueChanged=this.params.node.setDataValue(this.params.column,isSelected,"edit"),eventStopped={type:Events.EVENT_CELL_EDITING_STOPPED,column,colDef:column==null?void 0:column.getColDef(),data:node.data,node,rowIndex,rowPinned:node.rowPinned,value,oldValue:value,newValue:isSelected,valueChanged};this.eventService.dispatchEvent(eventStopped)}},__name(_a91,"_CheckboxCellRenderer"),_a91);_CheckboxCellRenderer.TEMPLATE=`
        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">
            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
        </div>`;__decorateClass([RefSelector("eCheckbox")],_CheckboxCellRenderer.prototype,"eCheckbox",2);var CheckboxCellRenderer=_CheckboxCellRenderer,_a92,CheckboxCellEditor=(_a92=class extends PopupComponent{constructor(){super(`
            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}init(params){var _a273;this.params=params;const isSelected=(_a273=params.value)!=null?_a273:void 0;this.eCheckbox.setValue(isSelected),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(isSelected),this.addManagedListener(this.eCheckbox,Events.EVENT_FIELD_VALUE_CHANGED,event=>this.setAriaLabel(event.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(isSelected){const translate=this.localeService.getLocaleTextFunc(),stateName=getAriaCheckboxStateName(translate,isSelected),ariaLabel=translate("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${ariaLabel} (${stateName})`)}},__name(_a92,"CheckboxCellEditor"),_a92);__decorateClass([RefSelector("eCheckbox")],CheckboxCellEditor.prototype,"eCheckbox",2);var _a93,AgMenuItemRenderer=(_a93=class extends Component{constructor(){super(),this.setTemplate("<div></div>")}init(params){var _a273;this.params=params,this.cssClassPrefix=(_a273=this.params.cssClassPrefix)!=null?_a273:"ag-menu-option",this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addIcon(){if(this.params.isCompact)return;const icon=loadTemplate(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?icon.appendChild(createIconNoSpan("check",this.gridOptionsService)):this.params.icon&&(isNodeOrElement(this.params.icon)?icon.appendChild(this.params.icon):typeof this.params.icon=="string"?icon.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(icon)}addName(){const name=loadTemplate(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(name)}addShortcut(){if(this.params.isCompact)return;const shortcut=loadTemplate(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(shortcut)}addSubMenu(){const pointer=loadTemplate(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),eGui=this.getGui();if(this.params.subMenu){const iconName=this.gridOptionsService.get("enableRtl")?"smallLeft":"smallRight";setAriaExpanded(eGui,!1),pointer.appendChild(createIconNoSpan(iconName,this.gridOptionsService))}eGui.appendChild(pointer)}getClassName(suffix){return`${this.cssClassPrefix}-${suffix}`}destroy(){super.destroy()}},__name(_a93,"AgMenuItemRenderer"),_a93),_a94,UserComponentRegistry=(_a94=class extends BeanStub{constructor(){super(...arguments),this.agGridDefaults={agDateInput:DefaultDateComponent,agColumnHeader:HeaderComp,agColumnGroupHeader:HeaderGroupComp,agSortIndicator:SortIndicatorComp,agTextColumnFloatingFilter:TextFloatingFilter,agNumberColumnFloatingFilter:NumberFloatingFilter,agDateColumnFloatingFilter:DateFloatingFilter,agReadOnlyFloatingFilter:ReadOnlyFloatingFilter,agAnimateShowChangeCellRenderer:AnimateShowChangeCellRenderer,agAnimateSlideCellRenderer:AnimateSlideCellRenderer,agGroupCellRenderer:GroupCellRenderer,agGroupRowRenderer:GroupCellRenderer,agLoadingCellRenderer:LoadingCellRenderer,agCheckboxCellRenderer:CheckboxCellRenderer,agCellEditor:TextCellEditor,agTextCellEditor:TextCellEditor,agNumberCellEditor:NumberCellEditor,agDateCellEditor:DateCellEditor,agDateStringCellEditor:DateStringCellEditor,agSelectCellEditor:SelectCellEditor,agLargeTextCellEditor:LargeTextCellEditor,agCheckboxCellEditor:CheckboxCellEditor,agTextColumnFilter:TextFilter,agNumberColumnFilter:NumberFilter,agDateColumnFilter:DateFilter,agLoadingOverlay:LoadingOverlayComponent,agNoRowsOverlay:NoRowsOverlayComponent,agTooltipComponent:TooltipComponent,agMenuItem:AgMenuItemRenderer},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}init(){this.gridOptions.components!=null&&iterateObject(this.gridOptions.components,(key,component)=>this.registerJsComponent(key,component))}registerDefaultComponent(name,component){if(this.agGridDefaults[name]){console.error("Trying to overwrite a default component. You should call registerComponent");return}this.agGridDefaults[name]=component}registerJsComponent(name,component){this.jsComps[name]=component}retrieve(propertyName,name){const createResult=__name((component,componentFromFramework)=>({componentFromFramework,component}),"createResult"),registeredViaFrameworkComp=this.getFrameworkOverrides().frameworkComponent(name,this.gridOptions.components);if(registeredViaFrameworkComp!=null)return createResult(registeredViaFrameworkComp,!0);const jsComponent=this.jsComps[name];if(jsComponent){const isFwkComp=this.getFrameworkOverrides().isFrameworkComponent(jsComponent);return createResult(jsComponent,isFwkComp)}const defaultComponent=this.agGridDefaults[name];if(defaultComponent)return createResult(defaultComponent,!1);const moduleForComponent=this.enterpriseAgDefaultCompsModule[name];return moduleForComponent?ModuleRegistry.__assertRegistered(moduleForComponent,`AG Grid '${propertyName}' component: ${name}`,this.context.getGridId()):doOnce(()=>{this.warnAboutMissingComponent(propertyName,name)},"MissingComp"+name),null}warnAboutMissingComponent(propertyName,componentName){const validComponents=[...Object.keys(this.agGridDefaults).filter(k=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(k)),...Object.keys(this.jsComps)],suggestions=fuzzySuggestions(componentName,validComponents,!0,.8).values;console.warn(`AG Grid: Could not find '${componentName}' component. It was configured as "${propertyName}: '${componentName}'" but it wasn't found in the list of registered components.`),suggestions.length>0&&console.warn(`         Did you mean: [${suggestions.slice(0,3)}]?`),console.warn(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}},__name(_a94,"UserComponentRegistry"),_a94);__decorateClass([Autowired("gridOptions")],UserComponentRegistry.prototype,"gridOptions",2);__decorateClass([PostConstruct],UserComponentRegistry.prototype,"init",1);UserComponentRegistry=__decorateClass([Bean("userComponentRegistry")],UserComponentRegistry);var DateComponent={propertyName:"dateComponent",cellRenderer:!1},HeaderComponent={propertyName:"headerComponent",cellRenderer:!1},HeaderGroupComponent={propertyName:"headerGroupComponent",cellRenderer:!1},CellRendererComponent={propertyName:"cellRenderer",cellRenderer:!0},CellEditorComponent={propertyName:"cellEditor",cellRenderer:!1},InnerRendererComponent={propertyName:"innerRenderer",cellRenderer:!0},LoadingOverlayComponent2={propertyName:"loadingOverlayComponent",cellRenderer:!1},NoRowsOverlayComponent2={propertyName:"noRowsOverlayComponent",cellRenderer:!1},TooltipComponent2={propertyName:"tooltipComponent",cellRenderer:!1},FilterComponent={propertyName:"filter",cellRenderer:!1},FloatingFilterComponent={propertyName:"floatingFilterComponent",cellRenderer:!1},ToolPanelComponent={propertyName:"toolPanel",cellRenderer:!1},StatusPanelComponent={propertyName:"statusPanel",cellRenderer:!1},FullWidth={propertyName:"fullWidthCellRenderer",cellRenderer:!0},FullWidthLoading={propertyName:"loadingCellRenderer",cellRenderer:!0},FullWidthGroup={propertyName:"groupRowRenderer",cellRenderer:!0},FullWidthDetail={propertyName:"detailCellRenderer",cellRenderer:!0},MenuItemComponent={propertyName:"menuItem",cellRenderer:!1},_a95,FloatingFilterMapper=(_a95=class{static getFloatingFilterType(filterType){return this.filterToFloatingFilterMapping[filterType]}},__name(_a95,"FloatingFilterMapper"),_a95);FloatingFilterMapper.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var _a96,UserComponentFactory=(_a96=class extends BeanStub{getHeaderCompDetails(colDef,params){return this.getCompDetails(colDef,HeaderComponent,"agColumnHeader",params)}getHeaderGroupCompDetails(params){const colGroupDef=params.columnGroup.getColGroupDef();return this.getCompDetails(colGroupDef,HeaderGroupComponent,"agColumnGroupHeader",params)}getFullWidthCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidth,null,params,!0)}getFullWidthLoadingCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidthLoading,"agLoadingCellRenderer",params,!0)}getFullWidthGroupCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidthGroup,"agGroupRowRenderer",params,!0)}getFullWidthDetailCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidthDetail,"agDetailCellRenderer",params,!0)}getInnerRendererDetails(def,params){return this.getCompDetails(def,InnerRendererComponent,null,params)}getFullWidthGroupRowInnerCellRenderer(def,params){return this.getCompDetails(def,InnerRendererComponent,null,params)}getCellRendererDetails(def,params){return this.getCompDetails(def,CellRendererComponent,null,params)}getCellEditorDetails(def,params){return this.getCompDetails(def,CellEditorComponent,"agCellEditor",params,!0)}getFilterDetails(def,params,defaultFilter){return this.getCompDetails(def,FilterComponent,defaultFilter,params,!0)}getDateCompDetails(params){return this.getCompDetails(this.gridOptions,DateComponent,"agDateInput",params,!0)}getLoadingOverlayCompDetails(params){return this.getCompDetails(this.gridOptions,LoadingOverlayComponent2,"agLoadingOverlay",params,!0)}getNoRowsOverlayCompDetails(params){return this.getCompDetails(this.gridOptions,NoRowsOverlayComponent2,"agNoRowsOverlay",params,!0)}getTooltipCompDetails(params){return this.getCompDetails(params.colDef,TooltipComponent2,"agTooltipComponent",params,!0)}getSetFilterCellRendererDetails(def,params){return this.getCompDetails(def,CellRendererComponent,null,params)}getFloatingFilterCompDetails(def,params,defaultFloatingFilter){return this.getCompDetails(def,FloatingFilterComponent,defaultFloatingFilter,params)}getToolPanelCompDetails(toolPanelDef,params){return this.getCompDetails(toolPanelDef,ToolPanelComponent,null,params,!0)}getStatusPanelCompDetails(def,params){return this.getCompDetails(def,StatusPanelComponent,null,params,!0)}getMenuItemCompDetails(def,params){return this.getCompDetails(def,MenuItemComponent,"agMenuItem",params,!0)}getCompDetails(defObject,type,defaultName,params,mandatory=!1){const{propertyName,cellRenderer}=type;let{compName,jsComp,fwComp,paramsFromSelector,popupFromSelector,popupPositionFromSelector}=this.getCompKeys(defObject,type,params);const lookupFromRegistry=__name(key=>{const item=this.userComponentRegistry.retrieve(propertyName,key);item&&(jsComp=item.componentFromFramework?void 0:item.component,fwComp=item.componentFromFramework?item.component:void 0)},"lookupFromRegistry");if(compName!=null&&lookupFromRegistry(compName),jsComp==null&&fwComp==null&&defaultName!=null&&lookupFromRegistry(defaultName),jsComp&&cellRenderer&&!this.agComponentUtils.doesImplementIComponent(jsComp)&&(jsComp=this.agComponentUtils.adaptFunction(propertyName,jsComp)),!jsComp&&!fwComp){mandatory&&console.error(`AG Grid: Could not find component ${compName}, did you forget to configure this component?`);return}const paramsMerged=this.mergeParamsWithApplicationProvidedParams(defObject,type,params,paramsFromSelector),componentFromFramework=jsComp==null,componentClass=jsComp||fwComp;return{componentFromFramework,componentClass,params:paramsMerged,type,popupFromSelector,popupPositionFromSelector,newAgStackInstance:()=>this.newAgStackInstance(componentClass,componentFromFramework,paramsMerged,type)}}getCompKeys(defObject,type,params){const{propertyName}=type;let compName,jsComp,fwComp,paramsFromSelector,popupFromSelector,popupPositionFromSelector;if(defObject){const defObjectAny=defObject,selectorFunc=defObjectAny[propertyName+"Selector"],selectorRes=selectorFunc?selectorFunc(params):null,assignComp=__name(providedJsComp=>{typeof providedJsComp=="string"?compName=providedJsComp:providedJsComp!=null&&providedJsComp!==!0&&(this.getFrameworkOverrides().isFrameworkComponent(providedJsComp)?fwComp=providedJsComp:jsComp=providedJsComp)},"assignComp");selectorRes?(assignComp(selectorRes.component),paramsFromSelector=selectorRes.params,popupFromSelector=selectorRes.popup,popupPositionFromSelector=selectorRes.popupPosition):assignComp(defObjectAny[propertyName])}return{compName,jsComp,fwComp,paramsFromSelector,popupFromSelector,popupPositionFromSelector}}newAgStackInstance(ComponentClass,componentFromFramework,params,type){const propertyName=type.propertyName,jsComponent=!componentFromFramework;let instance;if(jsComponent)instance=new ComponentClass;else{const thisComponentConfig=this.componentMetadataProvider.retrieve(propertyName);instance=this.frameworkComponentWrapper.wrap(ComponentClass,thisComponentConfig.mandatoryMethodList,thisComponentConfig.optionalMethodList,type)}const deferredInit=this.initComponent(instance,params);return deferredInit==null?AgPromise.resolve(instance):deferredInit.then(()=>instance)}mergeParamsWithApplicationProvidedParams(defObject,type,paramsFromGrid,paramsFromSelector=null){const params=this.gridOptionsService.getGridCommonParams();mergeDeep(params,paramsFromGrid);const defObjectAny=defObject,userParams=defObjectAny&&defObjectAny[type.propertyName+"Params"];if(typeof userParams=="function"){const userParamsFromFunc=userParams(paramsFromGrid);mergeDeep(params,userParamsFromFunc)}else typeof userParams=="object"&&mergeDeep(params,userParams);return mergeDeep(params,paramsFromSelector),params}initComponent(component,params){if(this.context.createBean(component),component.init!=null)return component.init(params)}getDefaultFloatingFilterType(def,getFromDefault){if(def==null)return null;let defaultFloatingFilterType=null,{compName,jsComp,fwComp}=this.getCompKeys(def,FilterComponent);return compName?defaultFloatingFilterType=FloatingFilterMapper.getFloatingFilterType(compName):jsComp==null&&fwComp==null&&def.filter===!0&&(defaultFloatingFilterType=getFromDefault()),defaultFloatingFilterType}},__name(_a96,"UserComponentFactory"),_a96);__decorateClass([Autowired("gridOptions")],UserComponentFactory.prototype,"gridOptions",2);__decorateClass([Autowired("agComponentUtils")],UserComponentFactory.prototype,"agComponentUtils",2);__decorateClass([Autowired("componentMetadataProvider")],UserComponentFactory.prototype,"componentMetadataProvider",2);__decorateClass([Autowired("userComponentRegistry")],UserComponentFactory.prototype,"userComponentRegistry",2);__decorateClass([Optional("frameworkComponentWrapper")],UserComponentFactory.prototype,"frameworkComponentWrapper",2);UserComponentFactory=__decorateClass([Bean("userComponentFactory")],UserComponentFactory);var _a97,_ColDefUtil=(_a97=class{},__name(_a97,"_ColDefUtil"),_a97);_ColDefUtil.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0};_ColDefUtil.ALL_PROPERTIES=Object.keys(_ColDefUtil.ColDefPropertyMap);var ColDefUtil=_ColDefUtil,_a98,AutoScrollService=(_a98=class{constructor(params){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=params.scrollContainer,this.scrollHorizontally=params.scrollAxis.indexOf("x")!==-1,this.scrollVertically=params.scrollAxis.indexOf("y")!==-1,this.scrollByTick=params.scrollByTick!=null?params.scrollByTick:20,params.onScrollCallback&&(this.onScrollCallback=params.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=params.getVerticalPosition,this.setVerticalPosition=params.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=params.getHorizontalPosition,this.setHorizontalPosition=params.setHorizontalPosition),this.shouldSkipVerticalScroll=params.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=params.shouldSkipHorizontalScroll||(()=>!1)}check(mouseEvent,forceSkipVerticalScroll=!1){const skipVerticalScroll=forceSkipVerticalScroll||this.shouldSkipVerticalScroll();if(skipVerticalScroll&&this.shouldSkipHorizontalScroll())return;const rect=this.scrollContainer.getBoundingClientRect(),scrollTick=this.scrollByTick;this.tickLeft=mouseEvent.clientX<rect.left+scrollTick,this.tickRight=mouseEvent.clientX>rect.right-scrollTick,this.tickUp=mouseEvent.clientY<rect.top+scrollTick&&!skipVerticalScroll,this.tickDown=mouseEvent.clientY>rect.bottom-scrollTick&&!skipVerticalScroll,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let tickAmount;if(tickAmount=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const vScrollPosition=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(vScrollPosition-tickAmount),this.tickDown&&this.setVerticalPosition(vScrollPosition+tickAmount)}if(this.scrollHorizontally){const hScrollPosition=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(hScrollPosition-tickAmount),this.tickRight&&this.setHorizontalPosition(hScrollPosition+tickAmount)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},__name(_a98,"AutoScrollService"),_a98),_a99,RowDragFeature=(_a99=class extends BeanStub{constructor(eContainer){super(),this.isMultiRowDrag=!1,this.eContainer=eContainer}postConstruct(){this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(()=>{const gridBodyCon=this.ctrlsService.getGridBodyCtrl();this.autoScrollService=new AutoScrollService({scrollContainer:gridBodyCon.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>gridBodyCon.getScrollFeature().getVScrollPosition().top,setVerticalPosition:position=>gridBodyCon.getScrollFeature().setVerticalScrollPosition(position),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(type){return type===2}getIconName(){return this.gridOptionsService.get("rowDragManaged")&&this.shouldPreventRowMove()?DragAndDropService.ICON_NOT_ALLOWED:DragAndDropService.ICON_MOVE}shouldPreventRowMove(){return!!(this.columnModel.getRowGroupColumns().length||this.filterManager.isAnyFilterPresent()||this.sortController.isSortActive())}getRowNodes(draggingEvent){if(!this.isFromThisGrid(draggingEvent))return draggingEvent.dragItem.rowNodes||[];const isRowDragMultiRow=this.gridOptionsService.get("rowDragMultiRow"),selectedNodes=[...this.selectionService.getSelectedNodes()].sort((a,b)=>a.rowIndex==null||b.rowIndex==null?0:this.getRowIndexNumber(a)-this.getRowIndexNumber(b)),currentNode=draggingEvent.dragItem.rowNode;return isRowDragMultiRow&&selectedNodes.indexOf(currentNode)!==-1?(this.isMultiRowDrag=!0,selectedNodes):(this.isMultiRowDrag=!1,[currentNode])}onDragEnter(draggingEvent){draggingEvent.dragItem.rowNodes=this.getRowNodes(draggingEvent),this.dispatchGridEvent(Events.EVENT_ROW_DRAG_ENTER,draggingEvent),this.getRowNodes(draggingEvent).forEach(rowNode=>{rowNode.setDragging(!0)}),this.onEnterOrDragging(draggingEvent)}onDragging(draggingEvent){this.onEnterOrDragging(draggingEvent)}isFromThisGrid(draggingEvent){const{dragSourceDomDataKey}=draggingEvent.dragSource;return dragSourceDomDataKey===this.gridOptionsService.getDomDataKey()}isDropZoneWithinThisGrid(draggingEvent){const gridGui=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget}=draggingEvent;return!gridGui.contains(dropZoneTarget)}onEnterOrDragging(draggingEvent){this.dispatchGridEvent(Events.EVENT_ROW_DRAG_MOVE,draggingEvent),this.lastDraggingEvent=draggingEvent;const pixel=this.mouseEventService.getNormalisedPosition(draggingEvent).y;this.gridOptionsService.get("rowDragManaged")&&this.doManagedDrag(draggingEvent,pixel),this.autoScrollService.check(draggingEvent.event)}doManagedDrag(draggingEvent,pixel){const isFromThisGrid=this.isFromThisGrid(draggingEvent),managedDrag=this.gridOptionsService.get("rowDragManaged"),rowNodes=draggingEvent.dragItem.rowNodes;managedDrag&&this.shouldPreventRowMove()||(this.gridOptionsService.get("suppressMoveWhenRowDragging")||!isFromThisGrid?this.isDropZoneWithinThisGrid(draggingEvent)||this.clientSideRowModel.highlightRowAtPixel(rowNodes[0],pixel):this.moveRows(rowNodes,pixel))}getRowIndexNumber(rowNode){return parseInt(last(rowNode.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(draggingEvent){const lastHighlightedRowNode=this.clientSideRowModel.getLastHighlightedRowNode(),isBelow=lastHighlightedRowNode&&lastHighlightedRowNode.highlighted===1,pixel=this.mouseEventService.getNormalisedPosition(draggingEvent).y,rowNodes=draggingEvent.dragItem.rowNodes;let increment=isBelow?1:0;if(this.isFromThisGrid(draggingEvent))rowNodes.forEach(rowNode=>{rowNode.rowTop<pixel&&(increment-=1)}),this.moveRows(rowNodes,pixel,increment);else{const getRowIdFunc=this.gridOptionsService.getCallback("getRowId");let addIndex=this.clientSideRowModel.getRowIndexAtPixel(pixel)+1;this.clientSideRowModel.getHighlightPosition(pixel)===0&&addIndex--,this.clientSideRowModel.updateRowData({add:rowNodes.map(node=>node.data).filter(data=>!this.clientSideRowModel.getRowNode(getRowIdFunc?getRowIdFunc({data,level:0}):data.id)),addIndex})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(rowNodes,pixel,increment=0){this.clientSideRowModel.ensureRowsAtPixel(rowNodes,pixel,increment)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())}addRowDropZone(params){if(!params.getContainer()){warnOnce("addRowDropZone - A container target needs to be provided");return}if(this.dragAndDropService.findExternalZone(params)){console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");return}let processedParams={getContainer:params.getContainer};params.fromGrid?processedParams=params:(params.onDragEnter&&(processedParams.onDragEnter=e=>{params.onDragEnter(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER,e))}),params.onDragLeave&&(processedParams.onDragLeave=e=>{params.onDragLeave(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE,e))}),params.onDragging&&(processedParams.onDragging=e=>{params.onDragging(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE,e))}),params.onDragStop&&(processedParams.onDragStop=e=>{params.onDragStop(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END,e))})),this.dragAndDropService.addDropTarget(__spreadValues({isInterestedIn:type=>type===2,getIconName:()=>DragAndDropService.ICON_MOVE,external:!0},processedParams))}getRowDropZone(events){const getContainer=this.getContainer.bind(this),onDragEnter=this.onDragEnter.bind(this),onDragLeave=this.onDragLeave.bind(this),onDragging=this.onDragging.bind(this),onDragStop=this.onDragStop.bind(this);return events?{getContainer,onDragEnter:events.onDragEnter?e=>{onDragEnter(e),events.onDragEnter(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER,e))}:onDragEnter,onDragLeave:events.onDragLeave?e=>{onDragLeave(e),events.onDragLeave(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE,e))}:onDragLeave,onDragging:events.onDragging?e=>{onDragging(e),events.onDragging(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE,e))}:onDragging,onDragStop:events.onDragStop?e=>{onDragStop(e),events.onDragStop(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END,e))}:onDragStop,fromGrid:!0}:{getContainer,onDragEnter,onDragLeave,onDragging,onDragStop,fromGrid:!0}}draggingToRowDragEvent(type,draggingEvent){const yNormalised=this.mouseEventService.getNormalisedPosition(draggingEvent).y,mouseIsPastLastRow=yNormalised>this.paginationProxy.getCurrentPageHeight();let overIndex=-1,overNode;mouseIsPastLastRow||(overIndex=this.rowModel.getRowIndexAtPixel(yNormalised),overNode=this.rowModel.getRow(overIndex));let vDirectionString;switch(draggingEvent.vDirection){case 1:vDirectionString="down";break;case 0:vDirectionString="up";break;default:vDirectionString=null;break}return this.gridOptionsService.addGridCommonParams({type,event:draggingEvent.event,node:draggingEvent.dragItem.rowNode,nodes:draggingEvent.dragItem.rowNodes,overIndex,overNode,y:yNormalised,vDirection:vDirectionString})}dispatchGridEvent(type,draggingEvent){const event=this.draggingToRowDragEvent(type,draggingEvent);this.eventService.dispatchEvent(event)}onDragLeave(draggingEvent){this.dispatchGridEvent(Events.EVENT_ROW_DRAG_LEAVE,draggingEvent),this.stopDragging(draggingEvent),this.gridOptionsService.get("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(draggingEvent)&&(this.isMultiRowDrag=!1)}onDragStop(draggingEvent){this.dispatchGridEvent(Events.EVENT_ROW_DRAG_END,draggingEvent),this.stopDragging(draggingEvent),this.gridOptionsService.get("rowDragManaged")&&(this.gridOptionsService.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(draggingEvent))&&!this.isDropZoneWithinThisGrid(draggingEvent)&&this.moveRowAndClearHighlight(draggingEvent)}stopDragging(draggingEvent){this.autoScrollService.ensureCleared(),this.getRowNodes(draggingEvent).forEach(rowNode=>{rowNode.setDragging(!1)})}},__name(_a99,"RowDragFeature"),_a99);__decorateClass([Autowired("dragAndDropService")],RowDragFeature.prototype,"dragAndDropService",2);__decorateClass([Autowired("rowModel")],RowDragFeature.prototype,"rowModel",2);__decorateClass([Autowired("paginationProxy")],RowDragFeature.prototype,"paginationProxy",2);__decorateClass([Autowired("columnModel")],RowDragFeature.prototype,"columnModel",2);__decorateClass([Autowired("focusService")],RowDragFeature.prototype,"focusService",2);__decorateClass([Autowired("sortController")],RowDragFeature.prototype,"sortController",2);__decorateClass([Autowired("filterManager")],RowDragFeature.prototype,"filterManager",2);__decorateClass([Autowired("selectionService")],RowDragFeature.prototype,"selectionService",2);__decorateClass([Autowired("mouseEventService")],RowDragFeature.prototype,"mouseEventService",2);__decorateClass([Autowired("ctrlsService")],RowDragFeature.prototype,"ctrlsService",2);__decorateClass([Optional("rangeService")],RowDragFeature.prototype,"rangeService",2);__decorateClass([PostConstruct],RowDragFeature.prototype,"postConstruct",1);var _a100,DragService=(_a100=class extends BeanStub{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(dragSourceAndListener){const element=dragSourceAndListener.dragSource.eElement,mouseDownListener=dragSourceAndListener.mouseDownListener;if(element.removeEventListener("mousedown",mouseDownListener),dragSourceAndListener.touchEnabled){const touchStartListener=dragSourceAndListener.touchStartListener;element.removeEventListener("touchstart",touchStartListener,{passive:!0})}}removeDragSource(params){const dragSourceAndListener=this.dragSources.find(item=>item.dragSource===params);dragSourceAndListener&&(this.removeListener(dragSourceAndListener),removeFromArray(this.dragSources,dragSourceAndListener))}isDragging(){return this.dragging}addDragSource(params){const mouseListener=this.onMouseDown.bind(this,params),{eElement,includeTouch,stopPropagationForTouch}=params;eElement.addEventListener("mousedown",mouseListener);let touchListener=null;const suppressTouch=this.gridOptionsService.get("suppressTouch");includeTouch&&!suppressTouch&&(touchListener=__name(touchEvent=>{isFocusableFormField(touchEvent.target)||(touchEvent.cancelable&&(touchEvent.preventDefault(),stopPropagationForTouch&&touchEvent.stopPropagation()),this.onTouchStart(params,touchEvent))},"touchListener"),eElement.addEventListener("touchstart",touchListener,{passive:!1})),this.dragSources.push({dragSource:params,mouseDownListener:mouseListener,touchStartListener:touchListener,touchEnabled:!!includeTouch})}getStartTarget(){return this.startTarget}onTouchStart(params,touchEvent){this.currentDragParams=params,this.dragging=!1;const touch=touchEvent.touches[0];this.touchLastTime=touch,this.touchStart=touch;const touchMoveEvent=__name(e=>this.onTouchMove(e,params.eElement),"touchMoveEvent"),touchEndEvent=__name(e=>this.onTouchUp(e,params.eElement),"touchEndEvent"),documentTouchMove=__name(e=>{e.cancelable&&e.preventDefault()},"documentTouchMove"),target=touchEvent.target,events=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:documentTouchMove,options:{passive:!1}},{target,type:"touchmove",listener:touchMoveEvent,options:{passive:!0}},{target,type:"touchend",listener:touchEndEvent,options:{passive:!0}},{target,type:"touchcancel",listener:touchEndEvent,options:{passive:!0}}];this.addTemporaryEvents(events),params.dragStartPixels===0&&this.onCommonMove(touch,this.touchStart,params.eElement)}onMouseDown(params,mouseEvent){const e=mouseEvent;if(params.skipMouseEvent&&params.skipMouseEvent(mouseEvent)||e._alreadyProcessedByDragService||(e._alreadyProcessedByDragService=!0,mouseEvent.button!==0))return;this.shouldPreventMouseEvent(mouseEvent)&&mouseEvent.preventDefault(),this.currentDragParams=params,this.dragging=!1,this.mouseStartEvent=mouseEvent,this.startTarget=mouseEvent.target;const mouseMoveEvent=__name(event=>this.onMouseMove(event,params.eElement),"mouseMoveEvent"),mouseUpEvent=__name(event=>this.onMouseUp(event,params.eElement),"mouseUpEvent"),contextEvent=__name(event=>event.preventDefault(),"contextEvent"),target=this.gridOptionsService.getRootNode(),events=[{target,type:"mousemove",listener:mouseMoveEvent},{target,type:"mouseup",listener:mouseUpEvent},{target,type:"contextmenu",listener:contextEvent}];this.addTemporaryEvents(events),params.dragStartPixels===0&&this.onMouseMove(mouseEvent,params.eElement)}addTemporaryEvents(events){events.forEach(currentEvent=>{const{target,type,listener,options}=currentEvent;target.addEventListener(type,listener,options)}),this.dragEndFunctions.push(()=>{events.forEach(currentEvent=>{const{target,type,listener,options}=currentEvent;target.removeEventListener(type,listener,options)})})}isEventNearStartEvent(currentEvent,startEvent){const{dragStartPixels}=this.currentDragParams,requiredPixelDiff=exists(dragStartPixels)?dragStartPixels:4;return areEventsNear(currentEvent,startEvent,requiredPixelDiff)}getFirstActiveTouch(touchList){for(let i=0;i<touchList.length;i++)if(touchList[i].identifier===this.touchStart.identifier)return touchList[i];return null}onCommonMove(currentEvent,startEvent,el){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(currentEvent,startEvent))return;this.dragging=!0;const event={type:Events.EVENT_DRAG_STARTED,target:el};this.eventService.dispatchEvent(event),this.currentDragParams.onDragStart(startEvent),this.currentDragParams.onDragging(startEvent)}this.currentDragParams.onDragging(currentEvent)}onTouchMove(touchEvent,el){const touch=this.getFirstActiveTouch(touchEvent.touches);touch&&this.onCommonMove(touch,this.touchStart,el)}onMouseMove(mouseEvent,el){var _a273;isBrowserSafari()&&((_a273=this.gridOptionsService.getDocument().getSelection())==null||_a273.removeAllRanges()),this.shouldPreventMouseEvent(mouseEvent)&&mouseEvent.preventDefault(),this.onCommonMove(mouseEvent,this.mouseStartEvent,el)}shouldPreventMouseEvent(mouseEvent){const isEnableCellTextSelect=this.gridOptionsService.get("enableCellTextSelection"),isMouseMove=mouseEvent.type==="mousemove";return isEnableCellTextSelect&&isMouseMove&&mouseEvent.cancelable&&this.mouseEventService.isEventFromThisGrid(mouseEvent)&&!this.isOverFormFieldElement(mouseEvent)}isOverFormFieldElement(mouseEvent){const el=mouseEvent.target,tagName=el==null?void 0:el.tagName.toLocaleLowerCase();return!!(tagName!=null&&tagName.match("^a$|textarea|input|select|button"))}onTouchUp(touchEvent,el){let touch=this.getFirstActiveTouch(touchEvent.changedTouches);touch||(touch=this.touchLastTime),this.onUpCommon(touch,el)}onMouseUp(mouseEvent,el){this.onUpCommon(mouseEvent,el)}onUpCommon(eventOrTouch,el){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(eventOrTouch);const event={type:Events.EVENT_DRAG_STOPPED,target:el};this.eventService.dispatchEvent(event)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(func=>func()),this.dragEndFunctions.length=0}},__name(_a100,"DragService"),_a100);__decorateClass([Autowired("mouseEventService")],DragService.prototype,"mouseEventService",2);__decorateClass([PreDestroy],DragService.prototype,"removeAllListeners",1);DragService=__decorateClass([Bean("dragService")],DragService);var LIST_ITEM_HOVERED="ag-list-item-hovered",_a101,VirtualListDragFeature=(_a101=class extends BeanStub{constructor(comp,virtualList,params){super(),this.comp=comp,this.virtualList=virtualList,this.params=params,this.currentDragValue=null,this.lastHoveredListItem=null}postConstruct(){this.addManagedListener(this.params.eventSource,this.params.listItemDragStartEvent,this.listItemDragStart.bind(this)),this.addManagedListener(this.params.eventSource,this.params.listItemDragEndEvent,this.listItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(event){this.currentDragValue=this.params.getCurrentDragValue(event),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){const dropTarget={isInterestedIn:type=>type===this.params.dragSourceType,getIconName:()=>this.moveBlocked?DragAndDropService.ICON_PINNED:DragAndDropService.ICON_MOVE,getContainer:()=>this.comp.getGui(),onDragging:e=>this.onDragging(e),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(dropTarget)}createAutoScrollService(){const virtualListGui=this.virtualList.getGui();this.autoScrollService=new AutoScrollService({scrollContainer:virtualListGui,scrollAxis:"y",getVerticalPosition:()=>virtualListGui.scrollTop,setVerticalPosition:position=>virtualListGui.scrollTop=position})}onDragging(e){if(!this.currentDragValue||this.moveBlocked)return;const hoveredListItem=this.getListDragItem(e),comp=this.virtualList.getComponentAt(hoveredListItem.rowIndex);if(!comp)return;const el=comp.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===hoveredListItem.rowIndex&&this.lastHoveredListItem.position===hoveredListItem.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredListItem=hoveredListItem,radioCssClass(el,LIST_ITEM_HOVERED),radioCssClass(el,`ag-item-highlight-${hoveredListItem.position}`))}getListDragItem(e){const virtualListGui=this.virtualList.getGui(),paddingTop=parseFloat(window.getComputedStyle(virtualListGui).paddingTop),rowHeight=this.virtualList.getRowHeight(),scrollTop=this.virtualList.getScrollTop(),rowIndex=Math.max(0,(e.y-paddingTop+scrollTop)/rowHeight),maxLen=this.params.getNumRows(this.comp)-1,normalizedRowIndex=Math.min(maxLen,rowIndex)|0;return{rowIndex:normalizedRowIndex,position:Math.round(rowIndex)>rowIndex||rowIndex>maxLen?"bottom":"top",component:this.virtualList.getComponentAt(normalizedRowIndex)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearHoveredItems(),this.autoScrollService.ensureCleared())}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${LIST_ITEM_HOVERED}`).forEach(el=>{[LIST_ITEM_HOVERED,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(cls=>{el.classList.remove(cls)})}),this.lastHoveredListItem=null}},__name(_a101,"VirtualListDragFeature"),_a101);__decorateClass([Autowired("dragAndDropService")],VirtualListDragFeature.prototype,"dragAndDropService",2);__decorateClass([PostConstruct],VirtualListDragFeature.prototype,"postConstruct",1);function unwrapUserComp(comp){const compAsAny=comp;return compAsAny!=null&&compAsAny.getFrameworkComponentInstance!=null?compAsAny.getFrameworkComponentInstance():comp}__name(unwrapUserComp,"unwrapUserComp");var _a102,GridApi=(_a102=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel;break}this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl()})}__getAlignedGridService(){return this.alignedGridsService}__getContext(){return this.context}__getModel(){return this.rowModel}getGridId(){return this.context.getGridId()}addDetailGridInfo(id,gridInfo){this.detailGridInfoMap[id]=gridInfo}removeDetailGridInfo(id){this.detailGridInfoMap[id]=void 0}getDetailGridInfo(id){return this.detailGridInfoMap[id]}forEachDetailGridInfo(callback){let index=0;iterateObject(this.detailGridInfoMap,(id,gridInfo)=>{exists(gridInfo)&&(callback(gridInfo,index),index++)})}getDataAsCsv(params){if(ModuleRegistry.__assertRegistered("@ag-grid-community/csv-export","api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(params)}exportDataAsCsv(params){ModuleRegistry.__assertRegistered("@ag-grid-community/csv-export","api.exportDataAsCSv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(params)}assertNotExcelMultiSheet(method,params){return ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api."+method,this.context.getGridId())?this.excelCreator.getFactoryMode()===1?(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1):!0:!1}getDataAsExcel(params){if(this.assertNotExcelMultiSheet("getDataAsExcel",params))return this.excelCreator.getDataAsExcel(params)}exportDataAsExcel(params){this.assertNotExcelMultiSheet("exportDataAsExcel",params)&&this.excelCreator.exportDataAsExcel(params)}getSheetDataForExcel(params){if(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api.getSheetDataForExcel",this.context.getGridId()))return this.excelCreator.setFactoryMode(1),this.excelCreator.getSheetDataForExcel(params)}getMultipleSheetsAsExcel(params){if(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(params)}exportMultipleSheetsAsExcel(params){ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api.exportMultipleSheetsAsExcel",this.context.getGridId())&&this.excelCreator.exportMultipleSheetsAsExcel(params)}setGridAriaProperty(property,value){if(!property)return;const eGrid=this.ctrlsService.getGridBodyCtrl().getGui(),ariaProperty=`aria-${property}`;value===null?eGrid.removeAttribute(ariaProperty):eGrid.setAttribute(ariaProperty,value)}logMissingRowModel(apiMethod,...requiredRowModels){console.error(`AG Grid: api.${apiMethod} can only be called when gridOptions.rowModelType is ${requiredRowModels.join(" or ")}`)}logDeprecation(version,apiMethod,replacement,message){warnOnce(`Since ${version} api.${apiMethod} is deprecated. Please use ${replacement} instead. ${message}`)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(index){return this.pinnedRowModel.getPinnedTopRow(index)}getPinnedBottomRow(index){return this.pinnedRowModel.getPinnedBottomRow(index)}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}refreshCells(params={}){this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.refreshCells(params))}flashCells(params={}){const warning=__name(prop=>warnOnce(`Since v31.1 api.flashCells parameter '${prop}Delay' is deprecated. Please use '${prop}Duration' instead.`),"warning");exists(params.fadeDelay)&&warning("fade"),exists(params.flashDelay)&&warning("flash"),this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.flashCells(params))}redrawRows(params={}){const rowNodes=params?params.rowNodes:void 0;this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.redrawRows(rowNodes))}refreshHeader(){this.frameworkOverrides.wrapIncoming(()=>this.ctrlsService.getHeaderRowContainerCtrls().forEach(c=>c.refresh()))}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return warnOnce("Since v31.1 getModel() is deprecated. Please use the appropriate grid API methods instead."),this.rowModel}setRowNodeExpanded(rowNode,expanded,expandParents){this.expansionService.setRowNodeExpanded(rowNode,expanded,expandParents)}onGroupExpandedOrCollapsed(){if(missing(this.clientSideRowModel)){this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide");return}this.expansionService.onGroupExpandedOrCollapsed()}refreshClientSideRowModel(step){if(missing(this.clientSideRowModel)){this.logMissingRowModel("refreshClientSideRowModel","clientSide");return}this.clientSideRowModel.refreshModel(step)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(id){return this.rowModel.getRowNode(id)}getSizesForCurrentTheme(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!1):this.logMissingRowModel("collapseAll","clientSide","serverSide")}addRenderedRowListener(eventName,rowIndex,callback){this.rowRenderer.addRenderedRowListener(eventName,rowIndex,callback)}getQuickFilter(){return this.gos.get("quickFilterText")}getAdvancedFilterModel(){return ModuleRegistry.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null}setAdvancedFilterModel(advancedFilterModel){this.filterManager.setAdvancedFilterModel(advancedFilterModel)}showAdvancedFilterBuilder(){ModuleRegistry.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.showAdvancedFilterBuilder("api")}setNodesSelected(params){if(!params.nodes.every(node=>node.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):node.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),!1):!0))return;const{nodes,source,newValue}=params,nodesAsRowNode=nodes;this.selectionService.setNodesSelected({nodes:nodesAsRowNode,source:source??"api",newValue})}selectAll(source="apiSelectAll"){this.selectionService.selectAllRowNodes({source})}deselectAll(source="apiSelectAll"){this.selectionService.deselectAllRowNodes({source})}selectAllFiltered(source="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source,justFiltered:!0})}deselectAllFiltered(source="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source,justFiltered:!0})}getServerSideSelectionState(){return missing(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getSelectionState()}setServerSideSelectionState(state){if(missing(this.serverSideRowModel)){this.logMissingRowModel("setServerSideSelectionState","serverSide");return}this.selectionService.setSelectionState(state,"api")}selectAllOnCurrentPage(source="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source,justCurrentPage:!0})}deselectAllOnCurrentPage(source="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source,justCurrentPage:!0})}showLoadingOverlay(){this.overlayService.showLoadingOverlay()}showNoRowsOverlay(){this.overlayService.showNoRowsOverlay()}hideOverlay(){this.overlayService.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(missing(this.clientSideRowModel)){this.logMissingRowModel("getBestCostNodeSelection","clientSide");return}return this.selectionService.getBestCostNodeSelection()}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(key,position="auto"){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(key,position),"ensureVisible")}ensureIndexVisible(index,position){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(index,position),"ensureVisible")}ensureNodeVisible(nodeSelector,position=null){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(nodeSelector,position),"ensureVisible")}forEachLeafNode(callback){if(missing(this.clientSideRowModel)){this.logMissingRowModel("forEachLeafNode","clientSide");return}this.clientSideRowModel.forEachLeafNode(callback)}forEachNode(callback,includeFooterNodes){this.rowModel.forEachNode(callback,includeFooterNodes)}forEachNodeAfterFilter(callback){if(missing(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilter","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilter(callback)}forEachNodeAfterFilterAndSort(callback){if(missing(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilterAndSort(callback)}getFilterInstance(key,callback){return warnOnce("'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."),this.filterManager.getFilterInstance(key,callback)}getColumnFilterInstance(key){return this.filterManager.getColumnFilterInstance(key)}destroyFilter(key){const column=this.columnModel.getPrimaryColumn(key);if(column)return this.filterManager.destroyFilter(column,"api")}getStatusPanel(key){if(!ModuleRegistry.__assertRegistered("@ag-grid-enterprise/status-bar","api.getStatusPanel",this.context.getGridId()))return;const comp=this.statusBarService.getStatusPanel(key);return unwrapUserComp(comp)}getColumnDef(key){const column=this.columnModel.getPrimaryColumn(key);return column?column.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(source="api"){this.filterManager.onFilterChanged({source})}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(model){this.frameworkOverrides.wrapIncoming(()=>this.filterManager.setFilterModel(model))}getFilterModel(){return this.filterManager.getFilterModel()}getColumnFilterModel(column){return this.filterManager.getColumnFilterModel(column)}setColumnFilterModel(column,model){return this.filterManager.setColumnFilterModel(column,model)}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(rowIndex,colKey,rowPinned){this.focusService.setFocusedCell({rowIndex,column:colKey,rowPinned,forceBrowserFocus:!0})}addRowDropZone(params){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(params)}removeRowDropZone(params){const activeDropTarget=this.dragAndDropService.findExternalZone(params);activeDropTarget&&this.dragAndDropService.removeDropTarget(activeDropTarget)}getRowDropZoneParams(events){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(events)}assertSideBarLoaded(apiMethod){return ModuleRegistry.__assertRegistered("@ag-grid-enterprise/side-bar","api."+apiMethod,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarService.getSideBarComp().isDisplayed()}setSideBarVisible(show){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarService.getSideBarComp().setDisplayed(show)}setSideBarPosition(position){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarService.getSideBarComp().setSideBarPosition(position)}openToolPanel(key){this.assertSideBarLoaded("openToolPanel")&&this.sideBarService.getSideBarComp().openToolPanel(key,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarService.getSideBarComp().close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarService.getSideBarComp().openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarService.getSideBarComp().refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarService.getSideBarComp().isToolPanelShowing()}getToolPanelInstance(id){if(this.assertSideBarLoaded("getToolPanelInstance")){const comp=this.sideBarService.getSideBarComp().getToolPanelInstance(id);return unwrapUserComp(comp)}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarService.getSideBarComp().getDef()}resetRowHeights(){if(exists(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive()){console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");return}this.clientSideRowModel.resetRowHeights()}}setRowCount(rowCount,maxRowFound){if(this.serverSideRowModel){if(this.columnModel.isRowGroupEmpty()){this.serverSideRowModel.setRowCount(rowCount,maxRowFound);return}console.error("AG Grid: setRowCount cannot be used while using row grouping.");return}if(this.infiniteRowModel){this.infiniteRowModel.setRowCount(rowCount,maxRowFound);return}this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(colKey,rowNode){let column=this.columnModel.getPrimaryColumn(colKey);return missing(column)&&(column=this.columnModel.getGridColumn(colKey)),missing(column)?null:this.valueService.getValue(column,rowNode)}addEventListener(eventType,listener){this.apiEventService.addEventListener(eventType,listener)}addGlobalListener(listener){this.apiEventService.addGlobalListener(listener)}removeEventListener(eventType,listener){this.apiEventService.removeEventListener(eventType,listener)}removeGlobalListener(listener){this.apiEventService.removeGlobalListener(listener)}dispatchEvent(event){this.eventService.dispatchEvent(event)}destroy(){const preDestroyLink=`See ${this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}`;if(this.destroyCalled)return;const event={type:Events.EVENT_GRID_PRE_DESTROYED,state:this.getState()};this.dispatchEvent(event),this.destroyCalled=!0;const gridCtrl=this.ctrlsService.getGridCtrl();gridCtrl&&gridCtrl.destroyGridUi(),this.context.destroy(),removeAllReferences(this,["isDestroyed"],preDestroyLink)}isDestroyed(){return this.destroyCalled}resetQuickFilter(){this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/range-selection","api.getCellRanges",this.context.getGridId()),null)}addCellRange(params){if(this.rangeService){this.rangeService.addCellRange(params);return}ModuleRegistry.__assertRegistered("@ag-grid-enterprise/range-selection","api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),ModuleRegistry.__assertRegistered("@ag-grid-enterprise/range-selection","gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}assertChart(methodName,func){if(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/charts","api."+methodName,this.context.getGridId()))return this.frameworkOverrides.wrapIncoming(()=>func())}getChartModels(){return this.assertChart("getChartModels",()=>this.chartService.getChartModels())}getChartRef(chartId){return this.assertChart("getChartRef",()=>this.chartService.getChartRef(chartId))}getChartImageDataURL(params){return this.assertChart("getChartImageDataURL",()=>this.chartService.getChartImageDataURL(params))}downloadChart(params){return this.assertChart("downloadChart",()=>this.chartService.downloadChart(params))}openChartToolPanel(params){return this.assertChart("openChartToolPanel",()=>this.chartService.openChartToolPanel(params))}closeChartToolPanel(params){return this.assertChart("closeChartToolPanel",()=>this.chartService.closeChartToolPanel(params.chartId))}createRangeChart(params){return this.assertChart("createRangeChart",()=>this.chartService.createRangeChart(params))}createPivotChart(params){return this.assertChart("createPivotChart",()=>this.chartService.createPivotChart(params))}createCrossFilterChart(params){return this.assertChart("createCrossFilterChart",()=>this.chartService.createCrossFilterChart(params))}updateChart(params){return this.assertChart("updateChart",()=>this.chartService.updateChart(params))}restoreChart(chartModel,chartContainer){return this.assertChart("restoreChart",()=>this.chartService.restoreChart(chartModel,chartContainer))}assertClipboard(methodName,func){ModuleRegistry.__assertRegistered("@ag-grid-enterprise/clipboard","api"+methodName,this.context.getGridId())&&func()}copyToClipboard(params){this.assertClipboard("copyToClipboard",()=>this.clipboardService.copyToClipboard(params))}cutToClipboard(params){this.assertClipboard("cutToClipboard",()=>this.clipboardService.cutToClipboard(params))}copySelectedRowsToClipboard(params){this.assertClipboard("copySelectedRowsToClipboard",()=>this.clipboardService.copySelectedRowsToClipboard(params))}copySelectedRangeToClipboard(params){this.assertClipboard("copySelectedRangeToClipboard",()=>this.clipboardService.copySelectedRangeToClipboard(params))}copySelectedRangeDown(){this.assertClipboard("copySelectedRangeDown",()=>this.clipboardService.copyRangeDown())}pasteFromClipboard(){this.assertClipboard("pasteFromClipboard",()=>this.clipboardService.pasteFromClipboard())}showColumnMenuAfterButtonClick(colKey,buttonElement){warnOnce("'showColumnMenuAfterButtonClick' is deprecated. Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere.");const column=this.columnModel.getGridColumn(colKey);this.menuService.showColumnMenu({column,buttonElement,positionBy:"button"})}showColumnMenuAfterMouseClick(colKey,mouseEvent){warnOnce("'showColumnMenuAfterMouseClick' is deprecated. Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere.");let column=this.columnModel.getGridColumn(colKey);if(column||(column=this.columnModel.getPrimaryColumn(colKey)),!column){console.error(`AG Grid: column '${colKey}' not found`);return}this.menuService.showColumnMenu({column,mouseEvent,positionBy:"mouse"})}showColumnChooser(params){this.menuService.showColumnChooser({chooserParams:params})}showColumnFilter(colKey){const column=this.columnModel.getGridColumn(colKey);if(!column){console.error(`AG Grid: column '${colKey}' not found`);return}this.menuService.showFilterMenu({column,containerType:"columnFilter",positionBy:"auto"})}showColumnMenu(colKey){const column=this.columnModel.getGridColumn(colKey);if(!column){console.error(`AG Grid: column '${colKey}' not found`);return}this.menuService.showColumnMenu({column,positionBy:"auto"})}hidePopupMenu(){this.menuService.hidePopupMenu()}hideColumnChooser(){this.menuService.hideColumnChooser()}tabToNextCell(event){return this.navigationService.tabToNextCell(!1,event)}tabToPreviousCell(event){return this.navigationService.tabToNextCell(!0,event)}getCellRendererInstances(params={}){return this.rowRenderer.getCellRendererInstances(params).map(unwrapUserComp)}getCellEditorInstances(params={}){return this.rowRenderer.getCellEditorInstances(params).map(unwrapUserComp)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(cancel=!1){this.rowRenderer.stopEditing(cancel)}startEditingCell(params){const column=this.columnModel.getGridColumn(params.colKey);if(!column){console.warn(`AG Grid: no column found for ${params.colKey}`);return}const cellPosition={rowIndex:params.rowIndex,rowPinned:params.rowPinned||null,column};params.rowPinned==null&&this.ensureIndexVisible(params.rowIndex),this.ensureColumnVisible(params.colKey);const cell=this.navigationService.getCellByPosition(cellPosition);cell&&(this.focusService.isCellFocused(cellPosition)||this.focusService.setFocusedCell(cellPosition),cell.startRowOrCellEdit(params.key))}addAggFunc(key,aggFunc){this.logDeprecation("v31.1","addAggFunc(key, func)","addAggFuncs({ key: func })"),this.aggFuncService&&this.aggFuncService.addAggFuncs({key:aggFunc})}addAggFuncs(aggFuncs){this.aggFuncService&&this.aggFuncService.addAggFuncs(aggFuncs)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(transaction){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransaction","serverSide");return}return this.serverSideTransactionManager.applyTransaction(transaction)}applyServerSideTransactionAsync(transaction,callback){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransactionAsync","serverSide");return}return this.serverSideTransactionManager.applyTransactionAsync(transaction,callback)}applyServerSideRowData(params){var _a273,_b;const startRow=(_a273=params.startRow)!=null?_a273:0,route=(_b=params.route)!=null?_b:[];if(startRow<0){console.warn(`AG Grid: invalid value ${params.startRow} for startRow, the value should be >= 0`);return}this.serverSideRowModel?this.serverSideRowModel.applyRowData(params.successParams,startRow,route):this.logMissingRowModel("setServerSideDatasource","serverSide")}retryServerSideLoads(){if(!this.serverSideRowModel){this.logMissingRowModel("retryServerSideLoads","serverSide");return}this.serverSideRowModel.retryLoads()}flushServerSideAsyncTransactions(){if(!this.serverSideTransactionManager){this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide");return}return this.serverSideTransactionManager.flushAsyncTransactions()}applyTransaction(rowDataTransaction){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransaction","clientSide");return}return this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.updateRowData(rowDataTransaction))}applyTransactionAsync(rowDataTransaction,callback){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransactionAsync","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.batchUpdateRowData(rowDataTransaction,callback))}flushAsyncTransactions(){if(!this.clientSideRowModel){this.logMissingRowModel("flushAsyncTransactions","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.flushAsyncTransactions())}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(params){if(!this.serverSideRowModel){this.logMissingRowModel("refreshServerSide","serverSide");return}this.serverSideRowModel.refreshStore(params)}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.logDeprecation("v31.1","getFirstDisplayedRow","getFirstDisplayedRowIndex"),this.getFirstDisplayedRowIndex()}getFirstDisplayedRowIndex(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.logDeprecation("v31.1","getLastDisplayedRow","getLastDisplayedRowIndex"),this.getLastDisplayedRowIndex()}getLastDisplayedRowIndex(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(index){return this.rowModel.getRow(index)}getDisplayedRowCount(){return this.rowModel.getRowCount()}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(page){this.paginationProxy.goToPage(page)}sizeColumnsToFit(paramsOrGridWidth){typeof paramsOrGridWidth=="number"?this.columnModel.sizeColumnsToFit(paramsOrGridWidth,"api"):this.gridBodyCtrl.sizeColumnsToFit(paramsOrGridWidth)}setColumnGroupOpened(group,newValue){this.columnModel.setColumnGroupOpened(group,newValue,"api")}getColumnGroup(name,instanceId){return this.columnModel.getColumnGroup(name,instanceId)}getProvidedColumnGroup(name){return this.columnModel.getProvidedColumnGroup(name)}getDisplayNameForColumn(column,location){return this.columnModel.getDisplayNameForColumn(column,location)||""}getDisplayNameForColumnGroup(columnGroup,location){return this.columnModel.getDisplayNameForColumnGroup(columnGroup,location)||""}getColumn(key){return this.columnModel.getPrimaryColumn(key)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(params){return this.columnModel.applyColumnState(params,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(stateItems){this.columnModel.setColumnGroupState(stateItems,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(col){return this.columnModel.getDisplayedColAfter(col)}getDisplayedColBefore(col){return this.columnModel.getDisplayedColBefore(col)}setColumnVisible(key,visible){this.logDeprecation("v31.1","setColumnVisible(key,visible)","setColumnsVisible([key],visible)"),this.columnModel.setColumnsVisible([key],visible,"api")}setColumnsVisible(keys2,visible){this.columnModel.setColumnsVisible(keys2,visible,"api")}setColumnPinned(key,pinned){this.logDeprecation("v31.1","setColumnPinned(key,pinned)","setColumnsPinned([key],pinned)"),this.columnModel.setColumnsPinned([key],pinned,"api")}setColumnsPinned(keys2,pinned){this.columnModel.setColumnsPinned(keys2,pinned,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(key,toIndex){this.logDeprecation("v31.1","moveColumn(key, toIndex)","moveColumns([key], toIndex)"),this.columnModel.moveColumns([key],toIndex,"api")}moveColumnByIndex(fromIndex,toIndex){this.columnModel.moveColumnByIndex(fromIndex,toIndex,"api")}moveColumns(columnsToMoveKeys,toIndex){this.columnModel.moveColumns(columnsToMoveKeys,toIndex,"api")}moveRowGroupColumn(fromIndex,toIndex){this.columnModel.moveRowGroupColumn(fromIndex,toIndex,"api")}setColumnAggFunc(key,aggFunc){this.columnModel.setColumnAggFunc(key,aggFunc,"api")}setColumnWidth(key,newWidth,finished=!0,source="api"){this.logDeprecation("v31.1","setColumnWidth(col, width)","setColumnWidths([{key: col, newWidth: width}])"),this.columnModel.setColumnWidths([{key,newWidth}],!1,finished,source)}setColumnWidths(columnWidths,finished=!0,source="api"){this.columnModel.setColumnWidths(columnWidths,!1,finished,source)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(pivotKeys,valueColKey){return this.columnModel.getSecondaryPivotColumn(pivotKeys,valueColKey)}setValueColumns(colKeys){this.columnModel.setValueColumns(colKeys,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(colKey){this.logDeprecation("v31.1","removeValueColumn(colKey)","removeValueColumns([colKey])"),this.columnModel.removeValueColumns([colKey],"api")}removeValueColumns(colKeys){this.columnModel.removeValueColumns(colKeys,"api")}addValueColumn(colKey){this.logDeprecation("v31.1","addValueColumn(colKey)","addValueColumns([colKey])"),this.columnModel.addValueColumns([colKey],"api")}addValueColumns(colKeys){this.columnModel.addValueColumns(colKeys,"api")}setRowGroupColumns(colKeys){this.columnModel.setRowGroupColumns(colKeys,"api")}removeRowGroupColumn(colKey){this.logDeprecation("v31.1","removeRowGroupColumn(colKey)","removeRowGroupColumns([colKey])"),this.columnModel.removeRowGroupColumns([colKey],"api")}removeRowGroupColumns(colKeys){this.columnModel.removeRowGroupColumns(colKeys,"api")}addRowGroupColumn(colKey){this.logDeprecation("v31.1","addRowGroupColumn(colKey)","addRowGroupColumns([colKey])"),this.columnModel.addRowGroupColumns([colKey],"api")}addRowGroupColumns(colKeys){this.columnModel.addRowGroupColumns(colKeys,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(colKeys){this.columnModel.setPivotColumns(colKeys,"api")}removePivotColumn(colKey){this.logDeprecation("v31.1","removePivotColumn(colKey)","removePivotColumns([colKey])"),this.columnModel.removePivotColumns([colKey],"api")}removePivotColumns(colKeys){this.columnModel.removePivotColumns(colKeys,"api")}addPivotColumn(colKey){this.logDeprecation("v31.1","addPivotColumn(colKey)","addPivotColumns([colKey])"),this.columnModel.addPivotColumns([colKey],"api")}addPivotColumns(colKeys){this.columnModel.addPivotColumns(colKeys,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(key,skipHeader){return this.logDeprecation("v31.1","autoSizeColumn(key, skipHeader)","autoSizeColumns([key], skipHeader)"),this.columnModel.autoSizeColumns({columns:[key],skipHeader,source:"api"})}autoSizeColumns(keys2,skipHeader){this.columnModel.autoSizeColumns({columns:keys2,skipHeader,source:"api"})}autoSizeAllColumns(skipHeader){this.columnModel.autoSizeAllColumns("api",skipHeader)}setPivotResultColumns(colDefs){this.columnModel.setSecondaryColumns(colDefs,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}getState(){return this.stateService.getState()}getGridOption(key){return this.gos.get(key)}setGridOption(key,value){this.updateGridOptions({[key]:value})}updateGridOptions(options){this.gos.updateGridOptions({options})}__internalUpdateGridOptions(options){this.gos.updateGridOptions({options,source:"gridOptionsUpdated"})}deprecatedUpdateGridOption(key,value){warnOnce(`set${key.charAt(0).toUpperCase()}${key.slice(1,key.length)} is deprecated. Please use 'api.setGridOption('${key}', newValue)' or 'api.updateGridOptions({ ${key}: newValue })' instead.`),this.setGridOption(key,value)}setPivotMode(pivotMode){this.deprecatedUpdateGridOption("pivotMode",pivotMode)}setPinnedTopRowData(rows){this.deprecatedUpdateGridOption("pinnedTopRowData",rows)}setPinnedBottomRowData(rows){this.deprecatedUpdateGridOption("pinnedBottomRowData",rows)}setPopupParent(ePopupParent){this.deprecatedUpdateGridOption("popupParent",ePopupParent)}setSuppressModelUpdateAfterUpdateTransaction(value){this.deprecatedUpdateGridOption("suppressModelUpdateAfterUpdateTransaction",value)}setDataTypeDefinitions(dataTypeDefinitions){this.deprecatedUpdateGridOption("dataTypeDefinitions",dataTypeDefinitions)}setPagination(value){this.deprecatedUpdateGridOption("pagination",value)}paginationSetPageSize(size){this.deprecatedUpdateGridOption("paginationPageSize",size)}setSideBar(def){this.deprecatedUpdateGridOption("sideBar",def)}setSuppressClipboardPaste(value){this.deprecatedUpdateGridOption("suppressClipboardPaste",value)}setGroupRemoveSingleChildren(value){this.deprecatedUpdateGridOption("groupRemoveSingleChildren",value)}setGroupRemoveLowestSingleChildren(value){this.deprecatedUpdateGridOption("groupRemoveLowestSingleChildren",value)}setGroupDisplayType(value){this.deprecatedUpdateGridOption("groupDisplayType",value)}setGroupIncludeFooter(value){this.deprecatedUpdateGridOption("groupIncludeFooter",value)}setGroupIncludeTotalFooter(value){this.deprecatedUpdateGridOption("groupIncludeTotalFooter",value)}setRowClass(className){this.deprecatedUpdateGridOption("rowClass",className)}setDeltaSort(enable){this.deprecatedUpdateGridOption("deltaSort",enable)}setSuppressRowDrag(value){this.deprecatedUpdateGridOption("suppressRowDrag",value)}setSuppressMoveWhenRowDragging(value){this.deprecatedUpdateGridOption("suppressMoveWhenRowDragging",value)}setSuppressRowClickSelection(value){this.deprecatedUpdateGridOption("suppressRowClickSelection",value)}setEnableAdvancedFilter(enabled){this.deprecatedUpdateGridOption("enableAdvancedFilter",enabled)}setIncludeHiddenColumnsInAdvancedFilter(value){this.deprecatedUpdateGridOption("includeHiddenColumnsInAdvancedFilter",value)}setAdvancedFilterParent(advancedFilterParent){this.deprecatedUpdateGridOption("advancedFilterParent",advancedFilterParent)}setAdvancedFilterBuilderParams(params){this.deprecatedUpdateGridOption("advancedFilterBuilderParams",params)}setQuickFilter(newFilter){warnOnce("setQuickFilter is deprecated. Please use 'api.setGridOption('quickFilterText', newValue)' or 'api.updateGridOptions({ quickFilterText: newValue })' instead."),this.gos.updateGridOptions({options:{quickFilterText:newFilter}})}setExcludeHiddenColumnsFromQuickFilter(value){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",!value)}setIncludeHiddenColumnsInQuickFilter(value){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",value)}setQuickFilterParser(quickFilterParser){this.deprecatedUpdateGridOption("quickFilterParser",quickFilterParser)}setQuickFilterMatcher(quickFilterMatcher){this.deprecatedUpdateGridOption("quickFilterMatcher",quickFilterMatcher)}setAlwaysShowHorizontalScroll(show){this.deprecatedUpdateGridOption("alwaysShowHorizontalScroll",show)}setAlwaysShowVerticalScroll(show){this.deprecatedUpdateGridOption("alwaysShowVerticalScroll",show)}setFunctionsReadOnly(readOnly){this.deprecatedUpdateGridOption("functionsReadOnly",readOnly)}setColumnDefs(colDefs,source="api"){warnOnce("setColumnDefs is deprecated. Please use 'api.setGridOption('columnDefs', newValue)' or 'api.updateGridOptions({ columnDefs: newValue })' instead."),this.gos.updateGridOptions({options:{columnDefs:colDefs},source})}setAutoGroupColumnDef(colDef,source="api"){warnOnce("setAutoGroupColumnDef is deprecated. Please use 'api.setGridOption('autoGroupColumnDef', newValue)' or 'api.updateGridOptions({ autoGroupColumnDef: newValue })' instead."),this.gos.updateGridOptions({options:{autoGroupColumnDef:colDef},source})}setDefaultColDef(colDef,source="api"){warnOnce("setDefaultColDef is deprecated. Please use 'api.setGridOption('defaultColDef', newValue)' or 'api.updateGridOptions({ defaultColDef: newValue })' instead."),this.gos.updateGridOptions({options:{defaultColDef:colDef},source})}setColumnTypes(columnTypes,source="api"){warnOnce("setColumnTypes is deprecated. Please use 'api.setGridOption('columnTypes', newValue)' or 'api.updateGridOptions({ columnTypes: newValue })' instead."),this.gos.updateGridOptions({options:{columnTypes},source})}setTreeData(newTreeData){this.deprecatedUpdateGridOption("treeData",newTreeData)}setServerSideDatasource(datasource){this.deprecatedUpdateGridOption("serverSideDatasource",datasource)}setCacheBlockSize(blockSize){this.deprecatedUpdateGridOption("cacheBlockSize",blockSize)}setDatasource(datasource){this.deprecatedUpdateGridOption("datasource",datasource)}setViewportDatasource(viewportDatasource){this.deprecatedUpdateGridOption("viewportDatasource",viewportDatasource)}setRowData(rowData){this.deprecatedUpdateGridOption("rowData",rowData)}setEnableCellTextSelection(selectable){this.deprecatedUpdateGridOption("enableCellTextSelection",selectable)}setHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("headerHeight",headerHeight)}setDomLayout(domLayout){this.deprecatedUpdateGridOption("domLayout",domLayout)}setFillHandleDirection(direction){this.deprecatedUpdateGridOption("fillHandleDirection",direction)}setGroupHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("groupHeaderHeight",headerHeight)}setFloatingFiltersHeight(headerHeight){this.deprecatedUpdateGridOption("floatingFiltersHeight",headerHeight)}setPivotHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("pivotHeaderHeight",headerHeight)}setPivotGroupHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("pivotGroupHeaderHeight",headerHeight)}setAnimateRows(animateRows){this.deprecatedUpdateGridOption("animateRows",animateRows)}setIsExternalFilterPresent(isExternalFilterPresentFunc){this.deprecatedUpdateGridOption("isExternalFilterPresent",isExternalFilterPresentFunc)}setDoesExternalFilterPass(doesExternalFilterPassFunc){this.deprecatedUpdateGridOption("doesExternalFilterPass",doesExternalFilterPassFunc)}setNavigateToNextCell(navigateToNextCellFunc){this.deprecatedUpdateGridOption("navigateToNextCell",navigateToNextCellFunc)}setTabToNextCell(tabToNextCellFunc){this.deprecatedUpdateGridOption("tabToNextCell",tabToNextCellFunc)}setTabToNextHeader(tabToNextHeaderFunc){this.deprecatedUpdateGridOption("tabToNextHeader",tabToNextHeaderFunc)}setNavigateToNextHeader(navigateToNextHeaderFunc){this.deprecatedUpdateGridOption("navigateToNextHeader",navigateToNextHeaderFunc)}setRowGroupPanelShow(rowGroupPanelShow){this.deprecatedUpdateGridOption("rowGroupPanelShow",rowGroupPanelShow)}setGetGroupRowAgg(getGroupRowAggFunc){this.deprecatedUpdateGridOption("getGroupRowAgg",getGroupRowAggFunc)}setGetBusinessKeyForNode(getBusinessKeyForNodeFunc){this.deprecatedUpdateGridOption("getBusinessKeyForNode",getBusinessKeyForNodeFunc)}setGetChildCount(getChildCountFunc){this.deprecatedUpdateGridOption("getChildCount",getChildCountFunc)}setProcessRowPostCreate(processRowPostCreateFunc){this.deprecatedUpdateGridOption("processRowPostCreate",processRowPostCreateFunc)}setGetRowId(getRowIdFunc){warnOnce("getRowId is a static property and can no longer be updated.")}setGetRowClass(rowClassFunc){this.deprecatedUpdateGridOption("getRowClass",rowClassFunc)}setIsFullWidthRow(isFullWidthRowFunc){this.deprecatedUpdateGridOption("isFullWidthRow",isFullWidthRowFunc)}setIsRowSelectable(isRowSelectableFunc){this.deprecatedUpdateGridOption("isRowSelectable",isRowSelectableFunc)}setIsRowMaster(isRowMasterFunc){this.deprecatedUpdateGridOption("isRowMaster",isRowMasterFunc)}setPostSortRows(postSortRowsFunc){this.deprecatedUpdateGridOption("postSortRows",postSortRowsFunc)}setGetDocument(getDocumentFunc){this.deprecatedUpdateGridOption("getDocument",getDocumentFunc)}setGetContextMenuItems(getContextMenuItemsFunc){this.deprecatedUpdateGridOption("getContextMenuItems",getContextMenuItemsFunc)}setGetMainMenuItems(getMainMenuItemsFunc){this.deprecatedUpdateGridOption("getMainMenuItems",getMainMenuItemsFunc)}setProcessCellForClipboard(processCellForClipboardFunc){this.deprecatedUpdateGridOption("processCellForClipboard",processCellForClipboardFunc)}setSendToClipboard(sendToClipboardFunc){this.deprecatedUpdateGridOption("sendToClipboard",sendToClipboardFunc)}setProcessCellFromClipboard(processCellFromClipboardFunc){this.deprecatedUpdateGridOption("processCellFromClipboard",processCellFromClipboardFunc)}setProcessPivotResultColDef(processPivotResultColDefFunc){this.deprecatedUpdateGridOption("processPivotResultColDef",processPivotResultColDefFunc)}setProcessPivotResultColGroupDef(processPivotResultColGroupDefFunc){this.deprecatedUpdateGridOption("processPivotResultColGroupDef",processPivotResultColGroupDefFunc)}setPostProcessPopup(postProcessPopupFunc){this.deprecatedUpdateGridOption("postProcessPopup",postProcessPopupFunc)}setInitialGroupOrderComparator(initialGroupOrderComparatorFunc){this.deprecatedUpdateGridOption("initialGroupOrderComparator",initialGroupOrderComparatorFunc)}setGetChartToolbarItems(getChartToolbarItemsFunc){this.deprecatedUpdateGridOption("getChartToolbarItems",getChartToolbarItemsFunc)}setPaginationNumberFormatter(paginationNumberFormatterFunc){this.deprecatedUpdateGridOption("paginationNumberFormatter",paginationNumberFormatterFunc)}setGetServerSideGroupLevelParams(getServerSideGroupLevelParamsFunc){this.deprecatedUpdateGridOption("getServerSideGroupLevelParams",getServerSideGroupLevelParamsFunc)}setIsServerSideGroupOpenByDefault(isServerSideGroupOpenByDefaultFunc){this.deprecatedUpdateGridOption("isServerSideGroupOpenByDefault",isServerSideGroupOpenByDefaultFunc)}setIsApplyServerSideTransaction(isApplyServerSideTransactionFunc){this.deprecatedUpdateGridOption("isApplyServerSideTransaction",isApplyServerSideTransactionFunc)}setIsServerSideGroup(isServerSideGroupFunc){this.deprecatedUpdateGridOption("isServerSideGroup",isServerSideGroupFunc)}setGetServerSideGroupKey(getServerSideGroupKeyFunc){this.deprecatedUpdateGridOption("getServerSideGroupKey",getServerSideGroupKeyFunc)}setGetRowStyle(rowStyleFunc){this.deprecatedUpdateGridOption("getRowStyle",rowStyleFunc)}setGetRowHeight(rowHeightFunc){this.deprecatedUpdateGridOption("getRowHeight",rowHeightFunc)}},__name(_a102,"GridApi"),_a102);__decorateClass([Optional("csvCreator")],GridApi.prototype,"csvCreator",2);__decorateClass([Optional("excelCreator")],GridApi.prototype,"excelCreator",2);__decorateClass([Autowired("rowRenderer")],GridApi.prototype,"rowRenderer",2);__decorateClass([Autowired("navigationService")],GridApi.prototype,"navigationService",2);__decorateClass([Autowired("filterManager")],GridApi.prototype,"filterManager",2);__decorateClass([Autowired("columnModel")],GridApi.prototype,"columnModel",2);__decorateClass([Autowired("selectionService")],GridApi.prototype,"selectionService",2);__decorateClass([Autowired("gridOptionsService")],GridApi.prototype,"gos",2);__decorateClass([Autowired("valueService")],GridApi.prototype,"valueService",2);__decorateClass([Autowired("alignedGridsService")],GridApi.prototype,"alignedGridsService",2);__decorateClass([Autowired("eventService")],GridApi.prototype,"eventService",2);__decorateClass([Autowired("pinnedRowModel")],GridApi.prototype,"pinnedRowModel",2);__decorateClass([Autowired("context")],GridApi.prototype,"context",2);__decorateClass([Autowired("rowModel")],GridApi.prototype,"rowModel",2);__decorateClass([Autowired("sortController")],GridApi.prototype,"sortController",2);__decorateClass([Autowired("paginationProxy")],GridApi.prototype,"paginationProxy",2);__decorateClass([Autowired("focusService")],GridApi.prototype,"focusService",2);__decorateClass([Autowired("dragAndDropService")],GridApi.prototype,"dragAndDropService",2);__decorateClass([Optional("rangeService")],GridApi.prototype,"rangeService",2);__decorateClass([Optional("clipboardService")],GridApi.prototype,"clipboardService",2);__decorateClass([Optional("aggFuncService")],GridApi.prototype,"aggFuncService",2);__decorateClass([Autowired("menuService")],GridApi.prototype,"menuService",2);__decorateClass([Autowired("valueCache")],GridApi.prototype,"valueCache",2);__decorateClass([Autowired("animationFrameService")],GridApi.prototype,"animationFrameService",2);__decorateClass([Optional("statusBarService")],GridApi.prototype,"statusBarService",2);__decorateClass([Optional("chartService")],GridApi.prototype,"chartService",2);__decorateClass([Optional("undoRedoService")],GridApi.prototype,"undoRedoService",2);__decorateClass([Optional("rowNodeBlockLoader")],GridApi.prototype,"rowNodeBlockLoader",2);__decorateClass([Optional("ssrmTransactionManager")],GridApi.prototype,"serverSideTransactionManager",2);__decorateClass([Autowired("ctrlsService")],GridApi.prototype,"ctrlsService",2);__decorateClass([Autowired("overlayService")],GridApi.prototype,"overlayService",2);__decorateClass([Optional("sideBarService")],GridApi.prototype,"sideBarService",2);__decorateClass([Autowired("stateService")],GridApi.prototype,"stateService",2);__decorateClass([Autowired("expansionService")],GridApi.prototype,"expansionService",2);__decorateClass([Autowired("apiEventService")],GridApi.prototype,"apiEventService",2);__decorateClass([Autowired("frameworkOverrides")],GridApi.prototype,"frameworkOverrides",2);__decorateClass([PostConstruct],GridApi.prototype,"init",1);GridApi=__decorateClass([Bean("gridApi")],GridApi);var _a103,QuickFilterService=(_a103=class extends BeanStub{constructor(){super(...arguments),this.quickFilter=null,this.quickFilterParts=null}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,()=>{this.gridOptionsService.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter",()=>this.onIncludeHiddenColumnsInQuickFilterChanged()),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.parser=this.gridOptionsService.get("quickFilterParser"),this.matcher=this.gridOptionsService.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}isQuickFilterPresent(){return this.quickFilter!==null}doesRowPassQuickFilter(node){const usingCache=this.gridOptionsService.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(usingCache,node):this.quickFilterParts.every(part=>usingCache?this.doesRowPassQuickFilterCache(node,part):this.doesRowPassQuickFilterNoCache(node,part))}resetQuickFilterCache(){this.rowModel.forEachNode(node=>node.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter,parser}=this;quickFilter?this.quickFilterParts=parser?parser(quickFilter):quickFilter.split(" "):this.quickFilterParts=null}parseQuickFilter(newFilter){return exists(newFilter)?this.gridOptionsService.isRowModelType("clientSide")?newFilter.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(newFilter){if(newFilter!=null&&typeof newFilter!="string"){console.warn(`AG Grid - Grid option quickFilterText only supports string inputs, received: ${typeof newFilter}`);return}const parsedFilter=this.parseQuickFilter(newFilter);this.quickFilter!==parsedFilter&&(this.quickFilter=parsedFilter,this.setQuickFilterParts(),this.dispatchEvent({type:QuickFilterService.EVENT_QUICK_FILTER_CHANGED}))}setQuickFilterParserAndMatcher(){const parser=this.gridOptionsService.get("quickFilterParser"),matcher=this.gridOptionsService.get("quickFilterMatcher"),hasChanged=parser!==this.parser||matcher!==this.matcher;this.parser=parser,this.matcher=matcher,hasChanged&&(this.setQuickFilterParts(),this.dispatchEvent({type:QuickFilterService.EVENT_QUICK_FILTER_CHANGED}))}onIncludeHiddenColumnsInQuickFilterChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchEvent({type:QuickFilterService.EVENT_QUICK_FILTER_CHANGED})}doesRowPassQuickFilterNoCache(node,filterPart){return this.columnModel.getAllColumnsForQuickFilter().some(column=>{const part=this.getQuickFilterTextForColumn(column,node);return exists(part)&&part.indexOf(filterPart)>=0})}doesRowPassQuickFilterCache(node,filterPart){return this.checkGenerateQuickFilterAggregateText(node),node.quickFilterAggregateText.indexOf(filterPart)>=0}doesRowPassQuickFilterMatcher(usingCache,node){let quickFilterAggregateText;usingCache?(this.checkGenerateQuickFilterAggregateText(node),quickFilterAggregateText=node.quickFilterAggregateText):quickFilterAggregateText=this.getQuickFilterAggregateText(node);const{quickFilterParts,matcher}=this;return matcher(quickFilterParts,quickFilterAggregateText)}checkGenerateQuickFilterAggregateText(node){node.quickFilterAggregateText||(node.quickFilterAggregateText=this.getQuickFilterAggregateText(node))}getQuickFilterTextForColumn(column,node){let value=this.valueService.getValue(column,node,!0);const colDef=column.getColDef();if(colDef.getQuickFilterText){const params=this.gridOptionsService.addGridCommonParams({value,node,data:node.data,column,colDef});value=colDef.getQuickFilterText(params)}return exists(value)?value.toString().toUpperCase():null}getQuickFilterAggregateText(node){const stringParts=[];return this.columnModel.getAllColumnsForQuickFilter().forEach(column=>{const part=this.getQuickFilterTextForColumn(column,node);exists(part)&&stringParts.push(part)}),stringParts.join(QuickFilterService.QUICK_FILTER_SEPARATOR)}},__name(_a103,"QuickFilterService"),_a103);QuickFilterService.EVENT_QUICK_FILTER_CHANGED="quickFilterChanged";QuickFilterService.QUICK_FILTER_SEPARATOR=`
`;__decorateClass([Autowired("valueService")],QuickFilterService.prototype,"valueService",2);__decorateClass([Autowired("columnModel")],QuickFilterService.prototype,"columnModel",2);__decorateClass([Autowired("rowModel")],QuickFilterService.prototype,"rowModel",2);__decorateClass([PostConstruct],QuickFilterService.prototype,"postConstruct",1);QuickFilterService=__decorateClass([Bean("quickFilterService")],QuickFilterService);var _a104,FilterManager=(_a104=class extends BeanStub{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue=[]}init(){var _a273,_b,_c;this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,Events.EVENT_ROW_DATA_UPDATED,()=>this.onNewRowsLoaded("rowDataUpdated")),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",event=>this.setAdvancedFilterModel(event.currentValue)),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,({enabled})=>this.onAdvancedFilterEnabledChanged(enabled)),this.addManagedListener(this.eventService,Events.EVENT_DATA_TYPES_INFERRED,()=>this.processFilterModelUpdateQueue()),this.addManagedListener(this.quickFilterService,QuickFilterService.EVENT_QUICK_FILTER_CHANGED,()=>this.onFilterChanged({source:"quickFilter"})),this.initialFilterModel=__spreadValues({},(_c=(_b=(_a273=this.gridOptionsService.get("initialState"))==null?void 0:_a273.filter)==null?void 0:_b.filterModel)!=null?_c:{})}isExternalFilterPresentCallback(){const isFilterPresent=this.gridOptionsService.getCallback("isExternalFilterPresent");return typeof isFilterPresent=="function"?isFilterPresent({}):!1}doesExternalFilterPass(node){const doesFilterPass=this.gridOptionsService.get("doesExternalFilterPass");return typeof doesFilterPass=="function"?doesFilterPass(node):!1}setFilterModel(model,source="api"){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}if(this.dataTypeService.isPendingInference()){this.filterModelUpdateQueue.push({model,source});return}const allPromises=[],previousModel=this.getFilterModel();if(model){const modelKeys=convertToSet(Object.keys(model));this.allColumnFilters.forEach((filterWrapper,colId)=>{const newModel=model[colId];allPromises.push(this.setModelOnFilterWrapper(filterWrapper.filterPromise,newModel)),modelKeys.delete(colId)}),modelKeys.forEach(colId=>{const column=this.columnModel.getPrimaryColumn(colId)||this.columnModel.getGridColumn(colId);if(!column){console.warn("AG Grid: setFilterModel() - no column found for colId: "+colId);return}if(!column.isFilterAllowed()){console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+colId);return}const filterWrapper=this.getOrCreateFilterWrapper(column,"NO_UI");if(!filterWrapper){console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+colId);return}allPromises.push(this.setModelOnFilterWrapper(filterWrapper.filterPromise,model[colId]))})}else this.allColumnFilters.forEach(filterWrapper=>{allPromises.push(this.setModelOnFilterWrapper(filterWrapper.filterPromise,null))});AgPromise.all(allPromises).then(()=>{const currentModel=this.getFilterModel(),columns=[];this.allColumnFilters.forEach((filterWrapper,colId)=>{const before=previousModel?previousModel[colId]:null,after=currentModel?currentModel[colId]:null;_.jsonEquals(before,after)||columns.push(filterWrapper.column)}),columns.length>0&&this.onFilterChanged({columns,source})})}setModelOnFilterWrapper(filterPromise,newModel){return new AgPromise(resolve=>{filterPromise.then(filter=>{typeof filter.setModel!="function"&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),resolve()),(filter.setModel(newModel)||AgPromise.resolve()).then(()=>resolve())})})}getFilterModel(){const result={};return this.allColumnFilters.forEach((filterWrapper,key)=>{const model=this.getModelFromFilterWrapper(filterWrapper);exists(model)&&(result[key]=model)}),result}getModelFromFilterWrapper(filterWrapper){var _a273;const filter=filterWrapper.filterPromise.resolveNow(null,promiseFilter=>promiseFilter);return filter==null?(_a273=this.initialFilterModel[filterWrapper.column.getColId()])!=null?_a273:null:typeof filter.getModel!="function"?(console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel"),null):filter.getModel()}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(enabled){var _a273;enabled?this.allColumnFilters.size&&(this.allColumnFilters.forEach(filterWrapper=>this.disposeFilterWrapper(filterWrapper,"advancedFilterEnabled")),this.onFilterChanged({source:"advancedFilter"})):(_a273=this.advancedFilterService)!=null&&_a273.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var _a273;return!!((_a273=this.advancedFilterService)!=null&&_a273.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}doAggregateFiltersPass(node,filterToSkip){return this.doColumnFiltersPass(node,filterToSkip,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const isFilterActive=__name(filter=>filter?filter.isFilterActive?filter.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1):!1,"isFilterActive"),groupFilterEnabled=!!this.gridOptionsService.getGroupAggFiltering(),isAggFilter=__name(column=>{if(!column.isPrimary())return!0;const isShowingPrimaryColumns=!this.columnModel.isPivotActive();return!column.isValueActive()||!isShowingPrimaryColumns?!1:this.columnModel.isPivotMode()?!0:groupFilterEnabled},"isAggFilter");this.allColumnFilters.forEach(filterWrapper=>{if(filterWrapper.filterPromise.resolveNow(!1,isFilterActive)){const filterComp=filterWrapper.filterPromise.resolveNow(null,filter=>filter);isAggFilter(filterWrapper.column)?this.activeAggregateFilters.push(filterComp):this.activeColumnFilters.push(filterComp)}})}updateFilterFlagInColumns(source,additionalEventAttributes){this.allColumnFilters.forEach(filterWrapper=>{const isFilterActive=filterWrapper.filterPromise.resolveNow(!1,filter=>filter.isFilterActive());filterWrapper.column.setFilterActive(isFilterActive,source,additionalEventAttributes)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}doColumnFiltersPass(node,filterToSkip,targetAggregates){const{data,aggData}=node,targetedFilters=targetAggregates?this.activeAggregateFilters:this.activeColumnFilters,targetedData=targetAggregates?aggData:data;for(let i=0;i<targetedFilters.length;i++){const filter=targetedFilters[i];if(!(filter==null||filter===filterToSkip)){if(typeof filter.doesFilterPass!="function")throw new Error("Filter is missing method doesFilterPass");if(!filter.doesFilterPass({node,data:targetedData}))return!1}}return!0}resetQuickFilterCache(){this.quickFilterService.resetQuickFilterCache()}refreshFiltersForAggregations(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(params){const action=__name(()=>this.onFilterChanged(params),"action");this.rowRenderer.isRefreshInProgress()?setTimeout(action,0):action()}onFilterChanged(params={}){const{source,filterInstance,additionalEventAttributes,columns}=params;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",additionalEventAttributes),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(filterWrapper=>{filterWrapper.filterPromise&&filterWrapper.filterPromise.then(filter=>{filter&&filter!==filterInstance&&filter.onAnyFilterChanged&&filter.onAnyFilterChanged()})});const filterChangedEvent={source,type:Events.EVENT_FILTER_CHANGED,columns:columns||[]};additionalEventAttributes&&mergeDeep(filterChangedEvent,additionalEventAttributes),this.processingFilterChange=!0,this.eventService.dispatchEvent(filterChangedEvent),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){var _a273;return!((_a273=this.gridOptionsService.get("allowShowChangeAfterFilter"))!=null?_a273:!1)&&this.processingFilterChange}isQuickFilterPresent(){return this.quickFilterService.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!this.gridOptionsService.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&(this.aggFiltering||this.columnModel.isPivotMode())}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!(this.aggFiltering||this.columnModel.isPivotMode())}doesRowPassOtherFilters(filterToSkip,node){return this.doesRowPassFilter({rowNode:node,filterInstanceToSkip:filterToSkip})}doesRowPassAggregateFilters(params){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(params.rowNode)||this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(params.rowNode,params.filterInstanceToSkip))}doesRowPassFilter(params){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(params.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(params.rowNode)||this.isColumnFilterPresent()&&!this.doColumnFiltersPass(params.rowNode,params.filterInstanceToSkip)||this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(params.rowNode))}onNewRowsLoaded(source){this.allColumnFilters.forEach(filterWrapper=>{filterWrapper.filterPromise.then(filter=>{filter.onNewRowsLoaded&&filter.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(source,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(column){return({node})=>this.valueService.getValue(column,node,!0)}createGetValue(filterColumn){return(rowNode,column)=>{const columnToUse=column?this.columnModel.getGridColumn(column):filterColumn;return columnToUse?this.valueService.getValue(columnToUse,rowNode,!0):void 0}}getFilterComponent(column,source,createIfDoesNotExist=!0){var _a273;if(createIfDoesNotExist)return((_a273=this.getOrCreateFilterWrapper(column,source))==null?void 0:_a273.filterPromise)||null;const filterWrapper=this.cachedFilter(column);return filterWrapper?filterWrapper.filterPromise:null}isFilterActive(column){const filterWrapper=this.cachedFilter(column);return!!filterWrapper&&filterWrapper.filterPromise.resolveNow(!1,filter=>filter.isFilterActive())}getOrCreateFilterWrapper(column,source){if(!column.isFilterAllowed())return null;let filterWrapper=this.cachedFilter(column);return filterWrapper?source!=="NO_UI"&&this.putIntoGui(filterWrapper,source):(filterWrapper=this.createFilterWrapper(column,source),this.setColumnFilterWrapper(column,filterWrapper)),filterWrapper}cachedFilter(column){return this.allColumnFilters.get(column.getColId())}getDefaultFilter(column){let defaultFilter;if(ModuleRegistry.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))defaultFilter="agSetColumnFilter";else{const cellDataType=this.dataTypeService.getBaseDataType(column);cellDataType==="number"?defaultFilter="agNumberColumnFilter":cellDataType==="date"||cellDataType==="dateString"?defaultFilter="agDateColumnFilter":defaultFilter="agTextColumnFilter"}return defaultFilter}getDefaultFloatingFilter(column){let defaultFloatingFilterType;if(ModuleRegistry.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))defaultFloatingFilterType="agSetColumnFloatingFilter";else{const cellDataType=this.dataTypeService.getBaseDataType(column);cellDataType==="number"?defaultFloatingFilterType="agNumberColumnFloatingFilter":cellDataType==="date"||cellDataType==="dateString"?defaultFloatingFilterType="agDateColumnFloatingFilter":defaultFloatingFilterType="agTextColumnFloatingFilter"}return defaultFloatingFilterType}createFilterInstance(column){const defaultFilter=this.getDefaultFilter(column),colDef=column.getColDef();let filterInstance;const params=__spreadProps(__spreadValues({},this.createFilterParams(column,colDef)),{filterModifiedCallback:()=>this.filterModifiedCallbackFactory(filterInstance,column)(),filterChangedCallback:additionalEventAttributes=>this.filterChangedCallbackFactory(filterInstance,column)(additionalEventAttributes),doesRowPassOtherFilter:node=>this.doesRowPassOtherFilters(filterInstance,node)}),compDetails=this.userComponentFactory.getFilterDetails(colDef,params,defaultFilter);return compDetails?{filterPromise:()=>{const filterPromise=compDetails.newAgStackInstance();return filterPromise&&filterPromise.then(r=>filterInstance=r),filterPromise},compDetails}:{filterPromise:null,compDetails:null}}createFilterParams(column,colDef){return this.gridOptionsService.addGridCommonParams({column,colDef:cloneObject(colDef),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(column),getValue:this.createGetValue(column),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(column,source){var _a273;const filterWrapper={column,filterPromise:null,compiledElement:null,guiPromise:AgPromise.resolve(null),compDetails:null},{filterPromise,compDetails}=this.createFilterInstance(column);return filterWrapper.filterPromise=(_a273=filterPromise==null?void 0:filterPromise())!=null?_a273:null,filterWrapper.compDetails=compDetails,filterPromise&&this.putIntoGui(filterWrapper,source),filterWrapper}putIntoGui(filterWrapper,source){const eFilterGui=document.createElement("div");eFilterGui.className="ag-filter",filterWrapper.guiPromise=new AgPromise(resolve=>{filterWrapper.filterPromise.then(filter=>{let guiFromFilter=filter.getGui();exists(guiFromFilter)||console.warn(`AG Grid: getGui method from filter returned ${guiFromFilter}, it should be a DOM element or an HTML template string.`),typeof guiFromFilter=="string"&&(guiFromFilter=loadTemplate(guiFromFilter)),eFilterGui.appendChild(guiFromFilter),resolve(eFilterGui);const event={type:Events.EVENT_FILTER_OPENED,column:filterWrapper.column,source,eGui:eFilterGui};this.eventService.dispatchEvent(event)})})}onColumnsChanged(){const columns=[];this.allColumnFilters.forEach((wrapper,colId)=>{let currentColumn;wrapper.column.isPrimary()?currentColumn=this.columnModel.getPrimaryColumn(colId):currentColumn=this.columnModel.getGridColumn(colId),!currentColumn&&(columns.push(wrapper.column),this.disposeFilterWrapper(wrapper,"columnChanged"),this.disposeColumnListener(colId))}),columns.length>0?this.onFilterChanged({columns,source:"api"}):this.updateDependantFilters()}updateDependantFilters(){const groupColumns=this.columnModel.getGroupAutoColumns();groupColumns==null||groupColumns.forEach(groupColumn=>{groupColumn.getColDef().filter==="agGroupColumnFilter"&&this.getOrCreateFilterWrapper(groupColumn,"NO_UI")})}isFilterAllowed(column){var _a273,_b;if(this.isAdvancedFilterEnabled()||!column.isFilterAllowed())return!1;const filterWrapper=this.allColumnFilters.get(column.getColId());return(_b=(_a273=filterWrapper==null?void 0:filterWrapper.filterPromise)==null?void 0:_a273.resolveNow(!0,filter=>typeof(filter==null?void 0:filter.isFilterAllowed)=="function"?filter==null?void 0:filter.isFilterAllowed():!0))!=null?_b:!0}getFloatingFilterCompDetails(column,showParentFilter){const parentFilterInstance=__name(callback=>{const filterComponent=this.getFilterComponent(column,"NO_UI");filterComponent!=null&&filterComponent.then(instance=>{callback(unwrapUserComp(instance))})},"parentFilterInstance"),colDef=column.getColDef(),filterParams=__spreadProps(__spreadValues({},this.createFilterParams(column,colDef)),{filterChangedCallback:()=>parentFilterInstance(filterInstance=>this.filterChangedCallbackFactory(filterInstance,column)())}),finalFilterParams=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(colDef,FilterComponent,filterParams);let defaultFloatingFilterType=this.userComponentFactory.getDefaultFloatingFilterType(colDef,()=>this.getDefaultFloatingFilter(column));defaultFloatingFilterType==null&&(defaultFloatingFilterType="agReadOnlyFloatingFilter");const params={column,filterParams:finalFilterParams,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(column),parentFilterInstance,showParentFilter,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(colDef,params,defaultFloatingFilterType)}getCurrentFloatingFilterParentModel(column){const filterComponent=this.getFilterComponent(column,"NO_UI",!1);return filterComponent?filterComponent.resolveNow(null,filter=>filter&&filter.getModel()):null}destroyFilter(column,source="api"){const colId=column.getColId(),filterWrapper=this.allColumnFilters.get(colId);this.disposeColumnListener(colId),delete this.initialFilterModel[colId],filterWrapper&&(this.disposeFilterWrapper(filterWrapper,source),this.onFilterChanged({columns:[column],source:"api"}))}disposeColumnListener(colId){const columnListener=this.allColumnListeners.get(colId);columnListener&&(this.allColumnListeners.delete(colId),columnListener())}disposeFilterWrapper(filterWrapper,source){filterWrapper.filterPromise.then(filter=>{this.getContext().destroyBean(filter),filterWrapper.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(filterWrapper.column.getColId());const event={type:Events.EVENT_FILTER_DESTROYED,source,column:filterWrapper.column};this.eventService.dispatchEvent(event)})}filterModifiedCallbackFactory(filter,column){return()=>{const event={type:Events.EVENT_FILTER_MODIFIED,column,filterInstance:filter};this.eventService.dispatchEvent(event)}}filterChangedCallbackFactory(filter,column){return additionalEventAttributes=>{var _a273;const source=(_a273=additionalEventAttributes==null?void 0:additionalEventAttributes.source)!=null?_a273:"api",params={filter,additionalEventAttributes,columns:[column],source};this.callOnFilterChangedOutsideRenderCycle(params)}}checkDestroyFilter(colId){const filterWrapper=this.allColumnFilters.get(colId);if(!filterWrapper)return;const column=filterWrapper.column,{compDetails}=column.isFilterAllowed()?this.createFilterInstance(column):{compDetails:null};if(this.areFilterCompsDifferent(filterWrapper.compDetails,compDetails)){this.destroyFilter(column,"paramsUpdated");return}const newFilterParams=column.getColDef().filterParams;if(!filterWrapper.filterPromise){this.destroyFilter(column,"paramsUpdated");return}filterWrapper.filterPromise.then(filter=>{(filter!=null&&filter.refresh?filter.refresh(__spreadValues(__spreadProps(__spreadValues({},this.createFilterParams(column,column.getColDef())),{filterModifiedCallback:this.filterModifiedCallbackFactory(filter,column),filterChangedCallback:this.filterChangedCallbackFactory(filter,column),doesRowPassOtherFilter:node=>this.doesRowPassOtherFilters(filter,node)}),newFilterParams)):!0)===!1&&this.destroyFilter(column,"paramsUpdated")})}setColumnFilterWrapper(column,filterWrapper){const colId=column.getColId();this.allColumnFilters.set(colId,filterWrapper),this.allColumnListeners.set(colId,this.addManagedListener(column,Column.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(colId)))}areFilterCompsDifferent(oldCompDetails,newCompDetails){if(!newCompDetails||!oldCompDetails)return!0;const{componentClass:oldComponentClass}=oldCompDetails,{componentClass:newComponentClass}=newCompDetails;return!(oldComponentClass===newComponentClass||(oldComponentClass==null?void 0:oldComponentClass.render)&&(newComponentClass==null?void 0:newComponentClass.render)&&oldComponentClass.render===newComponentClass.render)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(expression){if(this.isAdvancedFilterEnabled()){if(this.dataTypeService.isPendingInference()){this.advancedFilterModelUpdateQueue.push(expression);return}this.advancedFilterService.setModel(expression??null),this.onFilterChanged({source:"advancedFilter"})}}showAdvancedFilterBuilder(source){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder(source,!0)}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvancedFilterEnabled()?!1:this.columnModel.getAllGridColumns().some(col=>col.getColDef().floatingFilter)}getFilterInstance(key,callback){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}const res=this.getFilterInstanceImpl(key,instance=>{if(!callback)return;const unwrapped2=unwrapUserComp(instance);callback(unwrapped2)});return unwrapUserComp(res)}getColumnFilterInstance(key){return new Promise(resolve=>{this.getFilterInstance(key,filter=>{resolve(filter)})})}getFilterInstanceImpl(key,callback){const column=this.columnModel.getPrimaryColumn(key);if(!column)return;const filterPromise=this.getFilterComponent(column,"NO_UI"),currentValue=filterPromise&&filterPromise.resolveNow(null,filterComp=>filterComp);return currentValue?setTimeout(callback,0,currentValue):filterPromise&&filterPromise.then(comp=>{callback(comp)}),currentValue}warnAdvancedFilters(){warnOnce("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(eCompToInsertBefore){var _a273;(_a273=this.advancedFilterService)==null||_a273.getCtrl().setupHeaderComp(eCompToInsertBefore)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model,source})=>this.setFilterModel(model,source)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key,model,resolve})=>{this.setColumnFilterModel(key,model).then(()=>resolve())}),this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue.forEach(model=>this.setAdvancedFilterModel(model)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(key){const filterWrapper=this.getFilterWrapper(key);return filterWrapper?this.getModelFromFilterWrapper(filterWrapper):null}setColumnFilterModel(key,model){if(this.isAdvancedFilterEnabled())return this.warnAdvancedFilters(),Promise.resolve();if(this.dataTypeService.isPendingInference()){let resolve=__name(()=>{},"resolve");const promise=new Promise(res=>{resolve=res});return this.columnFilterModelUpdateQueue.push({key,model,resolve}),promise}const column=this.columnModel.getPrimaryColumn(key),filterWrapper=column?this.getOrCreateFilterWrapper(column,"NO_UI"):null;return filterWrapper?__name(promise=>new Promise(resolve=>{promise.then(result=>resolve(result))}),"convertPromise")(this.setModelOnFilterWrapper(filterWrapper.filterPromise,model)):Promise.resolve()}getFilterWrapper(key){var _a273;const column=this.columnModel.getPrimaryColumn(key);return column&&(_a273=this.cachedFilter(column))!=null?_a273:null}destroy(){super.destroy(),this.allColumnFilters.forEach(filterWrapper=>this.disposeFilterWrapper(filterWrapper,"gridDestroyed")),this.allColumnListeners.clear()}},__name(_a104,"FilterManager"),_a104);__decorateClass([Autowired("valueService")],FilterManager.prototype,"valueService",2);__decorateClass([Autowired("columnModel")],FilterManager.prototype,"columnModel",2);__decorateClass([Autowired("rowModel")],FilterManager.prototype,"rowModel",2);__decorateClass([Autowired("userComponentFactory")],FilterManager.prototype,"userComponentFactory",2);__decorateClass([Autowired("rowRenderer")],FilterManager.prototype,"rowRenderer",2);__decorateClass([Autowired("dataTypeService")],FilterManager.prototype,"dataTypeService",2);__decorateClass([Autowired("quickFilterService")],FilterManager.prototype,"quickFilterService",2);__decorateClass([Optional("advancedFilterService")],FilterManager.prototype,"advancedFilterService",2);__decorateClass([PostConstruct],FilterManager.prototype,"init",1);FilterManager=__decorateClass([Bean("filterManager")],FilterManager);var _a105,AbstractHeaderCellComp=(_a105=class extends Component{constructor(template,ctrl){super(template),this.ctrl=ctrl}getCtrl(){return this.ctrl}},__name(_a105,"AbstractHeaderCellComp"),_a105),_a106,_HeaderFilterCellComp=(_a106=class extends AbstractHeaderCellComp{constructor(ctrl){super(_a106.TEMPLATE,ctrl)}postConstruct(){const eGui=this.getGui(),compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),addOrRemoveBodyCssClass:(cssClassName,on)=>this.eFloatingFilterBody.classList.toggle(cssClassName,on),setButtonWrapperDisplayed:displayed=>setDisplayed(this.eButtonWrapper,displayed),setCompDetails:compDetails=>this.setCompDetails(compDetails),getFloatingFilterComp:()=>this.compPromise,setWidth:width=>eGui.style.width=width,setMenuIcon:eIcon=>this.eButtonShowMainFilter.appendChild(eIcon)};this.ctrl.setComp(compProxy,eGui,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(compDetails){if(!compDetails){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=compDetails.newAgStackInstance(),this.compPromise.then(comp=>this.afterCompCreated(comp))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(comp){if(comp){if(!this.isAlive()){this.destroyBean(comp);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=comp,this.eFloatingFilterBody.appendChild(comp.getGui()),comp.afterGuiAttached&&comp.afterGuiAttached()}}},__name(_a106,"_HeaderFilterCellComp"),_a106);_HeaderFilterCellComp.TEMPLATE=`<div class="ag-header-cell ag-floating-filter" role="gridcell">
            <div ref="eFloatingFilterBody" role="presentation"></div>
            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">
                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>
            </div>
        </div>`;__decorateClass([RefSelector("eFloatingFilterBody")],_HeaderFilterCellComp.prototype,"eFloatingFilterBody",2);__decorateClass([RefSelector("eButtonWrapper")],_HeaderFilterCellComp.prototype,"eButtonWrapper",2);__decorateClass([RefSelector("eButtonShowMainFilter")],_HeaderFilterCellComp.prototype,"eButtonShowMainFilter",2);__decorateClass([PostConstruct],_HeaderFilterCellComp.prototype,"postConstruct",1);__decorateClass([PreDestroy],_HeaderFilterCellComp.prototype,"destroyFloatingFilterComp",1);var HeaderFilterCellComp=_HeaderFilterCellComp,_a107,LayoutFeature=(_a107=class extends BeanStub{constructor(view){super(),this.view=view}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const domLayout=this.getDomLayout(),params={autoHeight:domLayout==="autoHeight",normal:domLayout==="normal",print:domLayout==="print"},cssClass=params.autoHeight?"ag-layout-auto-height":params.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(cssClass,params)}getDomLayout(){var _a273;const domLayout=(_a273=this.gridOptionsService.get("domLayout"))!=null?_a273:"normal";return["normal","print","autoHeight"].indexOf(domLayout)===-1?(warnOnce(`${domLayout} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):domLayout}},__name(_a107,"LayoutFeature"),_a107);__decorateClass([PostConstruct],LayoutFeature.prototype,"postConstruct",1);var _a108,GridBodyScrollFeature=(_a108=class extends BeanStub{constructor(eBodyViewport){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=eBodyViewport,this.resetLastHScrollDebounced=debounce(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=debounce(()=>this.lastScrollSource[0]=null,500)}postConstruct(){this.enableRtl=this.gridOptionsService.get("enableRtl"),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(p=>{this.centerRowContainerCtrl=p.centerRowContainerCtrl,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const fakeHScroll=this.ctrlsService.getFakeHScrollComp(),fakeVScroll=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),fakeHScroll.onScrollCallback(this.onFakeHScroll.bind(this));const isDebounce=this.gridOptionsService.get("debounceVerticalScrollbar"),onVScroll=isDebounce?debounce(this.onVScroll.bind(this),100):this.onVScroll.bind(this),onFakeVScroll=isDebounce?debounce(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",onVScroll),fakeVScroll.onScrollCallback(onFakeVScroll)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(scrollLeft){if(this.centerRowContainerCtrl==null)return;scrollLeft===void 0&&(scrollLeft=this.centerRowContainerCtrl.getCenterViewportScrollLeft());const offset=this.enableRtl?scrollLeft:-scrollLeft,topCenterContainer=this.ctrlsService.getTopCenterRowContainerCtrl(),stickyTopCenterContainer=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),bottomCenterContainer=this.ctrlsService.getBottomCenterRowContainerCtrl(),fakeHScroll=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-offset),bottomCenterContainer.setContainerTranslateX(offset),topCenterContainer.setContainerTranslateX(offset),stickyTopCenterContainer.setContainerTranslateX(offset);const centerViewport=this.centerRowContainerCtrl.getViewportElement(),isCenterViewportLastHorizontal=this.lastScrollSource[1]===0;scrollLeft=Math.abs(scrollLeft),isCenterViewportLastHorizontal?fakeHScroll.setScrollPosition(scrollLeft):setScrollLeft(centerViewport,scrollLeft,this.enableRtl)}isControllingScroll(source,direction){return this.lastScrollSource[direction]==null?(this.lastScrollSource[direction]=source,!0):this.lastScrollSource[direction]===source}onFakeHScroll(){this.isControllingScroll(1,1)&&this.onHScrollCommon(1)}onHScroll(){this.isControllingScroll(0,1)&&this.onHScrollCommon(0)}onHScrollCommon(source){const centerContainerViewport=this.centerRowContainerCtrl.getViewportElement(),{scrollLeft}=centerContainerViewport;if(this.shouldBlockScrollUpdate(1,scrollLeft,!0))return;let newScrollLeft;source===0?newScrollLeft=getScrollLeft(centerContainerViewport,this.enableRtl):newScrollLeft=this.ctrlsService.getFakeHScrollComp().getScrollPosition(),this.doHorizontalScroll(Math.round(newScrollLeft)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(1,0)&&this.onVScrollCommon(1)}onVScroll(){this.isControllingScroll(0,0)&&this.onVScrollCommon(0)}onVScrollCommon(source){let scrollTop;source===0?scrollTop=this.eBodyViewport.scrollTop:scrollTop=this.ctrlsService.getFakeVScrollComp().getScrollPosition(),!this.shouldBlockScrollUpdate(0,scrollTop,!0)&&(this.animationFrameService.setScrollTop(scrollTop),this.nextScrollTop=scrollTop,source===0?this.ctrlsService.getFakeVScrollComp().setScrollPosition(scrollTop):this.eBodyViewport.scrollTop=scrollTop,this.gridOptionsService.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(scrollLeft){const fakeScrollLeft=this.ctrlsService.getFakeHScrollComp().getScrollPosition();this.scrollLeft===scrollLeft&&scrollLeft===fakeScrollLeft||(this.scrollLeft=scrollLeft,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(scrollLeft),this.centerRowContainerCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(direction){const bodyScrollEvent={type:Events.EVENT_BODY_SCROLL,direction:direction===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(bodyScrollEvent),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const bodyScrollEndEvent=__spreadProps(__spreadValues({},bodyScrollEvent),{type:Events.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(bodyScrollEndEvent)},100)}shouldBlockScrollUpdate(direction,scrollTo,touchOnly=!1){return touchOnly&&!isIOSUserAgent()?!1:direction===0?this.shouldBlockVerticalScroll(scrollTo):this.shouldBlockHorizontalScroll(scrollTo)}shouldBlockVerticalScroll(scrollTo){const clientHeight=getInnerHeight(this.eBodyViewport),{scrollHeight}=this.eBodyViewport;return scrollTo<0||scrollTo+clientHeight>scrollHeight}shouldBlockHorizontalScroll(scrollTo){const clientWidth=this.centerRowContainerCtrl.getCenterWidth(),{scrollWidth}=this.centerRowContainerCtrl.getViewportElement();if(this.enableRtl&&isRtlNegativeScroll()){if(scrollTo>0)return!0}else if(scrollTo<0)return!0;return Math.abs(scrollTo)+clientWidth>scrollWidth}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(0)}scrollGridIfNeeded(){const frameNeeded=this.scrollTop!=this.nextScrollTop;return frameNeeded&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),frameNeeded}setHorizontalScrollPosition(hScrollPosition,fromAlignedGridsService=!1){const maxScrollLeft=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();!fromAlignedGridsService&&this.shouldBlockScrollUpdate(1,hScrollPosition)&&(this.enableRtl&&isRtlNegativeScroll()?hScrollPosition=hScrollPosition>0?0:maxScrollLeft:hScrollPosition=Math.min(Math.max(hScrollPosition,0),maxScrollLeft)),setScrollLeft(this.centerRowContainerCtrl.getViewportElement(),Math.abs(hScrollPosition),this.enableRtl),this.doHorizontalScroll(hScrollPosition)}setVerticalScrollPosition(vScrollPosition){this.eBodyViewport.scrollTop=vScrollPosition}getVScrollPosition(){return this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight,{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowContainerCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()}scrollHorizontally(pixels){const oldScrollPosition=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(oldScrollPosition+pixels),this.centerRowContainerCtrl.getViewportElement().scrollLeft-oldScrollPosition}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(comparator,position=null){const rowCount=this.rowModel.getRowCount();let indexToSelect=-1;for(let i=0;i<rowCount;i++){const node=this.rowModel.getRow(i);if(typeof comparator=="function"){if(node&&comparator(node)){indexToSelect=i;break}}else if(comparator===node||comparator===node.data){indexToSelect=i;break}}indexToSelect>=0&&this.ensureIndexVisible(indexToSelect,position)}ensureIndexVisible(index,position){if(this.gridOptionsService.isDomLayout("print"))return;const rowCount=this.paginationProxy.getRowCount();if(typeof index!="number"||index<0||index>=rowCount){console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+index);return}const paginationPanelEnabled=this.gridOptionsService.get("pagination")&&!this.gridOptionsService.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{paginationPanelEnabled||this.paginationProxy.goToPageWithIndex(index);const stickyTopHeight=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),rowNode=this.paginationProxy.getRow(index);let rowGotShiftedDuringOperation;do{const startingRowTop=rowNode.rowTop,startingRowHeight=rowNode.rowHeight,paginationOffset=this.paginationProxy.getPixelOffset(),rowTopPixel=rowNode.rowTop-paginationOffset,rowBottomPixel=rowTopPixel+rowNode.rowHeight,scrollPosition=this.getVScrollPosition(),heightOffset=this.heightScaler.getDivStretchOffset(),vScrollTop=scrollPosition.top+heightOffset,vScrollBottom=scrollPosition.bottom+heightOffset,viewportHeight=vScrollBottom-vScrollTop,pxTop=this.heightScaler.getScrollPositionForPixel(rowTopPixel),pxBottom=this.heightScaler.getScrollPositionForPixel(rowBottomPixel-viewportHeight),pxMiddle=Math.min((pxTop+pxBottom)/2,rowTopPixel),rowAboveViewport=vScrollTop+stickyTopHeight>rowTopPixel,rowBelowViewport=vScrollBottom<rowBottomPixel;let newScrollPosition=null;position==="top"?newScrollPosition=pxTop:position==="bottom"?newScrollPosition=pxBottom:position==="middle"?newScrollPosition=pxMiddle:rowAboveViewport?newScrollPosition=pxTop-stickyTopHeight:rowBelowViewport&&(newScrollPosition=pxBottom),newScrollPosition!==null&&(this.setVerticalScrollPosition(newScrollPosition),this.rowRenderer.redraw({afterScroll:!0})),rowGotShiftedDuringOperation=startingRowTop!==rowNode.rowTop||startingRowHeight!==rowNode.rowHeight}while(rowGotShiftedDuringOperation);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(key,position="auto"){const column=this.columnModel.getGridColumn(key);if(!column||column.isPinned()||!this.columnModel.isColumnDisplayed(column))return;const newHorizontalScroll=this.getPositionedHorizontalScroll(column,position);this.getFrameworkOverrides().wrapIncoming(()=>{newHorizontalScroll!==null&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(newHorizontalScroll),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(top,left){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowContainerCtrl.setCenterViewportScrollLeft(left),this.setVerticalScrollPosition(top),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(column,position){const{columnBeforeStart,columnAfterEnd}=this.isColumnOutsideViewport(column),viewportTooSmallForColumn=this.centerRowContainerCtrl.getCenterWidth()<column.getActualWidth(),viewportWidth=this.centerRowContainerCtrl.getCenterWidth(),isRtl=this.enableRtl;let alignColToStart=(isRtl?columnBeforeStart:columnAfterEnd)||viewportTooSmallForColumn,alignColToEnd=isRtl?columnAfterEnd:columnBeforeStart;position!=="auto"&&(alignColToStart=position==="start",alignColToEnd=position==="end");const isMiddle=position==="middle";if(alignColToStart||alignColToEnd||isMiddle){const{colLeft,colMiddle,colRight}=this.getColumnBounds(column);return isMiddle?colMiddle-viewportWidth/2:alignColToStart?isRtl?colRight:colLeft:isRtl?colLeft-viewportWidth:colRight-viewportWidth}return null}isColumnOutsideViewport(column){const{start:viewportStart,end:viewportEnd}=this.getViewportBounds(),{colLeft,colRight}=this.getColumnBounds(column),isRtl=this.enableRtl,columnBeforeStart=isRtl?viewportStart>colRight:viewportEnd<colRight,columnAfterEnd=isRtl?viewportEnd<colLeft:viewportStart>colLeft;return{columnBeforeStart,columnAfterEnd}}getColumnBounds(column){const isRtl=this.enableRtl,bodyWidth=this.columnModel.getBodyContainerWidth(),colWidth=column.getActualWidth(),colLeft=column.getLeft(),multiplier=isRtl?-1:1,colLeftPixel=isRtl?bodyWidth-colLeft:colLeft,colRightPixel=colLeftPixel+colWidth*multiplier,colMidPixel=colLeftPixel+colWidth/2*multiplier;return{colLeft:colLeftPixel,colMiddle:colMidPixel,colRight:colRightPixel}}getViewportBounds(){const viewportWidth=this.centerRowContainerCtrl.getCenterWidth(),scrollPosition=this.centerRowContainerCtrl.getCenterViewportScrollLeft(),viewportStartPixel=scrollPosition,viewportEndPixel=viewportWidth+scrollPosition;return{start:viewportStartPixel,end:viewportEndPixel,width:viewportWidth}}},__name(_a108,"GridBodyScrollFeature"),_a108);__decorateClass([Autowired("ctrlsService")],GridBodyScrollFeature.prototype,"ctrlsService",2);__decorateClass([Autowired("animationFrameService")],GridBodyScrollFeature.prototype,"animationFrameService",2);__decorateClass([Autowired("paginationProxy")],GridBodyScrollFeature.prototype,"paginationProxy",2);__decorateClass([Autowired("rowModel")],GridBodyScrollFeature.prototype,"rowModel",2);__decorateClass([Autowired("rowContainerHeightService")],GridBodyScrollFeature.prototype,"heightScaler",2);__decorateClass([Autowired("rowRenderer")],GridBodyScrollFeature.prototype,"rowRenderer",2);__decorateClass([Autowired("columnModel")],GridBodyScrollFeature.prototype,"columnModel",2);__decorateClass([PostConstruct],GridBodyScrollFeature.prototype,"postConstruct",1);var CSS_CLASS_FORCE_VERTICAL_SCROLL="ag-force-vertical-scroll",CSS_CLASS_CELL_SELECTABLE="ag-selectable",CSS_CLASS_COLUMN_MOVING="ag-column-moving",_a109,GridBodyCtrl=(_a109=class extends BeanStub{constructor(){super(...arguments),this.stickyTopHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(comp,eGridBody,eBodyViewport,eTop,eBottom,eStickyTop){this.comp=comp,this.eGridBody=eGridBody,this.eBodyViewport=eBodyViewport,this.eTop=eTop,this.eBottom=eBottom,this.eStickyTop=eStickyTop,this.setCellTextSelection(this.gridOptionsService.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",props=>this.setCellTextSelection(props.currentValue)),this.createManagedBean(new LayoutFeature(this.comp)),this.bodyScrollFeature=this.createManagedBean(new GridBodyScrollFeature(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([eTop,eBodyViewport,eBottom,eStickyTop]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(eTop),this.ctrlsService.registerGridBodyCtrl(this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(elements){elements.forEach(element=>{this.addManagedListener(element,"focusin",e=>{const{target}=e,isFocusedElementNested=isElementChildOfClass(target,"ag-root",element);element.classList.toggle("ag-has-focus",!isFocusedElementNested)}),this.addManagedListener(element,"focusout",e=>{const{target,relatedTarget}=e,gridContainRelatedTarget=element.contains(relatedTarget),isNestedRelatedTarget=isElementChildOfClass(relatedTarget,"ag-root",element);isElementChildOfClass(target,"ag-root",element)||(!gridContainRelatedTarget||isNestedRelatedTarget)&&element.classList.remove("ag-has-focus")})})}setColumnMovingCss(moving){this.comp.setColumnMovingCss(CSS_CLASS_COLUMN_MOVING,moving)}setCellTextSelection(selectable=!1){this.comp.setCellSelectableCss(CSS_CLASS_CELL_SELECTABLE,selectable)}onScrollVisibilityChanged(){const visible=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(visible),this.setStickyTopWidth(visible);const scrollbarWidth=visible&&this.gridOptionsService.getScrollbarWidth()||0,pad=isInvisibleScrollbar()?16:0,width=`calc(100% + ${scrollbarWidth+pad}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(width))}onGridColumnsChanged(){const columns=this.columnModel.getAllGridColumns();this.comp.setColumnCount(columns.length)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",event=>{if(event.target instanceof HTMLImageElement)return event.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gridOptionsService.get("stopEditingWhenCellsLoseFocus"))return;const focusOutListener=__name(event=>{const elementWithFocus=event.relatedTarget;if(getTabIndex(elementWithFocus)===null){this.rowRenderer.stopEditing();return}let clickInsideGrid=viewports.some(viewport=>viewport.contains(elementWithFocus))&&this.mouseEventService.isElementInThisGrid(elementWithFocus);if(!clickInsideGrid){const popupService=this.popupService;clickInsideGrid=popupService.getActivePopups().some(popup=>popup.contains(elementWithFocus))||popupService.isElementWithinCustomPopup(elementWithFocus)}clickInsideGrid||this.rowRenderer.stopEditing()},"focusOutListener"),viewports=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];viewports.forEach(viewport=>this.addManagedListener(viewport,"focusout",focusOutListener))}updateRowCount(){const headerCount=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),rowCount=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,total=rowCount===-1?-1:headerCount+rowCount;this.comp.setRowCount(total)}registerBodyViewportResizeListener(listener){this.comp.registerBodyViewportResizeListener(listener)}setVerticalScrollPaddingVisible(visible){const overflowY=visible?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(overflowY)}isVerticalScrollShowing(){const show=this.gridOptionsService.get("alwaysShowVerticalScroll"),cssClass=show?CSS_CLASS_FORCE_VERTICAL_SCROLL:null,allowVerticalScroll=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(cssClass,show),show||allowVerticalScroll&&isVerticalScrollShowing(this.eBodyViewport)}setupRowAnimationCssClass(){const listener=__name(()=>{const animateRows=this.gridOptionsService.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),animateRowsCssClass=animateRows?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(animateRowsCssClass,animateRows)},"listener");listener(),this.addManagedListener(this.eventService,Events.EVENT_HEIGHT_SCALE_CHANGED,listener),this.addManagedPropertyListener("animateRows",listener)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const listener=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",listener),this.mockContextMenuForIPad(listener),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const fullWidthContainer=this.eBodyViewport.querySelector(".ag-full-width-container"),eCenterColsViewport=this.eBodyViewport.querySelector(".ag-center-cols-viewport");fullWidthContainer&&eCenterColsViewport&&this.addManagedListener(fullWidthContainer,"wheel",e=>this.onFullWidthContainerWheel(e,eCenterColsViewport))}onFullWidthContainerWheel(e,eCenterColsViewport){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),eCenterColsViewport.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(mouseEvent,touch,touchEvent){if(!mouseEvent&&!touchEvent)return;this.gridOptionsService.get("preventDefaultOnContextMenu")&&(mouseEvent||touchEvent).preventDefault();const{target}=mouseEvent||touch;(target===this.eBodyViewport||target===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement())&&this.menuService.showContextMenu({mouseEvent,touchEvent,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(listener){if(!isIOSUserAgent())return;const touchListener=new TouchListener(this.eBodyViewport),longTapListener=__name(event=>{listener(void 0,event.touchStart,event.touchEvent)},"longTapListener");this.addManagedListener(touchListener,TouchListener.EVENT_LONG_TAP,longTapListener),this.addDestroyFunc(()=>touchListener.destroy())}onBodyViewportWheel(e){this.gridOptionsService.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyTopWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(pixels){const oldScrollPosition=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(oldScrollPosition+pixels),this.eBodyViewport.scrollTop-oldScrollPosition}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new RowDragFeature(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel}=this;let floatingTopHeight=pinnedRowModel.getPinnedTopTotalHeight(),floatingBottomHeight=pinnedRowModel.getPinnedBottomTotalHeight();this.comp.setTopHeight(floatingTopHeight),this.comp.setBottomHeight(floatingBottomHeight),this.comp.setTopDisplay(floatingTopHeight?"inherit":"none"),this.comp.setBottomDisplay(floatingBottomHeight?"inherit":"none"),this.setStickyTopOffsetTop()}setStickyTopHeight(height=0){this.comp.setStickyTopHeight(`${height}px`),this.stickyTopHeight=height}getStickyTopHeight(){return this.stickyTopHeight}setStickyTopWidth(vScrollVisible){if(!vScrollVisible)this.comp.setStickyTopWidth("100%");else{const scrollbarWidth=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${scrollbarWidth}px)`)}}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const headerHeight=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight()+this.filterManager.getHeaderHeight(),pinnedTopHeight=this.pinnedRowModel.getPinnedTopTotalHeight();let height=0;headerHeight>0&&(height+=headerHeight+1),pinnedTopHeight>0&&(height+=pinnedTopHeight+1),this.comp.setStickyTopTop(`${height}px`)}sizeColumnsToFit(params,nextTimeout){const scrollWidthToRemove=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,availableWidth=getInnerWidth(this.eGridBody)-scrollWidthToRemove;if(availableWidth>0){this.columnModel.sizeColumnsToFit(availableWidth,"sizeColumnsToFit",!1,params);return}nextTimeout===void 0?window.setTimeout(()=>{this.sizeColumnsToFit(params,100)},0):nextTimeout===100?window.setTimeout(()=>{this.sizeColumnsToFit(params,500)},100):nextTimeout===500?window.setTimeout(()=>{this.sizeColumnsToFit(params,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(listener){this.eBodyViewport.addEventListener("scroll",listener,{passive:!0})}removeScrollEventListener(listener){this.eBodyViewport.removeEventListener("scroll",listener)}},__name(_a109,"GridBodyCtrl"),_a109);__decorateClass([Autowired("animationFrameService")],GridBodyCtrl.prototype,"animationFrameService",2);__decorateClass([Autowired("rowContainerHeightService")],GridBodyCtrl.prototype,"rowContainerHeightService",2);__decorateClass([Autowired("ctrlsService")],GridBodyCtrl.prototype,"ctrlsService",2);__decorateClass([Autowired("columnModel")],GridBodyCtrl.prototype,"columnModel",2);__decorateClass([Autowired("scrollVisibleService")],GridBodyCtrl.prototype,"scrollVisibleService",2);__decorateClass([Autowired("menuService")],GridBodyCtrl.prototype,"menuService",2);__decorateClass([Autowired("headerNavigationService")],GridBodyCtrl.prototype,"headerNavigationService",2);__decorateClass([Autowired("dragAndDropService")],GridBodyCtrl.prototype,"dragAndDropService",2);__decorateClass([Autowired("pinnedRowModel")],GridBodyCtrl.prototype,"pinnedRowModel",2);__decorateClass([Autowired("rowRenderer")],GridBodyCtrl.prototype,"rowRenderer",2);__decorateClass([Autowired("popupService")],GridBodyCtrl.prototype,"popupService",2);__decorateClass([Autowired("mouseEventService")],GridBodyCtrl.prototype,"mouseEventService",2);__decorateClass([Autowired("rowModel")],GridBodyCtrl.prototype,"rowModel",2);__decorateClass([Autowired("filterManager")],GridBodyCtrl.prototype,"filterManager",2);var CSS_CELL_RANGE_SELECTED="ag-cell-range-selected",CSS_CELL_RANGE_CHART="ag-cell-range-chart",CSS_CELL_RANGE_SINGLE_CELL="ag-cell-range-single-cell",CSS_CELL_RANGE_CHART_CATEGORY="ag-cell-range-chart-category",CSS_CELL_RANGE_HANDLE="ag-cell-range-handle",CSS_CELL_RANGE_TOP="ag-cell-range-top",CSS_CELL_RANGE_RIGHT="ag-cell-range-right",CSS_CELL_RANGE_BOTTOM="ag-cell-range-bottom",CSS_CELL_RANGE_LEFT="ag-cell-range-left",_a110,CellRangeFeature=(_a110=class{constructor(beans,ctrl){this.beans=beans,this.cellCtrl=ctrl}setComp(cellComp,eGui){this.cellComp=cellComp,this.eGui=eGui,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SELECTED,this.rangeCount!==0),this.cellComp.addOrRemoveCssClass(`${CSS_CELL_RANGE_SELECTED}-1`,this.rangeCount===1),this.cellComp.addOrRemoveCssClass(`${CSS_CELL_RANGE_SELECTED}-2`,this.rangeCount===2),this.cellComp.addOrRemoveCssClass(`${CSS_CELL_RANGE_SELECTED}-3`,this.rangeCount===3),this.cellComp.addOrRemoveCssClass(`${CSS_CELL_RANGE_SELECTED}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_CHART,this.hasChartRange),setAriaSelected(this.eGui,this.rangeCount>0?!0:void 0),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SINGLE_CELL,this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const rangeBorders=this.getRangeBorders(),isSingleCell=this.isSingleCell(),isTop=!isSingleCell&&rangeBorders.top,isRight=!isSingleCell&&rangeBorders.right,isBottom=!isSingleCell&&rangeBorders.bottom,isLeft=!isSingleCell&&rangeBorders.left;this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_TOP,isTop),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_RIGHT,isRight),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_BOTTOM,isBottom),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_LEFT,isLeft)}isSingleCell(){const{rangeService}=this.beans;return this.rangeCount===1&&rangeService&&!rangeService.isMoreThanOneCell()}getHasChartRange(){const{rangeService}=this.beans;if(!this.rangeCount||!rangeService)return!1;const cellRanges=rangeService.getCellRanges();return cellRanges.length>0&&cellRanges.every(range=>includes([1,0],range.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const isRtl=this.beans.gridOptionsService.get("enableRtl");let top=!1,right=!1,bottom=!1,left=!1;const thisCol=this.cellCtrl.getCellPosition().column,{rangeService,columnModel}=this.beans;let leftCol,rightCol;isRtl?(leftCol=columnModel.getDisplayedColAfter(thisCol),rightCol=columnModel.getDisplayedColBefore(thisCol)):(leftCol=columnModel.getDisplayedColBefore(thisCol),rightCol=columnModel.getDisplayedColAfter(thisCol));const ranges=rangeService.getCellRanges().filter(range=>rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),range));leftCol||(left=!0),rightCol||(right=!0);for(let i=0;i<ranges.length&&!(top&&right&&bottom&&left);i++){const range=ranges[i],startRow=rangeService.getRangeStartRow(range),endRow=rangeService.getRangeEndRow(range);!top&&this.beans.rowPositionUtils.sameRow(startRow,this.cellCtrl.getCellPosition())&&(top=!0),!bottom&&this.beans.rowPositionUtils.sameRow(endRow,this.cellCtrl.getCellPosition())&&(bottom=!0),!left&&leftCol&&range.columns.indexOf(leftCol)<0&&(left=!0),!right&&rightCol&&range.columns.indexOf(rightCol)<0&&(right=!0)}return{top,right,bottom,left}}refreshHandle(){if(!this.beans.rangeService||this.beans.context.isDestroyed())return;const shouldHaveSelectionHandle=this.shouldHaveSelectionHandle();this.selectionHandle&&!shouldHaveSelectionHandle&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),shouldHaveSelectionHandle&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_HANDLE,!!this.selectionHandle)}shouldHaveSelectionHandle(){const{gridOptionsService,rangeService}=this.beans,cellRanges=rangeService.getCellRanges(),rangesLen=cellRanges.length;if(this.rangeCount<1||rangesLen<1)return!1;const cellRange=last(cellRanges),cellPosition=this.cellCtrl.getCellPosition(),isFillHandleAvailable=gridOptionsService.get("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),isRangeHandleAvailable=gridOptionsService.get("enableRangeHandle");let handleIsAvailable=rangesLen===1&&!this.cellCtrl.isEditing()&&(isFillHandleAvailable||isRangeHandleAvailable);if(this.hasChartRange){const isCategoryCell=cellRanges[0].type===1&&rangeService.isCellInSpecificRange(cellPosition,cellRanges[0]);this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_CHART_CATEGORY,isCategoryCell),handleIsAvailable=cellRange.type===0}return handleIsAvailable&&cellRange.endRow!=null&&rangeService.isContiguousRange(cellRange)&&rangeService.isBottomRightCell(cellRange,cellPosition)}addSelectionHandle(){const{gridOptionsService,rangeService}=this.beans,cellRangeType=last(rangeService.getCellRanges()).type,type=gridOptionsService.get("enableFillHandle")&&missing(cellRangeType)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==type&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(type)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},__name(_a110,"CellRangeFeature"),_a110),_a111,CellPositionFeature=(_a111=class extends BeanStub{constructor(ctrl,beans){super(),this.cellCtrl=ctrl,this.beans=beans,this.column=ctrl.getColumn(),this.rowNode=ctrl.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListener(this.beans.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}setComp(eGui){this.eGui=eGui,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const rowSpan=this.column.getRowSpan(this.rowNode);this.rowSpan!==rowSpan&&(this.rowSpan=rowSpan,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const colsSpanning=this.getColSpanningList();areEqual(this.colsSpanning,colsSpanning)||(this.colsSpanning=colsSpanning,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const width=this.getCellWidth();this.eGui.style.width=`${width}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((width,col)=>width+col.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const colSpan=this.column.getColSpan(this.rowNode),colsSpanning=[];if(colSpan===1)colsSpanning.push(this.column);else{let pointer=this.column;const pinned=this.column.getPinned();for(let i=0;pointer&&i<colSpan&&(colsSpanning.push(pointer),pointer=this.beans.columnModel.getDisplayedColAfter(pointer),!(!pointer||missing(pointer)||pinned!==pointer.getPinned()));i++);}return colsSpanning}onLeftChanged(){if(!this.eGui)return;const left=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=left+"px"}getCellLeft(){let mostLeftCol;return this.beans.gridOptionsService.get("enableRtl")&&this.colsSpanning?mostLeftCol=last(this.colsSpanning):mostLeftCol=this.column,mostLeftCol.getLeft()}modifyLeftForPrintLayout(leftPosition){if(!this.cellCtrl.isPrintLayout()||this.column.getPinned()==="left")return leftPosition;const leftWidth=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(this.column.getPinned()==="right"){const bodyWidth=this.beans.columnModel.getBodyContainerWidth();return leftWidth+bodyWidth+(leftPosition||0)}return leftWidth+(leftPosition||0)}applyRowSpan(force){if(this.rowSpan===1&&!force)return;const totalRowHeight=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=`${totalRowHeight}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},__name(_a111,"CellPositionFeature"),_a111),_a112,CellCustomStyleFeature=(_a112=class extends BeanStub{constructor(ctrl,beans){super(),this.staticClasses=[],this.cellCtrl=ctrl,this.beans=beans,this.column=ctrl.getColumn(),this.rowNode=ctrl.getRowNode()}setComp(comp){this.cellComp=comp,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const colDef=this.column.getColDef(),{cellClassRules}=colDef,cellClassParams=this.beans.gridOptionsService.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(cellClassRules===this.cellClassRules?void 0:this.cellClassRules,cellClassRules,cellClassParams,className=>this.cellComp.addOrRemoveCssClass(className,!0),className=>this.cellComp.addOrRemoveCssClass(className,!1)),this.cellClassRules=cellClassRules}applyUserStyles(){const colDef=this.column.getColDef();if(!colDef.cellStyle)return;let styles;if(typeof colDef.cellStyle=="function"){const cellStyleParams=this.beans.gridOptionsService.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex}),cellStyleFunc=colDef.cellStyle;styles=cellStyleFunc(cellStyleParams)}else styles=colDef.cellStyle;styles&&this.cellComp.setUserStyles(styles)}applyClassesFromColDef(){const colDef=this.column.getColDef(),cellClassParams=this.beans.gridOptionsService.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(className=>this.cellComp.addOrRemoveCssClass(className,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(colDef,cellClassParams),this.staticClasses.length&&this.staticClasses.forEach(className=>this.cellComp.addOrRemoveCssClass(className,!0))}destroy(){super.destroy()}},__name(_a112,"CellCustomStyleFeature"),_a112),_a113,Beans=(_a113=class{postConstruct(){this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}},__name(_a113,"Beans"),_a113);__decorateClass([Autowired("resizeObserverService")],Beans.prototype,"resizeObserverService",2);__decorateClass([Autowired("paginationProxy")],Beans.prototype,"paginationProxy",2);__decorateClass([Autowired("context")],Beans.prototype,"context",2);__decorateClass([Autowired("columnApi")],Beans.prototype,"columnApi",2);__decorateClass([Autowired("gridApi")],Beans.prototype,"gridApi",2);__decorateClass([Autowired("gridOptionsService")],Beans.prototype,"gridOptionsService",2);__decorateClass([Autowired("expressionService")],Beans.prototype,"expressionService",2);__decorateClass([Autowired("environment")],Beans.prototype,"environment",2);__decorateClass([Autowired("rowRenderer")],Beans.prototype,"rowRenderer",2);__decorateClass([Autowired("templateService")],Beans.prototype,"templateService",2);__decorateClass([Autowired("valueService")],Beans.prototype,"valueService",2);__decorateClass([Autowired("eventService")],Beans.prototype,"eventService",2);__decorateClass([Autowired("columnModel")],Beans.prototype,"columnModel",2);__decorateClass([Autowired("headerNavigationService")],Beans.prototype,"headerNavigationService",2);__decorateClass([Autowired("navigationService")],Beans.prototype,"navigationService",2);__decorateClass([Autowired("columnAnimationService")],Beans.prototype,"columnAnimationService",2);__decorateClass([Optional("rangeService")],Beans.prototype,"rangeService",2);__decorateClass([Autowired("focusService")],Beans.prototype,"focusService",2);__decorateClass([Autowired("popupService")],Beans.prototype,"popupService",2);__decorateClass([Autowired("valueFormatterService")],Beans.prototype,"valueFormatterService",2);__decorateClass([Autowired("stylingService")],Beans.prototype,"stylingService",2);__decorateClass([Autowired("columnHoverService")],Beans.prototype,"columnHoverService",2);__decorateClass([Autowired("userComponentFactory")],Beans.prototype,"userComponentFactory",2);__decorateClass([Autowired("userComponentRegistry")],Beans.prototype,"userComponentRegistry",2);__decorateClass([Autowired("animationFrameService")],Beans.prototype,"animationFrameService",2);__decorateClass([Autowired("dragService")],Beans.prototype,"dragService",2);__decorateClass([Autowired("dragAndDropService")],Beans.prototype,"dragAndDropService",2);__decorateClass([Autowired("sortController")],Beans.prototype,"sortController",2);__decorateClass([Autowired("filterManager")],Beans.prototype,"filterManager",2);__decorateClass([Autowired("rowContainerHeightService")],Beans.prototype,"rowContainerHeightService",2);__decorateClass([Autowired("frameworkOverrides")],Beans.prototype,"frameworkOverrides",2);__decorateClass([Autowired("cellPositionUtils")],Beans.prototype,"cellPositionUtils",2);__decorateClass([Autowired("rowPositionUtils")],Beans.prototype,"rowPositionUtils",2);__decorateClass([Autowired("selectionService")],Beans.prototype,"selectionService",2);__decorateClass([Optional("selectionHandleFactory")],Beans.prototype,"selectionHandleFactory",2);__decorateClass([Autowired("rowCssClassCalculator")],Beans.prototype,"rowCssClassCalculator",2);__decorateClass([Autowired("rowModel")],Beans.prototype,"rowModel",2);__decorateClass([Autowired("ctrlsService")],Beans.prototype,"ctrlsService",2);__decorateClass([Autowired("ctrlsFactory")],Beans.prototype,"ctrlsFactory",2);__decorateClass([Autowired("agStackComponentsRegistry")],Beans.prototype,"agStackComponentsRegistry",2);__decorateClass([Autowired("valueCache")],Beans.prototype,"valueCache",2);__decorateClass([Autowired("rowNodeEventThrottle")],Beans.prototype,"rowNodeEventThrottle",2);__decorateClass([Autowired("localeService")],Beans.prototype,"localeService",2);__decorateClass([Autowired("valueParserService")],Beans.prototype,"valueParserService",2);__decorateClass([Autowired("syncService")],Beans.prototype,"syncService",2);__decorateClass([Autowired("ariaAnnouncementService")],Beans.prototype,"ariaAnnouncementService",2);__decorateClass([PostConstruct],Beans.prototype,"postConstruct",1);Beans=__decorateClass([Bean("beans")],Beans);var _a114,CellMouseListenerFeature=(_a114=class extends Beans{constructor(ctrl,beans,column){super(),this.cellCtrl=ctrl,this.beans=beans,this.column=column}onMouseEvent(eventName,mouseEvent){if(!isStopPropagationForAgGrid(mouseEvent))switch(eventName){case"click":this.onCellClicked(mouseEvent);break;case"mousedown":case"touchstart":this.onMouseDown(mouseEvent);break;case"dblclick":this.onCellDoubleClicked(mouseEvent);break;case"mouseout":this.onMouseOut(mouseEvent);break;case"mouseover":this.onMouseOver(mouseEvent);break}}onCellClicked(mouseEvent){if(this.isDoubleClickOnIPad()){this.onCellDoubleClicked(mouseEvent),mouseEvent.preventDefault();return}const{eventService,rangeService,gridOptionsService}=this.beans,isMultiKey=mouseEvent.ctrlKey||mouseEvent.metaKey;rangeService&&isMultiKey&&rangeService.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&rangeService.intersectLastRange(!0);const cellClickedEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_CLICKED);eventService.dispatchEvent(cellClickedEvent);const colDef=this.column.getColDef();colDef.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{colDef.onCellClicked(cellClickedEvent)})},0),(gridOptionsService.get("singleClickEdit")||colDef.singleClickEdit)&&!gridOptionsService.get("suppressClickEdit")&&!(mouseEvent.shiftKey&&(rangeService==null?void 0:rangeService.getCellRanges().length)!=0)&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!isIOSUserAgent()||isEventSupported("dblclick"))return!1;const nowMillis=new Date().getTime(),res=nowMillis-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=nowMillis,res}onCellDoubleClicked(mouseEvent){const colDef=this.column.getColDef(),cellDoubleClickedEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(cellDoubleClickedEvent),typeof colDef.onCellDoubleClicked=="function"&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{colDef.onCellDoubleClicked(cellDoubleClickedEvent)})},0),!this.beans.gridOptionsService.get("singleClickEdit")&&!this.beans.gridOptionsService.get("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,mouseEvent)}onMouseDown(mouseEvent){const{ctrlKey,metaKey,shiftKey}=mouseEvent,target=mouseEvent.target,{cellCtrl,beans}=this,{eventService,rangeService,focusService}=beans;if(this.isRightClickInExistingRange(mouseEvent))return;const ranges=rangeService&&rangeService.getCellRanges().length!=0;if(!shiftKey||!ranges){const forceBrowserFocus=isBrowserSafari()&&!cellCtrl.isEditing()&&!isFocusableFormField(target);cellCtrl.focusCell(forceBrowserFocus)}if(shiftKey&&ranges&&!focusService.isCellFocused(cellCtrl.getCellPosition())){mouseEvent.preventDefault();const focusedCellPosition=focusService.getFocusedCell();if(focusedCellPosition){const{column,rowIndex,rowPinned}=focusedCellPosition,focusedRowCtrl=beans.rowRenderer.getRowByPosition({rowIndex,rowPinned}),focusedCellCtrl=focusedRowCtrl==null?void 0:focusedRowCtrl.getCellCtrl(column);focusedCellCtrl!=null&&focusedCellCtrl.isEditing()&&focusedCellCtrl.stopEditing(),focusService.setFocusedCell({column,rowIndex,rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(target)){if(rangeService){const thisCell=this.cellCtrl.getCellPosition();if(shiftKey)rangeService.extendLatestRangeToCell(thisCell);else{const isMultiKey=ctrlKey||metaKey;rangeService.setRangeToCell(thisCell,isMultiKey)}}eventService.dispatchEvent(this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(mouseEvent){const{rangeService}=this.beans;if(rangeService){const cellInRange=rangeService.isCellInAnyRange(this.cellCtrl.getCellPosition()),isRightClick=mouseEvent.button===2||mouseEvent.ctrlKey&&this.beans.gridOptionsService.get("allowContextMenuWithControlKey");if(cellInRange&&isRightClick)return!0}return!1}containsWidget(target){return isElementChildOfClass(target,"ag-selection-checkbox",3)}onMouseOut(mouseEvent){if(this.mouseStayingInsideCell(mouseEvent))return;const cellMouseOutEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(cellMouseOutEvent),this.beans.columnHoverService.clearMouseOver()}onMouseOver(mouseEvent){if(this.mouseStayingInsideCell(mouseEvent))return;const cellMouseOverEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(cellMouseOverEvent),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const eGui=this.cellCtrl.getGui(),cellContainsTarget=eGui.contains(e.target),cellContainsRelatedTarget=eGui.contains(e.relatedTarget);return cellContainsTarget&&cellContainsRelatedTarget}destroy(){}},__name(_a114,"CellMouseListenerFeature"),_a114),_a115,CellKeyboardListenerFeature=(_a115=class extends BeanStub{constructor(ctrl,beans,column,rowNode,rowCtrl){super(),this.cellCtrl=ctrl,this.beans=beans,this.rowNode=rowNode,this.rowCtrl=rowCtrl}setComp(eGui){this.eGui=eGui}onKeyDown(event){const key=event.key;switch(key){case KeyCode.ENTER:this.onEnterKeyDown(event);break;case KeyCode.F2:this.onF2KeyDown(event);break;case KeyCode.ESCAPE:this.onEscapeKeyDown(event);break;case KeyCode.TAB:this.onTabKeyDown(event);break;case KeyCode.BACKSPACE:case KeyCode.DELETE:this.onBackspaceOrDeleteKeyDown(key,event);break;case KeyCode.DOWN:case KeyCode.UP:case KeyCode.RIGHT:case KeyCode.LEFT:this.onNavigationKeyDown(event,key);break}}onNavigationKeyDown(event,key){this.cellCtrl.isEditing()||(event.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(event):this.beans.navigationService.navigateToNextCell(event,key,this.cellCtrl.getCellPosition(),!0),event.preventDefault())}onShiftRangeSelect(event){if(!this.beans.rangeService)return;const endCell=this.beans.rangeService.extendLatestRangeInDirection(event);endCell&&this.beans.navigationService.ensureCellVisible(endCell)}onTabKeyDown(event){this.beans.navigationService.onTabKeyDown(this.cellCtrl,event)}onBackspaceOrDeleteKeyDown(key,event){const{cellCtrl,beans,rowNode}=this,{gridOptionsService,rangeService,eventService}=beans;cellCtrl.isEditing()||(eventService.dispatchEvent({type:Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),isDeleteKey(key,gridOptionsService.get("enableCellEditingOnBackspace"))?rangeService&&gridOptionsService.get("enableRangeSelection")?rangeService.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"}):cellCtrl.isCellEditable()&&rowNode.setDataValue(cellCtrl.getColumn(),null,"cellClear"):cellCtrl.startRowOrCellEdit(key,event),eventService.dispatchEvent({type:Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gridOptionsService.get("enterNavigatesVertically")){const key=e.shiftKey?KeyCode.UP:KeyCode.DOWN;this.beans.navigationService.navigateToNextCell(null,key,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(KeyCode.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(event){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(KeyCode.F2,event)}onEscapeKeyDown(event){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(event){if(event.target!==this.eGui||this.cellCtrl.isEditing())return;const key=event.key;key===" "?this.onSpaceKeyDown(event):(this.cellCtrl.startRowOrCellEdit(key,event),event.preventDefault())}onSpaceKeyDown(event){const{gridOptionsService}=this.beans;if(!this.cellCtrl.isEditing()&&gridOptionsService.isRowSelection()){const currentSelection=this.rowNode.isSelected(),newSelection=!currentSelection;if(newSelection||!gridOptionsService.get("suppressRowDeselection")){const groupSelectsFiltered=this.beans.gridOptionsService.get("groupSelectsFiltered"),updatedCount=this.rowNode.setSelectedParams({newValue:newSelection,rangeSelect:event.shiftKey,groupSelectsFiltered,event,source:"spaceKey"});currentSelection===void 0&&updatedCount===0&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:event.shiftKey,groupSelectsFiltered,event,source:"spaceKey"})}}event.preventDefault()}destroy(){super.destroy()}},__name(_a115,"CellKeyboardListenerFeature"),_a115),_a116,DndSourceComp=(_a116=class extends Component{constructor(rowNode,column,eCell){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=rowNode,this.column=column,this.eCell=eCell}postConstruct(){this.getGui().appendChild(createIconNoSpan("rowDrag",this.gridOptionsService,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(dragEvent){const providedOnRowDrag=this.column.getColDef().dndSourceOnRowDrag;dragEvent.dataTransfer.setDragImage(this.eCell,0,0);const defaultOnRowDrag=__name(()=>{try{const jsonData=JSON.stringify(this.rowNode.data);dragEvent.dataTransfer.setData("application/json",jsonData),dragEvent.dataTransfer.setData("text/plain",jsonData)}catch{}},"defaultOnRowDrag");if(providedOnRowDrag){const params=this.gridOptionsService.addGridCommonParams({rowNode:this.rowNode,dragEvent});providedOnRowDrag(params)}else defaultOnRowDrag()}checkVisibility(){const visible=this.column.isDndSource(this.rowNode);this.setDisplayed(visible)}},__name(_a116,"DndSourceComp"),_a116);__decorateClass([PostConstruct],DndSourceComp.prototype,"postConstruct",1);var CSS_FIRST_COLUMN="ag-column-first",CSS_LAST_COLUMN="ag-column-last",_a117,CssClassApplier=(_a117=class{static getHeaderClassesFromColDef(abstractColDef,gridOptionsService,column,columnGroup){return missing(abstractColDef)?[]:this.getColumnClassesFromCollDef(abstractColDef.headerClass,abstractColDef,gridOptionsService,column,columnGroup)}static getToolPanelClassesFromColDef(abstractColDef,gridOptionsService,column,columnGroup){return missing(abstractColDef)?[]:this.getColumnClassesFromCollDef(abstractColDef.toolPanelClass,abstractColDef,gridOptionsService,column,columnGroup)}static refreshFirstAndLastStyles(comp,column,columnModel){comp.addOrRemoveCssClass(CSS_FIRST_COLUMN,columnModel.isColumnAtEdge(column,"first")),comp.addOrRemoveCssClass(CSS_LAST_COLUMN,columnModel.isColumnAtEdge(column,"last"))}static getClassParams(abstractColDef,gridOptionsService,column,columnGroup){return gridOptionsService.addGridCommonParams({colDef:abstractColDef,column,columnGroup})}static getColumnClassesFromCollDef(classesOrFunc,abstractColDef,gridOptionsService,column,columnGroup){if(missing(classesOrFunc))return[];let classToUse;if(typeof classesOrFunc=="function"){const params=this.getClassParams(abstractColDef,gridOptionsService,column,columnGroup);classToUse=classesOrFunc(params)}else classToUse=classesOrFunc;return typeof classToUse=="string"?[classToUse]:Array.isArray(classToUse)?[...classToUse]:[]}},__name(_a117,"CssClassApplier"),_a117),CSS_CELL="ag-cell",CSS_AUTO_HEIGHT="ag-cell-auto-height",CSS_NORMAL_HEIGHT="ag-cell-normal-height",CSS_CELL_FOCUS="ag-cell-focus",CSS_CELL_FIRST_RIGHT_PINNED="ag-cell-first-right-pinned",CSS_CELL_LAST_LEFT_PINNED="ag-cell-last-left-pinned",CSS_CELL_NOT_INLINE_EDITING="ag-cell-not-inline-editing",CSS_COLUMN_HOVER="ag-column-hover",CSS_CELL_WRAP_TEXT="ag-cell-wrap-text",instanceIdSequence2=0,_a118,_CellCtrl=(_a118=class extends BeanStub{constructor(column,rowNode,beans,rowCtrl){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=column,this.rowNode=rowNode,this.beans=beans,this.rowCtrl=rowCtrl,this.instanceId=column.getId()+"-"+instanceIdSequence2++,this.colIdSanitised=escapeString(this.column.getId()),beans.gridOptionsService.get("suppressCellFocus")||(this.tabIndex=-1),this.createCellPosition(),this.addFeatures(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new CellPositionFeature(this,this.beans),this.addDestroyFunc(()=>{var _a273;(_a273=this.cellPositionFeature)==null||_a273.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new CellCustomStyleFeature(this,this.beans),this.addDestroyFunc(()=>{var _a273;(_a273=this.cellCustomStyleFeature)==null||_a273.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new CellMouseListenerFeature(this,this.beans,this.column),this.addDestroyFunc(()=>{var _a273;(_a273=this.cellMouseListenerFeature)==null||_a273.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new CellKeyboardListenerFeature(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var _a273;(_a273=this.cellKeyboardListenerFeature)==null||_a273.destroy(),this.cellKeyboardListenerFeature=null}),this.column.isTooltipEnabled()&&(this.enableTooltipFeature(),this.addDestroyFunc(()=>{this.disableTooltipFeature()})),this.beans.rangeService&&this.beans.gridOptionsService.get("enableRangeSelection")&&(this.cellRangeFeature=new CellRangeFeature(this.beans,this),this.addDestroyFunc(()=>{var _a273;(_a273=this.cellRangeFeature)==null||_a273.destroy(),this.cellRangeFeature=null}))}enableTooltipFeature(value,shouldDisplayTooltip){const getTooltipValue=__name(()=>{const colDef=this.column.getColDef(),data=this.rowNode.data;if(colDef.tooltipField&&exists(data))return getValueUsingField(data,colDef.tooltipField,this.column.isTooltipFieldContainsDots());const valueGetter=colDef.tooltipValueGetter;return valueGetter?valueGetter(this.beans.gridOptionsService.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},"getTooltipValue"),isTooltipWhenTruncated=this.beans.gridOptionsService.get("tooltipShowMode")==="whenTruncated";!shouldDisplayTooltip&&isTooltipWhenTruncated&&!this.isCellRenderer()&&(shouldDisplayTooltip=__name(()=>{const eGui=this.getGui(),textEl=eGui.children.length===0?eGui:eGui.querySelector(".ag-cell-value");return textEl?textEl.scrollWidth>textEl.clientWidth:!0},"shouldDisplayTooltip"));const tooltipCtrl={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:value!=null?()=>value:getTooltipValue,getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip};this.tooltipFeature=new TooltipFeature(tooltipCtrl,this.beans)}disableTooltipFeature(){this.tooltipFeature&&(this.tooltipFeature.destroy(),this.tooltipFeature=null)}setComp(comp,eGui,eCellWrapper,printLayout,startEditing){var _a273,_b,_c,_d;this.cellComp=comp,this.eGui=eGui,this.printLayout=printLayout,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(eCellWrapper),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(_a273=this.cellPositionFeature)==null||_a273.setComp(eGui),(_b=this.cellCustomStyleFeature)==null||_b.setComp(comp),(_c=this.tooltipFeature)==null||_c.refreshToolTip(),(_d=this.cellKeyboardListenerFeature)==null||_d.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(comp,eGui),startEditing&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(func=>func()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(eCellWrapper){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!eCellWrapper)return;const eParentCell=eCellWrapper.parentElement,minRowHeight=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,measureHeight=__name(timesCalled=>{if(this.editing||!this.isAlive())return;const{paddingTop,paddingBottom,borderBottomWidth,borderTopWidth}=getElementSize(eParentCell),extraHeight=paddingTop+paddingBottom+borderBottomWidth+borderTopWidth,autoHeight=eCellWrapper.offsetHeight+extraHeight;if(timesCalled<5){const doc=this.beans.gridOptionsService.getDocument(),notYetInDom=!doc||!doc.contains(eCellWrapper),possiblyNoContentYet=autoHeight==0;if(notYetInDom||possiblyNoContentYet){window.setTimeout(()=>measureHeight(timesCalled+1),0);return}}const newHeight=Math.max(autoHeight,minRowHeight);this.rowNode.setRowAutoHeight(newHeight,this.column)},"measureHeight"),listener=__name(()=>measureHeight(0),"listener");listener();const destroyResizeObserver=this.beans.resizeObserverService.observeResize(eCellWrapper,listener);this.addDestroyFunc(()=>{destroyResizeObserver(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){var _a273;return(_a273=this.column.getColDef().cellAriaRole)!=null?_a273:"gridcell"}getInstanceId(){return this.instanceId}getIncludeSelection(){return this.includeSelection}getIncludeRowDrag(){return this.includeRowDrag}getIncludeDndSource(){return this.includeDndSource}getColumnIdSanitised(){return this.colIdSanitised}getTabIndex(){return this.tabIndex}isCellRenderer(){const colDef=this.column.getColDef();return colDef.cellRenderer!=null||colDef.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted!=null?this.valueFormatted:this.value}showValue(forceNewCellRendererInstance=!1){const valueToDisplay=this.getValueToDisplay();let compDetails;if(this.isCellRenderer()){const params=this.createCellRendererParams();compDetails=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),params)}this.cellComp.setRenderDetails(compDetails,valueToDisplay,forceNewCellRendererInstance),this.refreshHandle()}setupControlComps(){const colDef=this.column.getColDef();this.includeSelection=this.isIncludeControl(colDef.checkboxSelection),this.includeRowDrag=this.isIncludeControl(colDef.rowDrag),this.includeDndSource=this.isIncludeControl(colDef.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gridOptionsService.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(value){return this.rowNode.rowPinned!=null?!1:typeof value=="function"||value===!0}refreshShouldDestroy(){const colDef=this.column.getColDef(),selectionChanged=this.includeSelection!=this.isIncludeControl(colDef.checkboxSelection),rowDragChanged=this.includeRowDrag!=this.isIncludeControl(colDef.rowDrag),dndSourceChanged=this.includeDndSource!=this.isIncludeControl(colDef.dndSource);return selectionChanged||rowDragChanged||dndSourceChanged}startEditing(key=null,cellStartedEdit=!1,event=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startEditing(key,cellStartedEdit,event)});return}const editorParams=this.createCellEditorParams(key,cellStartedEdit),colDef=this.column.getColDef(),compDetails=this.beans.userComponentFactory.getCellEditorDetails(colDef,editorParams);this.editCompDetails=compDetails;const popup=(compDetails==null?void 0:compDetails.popupFromSelector)!=null?compDetails.popupFromSelector:!!colDef.cellEditorPopup,position=(compDetails==null?void 0:compDetails.popupPositionFromSelector)!=null?compDetails.popupPositionFromSelector:colDef.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(compDetails,popup,position,this.beans.gridOptionsService.get("reactiveCustomComponents"));const e=this.createEvent(event,Events.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(e)}setEditing(editing){this.editing!==editing&&(this.editing=editing,this.refreshHandle())}stopRowOrCellEdit(cancel=!1){this.beans.gridOptionsService.get("editType")==="fullRow"?this.rowCtrl.stopEditing(cancel):this.stopEditing(cancel)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(cancel){const noValueResult={newValueExists:!1};if(cancel)return noValueResult;const cellEditor=this.cellComp.getCellEditor();return!cellEditor||cellEditor.isCancelAfterEnd&&cellEditor.isCancelAfterEnd()?noValueResult:{newValue:cellEditor.getValue(),newValueExists:!0}}saveNewValue(oldValue,newValue){if(newValue===oldValue)return!1;this.suppressRefreshCell=!0;const valueChanged=this.rowNode.setDataValue(this.column,newValue,"edit");return this.suppressRefreshCell=!1,valueChanged}stopEditing(cancel=!1){if(!this.editing)return!1;const{newValue,newValueExists}=this.takeValueFromCellEditor(cancel),oldValue=this.rowNode.getValueFromValueService(this.column);let valueChanged=!1;return newValueExists&&(valueChanged=this.saveNewValue(oldValue,newValue)),this.setEditing(!1),this.cellComp.setEditDetails(),this.editCompDetails=void 0,this.updateAndFormatValue(!1),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(oldValue,newValue,!cancel&&!!valueChanged),valueChanged}dispatchEditingStoppedEvent(oldValue,newValue,valueChanged){const editingStoppedEvent=__spreadProps(__spreadValues({},this.createEvent(null,Events.EVENT_CELL_EDITING_STOPPED)),{oldValue,newValue,valueChanged});this.beans.eventService.dispatchEvent(editingStoppedEvent)}createCellEditorParams(key,cellStartedEdit){return this.beans.gridOptionsService.addGridCommonParams({value:this.rowNode.getValueFromValueService(this.column),eventKey:key,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,cellStartedEdit,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)})}createCellRendererParams(){return this.beans.gridOptionsService.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:value=>this.beans.valueService.setValue(this.rowNode,this.column,value),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(rowDraggerElement,dragStartPixels,value,suppressVisibilityChange)=>this.registerRowDragger(rowDraggerElement,dragStartPixels,suppressVisibilityChange),setTooltip:(value,shouldDisplayTooltip)=>{this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(value,shouldDisplayTooltip),this.refreshToolTip()}})}parseValue(newValue){return this.beans.valueParserService.parseValue(this.column,this.rowNode,newValue,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const cellEditor=this.cellComp.getCellEditor();cellEditor&&cellEditor.focusOut&&cellEditor.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const cellEditor=this.cellComp.getCellEditor();cellEditor&&cellEditor.focusIn?cellEditor.focusIn():this.focusCell(!0)}onCellChanged(event){event.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(params){var _a273;this.refreshShouldDestroy()?(_a273=this.rowCtrl)==null||_a273.refreshCell(this):this.refreshCell(params)}refreshCell(params){var _a273,_b,_c;if(this.suppressRefreshCell||this.editing)return;const colDef=this.column.getColDef(),newData=params!=null&&!!params.newData,suppressFlash=params!=null&&!!params.suppressFlash||!!colDef.suppressCellFlash,noValueProvided=colDef.field==null&&colDef.valueGetter==null&&colDef.showRowGroup==null,forceRefresh=params&&params.forceRefresh||noValueProvided||newData,isCellCompReady=!!this.cellComp,valuesDifferent=this.updateAndFormatValue(isCellCompReady),dataNeedsUpdating=forceRefresh||valuesDifferent;if(isCellCompReady){if(dataNeedsUpdating){this.showValue(newData);const processingFilterChange=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!suppressFlash&&!processingFilterChange&&(this.beans.gridOptionsService.get("enableCellChangeFlash")||colDef.enableCellChangeFlash)&&this.flashCell(),(_a273=this.cellCustomStyleFeature)==null||_a273.applyUserStyles(),(_b=this.cellCustomStyleFeature)==null||_b.applyClassesFromColDef()}this.refreshToolTip(),(_c=this.cellCustomStyleFeature)==null||_c.applyCellClassRules()}}stopEditingAndFocus(suppressNavigateAfterEdit=!1,shiftKey=!1){this.stopRowOrCellEdit(),this.focusCell(!0),suppressNavigateAfterEdit||this.navigateAfterEdit(shiftKey)}navigateAfterEdit(shiftKey){if(this.beans.gridOptionsService.get("enterNavigatesVerticallyAfterEdit")){const key=shiftKey?KeyCode.UP:KeyCode.DOWN;this.beans.navigationService.navigateToNextCell(null,key,this.getCellPosition(),!1)}}flashCell(delays){var _a273,_b;const flashDuration=(_a273=delays==null?void 0:delays.flashDuration)!=null?_a273:delays==null?void 0:delays.flashDelay,fadeDuration=(_b=delays==null?void 0:delays.fadeDuration)!=null?_b:delays==null?void 0:delays.fadeDelay;this.animateCell("data-changed",flashDuration,fadeDuration)}animateCell(cssName,flashDuration,fadeDuration){if(!this.cellComp)return;const fullName=`ag-cell-${cssName}`,animationFullName=`ag-cell-${cssName}-animation`,{gridOptionsService}=this.beans;flashDuration||(flashDuration=gridOptionsService.get("cellFlashDuration")),exists(fadeDuration)||(fadeDuration=gridOptionsService.get("cellFadeDuration")),this.cellComp.addOrRemoveCssClass(fullName,!0),this.cellComp.addOrRemoveCssClass(animationFullName,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(fullName,!1),this.cellComp.addOrRemoveCssClass(animationFullName,!0),this.eGui.style.transition=`background-color ${fadeDuration}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(animationFullName,!1),this.eGui.style.transition="")},fadeDuration))},flashDuration)})}onFlashCells(event){if(!this.cellComp)return;const cellId=this.beans.cellPositionUtils.createId(this.getCellPosition());event.cells[cellId]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(value){var _a273;return(_a273=this.callValueFormatter(value))!=null?_a273:value}callValueFormatter(value){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,value)}updateAndFormatValue(compareValues){const oldValue=this.value,oldValueFormatted=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),compareValues?!this.valuesAreEqual(oldValue,this.value)||this.valueFormatted!=oldValueFormatted:!0}valuesAreEqual(val1,val2){const colDef=this.column.getColDef();return colDef.equals?colDef.equals(val1,val2):val1===val2}getComp(){return this.cellComp}getValue(){return this.value}getValueFormatted(){return this.valueFormatted}addDomData(){const element=this.getGui();this.beans.gridOptionsService.setDomData(element,_a118.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gridOptionsService.setDomData(element,_a118.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(domEvent,eventType){return this.beans.gridOptionsService.addGridCommonParams({type:eventType,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:domEvent,rowIndex:this.rowNode.rowIndex})}processCharacter(event){var _a273;(_a273=this.cellKeyboardListenerFeature)==null||_a273.processCharacter(event)}onKeyDown(event){var _a273;(_a273=this.cellKeyboardListenerFeature)==null||_a273.onKeyDown(event)}onMouseEvent(eventName,mouseEvent){var _a273;(_a273=this.cellMouseListenerFeature)==null||_a273.onMouseEvent(eventName,mouseEvent)}getGui(){return this.eGui}refreshToolTip(){var _a273;(_a273=this.tooltipFeature)==null||_a273.refreshToolTip()}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var _a273;this.cellComp&&((_a273=this.cellPositionFeature)==null||_a273.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp,column,beans}=this;CssClassApplier.refreshFirstAndLastStyles(cellComp,column,beans.columnModel)}refreshAriaColIndex(){const colIdx=this.beans.columnModel.getAriaColumnIndex(this.column);setAriaColIndex(this.getGui(),colIdx)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var _a273;return(_a273=this.cellPositionFeature)==null?void 0:_a273.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}getBeans(){return this.beans}isPrintLayout(){return this.printLayout}appendChild(htmlElement){this.eGui.appendChild(htmlElement)}refreshHandle(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(key,event=null){if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(key,event)});return}this.beans.gridOptionsService.get("editType")==="fullRow"?this.rowCtrl.startRowEditing(key,this):this.startEditing(key,!0,event)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return this.cellRangeFeature!=null}focusCell(forceBrowserFocus=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const firstRightPinned=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass(CSS_CELL_FIRST_RIGHT_PINNED,firstRightPinned)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const lastLeftPinned=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass(CSS_CELL_LAST_LEFT_PINNED,lastLeftPinned)}onCellFocused(event){if(this.beans.gridOptionsService.get("suppressCellFocus"))return;const cellFocused=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp){cellFocused&&(event!=null&&event.forceBrowserFocus)&&(this.focusEventToRestore=event);return}this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass(CSS_CELL_FOCUS,cellFocused),cellFocused&&event&&event.forceBrowserFocus&&this.cellComp.getFocusableElement().focus({preventScroll:!!event.preventScrollOnBrowserFocus});const fullRowEdit=this.beans.gridOptionsService.get("editType")==="fullRow";!cellFocused&&!fullRowEdit&&this.editing&&this.stopRowOrCellEdit(),cellFocused&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:makeNull(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass(CSS_CELL,!0),this.cellComp.addOrRemoveCssClass(CSS_CELL_NOT_INLINE_EDITING,!0);const autoHeight=this.column.isAutoHeight()==!0;this.cellComp.addOrRemoveCssClass(CSS_AUTO_HEIGHT,autoHeight),this.cellComp.addOrRemoveCssClass(CSS_NORMAL_HEIGHT,!autoHeight)}onColumnHover(){if(!this.cellComp||!this.beans.gridOptionsService.get("columnHoverHighlight"))return;const isHovered=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass(CSS_COLUMN_HOVER,isHovered)}onColDefChanged(){var _a273;if(!this.cellComp)return;if(this.column.isAutoHeight()!==this.isAutoHeight&&((_a273=this.rowCtrl)==null||_a273.refreshCell(this)),this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),!this.editing)this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0});else{const cellEditor=this.getCellEditor();if(cellEditor!=null&&cellEditor.refresh){const{eventKey,cellStartedEdit}=this.editCompDetails.params,editorParams=this.createCellEditorParams(eventKey,cellStartedEdit),colDef=this.column.getColDef(),compDetails=this.beans.userComponentFactory.getCellEditorDetails(colDef,editorParams);cellEditor.refresh(compDetails.params)}}}setWrapText(){const value=this.column.getColDef().wrapText==!0;this.cellComp.addOrRemoveCssClass(CSS_CELL_WRAP_TEXT,value)}dispatchCellContextMenuEvent(event){const colDef=this.column.getColDef(),cellContextMenuEvent=this.createEvent(event,Events.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(cellContextMenuEvent),colDef.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{colDef.onCellContextMenu(cellContextMenuEvent)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const cbSelectionComponent=new CheckboxSelectionComponent;return this.beans.context.createBean(cbSelectionComponent),cbSelectionComponent.init({rowNode:this.rowNode,column:this.column}),cbSelectionComponent}createDndSource(){const dndSourceComp=new DndSourceComp(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(dndSourceComp),dndSourceComp}registerRowDragger(customElement,dragStartPixels,suppressVisibilityChange){if(this.customRowDragComp){this.customRowDragComp.setDragElement(customElement,dragStartPixels);return}const newComp=this.createRowDragComp(customElement,dragStartPixels,suppressVisibilityChange);newComp&&(this.customRowDragComp=newComp,this.addDestroyFunc(()=>{this.beans.context.destroyBean(newComp),this.customRowDragComp=null}))}createRowDragComp(customElement,dragStartPixels,suppressVisibilityChange){const pagination=this.beans.gridOptionsService.get("pagination"),rowDragManaged=this.beans.gridOptionsService.get("rowDragManaged"),clientSideRowModelActive=this.beans.gridOptionsService.isRowModelType("clientSide");if(rowDragManaged){if(!clientSideRowModelActive){warnOnce("managed row dragging is only allowed in the Client Side Row Model");return}if(pagination){warnOnce("managed row dragging is not possible when doing pagination");return}}const rowDragComp=new RowDragComp(()=>this.value,this.rowNode,this.column,customElement,dragStartPixels,suppressVisibilityChange);return this.beans.context.createBean(rowDragComp),rowDragComp}},__name(_a118,"_CellCtrl"),_a118);_CellCtrl.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var CellCtrl=_CellCtrl,instanceIdSequence3=0,_a119,_RowCtrl=(_a119=class extends BeanStub{constructor(rowNode,beans,animateIn,useAnimationFrameForCreate,printLayout){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=beans,this.gridOptionsService=beans.gridOptionsService,this.rowNode=rowNode,this.paginationPage=beans.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=useAnimationFrameForCreate,this.printLayout=printLayout,this.suppressRowTransform=this.gridOptionsService.get("suppressRowTransform"),this.instanceId=rowNode.id+"-"+instanceIdSequence3++,this.rowId=escapeString(rowNode.id),this.initRowBusinessKey(),this.rowFocused=beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=beans.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(animateIn),this.rowStyles=this.processStylesFromGridOptions(),this.isFullWidth()&&!this.gridOptionsService.get("suppressCellFocus")&&(this.tabIndex=-1),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gridOptionsService.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const businessKey=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=escapeString(businessKey)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}getTabIndex(){return this.tabIndex}isSticky(){return this.rowNode.sticky}getBeans(){return this.beans}getInstanceId(){return this.instanceId}setComp(rowComp,element,containerType){const gui={rowComp,element,containerType};this.allRowGuis.push(gui),containerType==="left"?this.leftGui=gui:containerType==="right"?this.rightGui=gui:containerType==="fullWidth"?this.fullWidthGui=gui:this.centerGui=gui,this.initialiseRowComp(gui),this.rowType!=="FullWidthLoading"&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(containerType){switch(this.allRowGuis=this.allRowGuis.filter(rowGui=>rowGui.containerType!==containerType),containerType){case"left":this.leftGui=void 0;break;case"right":this.rightGui=void 0;break;case"fullWidth":this.fullWidthGui=void 0;break;case"center":this.centerGui=void 0;break}}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gridOptionsService.get("keepDetailRows")}setCached(cached){const displayValue=cached?"none":"";this.allRowGuis.forEach(rg=>rg.element.style.display=displayValue)}initialiseRowComp(gui){const gos=this.gridOptionsService;this.listenOnDomOrder(gui),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(gui),this.updateRowIndexes(gui),this.setFocusedClasses(gui),this.setStylesFromGridOptions(!1,gui),gos.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(gui),this.updateColumnLists(!this.useAnimationFrameForCreate);const comp=gui.rowComp;this.getInitialRowClasses(gui.containerType).forEach(name=>comp.addOrRemoveCssClass(name,!0)),this.executeSlideAndFadeAnimations(gui),this.rowNode.group&&setAriaExpanded(gui.element,this.rowNode.expanded==!0),this.setRowCompRowId(comp),this.setRowCompRowBusinessKey(comp),gos.setDomData(gui.element,_a119.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>gos.setDomData(gui.element,_a119.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,gui.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(gui.element),this.isFullWidth()&&this.setupFullWidth(gui),gos.get("rowDragEntireRow")&&this.addRowDraggerToRow(gui),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&gui.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(comp){this.businessKeySanitised!=null&&comp.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(comp){this.rowId=escapeString(this.rowNode.id),this.rowId!=null&&comp.setRowId(this.rowId)}executeSlideAndFadeAnimations(gui){const{containerType}=gui;this.slideInAnimation[containerType]&&(executeNextVMTurn(()=>{this.onTopChanged()}),this.slideInAnimation[containerType]=!1),this.fadeInAnimation[containerType]&&(executeNextVMTurn(()=>{gui.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[containerType]=!1)}addRowDraggerToRow(gui){if(this.gridOptionsService.get("enableRangeSelection")){warnOnce("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");return}const translate=this.beans.localeService.getLocaleTextFunc(),rowDragComp=new RowDragComp(()=>`1 ${translate("rowDragRow","row")}`,this.rowNode,void 0,gui.element,void 0,!0),rowDragBean=this.createBean(rowDragComp,this.beans.context);this.rowDragComps.push(rowDragBean)}setupFullWidth(gui){const pinned=this.getPinnedForContainer(gui.containerType);if(this.rowType=="FullWidthDetail"&&!ModuleRegistry.__assertRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;const compDetails=this.createFullWidthCompDetails(gui.element,pinned);gui.rowComp.showFullWidth(compDetails)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var _a273,_b;return this.gridOptionsService.get("embedFullWidthRows")?this.allRowGuis.map(gui=>{var _a274;return(_a274=gui==null?void 0:gui.rowComp)==null?void 0:_a274.getFullWidthCellRenderer()}):[(_b=(_a273=this.fullWidthGui)==null?void 0:_a273.rowComp)==null?void 0:_b.getFullWidthCellRenderer()]}getCellElement(column){const cellCtrl=this.getCellCtrl(column);return cellCtrl?cellCtrl.getGui():null}executeProcessRowPostCreateFunc(){const func=this.gridOptionsService.getCallback("processRowPostCreate");if(!func||!this.areAllContainersReady())return;const params={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};func(params)}areAllContainersReady(){const isLeftReady=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),isCenterReady=!!this.centerGui,isRightReady=!!this.rightGui||!this.beans.columnModel.isPinningRight();return isLeftReady&&isCenterReady&&isRightReady}setRowType(){const isStub=this.rowNode.stub,isFullWidthCell=this.rowNode.isFullWidthCell(),isDetailCell=this.gridOptionsService.get("masterDetail")&&this.rowNode.detail,pivotMode=this.beans.columnModel.isPivotMode(),isFullWidthGroup=!!this.rowNode.group&&!this.rowNode.footer&&this.gridOptionsService.isGroupUseEntireRow(pivotMode);isStub?this.rowType="FullWidthLoading":isDetailCell?this.rowType="FullWidthDetail":isFullWidthCell?this.rowType="FullWidth":isFullWidthGroup?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(suppressAnimationFrame=!1,useFlushSync=!1){if(this.isFullWidth())return;if(suppressAnimationFrame||this.gridOptionsService.get("suppressAnimationFrame")||this.printLayout){this.updateColumnListsImpl(useFlushSync);return}this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(prev,cols,pinned=null){const res={list:[],map:{}},addCell=__name((colInstanceId,cellCtrl)=>{res.list.push(cellCtrl),res.map[colInstanceId]=cellCtrl},"addCell");return cols.forEach(col=>{const colInstanceId=col.getInstanceId();let cellCtrl=prev.map[colInstanceId];cellCtrl||(cellCtrl=new CellCtrl(col,this.rowNode,this.beans,this)),addCell(colInstanceId,cellCtrl)}),prev.list.forEach(prevCellCtrl=>{if(res.map[prevCellCtrl.getColumn().getInstanceId()]!=null)return;if(!this.isCellEligibleToBeRemoved(prevCellCtrl,pinned)){addCell(prevCellCtrl.getColumn().getInstanceId(),prevCellCtrl);return}prevCellCtrl.destroy()}),res}updateColumnListsImpl(useFlushSync){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(useFlushSync)}setCellCtrls(useFlushSync){this.allRowGuis.forEach(item=>{const cellControls=this.getCellCtrlsForContainer(item.containerType);item.rowComp.setCellCtrls(cellControls,useFlushSync)})}getCellCtrlsForContainer(containerType){switch(containerType){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list;default:const exhaustiveCheck=containerType;throw new Error(`Unhandled case: ${exhaustiveCheck}`)}}createAllCellCtrls(){const columnModel=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,columnModel.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const centerCols=columnModel.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,centerCols);const leftCols=columnModel.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,leftCols,"left");const rightCols=columnModel.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,rightCols,"right")}}isCellEligibleToBeRemoved(cellCtrl,nextContainerPinned){if(cellCtrl.getColumn().getPinned()!=nextContainerPinned)return!0;const editing=cellCtrl.isEditing(),focused=this.beans.focusService.isCellFocused(cellCtrl.getCellPosition());if(editing||focused){const column2=cellCtrl.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(column2)>=0)}return!0}getDomOrder(){return this.gridOptionsService.get("ensureDomOrder")||this.gridOptionsService.isDomLayout("print")}listenOnDomOrder(gui){const listener=__name(()=>{gui.rowComp.setDomOrder(this.getDomOrder())},"listener");this.addManagedPropertyListener("domLayout",listener),this.addManagedPropertyListener("ensureDomOrder",listener)}setAnimateFlags(animateIn){if(this.isSticky()||!animateIn)return;const oldRowTopExists=exists(this.rowNode.oldRowTop),pinningLeft=this.beans.columnModel.isPinningLeft(),pinningRight=this.beans.columnModel.isPinningRight();if(oldRowTopExists){if(this.isFullWidth()&&!this.gridOptionsService.get("embedFullWidthRows")){this.slideInAnimation.fullWidth=!0;return}this.slideInAnimation.center=!0,this.slideInAnimation.left=pinningLeft,this.slideInAnimation.right=pinningRight}else{if(this.isFullWidth()&&!this.gridOptionsService.get("embedFullWidthRows")){this.fadeInAnimation.fullWidth=!0;return}this.fadeInAnimation.center=!0,this.fadeInAnimation.left=pinningLeft,this.fadeInAnimation.right=pinningRight}}isEditing(){return this.editingRow}isFullWidth(){return this.rowType!=="Normal"}getRowType(){return this.rowType}refreshFullWidth(){const tryRefresh=__name((gui,pinned)=>gui?gui.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(gui.element,pinned).params):!0,"tryRefresh"),fullWidthSuccess=tryRefresh(this.fullWidthGui,null),centerSuccess=tryRefresh(this.centerGui,null),leftSuccess=tryRefresh(this.leftGui,"left"),rightSuccess=tryRefresh(this.rightGui,"right");return fullWidthSuccess&&centerSuccess&&leftSuccess&&rightSuccess}addListeners(){this.addManagedListener(this.rowNode,RowNode.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,RowNode.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.postProcessCss.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DRAGGING_CHANGED,this.postProcessRowDragging.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const eventService=this.beans.eventService;this.addManagedListener(eventService,Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_MODEL_UPDATED,this.refreshFirstAndLastRowStyles.bind(this)),this.addManagedListener(eventService,Events.EVENT_COLUMN_MOVED,this.updateColumnLists.bind(this)),this.addDestroyFunc(()=>{this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{if(this.gridOptionsService.get("rowDragEntireRow")){this.allRowGuis.forEach(gui=>{this.addRowDraggerToRow(gui)});return}this.destroyBeans(this.rowDragComps,this.beans.context),this.rowDragComps=[]}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onRowIndexChanged())}),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,event=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onCellChanged(event))})}onRowNodeDataChanged(event){if(this.isFullWidth()!==!!this.rowNode.isFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.refreshCell({suppressFlash:!event.update,newData:!event.update})),this.allRowGuis.forEach(gui=>{this.setRowCompRowId(gui.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(gui.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const highlighted=this.rowNode.highlighted;this.allRowGuis.forEach(gui=>{const aboveOn=highlighted===0,belowOn=highlighted===1;gui.rowComp.addOrRemoveCssClass("ag-row-highlight-above",aboveOn),gui.rowComp.addOrRemoveCssClass("ag-row-highlight-below",belowOn)})}postProcessRowDragging(){const dragging=this.rowNode.dragging;this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-dragging",dragging))}updateExpandedCss(){const expandable=this.rowNode.isExpandable(),expanded=this.rowNode.expanded==!0;this.allRowGuis.forEach(gui=>{gui.rowComp.addOrRemoveCssClass("ag-row-group",expandable),gui.rowComp.addOrRemoveCssClass("ag-row-group-expanded",expandable&&expanded),gui.rowComp.addOrRemoveCssClass("ag-row-group-contracted",expandable&&!expanded),setAriaExpanded(gui.element,expandable&&expanded)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:makeNull(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(keyboardEvent){const currentFullWidthComp=this.allRowGuis.find(c=>c.element.contains(keyboardEvent.target));if(!((currentFullWidthComp?currentFullWidthComp.element:null)===keyboardEvent.target))return;const node=this.rowNode,lastFocusedCell=this.beans.focusService.getFocusedCell(),cellPosition={rowIndex:node.rowIndex,rowPinned:node.rowPinned,column:lastFocusedCell&&lastFocusedCell.column};this.beans.navigationService.navigateToNextCell(keyboardEvent,keyboardEvent.key,cellPosition,!0),keyboardEvent.preventDefault()}onTabKeyDown(keyboardEvent){if(keyboardEvent.defaultPrevented||isStopPropagationForAgGrid(keyboardEvent))return;const currentFullWidthComp=this.allRowGuis.find(c=>c.element.contains(keyboardEvent.target)),currentFullWidthContainer=currentFullWidthComp?currentFullWidthComp.element:null,isFullWidthContainerFocused=currentFullWidthContainer===keyboardEvent.target;let nextEl=null;isFullWidthContainerFocused||(nextEl=this.beans.focusService.findNextFocusableElement(currentFullWidthContainer,!1,keyboardEvent.shiftKey)),(this.isFullWidth()&&isFullWidthContainerFocused||!nextEl)&&this.beans.navigationService.onTabKeyDown(this,keyboardEvent)}onFullWidthRowFocused(event){var _a273;const node=this.rowNode,isFocused=event?this.isFullWidth()&&event.rowIndex===node.rowIndex&&event.rowPinned==node.rowPinned:!1,element=this.fullWidthGui?this.fullWidthGui.element:(_a273=this.centerGui)==null?void 0:_a273.element;element&&(element.classList.toggle("ag-full-width-focus",isFocused),isFocused&&element.focus({preventScroll:!0}))}refreshCell(cellCtrl){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,cellCtrl),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,cellCtrl),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,cellCtrl),this.updateColumnLists()}removeCellCtrl(prev,cellCtrlToRemove){const res={list:[],map:{}};return prev.list.forEach(cellCtrl=>{cellCtrl!==cellCtrlToRemove&&(res.list.push(cellCtrl),res.map[cellCtrl.getInstanceId()]=cellCtrl)}),res}onMouseEvent(eventName,mouseEvent){switch(eventName){case"dblclick":this.onRowDblClick(mouseEvent);break;case"click":this.onRowClick(mouseEvent);break;case"touchstart":case"mousedown":this.onRowMouseDown(mouseEvent);break}}createRowEvent(type,domEvent){return this.gridOptionsService.addGridCommonParams({type,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:domEvent})}createRowEventWithSource(type,domEvent){const event=this.createRowEvent(type,domEvent);return event.source=this,event}onRowDblClick(mouseEvent){if(isStopPropagationForAgGrid(mouseEvent))return;const agEvent=this.createRowEventWithSource(Events.EVENT_ROW_DOUBLE_CLICKED,mouseEvent);this.beans.eventService.dispatchEvent(agEvent)}onRowMouseDown(mouseEvent){if(this.lastMouseDownOnDragger=isElementChildOfClass(mouseEvent.target,"ag-row-drag",3),!this.isFullWidth())return;const node=this.rowNode,columnModel=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:node.rowIndex,column:columnModel.getAllDisplayedColumns()[0],rowPinned:node.rowPinned,forceBrowserFocus:!0})}onRowClick(mouseEvent){if(isStopPropagationForAgGrid(mouseEvent)||this.lastMouseDownOnDragger)return;const agEvent=this.createRowEventWithSource(Events.EVENT_ROW_CLICKED,mouseEvent);this.beans.eventService.dispatchEvent(agEvent);const isMultiKey=mouseEvent.ctrlKey||mouseEvent.metaKey,isShiftKey=mouseEvent.shiftKey;if(this.gridOptionsService.get("groupSelectsChildren")&&this.rowNode.group||this.isRowSelectionBlocked()||this.gridOptionsService.get("suppressRowClickSelection"))return;const multiSelectOnClick=this.gridOptionsService.get("rowMultiSelectWithClick"),rowDeselectionWithCtrl=!this.gridOptionsService.get("suppressRowDeselection"),source="rowClicked";if(this.rowNode.isSelected())multiSelectOnClick?this.rowNode.setSelectedParams({newValue:!1,event:mouseEvent,source}):isMultiKey?rowDeselectionWithCtrl&&this.rowNode.setSelectedParams({newValue:!1,event:mouseEvent,source}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!isShiftKey,rangeSelect:isShiftKey,event:mouseEvent,source});else{const clearSelection=multiSelectOnClick?!1:!isMultiKey;this.rowNode.setSelectedParams({newValue:!0,clearSelection,rangeSelect:isShiftKey,event:mouseEvent,source})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!this.gridOptionsService.isRowSelection()}setupDetailRowAutoHeight(eDetailGui){if(this.rowType!=="FullWidthDetail"||!this.gridOptionsService.get("detailRowAutoHeight"))return;const checkRowSizeFunc=__name(()=>{const clientHeight=eDetailGui.clientHeight;if(clientHeight!=null&&clientHeight>0){const updateRowHeightFunc=__name(()=>{this.rowNode.setRowHeight(clientHeight),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()},"updateRowHeightFunc");window.setTimeout(updateRowHeightFunc,0)}},"checkRowSizeFunc"),resizeObserverDestroyFunc=this.beans.resizeObserverService.observeResize(eDetailGui,checkRowSizeFunc);this.addDestroyFunc(resizeObserverDestroyFunc),checkRowSizeFunc()}createFullWidthCompDetails(eRow,pinned){const params=this.gridOptionsService.addGridCommonParams({fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,eGridCell:eRow,eParentOfValue:eRow,pinned,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(rowDraggerElement,dragStartPixels,value,suppressVisibilityChange)=>this.addFullWidthRowDragging(rowDraggerElement,dragStartPixels,value,suppressVisibilityChange),setTooltip:(value,shouldDisplayTooltip)=>this.refreshRowTooltip(value,shouldDisplayTooltip)});switch(this.rowType){case"FullWidthDetail":return this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(params);case"FullWidthGroup":return this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(params);case"FullWidthLoading":return this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(params);default:return this.beans.userComponentFactory.getFullWidthCellRendererDetails(params)}}refreshRowTooltip(value,shouldDisplayTooltip){if(!this.fullWidthGui)return;const tooltipParams={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>value,getLocation:()=>"fullWidthRow",shouldDisplayTooltip};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new TooltipFeature(tooltipParams,this.beans))}addFullWidthRowDragging(rowDraggerElement,dragStartPixels,value="",suppressVisibilityChange){if(!this.isFullWidth())return;const rowDragComp=new RowDragComp(()=>value,this.rowNode,void 0,rowDraggerElement,dragStartPixels,suppressVisibilityChange);this.createBean(rowDragComp,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(rowDragComp,this.beans.context)})}onUiLevelChanged(){const newLevel=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=newLevel){const classToAdd="ag-row-level-"+newLevel,classToRemove="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(gui=>{gui.rowComp.addOrRemoveCssClass(classToAdd,!0),gui.rowComp.addOrRemoveCssClass(classToRemove,!1)})}this.rowLevel=newLevel}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}refreshFirstAndLastRowStyles(){const newFirst=this.isFirstRowOnPage(),newLast=this.isLastRowOnPage();this.firstRowOnPage!==newFirst&&(this.firstRowOnPage=newFirst,this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-first",newFirst))),this.lastRowOnPage!==newLast&&(this.lastRowOnPage=newLast,this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-last",newLast)))}stopEditing(cancel=!1){if(this.stoppingRowEdit)return;const cellControls=this.getAllCellCtrls(),isRowEdit=this.editingRow;this.stoppingRowEdit=!0;let fireRowEditEvent=!1;for(const ctrl of cellControls){const valueChanged=ctrl.stopEditing(cancel);isRowEdit&&!cancel&&!fireRowEditEvent&&valueChanged&&(fireRowEditEvent=!0)}if(fireRowEditEvent){const event=this.createRowEvent(Events.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(event)}isRowEdit&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(editing){this.allRowGuis.forEach(gui=>{gui.rowComp.addOrRemoveCssClass("ag-row-inline-editing",editing),gui.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!editing)})}setEditingRow(value){this.editingRow=value,this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-editing",value));const event=value?this.createRowEvent(Events.EVENT_ROW_EDITING_STARTED):this.createRowEvent(Events.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(event)}startRowEditing(key=null,sourceRenderedCell=null,event=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((prev,cellCtrl)=>{const cellStartedEdit=cellCtrl===sourceRenderedCell;return cellStartedEdit?cellCtrl.startEditing(key,cellStartedEdit,event):cellCtrl.startEditing(null,cellStartedEdit,event),prev?!0:cellCtrl.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const cssClasses=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!cssClasses||!cssClasses.length||cssClasses.forEach(classStr=>{this.allRowGuis.forEach(c=>c.rowComp.addOrRemoveCssClass(classStr,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,className=>{this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass(className,!0))},className=>{this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass(className,!1))})}setStylesFromGridOptions(updateStyles,gui){updateStyles&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(gui,gui2=>gui2.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(rowContainerType){return rowContainerType==="left"?"left":rowContainerType==="right"?"right":null}getInitialRowClasses(rowContainerType){const pinned=this.getPinnedForContainer(rowContainerType),params={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[rowContainerType],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned};return this.beans.rowCssClassCalculator.getInitialRowClasses(params)}processStylesFromGridOptions(){const rowStyle=this.gridOptionsService.get("rowStyle");if(rowStyle&&typeof rowStyle=="function"){console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");return}const rowStyleFunc=this.gridOptionsService.getCallback("getRowStyle");let rowStyleFuncResult;if(rowStyleFunc){const params={data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex};rowStyleFuncResult=rowStyleFunc(params)}return rowStyleFuncResult||rowStyle?Object.assign({},rowStyle,rowStyleFuncResult):this.emptyStyle}onRowSelected(gui){const eDocument=this.beans.gridOptionsService.getDocument(),selected=!!this.rowNode.isSelected();this.forEachGui(gui,gui2=>{gui2.rowComp.addOrRemoveCssClass("ag-row-selected",selected),setAriaSelected(gui2.element,selected),gui2.element.contains(eDocument.activeElement)&&(gui2===this.centerGui||gui2===this.fullWidthGui)&&this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const selected=this.rowNode.isSelected();if(selected&&this.beans.gridOptionsService.get("suppressRowDeselection"))return;const label=this.beans.localeService.getLocaleTextFunc()(selected?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${selected?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(label)}isUseAnimationFrameForCreate(){return this.useAnimationFrameForCreate}addHoverFunctionality(eRow){this.active&&(this.addManagedListener(eRow,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(eRow,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,RowNode.EVENT_MOUSE_ENTER,()=>{!this.beans.dragService.isDragging()&&!this.gridOptionsService.get("suppressRowHoverHighlight")&&(eRow.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,RowNode.EVENT_MOUSE_LEAVE,()=>{eRow.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(rowTop){const range=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),minPixel=this.applyPaginationOffset(range.top,!0)-100,maxPixel=this.applyPaginationOffset(range.bottom,!0)+100;return Math.min(Math.max(minPixel,rowTop),maxPixel)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(gui,callback){gui?callback(gui):this.allRowGuis.forEach(callback)}onRowHeightChanged(gui){if(this.rowNode.rowHeight==null)return;const rowHeight=this.rowNode.rowHeight,defaultRowHeight=this.beans.environment.getDefaultRowHeight(),heightFromFunc=this.gridOptionsService.isGetRowHeightFunction()?this.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,lineHeight=heightFromFunc?`${Math.min(defaultRowHeight,heightFromFunc)-2}px`:void 0;this.forEachGui(gui,gui2=>{gui2.element.style.height=`${rowHeight}px`,lineHeight&&gui2.element.style.setProperty("--ag-line-height",lineHeight)})}addEventListener(eventType,listener){super.addEventListener(eventType,listener)}removeEventListener(eventType,listener){super.removeEventListener(eventType,listener)}destroyFirstPass(suppressAnimation=!1){if(this.active=!1,!suppressAnimation&&this.gridOptionsService.isAnimateRows()&&!this.isSticky())if(this.rowNode.rowTop!=null){const rowTop=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(rowTop)}else this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.rowNode.setHovered(!1);const event=this.createRowEvent(Events.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(event),this.beans.eventService.dispatchEvent(event),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const destroyCellCtrls=__name(ctrls=>(ctrls.list.forEach(c=>c.destroy()),{list:[],map:{}}),"destroyCellCtrls");this.centerCellCtrls=destroyCellCtrls(this.centerCellCtrls),this.leftCellCtrls=destroyCellCtrls(this.leftCellCtrls),this.rightCellCtrls=destroyCellCtrls(this.rightCellCtrls)}setFocusedClasses(gui){this.forEachGui(gui,gui2=>{gui2.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),gui2.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const rowFocused=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);rowFocused!==this.rowFocused&&(this.rowFocused=rowFocused,this.setFocusedClasses()),!rowFocused&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const currentPage=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==currentPage&&(this.paginationPage=currentPage,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(topPx,reverse=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return topPx;const pixelOffset=this.beans.paginationProxy.getPixelOffset();return topPx+pixelOffset*(reverse?1:-1)}setRowTop(pixels){if(!this.printLayout&&exists(pixels)){const afterPaginationPixels=this.applyPaginationOffset(pixels),topPx=`${this.rowNode.isRowPinned()||this.rowNode.sticky?afterPaginationPixels:this.beans.rowContainerHeightService.getRealPixelPosition(afterPaginationPixels)}px`;this.setRowTopStyle(topPx)}}getInitialRowTop(rowContainerType){return this.suppressRowTransform?this.getInitialRowTopShared(rowContainerType):void 0}getInitialTransform(rowContainerType){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(rowContainerType)})`}getInitialRowTopShared(rowContainerType){if(this.printLayout)return"";let rowTop;if(this.isSticky())rowTop=this.rowNode.stickyRowTop;else{const pixels=this.slideInAnimation[rowContainerType]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,afterPaginationPixels=this.applyPaginationOffset(pixels);rowTop=this.rowNode.isRowPinned()?afterPaginationPixels:this.beans.rowContainerHeightService.getRealPixelPosition(afterPaginationPixels)}return rowTop+"px"}setRowTopStyle(topPx){this.allRowGuis.forEach(gui=>this.suppressRowTransform?gui.rowComp.setTop(topPx):gui.rowComp.setTransform(`translateY(${topPx})`))}getRowNode(){return this.rowNode}getCellCtrl(column){let res=null;return this.getAllCellCtrls().forEach(cellCtrl=>{cellCtrl.getColumn()==column&&(res=cellCtrl)}),res!=null||this.getAllCellCtrls().forEach(cellCtrl=>{cellCtrl.getColSpanningList().indexOf(column)>=0&&(res=cellCtrl)}),res}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(gui){const rowIndexStr=this.rowNode.getRowIndexString(),headerRowCount=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),rowIsEven=this.rowNode.rowIndex%2===0,ariaRowIndex=headerRowCount+this.rowNode.rowIndex+1;this.forEachGui(gui,c=>{c.rowComp.setRowIndex(rowIndexStr),c.rowComp.addOrRemoveCssClass("ag-row-even",rowIsEven),c.rowComp.addOrRemoveCssClass("ag-row-odd",!rowIsEven),setAriaRowIndex(c.element,ariaRowIndex)})}},__name(_a119,"_RowCtrl"),_a119);_RowCtrl.DOM_DATA_KEY_ROW_CTRL="renderedRow";var RowCtrl=_RowCtrl,_a120,RowContainerEventsFeature=(_a120=class extends BeanStub{constructor(element){super(),this.element=element}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const eventName="keydown",listener=this.processKeyboardEvent.bind(this,eventName);this.addManagedListener(this.element,eventName,listener)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",isEventSupported("touchstart")?"touchstart":"mousedown"].forEach(eventName=>{const listener=this.processMouseEvent.bind(this,eventName);this.addManagedListener(this.element,eventName,listener)})}processMouseEvent(eventName,mouseEvent){if(!this.mouseEventService.isEventFromThisGrid(mouseEvent)||isStopPropagationForAgGrid(mouseEvent))return;const rowComp=this.getRowForEvent(mouseEvent),cellCtrl=this.mouseEventService.getRenderedCellForEvent(mouseEvent);eventName==="contextmenu"?this.handleContextMenuMouseEvent(mouseEvent,void 0,rowComp,cellCtrl):(cellCtrl&&cellCtrl.onMouseEvent(eventName,mouseEvent),rowComp&&rowComp.onMouseEvent(eventName,mouseEvent))}mockContextMenuForIPad(){if(!isIOSUserAgent())return;const touchListener=new TouchListener(this.element),longTapListener=__name(event=>{const rowComp=this.getRowForEvent(event.touchEvent),cellComp=this.mouseEventService.getRenderedCellForEvent(event.touchEvent);this.handleContextMenuMouseEvent(void 0,event.touchEvent,rowComp,cellComp)},"longTapListener");this.addManagedListener(touchListener,TouchListener.EVENT_LONG_TAP,longTapListener),this.addDestroyFunc(()=>touchListener.destroy())}getRowForEvent(event){let sourceElement=event.target;for(;sourceElement;){const rowCon=this.gridOptionsService.getDomData(sourceElement,RowCtrl.DOM_DATA_KEY_ROW_CTRL);if(rowCon)return rowCon;sourceElement=sourceElement.parentElement}return null}handleContextMenuMouseEvent(mouseEvent,touchEvent,rowComp,cellCtrl){const rowNode=rowComp?rowComp.getRowNode():null,column=cellCtrl?cellCtrl.getColumn():null;let value=null;if(column){const event=mouseEvent||touchEvent;cellCtrl.dispatchCellContextMenuEvent(event??null),value=this.valueService.getValue(column,rowNode)}const gridBodyCon=this.ctrlsService.getGridBodyCtrl(),anchorToElement=cellCtrl?cellCtrl.getGui():gridBodyCon.getGridBodyElement();this.menuService.showContextMenu({mouseEvent,touchEvent,rowNode,column,value,anchorToElement})}getControlsForEventTarget(target){return{cellCtrl:getCtrlForEventTarget(this.gridOptionsService,target,CellCtrl.DOM_DATA_KEY_CELL_CTRL),rowCtrl:getCtrlForEventTarget(this.gridOptionsService,target,RowCtrl.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(eventName,keyboardEvent){const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(keyboardEvent.target);keyboardEvent.defaultPrevented||(cellCtrl?this.processCellKeyboardEvent(cellCtrl,eventName,keyboardEvent):rowCtrl&&rowCtrl.isFullWidth()&&this.processFullWidthRowKeyboardEvent(rowCtrl,eventName,keyboardEvent))}processCellKeyboardEvent(cellCtrl,eventName,keyboardEvent){const rowNode=cellCtrl.getRowNode(),column=cellCtrl.getColumn(),editing=cellCtrl.isEditing();if(!isUserSuppressingKeyboardEvent(this.gridOptionsService,keyboardEvent,rowNode,column,editing)&&eventName==="keydown"&&(!editing&&this.navigationService.handlePageScrollingKey(keyboardEvent)||cellCtrl.onKeyDown(keyboardEvent),this.doGridOperations(keyboardEvent,cellCtrl.isEditing()),isEventFromPrintableCharacter(keyboardEvent)&&cellCtrl.processCharacter(keyboardEvent)),eventName==="keydown"){const cellKeyDownEvent=cellCtrl.createEvent(keyboardEvent,Events.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(cellKeyDownEvent)}}processFullWidthRowKeyboardEvent(rowComp,eventName,keyboardEvent){const rowNode=rowComp.getRowNode(),focusedCell=this.focusService.getFocusedCell(),column=focusedCell&&focusedCell.column;if(!isUserSuppressingKeyboardEvent(this.gridOptionsService,keyboardEvent,rowNode,column,!1)){const key=keyboardEvent.key;if(eventName==="keydown")switch(key){case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:case KeyCode.PAGE_UP:case KeyCode.PAGE_DOWN:this.navigationService.handlePageScrollingKey(keyboardEvent,!0);break;case KeyCode.UP:case KeyCode.DOWN:rowComp.onKeyboardNavigate(keyboardEvent);break;case KeyCode.TAB:rowComp.onTabKeyDown(keyboardEvent);break}}if(eventName==="keydown"){const cellKeyDownEvent=rowComp.createRowEvent(Events.EVENT_CELL_KEY_DOWN,keyboardEvent);this.eventService.dispatchEvent(cellKeyDownEvent)}}doGridOperations(keyboardEvent,editing){if(!keyboardEvent.ctrlKey&&!keyboardEvent.metaKey||editing||!this.mouseEventService.isEventFromThisGrid(keyboardEvent))return;const keyCode=normaliseQwertyAzerty(keyboardEvent);if(keyCode===KeyCode.A)return this.onCtrlAndA(keyboardEvent);if(keyCode===KeyCode.C)return this.onCtrlAndC(keyboardEvent);if(keyCode===KeyCode.D)return this.onCtrlAndD(keyboardEvent);if(keyCode===KeyCode.V)return this.onCtrlAndV(keyboardEvent);if(keyCode===KeyCode.X)return this.onCtrlAndX(keyboardEvent);if(keyCode===KeyCode.Y)return this.onCtrlAndY();if(keyCode===KeyCode.Z)return this.onCtrlAndZ(keyboardEvent)}onCtrlAndA(event){const{pinnedRowModel,paginationProxy,rangeService}=this;if(rangeService&&paginationProxy.isRowsToRender()){const[isEmptyPinnedTop,isEmptyPinnedBottom]=[pinnedRowModel.isEmpty("top"),pinnedRowModel.isEmpty("bottom")],floatingStart=isEmptyPinnedTop?null:"top";let floatingEnd,rowEnd;isEmptyPinnedBottom?(floatingEnd=null,rowEnd=this.paginationProxy.getRowCount()-1):(floatingEnd="bottom",rowEnd=pinnedRowModel.getPinnedBottomRowData().length-1);const allDisplayedColumns=this.columnModel.getAllDisplayedColumns();if(missingOrEmpty(allDisplayedColumns))return;rangeService.setCellRange({rowStartIndex:0,rowStartPinned:floatingStart,rowEndIndex:rowEnd,rowEndPinned:floatingEnd,columnStart:allDisplayedColumns[0],columnEnd:last(allDisplayedColumns)})}event.preventDefault()}onCtrlAndC(event){if(!this.clipboardService||this.gridOptionsService.get("enableCellTextSelection"))return;const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(event.target);cellCtrl!=null&&cellCtrl.isEditing()||rowCtrl!=null&&rowCtrl.isEditing()||(event.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(event){if(!this.clipboardService||this.gridOptionsService.get("enableCellTextSelection")||this.gridOptionsService.get("suppressCutToClipboard"))return;const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(event.target);cellCtrl!=null&&cellCtrl.isEditing()||rowCtrl!=null&&rowCtrl.isEditing()||(event.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(event){const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(event.target);cellCtrl!=null&&cellCtrl.isEditing()||rowCtrl!=null&&rowCtrl.isEditing()||this.clipboardService&&!this.gridOptionsService.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(event){this.clipboardService&&!this.gridOptionsService.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),event.preventDefault()}onCtrlAndZ(event){this.gridOptionsService.get("undoRedoCellEditing")&&(event.preventDefault(),event.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}},__name(_a120,"RowContainerEventsFeature"),_a120);__decorateClass([Autowired("mouseEventService")],RowContainerEventsFeature.prototype,"mouseEventService",2);__decorateClass([Autowired("valueService")],RowContainerEventsFeature.prototype,"valueService",2);__decorateClass([Autowired("menuService")],RowContainerEventsFeature.prototype,"menuService",2);__decorateClass([Autowired("ctrlsService")],RowContainerEventsFeature.prototype,"ctrlsService",2);__decorateClass([Autowired("navigationService")],RowContainerEventsFeature.prototype,"navigationService",2);__decorateClass([Autowired("focusService")],RowContainerEventsFeature.prototype,"focusService",2);__decorateClass([Autowired("undoRedoService")],RowContainerEventsFeature.prototype,"undoRedoService",2);__decorateClass([Autowired("columnModel")],RowContainerEventsFeature.prototype,"columnModel",2);__decorateClass([Autowired("paginationProxy")],RowContainerEventsFeature.prototype,"paginationProxy",2);__decorateClass([Autowired("pinnedRowModel")],RowContainerEventsFeature.prototype,"pinnedRowModel",2);__decorateClass([Optional("rangeService")],RowContainerEventsFeature.prototype,"rangeService",2);__decorateClass([Optional("clipboardService")],RowContainerEventsFeature.prototype,"clipboardService",2);__decorateClass([PostConstruct],RowContainerEventsFeature.prototype,"postConstruct",1);var _a121,ViewportSizeFeature=(_a121=class extends BeanStub{constructor(centerContainerCtrl){super(),this.centerContainerCtrl=centerContainerCtrl}postConstruct(){this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),this.listenForResize()}),this.addManagedListener(this.eventService,Events.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this)),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const listener=__name(()=>this.onCenterViewportResized(),"listener");this.centerContainerCtrl.registerViewportResizeListener(listener),this.gridBodyCtrl.registerBodyViewportResizeListener(listener)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const newWidth=this.centerContainerCtrl.getCenterWidth();newWidth!==this.centerWidth&&(this.centerWidth=newWidth,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const eBodyViewport=this.gridBodyCtrl.getBodyViewportElement(),bodyWidth=getInnerWidth(eBodyViewport);if(bodyWidth<=50)return;let columnsToRemove=this.getPinnedColumnsOverflowingViewport(bodyWidth-50);const processUnpinnedColumns=this.gridOptionsService.getCallback("processUnpinnedColumns");columnsToRemove.length&&(processUnpinnedColumns&&(columnsToRemove=processUnpinnedColumns({columns:columnsToRemove,viewportWidth:bodyWidth})),this.columnModel.setColumnsPinned(columnsToRemove,null,"viewportSizeFeature"))}getPinnedColumnsOverflowingViewport(viewportWidth){const pinnedRightWidth=this.pinnedWidthService.getPinnedRightWidth(),pinnedLeftWidth=this.pinnedWidthService.getPinnedLeftWidth(),totalPinnedWidth=pinnedRightWidth+pinnedLeftWidth;if(totalPinnedWidth<viewportWidth)return[];const pinnedLeftColumns=[...this.columnModel.getDisplayedLeftColumns()],pinnedRightColumns=[...this.columnModel.getDisplayedRightColumns()];let indexRight=0,indexLeft=0,totalWidthRemoved=0;const columnsToRemove=[];let spaceNecessary=totalPinnedWidth-totalWidthRemoved-viewportWidth;for(;(indexLeft<pinnedLeftColumns.length||indexRight<pinnedRightColumns.length)&&spaceNecessary>0;){if(indexRight<pinnedRightColumns.length){const currentColumn=pinnedRightColumns[indexRight++];spaceNecessary-=currentColumn.getActualWidth(),columnsToRemove.push(currentColumn)}if(indexLeft<pinnedLeftColumns.length&&spaceNecessary>0){const currentColumn=pinnedLeftColumns[indexLeft++];spaceNecessary-=currentColumn.getActualWidth(),columnsToRemove.push(currentColumn)}}return columnsToRemove}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const eBodyViewport=this.gridBodyCtrl.getBodyViewportElement(),bodyHeight=getInnerHeight(eBodyViewport);if(this.bodyHeight!==bodyHeight){this.bodyHeight=bodyHeight;const event={type:Events.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(event)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const params={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(params)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const scrollWidth=this.centerContainerCtrl.getCenterWidth(),scrollPosition=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(scrollWidth,scrollPosition)}},__name(_a121,"ViewportSizeFeature"),_a121);__decorateClass([Autowired("ctrlsService")],ViewportSizeFeature.prototype,"ctrlsService",2);__decorateClass([Autowired("pinnedWidthService")],ViewportSizeFeature.prototype,"pinnedWidthService",2);__decorateClass([Autowired("columnModel")],ViewportSizeFeature.prototype,"columnModel",2);__decorateClass([Autowired("scrollVisibleService")],ViewportSizeFeature.prototype,"scrollVisibleService",2);__decorateClass([PostConstruct],ViewportSizeFeature.prototype,"postConstruct",1);var _a122,SetPinnedLeftWidthFeature=(_a122=class extends BeanStub{constructor(element){super(),this.element=element}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const leftWidth=this.pinnedWidthService.getPinnedLeftWidth(),displayed=leftWidth>0;setDisplayed(this.element,displayed),setFixedWidth(this.element,leftWidth)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}},__name(_a122,"SetPinnedLeftWidthFeature"),_a122);__decorateClass([Autowired("pinnedWidthService")],SetPinnedLeftWidthFeature.prototype,"pinnedWidthService",2);__decorateClass([PostConstruct],SetPinnedLeftWidthFeature.prototype,"postConstruct",1);var _a123,SetPinnedRightWidthFeature=(_a123=class extends BeanStub{constructor(element){super(),this.element=element}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const rightWidth=this.pinnedWidthService.getPinnedRightWidth(),displayed=rightWidth>0;setDisplayed(this.element,displayed),setFixedWidth(this.element,rightWidth)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}},__name(_a123,"SetPinnedRightWidthFeature"),_a123);__decorateClass([Autowired("pinnedWidthService")],SetPinnedRightWidthFeature.prototype,"pinnedWidthService",2);__decorateClass([PostConstruct],SetPinnedRightWidthFeature.prototype,"postConstruct",1);var _a124,SetHeightFeature=(_a124=class extends BeanStub{constructor(eContainer,eViewport){super(),this.eContainer=eContainer,this.eViewport=eViewport}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const height=this.maxDivHeightScaler.getUiContainerHeight(),heightString=height!=null?`${height}px`:"";this.eContainer.style.height=heightString,this.eViewport&&(this.eViewport.style.height=heightString)}},__name(_a124,"SetHeightFeature"),_a124);__decorateClass([Autowired("rowContainerHeightService")],SetHeightFeature.prototype,"maxDivHeightScaler",2);__decorateClass([PostConstruct],SetHeightFeature.prototype,"postConstruct",1);var _a125,DragListenerFeature=(_a125=class extends BeanStub{constructor(eContainer){super(),this.eContainer=eContainer}postConstruct(){if(missing(this.rangeService))return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListener("enableRangeSelection",props=>{if(props.currentValue){this.enableFeature();return}this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature()),this.gridOptionsService.get("enableRangeSelection")&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}},__name(_a125,"DragListenerFeature"),_a125);__decorateClass([Optional("rangeService")],DragListenerFeature.prototype,"rangeService",2);__decorateClass([Autowired("dragService")],DragListenerFeature.prototype,"dragService",2);__decorateClass([PostConstruct],DragListenerFeature.prototype,"postConstruct",1);var _a126,CenterWidthFeature=(_a126=class extends BeanStub{constructor(callback,addSpacer=!1){super(),this.callback=callback,this.addSpacer=addSpacer}postConstruct(){const listener=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",listener),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,listener),this.addSpacer&&(this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLLBAR_WIDTH_CHANGED,listener)),this.setWidth()}setWidth(){const{columnModel}=this,printLayout=this.gridOptionsService.isDomLayout("print"),centerWidth=columnModel.getBodyContainerWidth(),leftWidth=columnModel.getDisplayedColumnsLeftWidth(),rightWidth=columnModel.getDisplayedColumnsRightWidth();let totalWidth;printLayout?totalWidth=centerWidth+leftWidth+rightWidth:(totalWidth=centerWidth,this.addSpacer&&(this.gridOptionsService.get("enableRtl")?leftWidth:rightWidth)===0&&this.scrollVisibleService.isVerticalScrollShowing()&&(totalWidth+=this.gridOptionsService.getScrollbarWidth())),this.callback(totalWidth)}},__name(_a126,"CenterWidthFeature"),_a126);__decorateClass([Autowired("columnModel")],CenterWidthFeature.prototype,"columnModel",2);__decorateClass([Autowired("scrollVisibleService")],CenterWidthFeature.prototype,"scrollVisibleService",2);__decorateClass([PostConstruct],CenterWidthFeature.prototype,"postConstruct",1);var RowContainerName=(RowContainerName2=>(RowContainerName2.LEFT="left",RowContainerName2.RIGHT="right",RowContainerName2.CENTER="center",RowContainerName2.FULL_WIDTH="fullWidth",RowContainerName2.TOP_LEFT="topLeft",RowContainerName2.TOP_RIGHT="topRight",RowContainerName2.TOP_CENTER="topCenter",RowContainerName2.TOP_FULL_WIDTH="topFullWidth",RowContainerName2.STICKY_TOP_LEFT="stickyTopLeft",RowContainerName2.STICKY_TOP_RIGHT="stickyTopRight",RowContainerName2.STICKY_TOP_CENTER="stickyTopCenter",RowContainerName2.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",RowContainerName2.BOTTOM_LEFT="bottomLeft",RowContainerName2.BOTTOM_RIGHT="bottomRight",RowContainerName2.BOTTOM_CENTER="bottomCenter",RowContainerName2.BOTTOM_FULL_WIDTH="bottomFullWidth",RowContainerName2))(RowContainerName||{});function getRowContainerTypeForName(name){switch(name){case"center":case"topCenter":case"stickyTopCenter":case"bottomCenter":return"center";case"left":case"topLeft":case"stickyTopLeft":case"bottomLeft":return"left";case"right":case"topRight":case"stickyTopRight":case"bottomRight":return"right";case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":return"fullWidth";default:throw Error("Invalid Row Container Type")}}__name(getRowContainerTypeForName,"getRowContainerTypeForName");var ContainerCssClasses=convertToMap([["center","ag-center-cols-container"],["left","ag-pinned-left-cols-container"],["right","ag-pinned-right-cols-container"],["fullWidth","ag-full-width-container"],["topCenter","ag-floating-top-container"],["topLeft","ag-pinned-left-floating-top"],["topRight","ag-pinned-right-floating-top"],["topFullWidth","ag-floating-top-full-width-container"],["stickyTopCenter","ag-sticky-top-container"],["stickyTopLeft","ag-pinned-left-sticky-top"],["stickyTopRight","ag-pinned-right-sticky-top"],["stickyTopFullWidth","ag-sticky-top-full-width-container"],["bottomCenter","ag-floating-bottom-container"],["bottomLeft","ag-pinned-left-floating-bottom"],["bottomRight","ag-pinned-right-floating-bottom"],["bottomFullWidth","ag-floating-bottom-full-width-container"]]),ViewportCssClasses=convertToMap([["center","ag-center-cols-viewport"],["topCenter","ag-floating-top-viewport"],["stickyTopCenter","ag-sticky-top-viewport"],["bottomCenter","ag-floating-bottom-viewport"]]),_a127,_RowContainerCtrl=(_a127=class extends BeanStub{constructor(name){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=name,this.isFullWithContainer=this.name==="topFullWidth"||this.name==="stickyTopFullWidth"||this.name==="bottomFullWidth"||this.name==="fullWidth"}static getRowContainerCssClasses(name){const containerClass=ContainerCssClasses.get(name),viewportClass=ViewportCssClasses.get(name);return{container:containerClass,viewport:viewportClass}}static getPinned(name){switch(name){case"bottomLeft":case"topLeft":case"stickyTopLeft":case"left":return"left";case"bottomRight":case"topRight":case"stickyTopRight":case"right":return"right";default:return null}}postConstruct(){this.enableRtl=this.gridOptionsService.get("enableRtl"),this.forContainers(["center"],()=>this.viewportSizeFeature=this.createManagedBean(new ViewportSizeFeature(this)))}registerWithCtrlsService(){switch(this.name){case"center":this.ctrlsService.registerCenterRowContainerCtrl(this);break;case"left":this.ctrlsService.registerLeftRowContainerCtrl(this);break;case"right":this.ctrlsService.registerRightRowContainerCtrl(this);break;case"topCenter":this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case"topLeft":this.ctrlsService.registerTopLeftRowContainerCon(this);break;case"topRight":this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case"stickyTopCenter":this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case"stickyTopLeft":this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case"stickyTopRight":this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case"bottomCenter":this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case"bottomLeft":this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case"bottomRight":this.ctrlsService.registerBottomRightRowContainerCtrl(this);break}}forContainers(names,callback){names.indexOf(this.name)>=0&&callback()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(view,eContainer,eViewport){this.comp=view,this.eContainer=eContainer,this.eViewport=eViewport,this.createManagedBean(new RowContainerEventsFeature(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const allTopNoFW=["topCenter","topLeft","topRight"],allStickyTopNoFW=["stickyTopCenter","stickyTopLeft","stickyTopRight"],allBottomNoFW=["bottomCenter","bottomLeft","bottomRight"],allMiddleNoFW=["center","left","right"],allNoFW=[...allTopNoFW,...allBottomNoFW,...allMiddleNoFW,...allStickyTopNoFW],allMiddle=["center","left","right","fullWidth"],allCenter=["center","topCenter","stickyTopCenter","bottomCenter"],allLeft=["left","bottomLeft","topLeft","stickyTopLeft"],allRight=["right","bottomRight","topRight","stickyTopRight"];this.forContainers(allLeft,()=>{this.pinnedWidthFeature=this.createManagedBean(new SetPinnedLeftWidthFeature(this.eContainer)),this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(allRight,()=>{this.pinnedWidthFeature=this.createManagedBean(new SetPinnedRightWidthFeature(this.eContainer)),this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(allMiddle,()=>this.createManagedBean(new SetHeightFeature(this.eContainer,this.name==="center"?eViewport:void 0))),this.forContainers(allNoFW,()=>this.createManagedBean(new DragListenerFeature(this.eContainer))),this.forContainers(allCenter,()=>this.createManagedBean(new CenterWidthFeature(width=>this.comp.setContainerWidth(`${width}px`)))),this.addListeners(),this.registerWithCtrlsService()}addListeners(){this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_ROWS_CHANGED,params=>this.onDisplayedRowsChanged(params.afterScroll)),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(["stickyTopCenter","stickyTopLeft","stickyTopRight","stickyTopFullWidth"].indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const listener=__name(()=>{const isEnsureDomOrder=this.gridOptionsService.get("ensureDomOrder"),isPrintLayout=this.gridOptionsService.isDomLayout("print");this.comp.setDomOrder(isEnsureDomOrder||isPrintLayout)},"listener");this.addManagedPropertyListener("domLayout",listener),listener()}stopHScrollOnPinnedRows(){this.forContainers(["topCenter","stickyTopCenter","bottomCenter"],()=>{const resetScrollLeft=__name(()=>this.eViewport.scrollLeft=0,"resetScrollLeft");this.addManagedListener(this.eViewport,"scroll",resetScrollLeft)})}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const preventScroll=__name(e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()},"preventScroll");this.eContainer.addEventListener("touchmove",preventScroll,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",preventScroll))}onHorizontalViewportChanged(afterScroll=!1){const scrollWidth=this.getCenterWidth(),scrollPosition=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(scrollWidth,scrollPosition,afterScroll)}getCenterWidth(){return getInnerWidth(this.eViewport)}getCenterViewportScrollLeft(){return getScrollLeft(this.eViewport,this.enableRtl)}registerViewportResizeListener(listener){const unsubscribeFromResize=this.resizeObserverService.observeResize(this.eViewport,listener);this.addDestroyFunc(()=>unsubscribeFromResize())}isViewportInTheDOMTree(){return isInDOM(this.eViewport)}getViewportScrollLeft(){return getScrollLeft(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gridOptionsService.get("alwaysShowHorizontalScroll")||isHorizontalScrollShowing(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(amount){this.eContainer.style.transform=`translateX(${amount}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(value){setScrollLeft(this.eViewport,value,this.enableRtl)}isContainerVisible(){return!_a127.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const visible=this.isContainerVisible();this.visible!=visible&&(this.visible=visible,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(afterScroll=!1){if(!this.visible){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const printLayout=this.gridOptionsService.isDomLayout("print"),embedFW=this.gridOptionsService.get("embedFullWidthRows")||printLayout,rowsThisContainer=this.getRowCtrls().filter(rowCtrl=>{const fullWidthRow=rowCtrl.isFullWidth();return this.isFullWithContainer?!embedFW&&fullWidthRow:embedFW||!fullWidthRow});this.comp.setRowCtrls({rowCtrls:rowsThisContainer,useFlushSync:afterScroll})}getRowCtrls(){switch(this.name){case"topCenter":case"topLeft":case"topRight":case"topFullWidth":return this.rowRenderer.getTopRowCtrls();case"stickyTopCenter":case"stickyTopLeft":case"stickyTopRight":case"stickyTopFullWidth":return this.rowRenderer.getStickyTopRowCtrls();case"bottomCenter":case"bottomLeft":case"bottomRight":case"bottomFullWidth":return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}}},__name(_a127,"_RowContainerCtrl"),_a127);__decorateClass([Autowired("dragService")],_RowContainerCtrl.prototype,"dragService",2);__decorateClass([Autowired("ctrlsService")],_RowContainerCtrl.prototype,"ctrlsService",2);__decorateClass([Autowired("columnModel")],_RowContainerCtrl.prototype,"columnModel",2);__decorateClass([Autowired("resizeObserverService")],_RowContainerCtrl.prototype,"resizeObserverService",2);__decorateClass([Autowired("rowRenderer")],_RowContainerCtrl.prototype,"rowRenderer",2);__decorateClass([PostConstruct],_RowContainerCtrl.prototype,"postConstruct",1);var RowContainerCtrl=_RowContainerCtrl,GRID_BODY_TEMPLATE=`<div class="ag-root ag-unselectable" role="treegrid">
        <ag-header-root ref="gridHeader"></ag-header-root>
        <div class="ag-floating-top" ref="eTop" role="presentation">
            <ag-row-container ref="topLeftContainer" name="topLeft"></ag-row-container>
            <ag-row-container ref="topCenterContainer" name="topCenter"></ag-row-container>
            <ag-row-container ref="topRightContainer" name="topRight"></ag-row-container>
            <ag-row-container ref="topFullWidthContainer" name="topFullWidth"></ag-row-container>
        </div>
        <div class="ag-body" ref="eBody" role="presentation">
            <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">
                <ag-row-container ref="leftContainer" name="left"></ag-row-container>
                <ag-row-container ref="centerContainer" name="center"></ag-row-container>
                <ag-row-container ref="rightContainer" name="right"></ag-row-container>
                <ag-row-container ref="fullWidthContainer" name="fullWidth"></ag-row-container>
            </div>
            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>
        </div>
        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">
            <ag-row-container ref="stickyTopLeftContainer" name="stickyTopLeft"></ag-row-container>
            <ag-row-container ref="stickyTopCenterContainer" name="stickyTopCenter"></ag-row-container>
            <ag-row-container ref="stickyTopRightContainer" name="stickyTopRight"></ag-row-container>
            <ag-row-container ref="stickyTopFullWidthContainer" name="stickyTopFullWidth"></ag-row-container>
        </div>
        <div class="ag-floating-bottom" ref="eBottom" role="presentation">
            <ag-row-container ref="bottomLeftContainer" name="bottomLeft"></ag-row-container>
            <ag-row-container ref="bottomCenterContainer" name="bottomCenter"></ag-row-container>
            <ag-row-container ref="bottomRightContainer" name="bottomRight"></ag-row-container>
            <ag-row-container ref="bottomFullWidthContainer" name="bottomFullWidth"></ag-row-container>
        </div>
        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>
        <ag-overlay-wrapper></ag-overlay-wrapper>
    </div>`,_a128,GridBodyComp=(_a128=class extends Component{constructor(){super(GRID_BODY_TEMPLATE)}init(){const setHeight=__name((height,element)=>{const heightString=`${height}px`;element.style.minHeight=heightString,element.style.height=heightString},"setHeight"),compProxy={setRowAnimationCssOnBodyViewport:(cssClass,animate)=>this.setRowAnimationCssOnBodyViewport(cssClass,animate),setColumnCount:count=>setAriaColCount(this.getGui(),count),setRowCount:count=>setAriaRowCount(this.getGui(),count),setTopHeight:height=>setHeight(height,this.eTop),setBottomHeight:height=>setHeight(height,this.eBottom),setTopDisplay:display=>this.eTop.style.display=display,setBottomDisplay:display=>this.eBottom.style.display=display,setStickyTopHeight:height=>this.eStickyTop.style.height=height,setStickyTopTop:top=>this.eStickyTop.style.top=top,setStickyTopWidth:width=>this.eStickyTop.style.width=width,setColumnMovingCss:(cssClass,flag)=>this.addOrRemoveCssClass(cssClass,flag),updateLayoutClasses:(cssClass,params)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(classList=>{classList.toggle("ag-layout-auto-height",params.autoHeight),classList.toggle("ag-layout-normal",params.normal),classList.toggle("ag-layout-print",params.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",params.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",params.normal),this.addOrRemoveCssClass("ag-layout-print",params.print)},setAlwaysVerticalScrollClass:(cssClass,on)=>this.eBodyViewport.classList.toggle(CSS_CLASS_FORCE_VERTICAL_SCROLL,on),registerBodyViewportResizeListener:listener=>{const unsubscribeFromResize=this.resizeObserverService.observeResize(this.eBodyViewport,listener);this.addDestroyFunc(()=>unsubscribeFromResize())},setPinnedTopBottomOverflowY:overflow=>this.eTop.style.overflowY=this.eBottom.style.overflowY=overflow,setCellSelectableCss:(cssClass,selectable)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(ct=>ct.classList.toggle(cssClass,selectable))},setBodyViewportWidth:width=>this.eBodyViewport.style.width=width};this.ctrl=this.createManagedBean(new GridBodyCtrl),this.ctrl.setComp(compProxy,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService&&this.gridOptionsService.get("enableRangeSelection")||this.gridOptionsService.get("rowSelection")==="multiple")&&setAriaMultiSelectable(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(cssClass,animateRows){const bodyViewportClassList=this.eBodyViewport.classList;bodyViewportClassList.toggle("ag-row-animation",animateRows),bodyViewportClassList.toggle("ag-row-no-animation",!animateRows)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}},__name(_a128,"GridBodyComp"),_a128);__decorateClass([Autowired("resizeObserverService")],GridBodyComp.prototype,"resizeObserverService",2);__decorateClass([Optional("rangeService")],GridBodyComp.prototype,"rangeService",2);__decorateClass([RefSelector("eBodyViewport")],GridBodyComp.prototype,"eBodyViewport",2);__decorateClass([RefSelector("eStickyTop")],GridBodyComp.prototype,"eStickyTop",2);__decorateClass([RefSelector("eTop")],GridBodyComp.prototype,"eTop",2);__decorateClass([RefSelector("eBottom")],GridBodyComp.prototype,"eBottom",2);__decorateClass([RefSelector("gridHeader")],GridBodyComp.prototype,"headerRootComp",2);__decorateClass([RefSelector("eBody")],GridBodyComp.prototype,"eBody",2);__decorateClass([PostConstruct],GridBodyComp.prototype,"init",1);var _a129,ScrollVisibleService=(_a129=class extends BeanStub{postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateImpl())}):this.updateImpl()}updateImpl(){const centerRowCtrl=this.ctrlsService.getCenterRowContainerCtrl();if(!centerRowCtrl||this.columnAnimationService.isActive())return;const params={horizontalScrollShowing:centerRowCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(params)}setScrollsVisible(params){if(this.horizontalScrollShowing!==params.horizontalScrollShowing||this.verticalScrollShowing!==params.verticalScrollShowing){this.horizontalScrollShowing=params.horizontalScrollShowing,this.verticalScrollShowing=params.verticalScrollShowing;const event={type:Events.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(event)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}},__name(_a129,"ScrollVisibleService"),_a129);__decorateClass([Autowired("ctrlsService")],ScrollVisibleService.prototype,"ctrlsService",2);__decorateClass([Autowired("columnAnimationService")],ScrollVisibleService.prototype,"columnAnimationService",2);__decorateClass([PostConstruct],ScrollVisibleService.prototype,"postConstruct",1);ScrollVisibleService=__decorateClass([Bean("scrollVisibleService")],ScrollVisibleService);var _a130,MouseEventService=(_a130=class extends BeanStub{constructor(){super(...arguments),this.gridInstanceId=MouseEventService.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(eGridDiv){eGridDiv[MouseEventService.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(event){return getCtrlForEventTarget(this.gridOptionsService,event.target,CellCtrl.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(event){return this.isElementInThisGrid(event.target)}isElementInThisGrid(element){let pointer=element;for(;pointer;){const instanceId=pointer[MouseEventService.GRID_DOM_KEY];if(exists(instanceId))return instanceId===this.gridInstanceId;pointer=pointer.parentElement}return!1}getCellPositionForEvent(event){const cellComp=this.getRenderedCellForEvent(event);return cellComp?cellComp.getCellPosition():null}getNormalisedPosition(event){const gridPanelHasScrolls=this.gridOptionsService.isDomLayout("normal"),e=event;let x,y;if(e.clientX!=null||e.clientY!=null?(x=e.clientX,y=e.clientY):(x=e.x,y=e.y),gridPanelHasScrolls){const gridBodyCon=this.ctrlsService.getGridBodyCtrl(),vRange=gridBodyCon.getScrollFeature().getVScrollPosition(),hRange=gridBodyCon.getScrollFeature().getHScrollPosition();x+=hRange.left,y+=vRange.top}return{x,y}}},__name(_a130,"MouseEventService"),_a130);MouseEventService.gridInstanceSequence=new NumberSequence;MouseEventService.GRID_DOM_KEY="__ag_grid_instance";__decorateClass([Autowired("ctrlsService")],MouseEventService.prototype,"ctrlsService",2);MouseEventService=__decorateClass([Bean("mouseEventService")],MouseEventService);var _a131,NavigationService=(_a131=class extends BeanStub{constructor(){super(),this.onPageDown=throttle(this.onPageDown,100),this.onPageUp=throttle(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridBodyCon=p.gridBodyCtrl})}handlePageScrollingKey(event,fromFullWidth=!1){const key=event.key,alt=event.altKey,ctrl=event.ctrlKey||event.metaKey,rangeServiceShouldHandleShift=!!this.rangeService&&event.shiftKey,currentCell=this.mouseEventService.getCellPositionForEvent(event);let processed=!1;switch(key){case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:!ctrl&&!alt&&(this.onHomeOrEndKey(key),processed=!0);break;case KeyCode.LEFT:case KeyCode.RIGHT:case KeyCode.UP:case KeyCode.DOWN:if(!currentCell)return!1;ctrl&&!alt&&!rangeServiceShouldHandleShift&&(this.onCtrlUpDownLeftRight(key,currentCell),processed=!0);break;case KeyCode.PAGE_DOWN:case KeyCode.PAGE_UP:!ctrl&&!alt&&(processed=this.handlePageUpDown(key,currentCell,fromFullWidth));break}return processed&&event.preventDefault(),processed}handlePageUpDown(key,currentCell,fromFullWidth){return fromFullWidth&&(currentCell=this.focusService.getFocusedCell()),currentCell?(key===KeyCode.PAGE_UP?this.onPageUp(currentCell):this.onPageDown(currentCell),!0):!1}navigateTo(navigateParams){const{scrollIndex,scrollType,scrollColumn,focusIndex,focusColumn}=navigateParams;if(exists(scrollColumn)&&!scrollColumn.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(scrollColumn),exists(scrollIndex)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(scrollIndex,scrollType),navigateParams.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(focusIndex),this.focusService.setFocusedCell({rowIndex:focusIndex,column:focusColumn,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){const cellPosition={rowIndex:focusIndex,rowPinned:null,column:focusColumn};this.rangeService.setRangeToCell(cellPosition)}}onPageDown(gridCell){const scrollPosition=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),pixelsInOnePage=this.getViewportHeight(),pagingPixelOffset=this.paginationProxy.getPixelOffset(),currentPageBottomPixel=scrollPosition.top+pixelsInOnePage,currentPageBottomRow=this.paginationProxy.getRowIndexAtPixel(currentPageBottomPixel+pagingPixelOffset);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(gridCell,currentPageBottomRow):this.navigateToNextPage(gridCell,currentPageBottomRow)}onPageUp(gridCell){const scrollPosition=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),pagingPixelOffset=this.paginationProxy.getPixelOffset(),currentPageTopPixel=scrollPosition.top,currentPageTopRow=this.paginationProxy.getRowIndexAtPixel(currentPageTopPixel+pagingPixelOffset);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(gridCell,currentPageTopRow,!0):this.navigateToNextPage(gridCell,currentPageTopRow,!0)}navigateToNextPage(gridCell,scrollIndex,up=!1){const pixelsInOnePage=this.getViewportHeight(),firstRow=this.paginationProxy.getPageFirstRow(),lastRow=this.paginationProxy.getPageLastRow(),pagingPixelOffset=this.paginationProxy.getPixelOffset(),currentRowNode=this.paginationProxy.getRow(gridCell.rowIndex),rowPixelDiff=up?(currentRowNode==null?void 0:currentRowNode.rowHeight)-pixelsInOnePage-pagingPixelOffset:pixelsInOnePage-pagingPixelOffset,nextCellPixel=(currentRowNode==null?void 0:currentRowNode.rowTop)+rowPixelDiff;let focusIndex=this.paginationProxy.getRowIndexAtPixel(nextCellPixel+pagingPixelOffset);if(focusIndex===gridCell.rowIndex){const diff=up?-1:1;scrollIndex=focusIndex=gridCell.rowIndex+diff}let scrollType;up?(scrollType="bottom",focusIndex<firstRow&&(focusIndex=firstRow),scrollIndex<firstRow&&(scrollIndex=firstRow)):(scrollType="top",focusIndex>lastRow&&(focusIndex=lastRow),scrollIndex>lastRow&&(scrollIndex=lastRow)),this.isRowTallerThanView(focusIndex)&&(scrollIndex=focusIndex,scrollType="top"),this.navigateTo({scrollIndex,scrollType,scrollColumn:null,focusIndex,focusColumn:gridCell.column})}navigateToNextPageWithAutoHeight(gridCell,scrollIndex,up=!1){this.navigateTo({scrollIndex,scrollType:up?"bottom":"top",scrollColumn:null,focusIndex:scrollIndex,focusColumn:gridCell.column}),setTimeout(()=>{const focusIndex=this.getNextFocusIndexForAutoHeight(gridCell,up);this.navigateTo({scrollIndex,scrollType:up?"bottom":"top",scrollColumn:null,focusIndex,focusColumn:gridCell.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(gridCell,up=!1){var _a273;const step=up?-1:1,pixelsInOnePage=this.getViewportHeight(),lastRowIndex=this.paginationProxy.getPageLastRow();let pixelSum=0,currentIndex=gridCell.rowIndex;for(;currentIndex>=0&&currentIndex<=lastRowIndex;){const currentCell=this.paginationProxy.getRow(currentIndex);if(currentCell){const currentCellHeight=(_a273=currentCell.rowHeight)!=null?_a273:0;if(pixelSum+currentCellHeight>pixelsInOnePage)break;pixelSum+=currentCellHeight}currentIndex+=step}return Math.max(0,Math.min(currentIndex,lastRowIndex))}getViewportHeight(){const scrollPosition=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),scrollbarWidth=this.gridOptionsService.getScrollbarWidth();let pixelsInOnePage=scrollPosition.bottom-scrollPosition.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(pixelsInOnePage-=scrollbarWidth),pixelsInOnePage}isRowTallerThanView(rowIndex){const rowNode=this.paginationProxy.getRow(rowIndex);if(!rowNode)return!1;const rowHeight=rowNode.rowHeight;return typeof rowHeight!="number"?!1:rowHeight>this.getViewportHeight()}onCtrlUpDownLeftRight(key,gridCell){const cellToFocus=this.cellNavigationService.getNextCellToFocus(key,gridCell,!0),{rowIndex,column}=cellToFocus;this.navigateTo({scrollIndex:rowIndex,scrollType:null,scrollColumn:column,focusIndex:rowIndex,focusColumn:column})}onHomeOrEndKey(key){const homeKey=key===KeyCode.PAGE_HOME,allColumns=this.columnModel.getAllDisplayedColumns(),columnToSelect=homeKey?allColumns[0]:last(allColumns),scrollIndex=homeKey?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex,scrollType:null,scrollColumn:columnToSelect,focusIndex:scrollIndex,focusColumn:columnToSelect})}onTabKeyDown(previous,keyboardEvent){const backwards=keyboardEvent.shiftKey;if(this.tabToNextCellCommon(previous,backwards,keyboardEvent)){keyboardEvent.preventDefault();return}if(backwards){const{rowIndex,rowPinned}=previous.getRowPosition();(rowPinned?rowIndex===0:rowIndex===this.paginationProxy.getPageFirstRow())&&(this.gridOptionsService.get("headerHeight")===0||this.gridOptionsService.get("suppressHeaderFocus")?this.focusService.focusNextGridCoreContainer(!0,!0):(keyboardEvent.preventDefault(),this.focusService.focusPreviousFromFirstCell(keyboardEvent)))}else previous instanceof CellCtrl&&previous.focusCell(!0),this.focusService.focusNextGridCoreContainer(backwards)&&keyboardEvent.preventDefault()}tabToNextCell(backwards,event){const focusedCell=this.focusService.getFocusedCell();if(!focusedCell)return!1;let cellOrRow=this.getCellByPosition(focusedCell);return!cellOrRow&&(cellOrRow=this.rowRenderer.getRowByPosition(focusedCell),!cellOrRow||!cellOrRow.isFullWidth())?!1:this.tabToNextCellCommon(cellOrRow,backwards,event)}tabToNextCellCommon(previous,backwards,event){let editing=previous.isEditing();if(!editing&&previous instanceof CellCtrl){const row=previous.getRowCtrl();row&&(editing=row.isEditing())}let res;return editing?this.gridOptionsService.get("editType")==="fullRow"?res=this.moveToNextEditingRow(previous,backwards,event):res=this.moveToNextEditingCell(previous,backwards,event):res=this.moveToNextCellNotEditing(previous,backwards),res||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(previousCell,backwards,event=null){const previousPos=previousCell.getCellPosition();previousCell.getGui().focus(),previousCell.stopEditing();const nextCell=this.findNextCellToFocusOn(previousPos,backwards,!0);return nextCell==null?!1:(nextCell.startEditing(null,!0,event),nextCell.focusCell(!1),!0)}moveToNextEditingRow(previousCell,backwards,event=null){const previousPos=previousCell.getCellPosition(),nextCell=this.findNextCellToFocusOn(previousPos,backwards,!0);if(nextCell==null)return!1;const nextPos=nextCell.getCellPosition(),previousEditable=this.isCellEditable(previousPos),nextEditable=this.isCellEditable(nextPos),rowsMatch=nextPos&&previousPos.rowIndex===nextPos.rowIndex&&previousPos.rowPinned===nextPos.rowPinned;return previousEditable&&previousCell.setFocusOutOnEditor(),rowsMatch||(previousCell.getRowCtrl().stopEditing(),nextCell.getRowCtrl().startRowEditing(void 0,void 0,event)),nextEditable?(nextCell.setFocusInOnEditor(),nextCell.focusCell()):nextCell.focusCell(!0),!0}moveToNextCellNotEditing(previousCell,backwards){const displayedColumns=this.columnModel.getAllDisplayedColumns();let cellPos;previousCell instanceof RowCtrl?cellPos=__spreadProps(__spreadValues({},previousCell.getRowPosition()),{column:backwards?displayedColumns[0]:last(displayedColumns)}):cellPos=previousCell.getCellPosition();const nextCell=this.findNextCellToFocusOn(cellPos,backwards,!1);if(nextCell instanceof CellCtrl)nextCell.focusCell(!0);else if(nextCell)return this.tryToFocusFullWidthRow(nextCell.getRowPosition(),backwards);return exists(nextCell)}findNextCellToFocusOn(previousPosition,backwards,startEditing){let nextPosition=previousPosition;for(;;){previousPosition!==nextPosition&&(previousPosition=nextPosition),backwards||(nextPosition=this.getLastCellOfColSpan(nextPosition)),nextPosition=this.cellNavigationService.getNextTabbedCell(nextPosition,backwards);const userFunc=this.gridOptionsService.getCallback("tabToNextCell");if(exists(userFunc)){const userCell=userFunc({backwards,editing:startEditing,previousCellPosition:previousPosition,nextCellPosition:nextPosition||null});exists(userCell)?(userCell.floating&&(warnOnce("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),userCell.rowPinned=userCell.floating),nextPosition={rowIndex:userCell.rowIndex,column:userCell.column,rowPinned:userCell.rowPinned}):nextPosition=null}if(!nextPosition)return null;if(nextPosition.rowIndex<0){const headerLen=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:headerLen+nextPosition.rowIndex,column:nextPosition.column},fromCell:!0}),null}const fullRowEdit=this.gridOptionsService.get("editType")==="fullRow";if(startEditing&&!fullRowEdit&&!this.isCellEditable(nextPosition))continue;this.ensureCellVisible(nextPosition);const nextCell=this.getCellByPosition(nextPosition);if(!nextCell){const row=this.rowRenderer.getRowByPosition(nextPosition);if(!row||!row.isFullWidth()||startEditing)continue;return row}if(!nextCell.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(nextPosition),nextCell}}isCellEditable(cell){const rowNode=this.lookupRowNodeForCell(cell);return rowNode?cell.column.isCellEditable(rowNode):!1}getCellByPosition(cellPosition){const rowCtrl=this.rowRenderer.getRowByPosition(cellPosition);return rowCtrl?rowCtrl.getCellCtrl(cellPosition.column):null}lookupRowNodeForCell(cell){return cell.rowPinned==="top"?this.pinnedRowModel.getPinnedTopRow(cell.rowIndex):cell.rowPinned==="bottom"?this.pinnedRowModel.getPinnedBottomRow(cell.rowIndex):this.paginationProxy.getRow(cell.rowIndex)}navigateToNextCell(event,key,currentCell,allowUserOverride){let nextCell=currentCell,hitEdgeOfGrid=!1;for(;nextCell&&(nextCell===currentCell||!this.isValidNavigateCell(nextCell));)this.gridOptionsService.get("enableRtl")?key===KeyCode.LEFT&&(nextCell=this.getLastCellOfColSpan(nextCell)):key===KeyCode.RIGHT&&(nextCell=this.getLastCellOfColSpan(nextCell)),nextCell=this.cellNavigationService.getNextCellToFocus(key,nextCell),hitEdgeOfGrid=missing(nextCell);if(hitEdgeOfGrid&&event&&event.key===KeyCode.UP&&(nextCell={rowIndex:-1,rowPinned:null,column:currentCell.column}),allowUserOverride){const userFunc=this.gridOptionsService.getCallback("navigateToNextCell");if(exists(userFunc)){const userCell=userFunc({key,previousCellPosition:currentCell,nextCellPosition:nextCell||null,event});exists(userCell)?(userCell.floating&&(warnOnce("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),userCell.rowPinned=userCell.floating),nextCell={rowPinned:userCell.rowPinned,rowIndex:userCell.rowIndex,column:userCell.column}):nextCell=null}}if(!nextCell)return;if(nextCell.rowIndex<0){const headerLen=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:headerLen+nextCell.rowIndex,column:currentCell.column},event:event||void 0,fromCell:!0});return}const normalisedPosition=this.getNormalisedPosition(nextCell);normalisedPosition?this.focusPosition(normalisedPosition):this.tryToFocusFullWidthRow(nextCell)}getNormalisedPosition(cellPosition){this.ensureCellVisible(cellPosition);const cellCtrl=this.getCellByPosition(cellPosition);return cellCtrl?(cellPosition=cellCtrl.getCellPosition(),this.ensureCellVisible(cellPosition),cellPosition):null}tryToFocusFullWidthRow(position,backwards=!1){const displayedColumns=this.columnModel.getAllDisplayedColumns(),rowComp=this.rowRenderer.getRowByPosition(position);if(!rowComp||!rowComp.isFullWidth())return!1;const currentCellFocused=this.focusService.getFocusedCell(),cellPosition={rowIndex:position.rowIndex,rowPinned:position.rowPinned,column:position.column||(backwards?last(displayedColumns):displayedColumns[0])};this.focusPosition(cellPosition);const fromBelow=currentCellFocused!=null?this.rowPositionUtils.before(cellPosition,currentCellFocused):!1,focusEvent={type:Events.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:cellPosition.rowIndex,rowPinned:cellPosition.rowPinned,column:cellPosition.column,isFullWidthCell:!0,floating:cellPosition.rowPinned,fromBelow};return this.eventService.dispatchEvent(focusEvent),!0}focusPosition(cellPosition){this.focusService.setFocusedCell({rowIndex:cellPosition.rowIndex,column:cellPosition.column,rowPinned:cellPosition.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(cellPosition)}isValidNavigateCell(cell){return!!this.rowPositionUtils.getRowNode(cell)}getLastCellOfColSpan(cell){const cellCtrl=this.getCellByPosition(cell);if(!cellCtrl)return cell;const colSpanningList=cellCtrl.getColSpanningList();return colSpanningList.length===1?cell:{rowIndex:cell.rowIndex,column:last(colSpanningList),rowPinned:cell.rowPinned}}ensureCellVisible(gridCell){const isGroupStickyEnabled=this.gridOptionsService.isGroupRowsSticky(),rowNode=this.rowModel.getRow(gridCell.rowIndex);!(isGroupStickyEnabled&&(rowNode==null?void 0:rowNode.sticky))&&missing(gridCell.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(gridCell.rowIndex),gridCell.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(gridCell.column)}},__name(_a131,"NavigationService"),_a131);__decorateClass([Autowired("mouseEventService")],NavigationService.prototype,"mouseEventService",2);__decorateClass([Autowired("paginationProxy")],NavigationService.prototype,"paginationProxy",2);__decorateClass([Autowired("focusService")],NavigationService.prototype,"focusService",2);__decorateClass([Optional("rangeService")],NavigationService.prototype,"rangeService",2);__decorateClass([Autowired("columnModel")],NavigationService.prototype,"columnModel",2);__decorateClass([Autowired("rowModel")],NavigationService.prototype,"rowModel",2);__decorateClass([Autowired("ctrlsService")],NavigationService.prototype,"ctrlsService",2);__decorateClass([Autowired("rowRenderer")],NavigationService.prototype,"rowRenderer",2);__decorateClass([Autowired("headerNavigationService")],NavigationService.prototype,"headerNavigationService",2);__decorateClass([Autowired("rowPositionUtils")],NavigationService.prototype,"rowPositionUtils",2);__decorateClass([Autowired("cellNavigationService")],NavigationService.prototype,"cellNavigationService",2);__decorateClass([Autowired("pinnedRowModel")],NavigationService.prototype,"pinnedRowModel",2);__decorateClass([PostConstruct],NavigationService.prototype,"postConstruct",1);NavigationService=__decorateClass([Bean("navigationService")],NavigationService);var _a132,_PopupEditorWrapper=(_a132=class extends PopupComponent{constructor(params){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=params}postConstruct(){this.gridOptionsService.setDomData(this.getGui(),_a132.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const eGui=this.getGui(),params=this.params,listener=__name(event=>{isUserSuppressingKeyboardEvent(this.gridOptionsService,event,params.node,params.column,!0)||params.onKeyDown(event)},"listener");this.addManagedListener(eGui,"keydown",listener)}},__name(_a132,"_PopupEditorWrapper"),_a132);_PopupEditorWrapper.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper";__decorateClass([PostConstruct],_PopupEditorWrapper.prototype,"postConstruct",1);var PopupEditorWrapper=_PopupEditorWrapper,_a133,CellComp=(_a133=class extends Component{constructor(beans,cellCtrl,printLayout,eRow,editingRow){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=beans,this.column=cellCtrl.getColumn(),this.rowNode=cellCtrl.getRowNode(),this.rowCtrl=cellCtrl.getRowCtrl(),this.eRow=eRow,this.cellCtrl=cellCtrl;const cellDiv=document.createElement("div");cellDiv.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(cellDiv);const eGui=this.getGui();this.forceWrapper=cellCtrl.isForceWrapper(),this.refreshWrapper(!1);const setAttribute=__name((name,value)=>{value!=null&&value!=""?eGui.setAttribute(name,value):eGui.removeAttribute(name)},"setAttribute");setAriaRole(eGui,cellCtrl.getCellAriaRole()),setAttribute("col-id",cellCtrl.getColumnIdSanitised());const tabIndex=cellCtrl.getTabIndex();tabIndex!==void 0&&setAttribute("tabindex",tabIndex.toString());const compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setUserStyles:styles=>addStylesToElement(eGui,styles),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:include=>this.includeSelection=include,setIncludeRowDrag:include=>this.includeRowDrag=include,setIncludeDndSource:include=>this.includeDndSource=include,setRenderDetails:(compDetails,valueToDisplay,force)=>this.setRenderDetails(compDetails,valueToDisplay,force),setEditDetails:(compDetails,popup,position)=>this.setEditDetails(compDetails,popup,position),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};cellCtrl.setComp(compProxy,this.getGui(),this.eCellWrapper,printLayout,editingRow)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(compDetails,valueToDisplay,forceNewCellRendererInstance){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const controlWrapperChanged=this.refreshWrapper(!1);this.refreshEditStyles(!1),compDetails?!(forceNewCellRendererInstance||controlWrapperChanged)&&this.refreshCellRenderer(compDetails)||(this.destroyRenderer(),this.createCellRendererInstance(compDetails)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(valueToDisplay))}setEditDetails(compDetails,popup,position){compDetails?this.createCellEditorInstance(compDetails,popup,position):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(editing){const providingControls=this.includeRowDrag||this.includeDndSource||this.includeSelection,usingWrapper=providingControls||this.forceWrapper,putWrapperIn=usingWrapper&&this.eCellWrapper==null;if(putWrapperIn){const wrapperDiv=document.createElement("div");wrapperDiv.setAttribute("role","presentation"),wrapperDiv.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=wrapperDiv,this.getGui().appendChild(this.eCellWrapper)}const takeWrapperOut=!usingWrapper&&this.eCellWrapper!=null;takeWrapperOut&&(removeFromParent(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!usingWrapper);const usingCellValue=!editing&&usingWrapper,putCellValueIn=usingCellValue&&this.eCellValue==null;if(putCellValueIn){const cellSpan=document.createElement("span");cellSpan.setAttribute("role","presentation"),cellSpan.setAttribute("class","ag-cell-value"),this.eCellValue=cellSpan,this.eCellWrapper.appendChild(this.eCellValue)}const takeCellValueOut=!usingCellValue&&this.eCellValue!=null;takeCellValueOut&&(removeFromParent(this.eCellValue),this.eCellValue=void 0);const templateChanged=putWrapperIn||takeWrapperOut||putCellValueIn||takeCellValueOut;return templateChanged&&this.removeControls(),editing||providingControls&&this.addControls(),templateChanged}addControls(){this.includeRowDrag&&this.rowDraggingComp==null&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&this.dndSourceComp==null&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(compDetails,popup,position){const versionCopy=this.editorVersion,cellEditorPromise=compDetails.newAgStackInstance();if(!cellEditorPromise)return;const{params}=compDetails;cellEditorPromise.then(c=>this.afterCellEditorCreated(versionCopy,c,params,popup,position)),missing(this.cellEditor)&&params.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(valueToDisplay){const eParent=this.getParentOfValue();clearElement(eParent);const escapedValue=valueToDisplay!=null?escapeString(valueToDisplay,!0):null;escapedValue!=null&&(eParent.textContent=escapedValue)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context}=this.beans;this.cellRenderer=context.destroyBean(this.cellRenderer),removeFromParent(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=context.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=context.destroyBean(this.cellEditorPopupWrapper),removeFromParent(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(compClassAndParams){if(this.cellRenderer==null||this.cellRenderer.refresh==null||this.cellRendererClass!==compClassAndParams.componentClass)return!1;const result=this.cellRenderer.refresh(compClassAndParams.params);return result===!0||result===void 0}createCellRendererInstance(compDetails){const useTaskService=!this.beans.gridOptionsService.get("suppressAnimationFrame"),displayComponentVersionCopy=this.rendererVersion,{componentClass}=compDetails,createCellRendererFunc=__name(()=>{if(this.rendererVersion!==displayComponentVersionCopy||!this.isAlive())return;const componentPromise=compDetails.newAgStackInstance(),callback=this.afterCellRendererCreated.bind(this,displayComponentVersionCopy,componentClass);componentPromise&&componentPromise.then(callback)},"createCellRendererFunc");useTaskService&&this.firstRender?this.beans.animationFrameService.createTask(createCellRendererFunc,this.rowNode.rowIndex,"createTasksP2"):createCellRendererFunc()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(cellRendererVersion,cellRendererClass,cellRenderer){if(!this.isAlive()||cellRendererVersion!==this.rendererVersion){this.beans.context.destroyBean(cellRenderer);return}if(this.cellRenderer=cellRenderer,this.cellRendererClass=cellRendererClass,this.cellRendererGui=this.cellRenderer.getGui(),this.cellRendererGui!=null){const eParent=this.getParentOfValue();clearElement(eParent),eParent.appendChild(this.cellRendererGui)}}afterCellEditorCreated(requestVersion,cellEditor,params,popup,position){if(requestVersion!==this.editorVersion){this.beans.context.destroyBean(cellEditor);return}if(cellEditor.isCancelBeforeStart&&cellEditor.isCancelBeforeStart()){this.beans.context.destroyBean(cellEditor),this.cellCtrl.stopEditing(!0);return}if(!cellEditor.getGui){console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),this.beans.context.destroyBean(cellEditor);return}this.cellEditor=cellEditor,this.cellEditorGui=cellEditor.getGui();const cellEditorInPopup=popup||cellEditor.isPopup!==void 0&&cellEditor.isPopup();cellEditorInPopup?this.addPopupCellEditor(params,position):this.addInCellEditor(),this.refreshEditStyles(!0,cellEditorInPopup),cellEditor.afterGuiAttached&&cellEditor.afterGuiAttached()}refreshEditStyles(editing,isPopup){var _a273;this.addOrRemoveCssClass("ag-cell-inline-editing",editing&&!isPopup),this.addOrRemoveCssClass("ag-cell-popup-editing",editing&&!!isPopup),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!editing||!!isPopup),(_a273=this.rowCtrl)==null||_a273.setInlineEditingCss(editing)}addInCellEditor(){const eGui=this.getGui(),eDocument=this.beans.gridOptionsService.getDocument();eGui.contains(eDocument.activeElement)&&eGui.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(params,position){this.beans.gridOptionsService.get("editType")==="fullRow"&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const cellEditor=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new PopupEditorWrapper(params));const ePopupGui=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&ePopupGui.appendChild(this.cellEditorGui);const popupService=this.beans.popupService,useModelPopup=this.beans.gridOptionsService.get("stopEditingWhenCellsLoseFocus"),positionToUse=position??(cellEditor.getPopupPosition?cellEditor.getPopupPosition():"over"),isRtl=this.beans.gridOptionsService.get("enableRtl"),positionParams={ePopup:ePopupGui,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:positionToUse,alignSide:isRtl?"right":"left",keepWithinBounds:!0},positionCallback=popupService.positionPopupByComponent.bind(popupService,positionParams),translate=this.beans.localeService.getLocaleTextFunc(),addPopupRes=popupService.addPopup({modal:useModelPopup,eChild:ePopupGui,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback,ariaLabel:translate("ariaLabelCellEditor","Cell Editor")});addPopupRes&&(this.hideEditorPopup=addPopupRes.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const eGui=this.getGui(),eDocument=this.beans.gridOptionsService.getDocument();eGui.contains(eDocument.activeElement)&&browserSupportsPreventScroll()&&eGui.focus({preventScroll:!0}),clearElement(this.getParentOfValue())}},__name(_a133,"CellComp"),_a133),_a134,RowComp=(_a134=class extends Component{constructor(ctrl,beans,containerType){super(),this.cellComps={},this.beans=beans,this.rowCtrl=ctrl;const rowDiv=document.createElement("div");rowDiv.setAttribute("comp-id",`${this.getCompId()}`),rowDiv.setAttribute("style",this.getInitialStyle(containerType)),this.setTemplateFromElement(rowDiv);const eGui=this.getGui(),style=eGui.style;this.domOrder=this.rowCtrl.getDomOrder(),setAriaRole(eGui,"row");const tabIndex=this.rowCtrl.getTabIndex();tabIndex!=null&&eGui.setAttribute("tabindex",tabIndex.toString());const compProxy={setDomOrder:domOrder=>this.domOrder=domOrder,setCellCtrls:cellCtrls=>this.setCellCtrls(cellCtrls),showFullWidth:compDetails=>this.showFullWidth(compDetails),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(name,on)=>this.addOrRemoveCssClass(name,on),setUserStyles:styles=>addStylesToElement(eGui,styles),setTop:top=>style.top=top,setTransform:transform=>style.transform=transform,setRowIndex:rowIndex=>eGui.setAttribute("row-index",rowIndex),setRowId:rowId=>eGui.setAttribute("row-id",rowId),setRowBusinessKey:businessKey=>eGui.setAttribute("row-business-key",businessKey),refreshFullWidth:getUpdatedParams=>this.refreshFullWidth(getUpdatedParams)};ctrl.setComp(compProxy,this.getGui(),containerType),this.addDestroyFunc(()=>{ctrl.unsetComp(containerType)})}getInitialStyle(containerType){const transform=this.rowCtrl.getInitialTransform(containerType);return transform?`transform: ${transform}`:`top: ${this.rowCtrl.getInitialRowTop(containerType)}`}showFullWidth(compDetails){const callback=__name(cellRenderer=>{if(this.isAlive()){const eGui=cellRenderer.getGui();this.getGui().appendChild(eGui),this.rowCtrl.setupDetailRowAutoHeight(eGui),this.setFullWidthRowComp(cellRenderer)}else this.beans.context.destroyBean(cellRenderer)},"callback"),res=compDetails.newAgStackInstance();res&&res.then(callback)}setCellCtrls(cellCtrls){const cellsToRemove=Object.assign({},this.cellComps);cellCtrls.forEach(cellCtrl=>{const key=cellCtrl.getInstanceId();this.cellComps[key]==null?this.newCellComp(cellCtrl):cellsToRemove[key]=null});const cellCompsToRemove=getAllValuesInObject(cellsToRemove).filter(cellComp=>cellComp!=null);this.destroyCells(cellCompsToRemove),this.ensureDomOrder(cellCtrls)}ensureDomOrder(cellCtrls){if(!this.domOrder)return;const elementsInOrder=[];cellCtrls.forEach(cellCtrl=>{const cellComp=this.cellComps[cellCtrl.getInstanceId()];cellComp&&elementsInOrder.push(cellComp.getGui())}),setDomChildOrder(this.getGui(),elementsInOrder)}newCellComp(cellCtrl){const cellComp=new CellComp(this.beans,cellCtrl,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[cellCtrl.getInstanceId()]=cellComp,this.getGui().appendChild(cellComp.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const cellsToDestroy=getAllValuesInObject(this.cellComps).filter(cp=>cp!=null);this.destroyCells(cellsToDestroy)}setFullWidthRowComp(fullWidthRowComponent){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=fullWidthRowComponent,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(cellComps){cellComps.forEach(cellComp=>{if(!cellComp)return;const instanceId=cellComp.getCtrl().getInstanceId();this.cellComps[instanceId]===cellComp&&(cellComp.detach(),cellComp.destroy(),this.cellComps[instanceId]=null)})}refreshFullWidth(getUpdatedParams){const{fullWidthCellRenderer}=this;if(!fullWidthCellRenderer||!fullWidthCellRenderer.refresh)return!1;const params=getUpdatedParams();return fullWidthCellRenderer.refresh(params)}},__name(_a134,"RowComp"),_a134);function templateFactory(){const name=Component.elementGettingCreated.getAttribute("name"),cssClasses=RowContainerCtrl.getRowContainerCssClasses(name);let res;return name==="center"||name==="topCenter"||name==="stickyTopCenter"||name==="bottomCenter"?res=`<div class="${cssClasses.viewport}" ref="eViewport" role="presentation">
                <div class="${cssClasses.container}" ref="eContainer"></div>
            </div>`:res=`<div class="${cssClasses.container}" ref="eContainer"></div>`,res}__name(templateFactory,"templateFactory");var _a135,RowContainerComp=(_a135=class extends Component{constructor(){super(templateFactory()),this.rowComps={},this.name=Component.elementGettingCreated.getAttribute("name"),this.type=getRowContainerTypeForName(this.name)}postConstruct(){const compProxy={setViewportHeight:height=>this.eViewport.style.height=height,setRowCtrls:({rowCtrls})=>this.setRowCtrls(rowCtrls),setDomOrder:domOrder=>{this.domOrder=domOrder},setContainerWidth:width=>this.eContainer.style.width=width};this.createManagedBean(new RowContainerCtrl(this.name)).setComp(compProxy,this.eContainer,this.eViewport)}preDestroy(){this.setRowCtrls([])}setRowCtrls(rowCtrls){const oldRows=__spreadValues({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;const processRow=__name(rowCon=>{const instanceId=rowCon.getInstanceId(),existingRowComp=oldRows[instanceId];if(existingRowComp)this.rowComps[instanceId]=existingRowComp,delete oldRows[instanceId],this.ensureDomOrder(existingRowComp.getGui());else{if(!rowCon.getRowNode().displayed)return;const rowComp=new RowComp(rowCon,this.beans,this.type);this.rowComps[instanceId]=rowComp,this.appendRow(rowComp.getGui())}},"processRow");rowCtrls.forEach(processRow),getAllValuesInObject(oldRows).forEach(oldRowComp=>{this.eContainer.removeChild(oldRowComp.getGui()),oldRowComp.destroy()}),setAriaRole(this.eContainer,"rowgroup")}appendRow(element){this.domOrder?insertWithDomOrder(this.eContainer,element,this.lastPlacedElement):this.eContainer.appendChild(element),this.lastPlacedElement=element}ensureDomOrder(eRow){this.domOrder&&(ensureDomOrder(this.eContainer,eRow,this.lastPlacedElement),this.lastPlacedElement=eRow)}},__name(_a135,"RowContainerComp"),_a135);__decorateClass([Autowired("beans")],RowContainerComp.prototype,"beans",2);__decorateClass([RefSelector("eViewport")],RowContainerComp.prototype,"eViewport",2);__decorateClass([RefSelector("eContainer")],RowContainerComp.prototype,"eContainer",2);__decorateClass([PostConstruct],RowContainerComp.prototype,"postConstruct",1);__decorateClass([PreDestroy],RowContainerComp.prototype,"preDestroy",1);var _a136,BodyDropPivotTarget=(_a136=class{constructor(pinned){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=pinned}onDragEnter(draggingEvent){if(this.clearColumnsList(),this.gridOptionsService.get("functionsReadOnly"))return;const dragColumns=draggingEvent.dragItem.columns;dragColumns&&dragColumns.forEach(column=>{column.isPrimary()&&(column.isAnyFunctionActive()||(column.isAllowValue()?this.columnsToAggregate.push(column):column.isAllowRowGroup()?this.columnsToGroup.push(column):column.isAllowPivot()&&this.columnsToPivot.push(column)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?DragAndDropService.ICON_PINNED:DragAndDropService.ICON_MOVE:null}onDragLeave(draggingEvent){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(draggingEvent){}onDragStop(draggingEvent){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}},__name(_a136,"BodyDropPivotTarget"),_a136);__decorateClass([Autowired("columnModel")],BodyDropPivotTarget.prototype,"columnModel",2);__decorateClass([Autowired("gridOptionsService")],BodyDropPivotTarget.prototype,"gridOptionsService",2);var _a137,ColumnMoveHelper=(_a137=class{static attemptMoveColumns(params){const{isFromHeader,hDirection,xPosition,fromEnter,fakeEvent,pinned,gridOptionsService,columnModel}=params,draggingLeft=hDirection===0,draggingRight=hDirection===1;let{allMovingColumns}=params;if(isFromHeader){let newCols=[];allMovingColumns.forEach(col=>{var _a273;let movingGroup=null,parent=col.getParent();for(;parent!=null&&parent.getDisplayedLeafColumns().length===1;)movingGroup=parent,parent=parent.getParent();movingGroup!=null?(!!((_a273=movingGroup.getColGroupDef())!=null&&_a273.marryChildren)?movingGroup.getProvidedColumnGroup().getLeafColumns():movingGroup.getLeafColumns()).forEach(newCol=>{newCols.includes(newCol)||newCols.push(newCol)}):newCols.includes(col)||newCols.push(col)}),allMovingColumns=newCols}const allMovingColumnsOrdered=allMovingColumns.slice();columnModel.sortColumnsLikeGridColumns(allMovingColumnsOrdered);const validMoves=this.calculateValidMoves({movingCols:allMovingColumnsOrdered,draggingRight,xPosition,pinned,gridOptionsService,columnModel}),oldIndex=this.calculateOldIndex(allMovingColumnsOrdered,columnModel);if(validMoves.length===0)return;const firstValidMove=validMoves[0];let constrainDirection=oldIndex!==null&&!fromEnter;if(isFromHeader&&(constrainDirection=oldIndex!==null),constrainDirection&&!fakeEvent&&(draggingLeft&&firstValidMove>=oldIndex||draggingRight&&firstValidMove<=oldIndex))return;const displayedCols=columnModel.getAllDisplayedColumns();let potentialMoves=[],targetOrder=null;for(let i=0;i<validMoves.length;i++){const move=validMoves[i],order=columnModel.getProposedColumnOrder(allMovingColumnsOrdered,move);if(!columnModel.doesOrderPassRules(order))continue;const displayedOrder=order.filter(col=>displayedCols.includes(col));if(targetOrder===null)targetOrder=displayedOrder;else if(!areEqual(displayedOrder,targetOrder))break;const fragCount=this.groupFragCount(order);potentialMoves.push({move,fragCount})}if(potentialMoves.length!==0)return potentialMoves.sort((a,b)=>a.fragCount-b.fragCount),this.moveColumns(allMovingColumns,potentialMoves[0].move,"uiColumnMoved",!1,columnModel)}static moveColumns(columns,toIndex,source,finished,columnModel){return columnModel.moveColumns(columns,toIndex,source,finished),finished?null:{columns,toIndex}}static calculateOldIndex(movingCols,columnModel){const gridCols=columnModel.getAllGridColumns(),indexes=sortNumerically(movingCols.map(col=>gridCols.indexOf(col))),firstIndex=indexes[0];return last(indexes)-firstIndex!==indexes.length-1?null:firstIndex}static groupFragCount(columns){function parents(col){let result=[],parent=col.getOriginalParent();for(;parent!=null;)result.push(parent),parent=parent.getOriginalParent();return result}__name(parents,"parents");let count=0;for(let i=0;i<columns.length-1;i++){let a=parents(columns[i]),b=parents(columns[i+1]);[a,b]=a.length>b.length?[a,b]:[b,a],a.forEach(parent=>{b.indexOf(parent)===-1&&count++})}return count}static calculateValidMoves(params){const{movingCols,draggingRight,xPosition,pinned,gridOptionsService,columnModel}=params;if(gridOptionsService.get("suppressMovableColumns")||movingCols.some(col=>col.getColDef().suppressMovable))return[];const allDisplayedCols=columnModel.getDisplayedColumns(pinned),allGridCols=columnModel.getAllGridColumns(),movingDisplayedCols=allDisplayedCols.filter(col=>includes(movingCols,col)),otherDisplayedCols=allDisplayedCols.filter(col=>!includes(movingCols,col)),otherGridCols=allGridCols.filter(col=>!includes(movingCols,col));let displayIndex=0,availableWidth=xPosition;if(draggingRight){let widthOfMovingDisplayedCols=0;movingDisplayedCols.forEach(col=>widthOfMovingDisplayedCols+=col.getActualWidth()),availableWidth-=widthOfMovingDisplayedCols}if(availableWidth>0){for(let i=0;i<otherDisplayedCols.length;i++){const col=otherDisplayedCols[i];if(availableWidth-=col.getActualWidth(),availableWidth<0)break;displayIndex++}draggingRight&&displayIndex++}let firstValidMove;if(displayIndex>0){const leftColumn=otherDisplayedCols[displayIndex-1];firstValidMove=otherGridCols.indexOf(leftColumn)+1}else firstValidMove=otherGridCols.indexOf(otherDisplayedCols[0]),firstValidMove===-1&&(firstValidMove=0);const validMoves=[firstValidMove],numberComparator=__name((a,b)=>a-b,"numberComparator");if(draggingRight){let pointer=firstValidMove+1;const lastIndex=allGridCols.length-1;for(;pointer<=lastIndex;)validMoves.push(pointer),pointer++;validMoves.sort(numberComparator)}else{let pointer=firstValidMove;const lastIndex=allGridCols.length-1;let displacedCol=allGridCols[pointer];for(;pointer<=lastIndex&&allDisplayedCols.indexOf(displacedCol)<0;)pointer++,validMoves.push(pointer),displacedCol=allGridCols[pointer];pointer=firstValidMove-1;const firstDisplayIndex=0;for(;pointer>=firstDisplayIndex;)validMoves.push(pointer),pointer--;validMoves.sort(numberComparator).reverse()}return validMoves}static normaliseX(x,pinned,fromKeyboard,gridOptionsService,ctrlsService){const eViewport=ctrlsService.getHeaderRowContainerCtrl(pinned).getViewport();return fromKeyboard&&(x-=eViewport.getBoundingClientRect().left),gridOptionsService.get("enableRtl")&&(x=eViewport.clientWidth-x),pinned==null&&(x+=ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),x}},__name(_a137,"ColumnMoveHelper"),_a137),_a138,MoveColumnFeature=(_a138=class{constructor(pinned,eContainer){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=pinned,this.eContainer=eContainer,this.centerContainer=!exists(pinned)}init(){this.ctrlsService.whenReady(()=>{this.gridBodyCon=this.ctrlsService.getGridBodyCtrl()})}getIconName(){return this.pinned?DragAndDropService.ICON_PINNED:DragAndDropService.ICON_MOVE}onDragEnter(draggingEvent){const columns=draggingEvent.dragItem.columns;if(draggingEvent.dragSource.type===0)this.setColumnsVisible(columns,!0,"uiColumnDragged");else{const visibleState=draggingEvent.dragItem.visibleState,visibleColumns=(columns||[]).filter(column=>visibleState[column.getId()]);this.setColumnsVisible(visibleColumns,!0,"uiColumnDragged")}this.setColumnsPinned(columns,this.pinned,"uiColumnDragged"),this.onDragging(draggingEvent,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(columns,visible,source){if(columns){const allowedCols=columns.filter(c=>!c.getColDef().lockVisible);this.columnModel.setColumnsVisible(allowedCols,visible,source)}}setColumnsPinned(columns,pinned,source){if(columns){const allowedCols=columns.filter(c=>!c.getColDef().lockPinned);this.columnModel.setColumnsPinned(allowedCols,pinned,source)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}checkCenterForScrolling(xAdjustedForScroll){if(this.centerContainer){const firstVisiblePixel=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),lastVisiblePixel=firstVisiblePixel+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.get("enableRtl")?(this.needToMoveRight=xAdjustedForScroll<firstVisiblePixel+50,this.needToMoveLeft=xAdjustedForScroll>lastVisiblePixel-50):(this.needToMoveLeft=xAdjustedForScroll<firstVisiblePixel+50,this.needToMoveRight=xAdjustedForScroll>lastVisiblePixel-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(draggingEvent=this.lastDraggingEvent,fromEnter=!1,fakeEvent=!1,finished=!1){var _a273;if(finished){if(this.lastMovedInfo){const{columns,toIndex}=this.lastMovedInfo;ColumnMoveHelper.moveColumns(columns,toIndex,"uiColumnMoved",!0,this.columnModel)}return}if(this.lastDraggingEvent=draggingEvent,missing(draggingEvent.hDirection))return;const mouseX=ColumnMoveHelper.normaliseX(draggingEvent.x,this.pinned,!1,this.gridOptionsService,this.ctrlsService);fromEnter||this.checkCenterForScrolling(mouseX);const hDirection=this.normaliseDirection(draggingEvent.hDirection),dragSourceType=draggingEvent.dragSource.type,allMovingColumns=((_a273=draggingEvent.dragSource.getDragItem().columns)==null?void 0:_a273.filter(col=>col.getColDef().lockPinned?col.getPinned()==this.pinned:!0))||[],lastMovedInfo=ColumnMoveHelper.attemptMoveColumns({allMovingColumns,isFromHeader:dragSourceType===1,hDirection,xPosition:mouseX,pinned:this.pinned,fromEnter,fakeEvent,gridOptionsService:this.gridOptionsService,columnModel:this.columnModel});lastMovedInfo&&(this.lastMovedInfo=lastMovedInfo)}normaliseDirection(hDirection){if(this.gridOptionsService.get("enableRtl"))switch(hDirection){case 0:return 1;case 1:return 0;default:console.error(`AG Grid: Unknown direction ${hDirection}`)}else return hDirection}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_MOVE))}moveInterval(){let pixelsToMove;this.intervalCount++,pixelsToMove=10+this.intervalCount*5,pixelsToMove>100&&(pixelsToMove=100);let pixelsMoved=null;const scrollFeature=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?pixelsMoved=scrollFeature.scrollHorizontally(-pixelsToMove):this.needToMoveRight&&(pixelsMoved=scrollFeature.scrollHorizontally(pixelsToMove)),pixelsMoved!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const columnsThatCanPin=this.lastDraggingEvent.dragItem.columns.filter(c=>!c.getColDef().lockPinned);if(columnsThatCanPin.length>0&&(this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_PINNED),this.failedMoveAttempts>7)){const pinType=this.needToMoveLeft?"left":"right";this.setColumnsPinned(columnsThatCanPin,pinType,"uiColumnDragged"),this.dragAndDropService.nudge()}}}},__name(_a138,"MoveColumnFeature"),_a138);__decorateClass([Autowired("columnModel")],MoveColumnFeature.prototype,"columnModel",2);__decorateClass([Autowired("dragAndDropService")],MoveColumnFeature.prototype,"dragAndDropService",2);__decorateClass([Autowired("gridOptionsService")],MoveColumnFeature.prototype,"gridOptionsService",2);__decorateClass([Autowired("ctrlsService")],MoveColumnFeature.prototype,"ctrlsService",2);__decorateClass([PostConstruct],MoveColumnFeature.prototype,"init",1);var _a139,BodyDropTarget=(_a139=class extends BeanStub{constructor(pinned,eContainer){super(),this.pinned=pinned,this.eContainer=eContainer}postConstruct(){this.ctrlsService.whenReady(p=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[p.gridBodyCtrl.getBodyViewportElement(),p.leftRowContainerCtrl.getContainerElement()],[p.bottomLeftRowContainerCtrl.getContainerElement()],[p.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[p.gridBodyCtrl.getBodyViewportElement(),p.rightRowContainerCtrl.getContainerElement()],[p.bottomRightRowContainerCtrl.getContainerElement()],[p.topRightRowContainerCtrl.getContainerElement()]];break;default:this.eSecondaryContainers=[[p.gridBodyCtrl.getBodyViewportElement(),p.centerRowContainerCtrl.getViewportElement()],[p.bottomCenterRowContainerCtrl.getViewportElement()],[p.topCenterRowContainerCtrl.getViewportElement()]];break}})}isInterestedIn(type){return type===1||type===0&&this.gridOptionsService.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new MoveColumnFeature(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new BodyDropPivotTarget(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(draggingEvent){return this.columnModel.isPivotMode()&&draggingEvent.dragSource.type===0}onDragEnter(draggingEvent){this.currentDropListener=this.isDropColumnInPivotMode(draggingEvent)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(draggingEvent)}onDragLeave(params){this.currentDropListener.onDragLeave(params)}onDragging(params){this.currentDropListener.onDragging(params)}onDragStop(params){this.currentDropListener.onDragStop(params)}},__name(_a139,"BodyDropTarget"),_a139);__decorateClass([Autowired("dragAndDropService")],BodyDropTarget.prototype,"dragAndDropService",2);__decorateClass([Autowired("columnModel")],BodyDropTarget.prototype,"columnModel",2);__decorateClass([Autowired("ctrlsService")],BodyDropTarget.prototype,"ctrlsService",2);__decorateClass([PostConstruct],BodyDropTarget.prototype,"postConstruct",1);__decorateClass([PostConstruct],BodyDropTarget.prototype,"init",1);var _a140,_HeaderCellComp=(_a140=class extends AbstractHeaderCellComp{constructor(ctrl){super(_a140.TEMPLATE,ctrl),this.headerCompVersion=0,this.column=ctrl.getColumnGroupChild(),this.pinned=ctrl.getPinned()}postConstruct(){const eGui=this.getGui();__name((name,value)=>{value!=null&&value!=""?eGui.setAttribute(name,value):eGui.removeAttribute(name)},"setAttribute")("col-id",this.column.getColId());const compProxy={setWidth:width=>eGui.style.width=width,addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setAriaSort:sort=>sort?setAriaSort(eGui,sort):removeAriaSort(eGui),setUserCompDetails:compDetails=>this.setUserCompDetails(compDetails),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(compProxy,this.getGui(),this.eResize,this.eHeaderCompWrapper);const selectAllGui=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",selectAllGui)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(compDetails){this.headerCompVersion++;const versionCopy=this.headerCompVersion;compDetails.newAgStackInstance().then(comp=>this.afterCompCreated(versionCopy,comp))}afterCompCreated(version,headerComp){if(version!=this.headerCompVersion||!this.isAlive()){this.destroyBean(headerComp);return}this.destroyHeaderComp(),this.headerComp=headerComp,this.headerCompGui=headerComp.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},__name(_a140,"_HeaderCellComp"),_a140);_HeaderCellComp.TEMPLATE=`<div class="ag-header-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>
        </div>`;__decorateClass([RefSelector("eResize")],_HeaderCellComp.prototype,"eResize",2);__decorateClass([RefSelector("eHeaderCompWrapper")],_HeaderCellComp.prototype,"eHeaderCompWrapper",2);__decorateClass([PostConstruct],_HeaderCellComp.prototype,"postConstruct",1);__decorateClass([PreDestroy],_HeaderCellComp.prototype,"destroyHeaderComp",1);var HeaderCellComp=_HeaderCellComp,_a141,_HeaderGroupCellComp=(_a141=class extends AbstractHeaderCellComp{constructor(ctrl){super(_a141.TEMPLATE,ctrl)}postConstruct(){const eGui=this.getGui(),setAttribute=__name((key,value)=>value!=null?eGui.setAttribute(key,value):eGui.removeAttribute(key),"setAttribute");eGui.setAttribute("col-id",this.ctrl.getColId());const compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setResizableDisplayed:displayed=>setDisplayed(this.eResize,displayed),setWidth:width=>eGui.style.width=width,setAriaExpanded:expanded=>setAttribute("aria-expanded",expanded),setUserCompDetails:details=>this.setUserCompDetails(details),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(compProxy,eGui,this.eResize)}setUserCompDetails(details){details.newAgStackInstance().then(comp=>this.afterHeaderCompCreated(comp))}afterHeaderCompCreated(headerGroupComp){const destroyFunc=__name(()=>this.destroyBean(headerGroupComp),"destroyFunc");if(!this.isAlive()){destroyFunc();return}const eGui=this.getGui(),eHeaderGroupGui=headerGroupComp.getGui();eGui.appendChild(eHeaderGroupGui),this.addDestroyFunc(destroyFunc),this.headerGroupComp=headerGroupComp,this.ctrl.setDragSource(eGui)}},__name(_a141,"_HeaderGroupCellComp"),_a141);_HeaderGroupCellComp.TEMPLATE=`<div class="ag-header-group-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
        </div>`;__decorateClass([RefSelector("eResize")],_HeaderGroupCellComp.prototype,"eResize",2);__decorateClass([PostConstruct],_HeaderGroupCellComp.prototype,"postConstruct",1);var HeaderGroupCellComp=_HeaderGroupCellComp,HeaderRowType=(HeaderRowType2=>(HeaderRowType2.COLUMN_GROUP="group",HeaderRowType2.COLUMN="column",HeaderRowType2.FLOATING_FILTER="filter",HeaderRowType2))(HeaderRowType||{}),_a142,HeaderRowComp=(_a142=class extends Component{constructor(ctrl){super(),this.headerComps={},this.ctrl=ctrl,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}init(){setAriaRowIndex(this.getGui(),this.ctrl.getAriaRowIndex());const compProxy={setHeight:height=>this.getGui().style.height=height,setTop:top=>this.getGui().style.top=top,setHeaderCtrls:(ctrls,forceOrder)=>this.setHeaderCtrls(ctrls,forceOrder),setWidth:width=>this.getGui().style.width=width};this.ctrl.setComp(compProxy)}destroyHeaderCtrls(){this.setHeaderCtrls([],!1)}setHeaderCtrls(ctrls,forceOrder){if(!this.isAlive())return;const oldComps=this.headerComps;if(this.headerComps={},ctrls.forEach(ctrl=>{const id=ctrl.getInstanceId();let comp=oldComps[id];delete oldComps[id],comp==null&&(comp=this.createHeaderComp(ctrl),this.getGui().appendChild(comp.getGui())),this.headerComps[id]=comp}),iterateObject(oldComps,(id,comp)=>{this.getGui().removeChild(comp.getGui()),this.destroyBean(comp)}),forceOrder){const comps=getAllValuesInObject(this.headerComps);comps.sort((a,b)=>{const leftA=a.getCtrl().getColumnGroupChild().getLeft(),leftB=b.getCtrl().getColumnGroupChild().getLeft();return leftA-leftB});const elementsInOrder=comps.map(c=>c.getGui());setDomChildOrder(this.getGui(),elementsInOrder)}}createHeaderComp(headerCtrl){let result;switch(this.ctrl.getType()){case"group":result=new HeaderGroupCellComp(headerCtrl);break;case"filter":result=new HeaderFilterCellComp(headerCtrl);break;default:result=new HeaderCellComp(headerCtrl);break}return this.createBean(result),result.setParentComponent(this),result}},__name(_a142,"HeaderRowComp"),_a142);__decorateClass([PostConstruct],HeaderRowComp.prototype,"init",1);__decorateClass([PreDestroy],HeaderRowComp.prototype,"destroyHeaderCtrls",1);var instanceIdSequence4=0,_a143,_AbstractHeaderCellCtrl=(_a143=class extends BeanStub{constructor(columnGroupChild,beans,parentRowCtrl){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=columnGroupChild,this.parentRowCtrl=parentRowCtrl,this.beans=beans,this.instanceId=columnGroupChild.getUniqueId()+"-"+instanceIdSequence4++}postConstruct(){this.addManagedPropertyListeners(["suppressHeaderFocus"],()=>this.refreshTabIndex())}shouldStopEventPropagation(e){const{headerRowIndex,column}=this.focusService.getFocusedHeader();return isUserSuppressingHeaderKeyboardEvent(this.gridOptionsService,e,headerRowIndex,column)}getWrapperHasFocus(){return this.gridOptionsService.getDocument().activeElement===this.eGui}setGui(eGui){this.eGui=eGui,this.addDomData(),this.addManagedListener(this.beans.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onDisplayedColumnsChanged(){!this.comp||!this.column||(this.refreshFirstAndLastStyles(),this.refreshAriaColIndex())}refreshFirstAndLastStyles(){const{comp,column,beans}=this;CssClassApplier.refreshFirstAndLastStyles(comp,column,beans.columnModel)}refreshAriaColIndex(){const{beans,column}=this,colIdx=beans.columnModel.getAriaColumnIndex(column);setAriaColIndex(this.eGui,colIdx)}addResizeAndMoveKeyboardListeners(){this.resizeFeature&&(this.addManagedListener(this.eGui,"keydown",this.onGuiKeyDown.bind(this)),this.addManagedListener(this.eGui,"keyup",this.onGuiKeyUp.bind(this)))}refreshTabIndex(){this.gridOptionsService.get("suppressHeaderFocus")?this.eGui.removeAttribute("tabindex"):this.eGui.setAttribute("tabindex","-1")}onGuiKeyDown(e){var _a273;const activeEl=this.gridOptionsService.getDocument().activeElement,isLeftOrRight=e.key===KeyCode.LEFT||e.key===KeyCode.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),activeEl!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||isLeftOrRight)&&(e.preventDefault(),e.stopImmediatePropagation()),!isLeftOrRight))return;const isLeft=e.key===KeyCode.LEFT!==this.gridOptionsService.get("enableRtl"),direction=HorizontalDirection[isLeft?"Left":"Right"];if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const diff=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(diff,e.shiftKey),(_a273=this.resizeFeature)==null||_a273.toggleColumnResizing(!0)}else this.moveHeader(direction)}getViewportAdjustedResizeDiff(e){let diff=this.getResizeDiff(e);if(this.column.getPinned()){const leftWidth=this.pinnedWidthService.getPinnedLeftWidth(),rightWidth=this.pinnedWidthService.getPinnedRightWidth(),bodyWidth=getInnerWidth(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(leftWidth+rightWidth+diff>bodyWidth)if(bodyWidth>leftWidth+rightWidth)diff=bodyWidth-leftWidth-rightWidth;else return 0}return diff}getResizeDiff(e){let isLeft=e.key===KeyCode.LEFT!==this.gridOptionsService.get("enableRtl");const pinned=this.column.getPinned(),isRtl=this.gridOptionsService.get("enableRtl");return pinned&&isRtl!==(pinned==="right")&&(isLeft=!isLeft),(isLeft?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=setTimeout(()=>{var _a273;(_a273=this.resizeFeature)==null||_a273.toggleColumnResizing(!1)},150))}handleKeyDown(e){const wrapperHasFocus=this.getWrapperHasFocus();switch(e.key){case KeyCode.PAGE_DOWN:case KeyCode.PAGE_UP:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:wrapperHasFocus&&e.preventDefault()}}addDomData(){const key=_a143.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,key,this),this.addDestroyFunc(()=>this.gridOptionsService.setDomData(this.eGui,key,null))}getGui(){return this.eGui}focus(event){return this.eGui?(this.lastFocusEvent=event||null,this.eGui.focus(),!0):!1}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(mouseEvent,touchEvent,column){const event=mouseEvent??touchEvent;this.gridOptionsService.get("preventDefaultOnContextMenu")&&event.preventDefault();const columnToUse=column instanceof Column?column:void 0;this.menuService.isHeaderContextMenuEnabled(columnToUse)&&this.menuService.showHeaderContextMenu(columnToUse,mouseEvent,touchEvent),this.dispatchColumnMouseEvent(Events.EVENT_COLUMN_HEADER_CONTEXT_MENU,column)}dispatchColumnMouseEvent(eventType,column){const event={type:eventType,column};this.eventService.dispatchEvent(event)}destroy(){super.destroy(),this.removeDragSource(),this.comp=null,this.column=null,this.resizeFeature=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null,this.eGui=null}},__name(_a143,"_AbstractHeaderCellCtrl"),_a143);_AbstractHeaderCellCtrl.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";__decorateClass([Autowired("pinnedWidthService")],_AbstractHeaderCellCtrl.prototype,"pinnedWidthService",2);__decorateClass([Autowired("focusService")],_AbstractHeaderCellCtrl.prototype,"focusService",2);__decorateClass([Autowired("userComponentFactory")],_AbstractHeaderCellCtrl.prototype,"userComponentFactory",2);__decorateClass([Autowired("ctrlsService")],_AbstractHeaderCellCtrl.prototype,"ctrlsService",2);__decorateClass([Autowired("dragAndDropService")],_AbstractHeaderCellCtrl.prototype,"dragAndDropService",2);__decorateClass([Autowired("menuService")],_AbstractHeaderCellCtrl.prototype,"menuService",2);__decorateClass([PostConstruct],_AbstractHeaderCellCtrl.prototype,"postConstruct",1);var AbstractHeaderCellCtrl=_AbstractHeaderCellCtrl,_a144,SetLeftFeature=(_a144=class extends BeanStub{constructor(columnOrGroup,eCell,beans,colsSpanning){super(),this.columnOrGroup=columnOrGroup,this.eCell=eCell,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=colsSpanning,this.beans=beans}setColsSpanning(colsSpanning){this.colsSpanning=colsSpanning,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gridOptionsService.get("enableRtl")&&this.colsSpanning?last(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,Column.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const suppressMoveAnimation=this.beans.gridOptionsService.get("suppressColumnMoveAnimation"),oldLeftExists=exists(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&oldLeftExists&&!suppressMoveAnimation?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const colOrGroup=this.getColumnOrGroup(),left=colOrGroup.getLeft(),oldLeft=colOrGroup.getOldLeft(),oldActualLeft=this.modifyLeftForPrintLayout(colOrGroup,oldLeft),actualLeft=this.modifyLeftForPrintLayout(colOrGroup,left);this.setLeft(oldActualLeft),this.actualLeft=actualLeft,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===actualLeft&&this.setLeft(actualLeft)})}onLeftChanged(){const colOrGroup=this.getColumnOrGroup(),left=colOrGroup.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(colOrGroup,left),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(colOrGroup,leftPosition){if(!this.beans.gridOptionsService.isDomLayout("print")||colOrGroup.getPinned()==="left")return leftPosition;const leftWidth=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(colOrGroup.getPinned()==="right"){const bodyWidth=this.beans.columnModel.getBodyContainerWidth();return leftWidth+bodyWidth+leftPosition}return leftWidth+leftPosition}setLeft(value){if(exists(value)&&(this.eCell.style.left=`${value}px`),this.columnOrGroup instanceof Column)this.columnOrGroup;else{const children=this.columnOrGroup.getLeafColumns();if(!children.length)return;children.length>1&&setAriaColSpan(this.ariaEl,children.length),children[0]}}},__name(_a144,"SetLeftFeature"),_a144);__decorateClass([PostConstruct],SetLeftFeature.prototype,"postConstruct",1);var _a145,HoverFeature=(_a145=class extends BeanStub{constructor(columns,element){super(),this.columns=columns,this.element=element}postConstruct(){this.gridOptionsService.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}},__name(_a145,"HoverFeature"),_a145);__decorateClass([Autowired("columnHoverService")],HoverFeature.prototype,"columnHoverService",2);__decorateClass([PostConstruct],HoverFeature.prototype,"postConstruct",1);var _a146,HeaderFilterCellCtrl=(_a146=class extends AbstractHeaderCellCtrl{constructor(column,beans,parentRowCtrl){super(column,beans,parentRowCtrl),this.iconCreated=!1,this.column=column}setComp(comp,eGui,eButtonShowMainFilter,eFloatingFilterBody){this.comp=comp,this.eButtonShowMainFilter=eButtonShowMainFilter,this.eFloatingFilterBody=eFloatingFilterBody,this.setGui(eGui),this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,Column.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}resizeHeader(){}moveHeader(){}setupActive(){const colDef=this.column.getColDef(),filterExists=!!colDef.filter,floatingFilterExists=!!colDef.floatingFilter;this.active=filterExists&&floatingFilterExists}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const eMenuIcon=createIconNoSpan("filter",this.gridOptionsService,this.column);eMenuIcon&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(eMenuIcon))}setupFocus(){this.createManagedBean(new ManagedFocusFeature(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const localeTextFunc=this.localeService.getLocaleTextFunc();setAriaLabel(this.eButtonShowMainFilter,localeTextFunc("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gridOptionsService.getDocument().activeElement===this.eGui)return;const nextFocusableEl=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(nextFocusableEl){this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),nextFocusableEl.focus();return}const nextFocusableColumn=this.findNextColumnWithFloatingFilter(e.shiftKey);nextFocusableColumn&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:nextFocusableColumn},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(backwards){const columnModel=this.beans.columnModel;let nextCol=this.column;do if(nextCol=backwards?columnModel.getDisplayedColBefore(nextCol):columnModel.getDisplayedColAfter(nextCol),!nextCol)break;while(!nextCol.getColDef().filter||!nextCol.getColDef().floatingFilter);return nextCol}handleKeyDown(e){super.handleKeyDown(e);const wrapperHasFocus=this.getWrapperHasFocus();switch(e.key){case KeyCode.UP:case KeyCode.DOWN:wrapperHasFocus||e.preventDefault();case KeyCode.LEFT:case KeyCode.RIGHT:if(wrapperHasFocus)return;e.stopPropagation();case KeyCode.ENTER:wrapperHasFocus&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case KeyCode.ESCAPE:wrapperHasFocus||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const notFromHeaderWrapper=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),fromWithinHeader=!!e.relatedTarget&&isElementChildOfClass(e.relatedTarget,"ag-floating-filter");if(notFromHeaderWrapper&&fromWithinHeader&&e.target===this.eGui){const lastFocusEvent=this.lastFocusEvent,fromTab=!!(lastFocusEvent&&lastFocusEvent.key===KeyCode.TAB);if(lastFocusEvent&&fromTab){const shouldFocusLast=lastFocusEvent.shiftKey;this.focusService.focusInto(this.eGui,shouldFocusLast)}}const rowIndex=this.getRowIndex();this.beans.focusService.setFocusedHeader(rowIndex,this.column)}setupHover(){this.createManagedBean(new HoverFeature([this.column],this.eGui));const listener=__name(()=>{if(!this.gridOptionsService.get("columnHoverHighlight"))return;const hovered=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",hovered)},"listener");this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HOVER_CHANGED,listener),listener()}setupLeft(){const setLeftFeature=new SetLeftFeature(this.column,this.eGui,this.beans);this.createManagedBean(setLeftFeature)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const compDetails=this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());compDetails&&this.setCompDetails(compDetails)}setCompDetails(compDetails){this.userCompDetails=compDetails,this.comp.setCompDetails(compDetails)}showParentFilter(){const eventSource=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:eventSource,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(){if(!this.active)return;const{filterManager}=this.beans,syncWithFilter=__name(filterChangedEvent=>{const compPromise=this.comp.getFloatingFilterComp();compPromise&&compPromise.then(comp=>{if(comp){const parentModel=filterManager.getCurrentFloatingFilterParentModel(this.column);comp.onParentModelChanged(parentModel,filterChangedEvent)}})},"syncWithFilter");this.destroySyncListener=this.addManagedListener(this.column,Column.EVENT_FILTER_CHANGED,syncWithFilter),filterManager.isFilterActive(this.column)&&syncWithFilter(null)}setupWidth(){const listener=__name(()=>{const width=`${this.column.getActualWidth()}px`;this.comp.setWidth(width)},"listener");this.addManagedListener(this.column,Column.EVENT_WIDTH_CHANGED,listener),listener()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,Column.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const isFilterAllowed=this.beans.filterManager.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(isFilterAllowed),this.highlightFilterButtonWhenActive&&isFilterAllowed&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(){var _a273,_b;const wasActive=this.active;this.setupActive();const becomeActive=!wasActive&&this.active;wasActive&&!this.active&&((_a273=this.destroySyncListener)==null||_a273.call(this),(_b=this.destroyFilterChangedListener)==null||_b.call(this));const newCompDetails=this.active?this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,compPromise=this.comp.getFloatingFilterComp();!compPromise||!newCompDetails?this.updateCompDetails(newCompDetails,becomeActive):compPromise.then(compInstance=>{var _a274;!compInstance||this.beans.filterManager.areFilterCompsDifferent((_a274=this.userCompDetails)!=null?_a274:null,newCompDetails)?this.updateCompDetails(newCompDetails,becomeActive):this.updateFloatingFilterParams(newCompDetails)})}updateCompDetails(compDetails,becomeActive){this.isAlive()&&(this.setCompDetails(compDetails),this.setupFilterButton(),this.setupUi(),becomeActive&&(this.setupSyncWithFilter(),this.setupFilterChangedListener()))}updateFloatingFilterParams(userCompDetails){var _a273;if(!userCompDetails)return;const params=userCompDetails.params;(_a273=this.comp.getFloatingFilterComp())==null||_a273.then(floatingFilter=>{let hasRefreshed=!1;floatingFilter!=null&&floatingFilter.refresh&&typeof floatingFilter.refresh=="function"&&floatingFilter.refresh(params)!==null&&(hasRefreshed=!0),!hasRefreshed&&(floatingFilter!=null&&floatingFilter.onParamsUpdated)&&typeof floatingFilter.onParamsUpdated=="function"&&floatingFilter.onParamsUpdated(params)!==null&&warnOnce("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")})}destroy(){super.destroy(),this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.destroySyncListener=null,this.destroyFilterChangedListener=null}},__name(_a146,"HeaderFilterCellCtrl"),_a146),_a147,ResizeFeature=(_a147=class extends BeanStub{constructor(pinned,column,eResize,comp,ctrl){super(),this.pinned=pinned,this.column=column,this.eResize=eResize,this.comp=comp,this.ctrl=ctrl}postConstruct(){const destroyResizeFuncs=[];let canResize,canAutosize;const addResize=__name(()=>{if(setDisplayed(this.eResize,canResize),!canResize)return;const finishedWithResizeFunc=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(destroyResizeFuncs.push(finishedWithResizeFunc),canAutosize){const skipHeaderOnAutoSize=this.gridOptionsService.get("skipHeaderOnAutoSize"),autoSizeColListener=__name(()=>{this.columnModel.autoSizeColumn(this.column,"uiColumnResized",skipHeaderOnAutoSize)},"autoSizeColListener");this.eResize.addEventListener("dblclick",autoSizeColListener);const touchListener=new TouchListener(this.eResize);touchListener.addEventListener(TouchListener.EVENT_DOUBLE_TAP,autoSizeColListener),destroyResizeFuncs.push(()=>{this.eResize.removeEventListener("dblclick",autoSizeColListener),touchListener.removeEventListener(TouchListener.EVENT_DOUBLE_TAP,autoSizeColListener),touchListener.destroy()})}},"addResize"),removeResize=__name(()=>{destroyResizeFuncs.forEach(f=>f()),destroyResizeFuncs.length=0},"removeResize"),refresh=__name(()=>{const resize=this.column.isResizable(),autoSize=!this.gridOptionsService.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(resize!==canResize||autoSize!==canAutosize)&&(canResize=resize,canAutosize=autoSize,removeResize(),addResize())},"refresh");refresh(),this.addDestroyFunc(removeResize),this.ctrl.addRefreshFunction(refresh)}onResizing(finished,resizeAmount){const{column:key,lastResizeAmount,resizeStartWidth}=this,resizeAmountNormalised=this.normaliseResizeAmount(resizeAmount),newWidth=resizeStartWidth+resizeAmountNormalised,columnWidths=[{key,newWidth}];if(this.column.getPinned()){const leftWidth=this.pinnedWidthService.getPinnedLeftWidth(),rightWidth=this.pinnedWidthService.getPinnedRightWidth(),bodyWidth=getInnerWidth(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(leftWidth+rightWidth+(resizeAmountNormalised-lastResizeAmount)>bodyWidth)return}this.lastResizeAmount=resizeAmountNormalised,this.columnModel.setColumnWidths(columnWidths,this.resizeWithShiftKey,finished,"uiColumnResized"),finished&&this.toggleColumnResizing(!1)}onResizeStart(shiftKey){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=shiftKey,this.toggleColumnResizing(!0)}toggleColumnResizing(resizing){this.comp.addOrRemoveCssClass("ag-column-resizing",resizing)}normaliseResizeAmount(dragChange){let result=dragChange;const notPinningLeft=this.pinned!=="left",pinningRight=this.pinned==="right";return this.gridOptionsService.get("enableRtl")?notPinningLeft&&(result*=-1):pinningRight&&(result*=-1),result}},__name(_a147,"ResizeFeature"),_a147);__decorateClass([Autowired("horizontalResizeService")],ResizeFeature.prototype,"horizontalResizeService",2);__decorateClass([Autowired("pinnedWidthService")],ResizeFeature.prototype,"pinnedWidthService",2);__decorateClass([Autowired("ctrlsService")],ResizeFeature.prototype,"ctrlsService",2);__decorateClass([Autowired("columnModel")],ResizeFeature.prototype,"columnModel",2);__decorateClass([PostConstruct],ResizeFeature.prototype,"postConstruct",1);var _a148,SelectAllFeature=(_a148=class extends BeanStub{constructor(column){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=column}onSpaceKeyDown(e){const checkbox=this.cbSelectAll,eDocument=this.gridOptionsService.getDocument();checkbox.isDisplayed()&&!checkbox.getGui().contains(eDocument.activeElement)&&(e.preventDefault(),checkbox.setValue(!checkbox.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(ctrl){this.headerCellCtrl=ctrl,this.cbSelectAll=this.createManagedBean(new AgCheckbox),this.cbSelectAll.addCssClass("ag-header-select-all"),setAriaRole(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,Events.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),setAriaHidden(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const allSelected=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(allSelected);const hasNodesToSelect=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!hasNodesToSelect),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const translate=this.localeService.getLocaleTextFunc(),ariaStatus=this.cbSelectAll.getValue()?translate("ariaChecked","checked"):translate("ariaUnchecked","unchecked"),ariaLabel=translate("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${ariaLabel} (${ariaStatus})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${ariaLabel} (${ariaStatus})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(feature){return this.gridOptionsService.get("rowSelection")==="multiple"?!0:(console.warn(`AG Grid: ${feature} is only available if using 'multiple' rowSelection.`),!1)}checkRightRowModelType(feature){const rowModelType=this.rowModel.getType();return rowModelType==="clientSide"||rowModelType==="serverSide"?!0:(console.warn(`AG Grid: ${feature} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${rowModelType}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const value=this.cbSelectAll.getValue(),justFiltered=this.isFilteredOnly(),justCurrentPage=this.isCurrentPageOnly();let source="uiSelectAll";justCurrentPage?source="uiSelectAllCurrentPage":justFiltered&&(source="uiSelectAllFiltered");const params={source,justFiltered,justCurrentPage};value?this.selectionService.selectAllRowNodes(params):this.selectionService.deselectAllRowNodes(params)}isCheckboxSelection(){let result=this.column.getColDef().headerCheckboxSelection;if(typeof result=="function"){const func=result,params=this.gridOptionsService.addGridCommonParams({column:this.column,colDef:this.column.getColDef()});result=func(params)}return result?this.checkRightRowModelType("headerCheckboxSelection")&&this.checkSelectionType("headerCheckboxSelection"):!1}isFilteredOnly(){return!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){return!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}},__name(_a148,"SelectAllFeature"),_a148);__decorateClass([Autowired("rowModel")],SelectAllFeature.prototype,"rowModel",2);__decorateClass([Autowired("selectionService")],SelectAllFeature.prototype,"selectionService",2);var _a149,HeaderCellCtrl=(_a149=class extends AbstractHeaderCellCtrl{constructor(column,beans,parentRowCtrl){super(column,beans,parentRowCtrl),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=column}setComp(comp,eGui,eResize,eHeaderCompWrapper){this.comp=comp,this.setGui(eGui),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(eHeaderCompWrapper),this.addColumnHoverListener(),this.setupFilterClass(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.resizeFeature=this.createManagedBean(new ResizeFeature(this.getPinned(),this.column,eResize,comp,this)),this.createManagedBean(new HoverFeature([this.column],eGui)),this.createManagedBean(new SetLeftFeature(this.column,eGui,this.beans)),this.createManagedBean(new ManagedFocusFeature(eGui,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(),this.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],this.refresh.bind(this)),this.addManagedListener(this.column,Column.EVENT_COL_DEF_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}resizeHeader(delta,shiftKey){var _a273,_b;if(!this.column.isResizable())return;const actualWidth=this.column.getActualWidth(),minWidth=(_a273=this.column.getMinWidth())!=null?_a273:0,maxWidth=(_b=this.column.getMaxWidth())!=null?_b:Number.MAX_SAFE_INTEGER,newWidth=Math.min(Math.max(actualWidth+delta,minWidth),maxWidth);this.beans.columnModel.setColumnWidths([{key:this.column,newWidth}],shiftKey,!0,"uiColumnResized")}moveHeader(hDirection){const{eGui,column,gridOptionsService,ctrlsService}=this,pinned=this.getPinned(),left=eGui.getBoundingClientRect().left,width=column.getActualWidth(),isRtl=gridOptionsService.get("enableRtl"),isLeft=hDirection===0!==isRtl,xPosition=ColumnMoveHelper.normaliseX(isLeft?left-20:left+width+20,pinned,!0,gridOptionsService,ctrlsService);ColumnMoveHelper.attemptMoveColumns({allMovingColumns:[column],isFromHeader:!0,hDirection,xPosition,pinned,fromEnter:!1,fakeEvent:!1,gridOptionsService,columnModel:this.beans.columnModel}),ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(column,"auto")}setupUserComp(){const compDetails=this.lookupUserCompDetails();this.setCompDetails(compDetails)}setCompDetails(compDetails){this.userCompDetails=compDetails,this.comp.setUserCompDetails(compDetails)}lookupUserCompDetails(){const params=this.createParams(),colDef=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(colDef,params)}createParams(){return this.gridOptionsService.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:buttonElement=>{this.menuService.showColumnMenu({column:this.column,buttonElement,positionBy:"button"})},showColumnMenuAfterMouseClick:mouseEvent=>{this.menuService.showColumnMenu({column:this.column,mouseEvent,positionBy:"mouse"})},showFilter:buttonElement=>{this.menuService.showFilterMenu({column:this.column,buttonElement,containerType:"columnFilter",positionBy:"button"})},progressSort:multiSort=>{this.beans.sortController.progressSort(this.column,!!multiSort,"uiColumnSorted")},setSort:(sort,multiSort)=>{this.beans.sortController.setSortForColumn(this.column,sort,!!multiSort,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(value,shouldDisplayTooltip)=>{this.setupTooltip(value,shouldDisplayTooltip)}})}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new SelectAllFeature(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===KeyCode.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===KeyCode.ENTER&&this.onEnterKeyDown(e),e.key===KeyCode.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const multiSort=e.shiftKey;this.beans.sortController.progressSort(this.column,multiSort,"uiColumnSorted")}}showMenuOnKeyPress(e,isFilterShortcut){const headerComp=this.comp.getUserCompInstance();!headerComp||!(headerComp instanceof HeaderComp)||headerComp.onMenuKeyboardShortcut(isFilterShortcut)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const rowIndex=this.getRowIndex();this.focusService.setFocusedHeader(rowIndex,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(value,shouldDisplayTooltip){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const isTooltipWhenTruncated=this.gridOptionsService.get("tooltipShowMode")==="whenTruncated",eGui=this.eGui,colDef=this.column.getColDef();!shouldDisplayTooltip&&isTooltipWhenTruncated&&!colDef.headerComponent&&(shouldDisplayTooltip=__name(()=>{const textEl=eGui.querySelector(".ag-header-cell-text");return textEl?textEl.scrollWidth>textEl.clientWidth:!0},"shouldDisplayTooltip"));const tooltipCtrl={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>eGui,getLocation:()=>"header",getTooltipValue:()=>value??this.column.getColDef().headerTooltip,shouldDisplayTooltip},tooltipFeature=this.createManagedBean(new TooltipFeature(tooltipCtrl));this.refreshFunctions.push(()=>tooltipFeature.refreshToolTip())}setupClassesFromColDef(){const refreshHeaderClasses=__name(()=>{const colDef=this.column.getColDef(),classes=CssClassApplier.getHeaderClassesFromColDef(colDef,this.gridOptionsService,this.column,null),oldClasses=this.userHeaderClasses;this.userHeaderClasses=new Set(classes),classes.forEach(c=>{oldClasses.has(c)?oldClasses.delete(c):this.comp.addOrRemoveCssClass(c,!0)}),oldClasses.forEach(c=>this.comp.addOrRemoveCssClass(c,!1))},"refreshHeaderClasses");this.refreshFunctions.push(refreshHeaderClasses),refreshHeaderClasses()}setDragSource(eSource){if(this.dragSourceElement=eSource,this.removeDragSource(),!eSource||!this.draggable)return;const{column,beans,displayName,dragAndDropService,gridOptionsService}=this,{columnModel}=beans;let hideColumnOnExit=!this.gridOptionsService.get("suppressDragLeaveHidesColumns");const dragSource=this.dragSource={type:1,eElement:eSource,getDefaultIconName:()=>hideColumnOnExit?DragAndDropService.ICON_HIDE:DragAndDropService.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(column),dragItemName:displayName,onDragStarted:()=>{hideColumnOnExit=!gridOptionsService.get("suppressDragLeaveHidesColumns"),column.setMoving(!0,"uiColumnMoved")},onDragStopped:()=>column.setMoving(!1,"uiColumnMoved"),onGridEnter:dragItem=>{var _a273;if(hideColumnOnExit){const unlockedColumns=((_a273=dragItem==null?void 0:dragItem.columns)==null?void 0:_a273.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!0,"uiColumnMoved")}},onGridExit:dragItem=>{var _a273;if(hideColumnOnExit){const unlockedColumns=((_a273=dragItem==null?void 0:dragItem.columns)==null?void 0:_a273.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!1,"uiColumnMoved")}}};dragAndDropService.addDragSource(dragSource,!0)}createDragItem(column){const visibleState={};return visibleState[column.getId()]=column.isVisible(),{columns:[column],visibleState}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(func){this.refreshFunctions.push(func)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(f=>f())}refreshHeaderComp(){const newCompDetails=this.lookupUserCompDetails();(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==newCompDetails.componentClass?this.attemptHeaderCompRefresh(newCompDetails.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(newCompDetails)}attemptHeaderCompRefresh(params){const headerComp=this.comp.getUserCompInstance();return!headerComp||!headerComp.refresh?!1:headerComp.refresh(params)}calculateDisplayName(){return this.beans.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const colDef=this.column.getColDef();return!!(!this.gridOptionsService.get("suppressMovableColumns")&&!colDef.suppressMovable&&!colDef.lockPosition)||!!colDef.enableRowGroup||!!colDef.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const listener=__name(()=>{const columnWidth=this.column.getActualWidth();this.comp.setWidth(`${columnWidth}px`)},"listener");this.addManagedListener(this.column,Column.EVENT_WIDTH_CHANGED,listener),listener()}setupMovingCss(){const listener=__name(()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())},"listener");this.addManagedListener(this.column,Column.EVENT_MOVING_CHANGED,listener),listener()}setupMenuClass(){const listener=__name(()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())},"listener");this.addManagedListener(this.column,Column.EVENT_MENU_VISIBLE_CHANGED,listener),listener()}setupSortableClass(){const updateSortableCssClass=__name(()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)},"updateSortableCssClass");updateSortableCssClass(),this.addRefreshFunction(updateSortableCssClass),this.addManagedListener(this.eventService,Column.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupFilterClass(){const listener=__name(()=>{const isFilterActive=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",isFilterActive),this.refreshAria()},"listener");this.addManagedListener(this.column,Column.EVENT_FILTER_ACTIVE_CHANGED,listener),listener()}setupWrapTextClass(){const listener=__name(()=>{const wrapText=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",wrapText)},"listener");listener(),this.addRefreshFunction(listener)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui,column,comp,beans}=this;if(!column.isSpanHeaderHeight()){eGui.style.removeProperty("top"),eGui.style.removeProperty("height"),comp.addOrRemoveCssClass("ag-header-span-height",!1),comp.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents,isSpanningTotal}=this.column.getColumnGroupPaddingInfo();comp.addOrRemoveCssClass("ag-header-span-height",numberOfParents>0);const{columnModel}=beans,headerHeight=columnModel.getColumnHeaderRowHeight();if(numberOfParents===0){comp.addOrRemoveCssClass("ag-header-span-total",!1),eGui.style.setProperty("top","0px"),eGui.style.setProperty("height",`${headerHeight}px`);return}comp.addOrRemoveCssClass("ag-header-span-total",isSpanningTotal);const groupHeaderHeight=columnModel.isPivotMode()?columnModel.getPivotGroupHeaderHeight():columnModel.getGroupHeaderHeight(),extraHeight=numberOfParents*groupHeaderHeight;eGui.style.setProperty("top",`${-extraHeight}px`),eGui.style.setProperty("height",`${headerHeight+extraHeight}px`)}setupAutoHeight(wrapperElement){const{columnModel,resizeObserverService}=this.beans,measureHeight=__name(timesCalled=>{if(!this.isAlive())return;const{paddingTop,paddingBottom,borderBottomWidth,borderTopWidth}=getElementSize(this.getGui()),extraHeight=paddingTop+paddingBottom+borderBottomWidth+borderTopWidth,autoHeight=wrapperElement.offsetHeight+extraHeight;if(timesCalled<5){const doc=this.beans.gridOptionsService.getDocument(),notYetInDom=!doc||!doc.contains(wrapperElement),possiblyNoContentYet=autoHeight==0;if(notYetInDom||possiblyNoContentYet){window.setTimeout(()=>measureHeight(timesCalled+1),0);return}}columnModel.setColumnHeaderHeight(this.column,autoHeight)},"measureHeight");let isMeasuring=!1,stopResizeObserver;const checkMeasuring=__name(()=>{const newValue=this.column.isAutoHeaderHeight();newValue&&!isMeasuring&&startMeasuring(),!newValue&&isMeasuring&&stopMeasuring()},"checkMeasuring"),startMeasuring=__name(()=>{isMeasuring=!0,measureHeight(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),stopResizeObserver=resizeObserverService.observeResize(wrapperElement,()=>measureHeight(0))},"startMeasuring"),stopMeasuring=__name(()=>{isMeasuring=!1,stopResizeObserver&&stopResizeObserver(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),stopResizeObserver=void 0},"stopMeasuring");checkMeasuring(),this.addDestroyFunc(()=>stopMeasuring()),this.addManagedListener(this.column,Column.EVENT_WIDTH_CHANGED,()=>isMeasuring&&measureHeight(0)),this.addManagedListener(this.eventService,Column.EVENT_SORT_CHANGED,()=>{isMeasuring&&window.setTimeout(()=>measureHeight(0))}),this.addRefreshFunction(checkMeasuring)}refreshAriaSort(){if(this.sortable){const translate=this.localeService.getLocaleTextFunc(),sort=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(getAriaSortState(sort)),this.setAriaDescriptionProperty("sort",translate("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const translate=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",translate("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const translate=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",translate("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const translate=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",translate("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(property,value){value!=null?this.ariaDescriptionProperties.set(property,value):this.ariaDescriptionProperties.delete(property)}announceAriaDescription(){const eDocument=this.beans.gridOptionsService.getDocument();if(!this.eGui.contains(eDocument.activeElement))return;const ariaDescription=Array.from(this.ariaDescriptionProperties.keys()).sort((a,b)=>a==="filter"?-1:b.charCodeAt(0)-a.charCodeAt(0)).map(key=>this.ariaDescriptionProperties.get(key)).join(". ");this.beans.ariaAnnouncementService.announceValue(ariaDescription)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(){const listener=__name(()=>{if(!this.gridOptionsService.get("columnHoverHighlight"))return;const isHovered=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",isHovered)},"listener");this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HOVER_CHANGED,listener),listener()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(){const listener=__name(e=>this.handleMouseOverChange(e.type==="mouseenter"),"listener"),clickListener=__name(()=>this.dispatchColumnMouseEvent(Events.EVENT_COLUMN_HEADER_CLICKED,this.column),"clickListener"),contextMenuListener=__name(event=>this.handleContextMenuMouseEvent(event,void 0,this.column),"contextMenuListener");this.addManagedListener(this.getGui(),"mouseenter",listener),this.addManagedListener(this.getGui(),"mouseleave",listener),this.addManagedListener(this.getGui(),"click",clickListener),this.addManagedListener(this.getGui(),"contextmenu",contextMenuListener)}handleMouseOverChange(isMouseOver){this.setActiveHeader(isMouseOver);const event={type:isMouseOver?Events.EVENT_COLUMN_HEADER_MOUSE_OVER:Events.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column};this.eventService.dispatchEvent(event)}setActiveHeader(active){this.comp.addOrRemoveCssClass("ag-header-active",active)}getAnchorElementForMenu(isFilter){const headerComp=this.comp.getUserCompInstance();return headerComp instanceof HeaderComp?headerComp.getAnchorElementForMenu(isFilter):this.getGui()}destroy(){super.destroy(),this.refreshFunctions=null,this.selectAllFeature=null,this.dragSourceElement=null,this.userCompDetails=null,this.userHeaderClasses=null,this.ariaDescriptionProperties=null}},__name(_a149,"HeaderCellCtrl"),_a149),_a150,GroupResizeFeature=(_a150=class extends BeanStub{constructor(comp,eResize,pinned,columnGroup){super(),this.eResize=eResize,this.comp=comp,this.pinned=pinned,this.columnGroup=columnGroup}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const finishedWithResizeFunc=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(finishedWithResizeFunc),!this.gridOptionsService.get("suppressAutoSize")){const skipHeaderOnAutoSize=this.gridOptionsService.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const keys2=[];this.columnGroup.getDisplayedLeafColumns().forEach(column=>{column.getColDef().suppressAutoSize||keys2.push(column.getColId())}),keys2.length>0&&this.columnModel.autoSizeColumns({columns:keys2,skipHeader:skipHeaderOnAutoSize,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(shiftKey){const initialValues=this.getInitialValues(shiftKey);this.storeLocalValues(initialValues),this.toggleColumnResizing(!0)}onResizing(finished,resizeAmount,source="uiColumnResized"){const resizeAmountNormalised=this.normaliseDragChange(resizeAmount),width=this.resizeStartWidth+resizeAmountNormalised;this.resizeColumnsFromLocalValues(width,source,finished)}getInitialValues(shiftKey){const columnsToResize=this.getColumnsToResize(),resizeStartWidth=this.getInitialSizeOfColumns(columnsToResize),resizeRatios=this.getSizeRatiosOfColumns(columnsToResize,resizeStartWidth),columnSizeAndRatios={columnsToResize,resizeStartWidth,resizeRatios};let groupAfter=null;if(shiftKey&&(groupAfter=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),groupAfter){const takeFromLeafCols=groupAfter.getDisplayedLeafColumns(),groupAfterColumns=columnSizeAndRatios.groupAfterColumns=takeFromLeafCols.filter(col=>col.isResizable()),groupAfterStartWidth=columnSizeAndRatios.groupAfterStartWidth=this.getInitialSizeOfColumns(groupAfterColumns);columnSizeAndRatios.groupAfterRatios=this.getSizeRatiosOfColumns(groupAfterColumns,groupAfterStartWidth)}else columnSizeAndRatios.groupAfterColumns=void 0,columnSizeAndRatios.groupAfterStartWidth=void 0,columnSizeAndRatios.groupAfterRatios=void 0;return columnSizeAndRatios}storeLocalValues(initialValues){const{columnsToResize,resizeStartWidth,resizeRatios,groupAfterColumns,groupAfterStartWidth,groupAfterRatios}=initialValues;this.resizeCols=columnsToResize,this.resizeStartWidth=resizeStartWidth,this.resizeRatios=resizeRatios,this.resizeTakeFromCols=groupAfterColumns,this.resizeTakeFromStartWidth=groupAfterStartWidth,this.resizeTakeFromRatios=groupAfterRatios}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(source){const preferredSize=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),initialValues=this.getInitialValues();preferredSize>initialValues.resizeStartWidth&&this.resizeColumns(initialValues,preferredSize,source,!0)}resizeColumnsFromLocalValues(totalWidth,source,finished=!0){var _a273,_b,_c;if(!this.resizeCols||!this.resizeRatios)return;const initialValues={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:(_a273=this.resizeTakeFromCols)!=null?_a273:void 0,groupAfterStartWidth:(_b=this.resizeTakeFromStartWidth)!=null?_b:void 0,groupAfterRatios:(_c=this.resizeTakeFromRatios)!=null?_c:void 0};this.resizeColumns(initialValues,totalWidth,source,finished)}resizeColumns(initialValues,totalWidth,source,finished=!0){const{columnsToResize,resizeStartWidth,resizeRatios,groupAfterColumns,groupAfterStartWidth,groupAfterRatios}=initialValues,resizeSets=[];if(resizeSets.push({columns:columnsToResize,ratios:resizeRatios,width:totalWidth}),groupAfterColumns){const diff=totalWidth-resizeStartWidth;resizeSets.push({columns:groupAfterColumns,ratios:groupAfterRatios,width:groupAfterStartWidth-diff})}this.columnModel.resizeColumnSets({resizeSets,finished,source}),finished&&this.toggleColumnResizing(!1)}toggleColumnResizing(resizing){this.comp.addOrRemoveCssClass("ag-column-resizing",resizing)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(col=>col.isResizable())}getInitialSizeOfColumns(columns){return columns.reduce((totalWidth,column)=>totalWidth+column.getActualWidth(),0)}getSizeRatiosOfColumns(columns,initialSizeOfColumns){return columns.map(column=>column.getActualWidth()/initialSizeOfColumns)}normaliseDragChange(dragChange){let result=dragChange;return this.gridOptionsService.get("enableRtl")?this.pinned!=="left"&&(result*=-1):this.pinned==="right"&&(result*=-1),result}destroy(){super.destroy(),this.clearLocalValues()}},__name(_a150,"GroupResizeFeature"),_a150);__decorateClass([Autowired("horizontalResizeService")],GroupResizeFeature.prototype,"horizontalResizeService",2);__decorateClass([Autowired("autoWidthCalculator")],GroupResizeFeature.prototype,"autoWidthCalculator",2);__decorateClass([Autowired("columnModel")],GroupResizeFeature.prototype,"columnModel",2);__decorateClass([PostConstruct],GroupResizeFeature.prototype,"postConstruct",1);var _a151,GroupWidthFeature=(_a151=class extends BeanStub{constructor(comp,columnGroup){super(),this.removeChildListenersFuncs=[],this.columnGroup=columnGroup,this.comp=comp}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const widthChangedListener=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(column=>{column.addEventListener("widthChanged",widthChangedListener),column.addEventListener("visibleChanged",widthChangedListener),this.removeChildListenersFuncs.push(()=>{column.removeEventListener("widthChanged",widthChangedListener),column.removeEventListener("visibleChanged",widthChangedListener)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(func=>func()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const columnWidth=this.columnGroup.getActualWidth();this.comp.setWidth(`${columnWidth}px`),this.comp.addOrRemoveCssClass("ag-hidden",columnWidth===0)}},__name(_a151,"GroupWidthFeature"),_a151);__decorateClass([PostConstruct],GroupWidthFeature.prototype,"postConstruct",1);var _a152,HeaderGroupCellCtrl=(_a152=class extends AbstractHeaderCellCtrl{constructor(columnGroup,beans,parentRowCtrl){super(columnGroup,beans,parentRowCtrl),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const eGui=this.getGui();this.setDragSource(eGui)}},this.column=columnGroup}setComp(comp,eGui,eResize){this.comp=comp,this.setGui(eGui),this.displayName=this.beans.columnModel.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.addDestroyFunc(()=>{this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature))}),this.setupUserComp(),this.addHeaderMouseListeners();const pinned=this.getParentRowCtrl().getPinned(),leafCols=this.column.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new HoverFeature(leafCols,eGui)),this.createManagedBean(new SetLeftFeature(this.column,eGui,this.beans)),this.createManagedBean(new GroupWidthFeature(comp,this.column)),this.resizeFeature=this.createManagedBean(new GroupResizeFeature(comp,eResize,pinned,this.column)),this.createManagedBean(new ManagedFocusFeature(eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addManagedPropertyListener(Events.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners()}resizeHeader(delta,shiftKey){if(!this.resizeFeature)return;const initialValues=this.resizeFeature.getInitialValues(shiftKey);this.resizeFeature.resizeColumns(initialValues,initialValues.resizeStartWidth+delta,"uiColumnResized",!0)}moveHeader(hDirection){const{beans,eGui,column,gridOptionsService,ctrlsService}=this,isRtl=gridOptionsService.get("enableRtl"),isLeft=hDirection===0,pinned=this.getPinned(),rect=eGui.getBoundingClientRect(),left=rect.left,width=rect.width,xPosition=ColumnMoveHelper.normaliseX(isLeft!==isRtl?left-20:left+width+20,pinned,!0,gridOptionsService,ctrlsService),id=column.getGroupId(),headerPosition=this.focusService.getFocusedHeader();ColumnMoveHelper.attemptMoveColumns({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,hDirection,xPosition,pinned,fromEnter:!1,fakeEvent:!1,gridOptionsService,columnModel:beans.columnModel});const displayedLeafColumns=column.getDisplayedLeafColumns(),targetColumn=isLeft?displayedLeafColumns[0]:last(displayedLeafColumns);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(targetColumn,"auto"),!this.isAlive()&&headerPosition&&this.restoreFocus(id,column,headerPosition)}restoreFocus(groupId,previousColumnGroup,previousPosition){const leafCols=previousColumnGroup.getLeafColumns();if(!leafCols.length)return;const parent=leafCols[0].getParent();if(!parent)return;const newColumnGroup=this.findGroupWidthId(parent,groupId);newColumnGroup&&this.focusService.focusHeaderPosition({headerPosition:__spreadProps(__spreadValues({},previousPosition),{column:newColumnGroup})})}findGroupWidthId(columnGroup,id){for(;columnGroup;){if(columnGroup.getGroupId()===id)return columnGroup;columnGroup=columnGroup.getParent()}return null}resizeLeafColumnsToFit(source){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(source)}setupUserComp(){const params=this.gridOptionsService.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:expanded=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),expanded,"gridInitializing")},setTooltip:(value,shouldDisplayTooltip)=>{this.setupTooltip(value,shouldDisplayTooltip)}}),compDetails=this.userComponentFactory.getHeaderGroupCompDetails(params);this.comp.setUserCompDetails(compDetails)}addHeaderMouseListeners(){const listener=__name(e=>this.handleMouseOverChange(e.type==="mouseenter"),"listener"),clickListener=__name(()=>this.dispatchColumnMouseEvent(Events.EVENT_COLUMN_HEADER_CLICKED,this.column.getProvidedColumnGroup()),"clickListener"),contextMenuListener=__name(event=>this.handleContextMenuMouseEvent(event,void 0,this.column.getProvidedColumnGroup()),"contextMenuListener");this.addManagedListener(this.getGui(),"mouseenter",listener),this.addManagedListener(this.getGui(),"mouseleave",listener),this.addManagedListener(this.getGui(),"click",clickListener),this.addManagedListener(this.getGui(),"contextmenu",contextMenuListener)}handleMouseOverChange(isMouseOver){const event={type:isMouseOver?Events.EVENT_COLUMN_HEADER_MOUSE_OVER:Events.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column.getProvidedColumnGroup()};this.eventService.dispatchEvent(event)}setupTooltip(value,shouldDisplayTooltip){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const colGroupDef=this.column.getColGroupDef(),isTooltipWhenTruncated=this.gridOptionsService.get("tooltipShowMode")==="whenTruncated",eGui=this.eGui;!shouldDisplayTooltip&&isTooltipWhenTruncated&&!(colGroupDef!=null&&colGroupDef.headerGroupComponent)&&(shouldDisplayTooltip=__name(()=>{const textEl=eGui.querySelector(".ag-header-group-text");return textEl?textEl.scrollWidth>textEl.clientWidth:!0},"shouldDisplayTooltip"));const tooltipCtrl={getColumn:()=>this.column,getGui:()=>eGui,getLocation:()=>"headerGroup",getTooltipValue:()=>value??(colGroupDef&&colGroupDef.headerTooltip),shouldDisplayTooltip};colGroupDef&&(tooltipCtrl.getColDef=()=>colGroupDef),this.createBean(new TooltipFeature(tooltipCtrl))}setupExpandable(){const providedColGroup=this.column.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(providedColGroup,ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(providedColGroup,ProvidedColumnGroup.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const column=this.column;this.expandable=column.isExpandable();const expanded=column.isExpanded();this.expandable?this.comp.setAriaExpanded(expanded?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const colGroupDef=this.column.getColGroupDef(),classes=CssClassApplier.getHeaderClassesFromColDef(colGroupDef,this.gridOptionsService,null,this.column);this.column.isPadding()?(classes.push("ag-header-group-cell-no-group"),this.column.getLeafColumns().every(col=>col.isSpanHeaderHeight())&&classes.push("ag-header-span-height")):classes.push("ag-header-group-cell-with-group"),classes.forEach(c=>this.comp.addOrRemoveCssClass(c,!0))}setupMovingCss(){const leafColumns=this.column.getProvidedColumnGroup().getLeafColumns(),listener=__name(()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving()),"listener");leafColumns.forEach(col=>{this.addManagedListener(col,Column.EVENT_MOVING_CHANGED,listener)}),listener()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const rowIndex=this.getRowIndex();this.beans.focusService.setFocusedHeader(rowIndex,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const wrapperHasFocus=this.getWrapperHasFocus();if(!(!this.expandable||!wrapperHasFocus)&&e.key===KeyCode.ENTER){const column=this.column,newExpandedValue=!column.isExpanded();this.beans.columnModel.setColumnGroupOpened(column.getProvidedColumnGroup(),newExpandedValue,"uiColumnExpanded")}}setDragSource(eHeaderGroup){if(!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),!eHeaderGroup))return;const{beans,column,displayName,gridOptionsService,dragAndDropService}=this,{columnModel}=beans,allLeafColumns=column.getProvidedColumnGroup().getLeafColumns();let hideColumnOnExit=!gridOptionsService.get("suppressDragLeaveHidesColumns");const dragSource=this.dragSource={type:1,eElement:eHeaderGroup,getDefaultIconName:()=>hideColumnOnExit?DragAndDropService.ICON_HIDE:DragAndDropService.ICON_NOT_ALLOWED,dragItemName:displayName,getDragItem:()=>this.getDragItemForGroup(column),onDragStarted:()=>{hideColumnOnExit=!gridOptionsService.get("suppressDragLeaveHidesColumns"),allLeafColumns.forEach(col=>col.setMoving(!0,"uiColumnDragged"))},onDragStopped:()=>allLeafColumns.forEach(col=>col.setMoving(!1,"uiColumnDragged")),onGridEnter:dragItem=>{var _a273;if(hideColumnOnExit){const unlockedColumns=((_a273=dragItem==null?void 0:dragItem.columns)==null?void 0:_a273.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!0,"uiColumnMoved")}},onGridExit:dragItem=>{var _a273;if(hideColumnOnExit){const unlockedColumns=((_a273=dragItem==null?void 0:dragItem.columns)==null?void 0:_a273.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!1,"uiColumnMoved")}}};dragAndDropService.addDragSource(dragSource,!0)}getDragItemForGroup(columnGroup){const allColumnsOriginalOrder=columnGroup.getProvidedColumnGroup().getLeafColumns(),visibleState={};allColumnsOriginalOrder.forEach(column=>visibleState[column.getId()]=column.isVisible());const allColumnsCurrentOrder=[];return this.beans.columnModel.getAllDisplayedColumns().forEach(column=>{allColumnsOriginalOrder.indexOf(column)>=0&&(allColumnsCurrentOrder.push(column),removeFromArray(allColumnsOriginalOrder,column))}),allColumnsOriginalOrder.forEach(column=>allColumnsCurrentOrder.push(column)),{columns:allColumnsCurrentOrder,visibleState}}isSuppressMoving(){let childSuppressesMoving=!1;return this.column.getLeafColumns().forEach(column=>{(column.getColDef().suppressMovable||column.getColDef().lockPosition)&&(childSuppressesMoving=!0)}),childSuppressesMoving||this.gridOptionsService.get("suppressMovableColumns")}},__name(_a152,"HeaderGroupCellCtrl"),_a152),instanceIdSequence5=0,_a153,HeaderRowCtrl=(_a153=class extends BeanStub{constructor(rowIndex,pinned,type){super(),this.instanceId=instanceIdSequence5++,this.rowIndex=rowIndex,this.pinned=pinned,this.type=type;const typeClass=type=="group"?"ag-header-row-column-group":type=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${typeClass}`}postConstruct(){this.isPrintLayout=this.gridOptionsService.isDomLayout("print"),this.isEnsureDomOrder=this.gridOptionsService.get("ensureDomOrder")}getInstanceId(){return this.instanceId}setComp(comp,initCompState=!0){this.comp=comp,initCompState&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_VIRTUAL_COLUMNS_CHANGED,params=>this.onVirtualColumnsChanged(params.afterScroll)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",e=>this.isEnsureDomOrder=e.currentValue),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(column){if(this.headerCellCtrls)return values(this.headerCellCtrls).find(cellCtrl=>cellCtrl.getColumnGroupChild()===column)}onDisplayedColumnsChanged(){this.isPrintLayout=this.gridOptionsService.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const width=this.getWidthForRow();this.comp.setWidth(`${width}px`)}getWidthForRow(){const{columnModel}=this.beans;return this.isPrintLayout?this.pinned!=null?0:columnModel.getContainerWidth("right")+columnModel.getContainerWidth("left")+columnModel.getContainerWidth(null):columnModel.getContainerWidth(this.pinned)}onRowHeightChanged(){var{topOffset,rowHeight}=this.getTopAndHeight();this.comp.setTop(topOffset+"px"),this.comp.setHeight(rowHeight+"px")}getTopAndHeight(){const{columnModel,filterManager}=this.beans;let headerRowCount=columnModel.getHeaderRowCount();const sizes=[];let numberOfFloating=0;filterManager.hasFloatingFilters()&&(headerRowCount++,numberOfFloating=1);const groupHeight=columnModel.getColumnGroupHeaderRowHeight(),headerHeight=columnModel.getColumnHeaderRowHeight(),numberOfNonGroups=1+numberOfFloating,numberOfGroups=headerRowCount-numberOfNonGroups;for(let i=0;i<numberOfGroups;i++)sizes.push(groupHeight);sizes.push(headerHeight);for(let i=0;i<numberOfFloating;i++)sizes.push(columnModel.getFloatingFiltersHeight());let topOffset=0;for(let i=0;i<this.rowIndex;i++)topOffset+=sizes[i];const rowHeight=sizes[this.rowIndex];return{topOffset,rowHeight}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(afterScroll=!1){const ctrlsToDisplay=this.getHeaderCtrls(),forceOrder=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(ctrlsToDisplay,forceOrder,afterScroll)}getHeaderCtrls(){const oldCtrls=this.headerCellCtrls;this.headerCellCtrls=new Map;const columns=this.getColumnsInViewport();for(const child of columns)this.recycleAndCreateHeaderCtrls(child,oldCtrls);const isFocusedAndDisplayed=__name(ctrl=>{const{focusService,columnModel}=this.beans;return focusService.isHeaderWrapperFocused(ctrl)?columnModel.isDisplayed(ctrl.getColumnGroupChild()):!1},"isFocusedAndDisplayed");if(oldCtrls)for(const[id,oldCtrl]of oldCtrls)isFocusedAndDisplayed(oldCtrl)?this.headerCellCtrls.set(id,oldCtrl):this.destroyBean(oldCtrl);return Array.from(this.headerCellCtrls.values())}recycleAndCreateHeaderCtrls(headerColumn,oldCtrls){if(!this.headerCellCtrls||headerColumn.isEmptyGroup())return;const idOfChild=headerColumn.getUniqueId();let headerCtrl;if(oldCtrls&&(headerCtrl=oldCtrls.get(idOfChild),oldCtrls.delete(idOfChild)),headerCtrl&&headerCtrl.getColumnGroupChild()!=headerColumn&&(this.destroyBean(headerCtrl),headerCtrl=void 0),headerCtrl==null)switch(this.type){case"filter":headerCtrl=this.createBean(new HeaderFilterCellCtrl(headerColumn,this.beans,this));break;case"group":headerCtrl=this.createBean(new HeaderGroupCellCtrl(headerColumn,this.beans,this));break;default:headerCtrl=this.createBean(new HeaderCellCtrl(headerColumn,this.beans,this));break}this.headerCellCtrls.set(idOfChild,headerCtrl)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let viewportColumns=[];const actualDepth=this.getActualDepth(),{columnModel}=this.beans;return["left",null,"right"].forEach(pinned=>{const items=columnModel.getVirtualHeaderGroupRow(pinned,actualDepth);viewportColumns=viewportColumns.concat(items)}),viewportColumns}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(column,event){if(!this.headerCellCtrls)return!1;const ctrl=Array.from(this.headerCellCtrls.values()).find(ctrl2=>ctrl2.getColumnGroupChild()==column);return ctrl?ctrl.focus(event):!1}destroy(){this.headerCellCtrls&&this.headerCellCtrls.forEach(ctrl=>{this.destroyBean(ctrl)}),this.headerCellCtrls=void 0,super.destroy()}},__name(_a153,"HeaderRowCtrl"),_a153);__decorateClass([Autowired("beans")],HeaderRowCtrl.prototype,"beans",2);__decorateClass([PostConstruct],HeaderRowCtrl.prototype,"postConstruct",1);var _a154,HeaderRowContainerCtrl=(_a154=class extends BeanStub{constructor(pinned){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=pinned}setComp(comp,eGui){this.comp=comp,this.eViewport=eGui,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(dropContainer){const bodyDropTarget=new BodyDropTarget(this.pinned,dropContainer);this.createManagedBean(bodyDropTarget)}refresh(keepColumns=!1){const sequence=new NumberSequence,focusedHeaderPosition=this.focusService.getFocusHeaderToUseAfterRefresh(),refreshColumnGroups=__name(()=>{const groupRowCount=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let i=0;i<groupRowCount;i++){const ctrl=this.createBean(new HeaderRowCtrl(sequence.next(),this.pinned,"group"));this.groupsRowCtrls.push(ctrl)}},"refreshColumnGroups"),refreshColumns=__name(()=>{const rowIndex=sequence.next(),needNewInstance=!this.hidden&&(this.columnsRowCtrl==null||!keepColumns||this.columnsRowCtrl.getRowIndex()!==rowIndex);(needNewInstance||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),needNewInstance&&(this.columnsRowCtrl=this.createBean(new HeaderRowCtrl(rowIndex,this.pinned,"column")))},"refreshColumns"),refreshFilters=__name(()=>{this.includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;const destroyPreviousComp=__name(()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)},"destroyPreviousComp");if(!this.includeFloatingFilter){destroyPreviousComp();return}const rowIndex=sequence.next();if(this.filtersRowCtrl){const rowIndexMismatch=this.filtersRowCtrl.getRowIndex()!==rowIndex;(!keepColumns||rowIndexMismatch)&&destroyPreviousComp()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new HeaderRowCtrl(rowIndex,this.pinned,"filter")))},"refreshFilters");refreshColumnGroups(),refreshColumns(),refreshFilters();const allCtrls=this.getAllCtrls();this.comp.setCtrls(allCtrls),this.restoreFocusOnHeader(focusedHeaderPosition)}restoreFocusOnHeader(position){position==null||position.column.getPinned()!=this.pinned||this.focusService.focusHeaderPosition({headerPosition:position})}getAllCtrls(){const res=[...this.groupsRowCtrls];return this.columnsRowCtrl&&res.push(this.columnsRowCtrl),this.filtersRowCtrl&&res.push(this.filtersRowCtrl),res}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==includeFloatingFilter&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new CenterWidthFeature(width=>this.comp.setCenterWidth(`${width}px`),!0))}setHorizontalScroll(offset){this.comp.setViewportScrollLeft(offset)}setupPinnedWidth(){if(this.pinned==null)return;const pinningLeft=this.pinned==="left",pinningRight=this.pinned==="right";this.hidden=!0;const listener=__name(()=>{const width=pinningLeft?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(width==null)return;const hidden=width==0,hiddenChanged=this.hidden!==hidden,isRtl=this.gridOptionsService.get("enableRtl"),scrollbarWidth=this.gridOptionsService.getScrollbarWidth(),widthWithPadding=this.scrollVisibleService.isVerticalScrollShowing()&&(isRtl&&pinningLeft||!isRtl&&pinningRight)?width+scrollbarWidth:width;this.comp.setPinnedContainerWidth(`${widthWithPadding}px`),this.comp.setDisplayed(!hidden),hiddenChanged&&(this.hidden=hidden,this.refresh())},"listener");this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLLBAR_WIDTH_CHANGED,listener)}getHeaderCtrlForColumn(column){if(column instanceof Column)return this.columnsRowCtrl?this.columnsRowCtrl.getHeaderCellCtrl(column):void 0;if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){const ctrl=this.groupsRowCtrls[i].getHeaderCellCtrl(column);if(ctrl)return ctrl}}getHtmlElementForColumnHeader(column){const cellCtrl=this.getHeaderCtrlForColumn(column);return cellCtrl?cellCtrl.getGui():null}getRowType(rowIndex){const ctrl=this.getAllCtrls()[rowIndex];return ctrl?ctrl.getType():void 0}focusHeader(rowIndex,column,event){const ctrl=this.getAllCtrls()[rowIndex];return ctrl?ctrl.focusHeader(column,event):!1}getViewport(){return this.eViewport}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}},__name(_a154,"HeaderRowContainerCtrl"),_a154);__decorateClass([Autowired("ctrlsService")],HeaderRowContainerCtrl.prototype,"ctrlsService",2);__decorateClass([Autowired("scrollVisibleService")],HeaderRowContainerCtrl.prototype,"scrollVisibleService",2);__decorateClass([Autowired("pinnedWidthService")],HeaderRowContainerCtrl.prototype,"pinnedWidthService",2);__decorateClass([Autowired("columnModel")],HeaderRowContainerCtrl.prototype,"columnModel",2);__decorateClass([Autowired("focusService")],HeaderRowContainerCtrl.prototype,"focusService",2);__decorateClass([Autowired("filterManager")],HeaderRowContainerCtrl.prototype,"filterManager",2);var _a155,_HeaderRowContainerComp=(_a155=class extends Component{constructor(pinned){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=pinned}init(){this.selectAndSetTemplate();const compProxy={setDisplayed:displayed=>this.setDisplayed(displayed),setCtrls:ctrls=>this.setCtrls(ctrls),setCenterWidth:width=>this.eCenterContainer.style.width=width,setViewportScrollLeft:left=>this.getGui().scrollLeft=left,setPinnedContainerWidth:width=>{const eGui=this.getGui();eGui.style.width=width,eGui.style.maxWidth=width,eGui.style.minWidth=width}};this.createManagedBean(new HeaderRowContainerCtrl(this.pinned)).setComp(compProxy,this.getGui())}selectAndSetTemplate(){const pinnedLeft=this.pinned=="left",pinnedRight=this.pinned=="right",template=pinnedLeft?_a155.PINNED_LEFT_TEMPLATE:pinnedRight?_a155.PINNED_RIGHT_TEMPLATE:_a155.CENTER_TEMPLATE;this.setTemplate(template),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(rowComp){this.destroyBean(rowComp),this.eRowContainer.removeChild(rowComp.getGui())}setCtrls(ctrls){const oldRowComps=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let prevGui;const appendEnsuringDomOrder=__name(rowComp=>{const eGui=rowComp.getGui();eGui.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(eGui),prevGui&&ensureDomOrder(this.eRowContainer,eGui,prevGui),prevGui=eGui},"appendEnsuringDomOrder");ctrls.forEach(ctrl=>{const ctrlId=ctrl.getInstanceId(),existingComp=oldRowComps[ctrlId];delete oldRowComps[ctrlId];const rowComp=existingComp||this.createBean(new HeaderRowComp(ctrl));this.headerRowComps[ctrlId]=rowComp,this.rowCompsList.push(rowComp),appendEnsuringDomOrder(rowComp)}),getAllValuesInObject(oldRowComps).forEach(c=>this.destroyRowComp(c))}},__name(_a155,"_HeaderRowContainerComp"),_a155);_HeaderRowContainerComp.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="rowgroup"></div>';_HeaderRowContainerComp.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="rowgroup"></div>';_HeaderRowContainerComp.CENTER_TEMPLATE=`<div class="ag-header-viewport" role="presentation">
            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>
        </div>`;__decorateClass([RefSelector("eCenterContainer")],_HeaderRowContainerComp.prototype,"eCenterContainer",2);__decorateClass([PostConstruct],_HeaderRowContainerComp.prototype,"init",1);__decorateClass([PreDestroy],_HeaderRowContainerComp.prototype,"destroyRowComps",1);var HeaderRowContainerComp=_HeaderRowContainerComp,_a156,HeaderNavigationService=(_a156=class extends BeanStub{constructor(){super(...arguments),this.currentHeaderRowWithoutSpan=-1}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridBodyCon=p.gridBodyCtrl});const eDocument=this.gridOptionsService.getDocument();this.addManagedListener(eDocument,"mousedown",()=>this.setCurrentHeaderRowWithoutSpan(-1))}getHeaderRowCount(){const centerHeaderContainer=this.ctrlsService.getHeaderRowContainerCtrl();return centerHeaderContainer?centerHeaderContainer.getRowCount():0}navigateVertically(direction,fromHeader,event){if(fromHeader||(fromHeader=this.focusService.getFocusedHeader()),!fromHeader)return!1;const{headerRowIndex,column}=fromHeader,rowLen=this.getHeaderRowCount(),isUp=direction===0;let{headerRowIndex:nextRow,column:nextFocusColumn,headerRowIndexWithoutSpan}=isUp?this.headerPositionUtils.getColumnVisibleParent(column,headerRowIndex):this.headerPositionUtils.getColumnVisibleChild(column,headerRowIndex),skipColumn=!1;return nextRow<0&&(nextRow=0,nextFocusColumn=column,skipColumn=!0),nextRow>=rowLen?(nextRow=-1,this.setCurrentHeaderRowWithoutSpan(-1)):headerRowIndexWithoutSpan!==void 0&&(this.currentHeaderRowWithoutSpan=headerRowIndexWithoutSpan),!skipColumn&&!nextFocusColumn?!1:this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:nextRow,column:nextFocusColumn},allowUserOverride:!0,event})}setCurrentHeaderRowWithoutSpan(row){this.currentHeaderRowWithoutSpan=row}navigateHorizontally(direction,fromTab=!1,event){const focusedHeader=this.focusService.getFocusedHeader(),isLeft=direction===2,isRtl=this.gridOptionsService.get("enableRtl");let nextHeader,normalisedDirection;return this.currentHeaderRowWithoutSpan!==-1?focusedHeader.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=focusedHeader.headerRowIndex,isLeft!==isRtl?(normalisedDirection="Before",nextHeader=this.headerPositionUtils.findHeader(focusedHeader,normalisedDirection)):(normalisedDirection="After",nextHeader=this.headerPositionUtils.findHeader(focusedHeader,normalisedDirection)),nextHeader||!fromTab?this.focusService.focusHeaderPosition({headerPosition:nextHeader,direction:normalisedDirection,fromTab,allowUserOverride:!0,event}):this.focusNextHeaderRow(focusedHeader,normalisedDirection,event)}focusNextHeaderRow(focusedHeader,direction,event){const currentIndex=focusedHeader.headerRowIndex;let nextPosition=null,nextRowIndex;if(direction==="Before"?currentIndex>0&&(nextRowIndex=currentIndex-1,this.currentHeaderRowWithoutSpan-=1,nextPosition=this.headerPositionUtils.findColAtEdgeForHeaderRow(nextRowIndex,"end")):(nextRowIndex=currentIndex+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),nextPosition=this.headerPositionUtils.findColAtEdgeForHeaderRow(nextRowIndex,"start")),!nextPosition)return!1;const{column,headerRowIndex}=this.headerPositionUtils.getHeaderIndexToFocus(nextPosition.column,nextPosition==null?void 0:nextPosition.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column,headerRowIndex},direction,fromTab:!0,allowUserOverride:!0,event})}scrollToColumn(column,direction="After"){if(column.getPinned())return;let columnToScrollTo;if(column instanceof ColumnGroup){const columns=column.getDisplayedLeafColumns();columnToScrollTo=direction==="Before"?last(columns):columns[0]}else columnToScrollTo=column;this.gridBodyCon.getScrollFeature().ensureColumnVisible(columnToScrollTo)}},__name(_a156,"HeaderNavigationService"),_a156);__decorateClass([Autowired("focusService")],HeaderNavigationService.prototype,"focusService",2);__decorateClass([Autowired("headerPositionUtils")],HeaderNavigationService.prototype,"headerPositionUtils",2);__decorateClass([Autowired("ctrlsService")],HeaderNavigationService.prototype,"ctrlsService",2);__decorateClass([PostConstruct],HeaderNavigationService.prototype,"postConstruct",1);HeaderNavigationService=__decorateClass([Bean("headerNavigationService")],HeaderNavigationService);var _a157,GridHeaderCtrl=(_a157=class extends BeanStub{setComp(comp,eGui,eFocusableElement){this.comp=comp,this.eGui=eGui,this.createManagedBean(new ManagedFocusFeature(eFocusableElement,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight();const listener=this.onHeaderContextMenu.bind(this);this.addManagedListener(this.eGui,"contextmenu",listener),this.mockContextMenuForIPad(listener),this.ctrlsService.registerGridHeaderCtrl(this)}setupHeaderHeight(){const listener=this.setHeaderHeight.bind(this);listener(),this.addManagedPropertyListener("headerHeight",listener),this.addManagedPropertyListener("pivotHeaderHeight",listener),this.addManagedPropertyListener("groupHeaderHeight",listener),this.addManagedPropertyListener("pivotGroupHeaderHeight",listener),this.addManagedPropertyListener("floatingFiltersHeight",listener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,listener)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel}=this;let numberOfFloating=0,headerRowCount=columnModel.getHeaderRowCount(),totalHeaderHeight;this.filterManager.hasFloatingFilters()&&(headerRowCount++,numberOfFloating=1);const groupHeight=this.columnModel.getColumnGroupHeaderRowHeight(),headerHeight=this.columnModel.getColumnHeaderRowHeight(),numberOfNonGroups=1+numberOfFloating,numberOfGroups=headerRowCount-numberOfNonGroups;if(totalHeaderHeight=numberOfFloating*columnModel.getFloatingFiltersHeight(),totalHeaderHeight+=numberOfGroups*groupHeight,totalHeaderHeight+=headerHeight,this.headerHeight===totalHeaderHeight)return;this.headerHeight=totalHeaderHeight;const px=`${totalHeaderHeight+1}px`;this.comp.setHeightAndMinHeight(px),this.eventService.dispatchEvent({type:Events.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const pivotMode=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",pivotMode),this.comp.addOrRemoveCssClass("ag-pivot-off",!pivotMode)}onDisplayedColumnsChanged(){const shouldAllowOverflow=this.columnModel.getAllDisplayedColumns().some(col=>col.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",shouldAllowOverflow)}onTabKeyDown(e){const isRtl=this.gridOptionsService.get("enableRtl"),direction=e.shiftKey!==isRtl?2:3;(this.headerNavigationService.navigateHorizontally(direction,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let direction=null;switch(e.key){case KeyCode.LEFT:direction=2;case KeyCode.RIGHT:exists(direction)||(direction=3),this.headerNavigationService.navigateHorizontally(direction,!1,e);break;case KeyCode.UP:direction=0;case KeyCode.DOWN:exists(direction)||(direction=1),this.headerNavigationService.navigateVertically(direction,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const eDocument=this.gridOptionsService.getDocument(),{relatedTarget}=e;!relatedTarget&&this.eGui.contains(eDocument.activeElement)||this.eGui.contains(relatedTarget)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(mouseEvent,touch,touchEvent){if(!mouseEvent&&!touchEvent||!this.menuService.isHeaderContextMenuEnabled())return;const{target}=mouseEvent??touch;(target===this.eGui||target===this.ctrlsService.getHeaderRowContainerCtrl().getViewport())&&this.menuService.showHeaderContextMenu(void 0,mouseEvent,touchEvent)}mockContextMenuForIPad(listener){if(!isIOSUserAgent())return;const touchListener=new TouchListener(this.eGui),longTapListener=__name(event=>{listener(void 0,event.touchStart,event.touchEvent)},"longTapListener");this.addManagedListener(touchListener,TouchListener.EVENT_LONG_TAP,longTapListener),this.addDestroyFunc(()=>touchListener.destroy())}},__name(_a157,"GridHeaderCtrl"),_a157);__decorateClass([Autowired("headerNavigationService")],GridHeaderCtrl.prototype,"headerNavigationService",2);__decorateClass([Autowired("focusService")],GridHeaderCtrl.prototype,"focusService",2);__decorateClass([Autowired("columnModel")],GridHeaderCtrl.prototype,"columnModel",2);__decorateClass([Autowired("ctrlsService")],GridHeaderCtrl.prototype,"ctrlsService",2);__decorateClass([Autowired("filterManager")],GridHeaderCtrl.prototype,"filterManager",2);__decorateClass([Autowired("menuService")],GridHeaderCtrl.prototype,"menuService",2);var _a158,_GridHeaderComp=(_a158=class extends Component{constructor(){super(_a158.TEMPLATE)}postConstruct(){const compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setHeightAndMinHeight:height=>{this.getGui().style.height=height,this.getGui().style.minHeight=height}};this.createManagedBean(new GridHeaderCtrl).setComp(compProxy,this.getGui(),this.getFocusableElement());const addContainer=__name(container=>{this.createManagedBean(container),this.appendChild(container)},"addContainer");addContainer(new HeaderRowContainerComp("left")),addContainer(new HeaderRowContainerComp(null)),addContainer(new HeaderRowContainerComp("right"))}},__name(_a158,"_GridHeaderComp"),_a158);_GridHeaderComp.TEMPLATE='<div class="ag-header" role="presentation"/>';__decorateClass([PostConstruct],_GridHeaderComp.prototype,"postConstruct",1);var GridHeaderComp=_GridHeaderComp,_a159,HorizontalResizeService=(_a159=class extends BeanStub{addResizeBar(params){const dragSource={dragStartPixels:params.dragStartPixels||0,eElement:params.eResizeBar,onDragStart:this.onDragStart.bind(this,params),onDragStop:this.onDragStop.bind(this,params),onDragging:this.onDragging.bind(this,params),includeTouch:!0,stopPropagationForTouch:!0};return this.dragService.addDragSource(dragSource),__name(()=>this.dragService.removeDragSource(dragSource),"finishedWithResizeFunc")}onDragStart(params,mouseEvent){this.dragStartX=mouseEvent.clientX,this.setResizeIcons();const shiftKey=mouseEvent instanceof MouseEvent&&mouseEvent.shiftKey===!0;params.onResizeStart(shiftKey)}setResizeIcons(){const ctrl=this.ctrlsService.getGridCtrl();ctrl.setResizeCursor(!0),ctrl.disableUserSelect(!0)}onDragStop(params,mouseEvent){params.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const ctrl=this.ctrlsService.getGridCtrl();ctrl.setResizeCursor(!1),ctrl.disableUserSelect(!1)}onDragging(params,mouseEvent){this.resizeAmount=mouseEvent.clientX-this.dragStartX,params.onResizing(this.resizeAmount)}},__name(_a159,"HorizontalResizeService"),_a159);__decorateClass([Autowired("dragService")],HorizontalResizeService.prototype,"dragService",2);__decorateClass([Autowired("ctrlsService")],HorizontalResizeService.prototype,"ctrlsService",2);HorizontalResizeService=__decorateClass([Bean("horizontalResizeService")],HorizontalResizeService);var _a160,StandardMenuFactory=(_a160=class extends BeanStub{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(column,mouseEvent,containerType){this.showPopup(column,eMenu=>{this.popupService.positionPopupUnderMouseEvent({column,type:containerType,mouseEvent,ePopup:eMenu})},containerType,mouseEvent.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(column,eventSource,containerType){let multiplier=-1,alignSide="left";const isLegacyMenuEnabled=this.menuService.isLegacyMenuEnabled();!isLegacyMenuEnabled&&this.gridOptionsService.get("enableRtl")&&(multiplier=1,alignSide="right");let nudgeX=isLegacyMenuEnabled?void 0:4*multiplier,nudgeY=isLegacyMenuEnabled?void 0:4;this.showPopup(column,eMenu=>{this.popupService.positionPopupByComponent({type:containerType,eventSource,ePopup:eMenu,nudgeX,nudgeY,alignSide,keepWithinBounds:!0,position:"under",column})},containerType,eventSource,isLegacyMenuEnabled)}showPopup(column,positionCallback,containerType,eventSource,isLegacyMenuEnabled){const filterWrapper=column?this.filterManager.getOrCreateFilterWrapper(column,"COLUMN_MENU"):void 0;if(!filterWrapper||!column)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const eMenu=document.createElement("div");setAriaRole(eMenu,"presentation"),eMenu.classList.add("ag-menu"),isLegacyMenuEnabled||eMenu.classList.add("ag-filter-menu"),this.tabListener=this.addManagedListener(eMenu,"keydown",e=>this.trapFocusWithin(e,eMenu)),filterWrapper.guiPromise.then(gui=>eMenu.appendChild(gui));let hidePopup;const afterGuiDetached=__name(()=>{var _a273;return(_a273=filterWrapper.filterPromise)==null?void 0:_a273.then(filter=>{var _a274;return(_a274=filter==null?void 0:filter.afterGuiDetached)==null?void 0:_a274.call(filter)})},"afterGuiDetached"),anchorToElement=this.menuService.isColumnMenuAnchoringEnabled()?eventSource??this.ctrlsService.getGridBodyCtrl().getGui():void 0,closedCallback=__name(e=>{column.setMenuVisible(!1,"contextMenu");const isKeyboardEvent=e instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),isKeyboardEvent&&eventSource&&isVisible(eventSource)){const focusableEl=this.focusService.findTabbableParent(eventSource);focusableEl&&focusableEl.focus()}afterGuiDetached(),this.dispatchVisibleChangedEvent(!1,containerType,column)},"closedCallback"),translate=this.localeService.getLocaleTextFunc(),ariaLabel=isLegacyMenuEnabled&&containerType!=="columnFilter"?translate("ariaLabelColumnMenu","Column Menu"):translate("ariaLabelColumnFilter","Column Filter"),addPopupRes=this.popupService.addPopup({modal:!0,eChild:eMenu,closeOnEsc:!0,closedCallback,positionCallback:()=>positionCallback(eMenu),anchorToElement,ariaLabel});addPopupRes&&(this.hidePopup=hidePopup=addPopupRes.hideFunc),filterWrapper.filterPromise.then(filter=>{positionCallback(eMenu),filter.afterGuiAttached&&filter.afterGuiAttached({container:containerType,hidePopup})}),column.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,containerType,column)}trapFocusWithin(e,menu){e.key!==KeyCode.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(menu,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(menu,e.shiftKey))}dispatchVisibleChangedEvent(visible,containerType,column){const displayedEvent={type:Events.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible,switchingTab:!1,key:containerType,column:column??null};this.eventService.dispatchEvent(displayedEvent)}isMenuEnabled(column){var _a273;return column.isFilterAllowed()&&((_a273=column.getColDef().menuTabs)!=null?_a273:["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}},__name(_a160,"StandardMenuFactory"),_a160);__decorateClass([Autowired("filterManager")],StandardMenuFactory.prototype,"filterManager",2);__decorateClass([Autowired("popupService")],StandardMenuFactory.prototype,"popupService",2);__decorateClass([Autowired("focusService")],StandardMenuFactory.prototype,"focusService",2);__decorateClass([Autowired("ctrlsService")],StandardMenuFactory.prototype,"ctrlsService",2);__decorateClass([Autowired("menuService")],StandardMenuFactory.prototype,"menuService",2);StandardMenuFactory=__decorateClass([Bean("filterMenuFactory")],StandardMenuFactory);var TabGuardClassNames=(TabGuardClassNames2=>(TabGuardClassNames2.TAB_GUARD="ag-tab-guard",TabGuardClassNames2.TAB_GUARD_TOP="ag-tab-guard-top",TabGuardClassNames2.TAB_GUARD_BOTTOM="ag-tab-guard-bottom",TabGuardClassNames2))(TabGuardClassNames||{}),_a161,TabGuardCtrl=(_a161=class extends BeanStub{constructor(params){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1;const{comp,eTopGuard,eBottomGuard,focusTrapActive,forceFocusOutWhenTabGuardsAreEmpty,focusInnerElement,onFocusIn,onFocusOut,shouldStopEventPropagation,onTabKeyDown,handleKeyDown,eFocusableElement}=params;this.comp=comp,this.eTopGuard=eTopGuard,this.eBottomGuard=eBottomGuard,this.providedFocusInnerElement=focusInnerElement,this.eFocusableElement=eFocusableElement,this.focusTrapActive=!!focusTrapActive,this.forceFocusOutWhenTabGuardsAreEmpty=!!forceFocusOutWhenTabGuardsAreEmpty,this.providedFocusIn=onFocusIn,this.providedFocusOut=onFocusOut,this.providedShouldStopEventPropagation=shouldStopEventPropagation,this.providedOnTabKeyDown=onTabKeyDown,this.providedHandleKeyDown=handleKeyDown}postConstruct(){this.createManagedBean(new ManagedFocusFeature(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(guard=>this.addManagedListener(guard,"focus",this.onFocus.bind(this)))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const tabIndex=this.gridOptionsService.get("tabIndex");this.comp.setTabIndex(tabIndex.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length===0){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}const fromBottom=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(fromBottom):this.focusInnerElement(fromBottom)}findNextElementOutsideAndFocus(up){const eDocument=this.gridOptionsService.getDocument(),focusableEls=this.focusService.findFocusableElements(eDocument.body,null,!0),index=focusableEls.indexOf(up?this.eTopGuard:this.eBottomGuard);if(index===-1)return;let start,end;up?(start=0,end=index):(start=index+1,end=focusableEls.length);const focusableRange=focusableEls.slice(start,end),targetTabIndex=this.gridOptionsService.get("tabIndex");focusableRange.sort((a,b)=>{const indexA=parseInt(a.getAttribute("tabindex")||"0"),indexB=parseInt(b.getAttribute("tabindex")||"0");return indexB===targetTabIndex?1:indexA===targetTabIndex?-1:indexA===0?1:indexB===0?-1:indexA-indexB}),focusableRange[up?focusableRange.length-1:0].focus()}onFocusIn(e){this.focusTrapActive||(this.providedFocusIn&&this.providedFocusIn(e),this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const tabGuardsAreActive=this.tabGuardsAreActive();tabGuardsAreActive&&this.deactivateTabGuards();const nextRoot=this.getNextFocusableElement(e.shiftKey);tabGuardsAreActive&&setTimeout(()=>this.activateTabGuards(),0),nextRoot&&(nextRoot.focus(),e.preventDefault())}focusInnerElement(fromBottom=!1){const focusable=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(focusable.splice(0,1),focusable.splice(focusable.length-1,1)),focusable.length&&focusable[fromBottom?focusable.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(backwards){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,backwards)}forceFocusOutOfContainer(up=!1){if(this.forcingFocusOut)return;const tabGuardToFocus=up?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,tabGuardToFocus.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(element){return element===this.eTopGuard||element===this.eBottomGuard}},__name(_a161,"TabGuardCtrl"),_a161);__decorateClass([Autowired("focusService")],TabGuardCtrl.prototype,"focusService",2);__decorateClass([PostConstruct],TabGuardCtrl.prototype,"postConstruct",1);var _a162,TabGuardComp=(_a162=class extends Component{initialiseTabGuard(params){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const tabGuards=[this.eTopGuard,this.eBottomGuard],compProxy={setTabIndex:tabIndex=>{tabGuards.forEach(tabGuard=>tabIndex!=null?tabGuard.setAttribute("tabindex",tabIndex):tabGuard.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new TabGuardCtrl({comp:compProxy,focusTrapActive:!!params.focusTrapActive,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:params.onFocusIn,onFocusOut:params.onFocusOut,focusInnerElement:params.focusInnerElement,handleKeyDown:params.handleKeyDown,onTabKeyDown:params.onTabKeyDown,shouldStopEventPropagation:params.shouldStopEventPropagation,forceFocusOutWhenTabGuardsAreEmpty:params.forceFocusOutWhenTabGuardsAreEmpty}))}createTabGuard(side){const tabGuard=document.createElement("div"),cls=side==="top"?"ag-tab-guard-top":"ag-tab-guard-bottom";return tabGuard.classList.add("ag-tab-guard",cls),setAriaRole(tabGuard,"presentation"),tabGuard}addTabGuards(topTabGuard,bottomTabGuard){this.eFocusableElement.insertAdjacentElement("afterbegin",topTabGuard),this.eFocusableElement.insertAdjacentElement("beforeend",bottomTabGuard)}removeAllChildrenExceptTabGuards(){const tabGuards=[this.eTopGuard,this.eBottomGuard];clearElement(this.getFocusableElement()),this.addTabGuards(...tabGuards)}forceFocusOutOfContainer(up=!1){this.tabGuardCtrl.forceFocusOutOfContainer(up)}appendChild(newChild,container){isNodeOrElement(newChild)||(newChild=newChild.getGui());const{eBottomGuard:bottomTabGuard}=this;bottomTabGuard?bottomTabGuard.insertAdjacentElement("beforebegin",newChild):super.appendChild(newChild,container)}},__name(_a162,"TabGuardComp"),_a162),_a163,_TabbedLayout=(_a163=class extends TabGuardComp{constructor(params){super(_a163.getTemplate(params.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=params}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(item=>this.addItem(item)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>{var _a273,_b,_c;return(_c=(_b=(_a273=this.activeItem)==null?void 0:_a273.tabbedItem)==null?void 0:_b.afterDetachedCallback)==null?void 0:_c.call(_b)})}static getTemplate(cssClass){return`<div class="ag-tabs ${cssClass}">
            <div ref="eHeader"></div>
            <div ref="eBody" role="presentation" class="ag-tabs-body ${cssClass?`${cssClass}-body`:""}"></div>
        </div>`}setupHeader(){const{enableCloseButton,cssClass}=this.params,addCssClasses=__name((el,suffix)=>{el.classList.add(`ag-tabs-${suffix}`),cssClass&&el.classList.add(`${cssClass}-${suffix}`)},"addCssClasses");enableCloseButton?(this.setupCloseButton(addCssClasses),this.eTabHeader=this.gridOptionsService.getDocument().createElement("div"),addCssClasses(this.eHeader,"header-wrapper"),setAriaRole(this.eHeader,"presentation"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,setAriaRole(this.eTabHeader,"tablist"),addCssClasses(this.eTabHeader,"header")}setupCloseButton(addCssClasses){const eDocument=this.gridOptionsService.getDocument(),eCloseButton=eDocument.createElement("button");addCssClasses(eCloseButton,"close-button");const eIcon=createIconNoSpan("close",this.gridOptionsService,void 0,!0);setAriaLabel(eCloseButton,this.params.closeButtonAriaLabel),eCloseButton.appendChild(eIcon),this.addManagedListener(eCloseButton,"click",()=>{var _a273,_b;return(_b=(_a273=this.params).onCloseClicked)==null?void 0:_b.call(_a273)});const eCloseButtonWrapper=eDocument.createElement("div");addCssClasses(eCloseButtonWrapper,"close-button-wrapper"),setAriaRole(eCloseButtonWrapper,"presentation"),eCloseButtonWrapper.appendChild(eCloseButton),this.eHeader.appendChild(eCloseButtonWrapper),this.eCloseButton=eCloseButton}handleKeyDown(e){const eDocument=this.gridOptionsService.getDocument();switch(e.key){case KeyCode.RIGHT:case KeyCode.LEFT:if(!this.eTabHeader.contains(eDocument.activeElement))return;const isRightKey=e.key===KeyCode.RIGHT,isRtl=this.gridOptionsService.get("enableRtl"),currentPosition=this.items.indexOf(this.activeItem),nextPosition=isRightKey!==isRtl?Math.min(currentPosition+1,this.items.length-1):Math.max(currentPosition-1,0);if(currentPosition===nextPosition)return;e.preventDefault();const nextItem=this.items[nextPosition];this.showItemWrapper(nextItem),nextItem.eHeaderButton.focus();break;case KeyCode.UP:case KeyCode.DOWN:e.stopPropagation();break}}onTabKeyDown(e){var _a273,_b,_c,_d;if(e.defaultPrevented)return;const{focusService,eHeader,eBody,activeItem,params}=this,{suppressTrapFocus,enableCloseButton}=params,activeElement=this.gridOptionsService.getDocument().activeElement,target=e.target,backwards=e.shiftKey;if(eHeader.contains(activeElement)){e.preventDefault(),enableCloseButton&&backwards&&!((_a273=this.eCloseButton)!=null&&_a273.contains(activeElement))?(_b=this.eCloseButton)==null||_b.focus():suppressTrapFocus&&backwards?(_c=this.focusService.findFocusableElementBeforeTabGuard(this.gridOptionsService.getDocument().body,target))==null||_c.focus():this.focusBody(e.shiftKey);return}let nextEl=null;if(focusService.isTargetUnderManagedComponent(eBody,target)&&(backwards&&(nextEl=this.focusService.findFocusableElementBeforeTabGuard(eBody,target)),!nextEl&&!suppressTrapFocus&&(nextEl=activeItem.eHeaderButton)),!nextEl&&eBody.contains(activeElement)&&(nextEl=focusService.findNextFocusableElement(eBody,!1,backwards),!nextEl)){e.preventDefault(),suppressTrapFocus&&!backwards?this.forceFocusOutOfContainer(backwards):enableCloseButton&&!backwards?(_d=this.eCloseButton)==null||_d.focus():this.focusHeader();return}nextEl&&(e.preventDefault(),nextEl.focus())}focusInnerElement(fromBottom){fromBottom?this.focusHeader():this.focusBody(!0)}focusHeader(preventScroll){this.activeItem.eHeaderButton.focus({preventScroll})}focusBody(fromBottom){this.focusService.focusInto(this.eBody,fromBottom)}setAfterAttachedParams(params){this.afterAttachedParams=params}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(item){const eHeaderButton=document.createElement("span");setAriaRole(eHeaderButton,"tab"),eHeaderButton.setAttribute("tabindex","-1"),eHeaderButton.appendChild(item.title),eHeaderButton.classList.add("ag-tab"),this.eTabHeader.appendChild(eHeaderButton),setAriaLabel(eHeaderButton,item.titleLabel);const wrapper={tabbedItem:item,eHeaderButton};this.items.push(wrapper),eHeaderButton.addEventListener("click",this.showItemWrapper.bind(this,wrapper))}showItem(tabbedItem){const itemWrapper=this.items.find(wrapper=>wrapper.tabbedItem===tabbedItem);itemWrapper&&this.showItemWrapper(itemWrapper)}showItemWrapper(wrapper){var _a273,_b,_c,_d,_e,_f;const{tabbedItem,eHeaderButton}=wrapper;if((_b=(_a273=this.params).onItemClicked)==null||_b.call(_a273,{item:tabbedItem}),this.activeItem===wrapper){(_d=(_c=this.params).onActiveItemClicked)==null||_d.call(_c);return}this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),clearElement(this.eBody),tabbedItem.bodyPromise.then(body=>{this.eBody.appendChild(body);const onlyUnmanaged=!this.focusService.isKeyboardMode();if(this.params.suppressFocusBodyOnOpen||this.focusService.focusInto(this.eBody,!1,onlyUnmanaged),tabbedItem.afterAttachedCallback&&tabbedItem.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const scrollableContainer=tabbedItem.getScrollableContainer&&tabbedItem.getScrollableContainer()||body;this.lastScrollListener=this.addManagedListener(scrollableContainer,"scroll",()=>{this.tabbedItemScrollMap.set(tabbedItem.name,scrollableContainer.scrollTop)});const scrollPosition=this.tabbedItemScrollMap.get(tabbedItem.name);scrollPosition!==void 0&&setTimeout(()=>{scrollableContainer.scrollTop=scrollPosition},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),(_f=(_e=this.activeItem.tabbedItem).afterDetachedCallback)==null||_f.call(_e)),eHeaderButton.classList.add("ag-tab-selected"),this.activeItem=wrapper}},__name(_a163,"_TabbedLayout"),_a163);__decorateClass([Autowired("focusService")],_TabbedLayout.prototype,"focusService",2);__decorateClass([RefSelector("eHeader")],_TabbedLayout.prototype,"eHeader",2);__decorateClass([RefSelector("eBody")],_TabbedLayout.prototype,"eBody",2);__decorateClass([PostConstruct],_TabbedLayout.prototype,"postConstruct",1);var DEBOUNCE_DELAY=50,_a164,ResizeObserverService=(_a164=class extends BeanStub{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(element,callback){const win=this.gridOptionsService.getWindow(),useBrowserResizeObserver=__name(()=>{const resizeObserver=new win.ResizeObserver(callback);return resizeObserver.observe(element),()=>resizeObserver.disconnect()},"useBrowserResizeObserver"),usePolyfill=__name(()=>{var _a273,_b;let widthLastTime=(_a273=element==null?void 0:element.clientWidth)!=null?_a273:0,heightLastTime=(_b=element==null?void 0:element.clientHeight)!=null?_b:0,running=!0;const periodicallyCheckWidthAndHeight=__name(()=>{var _a274,_b2;if(running){const newWidth=(_a274=element==null?void 0:element.clientWidth)!=null?_a274:0,newHeight=(_b2=element==null?void 0:element.clientHeight)!=null?_b2:0;(newWidth!==widthLastTime||newHeight!==heightLastTime)&&(widthLastTime=newWidth,heightLastTime=newHeight,callback()),this.doNextPolyfillTurn(periodicallyCheckWidthAndHeight)}},"periodicallyCheckWidthAndHeight");return periodicallyCheckWidthAndHeight(),()=>running=!1},"usePolyfill"),suppressResize=this.gridOptionsService.get("suppressBrowserResizeObserver");return!!win.ResizeObserver&&!suppressResize?useBrowserResizeObserver():this.getFrameworkOverrides().wrapIncoming(()=>usePolyfill(),"resize-observer")}doNextPolyfillTurn(func){this.polyfillFunctions.push(func),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;const executeAllFuncs=__name(()=>{const funcs=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],funcs.forEach(f=>f())},"executeAllFuncs");this.polyfillScheduled=!0,window.setTimeout(executeAllFuncs,DEBOUNCE_DELAY)}},__name(_a164,"ResizeObserverService"),_a164);ResizeObserverService=__decorateClass([Bean("resizeObserverService")],ResizeObserverService);var _a165,AnimationFrameService=(_a165=class extends BeanStub{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(scrollTop){const isPaginationActive=this.gridOptionsService.get("pagination");if(this.scrollGoingDown=scrollTop>=this.lastScrollTop,isPaginationActive&&scrollTop===0){const currentPage=this.paginationProxy.getCurrentPage();currentPage!==this.lastPage&&(this.lastPage=currentPage,this.scrollGoingDown=!0)}this.lastScrollTop=scrollTop}init(){this.useAnimationFrame=!this.gridOptionsService.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(methodName){this.useAnimationFrame===!1&&console.warn(`AG Grid: AnimationFrameService.${methodName} called but animation frames are off`)}createTask(task,index,list){this.verifyAnimationFrameOn(list);const taskItem={task,index,createOrder:++this.taskCount};this.addTaskToList(this[list],taskItem),this.schedule()}cancelTask(task){this.cancelledTasks.add(task)}addTaskToList(taskList,task){taskList.list.push(task),taskList.sorted=!1}sortTaskList(taskList){if(taskList.sorted)return;const sortDirection=this.scrollGoingDown?1:-1;taskList.list.sort((a,b)=>a.index!==b.index?sortDirection*(b.index-a.index):b.createOrder-a.createOrder),taskList.sorted=!0}addDestroyTask(task){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(task),this.schedule()}executeFrame(millis){this.verifyAnimationFrameOn("executeFrame");const p1TaskList=this.createTasksP1,p1Tasks=p1TaskList.list,p2TaskList=this.createTasksP2,p2Tasks=p2TaskList.list,destroyTasks=this.destroyTasks,frameStart=new Date().getTime();let duration=new Date().getTime()-frameStart;const noMaxMillis=millis<=0,gridBodyCon=this.ctrlsService.getGridBodyCtrl();for(;noMaxMillis||duration<millis;){if(!gridBodyCon.getScrollFeature().scrollGridIfNeeded()){let task;if(p1Tasks.length)this.sortTaskList(p1TaskList),task=p1Tasks.pop().task;else if(p2Tasks.length)this.sortTaskList(p2TaskList),task=p2Tasks.pop().task;else if(destroyTasks.length)task=destroyTasks.pop();else{this.cancelledTasks.clear();break}this.cancelledTasks.has(task)||task()}duration=new Date().getTime()-frameStart}p1Tasks.length||p2Tasks.length||destroyTasks.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const callback=this.executeFrame.bind(this,60);this.requestAnimationFrame(callback)}requestAnimationFrame(callback){const win=this.gridOptionsService.getWindow();win.requestAnimationFrame?win.requestAnimationFrame(callback):win.webkitRequestAnimationFrame?win.webkitRequestAnimationFrame(callback):win.setTimeout(callback,0)}isQueueEmpty(){return!this.ticking}debounce(func){let pending=!1;return()=>{if(!this.isOn()){window.setTimeout(func,0);return}pending||(pending=!0,this.addDestroyTask(()=>{pending=!1,func()}))}}},__name(_a165,"AnimationFrameService"),_a165);__decorateClass([Autowired("ctrlsService")],AnimationFrameService.prototype,"ctrlsService",2);__decorateClass([Autowired("paginationProxy")],AnimationFrameService.prototype,"paginationProxy",2);__decorateClass([PostConstruct],AnimationFrameService.prototype,"init",1);AnimationFrameService=__decorateClass([Bean("animationFrameService")],AnimationFrameService);var _a166,ExpansionService=(_a166=class extends BeanStub{postConstruct(){this.isClientSideRowModel=this.rowModel.getType()==="clientSide"}expandRows(rowIds){if(!this.isClientSideRowModel)return;const rowIdSet=new Set(rowIds);this.rowModel.forEachNode(node=>{node.id&&rowIdSet.has(node.id)&&(node.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const expandedRows=[];return this.rowModel.forEachNode(({expanded,id})=>{expanded&&id&&expandedRows.push(id)}),expandedRows}expandAll(value){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(value)}setRowNodeExpanded(rowNode,expanded,expandParents){rowNode&&(expandParents&&rowNode.parent&&rowNode.parent.level!==-1&&this.setRowNodeExpanded(rowNode.parent,expanded,expandParents),rowNode.setExpanded(expanded))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}},__name(_a166,"ExpansionService"),_a166);__decorateClass([Autowired("rowModel")],ExpansionService.prototype,"rowModel",2);__decorateClass([PostConstruct],ExpansionService.prototype,"postConstruct",1);ExpansionService=__decorateClass([Bean("expansionService")],ExpansionService);var _a167,MenuService=(_a167=class extends BeanStub{postConstruct(){var _a273;this.activeMenuFactory=(_a273=this.enterpriseMenuFactory)!=null?_a273:this.filterMenuFactory}showColumnMenu(params){this.showColumnMenuCommon(this.activeMenuFactory,params,"columnMenu")}showFilterMenu(params){const menuFactory=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(menuFactory,params,params.containerType,!0)}showHeaderContextMenu(column,mouseEvent,touchEvent){this.activeMenuFactory.showMenuAfterContextMenuEvent(column,mouseEvent,touchEvent)}showContextMenu(params){var _a273,_b,_c;const{column,anchorToElement,rowNode,value}=params;(_c=this.contextMenuFactory)==null||_c.onContextMenu((_a273=params.mouseEvent)!=null?_a273:null,(_b=params.touchEvent)!=null?_b:null,rowNode??null,column??null,value,anchorToElement)}showColumnChooser(params){var _a273;(_a273=this.columnChooserFactory)==null||_a273.showColumnChooser(params)}hidePopupMenu(){var _a273;(_a273=this.contextMenuFactory)==null||_a273.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var _a273;(_a273=this.columnChooserFactory)==null||_a273.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(column){const{suppressMenu,suppressHeaderMenuButton}=column.getColDef();return!(suppressHeaderMenuButton??suppressMenu)&&this.activeMenuFactory.isMenuEnabled(column)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(column){return!column.getColDef().suppressHeaderFilterButton&&this.filterManager.isFilterAllowed(column)}isHeaderContextMenuEnabled(column){return!(column!=null&&column.getColDef().suppressHeaderContextMenu)&&this.getColumnMenuType()==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const menuHides=!this.isSuppressMenuHide();return!(isIOSUserAgent()&&menuHides)}isHeaderFilterButtonEnabled(column){return this.isFilterMenuInHeaderEnabled(column)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(column)}isFilterMenuItemEnabled(column){return this.filterManager.isFilterAllowed(column)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(column)&&!this.isFloatingFilterButtonDisplayed(column)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return this.getColumnMenuType()==="new"}isLegacyMenuEnabled(){return this.getColumnMenuType()==="legacy"}isFloatingFilterButtonEnabled(column){var _a273;const colDef=column.getColDef(),legacySuppressFilterButton=(_a273=colDef.floatingFilterComponentParams)==null?void 0:_a273.suppressFilterButton;return legacySuppressFilterButton!=null&&warnOnce("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),colDef.suppressFloatingFilterButton==null?!legacySuppressFilterButton:!colDef.suppressFloatingFilterButton}getColumnMenuType(){var _a273;return(_a273=this.gridOptionsService.get("columnMenu"))!=null?_a273:"legacy"}isFloatingFilterButtonDisplayed(column){return!!column.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(column)}isSuppressMenuHide(){const suppressMenuHide=this.gridOptionsService.get("suppressMenuHide");return this.isLegacyMenuEnabled()||this.gridOptionsService.exists("suppressMenuHide")?suppressMenuHide:!0}showColumnMenuCommon(menuFactory,params,containerType,filtersOnly){const{column,positionBy}=params;if(positionBy==="button"){const{buttonElement}=params;menuFactory.showMenuAfterButtonClick(column,buttonElement,containerType,filtersOnly)}else if(positionBy==="mouse"){const{mouseEvent}=params;menuFactory.showMenuAfterMouseEvent(column,mouseEvent,containerType,filtersOnly)}else column&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(column,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const headerCellCtrl=this.ctrlsService.getHeaderRowContainerCtrl(column.getPinned()).getHeaderCtrlForColumn(column);menuFactory.showMenuAfterButtonClick(column,headerCellCtrl.getAnchorElementForMenu(filtersOnly),containerType,!0)}))}},__name(_a167,"MenuService"),_a167);__decorateClass([Optional("enterpriseMenuFactory")],MenuService.prototype,"enterpriseMenuFactory",2);__decorateClass([Autowired("filterMenuFactory")],MenuService.prototype,"filterMenuFactory",2);__decorateClass([Optional("contextMenuFactory")],MenuService.prototype,"contextMenuFactory",2);__decorateClass([Autowired("ctrlsService")],MenuService.prototype,"ctrlsService",2);__decorateClass([Autowired("animationFrameService")],MenuService.prototype,"animationFrameService",2);__decorateClass([Optional("columnChooserFactory")],MenuService.prototype,"columnChooserFactory",2);__decorateClass([Autowired("filterManager")],MenuService.prototype,"filterManager",2);__decorateClass([PostConstruct],MenuService.prototype,"postConstruct",1);MenuService=__decorateClass([Bean("menuService")],MenuService);var _a168,AutoWidthCalculator=(_a168=class extends BeanStub{postConstruct(){this.ctrlsService.whenReady(p=>{this.centerRowContainerCtrl=p.centerRowContainerCtrl})}getPreferredWidthForColumn(column,skipHeader){const eHeaderCell=this.getHeaderCellForColumn(column);if(!eHeaderCell)return-1;const elements=this.rowRenderer.getAllCellsForColumn(column);return skipHeader||elements.push(eHeaderCell),this.addElementsToContainerAndGetWidth(elements)}getPreferredWidthForColumnGroup(columnGroup){const eHeaderCell=this.getHeaderCellForColumn(columnGroup);return eHeaderCell?this.addElementsToContainerAndGetWidth([eHeaderCell]):-1}addElementsToContainerAndGetWidth(elements){const eDummyContainer=document.createElement("form");eDummyContainer.style.position="fixed";const eBodyContainer=this.centerRowContainerCtrl.getContainerElement();elements.forEach(el=>this.cloneItemIntoDummy(el,eDummyContainer)),eBodyContainer.appendChild(eDummyContainer);const dummyContainerWidth=eDummyContainer.offsetWidth;eBodyContainer.removeChild(eDummyContainer);const autoSizePadding=this.getAutoSizePadding();return dummyContainerWidth+autoSizePadding}getAutoSizePadding(){return this.gridOptionsService.get("autoSizePadding")}getHeaderCellForColumn(column){let element=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(container=>{const res=container.getHtmlElementForColumnHeader(column);res!=null&&(element=res)}),element}cloneItemIntoDummy(eCell,eDummyContainer){const eCellClone=eCell.cloneNode(!0);eCellClone.style.width="",eCellClone.style.position="static",eCellClone.style.left="";const eCloneParent=document.createElement("div"),eCloneParentClassList=eCloneParent.classList;["ag-header-cell","ag-header-group-cell"].some(cls=>eCellClone.classList.contains(cls))?(eCloneParentClassList.add("ag-header","ag-header-row"),eCloneParent.style.position="static"):eCloneParentClassList.add("ag-row");let pointer=eCell.parentElement;for(;pointer;){if(["ag-header-row","ag-row"].some(cls=>pointer.classList.contains(cls))){for(let i=0;i<pointer.classList.length;i++){const item=pointer.classList[i];item!="ag-row-position-absolute"&&eCloneParentClassList.add(item)}break}pointer=pointer.parentElement}eCloneParent.appendChild(eCellClone),eDummyContainer.appendChild(eCloneParent)}},__name(_a168,"AutoWidthCalculator"),_a168);__decorateClass([Autowired("rowRenderer")],AutoWidthCalculator.prototype,"rowRenderer",2);__decorateClass([Autowired("ctrlsService")],AutoWidthCalculator.prototype,"ctrlsService",2);__decorateClass([Autowired("rowCssClassCalculator")],AutoWidthCalculator.prototype,"rowCssClassCalculator",2);__decorateClass([PostConstruct],AutoWidthCalculator.prototype,"postConstruct",1);AutoWidthCalculator=__decorateClass([Bean("autoWidthCalculator")],AutoWidthCalculator);var _a169,StickyRowFeature=(_a169=class extends BeanStub{constructor(createRowCon,destroyRowCtrls){super(),this.createRowCon=createRowCon,this.destroyRowCtrls=destroyRowCtrls,this.stickyRowCtrls=[],this.containerHeight=0}postConstruct(){this.isClientSide=this.rowModel.getType()==="clientSide",this.ctrlsService.whenReady(params=>{this.gridBodyCtrl=params.gridBodyCtrl})}getStickyRowCtrls(){return this.stickyRowCtrls}checkStickyRows(){let height=0;if(!this.gridOptionsService.isGroupRowsSticky())return this.refreshNodesAndContainerHeight([],height);const stickyRows=[],firstPixel=this.rowRenderer.getFirstVisibleVerticalPixel(),addStickyRow=__name(stickyRow=>{var _a273,_b,_c;stickyRows.push(stickyRow);let lastChildBottom;if(this.isClientSide){let lastAncestor=stickyRow;for(;lastAncestor.isExpandable()&&lastAncestor.expanded;)if(lastAncestor.master)lastAncestor=lastAncestor.detailNode;else if(lastAncestor.childrenAfterSort){if(lastAncestor.childrenAfterSort.length===0)break;lastAncestor=last(lastAncestor.childrenAfterSort)}lastChildBottom=lastAncestor.rowTop+lastAncestor.rowHeight}else if(stickyRow.master)lastChildBottom=stickyRow.detailNode.rowTop+stickyRow.detailNode.rowHeight;else{const storeBounds=(_a273=stickyRow.childStore)==null?void 0:_a273.getStoreBounds();lastChildBottom=((_b=storeBounds==null?void 0:storeBounds.heightPx)!=null?_b:0)+((_c=storeBounds==null?void 0:storeBounds.topPx)!=null?_c:0)}const stickRowBottom=firstPixel+height+stickyRow.rowHeight;lastChildBottom<stickRowBottom?stickyRow.stickyRowTop=height+(lastChildBottom-stickRowBottom):stickyRow.stickyRowTop=height,height=0,stickyRows.forEach(rowNode=>{const thisRowLastPx=rowNode.stickyRowTop+rowNode.rowHeight;height<thisRowLastPx&&(height=thisRowLastPx)})},"addStickyRow");let counter=0;for(;;){const firstPixelAfterStickyRows=firstPixel+height,firstIndex=this.rowModel.getRowIndexAtPixel(firstPixelAfterStickyRows),firstRow=this.rowModel.getRow(firstIndex);if(firstRow==null||firstRow.level<0||counter++===100)break;const parents=[];let p=firstRow.parent;for(;p.level>=0;)parents.push(p),p=p.parent;const firstMissingParent=parents.reverse().find(parent=>stickyRows.indexOf(parent)<0&&parent.displayed);if(firstMissingParent){addStickyRow(firstMissingParent);continue}if(firstRow.isExpandable()&&firstRow.expanded&&firstRow.rowTop<firstPixelAfterStickyRows){addStickyRow(firstRow);continue}break}return this.refreshNodesAndContainerHeight(stickyRows,height)}refreshStickyNode(stickRowNode){const allStickyNodes=[];for(let i=0;i<this.stickyRowCtrls.length;i++){const currentNode=this.stickyRowCtrls[i].getRowNode();currentNode!==stickRowNode&&allStickyNodes.push(currentNode)}this.refreshNodesAndContainerHeight(allStickyNodes,this.containerHeight)&&this.checkStickyRows()}refreshNodesAndContainerHeight(allStickyNodes,height){let stickyRowsChanged=!1;const removedCtrls=this.stickyRowCtrls.filter(ctrl=>allStickyNodes.indexOf(ctrl.getRowNode())===-1),addedNodes=allStickyNodes.filter(rowNode=>this.stickyRowCtrls.findIndex(ctrl=>ctrl.getRowNode()===rowNode)===-1);(removedCtrls.length||addedNodes.length)&&(stickyRowsChanged=!0);const ctrlsToDestroy={};removedCtrls.forEach(removedCtrl=>{ctrlsToDestroy[removedCtrl.getRowNode().id]=removedCtrl,this.stickyRowCtrls=this.stickyRowCtrls.filter(ctrl=>ctrl!==removedCtrl)});for(const ctrl of Object.values(ctrlsToDestroy))ctrl.getRowNode().sticky=!1;this.destroyRowCtrls(ctrlsToDestroy,!1);const newCtrls=addedNodes.map(rowNode=>(rowNode.sticky=!0,this.createRowCon(rowNode,!1,!1)));return this.stickyRowCtrls.push(...newCtrls),this.stickyRowCtrls.forEach(ctrl=>ctrl.setRowTop(ctrl.getRowNode().stickyRowTop)),this.stickyRowCtrls.sort((a,b)=>b.getRowNode().rowIndex-a.getRowNode().rowIndex),this.containerHeight!==height&&(this.containerHeight=height,this.gridBodyCtrl.setStickyTopHeight(height),stickyRowsChanged=!0),stickyRowsChanged}},__name(_a169,"StickyRowFeature"),_a169);__decorateClass([Autowired("rowModel")],StickyRowFeature.prototype,"rowModel",2);__decorateClass([Autowired("rowRenderer")],StickyRowFeature.prototype,"rowRenderer",2);__decorateClass([Autowired("ctrlsService")],StickyRowFeature.prototype,"ctrlsService",2);__decorateClass([PostConstruct],StickyRowFeature.prototype,"postConstruct",1);var _a170,RowRenderer=(_a170=class extends BeanStub{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const onRangeSelectionChanged=__name(()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onRangeSelectionChanged())},"onRangeSelectionChanged"),onColumnMovedPinnedVisible=__name(()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.updateRangeBordersIfRangeCount())},"onColumnMovedPinnedVisible"),addRangeSelectionListeners=__name(()=>{this.eventService.addEventListener(Events.EVENT_RANGE_SELECTION_CHANGED,onRangeSelectionChanged),this.eventService.addEventListener(Events.EVENT_COLUMN_MOVED,onColumnMovedPinnedVisible),this.eventService.addEventListener(Events.EVENT_COLUMN_PINNED,onColumnMovedPinnedVisible),this.eventService.addEventListener(Events.EVENT_COLUMN_VISIBLE,onColumnMovedPinnedVisible)},"addRangeSelectionListeners"),removeRangeSelectionListeners=__name(()=>{this.eventService.removeEventListener(Events.EVENT_RANGE_SELECTION_CHANGED,onRangeSelectionChanged),this.eventService.removeEventListener(Events.EVENT_COLUMN_MOVED,onColumnMovedPinnedVisible),this.eventService.removeEventListener(Events.EVENT_COLUMN_PINNED,onColumnMovedPinnedVisible),this.eventService.removeEventListener(Events.EVENT_COLUMN_VISIBLE,onColumnMovedPinnedVisible)},"removeRangeSelectionListeners");this.addDestroyFunc(()=>removeRangeSelectionListeners()),this.addManagedPropertyListener("enableRangeSelection",params=>{params.currentValue?addRangeSelectionListeners():removeRangeSelectionListeners()}),this.gridOptionsService.get("enableRangeSelection")&&addRangeSelectionListeners()}}postConstruct(){this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListeners(["suppressCellFocus","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.gridOptionsService.isGroupRowsSticky()){const rowModelType=this.rowModel.getType();(rowModelType==="clientSide"||rowModelType==="serverSide")&&(this.stickyRowFeature=this.createManagedBean(new StickyRowFeature(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gridOptionsService.get("keepDetailRows")){const countProp=this.getKeepDetailRowsCount(),count=countProp??3;this.cachedRowCtrls=new RowCtrlCache(count)}}getKeepDetailRowsCount(){return this.gridOptionsService.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]}updateAllRowCtrls(){const liveList=getAllValuesInObject(this.rowCtrlsByRowIndex),zombieList=getAllValuesInObject(this.zombieRowCtrls),cachedList=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];zombieList.length>0||cachedList.length>0?this.allRowCtrls=[...liveList,...zombieList,...cachedList]:this.allRowCtrls=liveList}onCellFocusChanged(event){this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onCellFocused(event)),this.getFullWidthRowCtrls().forEach(rowCtrl=>rowCtrl.onFullWidthRowFocused(event))}registerCellEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_CELL_FOCUSED,event=>{this.onCellFocusChanged(event)}),this.addManagedListener(this.eventService,Events.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,Events.EVENT_FLASH_CELLS,event=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onFlashCells(event))}),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onColumnHover())}),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onLeftChanged())}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(func=>func()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.columnModel.getAllGridColumns().forEach(col=>{const forEachCellWithThisCol=__name(callback=>{this.getAllCellCtrls().forEach(cellCtrl=>{cellCtrl.getColumn()===col&&callback(cellCtrl)})},"forEachCellWithThisCol"),leftChangedListener=__name(()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onLeftChanged())},"leftChangedListener"),widthChangedListener=__name(()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onWidthChanged())},"widthChangedListener"),firstRightPinnedChangedListener=__name(()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onFirstRightPinnedChanged())},"firstRightPinnedChangedListener"),lastLeftPinnedChangedListener=__name(()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onLastLeftPinnedChanged())},"lastLeftPinnedChangedListener"),colDefChangedListener=__name(()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onColDefChanged())},"colDefChangedListener");col.addEventListener("leftChanged",leftChangedListener),col.addEventListener("widthChanged",widthChangedListener),col.addEventListener("firstRightPinnedChanged",firstRightPinnedChangedListener),col.addEventListener("lastLeftPinnedChanged",lastLeftPinnedChangedListener),col.addEventListener("colDefChanged",colDefChangedListener),this.destroyFuncsForColumnListeners.push(()=>{col.removeEventListener("leftChanged",leftChangedListener),col.removeEventListener("widthChanged",widthChangedListener),col.removeEventListener("firstRightPinnedChanged",firstRightPinnedChangedListener),col.removeEventListener("lastLeftPinnedChanged",lastLeftPinnedChangedListener),col.removeEventListener("colDefChanged",colDefChangedListener)})})}onDomLayoutChanged(){const printLayout=this.gridOptionsService.isDomLayout("print"),embedFullWidthRows=printLayout||this.gridOptionsService.get("embedFullWidthRows"),destroyRows=embedFullWidthRows!==this.embedFullWidthRows||this.printLayout!==printLayout;this.printLayout=printLayout,this.embedFullWidthRows=embedFullWidthRows,destroyRows&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const rowIndexesToRemove=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(rowIndexesToRemove)}onPageLoaded(event){const params={recycleRows:event.keepRenderedRows,animate:event.animate,newData:event.newData,newPage:event.newPage,onlyBody:!0};this.redrawAfterModelUpdate(params)}getAllCellsForColumn(column){const res=[];return this.getAllRowCtrls().forEach(rowCtrl=>{const eCell=rowCtrl.getCellElement(column);eCell&&res.push(eCell)}),res}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(rowComps,rowNodes){rowComps.forEach(row=>{row.destroyFirstPass(),row.destroySecondPass()}),rowComps.length=0,rowNodes&&rowNodes.forEach(rowNode=>{const rowCtrl=new RowCtrl(rowNode,this.beans,!1,!1,this.printLayout);rowComps.push(rowCtrl)})}onPinnedRowDataChanged(){const params={recycleRows:!0};this.redrawAfterModelUpdate(params)}redrawRow(rowNode,suppressEvent=!1){var _a273;if(rowNode.sticky)this.stickyRowFeature.refreshStickyNode(rowNode);else if((_a273=this.cachedRowCtrls)!=null&&_a273.has(rowNode)){this.cachedRowCtrls.removeRow(rowNode);return}else{const destroyAndRecreateCtrl=__name(dataStruct=>{const ctrl=dataStruct[rowNode.rowIndex];ctrl&&ctrl.getRowNode()===rowNode&&(ctrl.destroyFirstPass(),ctrl.destroySecondPass(),dataStruct[rowNode.rowIndex]=this.createRowCon(rowNode,!1,!1))},"destroyAndRecreateCtrl");switch(rowNode.rowPinned){case"top":destroyAndRecreateCtrl(this.topRowCtrls);break;case"bottom":destroyAndRecreateCtrl(this.bottomRowCtrls);break;default:destroyAndRecreateCtrl(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}suppressEvent||this.dispatchDisplayedRowsChanged(!1)}redrawRows(rowNodes){if(rowNodes!=null){rowNodes==null||rowNodes.forEach(node=>this.redrawRow(node,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(params){const focusedCell=params!=null&&params.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(focusedCell==null)return null;const activeElement=this.gridOptionsService.getDocument().activeElement,cellDomData=this.gridOptionsService.getDomData(activeElement,CellCtrl.DOM_DATA_KEY_CELL_CTRL),rowDomData=this.gridOptionsService.getDomData(activeElement,RowCtrl.DOM_DATA_KEY_ROW_CTRL);return cellDomData||rowDomData?focusedCell:null}redrawAfterModelUpdate(params={}){this.getLockOnRefresh();const focusedCell=this.getCellToRestoreFocusToAfterRefresh(params);this.updateContainerHeights(),this.scrollToTopIfNewData(params);const recycleRows=!params.domLayoutChanged&&!!params.recycleRows,animate=params.animate&&this.gridOptionsService.isAnimateRows(),rowsToRecycle=recycleRows?this.getRowsToRecycle():null;recycleRows||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(rowsToRecycle,animate),this.gridBodyCtrl.updateRowCount(),params.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),focusedCell!=null&&this.restoreFocusedCell(focusedCell),this.releaseLockOnRefresh()}scrollToTopIfNewData(params){const scrollToTop=params.newData||params.newPage,suppressScrollToTop=this.gridOptionsService.get("suppressScrollOnNewData");scrollToTop&&!suppressScrollToTop&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout){this.rowContainerHeightService.setModelHeight(null);return}let containerHeight=this.paginationProxy.getCurrentPageHeight();containerHeight===0&&(containerHeight=1),this.rowContainerHeightService.setModelHeight(containerHeight)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(cellPosition){cellPosition&&(this.focusService.setRestoreFocusedCell(cellPosition),this.onCellFocusChanged(this.beans.gridOptionsService.addGridCommonParams({rowIndex:cellPosition.rowIndex,column:cellPosition.column,rowPinned:cellPosition.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"mock"})))}stopEditing(cancel=!1){this.getAllRowCtrls().forEach(rowCtrl=>{rowCtrl.stopEditing(cancel)})}getAllCellCtrls(){const res=[],rowCtrls=this.getAllRowCtrls(),rowCtrlsLength=rowCtrls.length;for(let i=0;i<rowCtrlsLength;i++){const cellCtrls=rowCtrls[i].getAllCellCtrls(),cellCtrlsLength=cellCtrls.length;for(let j=0;j<cellCtrlsLength;j++)res.push(cellCtrls[j])}return res}getAllRowCtrls(){const stickyRowCtrls=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],res=[...this.topRowCtrls,...this.bottomRowCtrls,...stickyRowCtrls];for(const key of Object.keys(this.rowCtrlsByRowIndex))res.push(this.rowCtrlsByRowIndex[key]);return res}addRenderedRowListener(eventName,rowIndex,callback){const rowComp=this.rowCtrlsByRowIndex[rowIndex];rowComp&&rowComp.addEventListener(eventName,callback)}flashCells(params={}){this.getCellCtrls(params.rowNodes,params.columns).forEach(cellCtrl=>cellCtrl.flashCell(params))}refreshCells(params={}){const refreshCellParams={forceRefresh:params.force,newData:!1,suppressFlash:params.suppressFlash};this.getCellCtrls(params.rowNodes,params.columns).forEach(cellCtrl=>cellCtrl.refreshOrDestroyCell(refreshCellParams)),params.rowNodes&&(this.getRowCtrls(params.rowNodes).forEach(rowCtrl=>{if(!rowCtrl.isFullWidth())return;rowCtrl.refreshFullWidth()||this.redrawRow(rowCtrl.getRowNode(),!0)}),this.dispatchDisplayedRowsChanged(!1))}getCellRendererInstances(params){var _a273;const cellRenderers=this.getCellCtrls(params.rowNodes,params.columns).map(cellCtrl=>cellCtrl.getCellRenderer()).filter(renderer=>renderer!=null);if((_a273=params.columns)!=null&&_a273.length)return cellRenderers;const fullWidthRenderers=[],rowIdMap=this.mapRowNodes(params.rowNodes);return this.getAllRowCtrls().forEach(rowCtrl=>{if(rowIdMap&&!this.isRowInMap(rowCtrl.getRowNode(),rowIdMap)||!rowCtrl.isFullWidth())return;const renderers=rowCtrl.getFullWidthCellRenderers();for(let i=0;i<renderers.length;i++){const renderer=renderers[i];renderer!=null&&fullWidthRenderers.push(renderer)}}),[...fullWidthRenderers,...cellRenderers]}getCellEditorInstances(params){const res=[];return this.getCellCtrls(params.rowNodes,params.columns).forEach(cellCtrl=>{const cellEditor=cellCtrl.getCellEditor();cellEditor&&res.push(cellEditor)}),res}getEditingCells(){const res=[];return this.getAllCellCtrls().forEach(cellCtrl=>{if(cellCtrl.isEditing()){const cellPosition=cellCtrl.getCellPosition();res.push(cellPosition)}}),res}mapRowNodes(rowNodes){if(!rowNodes)return;const res={top:{},bottom:{},normal:{}};return rowNodes.forEach(rowNode=>{const id=rowNode.id;rowNode.rowPinned==="top"?res.top[id]=rowNode:rowNode.rowPinned==="bottom"?res.bottom[id]=rowNode:res.normal[id]=rowNode}),res}isRowInMap(rowNode,rowIdsMap){const id=rowNode.id,floating=rowNode.rowPinned;return floating==="bottom"?rowIdsMap.bottom[id]!=null:floating==="top"?rowIdsMap.top[id]!=null:rowIdsMap.normal[id]!=null}getRowCtrls(rowNodes){const rowIdsMap=this.mapRowNodes(rowNodes),allRowCtrls=this.getAllRowCtrls();return!rowNodes||!rowIdsMap?allRowCtrls:allRowCtrls.filter(rowCtrl=>{const rowNode=rowCtrl.getRowNode();return this.isRowInMap(rowNode,rowIdsMap)})}getCellCtrls(rowNodes,columns){let colIdsMap;exists(columns)&&(colIdsMap={},columns.forEach(colKey=>{const column=this.columnModel.getGridColumn(colKey);exists(column)&&(colIdsMap[column.getId()]=!0)}));const res=[];return this.getRowCtrls(rowNodes).forEach(rowCtrl=>{rowCtrl.getAllCellCtrls().forEach(cellCtrl=>{const colId=cellCtrl.getColumn().getId();colIdsMap&&!colIdsMap[colId]||res.push(cellCtrl)})}),res}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const rowIndexesToRemove=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(rowIndexesToRemove)}getRowsToRecycle(){const stubNodeIndexes=[];iterateObject(this.rowCtrlsByRowIndex,(index,rowComp)=>{rowComp.getRowNode().id==null&&stubNodeIndexes.push(index)}),this.removeRowCtrls(stubNodeIndexes);const ctrlsByIdMap={};return iterateObject(this.rowCtrlsByRowIndex,(index,rowComp)=>{const rowNode=rowComp.getRowNode();ctrlsByIdMap[rowNode.id]=rowComp}),this.rowCtrlsByRowIndex={},ctrlsByIdMap}removeRowCtrls(rowsToRemove,suppressAnimation=!1){rowsToRemove.forEach(indexToRemove=>{const rowCtrl=this.rowCtrlsByRowIndex[indexToRemove];rowCtrl&&(rowCtrl.destroyFirstPass(suppressAnimation),rowCtrl.destroySecondPass()),delete this.rowCtrlsByRowIndex[indexToRemove]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(params={}){const{afterScroll}=params;let cellFocused;this.stickyRowFeature&&browserSupportsPreventScroll()&&(cellFocused=this.getCellToRestoreFocusToAfterRefresh()||void 0);const oldFirstRow=this.firstRenderedRow,oldLastRow=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let hasStickyRowChanges=!1;this.stickyRowFeature&&(hasStickyRowChanges=this.stickyRowFeature.checkStickyRows());const rangeChanged=this.firstRenderedRow!==oldFirstRow||this.lastRenderedRow!==oldLastRow;if(!(afterScroll&&!hasStickyRowChanges&&!rangeChanged)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,afterScroll),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(afterScroll&&!hasStickyRowChanges),cellFocused!=null)){const newFocusedCell=this.getCellToRestoreFocusToAfterRefresh();cellFocused!=null&&newFocusedCell==null&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(cellFocused))}}removeRowCompsNotToDraw(indexesToDraw,suppressAnimation){const indexesToDrawMap={};indexesToDraw.forEach(index=>indexesToDrawMap[index]=!0);const indexesNotToDraw=Object.keys(this.rowCtrlsByRowIndex).filter(index=>!indexesToDrawMap[index]);this.removeRowCtrls(indexesNotToDraw,suppressAnimation)}calculateIndexesToDraw(rowsToRecycle){let indexesToDraw=createArrayOfNumbers(this.firstRenderedRow,this.lastRenderedRow);const checkRowToDraw=__name((indexStr,rowComp)=>{const index=rowComp.getRowNode().rowIndex;index!=null&&(index<this.firstRenderedRow||index>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(rowComp)&&indexesToDraw.push(index)},"checkRowToDraw");iterateObject(this.rowCtrlsByRowIndex,checkRowToDraw),iterateObject(rowsToRecycle,checkRowToDraw),indexesToDraw.sort((a,b)=>a-b);const ret=[];for(let i=0;i<indexesToDraw.length;i++){const currRow=indexesToDraw[i],rowNode=this.paginationProxy.getRow(currRow);rowNode&&!rowNode.sticky&&ret.push(currRow)}return ret}recycleRows(rowsToRecycle,animate=!1,afterScroll=!1){const indexesToDraw=this.calculateIndexesToDraw(rowsToRecycle);(this.printLayout||afterScroll)&&(animate=!1),this.removeRowCompsNotToDraw(indexesToDraw,!animate),indexesToDraw.forEach(rowIndex=>{this.createOrUpdateRowCtrl(rowIndex,rowsToRecycle,animate,afterScroll)}),rowsToRecycle&&(afterScroll&&!this.gridOptionsService.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(rowsToRecycle,animate),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(rowsToRecycle,animate)),this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(afterScroll=!1){const event={type:Events.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll};this.eventService.dispatchEvent(event)}onDisplayedColumnsChanged(){const pinningLeft=this.columnModel.isPinningLeft(),pinningRight=this.columnModel.isPinningRight();(this.pinningLeft!==pinningLeft||pinningRight!==this.pinningRight)&&(this.pinningLeft=pinningLeft,this.pinningRight=pinningRight,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const rowsToRemove=[];this.getFullWidthRowCtrls().forEach(fullWidthCtrl=>{const rowIndex=fullWidthCtrl.getRowNode().rowIndex;rowsToRemove.push(rowIndex.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(rowsToRemove),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(rowNodes){const rowNodesMap=this.mapRowNodes(rowNodes);return this.getAllRowCtrls().filter(rowCtrl=>{if(!rowCtrl.isFullWidth())return!1;const rowNode=rowCtrl.getRowNode();return!(rowNodesMap!=null&&!this.isRowInMap(rowNode,rowNodesMap))})}createOrUpdateRowCtrl(rowIndex,rowsToRecycle,animate,afterScroll){let rowNode,rowCtrl=this.rowCtrlsByRowIndex[rowIndex];if(rowCtrl||(rowNode=this.paginationProxy.getRow(rowIndex),exists(rowNode)&&exists(rowsToRecycle)&&rowsToRecycle[rowNode.id]&&rowNode.alreadyRendered&&(rowCtrl=rowsToRecycle[rowNode.id],rowsToRecycle[rowNode.id]=null)),!rowCtrl)if(rowNode||(rowNode=this.paginationProxy.getRow(rowIndex)),exists(rowNode))rowCtrl=this.createRowCon(rowNode,animate,afterScroll);else return;return rowNode&&(rowNode.alreadyRendered=!0),this.rowCtrlsByRowIndex[rowIndex]=rowCtrl,rowCtrl}destroyRowCtrls(rowCtrlsMap,animate){const executeInAWhileFuncs=[];iterateObject(rowCtrlsMap,(nodeId,rowCtrl)=>{if(rowCtrl){if(this.cachedRowCtrls&&rowCtrl.isCacheable()){this.cachedRowCtrls.addRow(rowCtrl);return}rowCtrl.destroyFirstPass(!animate),animate?(this.zombieRowCtrls[rowCtrl.getInstanceId()]=rowCtrl,executeInAWhileFuncs.push(()=>{rowCtrl.destroySecondPass(),delete this.zombieRowCtrls[rowCtrl.getInstanceId()]})):rowCtrl.destroySecondPass()}}),animate&&(executeInAWhileFuncs.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),executeInAWhile(executeInAWhileFuncs))}getRowBuffer(){return this.gridOptionsService.get("rowBuffer")}getRowBufferInPixels(){const rowsToBuffer=this.getRowBuffer(),defaultRowHeight=this.gridOptionsService.getRowHeightAsNumber();return rowsToBuffer*defaultRowHeight}workOutFirstAndLastRowsToRender(){this.rowContainerHeightService.updateOffset();let newFirst,newLast;if(!this.paginationProxy.isRowsToRender())newFirst=0,newLast=-1;else if(this.printLayout)this.environment.refreshRowHeightVariable(),newFirst=this.paginationProxy.getPageFirstRow(),newLast=this.paginationProxy.getPageLastRow();else{const bufferPixels=this.getRowBufferInPixels(),gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),suppressRowVirtualisation=this.gridOptionsService.get("suppressRowVirtualisation");let rowHeightsChanged=!1,firstPixel,lastPixel;do{const paginationOffset=this.paginationProxy.getPixelOffset(),{pageFirstPixel,pageLastPixel}=this.paginationProxy.getCurrentPagePixelRange(),divStretchOffset=this.rowContainerHeightService.getDivStretchOffset(),bodyVRange=gridBodyCtrl.getScrollFeature().getVScrollPosition(),bodyTopPixel=bodyVRange.top,bodyBottomPixel=bodyVRange.bottom;suppressRowVirtualisation?(firstPixel=pageFirstPixel+divStretchOffset,lastPixel=pageLastPixel+divStretchOffset):(firstPixel=Math.max(bodyTopPixel+paginationOffset-bufferPixels,pageFirstPixel)+divStretchOffset,lastPixel=Math.min(bodyBottomPixel+paginationOffset+bufferPixels,pageLastPixel)+divStretchOffset),this.firstVisibleVPixel=Math.max(bodyTopPixel+paginationOffset,pageFirstPixel)+divStretchOffset,rowHeightsChanged=this.ensureAllRowsInRangeHaveHeightsCalculated(firstPixel,lastPixel)}while(rowHeightsChanged);let firstRowIndex=this.paginationProxy.getRowIndexAtPixel(firstPixel),lastRowIndex=this.paginationProxy.getRowIndexAtPixel(lastPixel);const pageFirstRow=this.paginationProxy.getPageFirstRow(),pageLastRow=this.paginationProxy.getPageLastRow();firstRowIndex<pageFirstRow&&(firstRowIndex=pageFirstRow),lastRowIndex>pageLastRow&&(lastRowIndex=pageLastRow),newFirst=firstRowIndex,newLast=lastRowIndex}const rowLayoutNormal=this.gridOptionsService.isDomLayout("normal"),suppressRowCountRestriction=this.gridOptionsService.get("suppressMaxRenderedRowRestriction"),rowBufferMaxSize=Math.max(this.getRowBuffer(),500);rowLayoutNormal&&!suppressRowCountRestriction&&newLast-newFirst>rowBufferMaxSize&&(newLast=newFirst+rowBufferMaxSize);const firstDiffers=newFirst!==this.firstRenderedRow,lastDiffers=newLast!==this.lastRenderedRow;if(firstDiffers||lastDiffers){this.firstRenderedRow=newFirst,this.lastRenderedRow=newLast;const event={type:Events.EVENT_VIEWPORT_CHANGED,firstRow:newFirst,lastRow:newLast};this.eventService.dispatchEvent(event)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const event={type:Events.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(event)})}ensureAllRowsInRangeHaveHeightsCalculated(topPixel,bottomPixel){const res=this.paginationProxy.ensureRowHeightsValid(topPixel,bottomPixel,-1,-1);return res&&this.updateContainerHeights(),res}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(rowComp){const rowNode=rowComp.getRowNode(),rowHasFocus=this.focusService.isRowNodeFocused(rowNode),rowIsEditing=rowComp.isEditing(),rowIsDetail=rowNode.detail;return rowHasFocus||rowIsEditing||rowIsDetail?!!this.paginationProxy.isRowPresent(rowNode):!1}createRowCon(rowNode,animate,afterScroll){const rowCtrlFromCache=this.cachedRowCtrls?this.cachedRowCtrls.getRow(rowNode):null;if(rowCtrlFromCache)return rowCtrlFromCache;const suppressAnimationFrame=this.gridOptionsService.get("suppressAnimationFrame"),useAnimationFrameForCreate=afterScroll&&!suppressAnimationFrame&&!this.printLayout;return new RowCtrl(rowNode,this.beans,animate,useAnimationFrameForCreate,this.printLayout)}getRenderedNodes(){const renderedRows=this.rowCtrlsByRowIndex;return Object.keys(renderedRows).map(key=>renderedRows[key].getRowNode())}getRowByPosition(rowPosition){let rowCtrl;const{rowIndex}=rowPosition;switch(rowPosition.rowPinned){case"top":rowCtrl=this.topRowCtrls[rowIndex];break;case"bottom":rowCtrl=this.bottomRowCtrls[rowIndex];break;default:rowCtrl=this.rowCtrlsByRowIndex[rowIndex],rowCtrl||(rowCtrl=this.getStickyTopRowCtrls().find(ctrl=>ctrl.getRowNode().rowIndex===rowIndex)||null);break}return rowCtrl}getRowNode(gridRow){switch(gridRow.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];default:return this.rowModel.getRow(gridRow.rowIndex)}}isRangeInRenderedViewport(startIndex,endIndex){if(startIndex==null||endIndex==null)return!1;const blockAfterViewport=startIndex>this.lastRenderedRow;return!(endIndex<this.firstRenderedRow)&&!blockAfterViewport}},__name(_a170,"RowRenderer"),_a170);__decorateClass([Autowired("animationFrameService")],RowRenderer.prototype,"animationFrameService",2);__decorateClass([Autowired("paginationProxy")],RowRenderer.prototype,"paginationProxy",2);__decorateClass([Autowired("columnModel")],RowRenderer.prototype,"columnModel",2);__decorateClass([Autowired("pinnedRowModel")],RowRenderer.prototype,"pinnedRowModel",2);__decorateClass([Autowired("rowModel")],RowRenderer.prototype,"rowModel",2);__decorateClass([Autowired("focusService")],RowRenderer.prototype,"focusService",2);__decorateClass([Autowired("beans")],RowRenderer.prototype,"beans",2);__decorateClass([Autowired("rowContainerHeightService")],RowRenderer.prototype,"rowContainerHeightService",2);__decorateClass([Autowired("ctrlsService")],RowRenderer.prototype,"ctrlsService",2);__decorateClass([PostConstruct],RowRenderer.prototype,"postConstruct",1);RowRenderer=__decorateClass([Bean("rowRenderer")],RowRenderer);var _a171,RowCtrlCache=(_a171=class{constructor(maxCount){this.entriesMap={},this.entriesList=[],this.maxCount=maxCount}addRow(rowCtrl){if(this.entriesMap[rowCtrl.getRowNode().id]=rowCtrl,this.entriesList.push(rowCtrl),rowCtrl.setCached(!0),this.entriesList.length>this.maxCount){const rowCtrlToDestroy=this.entriesList[0];rowCtrlToDestroy.destroyFirstPass(),rowCtrlToDestroy.destroySecondPass(),this.removeFromCache(rowCtrlToDestroy)}}getRow(rowNode){if(rowNode==null||rowNode.id==null)return null;const res=this.entriesMap[rowNode.id];return res?(this.removeFromCache(res),res.setCached(!1),res.getRowNode()!=rowNode?null:res):null}has(rowNode){return this.entriesMap[rowNode.id]!=null}removeRow(rowNode){const rowNodeId=rowNode.id,ctrl=this.entriesMap[rowNodeId];delete this.entriesMap[rowNodeId],removeFromArray(this.entriesList,ctrl)}removeFromCache(rowCtrl){const rowNodeId=rowCtrl.getRowNode().id;delete this.entriesMap[rowNodeId],removeFromArray(this.entriesList,rowCtrl)}getEntries(){return this.entriesList}},__name(_a171,"RowCtrlCache"),_a171),_a172,ValueFormatterService=(_a172=class extends BeanStub{formatValue(column,node,value,suppliedFormatter,useFormatterFromColumn=!0){let result=null,formatter;const colDef=column.getColDef();if(suppliedFormatter?formatter=suppliedFormatter:useFormatterFromColumn&&(formatter=colDef.valueFormatter),formatter){const params=this.gridOptionsService.addGridCommonParams({value,node,data:node?node.data:null,colDef,column});typeof formatter=="function"?result=formatter(params):result=this.expressionService.evaluate(formatter,params)}else if(colDef.refData)return colDef.refData[value]||"";return result==null&&Array.isArray(value)&&(result=value.join(", ")),result}},__name(_a172,"ValueFormatterService"),_a172);__decorateClass([Autowired("expressionService")],ValueFormatterService.prototype,"expressionService",2);ValueFormatterService=__decorateClass([Bean("valueFormatterService")],ValueFormatterService);var _a173,PinnedRowModel=(_a173=class extends BeanStub{init(){this.setPinnedTopRowData(),this.setPinnedBottomRowData(),this.addManagedPropertyListener("pinnedTopRowData",()=>this.setPinnedTopRowData()),this.addManagedPropertyListener("pinnedBottomRowData",()=>this.setPinnedBottomRowData())}isEmpty(floating){const rows=floating==="top"?this.pinnedTopRows:this.pinnedBottomRows;return missingOrEmpty(rows)}isRowsToRender(floating){return!this.isEmpty(floating)}getRowAtPixel(pixel,floating){const rows=floating==="top"?this.pinnedTopRows:this.pinnedBottomRows;if(missingOrEmpty(rows))return 0;for(let i=0;i<rows.length;i++){const rowNode=rows[i];if(rowNode.rowTop+rowNode.rowHeight-1>=pixel)return i}return rows.length-1}setPinnedTopRowData(){const rowData=this.gridOptionsService.get("pinnedTopRowData");this.pinnedTopRows=this.createNodesFromData(rowData,!0);const event={type:Events.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(event)}setPinnedBottomRowData(){const rowData=this.gridOptionsService.get("pinnedBottomRowData");this.pinnedBottomRows=this.createNodesFromData(rowData,!1);const event={type:Events.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(event)}createNodesFromData(allData,isTop){const rowNodes=[];if(allData){let nextRowTop=0;allData.forEach((dataItem,index)=>{const rowNode=new RowNode(this.beans);rowNode.data=dataItem;const idPrefix=isTop?RowNode.ID_PREFIX_TOP_PINNED:RowNode.ID_PREFIX_BOTTOM_PINNED;rowNode.id=idPrefix+index,rowNode.rowPinned=isTop?"top":"bottom",rowNode.setRowTop(nextRowTop),rowNode.setRowHeight(this.gridOptionsService.getRowHeightForNode(rowNode).height),rowNode.setRowIndex(index),nextRowTop+=rowNode.rowHeight,rowNodes.push(rowNode)})}return rowNodes}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(index){return this.pinnedTopRows[index]}getPinnedBottomRow(index){return this.pinnedBottomRows[index]}forEachPinnedTopRow(callback){missingOrEmpty(this.pinnedTopRows)||this.pinnedTopRows.forEach(callback)}forEachPinnedBottomRow(callback){missingOrEmpty(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(callback)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(rowNodes){if(!rowNodes||rowNodes.length===0)return 0;const lastNode=last(rowNodes);return lastNode.rowTop+lastNode.rowHeight}},__name(_a173,"PinnedRowModel"),_a173);__decorateClass([Autowired("beans")],PinnedRowModel.prototype,"beans",2);__decorateClass([PostConstruct],PinnedRowModel.prototype,"init",1);PinnedRowModel=__decorateClass([Bean("pinnedRowModel")],PinnedRowModel);var _a174,ChangedPath=(_a174=class{constructor(keepingColumns,rootNode){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=keepingColumns,this.pathRoot={rowNode:rootNode,children:null},this.mapToItems[rootNode.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(pathItem,callback){if(pathItem.children)for(let i=0;i<pathItem.children.length;i++)this.depthFirstSearchChangedPath(pathItem.children[i],callback);callback(pathItem.rowNode)}depthFirstSearchEverything(rowNode,callback,traverseEverything){if(rowNode.childrenAfterGroup)for(let i=0;i<rowNode.childrenAfterGroup.length;i++){const childNode=rowNode.childrenAfterGroup[i];childNode.childrenAfterGroup?this.depthFirstSearchEverything(rowNode.childrenAfterGroup[i],callback,traverseEverything):traverseEverything&&callback(childNode)}callback(rowNode)}forEachChangedNodeDepthFirst(callback,traverseLeafNodes=!1,includeUnchangedNodes=!1){this.active&&!includeUnchangedNodes?this.depthFirstSearchChangedPath(this.pathRoot,callback):this.depthFirstSearchEverything(this.pathRoot.rowNode,callback,traverseLeafNodes)}executeFromRootNode(callback){callback(this.pathRoot.rowNode)}createPathItems(rowNode){let pointer=rowNode,newEntryCount=0;for(;!this.mapToItems[pointer.id];){const newEntry={rowNode:pointer,children:null};this.mapToItems[pointer.id]=newEntry,newEntryCount++,pointer=pointer.parent}return newEntryCount}populateColumnsMap(rowNode,columns){if(!this.keepingColumns||!columns)return;let pointer=rowNode;for(;pointer;)this.nodeIdsToColumns[pointer.id]||(this.nodeIdsToColumns[pointer.id]={}),columns.forEach(col=>this.nodeIdsToColumns[pointer.id][col.getId()]=!0),pointer=pointer.parent}linkPathItems(rowNode,newEntryCount){let pointer=rowNode;for(let i=0;i<newEntryCount;i++){const thisItem=this.mapToItems[pointer.id],parentItem=this.mapToItems[pointer.parent.id];parentItem.children||(parentItem.children=[]),parentItem.children.push(thisItem),pointer=pointer.parent}}addParentNode(rowNode,columns){if(!rowNode||rowNode.isRowPinned())return;const newEntryCount=this.createPathItems(rowNode);this.linkPathItems(rowNode,newEntryCount),this.populateColumnsMap(rowNode,columns)}canSkip(rowNode){return this.active&&!this.mapToItems[rowNode.id]}getValueColumnsForNode(rowNode,valueColumns){if(!this.keepingColumns)return valueColumns;const colsForThisNode=this.nodeIdsToColumns[rowNode.id];return valueColumns.filter(col=>colsForThisNode[col.getId()])}getNotValueColumnsForNode(rowNode,valueColumns){if(!this.keepingColumns)return null;const colsForThisNode=this.nodeIdsToColumns[rowNode.id];return valueColumns.filter(col=>!colsForThisNode[col.getId()])}},__name(_a174,"ChangedPath"),_a174),_a175,_RowNodeBlock=(_a175=class extends BeanStub{constructor(id){super(),this.state=_a175.STATE_WAITING_TO_LOAD,this.version=0,this.id=id}getId(){return this.id}load(){this.state=_a175.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=_a175.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(version){this.isRequestMostRecentAndLive(version)&&(this.state=_a175.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(version,params){this.successCommon(version,params)}pageLoaded(version,rows,lastRow){this.successCommon(version,{rowData:rows,rowCount:lastRow})}isRequestMostRecentAndLive(version){const thisIsMostRecentRequest=version===this.version,weAreNotDestroyed=this.isAlive();return thisIsMostRecentRequest&&weAreNotDestroyed}successCommon(version,params){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(version)&&(this.state=_a175.STATE_LOADED,this.processServerResult(params))}dispatchLoadCompleted(success=!0){const event={type:_a175.EVENT_LOAD_COMPLETE,success,block:this};this.dispatchEvent(event)}},__name(_a175,"_RowNodeBlock"),_a175);_RowNodeBlock.EVENT_LOAD_COMPLETE="loadComplete";_RowNodeBlock.STATE_WAITING_TO_LOAD="needsLoading";_RowNodeBlock.STATE_LOADING="loading";_RowNodeBlock.STATE_LOADED="loaded";_RowNodeBlock.STATE_FAILED="failed";var RowNodeBlock=_RowNodeBlock,_a176,RowNodeBlockLoader=(_a176=class extends BeanStub{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const blockLoadDebounceMillis=this.gridOptionsService.get("blockLoadDebounceMillis");blockLoadDebounceMillis&&blockLoadDebounceMillis>0&&(this.checkBlockToLoadDebounce=_.debounce(this.performCheckBlocksToLoad.bind(this),blockLoadDebounceMillis))}setBeans(loggerFactory){this.logger=loggerFactory.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const res=this.gridOptionsService.get("maxConcurrentDatasourceRequests");if(res==null)return 2;if(!(res<=0))return res}addBlock(block){this.blocks.push(block),block.addEventListener(RowNodeBlock.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(block){_.removeFromArray(this.blocks,block)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:RowNodeBlockLoader.BLOCK_LOADED_EVENT}),this.activeBlockLoadsCount==0&&this.dispatchEvent({type:RowNodeBlockLoader.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){this.logger.log("checkBlockToLoad: max loads exceeded");return}const loadAvailability=this.getAvailableLoadingCount(),blocksToLoad=this.blocks.filter(block=>block.getState()===RowNodeBlock.STATE_WAITING_TO_LOAD).slice(0,loadAvailability);this.registerLoads(blocksToLoad.length),blocksToLoad.forEach(block=>block.load()),this.printCacheStatus()}getBlockState(){if(this.gridOptionsService.isRowModelType("serverSide"))return this.rowModel.getBlockStates();const result={};return this.blocks.forEach(block=>{const{id,state}=block.getBlockStateJson();result[id]=state}),result}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(count){this.activeBlockLoadsCount+=count}getAvailableLoadingCount(){return this.maxConcurrentRequests!==void 0?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}},__name(_a176,"RowNodeBlockLoader"),_a176);RowNodeBlockLoader.BLOCK_LOADED_EVENT="blockLoaded";RowNodeBlockLoader.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished";__decorateClass([Autowired("rowModel")],RowNodeBlockLoader.prototype,"rowModel",2);__decorateClass([PostConstruct],RowNodeBlockLoader.prototype,"postConstruct",1);__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],RowNodeBlockLoader.prototype,"setBeans",1);RowNodeBlockLoader=__decorateClass([Bean("rowNodeBlockLoader")],RowNodeBlockLoader);var _a177,PaginationProxy=(_a177=class extends BeanStub{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gridOptionsService.get("pagination"),this.pageSizeFromGridOptions=this.gridOptionsService.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,Events.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(startPixel,endPixel,startLimitIndex,endLimitIndex){const res=this.rowModel.ensureRowHeightsValid(startPixel,endPixel,this.getPageFirstRow(),this.getPageLastRow());return res&&this.calculatePages(),res}isPaginateChildRows(){return this.gridOptionsService.get("groupRemoveSingleChildren")||this.gridOptionsService.get("groupRemoveLowestSingleChildren")?!0:this.gridOptionsService.get("paginateChildRows")}onModelUpdated(modelUpdatedEvent){this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:modelUpdatedEvent?modelUpdatedEvent.animate:!1,newData:modelUpdatedEvent?modelUpdatedEvent.newData:!1,newPage:modelUpdatedEvent?modelUpdatedEvent.newPage:!1,newPageSize:modelUpdatedEvent?modelUpdatedEvent.newPageSize:!1,keepRenderedRows:modelUpdatedEvent?modelUpdatedEvent.keepRenderedRows:!1};this.eventService.dispatchEvent(paginationChangedEvent)}onPaginationGridOptionChanged(){this.active=this.gridOptionsService.get("pagination"),this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(paginationChangedEvent)}onPageSizeGridOptionChanged(){this.setPageSize(this.gridOptionsService.get("paginationPageSize"),"gridOptions")}goToPage(page){if(!this.active||this.currentPage===page||typeof this.currentPage!="number")return;this.currentPage=page;const event={type:Events.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0,newPageSize:!1};this.onModelUpdated(event)}getPixelOffset(){return this.pixelOffset}getRow(index){return this.rowModel.getRow(index)}getRowNode(id){return this.rowModel.getRowNode(id)}getRowIndexAtPixel(pixel){return this.rowModel.getRowIndexAtPixel(pixel)}getCurrentPageHeight(){return missing(this.topRowBounds)||missing(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){const pageFirstPixel=this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel=this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0;return{pageFirstPixel,pageLastPixel}}isRowPresent(rowNode){return this.rowModel.isRowPresent(rowNode)?rowNode.rowIndex>=this.topDisplayedRowIndex&&rowNode.rowIndex<=this.bottomDisplayedRowIndex:!1}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(callback){return this.rowModel.forEachNode(callback)}forEachNodeOnPage(callback){const firstRow=this.getPageFirstRow(),lastRow=this.getPageLastRow();for(let i=firstRow;i<=lastRow;i++){const node=this.getRow(i);node&&callback(node)}}getType(){return this.rowModel.getType()}getRowBounds(index){const res=this.rowModel.getRowBounds(index);return res.rowIndex=index,res}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(index){return Math.floor(index/this.pageSize)}goToPageWithIndex(index){if(!this.active)return;const pageNumber=this.getPageForIndex(index);this.goToPage(pageNumber)}isRowInPage(row){return this.active?this.getPageForIndex(row.rowIndex)===this.currentPage:!0}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const rowCount=this.rowModel.getRowCount(),lastPage=Math.floor(rowCount/this.pageSize);this.goToPage(lastPage)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(page){this.currentPage=page}get pageSize(){return exists(this.pageSizeAutoCalculated)?this.pageSizeAutoCalculated:exists(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:exists(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:exists(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const oldPageSize=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==oldPageSize&&this.onModelUpdated({type:Events.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!1,newPageSize:!0})}setPageSize(size,source){const currentSize=this.pageSize;switch(source){case"autoCalculated":this.pageSizeAutoCalculated=size;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=size,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=size;break;case"gridOptions":this.pageSizeFromGridOptions=size,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}if(currentSize!==this.pageSize){const event={type:Events.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!1,newPageSize:!0};this.onModelUpdated(event)}}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(exists(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(value){this.pixelOffset!==value&&(this.pixelOffset=value,this.eventService.dispatchEvent({type:Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0){this.setZeroRows();return}const masterLastRowIndex=this.masterRowCount-1;this.totalPages=Math.floor(masterLastRowIndex/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const masterPageStartIndex=this.pageSize*this.currentPage;let masterPageEndIndex=this.pageSize*(this.currentPage+1)-1;if(masterPageEndIndex>masterLastRowIndex&&(masterPageEndIndex=masterLastRowIndex),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(masterPageStartIndex),masterPageEndIndex===masterLastRowIndex)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const firstIndexNotToShow=this.rowModel.getTopLevelRowDisplayedIndex(masterPageEndIndex+1);this.bottomDisplayedRowIndex=firstIndexNotToShow-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),this.masterRowCount===0){this.setZeroRows();return}const maxRowIndex=this.masterRowCount-1;this.totalPages=Math.floor(maxRowIndex/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>maxRowIndex&&(this.bottomDisplayedRowIndex=maxRowIndex)}calculatedPagesNotActive(){this.setPageSize(this.masterRowCount,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}},__name(_a177,"PaginationProxy"),_a177);__decorateClass([Autowired("rowModel")],PaginationProxy.prototype,"rowModel",2);__decorateClass([PostConstruct],PaginationProxy.prototype,"postConstruct",1);PaginationProxy=__decorateClass([Bean("paginationProxy")],PaginationProxy);var _a178,StylingService=(_a178=class extends BeanStub{processAllCellClasses(colDef,params,onApplicableClass,onNotApplicableClass){this.processClassRules(void 0,colDef.cellClassRules,params,onApplicableClass,onNotApplicableClass),this.processStaticCellClasses(colDef,params,onApplicableClass)}processClassRules(previousClassRules,classRules,params,onApplicableClass,onNotApplicableClass){if(classRules==null&&previousClassRules==null)return;const classesToApply={},classesToRemove={},forEachSingleClass=__name((className,callback)=>{className.split(" ").forEach(singleClass=>{singleClass.trim()!=""&&callback(singleClass)})},"forEachSingleClass");if(classRules){const classNames=Object.keys(classRules);for(let i=0;i<classNames.length;i++){const className=classNames[i],rule=classRules[className];let resultOfRule;typeof rule=="string"?resultOfRule=this.expressionService.evaluate(rule,params):typeof rule=="function"&&(resultOfRule=rule(params)),forEachSingleClass(className,singleClass=>{resultOfRule?classesToApply[singleClass]=!0:classesToRemove[singleClass]=!0})}}previousClassRules&&onNotApplicableClass&&Object.keys(previousClassRules).forEach(className=>forEachSingleClass(className,singleClass=>{classesToApply[singleClass]||(classesToRemove[singleClass]=!0)})),onNotApplicableClass&&Object.keys(classesToRemove).forEach(onNotApplicableClass),Object.keys(classesToApply).forEach(onApplicableClass)}getStaticCellClasses(colDef,params){const{cellClass}=colDef;if(!cellClass)return[];let classOrClasses;return typeof cellClass=="function"?classOrClasses=cellClass(params):classOrClasses=cellClass,typeof classOrClasses=="string"&&(classOrClasses=[classOrClasses]),classOrClasses||[]}processStaticCellClasses(colDef,params,onApplicableClass){this.getStaticCellClasses(colDef,params).forEach(cssClassItem=>{onApplicableClass(cssClassItem)})}},__name(_a178,"StylingService"),_a178);__decorateClass([Autowired("expressionService")],StylingService.prototype,"expressionService",2);StylingService=__decorateClass([Bean("stylingService")],StylingService);var _a179,AgToggleButton=(_a179=class extends AgCheckbox{constructor(config){super(config,"ag-toggle-button")}setValue(value,silent){return super.setValue(value,silent),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}},__name(_a179,"AgToggleButton"),_a179),_a180,AgInputTextArea=(_a180=class extends AgAbstractInputField{constructor(config){super(config,"ag-text-area",null,"textarea")}setValue(value,silent){const ret=super.setValue(value,silent);return this.eInput.value=value,ret}setCols(cols){return this.eInput.cols=cols,this}setRows(rows){return this.eInput.rows=rows,this}},__name(_a180,"AgInputTextArea"),_a180),_a181,AgInputDateField=(_a181=class extends AgInputTextField{constructor(config){super(config,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const usingSafari=isBrowserSafari();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||usingSafari||this.eInput.focus()}),this.eInput.step="any"}onWheel(e){document.activeElement===this.eInput&&e.preventDefault()}setMin(minDate){var _a273;const min=minDate instanceof Date?(_a273=serialiseDate(minDate??null,!1))!=null?_a273:void 0:minDate;return this.min===min?this:(this.min=min,addOrRemoveAttribute(this.eInput,"min",min),this)}setMax(maxDate){var _a273;const max=maxDate instanceof Date?(_a273=serialiseDate(maxDate??null,!1))!=null?_a273:void 0:maxDate;return this.max===max?this:(this.max=max,addOrRemoveAttribute(this.eInput,"max",max),this)}setStep(step){return this.step===step?this:(this.step=step,addOrRemoveAttribute(this.eInput,"step",step),this)}getDate(){var _a273;if(this.eInput.validity.valid)return(_a273=parseDateTimeFromString(this.getValue()))!=null?_a273:void 0}setDate(date,silent){this.setValue(serialiseDate(date??null,!1),silent)}},__name(_a181,"AgInputDateField"),_a181),_a182,AgInputRange=(_a182=class extends AgAbstractInputField{constructor(config){super(config,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min,max,step}=this.config;min!=null&&this.setMinValue(min),max!=null&&this.setMaxValue(max),this.setStep(step||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>{const value=e.target.value;this.setValue(value)})}setMinValue(value){return this.min=value,this.eInput.setAttribute("min",value.toString()),this}setMaxValue(value){return this.max=value,this.eInput.setAttribute("max",value.toString()),this}setStep(value){return this.eInput.setAttribute("step",value.toString()),this}setValue(value,silent){this.min!=null&&(value=Math.max(parseFloat(value),this.min).toString()),this.max!=null&&(value=Math.min(parseFloat(value),this.max).toString());const ret=super.setValue(value,silent);return this.eInput.value=value,ret}},__name(_a182,"AgInputRange"),_a182),_a183,RichSelectRow=(_a183=class extends Component{constructor(params,wrapperEl){super('<div class="ag-rich-select-row" role="presentation"></div>'),this.params=params,this.wrapperEl=wrapperEl}postConstruct(){this.addManagedListener(this.getGui(),"click",this.onClick.bind(this))}setState(value){let formattedValue="";this.params.valueFormatter&&(formattedValue=this.params.valueFormatter(value)),this.populateWithRenderer(value,formattedValue)||this.populateWithoutRenderer(value,formattedValue),this.value=value}highlightString(matchString){const{parsedValue}=this;if(this.params.cellRenderer||!exists(parsedValue))return;let hasMatch=exists(matchString);if(hasMatch){const index=parsedValue==null?void 0:parsedValue.toLocaleLowerCase().indexOf(matchString.toLocaleLowerCase());if(index>=0){const highlightEndIndex=index+matchString.length,startPart=escapeString(parsedValue.slice(0,index),!0),highlightedPart=escapeString(parsedValue.slice(index,highlightEndIndex),!0),endPart=escapeString(parsedValue.slice(highlightEndIndex));this.renderValueWithoutRenderer(`${startPart}<span class="ag-rich-select-row-text-highlight">${highlightedPart}</span>${endPart}`)}else hasMatch=!1}hasMatch||this.renderValueWithoutRenderer(parsedValue)}updateHighlighted(highlighted){var _a273;const eGui=this.getGui(),parentId=`ag-rich-select-row-${this.getCompId()}`;if((_a273=eGui.parentElement)==null||_a273.setAttribute("id",parentId),highlighted){const parentAriaEl=this.getParentComponent().getAriaElement();setAriaActiveDescendant(parentAriaEl,parentId),this.wrapperEl.setAttribute("data-active-option",parentId)}setAriaSelected(eGui.parentElement,highlighted),this.addOrRemoveCssClass("ag-rich-select-row-selected",highlighted)}populateWithoutRenderer(value,valueFormatted){const eDocument=this.gridOptionsService.getDocument(),eGui=this.getGui(),span=eDocument.createElement("span");span.style.overflow="hidden",span.style.textOverflow="ellipsis";const parsedValue=escapeString(exists(valueFormatted)?valueFormatted:value,!0);this.parsedValue=exists(parsedValue)?parsedValue:null,eGui.appendChild(span),this.renderValueWithoutRenderer(parsedValue),this.setTooltip({newTooltipText:this.parsedValue,shouldDisplayTooltip:()=>span.scrollWidth>span.clientWidth})}renderValueWithoutRenderer(value){const span=this.getGui().querySelector("span");span&&(span.innerHTML=exists(value)?value:"&nbsp;")}populateWithRenderer(value,valueFormatted){let cellRendererPromise,userCompDetails;return this.params.cellRenderer&&(userCompDetails=this.userComponentFactory.getCellRendererDetails(this.params,{value,valueFormatted,setTooltip:(value2,shouldDisplayTooltip)=>{this.setTooltip({newTooltipText:value2,shouldDisplayTooltip})}})),userCompDetails&&(cellRendererPromise=userCompDetails.newAgStackInstance()),cellRendererPromise&&bindCellRendererToHtmlElement(cellRendererPromise,this.getGui()),cellRendererPromise?(cellRendererPromise.then(childComponent=>{this.addDestroyFunc(()=>{this.getContext().destroyBean(childComponent)})}),!0):!1}onClick(){const parent=this.getParentComponent(),event={type:Events.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};parent==null||parent.dispatchEvent(event)}},__name(_a183,"RichSelectRow"),_a183);__decorateClass([Autowired("userComponentFactory")],RichSelectRow.prototype,"userComponentFactory",2);__decorateClass([PostConstruct],RichSelectRow.prototype,"postConstruct",1);var _a184,_VirtualList=(_a184=class extends TabGuardComp{constructor(params){super(_a184.getTemplate((params==null?void 0:params.cssIdentifier)||"default")),this.renderedRows=new Map,this.rowHeight=20,this.isHeightFromTheme=!0;const{cssIdentifier="default",ariaRole="listbox",listName}=params||{};this.cssIdentifier=cssIdentifier,this.ariaRole=ariaRole,this.listName=listName}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:fromBottom=>this.focusInnerElement(fromBottom),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.setAriaProperties(),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const listName=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),ariaEl=this.eContainer;setAriaRole(ariaEl,this.ariaRole),setAriaLabel(ariaEl,listName)}addResizeObserver(){const listener=__name(()=>this.animationFrameService.requestAnimationFrame(()=>this.drawVirtualRows()),"listener"),destroyObserver=this.resizeObserverService.observeResize(this.getGui(),listener);this.addDestroyFunc(destroyObserver)}focusInnerElement(fromBottom){this.focusRow(fromBottom?this.model.getRowCount()-1:0)}onFocusIn(e){const target=e.target;target.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=getAriaPosInSet(target)-1)}onFocusOut(e){this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(e){switch(e.key){case KeyCode.UP:case KeyCode.DOWN:this.navigate(e.key===KeyCode.UP)&&e.preventDefault();break}}onTabKeyDown(e){this.navigate(e.shiftKey)?e.preventDefault():(stopPropagationForAgGrid(e),this.forceFocusOutOfContainer(e.shiftKey))}navigate(up){if(this.lastFocusedRowIndex==null)return!1;const nextRow=this.lastFocusedRowIndex+(up?-1:1);return nextRow<0||nextRow>=this.model.getRowCount()?!1:(this.focusRow(nextRow),!0)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(rowNumber){this.ensureIndexVisible(rowNumber),window.setTimeout(()=>{if(!this.isAlive())return;const renderedRow=this.renderedRows.get(rowNumber);renderedRow&&renderedRow.eDiv.focus()},10)}getComponentAt(rowIndex){const comp=this.renderedRows.get(rowIndex);return comp&&comp.rowComponent}forEachRenderedRow(func){this.renderedRows.forEach((value,key)=>func(value.rowComponent,key))}static getTemplate(cssIdentifier){return`<div class="ag-virtual-list-viewport ag-${cssIdentifier}-virtual-list-viewport" role="presentation">
                <div class="ag-virtual-list-container ag-${cssIdentifier}-virtual-list-container" ref="eContainer"></div>
            </div>`}getItemHeight(){return this.isHeightFromTheme?this.environment.getListItemHeight():this.rowHeight}ensureIndexVisible(index,scrollPartialIntoView=!0){const lastRow=this.model.getRowCount();if(typeof index!="number"||index<0||index>=lastRow)return console.warn("AG Grid: invalid row index for ensureIndexVisible: "+index),!1;const rowTopPixel=index*this.rowHeight,rowBottomPixel=rowTopPixel+this.rowHeight,eGui=this.getGui(),viewportTopPixel=eGui.scrollTop,viewportHeight=eGui.offsetHeight,viewportBottomPixel=viewportTopPixel+viewportHeight,diff=scrollPartialIntoView?0:this.rowHeight,viewportScrolledPastRow=viewportTopPixel>rowTopPixel+diff,viewportScrolledBeforeRow=viewportBottomPixel<rowBottomPixel-diff;if(viewportScrolledPastRow)return eGui.scrollTop=rowTopPixel,!0;if(viewportScrolledBeforeRow){const newScrollPosition=rowBottomPixel-viewportHeight;return eGui.scrollTop=newScrollPosition,!0}return!1}setComponentCreator(componentCreator){this.componentCreator=componentCreator}setComponentUpdater(componentUpdater){this.componentUpdater=componentUpdater}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(rowHeight){this.isHeightFromTheme=!1,this.rowHeight=rowHeight,this.refresh()}refresh(softRefresh){if(this.model==null||!this.isAlive())return;const rowCount=this.model.getRowCount();this.eContainer.style.height=`${rowCount*this.rowHeight}px`,waitUntil(()=>this.eContainer.clientHeight>=rowCount*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(softRefresh)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(softRefresh){return!!(softRefresh&&this.renderedRows.size&&typeof this.model.areRowsEqual=="function"&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((_2,rowIndex)=>this.removeRow(rowIndex))}drawVirtualRows(softRefresh){if(!this.isAlive()||!this.model)return;const gui=this.getGui(),topPixel=gui.scrollTop,bottomPixel=topPixel+gui.offsetHeight,firstRow=Math.floor(topPixel/this.rowHeight),lastRow=Math.floor(bottomPixel/this.rowHeight);this.ensureRowsRendered(firstRow,lastRow,softRefresh)}ensureRowsRendered(start,finish,softRefresh){this.renderedRows.forEach((_2,rowIndex)=>{(rowIndex<start||rowIndex>finish)&&rowIndex!==this.lastFocusedRowIndex&&this.removeRow(rowIndex)}),softRefresh&&this.refreshRows();for(let rowIndex=start;rowIndex<=finish;rowIndex++)this.renderedRows.has(rowIndex)||rowIndex<this.model.getRowCount()&&this.insertRow(rowIndex)}insertRow(rowIndex){const value=this.model.getRow(rowIndex),eDiv=document.createElement("div");eDiv.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),setAriaRole(eDiv,this.ariaRole==="tree"?"treeitem":"option"),setAriaSetSize(eDiv,this.model.getRowCount()),setAriaPosInSet(eDiv,rowIndex+1),eDiv.setAttribute("tabindex","-1"),eDiv.style.height=`${this.rowHeight}px`,eDiv.style.top=`${this.rowHeight*rowIndex}px`;const rowComponent=this.componentCreator(value,eDiv);rowComponent.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=rowIndex),eDiv.appendChild(rowComponent.getGui()),this.renderedRows.has(rowIndex-1)?this.renderedRows.get(rowIndex-1).eDiv.insertAdjacentElement("afterend",eDiv):this.renderedRows.has(rowIndex+1)?this.renderedRows.get(rowIndex+1).eDiv.insertAdjacentElement("beforebegin",eDiv):this.eContainer.appendChild(eDiv),this.renderedRows.set(rowIndex,{rowComponent,eDiv,value})}removeRow(rowIndex){const component=this.renderedRows.get(rowIndex);this.eContainer.removeChild(component.eDiv),this.destroyBean(component.rowComponent),this.renderedRows.delete(rowIndex)}refreshRows(){const rowCount=this.model.getRowCount();this.renderedRows.forEach((row,rowIndex)=>{var _a273,_b;if(rowIndex>=rowCount)this.removeRow(rowIndex);else{const newValue=this.model.getRow(rowIndex);(_b=(_a273=this.model).areRowsEqual)!=null&&_b.call(_a273,row.value,newValue)?this.componentUpdater(newValue,row.rowComponent):this.removeRow(rowIndex)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(model){this.model=model}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}},__name(_a184,"_VirtualList"),_a184);__decorateClass([Autowired("resizeObserverService")],_VirtualList.prototype,"resizeObserverService",2);__decorateClass([Autowired("animationFrameService")],_VirtualList.prototype,"animationFrameService",2);__decorateClass([RefSelector("eContainer")],_VirtualList.prototype,"eContainer",2);__decorateClass([PostConstruct],_VirtualList.prototype,"postConstruct",1);var VirtualList=_VirtualList,TEMPLATE2=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,_a185,AgRichSelect=(_a185=class extends AgPickerField{constructor(config){var _a273,_b;super(__spreadProps(__spreadValues({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"smallDown",ariaRole:"combobox",template:(_a273=config==null?void 0:config.template)!=null?_a273:TEMPLATE2,modalPicker:!1},config),{maxPickerHeight:(_b=config==null?void 0:config.maxPickerHeight)!=null?_b:"calc(var(--ag-row-height) * 6.5)"})),this.searchString="",this.highlightedItem=-1,this.lastRowHovered=-1,this.searchStringCreator=null;const{cellRowHeight,value,valueList,searchStringCreator}=config||{};cellRowHeight!=null&&(this.cellRowHeight=cellRowHeight),value!==void 0&&(this.value=value),valueList!=null&&(this.values=valueList),searchStringCreator&&(this.searchStringCreator=searchStringCreator)}postConstruct(){super.postConstruct(),this.createLoadingElement(),this.createListComponent();const{allowTyping,placeholder}=this.config;allowTyping?(this.eInput.setAutoComplete(!1).setInputPlaceholder(placeholder),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.eWrapper.tabIndex=this.gridOptionsService.get("tabIndex");const{searchDebounceDelay=300}=this.config;this.clearSearchString=debounce(this.clearSearchString,searchDebounceDelay),this.renderSelectedValue(),allowTyping&&(this.eInput.onValueChange(value=>this.searchTextFromString(value)),this.addManagedListener(this.eWrapper,"focus",this.onWrapperFocus.bind(this))),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}createLoadingElement(){const eDocument=this.gridOptionsService.getDocument(),translate=this.localeService.getLocaleTextFunc(),el=eDocument.createElement("div");el.classList.add("ag-loading-text"),el.innerText=translate("loadingOoo","Loading..."),this.eLoading=el}createListComponent(){this.listComponent=this.createBean(new VirtualList({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this));const componentUpdater=__name((item,component)=>{},"componentUpdater");this.listComponent.setComponentUpdater(componentUpdater),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,Events.EVENT_FIELD_PICKER_VALUE_SELECTED,e=>{this.onListValueSelected(e.value,e.fromEnterKey)});const{cellRowHeight}=this;cellRowHeight&&this.listComponent.setRowHeight(cellRowHeight);const eListGui=this.listComponent.getGui(),eListAriaEl=this.listComponent.getAriaElement();this.addManagedListener(eListGui,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(eListGui,"mousedown",e=>e.preventDefault()),eListGui.classList.add("ag-rich-select-list");const listId=`ag-rich-select-list-${this.listComponent.getCompId()}`;eListAriaEl.setAttribute("id",listId);const ariaLabel=this.localeService.getLocaleTextFunc()(this.config.pickerAriaLabelKey,this.config.pickerAriaLabelValue);setAriaLabel(eListAriaEl,ariaLabel),setAriaControls(this.eWrapper,eListAriaEl)}renderSelectedValue(){const{value,eDisplayField,config}=this,{allowTyping,initialInputValue}=this.config,valueFormatted=this.config.valueFormatter?this.config.valueFormatter(value):value;if(allowTyping){this.eInput.setValue(initialInputValue??valueFormatted);return}let userCompDetails;config.cellRenderer&&(userCompDetails=this.userComponentFactory.getCellRendererDetails(this.config,{value,valueFormatted}));let userCompDetailsPromise;if(userCompDetails&&(userCompDetailsPromise=userCompDetails.newAgStackInstance()),userCompDetailsPromise)clearElement(eDisplayField),bindCellRendererToHtmlElement(userCompDetailsPromise,eDisplayField),userCompDetailsPromise.then(renderer=>{this.addDestroyFunc(()=>this.getContext().destroyBean(renderer))});else{if(exists(this.value))eDisplayField.innerText=valueFormatted,eDisplayField.classList.remove("ag-display-as-placeholder");else{const{placeholder}=config;exists(placeholder)?(eDisplayField.innerHTML=`${escapeString(placeholder)}`,eDisplayField.classList.add("ag-display-as-placeholder")):clearElement(eDisplayField)}this.setTooltip({newTooltipText:valueFormatted??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth})}}getCurrentValueIndex(){const{currentList,value}=this;if(value==null||!currentList)return-1;for(let i=0;i<currentList.length;i++)if(currentList[i]===value)return i;return-1}highlightFilterMatch(){var _a273;(_a273=this.listComponent)==null||_a273.forEachRenderedRow((cmp,idx)=>{cmp.highlightString(this.searchString)})}highlightSelectedValue(index){var _a273;index==null&&(index=this.getCurrentValueIndex()),this.highlightedItem=index,(_a273=this.listComponent)==null||_a273.forEachRenderedRow((cmp,idx)=>{const highlighted=index===-1?!1:this.highlightedItem===idx;cmp.updateHighlighted(highlighted)})}setRowHeight(height){height!==this.cellRowHeight&&(this.cellRowHeight=height),this.listComponent&&this.listComponent.setRowHeight(height)}createPickerComponent(){const{values:values2}=this;return values2&&this.setValueList({valueList:values2}),this.listComponent}setSearchStringCreator(searchStringFn){this.searchStringCreator=searchStringFn}setValueList(params){const{valueList,refresh}=params;this.listComponent&&this.currentList!==valueList&&(this.currentList=valueList,this.listComponent.setModel({getRowCount:()=>valueList.length,getRow:index=>valueList[index],areRowsEqual:(oldRow,newRow)=>oldRow===newRow}),refresh&&(this.values?this.listComponent.refresh(!0):(this.values=valueList,this.isPickerDisplayed&&this.showCurrentValueInPicker())))}showPicker(){super.showPicker(),this.showCurrentValueInPicker(),this.displayOrHidePicker()}showCurrentValueInPicker(){var _a273,_b;if(!this.listComponent)return;if(!this.currentList){this.isPickerDisplayed&&this.eLoading&&this.listComponent.appendChild(this.eLoading);return}(_a273=this.eLoading)!=null&&_a273.offsetParent&&((_b=this.eLoading.parentElement)==null||_b.removeChild(this.eLoading));const currentValueIndex=this.getCurrentValueIndex();currentValueIndex!==-1?(this.listComponent.refresh(),this.listComponent.ensureIndexVisible(currentValueIndex),this.listComponent.refresh(!0),this.highlightSelectedValue(currentValueIndex)):this.listComponent.refresh()}beforeHidePicker(){this.highlightedItem=-1,super.beforeHidePicker()}onWrapperFocus(){if(!this.eInput)return;const focusableEl=this.eInput.getFocusableElement();focusableEl.focus(),focusableEl.select()}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}buildSearchStringFromKeyboardEvent(searchKey){let{key}=searchKey;if(key===KeyCode.BACKSPACE)this.searchString=this.searchString.slice(0,-1),key="";else if(!isEventFromPrintableCharacter(searchKey))return;searchKey.preventDefault(),this.searchTextFromCharacter(key)}searchTextFromCharacter(char){this.searchString+=char,this.runSearch(),this.clearSearchString()}searchTextFromString(str){str==null&&(str=""),this.searchString=str,this.runSearch()}buildSearchStrings(values2){const{valueFormatter=__name(value=>value,"valueFormatter")}=this.config;let searchStrings;return typeof values2[0]=="number"||typeof values2[0]=="string"?searchStrings=values2.map(v=>valueFormatter(v)):typeof values2[0]=="object"&&this.searchStringCreator&&(searchStrings=this.searchStringCreator(values2)),searchStrings}getSuggestionsAndFilteredValues(searchValue,valueList){let suggestions=[],filteredValues=[];if(!searchValue.length)return{suggestions,filteredValues};const{searchType="fuzzy",filterList}=this.config;if(searchType==="fuzzy"){const fuzzySearchResult=fuzzySuggestions(this.searchString,valueList,!0);suggestions=fuzzySearchResult.values;const indices=fuzzySearchResult.indices;if(filterList&&indices.length)for(let i=0;i<indices.length;i++)filteredValues.push(this.values[indices[i]])}else suggestions=valueList.filter((val,idx)=>{const currentValue=val.toLocaleLowerCase(),valueToMatch=this.searchString.toLocaleLowerCase(),isMatch=searchType==="match"?currentValue.startsWith(valueToMatch):currentValue.indexOf(valueToMatch)!==-1;return filterList&&isMatch&&filteredValues.push(this.values[idx]),isMatch});return{suggestions,filteredValues}}filterListModel(filteredValues){const{filterList}=this.config;filterList&&(this.setValueList({valueList:filteredValues,refresh:!0}),this.alignPickerToComponent())}runSearch(){var _a273,_b;const{values:values2}=this,searchStrings=this.buildSearchStrings(values2);if(!searchStrings){this.highlightSelectedValue(-1);return}const{suggestions,filteredValues}=this.getSuggestionsAndFilteredValues(this.searchString,searchStrings),{filterList,highlightMatch,searchType="fuzzy"}=this.config,filterValueLen=filteredValues.length,shouldFilter=!!(filterList&&this.searchString!=="");if(this.filterListModel(shouldFilter?filteredValues:values2),suggestions.length){const topSuggestionIndex=shouldFilter?0:searchStrings.indexOf(suggestions[0]);this.selectListItem(topSuggestionIndex)}else if(this.highlightSelectedValue(-1),!shouldFilter||filterValueLen)(_a273=this.listComponent)==null||_a273.ensureIndexVisible(0);else if(shouldFilter){this.getAriaElement().removeAttribute("data-active-option");const eListAriaEl=(_b=this.listComponent)==null?void 0:_b.getAriaElement();eListAriaEl&&setAriaActiveDescendant(eListAriaEl,null)}highlightMatch&&searchType!=="fuzzy"&&this.highlightFilterMatch(),this.displayOrHidePicker()}displayOrHidePicker(){var _a273;const eListGui=(_a273=this.listComponent)==null?void 0:_a273.getGui(),toggleValue=this.currentList?this.currentList.length===0:!1;eListGui==null||eListGui.classList.toggle("ag-hidden",toggleValue)}clearSearchString(){this.searchString=""}selectListItem(index,preventUnnecessaryScroll){if(!this.isPickerDisplayed||!this.currentList||!this.listComponent||index<0||index>=this.currentList.length)return;this.listComponent.ensureIndexVisible(index,!preventUnnecessaryScroll)&&!preventUnnecessaryScroll&&this.listComponent.refresh(!0),this.highlightSelectedValue(index)}setValue(value,silent,fromPicker){const index=this.currentList?this.currentList.indexOf(value):-1;return index===-1?this:(this.value=value,fromPicker||this.selectListItem(index),this.renderSelectedValue(),super.setValue(value,silent))}createRowComponent(value){const row=new RichSelectRow(this.config,this.eWrapper);row.setParentComponent(this.listComponent),this.getContext().createBean(row),row.setState(value);const{highlightMatch,searchType="fuzzy"}=this.config;return highlightMatch&&searchType!=="fuzzy"&&row.highlightString(this.searchString),row}getRowForMouseEvent(e){const{listComponent}=this;if(!listComponent)return-1;const rect=(listComponent==null?void 0:listComponent.getGui()).getBoundingClientRect(),scrollTop=listComponent.getScrollTop(),mouseY=e.clientY-rect.top+scrollTop;return Math.floor(mouseY/listComponent.getRowHeight())}onPickerMouseMove(e){if(!this.listComponent)return;const row=this.getRowForMouseEvent(e);row!==-1&&row!=this.lastRowHovered&&(this.lastRowHovered=row,this.selectListItem(row,!0))}onNavigationKeyDown(event,key){event.preventDefault();const isDown=key===KeyCode.DOWN;if(!this.isPickerDisplayed&&isDown){this.showPicker();return}const oldIndex=this.highlightedItem,newIndex=oldIndex===-1?0:oldIndex+(isDown?1:-1);this.selectListItem(newIndex)}onEnterKeyDown(e){this.isPickerDisplayed&&(e.preventDefault(),this.currentList&&this.onListValueSelected(this.currentList[this.highlightedItem],!0))}onTabKeyDown(){!this.isPickerDisplayed||!this.currentList||this.setValue(this.currentList[this.highlightedItem],!1,!0)}onListValueSelected(value,fromEnterKey){this.setValue(value,!1,!0),this.dispatchPickerEvent(value,fromEnterKey),this.hidePicker()}dispatchPickerEvent(value,fromEnterKey){const event={type:Events.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey,value};this.dispatchEvent(event)}getFocusableElement(){const{allowTyping}=this.config;return allowTyping?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(event){const key=event.key,{allowTyping}=this.config;switch(key){case KeyCode.LEFT:case KeyCode.RIGHT:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:allowTyping||event.preventDefault();break;case KeyCode.PAGE_UP:case KeyCode.PAGE_DOWN:event.preventDefault();break;case KeyCode.DOWN:case KeyCode.UP:this.onNavigationKeyDown(event,key);break;case KeyCode.ESCAPE:this.isPickerDisplayed&&(isVisible(this.listComponent.getGui())&&(event.preventDefault(),stopPropagationForAgGrid(event)),this.hidePicker());break;case KeyCode.ENTER:this.onEnterKeyDown(event);break;case KeyCode.TAB:this.onTabKeyDown();break;default:allowTyping||this.buildSearchStringFromKeyboardEvent(event)}}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),this.eLoading=void 0,super.destroy()}},__name(_a185,"AgRichSelect"),_a185);__decorateClass([Autowired("userComponentFactory")],AgRichSelect.prototype,"userComponentFactory",2);__decorateClass([RefSelector("eInput")],AgRichSelect.prototype,"eInput",2);var _a186,_AgSlider=(_a186=class extends AgAbstractLabel{constructor(config){super(config,_a186.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field");const{minValue,maxValue,textFieldWidth,step,value,onValueChange}=this.config;minValue!=null&&this.setMinValue(minValue),maxValue!=null&&this.setMaxValue(maxValue),textFieldWidth!=null&&this.setTextFieldWidth(textFieldWidth),step!=null&&this.setStep(step),value!=null&&this.setValue(value),onValueChange!=null&&this.onValueChange(onValueChange)}onValueChange(callbackFn){const eventChanged=Events.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,eventChanged,()=>{const textValue=parseFloat(this.eText.getValue());this.eSlider.setValue(textValue.toString(),!0),callbackFn(textValue||0)}),this.addManagedListener(this.eSlider,eventChanged,()=>{const sliderValue=this.eSlider.getValue();this.eText.setValue(sliderValue,!0),callbackFn(parseFloat(sliderValue))}),this}setSliderWidth(width){return this.eSlider.setWidth(width),this}setTextFieldWidth(width){return this.eText.setWidth(width),this}setMinValue(minValue){return this.eSlider.setMinValue(minValue),this.eText.setMin(minValue),this}setMaxValue(maxValue){return this.eSlider.setMaxValue(maxValue),this.eText.setMax(maxValue),this}getValue(){return this.eText.getValue()}setValue(value,silent){return this.getValue()===value?this:(this.eText.setValue(value,!0),this.eSlider.setValue(value,!0),silent||this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED}),this)}setStep(step){return this.eSlider.setStep(step),this.eText.setStep(step),this}},__name(_a186,"_AgSlider"),_a186);_AgSlider.TEMPLATE=`<div class="ag-slider">
            <label ref="eLabel"></label>
            <div class="ag-wrapper ag-slider-wrapper">
                <ag-input-range ref="eSlider"></ag-input-range>
                <ag-input-number-field ref="eText"></ag-input-number-field>
            </div>
        </div>`;__decorateClass([RefSelector("eLabel")],_AgSlider.prototype,"eLabel",2);__decorateClass([RefSelector("eSlider")],_AgSlider.prototype,"eSlider",2);__decorateClass([RefSelector("eText")],_AgSlider.prototype,"eText",2);__decorateClass([PostConstruct],_AgSlider.prototype,"init",1);var AgSlider=_AgSlider,_a187,_AgGroupComponent=(_a187=class extends Component{constructor(params={}){super(_a187.getTemplate(params)),this.params=params,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1;const{enabled,items,suppressEnabledCheckbox,expanded,suppressToggleExpandOnEnableChange,useToggle:toggleMode}=params;this.cssIdentifier=params.cssIdentifier||"default",this.enabled=enabled??!0,this.items=items||[],this.useToggle=toggleMode??!1,this.alignItems=params.alignItems||"center",this.expanded=expanded??!0,suppressEnabledCheckbox!=null&&(this.suppressEnabledCheckbox=suppressEnabledCheckbox),suppressToggleExpandOnEnableChange!=null&&(this.suppressToggleExpandOnEnableChange=suppressToggleExpandOnEnableChange)}static getTemplate(params){const cssIdentifier=params.cssIdentifier||"default",direction=params.direction||"vertical";return`
            <div class="ag-group ag-${cssIdentifier}-group" role="presentation">
                <div ref="eToolbar" class="ag-group-toolbar ag-${cssIdentifier}-group-toolbar">
                    <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>
                </div>
                <div ref="eContainer" class="ag-group-container ag-group-container-${direction} ag-${cssIdentifier}-group-container"></div>
            </div>
        `}postConstruct(){if(this.setupTitleBar(),this.items.length){const initialItems=this.items;this.items=[],this.addItems(initialItems)}const localeTextFunc=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(localeTextFunc("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange,suppressOpenCloseIcons}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(suppressOpenCloseIcons??!1),this.refreshChildDisplay(),setDisplayed(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(newSelection=>{this.setEnabled(newSelection,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(newSelection)}),onEnableChange!=null&&this.onEnableChange(onEnableChange)}refreshChildDisplay(){var _a273;setDisplayed(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),(_a273=this.eTitleBar)==null||_a273.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(alignment){this.alignItems!==alignment&&this.removeCssClass(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=alignment;const newCls=`ag-group-item-alignment-${this.alignItems}`;return this.addCssClass(newCls),this}toggleGroupExpand(expanded){var _a273;let silent=!1;if((_a273=this.eTitleBar)!=null&&_a273.isSuppressCollapse()&&!this.useToggle)expanded=!0,silent=!0;else if(expanded=expanded??!this.expanded,this.expanded===expanded)return this;return this.expanded=expanded,this.refreshChildDisplay(),setDisplayed(this.eContainer,expanded),silent||this.dispatchEvent({type:expanded?_a187.EVENT_EXPANDED:_a187.EVENT_COLLAPSED}),this}addItems(items){items.forEach(item=>this.addItem(item))}prependItem(item){this.insertItem(item,!0)}addItem(item){this.insertItem(item,!1)}insertItem(item,prepend){const container=this.eContainer,el=item instanceof Component?item.getGui():item;el.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),prepend?(container.insertAdjacentElement("afterbegin",el),this.items.unshift(el)):(container.appendChild(el),this.items.push(el))}hideItem(hide,index){const itemToHide=this.items[index];setDisplayed(itemToHide,!hide)}getItemIndex(item){const el=item instanceof Component?item.getGui():item;return this.items.indexOf(el)}setTitle(title){var _a273;return(_a273=this.eTitleBar)==null||_a273.setTitle(title),this}addCssClassToTitleBar(cssClass){var _a273;(_a273=this.eTitleBar)==null||_a273.addCssClass(cssClass)}dispatchEnableChangeEvent(enabled){const event={type:_a187.EVENT_ENABLE_CHANGE,enabled};this.dispatchEvent(event)}setEnabled(enabled,skipToggle,skipExpand){var _a273;return this.enabled=enabled,this.refreshDisabledStyles(),skipExpand||this.toggleGroupExpand(enabled),skipToggle||(this.cbGroupEnabled.setValue(enabled),(_a273=this.eToggle)==null||_a273.setValue(enabled)),this}isEnabled(){return this.enabled}onEnableChange(callbackFn){return this.addManagedListener(this,_a187.EVENT_ENABLE_CHANGE,event=>callbackFn(event.enabled)),this}hideEnabledCheckbox(hide){return this.suppressEnabledCheckbox=hide,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(hide){var _a273;return(_a273=this.eTitleBar)==null||_a273.hideOpenCloseIcons(hide),this}refreshDisabledStyles(){var _a273;const disabled=!this.enabled;this.eContainer.classList.toggle("ag-disabled",disabled),(_a273=this.eTitleBar)==null||_a273.refreshDisabledStyles(this.suppressEnabledCheckbox&&disabled),this.eContainer.classList.toggle("ag-disabled-group-container",disabled)}setupTitleBar(){const titleBar=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",titleBar.getGui())}createDefaultTitleBar(){const titleBar=this.createManagedBean(new DefaultTitleBar(this.params));return this.eTitleBar=titleBar,titleBar.refreshOnExpand(this.expanded),this.addManagedListener(titleBar,DefaultTitleBar.EVENT_EXPAND_CHANGED,event=>this.toggleGroupExpand(event.expanded)),titleBar}createToggleTitleBar(){var _a273;const eToggle=this.createManagedBean(new AgToggleButton({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:enabled=>{this.setEnabled(enabled,!0),this.dispatchEnableChangeEvent(enabled)}}));return eToggle.addCssClass("ag-group-title-bar"),eToggle.addCssClass(`ag-${(_a273=this.params.cssIdentifier)!=null?_a273:"default"}-group-title-bar ag-unselectable`),this.eToggle=eToggle,this.toggleGroupExpand(this.enabled),eToggle}},__name(_a187,"_AgGroupComponent"),_a187);_AgGroupComponent.EVENT_EXPANDED="expanded";_AgGroupComponent.EVENT_COLLAPSED="collapsed";_AgGroupComponent.EVENT_ENABLE_CHANGE="enableChange";__decorateClass([RefSelector("eToolbar")],_AgGroupComponent.prototype,"eToolbar",2);__decorateClass([RefSelector("cbGroupEnabled")],_AgGroupComponent.prototype,"cbGroupEnabled",2);__decorateClass([RefSelector("eContainer")],_AgGroupComponent.prototype,"eContainer",2);__decorateClass([PostConstruct],_AgGroupComponent.prototype,"postConstruct",1);var AgGroupComponent=_AgGroupComponent,_a188,_DefaultTitleBar=(_a188=class extends Component{constructor(params={}){super(_a188.getTemplate(params)),this.suppressOpenCloseIcons=!1;const{title,suppressOpenCloseIcons}=params;this.title=title,suppressOpenCloseIcons!=null&&(this.suppressOpenCloseIcons=suppressOpenCloseIcons)}static getTemplate(params){var _a273;const cssIdentifier=(_a273=params.cssIdentifier)!=null?_a273:"default";return`
            <div class="ag-group-title-bar ag-${cssIdentifier}-group-title-bar ag-unselectable" role="button">
                <span class="ag-group-title-bar-icon ag-${cssIdentifier}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>
                <span class="ag-group-title-bar-icon ag-${cssIdentifier}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>
                <span ref="eTitle" class="ag-group-title ag-${cssIdentifier}-group-title"></span>
            </div>
        `}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild(createIcon("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(createIcon("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.getGui(),"click",()=>this.dispatchExpandChanged()),this.addManagedListener(this.getGui(),"keydown",e=>{switch(e.key){case KeyCode.ENTER:case KeyCode.SPACE:e.preventDefault(),this.dispatchExpandChanged();break;case KeyCode.RIGHT:case KeyCode.LEFT:e.preventDefault(),this.dispatchExpandChanged(e.key===KeyCode.RIGHT);break}})}refreshOnExpand(expanded){this.refreshAriaStatus(expanded),this.refreshOpenCloseIcons(expanded)}refreshAriaStatus(expanded){this.suppressOpenCloseIcons||setAriaExpanded(this.getGui(),expanded)}refreshOpenCloseIcons(expanded){const showIcon=!this.suppressOpenCloseIcons;setDisplayed(this.eGroupOpenedIcon,showIcon&&expanded),setDisplayed(this.eGroupClosedIcon,showIcon&&!expanded)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(expanded){const event={type:_a188.EVENT_EXPAND_CHANGED,expanded};this.dispatchEvent(event)}setTitle(title){return this.eTitle.innerText=title||"",setDisplayed(this.getGui(),title!=null),this}hideOpenCloseIcons(hide){return this.suppressOpenCloseIcons=hide,hide&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(disabled){const eGui=this.getGui();disabled?(eGui.classList.add("ag-disabled-group-title-bar"),eGui.removeAttribute("tabindex")):(eGui.classList.remove("ag-disabled-group-title-bar"),typeof this.title=="string"?eGui.setAttribute("tabindex","0"):eGui.removeAttribute("tabindex"))}},__name(_a188,"_DefaultTitleBar"),_a188);_DefaultTitleBar.EVENT_EXPAND_CHANGED="expandedChanged";__decorateClass([RefSelector("eGroupOpenedIcon")],_DefaultTitleBar.prototype,"eGroupOpenedIcon",2);__decorateClass([RefSelector("eGroupClosedIcon")],_DefaultTitleBar.prototype,"eGroupClosedIcon",2);__decorateClass([RefSelector("eTitle")],_DefaultTitleBar.prototype,"eTitle",2);__decorateClass([PostConstruct],_DefaultTitleBar.prototype,"postConstruct",1);var DefaultTitleBar=_DefaultTitleBar,_a189,AgMenuList=(_a189=class extends TabGuardComp{constructor(level=0,params){super('<div class="ag-menu-list" role="tree"></div>'),this.level=level,this.menuItems=[],this.params=params??{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.handleFocusIn(e),onFocusOut:e=>this.handleFocusOut(e)})}onTabKeyDown(e){const parent=this.getParentComponent(),parentGui=parent&&parent.getGui();parentGui&&parentGui.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(e){switch(e.key){case KeyCode.UP:case KeyCode.RIGHT:case KeyCode.DOWN:case KeyCode.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case KeyCode.ESCAPE:this.closeIfIsChild()&&stopPropagationForAgGrid(e);break}}handleFocusIn(e){var _a273,_b;const oldFocusedElement=e.relatedTarget;!this.tabGuardCtrl.isTabGuard(oldFocusedElement)&&(this.getGui().contains(oldFocusedElement)||(_b=(_a273=this.activeMenuItem)==null?void 0:_a273.getSubMenuGui())!=null&&_b.contains(oldFocusedElement))||(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(e){var _a273;const newFocusedElement=e.relatedTarget;!this.activeMenuItem||this.getGui().contains(newFocusedElement)||(_a273=this.activeMenuItem.getSubMenuGui())!=null&&_a273.contains(newFocusedElement)||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(menuItems){menuItems!=null&&AgPromise.all(menuItems.map(menuItemOrString=>menuItemOrString==="separator"?AgPromise.resolve({eGui:this.createSeparator()}):typeof menuItemOrString=="string"?(console.warn(`AG Grid: unrecognised menu item ${menuItemOrString}`),AgPromise.resolve({eGui:null})):this.addItem(menuItemOrString))).then(elements=>{elements.forEach(element=>{element!=null&&element.eGui&&(this.appendChild(element.eGui),element.comp&&this.menuItems.push(element.comp))})})}addItem(menuItemDef){const menuItem=this.createManagedBean(new AgMenuItemComponent);return menuItem.init({menuItemDef,isAnotherSubMenuOpen:()=>this.menuItems.some(m=>m.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(menuItem.setParentComponent(this),this.addManagedListener(menuItem,AgMenuItemComponent.EVENT_CLOSE_MENU,event=>{this.dispatchEvent(event)}),this.addManagedListener(menuItem,AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED,event=>{this.activeMenuItem&&this.activeMenuItem!==event.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=event.menuItem}),{comp:menuItem,eGui:menuItem.getGui()}))}activateFirstItem(){const item=this.menuItems.filter(currentItem=>!currentItem.isDisabled())[0];item&&item.activate()}createSeparator(){return loadTemplate(`
            <div class="ag-menu-separator" aria-hidden="true">
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
            </div>`)}handleNavKey(key){switch(key){case KeyCode.UP:case KeyCode.DOWN:const nextItem=this.findNextItem(key===KeyCode.UP);nextItem&&nextItem!==this.activeMenuItem&&nextItem.activate();return}const left=this.gridOptionsService.get("enableRtl")?KeyCode.RIGHT:KeyCode.LEFT;key===left?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const parentItem=this.getParentComponent();return parentItem&&parentItem instanceof AgMenuItemComponent?(e&&e.preventDefault(),parentItem.closeSubMenu(),parentItem.getGui().focus(),!0):!1}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(up){const items=this.menuItems.filter(item=>!item.isDisabled());if(!items.length)return;if(!this.activeMenuItem)return up?last(items):items[0];up&&items.reverse();let nextItem,foundCurrent=!1;for(let i=0;i<items.length;i++){const item=items[i];if(!foundCurrent){item===this.activeMenuItem&&(foundCurrent=!0);continue}nextItem=item;break}return foundCurrent&&!nextItem?items[0]:nextItem||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}},__name(_a189,"AgMenuList"),_a189);__decorateClass([Autowired("focusService")],AgMenuList.prototype,"focusService",2);__decorateClass([PostConstruct],AgMenuList.prototype,"postConstruct",1);var _a190,AgMenuPanel=(_a190=class extends TabGuardComp{constructor(wrappedComponent){super(),this.wrappedComponent=wrappedComponent,this.setTemplateFromElement(wrappedComponent.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===KeyCode.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const menuItem=this.parentComponent;menuItem.closeSubMenu(),setTimeout(()=>menuItem.getGui().focus(),0)}},__name(_a190,"AgMenuPanel"),_a190);__decorateClass([PostConstruct],AgMenuPanel.prototype,"postConstruct",1);var _a191,_AgMenuItemComponent=(_a191=class extends BeanStub{constructor(){super(...arguments),this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}init(params){var _a273,_b;const{menuItemDef,isAnotherSubMenuOpen,level,childComponent,contextParams}=params;return this.params=params.menuItemDef,this.level=level,this.isAnotherSubMenuOpen=isAnotherSubMenuOpen,this.childComponent=childComponent,this.contextParams=contextParams,this.cssClassPrefix=(_b=(_a273=this.params.menuItemParams)==null?void 0:_a273.cssClassPrefix)!=null?_b:"ag-menu-option",this.userComponentFactory.getMenuItemCompDetails(this.params,__spreadProps(__spreadValues({},menuItemDef),{level,isAnotherSubMenuOpen,openSubMenu:activateFirstItem=>this.openSubMenu(activateFirstItem),closeSubMenu:()=>this.closeSubMenu(),closeMenu:event=>this.closeMenu(event),updateTooltip:(tooltip,shouldDisplayTooltip)=>this.refreshTooltip(tooltip,shouldDisplayTooltip),onItemActivated:()=>this.onItemActivated()})).newAgStackInstance().then(comp=>{var _a274;this.menuItemComp=comp;const configureDefaults=(_a274=comp.configureDefaults)==null?void 0:_a274.call(comp);configureDefaults&&this.configureDefaults(configureDefaults===!0?void 0:configureDefaults)})}addListeners(eGui,params){params!=null&&params.suppressClick||this.addManagedListener(eGui,"click",e=>this.onItemSelected(e)),params!=null&&params.suppressKeyboardSelect||this.addManagedListener(eGui,"keydown",e=>{(e.key===KeyCode.ENTER||e.key===KeyCode.SPACE)&&(e.preventDefault(),this.onItemSelected(e))}),params!=null&&params.suppressMouseDown||this.addManagedListener(eGui,"mousedown",e=>{e.stopPropagation(),e.preventDefault()}),params!=null&&params.suppressMouseOver||(this.addManagedListener(eGui,"mouseenter",()=>this.onMouseEnter()),this.addManagedListener(eGui,"mouseleave",()=>this.onMouseLeave()))}isDisabled(){return!!this.params.disabled}openSubMenu(activateFirstItem=!1){var _a273,_b;if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const ePopup=loadTemplate('<div class="ag-menu" role="presentation"></div>');this.eSubMenuGui=ePopup;let destroySubMenu,afterGuiAttached=__name(()=>{this.subMenuIsOpening=!1},"afterGuiAttached");if(this.childComponent){const menuPanel=this.createBean(new AgMenuPanel(this.childComponent));menuPanel.setParentComponent(this);const subMenuGui=menuPanel.getGui(),mouseEvent="mouseenter",mouseEnterListener=__name(()=>this.cancelDeactivate(),"mouseEnterListener");subMenuGui.addEventListener(mouseEvent,mouseEnterListener),destroySubMenu=__name(()=>subMenuGui.removeEventListener(mouseEvent,mouseEnterListener),"destroySubMenu"),ePopup.appendChild(subMenuGui),this.childComponent.afterGuiAttached&&(afterGuiAttached=__name(()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1},"afterGuiAttached"))}else if(this.params.subMenu){const childMenu=this.createBean(new AgMenuList(this.level+1,this.contextParams));childMenu.setParentComponent(this),childMenu.addMenuItems(this.params.subMenu),ePopup.appendChild(childMenu.getGui()),this.addManagedListener(childMenu,_a191.EVENT_CLOSE_MENU,e=>this.dispatchEvent(e)),childMenu.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),destroySubMenu=__name(()=>this.destroyBean(childMenu),"destroySubMenu"),activateFirstItem&&(afterGuiAttached=__name(()=>{childMenu.activateFirstItem(),this.subMenuIsOpening=!1},"afterGuiAttached"))}const positionCallback=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:this.eGui,ePopup}),translate=this.localeService.getLocaleTextFunc(),addPopupRes=this.popupService.addPopup({modal:!0,eChild:ePopup,positionCallback,anchorToElement:this.eGui,ariaLabel:translate("ariaLabelSubMenu","SubMenu"),afterGuiAttached});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{var _a274,_b2;addPopupRes&&addPopupRes.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),destroySubMenu(),(_b2=(_a274=this.menuItemComp).setExpanded)==null||_b2.call(_a274,!1),this.eSubMenuGui=void 0},(_b=(_a273=this.menuItemComp).setExpanded)==null||_b.call(_a273,!0)}setAriaExpanded(expanded){this.suppressAria||setAriaExpanded(this.eGui,expanded)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(openSubMenu){var _a273,_b;this.cancelActivate(),!this.params.disabled&&(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),(_b=(_a273=this.menuItemComp).setActive)==null||_b.call(_a273,!0),this.suppressFocus||this.eGui.focus({preventScroll:!0}),openSubMenu&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){var _a273,_b;this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),(_b=(_a273=this.menuItemComp).setActive)==null||_b.call(_a273,!1),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(component){this.parentComponent=component}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(event){var _a273,_b;(_b=(_a273=this.menuItemComp).select)==null||_b.call(_a273),this.params.action?this.getFrameworkOverrides().wrapOutgoing(()=>this.params.action(this.gridOptionsService.addGridCommonParams(__spreadValues({},this.contextParams)))):this.openSubMenu(event&&event.type==="keydown"),!(this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect)&&this.closeMenu(event)}closeMenu(event){const e={type:_a191.EVENT_CLOSE_MENU,event};this.dispatchEvent(e)}onItemActivated(){const event={type:_a191.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(event)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),_a191.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),_a191.ACTIVATION_DELAY):this.deactivate()}configureDefaults(params){var _a273,_b,_c;if(this.tooltip=this.params.tooltip,!this.menuItemComp){setTimeout(()=>this.configureDefaults(params));return}let eGui=this.menuItemComp.getGui();const rootElement=(_b=(_a273=this.menuItemComp).getRootElement)==null?void 0:_b.call(_a273);rootElement&&(params!=null&&params.suppressRootStyles||eGui.classList.add("ag-menu-option-custom"),eGui=rootElement),this.eGui=eGui,this.suppressRootStyles=!!(params!=null&&params.suppressRootStyles),this.suppressRootStyles||(eGui.classList.add(this.cssClassPrefix),(_c=this.params.cssClasses)==null||_c.forEach(it=>eGui.classList.add(it)),this.params.disabled&&eGui.classList.add(`${this.cssClassPrefix}-disabled`)),params!=null&&params.suppressTooltip||this.refreshTooltip(),this.suppressAria=!!(params!=null&&params.suppressAria),this.suppressAria||(setAriaRole(eGui,"treeitem"),setAriaLevel(eGui,this.level+1),this.params.disabled&&setAriaDisabled(eGui,!0)),params!=null&&params.suppressTabIndex||eGui.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(eGui,params),this.suppressFocus=!!(params!=null&&params.suppressFocus)}refreshTooltip(tooltip,shouldDisplayTooltip){this.tooltip=tooltip,this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),!(!tooltip||!this.menuItemComp)&&(this.tooltipFeature=this.createBean(new TooltipFeature({getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip})))}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}},__name(_a191,"_AgMenuItemComponent"),_a191);_AgMenuItemComponent.EVENT_CLOSE_MENU="closeMenu";_AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated";_AgMenuItemComponent.ACTIVATION_DELAY=80;__decorateClass([Autowired("popupService")],_AgMenuItemComponent.prototype,"popupService",2);__decorateClass([Autowired("userComponentFactory")],_AgMenuItemComponent.prototype,"userComponentFactory",2);__decorateClass([Autowired("beans")],_AgMenuItemComponent.prototype,"beans",2);var AgMenuItemComponent=_AgMenuItemComponent,_a192,_AgPanel=(_a192=class extends Component{constructor(config){super(_a192.getTemplate(config)),this.config=config,this.closable=!0}static getTemplate(config){const cssIdentifier=config.cssIdentifier||"default";return`<div class="ag-panel ag-${cssIdentifier}-panel" tabindex="-1">
            <div ref="eTitleBar" class="ag-panel-title-bar ag-${cssIdentifier}-panel-title-bar ag-unselectable">
                <span ref="eTitle" class="ag-panel-title-bar-title ag-${cssIdentifier}-panel-title-bar-title"></span>
                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${cssIdentifier}-panel-title-bar-buttons"></div>
            </div>
            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${cssIdentifier}-panel-content-wrapper"></div>
        </div>`}postConstruct(){const{component,closable,hideTitleBar,title,minWidth=250,width,minHeight=250,height,centered,popup,x,y}=this.config;this.positionableFeature=new PositionableFeature(this.getGui(),{minWidth,width,minHeight,height,centered,x,y,popup,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const eGui=this.getGui();component&&this.setBodyComponent(component),hideTitleBar?setDisplayed(this.eTitleBar,!1):(title&&this.setTitle(title),this.setClosable(closable??this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",e=>{const eDocument=this.gridOptionsService.getDocument();if(eGui.contains(e.relatedTarget)||eGui.contains(eDocument.activeElement)||this.eTitleBarButtons.contains(e.target)){e.preventDefault();return}const focusEl=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");focusEl&&focusEl.focus()}),!(popup&&this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const eGui=this.getGui();eGui.focus(),this.close=()=>{eGui.parentElement.removeChild(eGui),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(height){this.positionableFeature.setHeight(height)}getWidth(){return this.positionableFeature.getWidth()}setWidth(width){this.positionableFeature.setWidth(width)}setClosable(closable){if(closable!==this.closable&&(this.closable=closable),closable){const closeButtonComp=this.closeButtonComp=new Component(_a192.CLOSE_BTN_TEMPLATE);this.getContext().createBean(closeButtonComp);const eGui=closeButtonComp.getGui(),child=createIconNoSpan("close",this.gridOptionsService);child.classList.add("ag-panel-title-bar-button-icon"),eGui.appendChild(child),this.addTitleBarButton(closeButtonComp),closeButtonComp.addManagedListener(eGui,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const eGui=this.closeButtonComp.getGui();eGui.parentElement.removeChild(eGui),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(bodyComponent){bodyComponent.setParentComponent(this),this.eContentWrapper.appendChild(bodyComponent.getGui())}addTitleBarButton(button,position){const eTitleBarButtons=this.eTitleBarButtons,buttons=eTitleBarButtons.children,len=buttons.length;position==null&&(position=len),position=Math.max(0,Math.min(position,len)),button.addCssClass("ag-panel-title-bar-button");const eGui=button.getGui();position===0?eTitleBarButtons.insertAdjacentElement("afterbegin",eGui):position===len?eTitleBarButtons.insertAdjacentElement("beforeend",eGui):buttons[position-1].insertAdjacentElement("afterend",eGui),button.setParentComponent(this)}getBodyHeight(){return getInnerHeight(this.eContentWrapper)}getBodyWidth(){return getInnerWidth(this.eContentWrapper)}setTitle(title){this.eTitle.innerText=title}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const eGui=this.getGui();eGui&&isVisible(eGui)&&this.close(),super.destroy()}},__name(_a192,"_AgPanel"),_a192);_AgPanel.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>';__decorateClass([RefSelector("eContentWrapper")],_AgPanel.prototype,"eContentWrapper",2);__decorateClass([RefSelector("eTitleBar")],_AgPanel.prototype,"eTitleBar",2);__decorateClass([RefSelector("eTitleBarButtons")],_AgPanel.prototype,"eTitleBarButtons",2);__decorateClass([RefSelector("eTitle")],_AgPanel.prototype,"eTitle",2);__decorateClass([PostConstruct],_AgPanel.prototype,"postConstruct",1);var AgPanel=_AgPanel,_a193,AgDialog=(_a193=class extends AgPanel{constructor(config){super(__spreadProps(__spreadValues({},config),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const eGui=this.getGui(),{movable,resizable,maximizable}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(eGui,"focusin",e=>{this.popupService.bringPopupToFront(eGui)}),movable&&this.setMovable(movable),maximizable&&this.setMaximizable(maximizable),resizable&&this.setResizable(resizable)}renderComponent(){const eGui=this.getGui(),{alwaysOnTop,modal,title,afterGuiAttached}=this.config,translate=this.localeService.getLocaleTextFunc(),addPopupRes=this.popupService.addPopup({modal,eChild:eGui,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop,ariaLabel:title||translate("ariaLabelDialog","Dialog"),afterGuiAttached});addPopupRes&&(this.close=addPopupRes.hideFunc)}onClosed(event){var _a273,_b;this.destroy(),(_b=(_a273=this.config).closedCallback)==null||_b.call(_a273,event)}toggleMaximize(){const position=this.positionableFeature.getPosition();if(this.isMaximized){const{x,y,width,height}=this.lastPosition;this.setWidth(width),this.setHeight(height),this.positionableFeature.offsetElement(x,y)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=position.x,this.lastPosition.y=position.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){setDisplayed(this.maximizeIcon,!this.isMaximized),setDisplayed(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(destroyListener=>destroyListener()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(resizable){this.positionableFeature.setResizable(resizable)}setMovable(movable){this.positionableFeature.setMovable(movable,this.eTitleBar)}setMaximizable(maximizable){if(!maximizable){this.clearMaximizebleListeners(),this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0);return}const eTitleBar=this.eTitleBar;if(!eTitleBar||maximizable===this.isMaximizable)return;const maximizeButtonComp=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),maximizeButtonComp.addManagedListener(maximizeButtonComp.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(maximizeButtonComp,0),this.maximizeListeners.push(this.addManagedListener(eTitleBar,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const maximizeButtonComp=this.maximizeButtonComp=this.createBean(new Component('<div class="ag-dialog-button"></span>')),eGui=maximizeButtonComp.getGui();return this.maximizeIcon=createIconNoSpan("maximize",this.gridOptionsService),eGui.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=createIconNoSpan("minimize",this.gridOptionsService),eGui.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),maximizeButtonComp}},__name(_a193,"AgDialog"),_a193);__decorateClass([Autowired("popupService")],AgDialog.prototype,"popupService",2);var instanceIdSeq=0,_a194,PopupService=(_a194=class extends BeanStub{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridCtrl=p.gridCtrl}),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.handleThemeChange.bind(this))}getPopupParent(){const ePopupParent=this.gridOptionsService.get("popupParent");return ePopupParent||this.gridCtrl.getGui()}positionPopupForMenu(params){const{eventSource,ePopup}=params,popupIdx=this.getPopupIndex(ePopup);if(popupIdx!==-1){const popup=this.popupList[popupIdx];popup.alignedToElement=eventSource}const sourceRect=eventSource.getBoundingClientRect(),parentRect=this.getParentRect(),y=this.keepXYWithinBounds(ePopup,sourceRect.top-parentRect.top,0),minWidth=ePopup.clientWidth>0?ePopup.clientWidth:200;ePopup.style.minWidth=`${minWidth}px`;const maxX=parentRect.right-parentRect.left-minWidth;let x;this.gridOptionsService.get("enableRtl")?(x=xLeftPosition(),x<0&&(x=xRightPosition(),this.setAlignedStyles(ePopup,"left")),x>maxX&&(x=0,this.setAlignedStyles(ePopup,"right"))):(x=xRightPosition(),x>maxX&&(x=xLeftPosition(),this.setAlignedStyles(ePopup,"right")),x<0&&(x=0,this.setAlignedStyles(ePopup,"left"))),ePopup.style.left=`${x}px`,ePopup.style.top=`${y}px`;function xRightPosition(){return sourceRect.right-parentRect.left-2}__name(xRightPosition,"xRightPosition");function xLeftPosition(){return sourceRect.left-parentRect.left-minWidth}__name(xLeftPosition,"xLeftPosition")}positionPopupUnderMouseEvent(params){const{ePopup,nudgeX,nudgeY,skipObserver}=params;this.positionPopup({ePopup,nudgeX,nudgeY,keepWithinBounds:!0,skipObserver,updatePosition:()=>this.calculatePointerAlign(params.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(params.type,params.ePopup,null,params.mouseEvent,params.column,params.rowNode)})}calculatePointerAlign(e){const parentRect=this.getParentRect();return{x:e.clientX-parentRect.left,y:e.clientY-parentRect.top}}positionPopupByComponent(params){const{ePopup,nudgeX,nudgeY,keepWithinBounds,eventSource,alignSide="left",position="over",column,rowNode,type}=params,sourceRect=eventSource.getBoundingClientRect(),parentRect=this.getParentRect(),popupIdx=this.getPopupIndex(ePopup);if(popupIdx!==-1){const popup=this.popupList[popupIdx];popup.alignedToElement=eventSource}const updatePosition=__name(()=>{let x=sourceRect.left-parentRect.left;alignSide==="right"&&(x-=ePopup.offsetWidth-sourceRect.width);let y;return position==="over"?(y=sourceRect.top-parentRect.top,this.setAlignedStyles(ePopup,"over")):(this.setAlignedStyles(ePopup,"under"),this.shouldRenderUnderOrAbove(ePopup,sourceRect,parentRect,params.nudgeY||0)==="under"?y=sourceRect.top-parentRect.top+sourceRect.height:y=sourceRect.top-ePopup.offsetHeight-(nudgeY||0)*2-parentRect.top),{x,y}},"updatePosition");this.positionPopup({ePopup,nudgeX,nudgeY,keepWithinBounds,updatePosition,postProcessCallback:()=>this.callPostProcessPopup(type,ePopup,eventSource,null,column,rowNode)})}shouldRenderUnderOrAbove(ePopup,targetCompRect,parentRect,nudgeY){const spaceAvailableUnder=parentRect.bottom-targetCompRect.bottom,spaceAvailableAbove=targetCompRect.top-parentRect.top,spaceRequired=ePopup.offsetHeight+nudgeY;return spaceAvailableUnder>spaceRequired?"under":spaceAvailableAbove>spaceRequired||spaceAvailableAbove>spaceAvailableUnder?"above":"under"}setAlignedStyles(ePopup,positioned){const popupIdx=this.getPopupIndex(ePopup);if(popupIdx===-1)return;const popup=this.popupList[popupIdx],{alignedToElement}=popup;!alignedToElement||(["right","left","over","above","under"].forEach(position=>{alignedToElement.classList.remove(`ag-has-popup-positioned-${position}`),ePopup.classList.remove(`ag-popup-positioned-${position}`)}),!positioned)||(alignedToElement.classList.add(`ag-has-popup-positioned-${positioned}`),ePopup.classList.add(`ag-popup-positioned-${positioned}`))}callPostProcessPopup(type,ePopup,eventSource,mouseEvent,column,rowNode){const callback=this.gridOptionsService.getCallback("postProcessPopup");callback&&callback({column,rowNode,ePopup,type,eventSource,mouseEvent})}positionPopup(params){const{ePopup,keepWithinBounds,nudgeX,nudgeY,skipObserver,updatePosition}=params,lastSize={width:0,height:0},updatePopupPosition=__name((fromResizeObserver=!1)=>{let{x,y}=updatePosition();fromResizeObserver&&ePopup.clientWidth===lastSize.width&&ePopup.clientHeight===lastSize.height||(lastSize.width=ePopup.clientWidth,lastSize.height=ePopup.clientHeight,nudgeX&&(x+=nudgeX),nudgeY&&(y+=nudgeY),keepWithinBounds&&(x=this.keepXYWithinBounds(ePopup,x,1),y=this.keepXYWithinBounds(ePopup,y,0)),ePopup.style.left=`${x}px`,ePopup.style.top=`${y}px`,params.postProcessCallback&&params.postProcessCallback())},"updatePopupPosition");if(updatePopupPosition(),!skipObserver){const resizeObserverDestroyFunc=this.resizeObserverService.observeResize(ePopup,()=>updatePopupPosition(!0));setTimeout(()=>resizeObserverDestroyFunc(),PopupService.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(popup=>popup.element)}getPopupList(){return this.popupList}getParentRect(){const eDocument=this.gridOptionsService.getDocument();let popupParent=this.getPopupParent();return popupParent===eDocument.body?popupParent=eDocument.documentElement:getComputedStyle(popupParent).position==="static"&&(popupParent=popupParent.offsetParent),getElementRectWithOffset(popupParent)}keepXYWithinBounds(ePopup,position,direction){const isVertical=direction===0,sizeProperty=isVertical?"clientHeight":"clientWidth",anchorProperty=isVertical?"top":"left",offsetProperty=isVertical?"offsetHeight":"offsetWidth",scrollPositionProperty=isVertical?"scrollTop":"scrollLeft",eDocument=this.gridOptionsService.getDocument(),docElement=eDocument.documentElement,popupParent=this.getPopupParent(),parentRect=popupParent.getBoundingClientRect(),documentRect=eDocument.documentElement.getBoundingClientRect(),isBody=popupParent===eDocument.body,offsetSize=ePopup[offsetProperty];let sizeOfParent=isBody?(isVertical?getAbsoluteHeight:getAbsoluteWidth)(docElement)+docElement[scrollPositionProperty]:popupParent[sizeProperty];isBody&&(sizeOfParent-=Math.abs(documentRect[anchorProperty]-parentRect[anchorProperty]));const max=sizeOfParent-offsetSize;return Math.min(Math.max(position,0),Math.abs(max))}addPopup(params){const eDocument=this.gridOptionsService.getDocument(),{eChild,ariaLabel,alwaysOnTop,positionCallback,anchorToElement}=params;if(!eDocument)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const pos=this.getPopupIndex(eChild);if(pos!==-1)return{hideFunc:this.popupList[pos].hideFunc};this.initialisePopupPosition(eChild);const wrapperEl=this.createPopupWrapper(eChild,ariaLabel,!!alwaysOnTop),removeListeners=this.addEventListenersToPopup(__spreadProps(__spreadValues({},params),{wrapperEl}));return positionCallback&&positionCallback(),this.addPopupToPopupList(eChild,wrapperEl,removeListeners,anchorToElement),{hideFunc:removeListeners}}initialisePopupPosition(element){const ePopupParentRect=this.getPopupParent().getBoundingClientRect();exists(element.style.top)||(element.style.top=`${ePopupParentRect.top*-1}px`),exists(element.style.left)||(element.style.left=`${ePopupParentRect.left*-1}px`)}createPopupWrapper(element,ariaLabel,alwaysOnTop){const ePopupParent=this.getPopupParent(),eWrapper=document.createElement("div"),{allThemes}=this.environment.getTheme();return allThemes.length&&eWrapper.classList.add(...allThemes),eWrapper.classList.add("ag-popup"),element.classList.add(this.gridOptionsService.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),element.hasAttribute("role")||setAriaRole(element,"dialog"),setAriaLabel(element,ariaLabel),eWrapper.appendChild(element),ePopupParent.appendChild(eWrapper),alwaysOnTop?this.setAlwaysOnTop(element,!0):this.bringPopupToFront(element),eWrapper}handleThemeChange(){const{allThemes}=this.environment.getTheme();for(const popup of this.popupList){for(const className of Array.from(popup.wrapper.classList))className.startsWith("ag-theme-")&&popup.wrapper.classList.remove(className);allThemes.length&&popup.wrapper.classList.add(...allThemes)}}addEventListenersToPopup(params){const eDocument=this.gridOptionsService.getDocument(),ePopupParent=this.getPopupParent(),{wrapperEl,eChild:popupEl,click:pointerEvent,closedCallback,afterGuiAttached,closeOnEsc,modal}=params;let popupHidden=!1;const hidePopupOnKeyboardEvent=__name(event=>{if(!wrapperEl.contains(eDocument.activeElement))return;event.key===KeyCode.ESCAPE&&!isStopPropagationForAgGrid(event)&&removeListeners({keyboardEvent:event})},"hidePopupOnKeyboardEvent"),hidePopupOnMouseEvent=__name(event=>removeListeners({mouseEvent:event}),"hidePopupOnMouseEvent"),hidePopupOnTouchEvent=__name(event=>removeListeners({touchEvent:event}),"hidePopupOnTouchEvent"),removeListeners=__name((popupParams={})=>{const{mouseEvent,touchEvent,keyboardEvent}=popupParams;this.isEventFromCurrentPopup({mouseEvent,touchEvent},popupEl)||popupHidden||(popupHidden=!0,ePopupParent.removeChild(wrapperEl),eDocument.removeEventListener("keydown",hidePopupOnKeyboardEvent),eDocument.removeEventListener("mousedown",hidePopupOnMouseEvent),eDocument.removeEventListener("touchstart",hidePopupOnTouchEvent),eDocument.removeEventListener("contextmenu",hidePopupOnMouseEvent),this.eventService.removeEventListener(Events.EVENT_DRAG_STARTED,hidePopupOnMouseEvent),closedCallback&&closedCallback(mouseEvent||touchEvent||keyboardEvent),this.removePopupFromPopupList(popupEl))},"removeListeners");return afterGuiAttached&&afterGuiAttached({hidePopup:removeListeners}),window.setTimeout(()=>{closeOnEsc&&eDocument.addEventListener("keydown",hidePopupOnKeyboardEvent),modal&&(eDocument.addEventListener("mousedown",hidePopupOnMouseEvent),this.eventService.addEventListener(Events.EVENT_DRAG_STARTED,hidePopupOnMouseEvent),eDocument.addEventListener("touchstart",hidePopupOnTouchEvent),eDocument.addEventListener("contextmenu",hidePopupOnMouseEvent))},0),removeListeners}addPopupToPopupList(element,wrapperEl,removeListeners,anchorToElement){this.popupList.push({element,wrapper:wrapperEl,hideFunc:removeListeners,instanceId:instanceIdSeq++,isAnchored:!!anchorToElement}),anchorToElement&&this.setPopupPositionRelatedToElement(element,anchorToElement)}getPopupIndex(el){return this.popupList.findIndex(p=>p.element===el)}setPopupPositionRelatedToElement(popupEl,relativeElement){const popupIndex=this.getPopupIndex(popupEl);if(popupIndex===-1)return;const popup=this.popupList[popupIndex];if(popup.stopAnchoringPromise&&popup.stopAnchoringPromise.then(destroyFunc=>destroyFunc&&destroyFunc()),popup.stopAnchoringPromise=void 0,popup.isAnchored=!1,!relativeElement)return;const destroyPositionTracker=this.keepPopupPositionedRelativeTo({element:relativeElement,ePopup:popupEl,hidePopup:popup.hideFunc});return popup.stopAnchoringPromise=destroyPositionTracker,popup.isAnchored=!0,destroyPositionTracker}removePopupFromPopupList(element){this.setAlignedStyles(element,null),this.setPopupPositionRelatedToElement(element,null),this.popupList=this.popupList.filter(p=>p.element!==element)}keepPopupPositionedRelativeTo(params){const eParent=this.getPopupParent(),parentRect=eParent.getBoundingClientRect(),{element,ePopup}=params,sourceRect=element.getBoundingClientRect(),initialDiffTop=parentRect.top-sourceRect.top,initialDiffLeft=parentRect.left-sourceRect.left;let lastDiffTop=initialDiffTop,lastDiffLeft=initialDiffLeft;const topPx=ePopup.style.top,top=parseInt(topPx.substring(0,topPx.length-1),10),leftPx=ePopup.style.left,left=parseInt(leftPx.substring(0,leftPx.length-1),10);return new AgPromise(resolve=>{this.getFrameworkOverrides().setInterval(()=>{const pRect=eParent.getBoundingClientRect(),sRect=element.getBoundingClientRect();if(sRect.top==0&&sRect.left==0&&sRect.height==0&&sRect.width==0){params.hidePopup();return}const currentDiffTop=pRect.top-sRect.top;if(currentDiffTop!=lastDiffTop){const newTop=this.keepXYWithinBounds(ePopup,top+initialDiffTop-currentDiffTop,0);ePopup.style.top=`${newTop}px`}lastDiffTop=currentDiffTop;const currentDiffLeft=pRect.left-sRect.left;if(currentDiffLeft!=lastDiffLeft){const newLeft=this.keepXYWithinBounds(ePopup,left+initialDiffLeft-currentDiffLeft,1);ePopup.style.left=`${newLeft}px`}lastDiffLeft=currentDiffLeft},200).then(intervalId=>{resolve(__name(()=>{intervalId!=null&&window.clearInterval(intervalId)},"result"))})})}hasAnchoredPopup(){return this.popupList.some(popup=>popup.isAnchored)}isEventFromCurrentPopup(params,target){const{mouseEvent,touchEvent}=params,event=mouseEvent||touchEvent;if(!event)return!1;const indexOfThisChild=this.getPopupIndex(target);if(indexOfThisChild===-1)return!1;for(let i=indexOfThisChild;i<this.popupList.length;i++){const popup=this.popupList[i];if(isElementInEventPath(popup.element,event))return!0}return this.isElementWithinCustomPopup(event.target)}isElementWithinCustomPopup(el){const eDocument=this.gridOptionsService.getDocument();for(;el&&el!==eDocument.body;){if(el.classList.contains("ag-custom-component-popup")||el.parentElement===null)return!0;el=el.parentElement}return!1}getWrapper(ePopup){for(;!ePopup.classList.contains("ag-popup")&&ePopup.parentElement;)ePopup=ePopup.parentElement;return ePopup.classList.contains("ag-popup")?ePopup:null}setAlwaysOnTop(ePopup,alwaysOnTop){const eWrapper=this.getWrapper(ePopup);eWrapper&&(eWrapper.classList.toggle("ag-always-on-top",!!alwaysOnTop),alwaysOnTop&&this.bringPopupToFront(eWrapper))}bringPopupToFront(ePopup){const parent=this.getPopupParent(),popupList=Array.prototype.slice.call(parent.querySelectorAll(".ag-popup")),popupLen=popupList.length,alwaysOnTopList=Array.prototype.slice.call(parent.querySelectorAll(".ag-popup.ag-always-on-top")),onTopLength=alwaysOnTopList.length,eWrapper=this.getWrapper(ePopup);if(!eWrapper||popupLen<=1||!parent.contains(ePopup))return;const pos=popupList.indexOf(eWrapper),innerEls=eWrapper.querySelectorAll("div"),innerElsScrollMap=[];for(innerEls.forEach(el=>{el.scrollTop!==0&&innerElsScrollMap.push([el,el.scrollTop])}),onTopLength?eWrapper.classList.contains("ag-always-on-top")?pos!==popupLen-1&&last(alwaysOnTopList).insertAdjacentElement("afterend",eWrapper):pos!==popupLen-onTopLength-1&&alwaysOnTopList[0].insertAdjacentElement("beforebegin",eWrapper):pos!==popupLen-1&&last(popupList).insertAdjacentElement("afterend",eWrapper);innerElsScrollMap.length;){const currentEl=innerElsScrollMap.pop();currentEl[0].scrollTop=currentEl[1]}}},__name(_a194,"PopupService"),_a194);PopupService.WAIT_FOR_POPUP_CONTENT_RESIZE=200;__decorateClass([Autowired("focusService")],PopupService.prototype,"focusService",2);__decorateClass([Autowired("ctrlsService")],PopupService.prototype,"ctrlsService",2);__decorateClass([Autowired("resizeObserverService")],PopupService.prototype,"resizeObserverService",2);__decorateClass([PostConstruct],PopupService.prototype,"postConstruct",1);PopupService=__decorateClass([Bean("popupService")],PopupService);var _a195,AgAutocompleteRow=(_a195=class extends Component{constructor(){super(`
        <div class="ag-autocomplete-row" role="presentation">
            <div class="ag-autocomplete-row-label"></div>
        </div>`),this.hasHighlighting=!1}setState(value,selected){this.value=value,this.render(),this.updateSelected(selected)}updateSelected(selected){this.addOrRemoveCssClass("ag-autocomplete-row-selected",selected)}setSearchString(searchString){var _a273;let keepHighlighting=!1;if(exists(searchString)){const index=(_a273=this.value)==null?void 0:_a273.toLocaleLowerCase().indexOf(searchString.toLocaleLowerCase());if(index>=0){keepHighlighting=!0,this.hasHighlighting=!0;const highlightEndIndex=index+searchString.length,startPart=escapeString(this.value.slice(0,index)),highlightedPart=escapeString(this.value.slice(index,highlightEndIndex)),endPart=escapeString(this.value.slice(highlightEndIndex));this.getGui().lastElementChild.innerHTML=`${startPart}<b>${highlightedPart}</b>${endPart}`}}!keepHighlighting&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())}render(){var _a273;this.getGui().lastElementChild.innerHTML=(_a273=escapeString(this.value))!=null?_a273:"&nbsp;"}},__name(_a195,"AgAutocompleteRow"),_a195),_a196,_AgAutocompleteList=(_a196=class extends PopupComponent{constructor(params){super(_a196.TEMPLATE),this.params=params,this.searchString=""}destroy(){super.destroy()}init(){this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new VirtualList({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.autocompleteEntries.length,getRow:index=>this.autocompleteEntries[index]});const virtualListGui=this.virtualList.getGui();this.addManagedListener(virtualListGui,"click",()=>this.params.onConfirmed()),this.addManagedListener(virtualListGui,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(virtualListGui,"mousedown",e=>e.preventDefault()),this.setSelectedValue(0)}onNavigationKeyDown(event,key){event.preventDefault();const oldIndex=this.autocompleteEntries.indexOf(this.selectedValue),newIndex=key===KeyCode.UP?oldIndex-1:oldIndex+1;this.checkSetSelectedValue(newIndex)}setSearch(searchString){this.searchString=searchString,exists(searchString)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()}runContainsSearch(searchString,searchStrings){let topMatch,topMatchStartsWithSearchString=!1;const lowerCaseSearchString=searchString.toLocaleLowerCase(),allMatches=searchStrings.filter(string=>{const index=string.toLocaleLowerCase().indexOf(lowerCaseSearchString),startsWithSearchString=index===0,isMatch=index>=0;return isMatch&&(!topMatch||!topMatchStartsWithSearchString&&startsWithSearchString||topMatchStartsWithSearchString===startsWithSearchString&&string.length<topMatch.length)&&(topMatch=string,topMatchStartsWithSearchString=startsWithSearchString),isMatch});return!topMatch&&allMatches.length&&(topMatch=allMatches[0]),{topMatch,allMatches}}runSearch(){var _a273,_b;const{autocompleteEntries}=this.params,searchStrings=autocompleteEntries.map(v=>{var _a274;return(_a274=v.displayValue)!=null?_a274:v.key});let matchingStrings,topSuggestion;if(this.params.useFuzzySearch)matchingStrings=fuzzySuggestions(this.searchString,searchStrings,!0).values,topSuggestion=matchingStrings.length?matchingStrings[0]:void 0;else{const containsMatches=this.runContainsSearch(this.searchString,searchStrings);matchingStrings=containsMatches.allMatches,topSuggestion=containsMatches.topMatch}let filteredEntries=autocompleteEntries.filter(({key,displayValue})=>matchingStrings.includes(displayValue??key));if(!filteredEntries.length&&this.selectedValue&&((_b=(_a273=this.params)==null?void 0:_a273.forceLastSelection)!=null&&_b.call(_a273,this.selectedValue,this.searchString))&&(filteredEntries=[this.selectedValue]),this.autocompleteEntries=filteredEntries,this.virtualList.refresh(),!topSuggestion)return;const topSuggestionIndex=matchingStrings.indexOf(topSuggestion);this.checkSetSelectedValue(topSuggestionIndex)}updateSearchInList(){this.virtualList.forEachRenderedRow(row=>row.setSearchString(this.searchString))}checkSetSelectedValue(index){index>=0&&index<this.autocompleteEntries.length&&this.setSelectedValue(index)}setSelectedValue(index){const value=this.autocompleteEntries[index];this.selectedValue!==value&&(this.selectedValue=value,this.virtualList.ensureIndexVisible(index),this.virtualList.forEachRenderedRow((cmp,idx)=>{cmp.updateSelected(index===idx)}))}createRowComponent(value){var _a273;const row=new AgAutocompleteRow;return this.getContext().createBean(row),row.setState((_a273=value.displayValue)!=null?_a273:value.key,value===this.selectedValue),row}onMouseMove(mouseEvent){const rect=this.virtualList.getGui().getBoundingClientRect(),scrollTop=this.virtualList.getScrollTop(),mouseY=mouseEvent.clientY-rect.top+scrollTop,row=Math.floor(mouseY/this.virtualList.getRowHeight());this.checkSetSelectedValue(row)}afterGuiAttached(){this.virtualList.refresh()}getSelectedValue(){var _a273;return this.autocompleteEntries.length&&(_a273=this.selectedValue)!=null?_a273:null}},__name(_a196,"_AgAutocompleteList"),_a196);_AgAutocompleteList.TEMPLATE=`<div class="ag-autocomplete-list-popup">
            <div ref="eList" class="ag-autocomplete-list"></div>
        <div>`;__decorateClass([RefSelector("eList")],_AgAutocompleteList.prototype,"eList",2);__decorateClass([PostConstruct],_AgAutocompleteList.prototype,"init",1);var AgAutocompleteList=_AgAutocompleteList,_a197,_AgAutocomplete=(_a197=class extends Component{constructor(){super(`
            <div class="ag-autocomplete" role="presentation">
                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>
            </div>`),this.isListOpen=!1,this.lastPosition=0,this.valid=!0}postConstruct(){this.eAutocompleteInput.onValueChange(value=>this.onValueChanged(value)),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc(()=>{this.destroyBean(this.autocompleteList)}),this.addGuiEventListener("focusout",()=>this.onFocusOut())}onValueChanged(value){const parsedValue=makeNull(value);this.updateValue(parsedValue),this.updateAutocompleteList(parsedValue)}updateValue(value){this.updateLastPosition(),this.dispatchEvent({type:_a197.EVENT_VALUE_CHANGED,value}),this.validate(value)}updateAutocompleteList(value){var _a273,_b,_c,_d;const autocompleteListParams=(_b=(_a273=this.listGenerator)==null?void 0:_a273.call(this,value,this.lastPosition))!=null?_b:{enabled:!1};if((!autocompleteListParams.type||autocompleteListParams.type!==((_c=this.autocompleteListParams)==null?void 0:_c.type))&&this.isListOpen&&this.closeList(),this.autocompleteListParams=autocompleteListParams,(_d=this.autocompleteListParams)!=null&&_d.enabled){this.isListOpen||this.openList();const{searchString}=this.autocompleteListParams;this.autocompleteList.setSearch(searchString??"")}else this.isListOpen&&this.closeList()}onKeyDown(event){const key=event.key;switch(this.updateLastPosition(),key){case KeyCode.ENTER:this.onEnterKeyDown(event);break;case KeyCode.TAB:this.onTabKeyDown(event);break;case KeyCode.DOWN:case KeyCode.UP:this.onUpDownKeyDown(event,key);break;case KeyCode.LEFT:case KeyCode.RIGHT:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:setTimeout(()=>{this.updatePositionAndList()});break;case KeyCode.ESCAPE:this.onEscapeKeyDown(event);break;case KeyCode.SPACE:event.ctrlKey&&!this.isListOpen&&(event.preventDefault(),this.forceOpenList());break}}confirmSelection(){var _a273;const selectedValue=(_a273=this.autocompleteList)==null?void 0:_a273.getSelectedValue();selectedValue&&(this.closeList(),this.dispatchEvent({type:_a197.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:selectedValue,autocompleteType:this.autocompleteListParams.type}))}onTabKeyDown(event){this.isListOpen&&(event.preventDefault(),event.stopPropagation(),this.confirmSelection())}onEnterKeyDown(event){event.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()}onUpDownKeyDown(event,key){var _a273;event.preventDefault(),this.isListOpen?(_a273=this.autocompleteList)==null||_a273.onNavigationKeyDown(event,key):this.forceOpenList()}onEscapeKeyDown(event){this.isListOpen&&(event.preventDefault(),event.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))}onFocusOut(){this.isListOpen&&this.closeList()}updatePositionAndList(){var _a273;this.updateLastPosition(),this.updateAutocompleteList((_a273=this.eAutocompleteInput.getValue())!=null?_a273:null)}setCaret(position,setFocus){const eDocument=this.gridOptionsService.getDocument();setFocus&&eDocument.activeElement===eDocument.body&&this.eAutocompleteInput.getFocusableElement().focus();const eInput=this.eAutocompleteInput.getInputElement();eInput.setSelectionRange(position,position),position===eInput.value.length&&(eInput.scrollLeft=eInput.scrollWidth)}forceOpenList(){this.onValueChanged(this.eAutocompleteInput.getValue())}updateLastPosition(){var _a273;this.lastPosition=(_a273=this.eAutocompleteInput.getInputElement().selectionStart)!=null?_a273:0}validate(value){var _a273;this.validator&&(this.validationMessage=this.validator(value),this.eAutocompleteInput.getInputElement().setCustomValidity((_a273=this.validationMessage)!=null?_a273:""),this.valid=!this.validationMessage,this.dispatchEvent({type:_a197.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))}openList(){this.isListOpen=!0,this.autocompleteList=this.createBean(new AgAutocompleteList({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:()=>this.confirmSelection(),forceLastSelection:this.forceLastSelection}));const ePopupGui=this.autocompleteList.getGui(),positionParams={ePopup:ePopupGui,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gridOptionsService.get("enableRtl")?"right":"left",keepWithinBounds:!0},addPopupRes=this.popupService.addPopup({eChild:ePopupGui,anchorToElement:this.getGui(),positionCallback:()=>this.popupService.positionPopupByComponent(positionParams),ariaLabel:this.listAriaLabel});this.hidePopup=addPopupRes.hideFunc,this.autocompleteList.afterGuiAttached()}closeList(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null}onCompleted(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:_a197.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})}getValue(){return makeNull(this.eAutocompleteInput.getValue())}setInputPlaceholder(placeholder){return this.eAutocompleteInput.setInputPlaceholder(placeholder),this}setInputAriaLabel(label){return this.eAutocompleteInput.setInputAriaLabel(label),this}setListAriaLabel(label){return this.listAriaLabel=label,this}setListGenerator(listGenerator){return this.listGenerator=listGenerator,this}setValidator(validator){return this.validator=validator,this}isValid(){return this.valid}setValue(params){const{value,position,silent,updateListOnlyIfOpen,restoreFocus}=params;this.eAutocompleteInput.setValue(value,!0),this.setCaret(position??this.lastPosition,restoreFocus),silent||this.updateValue(value),(!updateListOnlyIfOpen||this.isListOpen)&&this.updateAutocompleteList(value)}setForceLastSelection(forceLastSelection){return this.forceLastSelection=forceLastSelection,this}setInputDisabled(disabled){return this.eAutocompleteInput.setDisabled(disabled),this}},__name(_a197,"_AgAutocomplete"),_a197);_AgAutocomplete.EVENT_VALUE_CHANGED="eventValueChanged";_AgAutocomplete.EVENT_VALUE_CONFIRMED="eventValueConfirmed";_AgAutocomplete.EVENT_OPTION_SELECTED="eventOptionSelected";_AgAutocomplete.EVENT_VALID_CHANGED="eventValidChanged";__decorateClass([Autowired("popupService")],_AgAutocomplete.prototype,"popupService",2);__decorateClass([RefSelector("eAutocompleteInput")],_AgAutocomplete.prototype,"eAutocompleteInput",2);__decorateClass([PostConstruct],_AgAutocomplete.prototype,"postConstruct",1);var AgAutocomplete=_AgAutocomplete,_a198,_PillDragComp=(_a198=class extends Component{constructor(dragSourceDropTarget,ghost,horizontal,template){super(),this.dragSourceDropTarget=dragSourceDropTarget,this.ghost=ghost,this.horizontal=horizontal,this.template=template}init(){var _a273;this.setTemplate((_a273=this.template)!=null?_a273:_a198.TEMPLATE);const eGui=this.getGui();this.addElementClasses(eGui),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(createIconNoSpan("columnDrag",this.gridOptionsService)),this.eButton.appendChild(createIconNoSpan("cancel",this.gridOptionsService)),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const translate=this.localeService.getLocaleTextFunc(),ariaInstructions=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(ariaInstructions,translate),setAriaLabel(this.getGui(),ariaInstructions.join(". "))}addAdditionalAriaInstructions(ariaInstructions,translate){if(this.isRemovable()){const deleteAria=translate("ariaDropZoneColumnComponentDescription","Press DELETE to remove");ariaInstructions.push(deleteAria)}}setupTooltip(){const refresh=__name(()=>{const newTooltipText=this.getTooltip();this.setTooltip({newTooltipText})},"refresh");refresh(),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,refresh)}getDragSourceId(){}getDefaultIconName(){return DragAndDropService.ICON_NOT_ALLOWED}addDragSource(){const{dragAndDropService,eDragHandle}=this,getDragItem=this.createGetDragItem(),defaultIconName=this.getDefaultIconName(),dragSource={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:eDragHandle,getDefaultIconName:()=>defaultIconName,getDragItem,dragItemName:this.getDisplayName()};dragAndDropService.addDragSource(dragSource,!0),this.addDestroyFunc(()=>dragAndDropService.removeDragSource(dragSource))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){setDisplayed(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const agEvent={type:_a198.EVENT_COLUMN_REMOVE};this.addGuiEventListener("keydown",e=>this.onKeyDown(e)),this.addManagedListener(this.eButton,"click",mouseEvent=>{this.dispatchEvent(agEvent),mouseEvent.stopPropagation()});const touchListener=new TouchListener(this.eButton);this.addManagedListener(touchListener,TouchListener.EVENT_TAP,()=>{this.dispatchEvent(agEvent)}),this.addDestroyFunc(touchListener.destroy.bind(touchListener))}onKeyDown(e){e.key===KeyCode.DELETE&&this.isRemovable()&&(e.preventDefault(),this.dispatchEvent({type:_a198.EVENT_COLUMN_REMOVE}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const displayValue=this.getDisplayValue(),displayValueSanitised=escapeString(displayValue);this.eText.innerHTML=displayValueSanitised}addElementClasses(el,suffix){suffix=suffix?`-${suffix}`:"";const direction=this.horizontal?"horizontal":"vertical";el.classList.add(`ag-column-drop-cell${suffix}`,`ag-column-drop-${direction}-cell${suffix}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}},__name(_a198,"_PillDragComp"),_a198);_PillDragComp.EVENT_COLUMN_REMOVE="columnRemove";_PillDragComp.TEMPLATE=`<span role="option">
          <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>
          <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>
          <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>
        </span>`;__decorateClass([Autowired("dragAndDropService")],_PillDragComp.prototype,"dragAndDropService",2);__decorateClass([RefSelector("eText")],_PillDragComp.prototype,"eText",2);__decorateClass([RefSelector("eDragHandle")],_PillDragComp.prototype,"eDragHandle",2);__decorateClass([RefSelector("eButton")],_PillDragComp.prototype,"eButton",2);__decorateClass([PostConstruct],_PillDragComp.prototype,"init",1);var PillDragComp=_PillDragComp,_a199,_PillDropZonePanel=(_a199=class extends Component{constructor(horizontal){super('<div class="ag-unselectable" role="presentation"></div>'),this.horizontal=horizontal,this.state=_a199.STATE_NOT_DRAGGING,this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=document.createElement("div"),this.addElementClasses(this.ePillDropList,"list"),setAriaRole(this.ePillDropList,"listbox")}isHorizontal(){return this.horizontal}toggleResizable(resizable){this.positionableFeature.setResizable(resizable?{bottom:!0}:!1),this.resizeEnabled=resizable}isSourceEventFromTarget(draggingEvent){const{dropZoneTarget,dragSource}=draggingEvent;return dropZoneTarget.contains(dragSource.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(func=>func()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,clearElement(this.getGui()),clearElement(this.ePillDropList)}init(params){this.params=params??{},this.createManagedBean(new ManagedFocusFeature(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new PositionableFeature(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),setAriaLabel(this.ePillDropList,this.getAriaLabel())}handleKeyDown(e){const isVertical=!this.horizontal;let isNext=e.key===KeyCode.DOWN,isPrevious=e.key===KeyCode.UP;if(!isVertical){const isRtl=this.gridOptionsService.get("enableRtl");isNext=!isRtl&&e.key===KeyCode.RIGHT||isRtl&&e.key===KeyCode.LEFT,isPrevious=!isRtl&&e.key===KeyCode.LEFT||isRtl&&e.key===KeyCode.RIGHT}if(!isNext&&!isPrevious)return;const el=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,isPrevious);el&&(e.preventDefault(),el.focus())}addElementClasses(el,suffix){suffix=suffix?`-${suffix}`:"";const direction=this.horizontal?"horizontal":"vertical";el.classList.add(`ag-column-drop${suffix}`,`ag-column-drop-${direction}${suffix}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.dragAndDropService.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(draggingEvent){const newIndex=this.getNewInsertIndex(draggingEvent);if(newIndex<0)return!1;const minimumAllowedIndex=this.minimumAllowedNewInsertIndex(),newAdjustedIndex=Math.max(minimumAllowedIndex,newIndex),changed=newAdjustedIndex!==this.insertIndex;return changed&&(this.insertIndex=newAdjustedIndex),changed}getNewInsertIndex(draggingEvent){const mouseEvent=draggingEvent.event,mouseLocation=this.horizontal?mouseEvent.clientX:mouseEvent.clientY,boundsList=this.childPillComponents.map(comp=>comp.getGui().getBoundingClientRect()),hoveredIndex=boundsList.findIndex(rect=>this.horizontal?rect.right>mouseLocation&&rect.left<mouseLocation:rect.top<mouseLocation&&rect.bottom>mouseLocation);if(hoveredIndex===-1){const enableRtl=this.gridOptionsService.get("enableRtl");return boundsList.every(rect=>mouseLocation>(this.horizontal?rect.right:rect.bottom))?enableRtl&&this.horizontal?0:this.childPillComponents.length:boundsList.every(rect=>mouseLocation<(this.horizontal?rect.left:rect.top))?enableRtl&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=hoveredIndex?hoveredIndex+1:hoveredIndex}checkDragStartedBySelf(draggingEvent){this.state===_a199.STATE_NOT_DRAGGING&&(this.state=_a199.STATE_REARRANGE_ITEMS,this.potentialDndItems=this.getItems(draggingEvent.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(draggingEvent),this.refreshGui())}onDragging(draggingEvent){this.checkDragStartedBySelf(draggingEvent),this.checkInsertIndex(draggingEvent)&&this.refreshGui()}handleDragEnterEnd(draggingEvent){}onDragEnter(draggingEvent){const dragItems=this.getItems(draggingEvent.dragSource.getDragItem());this.state=_a199.STATE_NEW_ITEMS_IN;const goodDragItems=dragItems.filter(item=>this.isItemDroppable(item,draggingEvent)),alreadyPresent=goodDragItems.every(item=>this.childPillComponents.map(cmp=>cmp.getItem()).indexOf(item)!==-1);if(goodDragItems.length!==0){if(this.potentialDndItems=goodDragItems,alreadyPresent){this.state=_a199.STATE_NOT_DRAGGING;return}this.handleDragEnterEnd(draggingEvent),this.checkInsertIndex(draggingEvent),this.refreshGui()}}isPotentialDndItems(){return existsAndNotEmpty(this.potentialDndItems)}handleDragLeaveEnd(draggingEvent){}onDragLeave(draggingEvent){if(this.state===_a199.STATE_REARRANGE_ITEMS){const items=this.getItems(draggingEvent.dragSource.getDragItem());this.removeItems(items)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(draggingEvent),this.potentialDndItems=[],this.refreshGui()),this.state=_a199.STATE_NOT_DRAGGING}refreshOnDragStop(){return!0}onDragStop(){if(this.isPotentialDndItems()){let success=!1;this.state===_a199.STATE_NEW_ITEMS_IN?(this.addItems(this.potentialDndItems),success=!0):success=this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],(this.refreshOnDragStop()||!success)&&this.refreshGui()}this.state=_a199.STATE_NOT_DRAGGING}removeItems(itemsToRemove){const newItemList=this.getExistingItems().filter(item=>!includes(itemsToRemove,item));this.updateItems(newItemList)}addItems(itemsToAdd){if(!itemsToAdd)return;const newItemList=this.getExistingItems().slice(),itemsToAddNoDuplicates=itemsToAdd.filter(item=>newItemList.indexOf(item)<0);insertArrayIntoArray(newItemList,itemsToAddNoDuplicates,this.insertIndex),this.updateItems(newItemList)}addItem(item){this.insertIndex=this.getExistingItems().length,this.addItems([item]),this.refreshGui()}rearrangeItems(itemsToAdd){const newItemList=this.getNonGhostItems().slice();return insertArrayIntoArray(newItemList,itemsToAdd,this.insertIndex),areEqual(newItemList,this.getExistingItems())?!1:(this.updateItems(newItemList),!0)}refreshGui(){const scrollTop=this.ePillDropList.scrollTop,resizeEnabled=this.resizeEnabled,focusedIndex=this.getFocusedItem();let alternateElement=this.focusService.findNextFocusableElement();alternateElement||(alternateElement=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),this.isHorizontal()||(this.ePillDropList.scrollTop=scrollTop),resizeEnabled&&this.toggleResizable(resizeEnabled),this.focusService.isKeyboardMode()&&this.restoreFocus(focusedIndex,alternateElement)}getFocusedItem(){const eGui=this.getGui(),activeElement=this.gridOptionsService.getDocument().activeElement;return eGui.contains(activeElement)?Array.from(eGui.querySelectorAll(".ag-column-drop-cell")).indexOf(activeElement):-1}restoreFocus(index,alternateElement){const eGui=this.getGui(),items=Array.from(eGui.querySelectorAll(".ag-column-drop-cell"));if(index===-1)return;items.length===0&&alternateElement.focus();const indexToFocus=Math.min(items.length-1,index),el=items[indexToFocus];el&&el.focus()}focusList(fromBottom){const index=fromBottom?this.childPillComponents.length-1:0;this.restoreFocus(index,this.getFocusableElement())}getNonGhostItems(){const existingItems=this.getExistingItems();return this.isPotentialDndItems()?existingItems.filter(item=>!includes(this.potentialDndItems,item)):existingItems}addItemsToGui(){const itemsToAddToGui=this.getNonGhostItems().map(item=>this.createItemComponent(item,!1));if(this.isPotentialDndItems()){const dndItems=this.potentialDndItems.map(item=>this.createItemComponent(item,!0));this.insertIndex>=itemsToAddToGui.length?itemsToAddToGui.push(...dndItems):itemsToAddToGui.splice(this.insertIndex,0,...dndItems)}this.appendChild(this.ePillDropList),itemsToAddToGui.forEach((itemComponent,index)=>{index>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(itemComponent.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){this.childPillComponents.forEach((comp,idx)=>{const eGui=comp.getGui();setAriaPosInSet(eGui,idx+1),setAriaSetSize(eGui,this.childPillComponents.length)})}createItemComponent(item,ghost){const itemComponent=this.createPillComponent(item,this.dropTarget,ghost,this.horizontal);return itemComponent.addEventListener(PillDragComp.EVENT_COLUMN_REMOVE,this.removeItems.bind(this,[item])),this.context.createBean(itemComponent),this.guiDestroyFunctions.push(()=>this.destroyBean(itemComponent)),ghost||this.childPillComponents.push(itemComponent),itemComponent}addIconAndTitleToGui(){const{title,icon:eGroupIcon}=this.params;if(!title||!eGroupIcon)return;const eTitleBar=document.createElement("div");if(setAriaHidden(eTitleBar,!0),this.addElementClasses(eTitleBar,"title-bar"),this.addElementClasses(eGroupIcon,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),eTitleBar.appendChild(eGroupIcon),!this.horizontal){const eTitle=document.createElement("span");this.addElementClasses(eTitle,"title"),eTitle.innerHTML=title,eTitleBar.appendChild(eTitle)}this.appendChild(eTitleBar)}isExistingItemsEmpty(){return this.getExistingItems().length===0}addEmptyMessageToGui(){const{emptyMessage}=this.params;if(!emptyMessage||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const eMessage=document.createElement("span");eMessage.innerHTML=emptyMessage,this.addElementClasses(eMessage,"empty-message"),this.ePillDropList.appendChild(eMessage)}addArrow(eParent){if(this.horizontal){const enableRtl=this.gridOptionsService.get("enableRtl"),icon=createIconNoSpan(enableRtl?"smallLeft":"smallRight",this.gridOptionsService);this.addElementClasses(icon,"cell-separator"),eParent.appendChild(icon)}}},__name(_a199,"_PillDropZonePanel"),_a199);_PillDropZonePanel.STATE_NOT_DRAGGING="notDragging";_PillDropZonePanel.STATE_NEW_ITEMS_IN="newItemsIn";_PillDropZonePanel.STATE_REARRANGE_ITEMS="rearrangeItems";__decorateClass([Autowired("focusService")],_PillDropZonePanel.prototype,"focusService",2);__decorateClass([Autowired("dragAndDropService")],_PillDropZonePanel.prototype,"dragAndDropService",2);var PASSIVE_EVENTS2=["touchstart","touchend","touchmove","touchcancel"],_a200,VanillaFrameworkOverrides=(_a200=class{constructor(frameworkName="javascript"){this.frameworkName=frameworkName,this.renderingEngine="vanilla",this.wrapIncoming=callback=>callback(),this.wrapOutgoing=callback=>callback()}setInterval(action,timeout){return new AgPromise(resolve=>{resolve(window.setInterval(action,timeout))})}addEventListener(element,type,listener,useCapture){const isPassive=includes(PASSIVE_EVENTS2,type);element.addEventListener(type,listener,{capture:!!useCapture,passive:isPassive})}get shouldWrapOutgoing(){return!1}frameworkComponent(name){return null}isFrameworkComponent(comp){return!1}getDocLink(path){return`https://www.ag-grid.com/${this.frameworkName==="solid"?"react":this.frameworkName}-data-grid${path?`/${path}`:""}`}},__name(_a200,"VanillaFrameworkOverrides"),_a200),_a201,CellNavigationService=(_a201=class extends BeanStub{getNextCellToFocus(key,focusedCell,ctrlPressed=!1){return ctrlPressed?this.getNextCellToFocusWithCtrlPressed(key,focusedCell):this.getNextCellToFocusWithoutCtrlPressed(key,focusedCell)}getNextCellToFocusWithCtrlPressed(key,focusedCell){const upKey=key===KeyCode.UP,downKey=key===KeyCode.DOWN,leftKey=key===KeyCode.LEFT;let column,rowIndex;if(upKey||downKey)rowIndex=upKey?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),column=focusedCell.column;else{const allColumns=this.columnModel.getAllDisplayedColumns(),isRtl=this.gridOptionsService.get("enableRtl");rowIndex=focusedCell.rowIndex,column=leftKey!==isRtl?allColumns[0]:last(allColumns)}return{rowIndex,rowPinned:null,column}}getNextCellToFocusWithoutCtrlPressed(key,focusedCell){let pointer=focusedCell,finished=!1;for(;!finished;){switch(key){case KeyCode.UP:pointer=this.getCellAbove(pointer);break;case KeyCode.DOWN:pointer=this.getCellBelow(pointer);break;case KeyCode.RIGHT:this.gridOptionsService.get("enableRtl")?pointer=this.getCellToLeft(pointer):pointer=this.getCellToRight(pointer);break;case KeyCode.LEFT:this.gridOptionsService.get("enableRtl")?pointer=this.getCellToRight(pointer):pointer=this.getCellToLeft(pointer);break;default:pointer=null,console.warn("AG Grid: unknown key for navigation "+key);break}pointer?finished=this.isCellGoodToFocusOn(pointer):finished=!0}return pointer}isCellGoodToFocusOn(gridCell){const column=gridCell.column;let rowNode;switch(gridCell.rowPinned){case"top":rowNode=this.pinnedRowModel.getPinnedTopRow(gridCell.rowIndex);break;case"bottom":rowNode=this.pinnedRowModel.getPinnedBottomRow(gridCell.rowIndex);break;default:rowNode=this.rowModel.getRow(gridCell.rowIndex);break}return rowNode?!column.isSuppressNavigable(rowNode):!1}getCellToLeft(lastCell){if(!lastCell)return null;const colToLeft=this.columnModel.getDisplayedColBefore(lastCell.column);return colToLeft?{rowIndex:lastCell.rowIndex,column:colToLeft,rowPinned:lastCell.rowPinned}:null}getCellToRight(lastCell){if(!lastCell)return null;const colToRight=this.columnModel.getDisplayedColAfter(lastCell.column);return colToRight?{rowIndex:lastCell.rowIndex,column:colToRight,rowPinned:lastCell.rowPinned}:null}getRowBelow(rowPosition){const index=rowPosition.rowIndex,pinned=rowPosition.rowPinned;if(this.isLastRowInContainer(rowPosition))switch(pinned){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const rowNode=this.rowModel.getRow(rowPosition.rowIndex),nextStickyPosition=this.getNextStickyPosition(rowNode);return nextStickyPosition||{rowIndex:index+1,rowPinned:pinned}}getNextStickyPosition(rowNode,up){if(!this.gridOptionsService.isGroupRowsSticky()||!rowNode||!rowNode.sticky)return;const stickyRowCtrls=[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,b)=>a.getRowNode().rowIndex-b.getRowNode().rowIndex),diff=up?-1:1,idx=stickyRowCtrls.findIndex(ctrl=>ctrl.getRowNode().rowIndex===rowNode.rowIndex),nextCtrl=stickyRowCtrls[idx+diff];if(nextCtrl)return{rowIndex:nextCtrl.getRowNode().rowIndex,rowPinned:null}}getCellBelow(lastCell){if(!lastCell)return null;const rowBelow=this.getRowBelow(lastCell);return rowBelow?{rowIndex:rowBelow.rowIndex,column:lastCell.column,rowPinned:rowBelow.rowPinned}:null}isLastRowInContainer(rowPosition){const pinned=rowPosition.rowPinned,index=rowPosition.rowIndex;return pinned==="top"?this.pinnedRowModel.getPinnedTopRowData().length-1<=index:pinned==="bottom"?this.pinnedRowModel.getPinnedBottomRowData().length-1<=index:this.paginationProxy.getPageLastRow()<=index}getRowAbove(rowPosition){const index=rowPosition.rowIndex,pinned=rowPosition.rowPinned;if(pinned?index===0:index===this.paginationProxy.getPageFirstRow())return pinned==="top"?null:pinned?this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null:this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const rowNode=this.rowModel.getRow(rowPosition.rowIndex),nextStickyPosition=this.getNextStickyPosition(rowNode,!0);return nextStickyPosition||{rowIndex:index-1,rowPinned:pinned}}getCellAbove(lastCell){if(!lastCell)return null;const rowAbove=this.getRowAbove({rowIndex:lastCell.rowIndex,rowPinned:lastCell.rowPinned});return rowAbove?{rowIndex:rowAbove.rowIndex,column:lastCell.column,rowPinned:rowAbove.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(gridCell,backwards){return backwards?this.getNextTabbedCellBackwards(gridCell):this.getNextTabbedCellForwards(gridCell)}getNextTabbedCellForwards(gridCell){const displayedColumns=this.columnModel.getAllDisplayedColumns();let newRowIndex=gridCell.rowIndex,newFloating=gridCell.rowPinned,newColumn=this.columnModel.getDisplayedColAfter(gridCell.column);if(!newColumn){newColumn=displayedColumns[0];const rowBelow=this.getRowBelow(gridCell);if(missing(rowBelow)||!rowBelow.rowPinned&&!this.paginationProxy.isRowInPage(rowBelow))return null;newRowIndex=rowBelow?rowBelow.rowIndex:null,newFloating=rowBelow?rowBelow.rowPinned:null}return{rowIndex:newRowIndex,column:newColumn,rowPinned:newFloating}}getNextTabbedCellBackwards(gridCell){const displayedColumns=this.columnModel.getAllDisplayedColumns();let newRowIndex=gridCell.rowIndex,newFloating=gridCell.rowPinned,newColumn=this.columnModel.getDisplayedColBefore(gridCell.column);if(!newColumn){newColumn=last(displayedColumns);const rowAbove=this.getRowAbove({rowIndex:gridCell.rowIndex,rowPinned:gridCell.rowPinned});if(missing(rowAbove)||!rowAbove.rowPinned&&!this.paginationProxy.isRowInPage(rowAbove))return null;newRowIndex=rowAbove?rowAbove.rowIndex:null,newFloating=rowAbove?rowAbove.rowPinned:null}return{rowIndex:newRowIndex,column:newColumn,rowPinned:newFloating}}},__name(_a201,"CellNavigationService"),_a201);__decorateClass([Autowired("columnModel")],CellNavigationService.prototype,"columnModel",2);__decorateClass([Autowired("rowModel")],CellNavigationService.prototype,"rowModel",2);__decorateClass([Autowired("rowRenderer")],CellNavigationService.prototype,"rowRenderer",2);__decorateClass([Autowired("pinnedRowModel")],CellNavigationService.prototype,"pinnedRowModel",2);__decorateClass([Autowired("paginationProxy")],CellNavigationService.prototype,"paginationProxy",2);CellNavigationService=__decorateClass([Bean("cellNavigationService")],CellNavigationService);var _a202,AlignedGridsService=(_a202=class extends BeanStub{constructor(){super(...arguments),this.consuming=!1}setBeans(loggerFactory){this.logger=loggerFactory.create("AlignedGridsService")}getAlignedGridApis(){var _a273;let alignedGrids=(_a273=this.gridOptionsService.get("alignedGrids"))!=null?_a273:[];const isCallbackConfig=typeof alignedGrids=="function";typeof alignedGrids=="function"&&(alignedGrids=alignedGrids());const seeUrl=__name(()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`,"seeUrl");return alignedGrids.map(alignedGrid=>{var _a274;if(!alignedGrid){errorOnce("alignedGrids contains an undefined option."),isCallbackConfig||errorOnce(`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`),errorOnce(seeUrl());return}if(alignedGrid instanceof GridApi)return alignedGrid;const refOrComp=alignedGrid;return"current"in refOrComp?(_a274=refOrComp.current)==null?void 0:_a274.api:(refOrComp.api||errorOnce(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${seeUrl()}`),refOrComp.api)}).filter(api=>!!api&&!api.isDestroyed())}init(){this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(callback){this.consuming||this.getAlignedGridApis().forEach(api=>{const alignedGridService=api.__getAlignedGridService();callback(alignedGridService)})}onEvent(callback){this.consuming=!0,callback(),this.consuming=!1}fireColumnEvent(event){this.fireEvent(alignedGridsService=>{alignedGridsService.onColumnEvent(event)})}fireScrollEvent(event){event.direction==="horizontal"&&this.fireEvent(alignedGridsService=>{alignedGridsService.onScrollEvent(event)})}onScrollEvent(event){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(event.left,!0)})}getMasterColumns(event){const result=[];return event.columns?event.columns.forEach(column=>{result.push(column)}):event.column&&result.push(event.column),result}getColumnIds(event){const result=[];return event.columns?event.columns.forEach(column=>{result.push(column.getColId())}):event.column&&result.push(event.column.getColId()),result}onColumnEvent(event){this.onEvent(()=>{switch(event.type){case Events.EVENT_COLUMN_MOVED:case Events.EVENT_COLUMN_VISIBLE:case Events.EVENT_COLUMN_PINNED:case Events.EVENT_COLUMN_RESIZED:const colEvent=event;this.processColumnEvent(colEvent);break;case Events.EVENT_COLUMN_GROUP_OPENED:const groupOpenedEvent=event;this.processGroupOpenedEvent(groupOpenedEvent);break;case Events.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.");break}})}processGroupOpenedEvent(groupOpenedEvent){groupOpenedEvent.columnGroups.forEach(masterGroup=>{let otherColumnGroup=null;if(masterGroup){const groupId=masterGroup.getGroupId();otherColumnGroup=this.columnModel.getProvidedColumnGroup(groupId)}masterGroup&&!otherColumnGroup||(this.logger.log("onColumnEvent-> processing "+groupOpenedEvent+" expanded = "+masterGroup.isExpanded()),this.columnModel.setColumnGroupOpened(otherColumnGroup,masterGroup.isExpanded(),"alignedGridChanged"))})}processColumnEvent(colEvent){var _a273;const masterColumn=colEvent.column;let otherColumn=null;if(masterColumn&&(otherColumn=this.columnModel.getPrimaryColumn(masterColumn.getColId())),masterColumn&&!otherColumn)return;const masterColumns=this.getMasterColumns(colEvent);switch(colEvent.type){case Events.EVENT_COLUMN_MOVED:{const movedEvent=colEvent,destColState=colEvent.api.getColumnState().map(s=>({colId:s.colId}));this.columnModel.applyColumnState({state:destColState,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${colEvent.type} toIndex = ${movedEvent.toIndex}`)}break;case Events.EVENT_COLUMN_VISIBLE:{const visibleEvent=colEvent,destColState=colEvent.api.getColumnState().map(s=>({colId:s.colId,hide:s.hide}));this.columnModel.applyColumnState({state:destColState},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${colEvent.type} visible = ${visibleEvent.visible}`)}break;case Events.EVENT_COLUMN_PINNED:{const pinnedEvent=colEvent,destColState=colEvent.api.getColumnState().map(s=>({colId:s.colId,pinned:s.pinned}));this.columnModel.applyColumnState({state:destColState},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${colEvent.type} pinned = ${pinnedEvent.pinned}`)}break;case Events.EVENT_COLUMN_RESIZED:const resizedEvent=colEvent,columnWidths={};masterColumns.forEach(column=>{this.logger.log(`onColumnEvent-> processing ${colEvent.type} actualWidth = ${column.getActualWidth()}`),columnWidths[column.getId()]={key:column.getColId(),newWidth:column.getActualWidth()}}),(_a273=resizedEvent.flexColumns)==null||_a273.forEach(col=>{columnWidths[col.getId()]&&delete columnWidths[col.getId()]}),this.columnModel.setColumnWidths(Object.values(columnWidths),!1,resizedEvent.finished,"alignedGridChanged");break}const isVerticalScrollShowing2=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(api=>{api.setGridOption("alwaysShowVerticalScroll",isVerticalScrollShowing2)})}},__name(_a202,"AlignedGridsService"),_a202);__decorateClass([Autowired("columnModel")],AlignedGridsService.prototype,"columnModel",2);__decorateClass([Autowired("ctrlsService")],AlignedGridsService.prototype,"ctrlsService",2);__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],AlignedGridsService.prototype,"setBeans",1);__decorateClass([PostConstruct],AlignedGridsService.prototype,"init",1);AlignedGridsService=__decorateClass([Bean("alignedGridsService")],AlignedGridsService);var _a203,SelectionService=(_a203=class extends BeanStub{constructor(){super(...arguments),this.selectedNodes=new Map,this.lastRowNode=null}init(){this.rowSelection=this.gridOptionsService.get("rowSelection"),this.groupSelectsChildren=this.gridOptionsService.get("groupSelectsChildren"),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{this.groupSelectsChildren=this.gridOptionsService.get("groupSelectsChildren"),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.deselectAllRowNodes({source:"api"})}),this.addManagedListener(this.eventService,Events.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}destroy(){super.destroy(),this.resetNodes(),this.lastRowNode=null}isMultiselect(){return this.rowSelection==="multiple"}setNodesSelected(params){var _a273;const{newValue,clearSelection,suppressFinishActions,rangeSelect,nodes,event,source="api"}=params;if(nodes.length===0)return 0;if(nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const groupSelectsFiltered=this.groupSelectsChildren&&params.groupSelectsFiltered===!0,filteredNodes=nodes.map(node=>node.footer?node.sibling:node);if(rangeSelect){if(nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;let toNode=null;if(source==="checkboxSelected"&&newValue===!1&&this.lastRowNode&&(this.lastRowNode.id?toNode=this.lastRowNode:this.lastRowNode=null),toNode==null&&(toNode=this.getLastSelectedNode()),toNode){const fromNode=filteredNodes[0];if(fromNode!==toNode&&this.isMultiselect())return this.selectRange(fromNode,toNode,newValue,source)}}this.lastRowNode=newValue?null:filteredNodes[0];let updatedCount=0;for(let i=0;i<filteredNodes.length;i++){const node=filteredNodes[i];groupSelectsFiltered&&node.group||node.selectThisNode(newValue,event,source)&&updatedCount++,this.groupSelectsChildren&&((_a273=node.childrenAfterGroup)!=null&&_a273.length)&&(updatedCount+=this.selectChildren(node,newValue,groupSelectsFiltered,source))}if(!suppressFinishActions&&(newValue&&(clearSelection||!this.isMultiselect())&&(updatedCount+=this.clearOtherNodes(filteredNodes[0],source)),updatedCount>0)){this.updateGroupsFromChildrenSelections(source);const event2={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event2)}return updatedCount}selectRange(fromNode,toNode,value=!0,source){const nodesToSelect=this.rowModel.getNodesInRangeForSelection(fromNode,toNode);let updatedCount=0;nodesToSelect.forEach(rowNode=>{if(rowNode.group&&this.groupSelectsChildren)return;rowNode.selectThisNode(value,void 0,source)&&updatedCount++}),this.updateGroupsFromChildrenSelections(source);const event={type:Events.EVENT_SELECTION_CHANGED,source};return this.eventService.dispatchEvent(event),updatedCount}selectChildren(node,newValue,groupSelectsFiltered,source){const children=groupSelectsFiltered?node.childrenAfterAggFilter:node.childrenAfterGroup;return missing(children)?0:this.setNodesSelected({newValue,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered,source,nodes:children})}getLastSelectedNode(){const selectedKeys=Array.from(this.selectedNodes.keys());if(selectedKeys.length==0)return null;const node=this.selectedNodes.get(last(selectedKeys));return node||null}getSelectedNodes(){const selectedNodes=[];return this.selectedNodes.forEach(rowNode=>{rowNode&&selectedNodes.push(rowNode)}),selectedNodes}getSelectedRows(){const selectedRows=[];return this.selectedNodes.forEach(rowNode=>{rowNode&&rowNode.data&&selectedRows.push(rowNode.data)}),selectedRows}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(predicate){const newSelectedNodes=new Map;this.selectedNodes.forEach((rowNode,key)=>{rowNode&&predicate(rowNode)&&newSelectedNodes.set(key,rowNode)}),this.selectedNodes=newSelectedNodes}updateGroupsFromChildrenSelections(source,changedPath){if(!this.groupSelectsChildren||this.rowModel.getType()!=="clientSide")return!1;const rootNode=this.rowModel.getRootNode();changedPath||(changedPath=new ChangedPath(!0,rootNode),changedPath.setInactive());let selectionChanged=!1;return changedPath.forEachChangedNodeDepthFirst(rowNode=>{if(rowNode!==rootNode){const selected=rowNode.calculateSelectedFromChildren();selectionChanged=rowNode.selectThisNode(selected===null?!1:selected,void 0,source)||selectionChanged}}),selectionChanged}clearOtherNodes(rowNodeToKeepSelected,source){const groupsToRefresh=new Map;let updatedCount=0;return this.selectedNodes.forEach(otherRowNode=>{if(otherRowNode&&otherRowNode.id!==rowNodeToKeepSelected.id){const rowNode=this.selectedNodes.get(otherRowNode.id);updatedCount+=rowNode.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source}),this.groupSelectsChildren&&otherRowNode.parent&&groupsToRefresh.set(otherRowNode.parent.id,otherRowNode.parent)}}),groupsToRefresh.forEach(group=>{const selected=group.calculateSelectedFromChildren();group.selectThisNode(selected===null?!1:selected,void 0,source)}),updatedCount}onRowSelected(event){const rowNode=event.node;this.groupSelectsChildren&&rowNode.group||(rowNode.isSelected()?this.selectedNodes.set(rowNode.id,rowNode):this.selectedNodes.delete(rowNode.id))}syncInRowNode(rowNode,oldNode){this.syncInOldRowNode(rowNode,oldNode),this.syncInNewRowNode(rowNode)}syncInOldRowNode(rowNode,oldNode){if(exists(oldNode)&&rowNode.id!==oldNode.id&&oldNode){const id=oldNode.id;this.selectedNodes.get(id)==rowNode&&this.selectedNodes.set(oldNode.id,oldNode)}}syncInNewRowNode(rowNode){this.selectedNodes.has(rowNode.id)?(rowNode.setSelectedInitialValue(!0),this.selectedNodes.set(rowNode.id,rowNode)):rowNode.setSelectedInitialValue(!1)}reset(source){const selectionCount=this.getSelectionCount();if(this.resetNodes(),selectionCount){const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}}resetNodes(){var _a273;(_a273=this.selectedNodes)==null||_a273.clear()}getBestCostNodeSelection(){if(this.rowModel.getType()!=="clientSide")return;const topLevelNodes=this.rowModel.getTopLevelNodes();if(topLevelNodes===null)return;const result=[];function traverse(nodes){for(let i=0,l=nodes.length;i<l;i++){const node=nodes[i];if(node.isSelected())result.push(node);else{const maybeGroup=node;maybeGroup.group&&maybeGroup.children&&traverse(maybeGroup.children)}}}return __name(traverse,"traverse"),traverse(topLevelNodes),result}isEmpty(){let count=0;return this.selectedNodes.forEach(rowNode=>{rowNode&&count++}),count===0}deselectAllRowNodes(params){const callback=__name(rowNode=>rowNode.selectThisNode(!1,void 0,source),"callback"),rowModelClientSide=this.rowModel.getType()==="clientSide",{source,justFiltered,justCurrentPage}=params;if(justCurrentPage||justFiltered){if(!rowModelClientSide){console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");return}this.getNodesToSelect(justFiltered,justCurrentPage).forEach(callback)}else this.selectedNodes.forEach(rowNode=>{rowNode&&callback(rowNode)}),this.reset(source);rowModelClientSide&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(source);const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}getSelectedCounts(justFiltered,justCurrentPage){let selectedCount=0,notSelectedCount=0;const callback=__name(node=>{this.groupSelectsChildren&&node.group||(node.isSelected()?selectedCount++:node.selectable&&notSelectedCount++)},"callback");return this.getNodesToSelect(justFiltered,justCurrentPage).forEach(callback),{selectedCount,notSelectedCount}}getSelectAllState(justFiltered,justCurrentPage){const{selectedCount,notSelectedCount}=this.getSelectedCounts(justFiltered,justCurrentPage);return selectedCount===0&&notSelectedCount===0?!1:selectedCount>0&&notSelectedCount>0?null:selectedCount>0}hasNodesToSelect(justFiltered=!1,justCurrentPage=!1){return this.getNodesToSelect(justFiltered,justCurrentPage).filter(node=>node.selectable).length>0}getNodesToSelect(justFiltered=!1,justCurrentPage=!1){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const nodes=[];if(justCurrentPage)return this.paginationProxy.forEachNodeOnPage(node=>{if(!node.group){nodes.push(node);return}if(!node.expanded){const recursivelyAddChildren=__name(child=>{var _a273;nodes.push(child),(_a273=child.childrenAfterFilter)!=null&&_a273.length&&child.childrenAfterFilter.forEach(recursivelyAddChildren)},"recursivelyAddChildren");recursivelyAddChildren(node);return}this.groupSelectsChildren||nodes.push(node)}),nodes;const clientSideRowModel=this.rowModel;return justFiltered?(clientSideRowModel.forEachNodeAfterFilter(node=>{nodes.push(node)}),nodes):(clientSideRowModel.forEachNode(node=>{nodes.push(node)}),nodes)}selectAllRowNodes(params){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const{source,justFiltered,justCurrentPage}=params,callback=__name(rowNode=>rowNode.selectThisNode(!0,void 0,source),"callback");this.getNodesToSelect(justFiltered,justCurrentPage).forEach(callback),this.rowModel.getType()==="clientSide"&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(source);const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}getSelectionState(){const selectedIds=[];return this.selectedNodes.forEach(node=>{node!=null&&node.id&&selectedIds.push(node.id)}),selectedIds.length?selectedIds:null}setSelectionState(state,source){if(!Array.isArray(state))return;const rowIds=new Set(state),nodes=[];this.rowModel.forEachNode(node=>{rowIds.has(node.id)&&nodes.push(node)}),this.setNodesSelected({newValue:!0,nodes,source})}},__name(_a203,"SelectionService"),_a203);__decorateClass([Autowired("rowModel")],SelectionService.prototype,"rowModel",2);__decorateClass([Autowired("paginationProxy")],SelectionService.prototype,"paginationProxy",2);__decorateClass([PostConstruct],SelectionService.prototype,"init",1);SelectionService=__decorateClass([Bean("selectionService")],SelectionService);var _a204,ColumnApi=(_a204=class{constructor(gridAp){this.viaApi=(funcName,...args)=>(warnOnce(`Since v31, 'columnApi.${funcName}' is deprecated and moved to 'api.${funcName}'.`),this.api[funcName](...args)),this.api=gridAp}sizeColumnsToFit(gridWidth){this.viaApi("sizeColumnsToFit",gridWidth)}setColumnGroupOpened(group,newValue){this.viaApi("setColumnGroupOpened",group,newValue)}getColumnGroup(name,instanceId){return this.viaApi("getColumnGroup",name,instanceId)}getProvidedColumnGroup(name){return this.viaApi("getProvidedColumnGroup",name)}getDisplayNameForColumn(column,location){return this.viaApi("getDisplayNameForColumn",column,location)}getDisplayNameForColumnGroup(columnGroup,location){return this.viaApi("getDisplayNameForColumnGroup",columnGroup,location)}getColumn(key){return this.viaApi("getColumn",key)}getColumns(){return this.viaApi("getColumns")}applyColumnState(params){return this.viaApi("applyColumnState",params)}getColumnState(){return this.viaApi("getColumnState")}resetColumnState(){this.viaApi("resetColumnState")}getColumnGroupState(){return this.viaApi("getColumnGroupState")}setColumnGroupState(stateItems){this.viaApi("setColumnGroupState",stateItems)}resetColumnGroupState(){this.viaApi("resetColumnGroupState")}isPinning(){return this.viaApi("isPinning")}isPinningLeft(){return this.viaApi("isPinningLeft")}isPinningRight(){return this.viaApi("isPinningRight")}getDisplayedColAfter(col){return this.viaApi("getDisplayedColAfter",col)}getDisplayedColBefore(col){return this.viaApi("getDisplayedColBefore",col)}setColumnVisible(key,visible){this.viaApi("setColumnVisible",key,visible)}setColumnsVisible(keys2,visible){this.viaApi("setColumnsVisible",keys2,visible)}setColumnPinned(key,pinned){this.viaApi("setColumnPinned",key,pinned)}setColumnsPinned(keys2,pinned){this.viaApi("setColumnsPinned",keys2,pinned)}getAllGridColumns(){return this.viaApi("getAllGridColumns")}getDisplayedLeftColumns(){return this.viaApi("getDisplayedLeftColumns")}getDisplayedCenterColumns(){return this.viaApi("getDisplayedCenterColumns")}getDisplayedRightColumns(){return this.viaApi("getDisplayedRightColumns")}getAllDisplayedColumns(){return this.viaApi("getAllDisplayedColumns")}getAllDisplayedVirtualColumns(){return this.viaApi("getAllDisplayedVirtualColumns")}moveColumn(key,toIndex){this.viaApi("moveColumn",key,toIndex)}moveColumnByIndex(fromIndex,toIndex){this.viaApi("moveColumnByIndex",fromIndex,toIndex)}moveColumns(columnsToMoveKeys,toIndex){this.viaApi("moveColumns",columnsToMoveKeys,toIndex)}moveRowGroupColumn(fromIndex,toIndex){this.viaApi("moveRowGroupColumn",fromIndex,toIndex)}setColumnAggFunc(key,aggFunc){this.viaApi("setColumnAggFunc",key,aggFunc)}setColumnWidth(key,newWidth,finished=!0,source){this.viaApi("setColumnWidth",key,newWidth,finished,source)}setColumnWidths(columnWidths,finished=!0,source){this.viaApi("setColumnWidths",columnWidths,finished,source)}setPivotMode(pivotMode){this.viaApi("setPivotMode",pivotMode)}isPivotMode(){return this.viaApi("isPivotMode")}getPivotResultColumn(pivotKeys,valueColKey){return this.viaApi("getPivotResultColumn",pivotKeys,valueColKey)}setValueColumns(colKeys){this.viaApi("setValueColumns",colKeys)}getValueColumns(){return this.viaApi("getValueColumns")}removeValueColumn(colKey){this.viaApi("removeValueColumn",colKey)}removeValueColumns(colKeys){this.viaApi("removeValueColumns",colKeys)}addValueColumn(colKey){this.viaApi("addValueColumn",colKey)}addValueColumns(colKeys){this.viaApi("addValueColumns",colKeys)}setRowGroupColumns(colKeys){this.viaApi("setRowGroupColumns",colKeys)}removeRowGroupColumn(colKey){this.viaApi("removeRowGroupColumn",colKey)}removeRowGroupColumns(colKeys){this.viaApi("removeRowGroupColumns",colKeys)}addRowGroupColumn(colKey){this.viaApi("addRowGroupColumn",colKey)}addRowGroupColumns(colKeys){this.viaApi("addRowGroupColumns",colKeys)}getRowGroupColumns(){return this.viaApi("getRowGroupColumns")}setPivotColumns(colKeys){this.viaApi("setPivotColumns",colKeys)}removePivotColumn(colKey){this.viaApi("removePivotColumn",colKey)}removePivotColumns(colKeys){this.viaApi("removePivotColumns",colKeys)}addPivotColumn(colKey){this.viaApi("addPivotColumn",colKey)}addPivotColumns(colKeys){this.viaApi("addPivotColumns",colKeys)}getPivotColumns(){return this.viaApi("getPivotColumns")}getLeftDisplayedColumnGroups(){return this.viaApi("getLeftDisplayedColumnGroups")}getCenterDisplayedColumnGroups(){return this.viaApi("getCenterDisplayedColumnGroups")}getRightDisplayedColumnGroups(){return this.viaApi("getRightDisplayedColumnGroups")}getAllDisplayedColumnGroups(){return this.viaApi("getAllDisplayedColumnGroups")}autoSizeColumn(key,skipHeader){return this.viaApi("autoSizeColumn",key,skipHeader)}autoSizeColumns(keys2,skipHeader){this.viaApi("autoSizeColumns",keys2,skipHeader)}autoSizeAllColumns(skipHeader){this.viaApi("autoSizeAllColumns",skipHeader)}setPivotResultColumns(colDefs){this.viaApi("setPivotResultColumns",colDefs)}getPivotResultColumns(){return this.viaApi("getPivotResultColumns")}},__name(_a204,"ColumnApi"),_a204);__decorateClass([Autowired("gridApi")],ColumnApi.prototype,"api",2);ColumnApi=__decorateClass([Bean("columnApi")],ColumnApi);var _a205,ValueService=(_a205=class extends BeanStub{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gridOptionsService.isRowModelType("serverSide"),this.cellExpressions=this.gridOptionsService.get("enableCellExpressions"),this.isTreeData=this.gridOptionsService.get("treeData"),this.initialised=!0;const listener=__name(event=>this.callColumnCellValueChangedHandler(event),"listener"),async=this.gridOptionsService.useAsyncEvents();this.eventService.addEventListener(Events.EVENT_CELL_VALUE_CHANGED,listener,async),this.addDestroyFunc(()=>this.eventService.removeEventListener(Events.EVENT_CELL_VALUE_CHANGED,listener,async)),this.addManagedPropertyListener("treeData",propChange=>this.isTreeData=propChange.currentValue)}getValue(column,rowNode,forFilter=!1,ignoreAggData=!1){if(this.initialised||this.init(),!rowNode)return;const colDef=column.getColDef(),field=colDef.field,colId=column.getColId(),data=rowNode.data;let result;const groupDataExists=rowNode.groupData&&rowNode.groupData[colId]!==void 0,aggDataExists=!ignoreAggData&&rowNode.aggData&&rowNode.aggData[colId]!==void 0,ignoreSsrmAggData=this.isSsrm&&ignoreAggData&&!!column.getColDef().aggFunc,ssrmFooterGroupCol=this.isSsrm&&rowNode.footer&&rowNode.field&&(column.getColDef().showRowGroup===!0||column.getColDef().showRowGroup===rowNode.field);if(forFilter&&colDef.filterValueGetter?result=this.executeFilterValueGetter(colDef.filterValueGetter,data,column,rowNode):this.isTreeData&&aggDataExists?result=rowNode.aggData[colId]:this.isTreeData&&colDef.valueGetter?result=this.executeValueGetter(colDef.valueGetter,data,column,rowNode):this.isTreeData&&field&&data?result=getValueUsingField(data,field,column.isFieldContainsDots()):groupDataExists?result=rowNode.groupData[colId]:aggDataExists?result=rowNode.aggData[colId]:colDef.valueGetter?result=this.executeValueGetter(colDef.valueGetter,data,column,rowNode):ssrmFooterGroupCol?result=getValueUsingField(data,rowNode.field,column.isFieldContainsDots()):field&&data&&!ignoreSsrmAggData&&(result=getValueUsingField(data,field,column.isFieldContainsDots())),this.cellExpressions&&typeof result=="string"&&result.indexOf("=")===0){const cellValueGetter=result.substring(1);result=this.executeValueGetter(cellValueGetter,data,column,rowNode)}if(result==null){const openedGroup=this.getOpenedGroup(rowNode,column);if(openedGroup!=null)return openedGroup}return result}getOpenedGroup(rowNode,column){if(!this.gridOptionsService.get("showOpenedGroup")||!column.getColDef().showRowGroup)return;const showRowGroup=column.getColDef().showRowGroup;let pointer=rowNode.parent;for(;pointer!=null;){if(pointer.rowGroupColumn&&(showRowGroup===!0||showRowGroup===pointer.rowGroupColumn.getColId()))return pointer.key;pointer=pointer.parent}}setValue(rowNode,colKey,newValue,eventSource){const column=this.columnModel.getPrimaryColumn(colKey);if(!rowNode||!column)return!1;missing(rowNode.data)&&(rowNode.data={});const{field,valueSetter}=column.getColDef();if(missing(field)&&missing(valueSetter))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(column,newValue))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const params=this.gridOptionsService.addGridCommonParams({node:rowNode,data:rowNode.data,oldValue:this.getValue(column,rowNode),newValue,colDef:column.getColDef(),column});params.newValue=newValue;let valueWasDifferent;if(exists(valueSetter)?typeof valueSetter=="function"?valueWasDifferent=valueSetter(params):valueWasDifferent=this.expressionService.evaluate(valueSetter,params):valueWasDifferent=this.setValueUsingField(rowNode.data,field,newValue,column.isFieldContainsDots()),valueWasDifferent===void 0&&(valueWasDifferent=!0),!valueWasDifferent)return!1;rowNode.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),params.newValue=this.getValue(column,rowNode);const event={type:Events.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:rowNode.rowIndex,rowPinned:rowNode.rowPinned,column:params.column,api:params.api,columnApi:params.columnApi,colDef:params.colDef,context:params.context,data:rowNode.data,node:rowNode,oldValue:params.oldValue,newValue:params.newValue,value:params.newValue,source:eventSource};return this.eventService.dispatchEvent(event),!0}callColumnCellValueChangedHandler(event){const onCellValueChanged=event.colDef.onCellValueChanged;typeof onCellValueChanged=="function"&&this.getFrameworkOverrides().wrapOutgoing(()=>{onCellValueChanged({node:event.node,data:event.data,oldValue:event.oldValue,newValue:event.newValue,colDef:event.colDef,column:event.column,api:event.api,columnApi:event.columnApi,context:event.context})})}setValueUsingField(data,field,newValue,isFieldContainsDots){if(!field)return!1;let valuesAreSame=!1;if(!isFieldContainsDots)valuesAreSame=data[field]===newValue,valuesAreSame||(data[field]=newValue);else{const fieldPieces=field.split(".");let currentObject=data;for(;fieldPieces.length>0&&currentObject;){const fieldPiece=fieldPieces.shift();fieldPieces.length===0?(valuesAreSame=currentObject[fieldPiece]===newValue,valuesAreSame||(currentObject[fieldPiece]=newValue)):currentObject=currentObject[fieldPiece]}}return!valuesAreSame}executeFilterValueGetter(valueGetter,data,column,rowNode){const params=this.gridOptionsService.addGridCommonParams({data,node:rowNode,column,colDef:column.getColDef(),getValue:this.getValueCallback.bind(this,rowNode)});return typeof valueGetter=="function"?valueGetter(params):this.expressionService.evaluate(valueGetter,params)}executeValueGetter(valueGetter,data,column,rowNode){const colId=column.getColId(),valueFromCache=this.valueCache.getValue(rowNode,colId);if(valueFromCache!==void 0)return valueFromCache;const params=this.gridOptionsService.addGridCommonParams({data,node:rowNode,column,colDef:column.getColDef(),getValue:this.getValueCallback.bind(this,rowNode)});let result;return typeof valueGetter=="function"?result=valueGetter(params):result=this.expressionService.evaluate(valueGetter,params),this.valueCache.setValue(rowNode,colId,result),result}getValueCallback(node,field){const otherColumn=this.columnModel.getPrimaryColumn(field);return otherColumn?this.getValue(otherColumn,node):null}getKeyForNode(col,rowNode){const value=this.getValue(col,rowNode),keyCreator=col.getColDef().keyCreator;let result=value;if(keyCreator){const keyParams=this.gridOptionsService.addGridCommonParams({value,colDef:col.getColDef(),column:col,node:rowNode,data:rowNode.data});result=keyCreator(keyParams)}return typeof result=="string"||result==null||(result=String(result),result==="[object Object]"&&warnOnce("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),result}},__name(_a205,"ValueService"),_a205);__decorateClass([Autowired("expressionService")],ValueService.prototype,"expressionService",2);__decorateClass([Autowired("columnModel")],ValueService.prototype,"columnModel",2);__decorateClass([Autowired("valueCache")],ValueService.prototype,"valueCache",2);__decorateClass([Autowired("dataTypeService")],ValueService.prototype,"dataTypeService",2);__decorateClass([PostConstruct],ValueService.prototype,"init",1);ValueService=__decorateClass([Bean("valueService")],ValueService);var _a206,ExpressionService=(_a206=class extends BeanStub{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(loggerFactory){this.logger=loggerFactory.create("ExpressionService")}evaluate(expression,params){if(typeof expression=="string")return this.evaluateExpression(expression,params);console.error("AG Grid: value should be either a string or a function",expression)}evaluateExpression(expression,params){try{return this.createExpressionFunction(expression)(params.value,params.context,params.oldValue,params.newValue,params.value,params.node,params.data,params.colDef,params.rowIndex,params.api,params.columnApi,params.getValue,params.column,params.columnGroup)}catch(e){return console.log("Processing of the expression failed"),console.log("Expression = "+expression),console.log("Params =",params),console.log("Exception = "+e),null}}createExpressionFunction(expression){if(this.expressionToFunctionCache[expression])return this.expressionToFunctionCache[expression];const functionBody=this.createFunctionBody(expression),theFunction=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",functionBody);return this.expressionToFunctionCache[expression]=theFunction,theFunction}createFunctionBody(expression){return expression.indexOf("return")>=0?expression:"return "+expression+";"}},__name(_a206,"ExpressionService"),_a206);__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],ExpressionService.prototype,"setBeans",1);ExpressionService=__decorateClass([Bean("expressionService")],ExpressionService);var _a207,TemplateService=(_a207=class extends BeanStub{constructor(){super(...arguments),this.templateCache={},this.waitingCallbacks={}}getTemplate(url,callback){const templateFromCache=this.templateCache[url];if(templateFromCache)return templateFromCache;let callbackList=this.waitingCallbacks[url];const that=this;if(!callbackList){callbackList=[],this.waitingCallbacks[url]=callbackList;const client=new XMLHttpRequest;client.onload=function(){that.handleHttpResult(this,url)},client.open("GET",url),client.send()}return callback&&callbackList.push(callback),null}handleHttpResult(httpResult,url){if(httpResult.status!==200||httpResult.response===null){console.warn(`AG Grid: Unable to get template error ${httpResult.status} - ${url}`);return}this.templateCache[url]=httpResult.response||httpResult.responseText;const callbacks=this.waitingCallbacks[url];for(let i=0;i<callbacks.length;i++){const callback=callbacks[i];callback()}}},__name(_a207,"TemplateService"),_a207);TemplateService=__decorateClass([Bean("templateService")],TemplateService);var _a208,LoggerFactory=(_a208=class extends BeanStub{setBeans(gridOptionsService){this.logging=gridOptionsService.get("debug")}create(name){return new Logger(name,this.isLogging.bind(this))}isLogging(){return this.logging}},__name(_a208,"LoggerFactory"),_a208);__decorateClass([__decorateParam(0,Qualifier("gridOptionsService"))],LoggerFactory.prototype,"setBeans",1);LoggerFactory=__decorateClass([Bean("loggerFactory")],LoggerFactory);var _a209,Logger=(_a209=class{constructor(name,isLoggingFunc){this.name=name,this.isLoggingFunc=isLoggingFunc}isLogging(){return this.isLoggingFunc()}log(message){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+message)}},__name(_a209,"Logger"),_a209),_a210,GridCtrl=(_a210=class extends BeanStub{setComp(view,eGridDiv,eGui){this.view=view,this.eGridHostDiv=eGridDiv,this.eGui=eGui,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:type=>type===1||type===0,getIconName:()=>DragAndDropService.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(eGridDiv),this.createManagedBean(new LayoutFeature(this.view)),this.addRtlSupport();const unsubscribeFromResize=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>unsubscribeFromResize()),this.ctrlsService.registerGridCtrl(this)}isDetailGrid(){var _a273;const el=this.focusService.findTabbableParent(this.getGui());return((_a273=el==null?void 0:el.getAttribute("row-id"))==null?void 0:_a273.startsWith("detail"))||!1}showDropZones(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/row-grouping",this.context.getGridId())}showSideBar(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/side-bar",this.context.getGridId())}showStatusBar(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/status-bar",this.context.getGridId())}showWatermark(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId())}onGridSizeChanged(){const event={type:Events.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(event)}addRtlSupport(){const cssClass=this.gridOptionsService.get("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(cssClass)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(on){this.view.setCursor(on?"ew-resize":null)}disableUserSelect(on){this.view.setUserSelect(on?"none":null)}focusNextInnerContainer(backwards){const eDocument=this.gridOptionsService.getDocument(),focusableContainers=this.view.getFocusableContainers(),nextIdx=focusableContainers.findIndex(container=>container.contains(eDocument.activeElement))+(backwards?-1:1);return nextIdx<=0||nextIdx>=focusableContainers.length?!1:this.focusService.focusInto(focusableContainers[nextIdx])}focusInnerElement(fromBottom){const focusableContainers=this.view.getFocusableContainers(),allColumns=this.columnModel.getAllDisplayedColumns();if(fromBottom){if(focusableContainers.length>1)return this.focusService.focusInto(last(focusableContainers),!0);const lastColumn=last(allColumns);if(this.focusService.focusGridView(lastColumn,!0))return!0}if(this.gridOptionsService.get("headerHeight")===0||this.gridOptionsService.get("suppressHeaderFocus")){if(this.focusService.focusGridView(allColumns[0]))return!0;for(let i=1;i<focusableContainers.length;i++)if(this.focusService.focusInto(focusableContainers[i]))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(up=!1){this.view.forceFocusOutOfContainer(up)}},__name(_a210,"GridCtrl"),_a210);__decorateClass([Autowired("focusService")],GridCtrl.prototype,"focusService",2);__decorateClass([Autowired("resizeObserverService")],GridCtrl.prototype,"resizeObserverService",2);__decorateClass([Autowired("columnModel")],GridCtrl.prototype,"columnModel",2);__decorateClass([Autowired("ctrlsService")],GridCtrl.prototype,"ctrlsService",2);__decorateClass([Autowired("mouseEventService")],GridCtrl.prototype,"mouseEventService",2);__decorateClass([Autowired("dragAndDropService")],GridCtrl.prototype,"dragAndDropService",2);var _a211,GridComp=(_a211=class extends TabGuardComp{constructor(eGridDiv){super(),this.eGridDiv=eGridDiv}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const compProxy={destroyGridUi:()=>this.destroyBean(this),setRtlClass:cssClass=>this.addCssClass(cssClass),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:value=>{this.getGui().style.userSelect=value??"",this.getGui().style.webkitUserSelect=value??""},setCursor:value=>{this.getGui().style.cursor=value??""}};this.ctrl=this.createManagedBean(new GridCtrl);const template=this.createTemplate();this.setTemplate(template),this.ctrl.setComp(compProxy,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:fromBottom=>this.ctrl.focusInnerElement(fromBottom),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const eGui=this.getGui();this.eGridDiv.appendChild(eGui),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(eGui),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(cssClass,params){const eRootWrapperBodyClassList=this.eRootWrapperBody.classList;eRootWrapperBodyClassList.toggle("ag-layout-auto-height",params.autoHeight),eRootWrapperBodyClassList.toggle("ag-layout-normal",params.normal),eRootWrapperBodyClassList.toggle("ag-layout-print",params.print),this.addOrRemoveCssClass("ag-layout-auto-height",params.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",params.normal),this.addOrRemoveCssClass("ag-layout-print",params.print)}createTemplate(){const dropZones=this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"",sideBar=this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"",statusBar=this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"",watermark=this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"";return`<div class="ag-root-wrapper" role="presentation">
                ${dropZones}
                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">
                    <ag-grid-body ref="gridBody"></ag-grid-body>
                    ${sideBar}
                </div>
                ${statusBar}
                <ag-pagination></ag-pagination>
                ${watermark}
            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const focusableContainers=[this.gridBodyComp.getGui()];return this.sideBarComp&&focusableContainers.push(this.sideBarComp.getGui()),focusableContainers.filter(el=>isVisible(el))}},__name(_a211,"GridComp"),_a211);__decorateClass([Autowired("loggerFactory")],GridComp.prototype,"loggerFactory",2);__decorateClass([RefSelector("gridBody")],GridComp.prototype,"gridBodyComp",2);__decorateClass([RefSelector("sideBar")],GridComp.prototype,"sideBarComp",2);__decorateClass([RefSelector("rootWrapperBody")],GridComp.prototype,"eRootWrapperBody",2);__decorateClass([PostConstruct],GridComp.prototype,"postConstruct",1);var _a212,SortController=(_a212=class extends BeanStub{progressSort(column,multiSort,source){const nextDirection=this.getNextSortDirection(column);this.setSortForColumn(column,nextDirection,multiSort,source)}setSortForColumn(column,sort,multiSort,source){sort!=="asc"&&sort!=="desc"&&(sort=null);const isColumnsSortingCoupledToGroup=this.gridOptionsService.isColumnsSortingCoupledToGroup();let columnsToUpdate=[column];if(isColumnsSortingCoupledToGroup&&column.getColDef().showRowGroup){const rowGroupColumns=this.columnModel.getSourceColumnsForGroupColumn(column),sortableRowGroupColumns=rowGroupColumns==null?void 0:rowGroupColumns.filter(col=>col.isSortable());sortableRowGroupColumns&&(columnsToUpdate=[column,...sortableRowGroupColumns])}columnsToUpdate.forEach(col=>col.setSort(sort,source));const doingMultiSort=(multiSort||this.gridOptionsService.get("alwaysMultiSort"))&&!this.gridOptionsService.get("suppressMultiSort"),updatedColumns=[];if(!doingMultiSort){const clearedColumns=this.clearSortBarTheseColumns(columnsToUpdate,source);updatedColumns.push(...clearedColumns)}this.updateSortIndex(column),updatedColumns.push(...columnsToUpdate),this.dispatchSortChangedEvents(source,updatedColumns)}updateSortIndex(lastColToChange){const isCoupled=this.gridOptionsService.isColumnsSortingCoupledToGroup(),groupParent=this.columnModel.getGroupDisplayColumnForGroup(lastColToChange.getId()),lastSortIndexCol=isCoupled&&groupParent||lastColToChange,allSortedCols=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(col=>col.setSortIndex(null));const allSortedColsWithoutChangesOrGroups=allSortedCols.filter(col=>isCoupled&&col.getColDef().showRowGroup?!1:col!==lastSortIndexCol);(lastSortIndexCol.getSort()?[...allSortedColsWithoutChangesOrGroups,lastSortIndexCol]:allSortedColsWithoutChangesOrGroups).forEach((col,idx)=>{col.setSortIndex(idx)})}onSortChanged(source,columns){this.dispatchSortChangedEvents(source,columns)}isSortActive(){const sortedCols=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(column=>!!column.getSort());return sortedCols&&sortedCols.length>0}dispatchSortChangedEvents(source,columns){const event={type:Events.EVENT_SORT_CHANGED,source};columns&&(event.columns=columns),this.eventService.dispatchEvent(event)}clearSortBarTheseColumns(columnsToSkip,source){const clearedColumns=[];return this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(columnToClear=>{columnsToSkip.includes(columnToClear)||(columnToClear.getSort()&&clearedColumns.push(columnToClear),columnToClear.setSort(void 0,source))}),clearedColumns}getNextSortDirection(column){let sortingOrder;if(column.getColDef().sortingOrder?sortingOrder=column.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?sortingOrder=this.gridOptionsService.get("sortingOrder"):sortingOrder=SortController.DEFAULT_SORTING_ORDER,!Array.isArray(sortingOrder)||sortingOrder.length<=0)return console.warn(`AG Grid: sortingOrder must be an array with at least one element, currently it's ${sortingOrder}`),null;const currentIndex=sortingOrder.indexOf(column.getSort()),notInArray=currentIndex<0,lastItemInArray=currentIndex==sortingOrder.length-1;let result;return notInArray||lastItemInArray?result=sortingOrder[0]:result=sortingOrder[currentIndex+1],SortController.DEFAULT_SORTING_ORDER.indexOf(result)<0?(console.warn("AG Grid: invalid sort type "+result),null):result}getIndexedSortMap(){let allSortedCols=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(col=>!!col.getSort());if(this.columnModel.isPivotMode()){const isSortingLinked=this.gridOptionsService.isColumnsSortingCoupledToGroup();allSortedCols=allSortedCols.filter(col=>{const isAggregated=!!col.getAggFunc(),isSecondary=!col.isPrimary(),isGroup=isSortingLinked?this.columnModel.getGroupDisplayColumnForGroup(col.getId()):col.getColDef().showRowGroup;return isAggregated||isSecondary||isGroup})}const sortedRowGroupCols=this.columnModel.getRowGroupColumns().filter(col=>!!col.getSort()),allColsIndexes={};allSortedCols.forEach((col,index)=>allColsIndexes[col.getId()]=index),allSortedCols.sort((a,b)=>{const iA=a.getSortIndex(),iB=b.getSortIndex();if(iA!=null&&iB!=null)return iA-iB;if(iA==null&&iB==null){const posA=allColsIndexes[a.getId()],posB=allColsIndexes[b.getId()];return posA>posB?1:-1}else return iB==null?-1:1});const isSortLinked=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!sortedRowGroupCols.length;isSortLinked&&(allSortedCols=[...new Set(allSortedCols.map(col=>{var _a273;return(_a273=this.columnModel.getGroupDisplayColumnForGroup(col.getId()))!=null?_a273:col}))]);const indexMap=new Map;return allSortedCols.forEach((col,idx)=>indexMap.set(col,idx)),isSortLinked&&sortedRowGroupCols.forEach(col=>{const groupDisplayCol=this.columnModel.getGroupDisplayColumnForGroup(col.getId());indexMap.set(col,indexMap.get(groupDisplayCol))}),indexMap}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([col1,idx1],[col2,idx2])=>idx1-idx2).map(([col])=>col)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(column=>column.getSort()).map(column=>({sort:column.getSort(),colId:column.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(column=>column.getSort()).map(column=>({sort:column.getSort(),column}))}canColumnDisplayMixedSort(column){const isColumnSortCouplingActive=this.gridOptionsService.isColumnsSortingCoupledToGroup(),isGroupDisplayColumn=!!column.getColDef().showRowGroup;return isColumnSortCouplingActive&&isGroupDisplayColumn}getDisplaySortForColumn(column){const linkedColumns=this.columnModel.getSourceColumnsForGroupColumn(column);if(!this.canColumnDisplayMixedSort(column)||!(linkedColumns!=null&&linkedColumns.length))return column.getSort();const sortableColumns=column.getColDef().field!=null||!!column.getColDef().valueGetter?[column,...linkedColumns]:linkedColumns,firstSort=sortableColumns[0].getSort();return sortableColumns.every(col=>col.getSort()==firstSort)?firstSort:"mixed"}getDisplaySortIndexForColumn(column){return this.getIndexedSortMap().get(column)}},__name(_a212,"SortController"),_a212);SortController.DEFAULT_SORTING_ORDER=["asc","desc",null];__decorateClass([Autowired("columnModel")],SortController.prototype,"columnModel",2);SortController=__decorateClass([Bean("sortController")],SortController);var _a213,FocusService=(_a213=class extends BeanStub{static addKeyboardModeEvents(doc){this.instanceCount>0||(doc.addEventListener("keydown",FocusService.toggleKeyboardMode),doc.addEventListener("mousedown",FocusService.toggleKeyboardMode))}static removeKeyboardModeEvents(doc){this.instanceCount>0||(doc.addEventListener("keydown",FocusService.toggleKeyboardMode),doc.addEventListener("mousedown",FocusService.toggleKeyboardMode))}static toggleKeyboardMode(event){const isKeyboardActive=FocusService.keyboardModeActive,isKeyboardEvent=event.type==="keydown";isKeyboardEvent&&(event.ctrlKey||event.metaKey||event.altKey)||isKeyboardActive!==isKeyboardEvent&&(FocusService.keyboardModeActive=isKeyboardEvent)}static unregisterGridCompController(doc){FocusService.removeKeyboardModeEvents(doc)}init(){const clearFocusedCellListener=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,clearFocusedCellListener),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,clearFocusedCellListener),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,clearFocusedCellListener),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(p=>{this.gridCtrl=p.gridCtrl})}registerKeyboardFocusEvents(){const eDocument=this.gridOptionsService.getDocument();FocusService.addKeyboardModeEvents(eDocument),FocusService.instanceCount++,this.addDestroyFunc(()=>{FocusService.instanceCount--,FocusService.unregisterGridCompController(eDocument)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const col=this.focusedCellPosition.column,colFromColumnModel=this.columnModel.getGridColumn(col.getId());col!==colFromColumnModel&&this.clearFocusedCell()}isKeyboardMode(){return FocusService.keyboardModeActive}getFocusCellToUseAfterRefresh(){const eDocument=this.gridOptionsService.getDocument();return this.gridOptionsService.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(eDocument.activeElement,RowCtrl.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){const eDocument=this.gridOptionsService.getDocument();return this.gridOptionsService.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(eDocument.activeElement,AbstractHeaderCellCtrl.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(eBrowserCell,key){let ePointer=eBrowserCell;for(;ePointer;){if(this.gridOptionsService.getDomData(ePointer,key))return!1;ePointer=ePointer.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(cell){return this.isCellRestoreFocused(cell)?(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0):!1}isCellRestoreFocused(cellPosition){return this.restoredFocusedCellPosition==null?!1:this.cellPositionUtils.equals(cellPosition,this.restoredFocusedCellPosition)}setRestoreFocusedCell(cellPosition){this.getFrameworkOverrides().renderingEngine==="react"&&(this.restoredFocusedCellPosition=cellPosition)}getFocusEventParams(){const{rowIndex,rowPinned,column}=this.focusedCellPosition,params={rowIndex,rowPinned,column,isFullWidthCell:!1},rowCtrl=this.rowRenderer.getRowByPosition({rowIndex,rowPinned});return rowCtrl&&(params.isFullWidthCell=rowCtrl.isFullWidth()),params}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,this.focusedCellPosition==null)return;const event=__spreadValues({type:Events.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(event)}setFocusedCell(params){const{column,rowIndex,rowPinned,forceBrowserFocus=!1,preventScrollOnBrowserFocus=!1}=params,gridColumn=this.columnModel.getGridColumn(column);if(!gridColumn){this.focusedCellPosition=null;return}this.focusedCellPosition=gridColumn?{rowIndex,rowPinned:makeNull(rowPinned),column:gridColumn}:null;const event=__spreadProps(__spreadValues({type:Events.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus,preventScrollOnBrowserFocus,floating:null});this.eventService.dispatchEvent(event)}isCellFocused(cellPosition){return this.focusedCellPosition==null?!1:this.cellPositionUtils.equals(cellPosition,this.focusedCellPosition)}isRowNodeFocused(rowNode){return this.isRowFocused(rowNode.rowIndex,rowNode.rowPinned)}isHeaderWrapperFocused(headerCtrl){if(this.focusedHeaderPosition==null)return!1;const column=headerCtrl.getColumnGroupChild(),headerRowIndex=headerCtrl.getRowIndex(),pinned=headerCtrl.getPinned(),{column:focusedColumn,headerRowIndex:focusedHeaderRowIndex}=this.focusedHeaderPosition;return column===focusedColumn&&headerRowIndex===focusedHeaderRowIndex&&pinned==focusedColumn.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(headerRowIndex,column){this.focusedHeaderPosition={headerRowIndex,column}}focusHeaderPosition(params){if(this.gridOptionsService.get("suppressHeaderFocus"))return!1;const{direction,fromTab,allowUserOverride,event,fromCell,rowWithoutSpanValue}=params;let{headerPosition}=params;if(fromCell&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(headerPosition);if(allowUserOverride){const currentPosition=this.getFocusedHeader(),headerRowCount=this.headerNavigationService.getHeaderRowCount();if(fromTab){const userFunc=this.gridOptionsService.getCallback("tabToNextHeader");userFunc&&(headerPosition=userFunc({backwards:direction==="Before",previousHeaderPosition:currentPosition,nextHeaderPosition:headerPosition,headerRowCount}))}else{const userFunc=this.gridOptionsService.getCallback("navigateToNextHeader");if(userFunc&&event){const params2={key:event.key,previousHeaderPosition:currentPosition,nextHeaderPosition:headerPosition,headerRowCount,event};headerPosition=userFunc(params2)}}}if(!headerPosition)return!1;if(headerPosition.headerRowIndex===-1)return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(headerPosition):this.focusGridView(headerPosition.column);this.headerNavigationService.scrollToColumn(headerPosition.column,direction);const focusSuccess=this.ctrlsService.getHeaderRowContainerCtrl(headerPosition.column.getPinned()).focusHeader(headerPosition.headerRowIndex,headerPosition.column,event);return focusSuccess&&(rowWithoutSpanValue!=null||fromCell)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(rowWithoutSpanValue??-1),focusSuccess}focusFirstHeader(){let firstColumn=this.columnModel.getAllDisplayedColumns()[0];if(!firstColumn)return!1;firstColumn.getParent()&&(firstColumn=this.columnModel.getColumnGroupAtLevel(firstColumn,0));const headerPosition=this.headerPositionUtils.getHeaderIndexToFocus(firstColumn,0);return this.focusHeaderPosition({headerPosition,rowWithoutSpanValue:0})}focusLastHeader(event){const headerRowIndex=this.headerNavigationService.getHeaderRowCount()-1,column=last(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex,column},rowWithoutSpanValue:-1,event})}focusPreviousFromFirstCell(event){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(event)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(rowIndex,floating){return this.focusedCellPosition==null?!1:this.focusedCellPosition.rowIndex===rowIndex&&this.focusedCellPosition.rowPinned===makeNull(floating)}findFocusableElements(rootNode,exclude,onlyUnmanaged=!1){const focusableString=FOCUSABLE_SELECTOR;let excludeString=FOCUSABLE_EXCLUDE;exclude&&(excludeString+=", "+exclude),onlyUnmanaged&&(excludeString+=', [tabindex="-1"]');const nodes=Array.prototype.slice.apply(rootNode.querySelectorAll(focusableString)).filter(node=>isVisible(node)),excludeNodes=Array.prototype.slice.apply(rootNode.querySelectorAll(excludeString));return excludeNodes.length?__name((a,b)=>a.filter(element=>b.indexOf(element)===-1),"diff")(nodes,excludeNodes):nodes}focusInto(rootNode,up=!1,onlyUnmanaged=!1){const focusableElements=this.findFocusableElements(rootNode,null,onlyUnmanaged),toFocus=up?last(focusableElements):focusableElements[0];return toFocus?(toFocus.focus({preventScroll:!0}),!0):!1}findFocusableElementBeforeTabGuard(rootNode,referenceElement){if(!referenceElement)return null;const focusableElements=this.findFocusableElements(rootNode),referenceIndex=focusableElements.indexOf(referenceElement);if(referenceIndex===-1)return null;let lastTabGuardIndex=-1;for(let i=referenceIndex-1;i>=0;i--)if(focusableElements[i].classList.contains("ag-tab-guard-top")){lastTabGuardIndex=i;break}return lastTabGuardIndex<=0?null:focusableElements[lastTabGuardIndex-1]}findNextFocusableElement(rootNode=this.eGridDiv,onlyManaged,backwards){const focusable=this.findFocusableElements(rootNode,onlyManaged?':not([tabindex="-1"])':null),activeEl=this.gridOptionsService.getDocument().activeElement;let currentIndex;onlyManaged?currentIndex=focusable.findIndex(el=>el.contains(activeEl)):currentIndex=focusable.indexOf(activeEl);const nextIndex=currentIndex+(backwards?-1:1);return nextIndex<0||nextIndex>=focusable.length?null:focusable[nextIndex]}isTargetUnderManagedComponent(rootNode,target){if(!target)return!1;const managedContainers=rootNode.querySelectorAll(`.${ManagedFocusFeature.FOCUS_MANAGED_CLASS}`);if(!managedContainers.length)return!1;for(let i=0;i<managedContainers.length;i++)if(managedContainers[i].contains(target))return!0;return!1}findTabbableParent(node,limit=5){let counter=0;for(;node&&getTabIndex(node)===null&&++counter<=limit;)node=node.parentElement;return getTabIndex(node)===null?null:node}focusGridView(column,backwards){if(this.gridOptionsService.get("suppressCellFocus"))return backwards?this.gridOptionsService.get("suppressHeaderFocus")?this.focusNextGridCoreContainer(!0,!0):this.focusLastHeader():this.focusNextGridCoreContainer(!1);const nextRow=backwards?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!nextRow)return!1;const{rowIndex,rowPinned}=nextRow,focusedHeader=this.getFocusedHeader();if(!column&&focusedHeader&&(column=focusedHeader.column),rowIndex==null||!column)return!1;if(this.navigationService.ensureCellVisible({rowIndex,column,rowPinned}),this.setFocusedCell({rowIndex,column,rowPinned:makeNull(rowPinned),forceBrowserFocus:!0}),this.rangeService){const cellPosition={rowIndex,rowPinned,column};this.rangeService.setRangeToCell(cellPosition)}return!0}focusNextGridCoreContainer(backwards,forceOut=!1){return!forceOut&&this.gridCtrl.focusNextInnerContainer(backwards)?!0:((forceOut||!backwards&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(backwards),!1)}focusAdvancedFilter(position){return this.advancedFilterFocusColumn=position==null?void 0:position.column,this.advancedFilterService.getCtrl().focusHeaderComp()}focusNextFromAdvancedFilter(backwards,forceFirstColumn){var _a273,_b;const column=(_b=forceFirstColumn?void 0:this.advancedFilterFocusColumn)!=null?_b:(_a273=this.columnModel.getAllDisplayedColumns())==null?void 0:_a273[0];return backwards?this.focusHeaderPosition({headerPosition:{column,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(column)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}},__name(_a213,"FocusService"),_a213);FocusService.keyboardModeActive=!1;FocusService.instanceCount=0;__decorateClass([Autowired("eGridDiv")],FocusService.prototype,"eGridDiv",2);__decorateClass([Autowired("columnModel")],FocusService.prototype,"columnModel",2);__decorateClass([Autowired("headerNavigationService")],FocusService.prototype,"headerNavigationService",2);__decorateClass([Autowired("headerPositionUtils")],FocusService.prototype,"headerPositionUtils",2);__decorateClass([Autowired("rowRenderer")],FocusService.prototype,"rowRenderer",2);__decorateClass([Autowired("rowPositionUtils")],FocusService.prototype,"rowPositionUtils",2);__decorateClass([Autowired("cellPositionUtils")],FocusService.prototype,"cellPositionUtils",2);__decorateClass([Optional("rangeService")],FocusService.prototype,"rangeService",2);__decorateClass([Autowired("navigationService")],FocusService.prototype,"navigationService",2);__decorateClass([Autowired("ctrlsService")],FocusService.prototype,"ctrlsService",2);__decorateClass([Autowired("filterManager")],FocusService.prototype,"filterManager",2);__decorateClass([Optional("advancedFilterService")],FocusService.prototype,"advancedFilterService",2);__decorateClass([PostConstruct],FocusService.prototype,"init",1);FocusService=__decorateClass([Bean("focusService")],FocusService);var _a214,ColumnHoverService=(_a214=class extends BeanStub{setMouseOver(columns){this.selectedColumns=columns;const event={type:Events.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(event)}clearMouseOver(){this.selectedColumns=null;const event={type:Events.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(event)}isHovered(column){return!!this.selectedColumns&&this.selectedColumns.indexOf(column)>=0}},__name(_a214,"ColumnHoverService"),_a214);ColumnHoverService=__decorateClass([Bean("columnHoverService")],ColumnHoverService);var _a215,ColumnAnimationService=(_a215=class extends BeanStub{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(p=>this.gridBodyCtrl=p.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(suppress){this.suppressAnimation=suppress}start(){this.active||this.gridOptionsService.get("suppressColumnMoveAnimation")||this.gridOptionsService.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&this.flush(()=>{this.active=!1})}executeNextVMTurn(func){this.active?this.executeNextFuncs.push(func):func()}executeLaterVMTurn(func){this.active?this.executeLaterFuncs.push(func):func()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const animationThreadCountCopy=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===animationThreadCountCopy&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(callback){if(this.executeNextFuncs.length===0&&this.executeLaterFuncs.length===0){callback();return}const runFuncs=__name(queue=>{for(;queue.length;){const func=queue.pop();func&&func()}},"runFuncs");this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>runFuncs(this.executeNextFuncs),0),window.setTimeout(()=>{runFuncs(this.executeLaterFuncs),callback()},200)})}},__name(_a215,"ColumnAnimationService"),_a215);__decorateClass([Autowired("ctrlsService")],ColumnAnimationService.prototype,"ctrlsService",2);__decorateClass([PostConstruct],ColumnAnimationService.prototype,"postConstruct",1);ColumnAnimationService=__decorateClass([Bean("columnAnimationService")],ColumnAnimationService);var _a216,PaginationAutoPageSizeService=(_a216=class extends BeanStub{postConstruct(){this.ctrlsService.whenReady(p=>{this.centerRowContainerCon=p.centerRowContainerCtrl,this.addManagedListener(this.eventService,Events.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gridOptionsService.get("paginationAutoPageSize")||this.centerRowContainerCon==null}onPaginationAutoSizeChanged(){this.notActive()?this.paginationProxy.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const bodyHeight=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(bodyHeight>0){const update=__name(()=>{const rowHeight=this.gridOptionsService.getRowHeightAsNumber(),newPageSize=Math.floor(bodyHeight/rowHeight);this.paginationProxy.setPageSize(newPageSize,"autoCalculated")},"update");this.isBodyRendered?debounce(()=>update(),50)():(update(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},__name(_a216,"PaginationAutoPageSizeService"),_a216);__decorateClass([Autowired("ctrlsService")],PaginationAutoPageSizeService.prototype,"ctrlsService",2);__decorateClass([Autowired("paginationProxy")],PaginationAutoPageSizeService.prototype,"paginationProxy",2);__decorateClass([PostConstruct],PaginationAutoPageSizeService.prototype,"postConstruct",1);PaginationAutoPageSizeService=__decorateClass([Bean("paginationAutoPageSizeService")],PaginationAutoPageSizeService);var _a217,ValueCache=(_a217=class extends BeanStub{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gridOptionsService.get("valueCache"),this.neverExpires=this.gridOptionsService.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(rowNode,colId,value){this.active&&(rowNode.__cacheVersion!==this.cacheVersion&&(rowNode.__cacheVersion=this.cacheVersion,rowNode.__cacheData={}),rowNode.__cacheData[colId]=value)}getValue(rowNode,colId){if(!(!this.active||rowNode.__cacheVersion!==this.cacheVersion))return rowNode.__cacheData[colId]}},__name(_a217,"ValueCache"),_a217);__decorateClass([PostConstruct],ValueCache.prototype,"init",1);ValueCache=__decorateClass([Bean("valueCache")],ValueCache);var SOURCE_PASTE="paste",_a218,ChangeDetectionService=(_a218=class extends BeanStub{init(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,Events.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(event){event.source!==SOURCE_PASTE&&this.doChangeDetection(event.node,event.column)}doChangeDetection(rowNode,column){if(this.gridOptionsService.get("suppressChangeDetection"))return;const nodesToRefresh=[rowNode];if(this.clientSideRowModel&&!rowNode.isRowPinned()){const onlyChangedColumns=this.gridOptionsService.get("aggregateOnlyChangedColumns"),changedPath=new ChangedPath(onlyChangedColumns,this.clientSideRowModel.getRootNode());changedPath.addParentNode(rowNode.parent,[column]),this.clientSideRowModel.doAggregate(changedPath),changedPath.forEachChangedNodeDepthFirst(rowNode2=>{nodesToRefresh.push(rowNode2)})}this.rowRenderer.refreshCells({rowNodes:nodesToRefresh})}},__name(_a218,"ChangeDetectionService"),_a218);__decorateClass([Autowired("rowModel")],ChangeDetectionService.prototype,"rowModel",2);__decorateClass([Autowired("rowRenderer")],ChangeDetectionService.prototype,"rowRenderer",2);__decorateClass([PostConstruct],ChangeDetectionService.prototype,"init",1);ChangeDetectionService=__decorateClass([Bean("changeDetectionService")],ChangeDetectionService);var _a219,AgComponentUtils=(_a219=class extends BeanStub{adaptFunction(propertyName,jsCompFunc){const metadata=this.componentMetadataProvider.retrieve(propertyName);return metadata&&metadata.functionAdapter?metadata.functionAdapter(jsCompFunc):null}adaptCellRendererFunction(callback){const _Adapter=class _Adapter{refresh(params){return!1}getGui(){return this.eGui}init(params){const callbackResult=callback(params),type=typeof callbackResult;if(type==="string"||type==="number"||type==="boolean"){this.eGui=loadTemplate("<span>"+callbackResult+"</span>");return}if(callbackResult==null){this.eGui=loadTemplate("<span></span>");return}this.eGui=callbackResult}};__name(_Adapter,"Adapter");let Adapter=_Adapter;return Adapter}doesImplementIComponent(candidate){return candidate?candidate.prototype&&"getGui"in candidate.prototype:!1}},__name(_a219,"AgComponentUtils"),_a219);__decorateClass([Autowired("componentMetadataProvider")],AgComponentUtils.prototype,"componentMetadataProvider",2);AgComponentUtils=__decorateClass([Bean("agComponentUtils")],AgComponentUtils);var _a220,ComponentMetadataProvider=(_a220=class extends BeanStub{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(name){return this.componentMetaData[name]}},__name(_a220,"ComponentMetadataProvider"),_a220);__decorateClass([Autowired("agComponentUtils")],ComponentMetadataProvider.prototype,"agComponentUtils",2);__decorateClass([PostConstruct],ComponentMetadataProvider.prototype,"postConstruct",1);ComponentMetadataProvider=__decorateClass([Bean("componentMetadataProvider")],ComponentMetadataProvider);var DEFAULT_ROW_HEIGHT=25,MIN_COL_WIDTH=10,MAT_GRID_SIZE=8,BASE_GRID_SIZE=4,BALHAM_GRID_SIZE=4,ALPINE_GRID_SIZE=6,QUARTZ_ICON_SIZE=16,QUARTZ_FONT_SIZE=14,QUARTZ_GRID_SIZE=8,HARD_CODED_SIZES={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:BASE_GRID_SIZE*5,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:MAT_GRID_SIZE*7,headerCellMinWidth:48,listItemHeight:MAT_GRID_SIZE*4,rowHeight:MAT_GRID_SIZE*6,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:BALHAM_GRID_SIZE*8,headerCellMinWidth:24,listItemHeight:BALHAM_GRID_SIZE*6,rowHeight:BALHAM_GRID_SIZE*7,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:ALPINE_GRID_SIZE*8,headerCellMinWidth:36,listItemHeight:ALPINE_GRID_SIZE*4,rowHeight:ALPINE_GRID_SIZE*7,chartMenuPanelWidth:240},"ag-theme-quartz":{headerHeight:QUARTZ_FONT_SIZE+QUARTZ_GRID_SIZE*4.25,headerCellMinWidth:36,listItemHeight:QUARTZ_ICON_SIZE+QUARTZ_GRID_SIZE,rowHeight:QUARTZ_FONT_SIZE+QUARTZ_GRID_SIZE*3.5,chartMenuPanelWidth:260}},SASS_PROPERTY_BUILDER={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},_a221,Environment=(_a221=class extends BeanStub{constructor(){super(...arguments),this.calculatedSizes={}}postConstruct(){var _a273;const el=(_a273=this.getTheme().el)!=null?_a273:this.eGridDiv;this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(el||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const event={type:Events.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(event)}getSassVariable(key){const{themeFamily,el}=this.getTheme();if(!themeFamily||themeFamily.indexOf("ag-theme")!==0)return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[themeFamily]||(this.calculatedSizes[themeFamily]={});const size=this.calculatedSizes[themeFamily][key];return size??(this.calculatedSizes[themeFamily][key]=this.calculateValueForSassProperty(key,themeFamily,el),this.calculatedSizes[themeFamily][key])}calculateValueForSassProperty(property,theme,themeElement){const useTheme="ag-theme-"+(theme.match("material")?"material":theme.match("balham")?"balham":theme.match("alpine")?"alpine":"custom"),defaultValue=HARD_CODED_SIZES[useTheme][property],eDocument=this.gridOptionsService.getDocument();if(themeElement||(themeElement=this.eGridDiv),!SASS_PROPERTY_BUILDER[property])return defaultValue;const classList=SASS_PROPERTY_BUILDER[property],div=eDocument.createElement("div"),classesFromThemeElement=Array.from(themeElement.classList);div.classList.add(theme,...classesFromThemeElement),div.style.position="absolute";const el=classList.reduce((prevEl,currentClass)=>{const currentDiv=eDocument.createElement("div");return currentDiv.style.position="static",currentDiv.classList.add(currentClass),prevEl.appendChild(currentDiv),currentDiv},div);let calculatedValue=0;if(eDocument.body){eDocument.body.appendChild(div);const sizeName=property.toLowerCase().indexOf("height")!==-1?"height":"width";calculatedValue=parseInt(window.getComputedStyle(el)[sizeName],10),eDocument.body.removeChild(div)}return calculatedValue||defaultValue}isThemeDark(){const{theme}=this.getTheme();return!!theme&&theme.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){const reg=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let el=this.eGridDiv,themeMatch=null,allThemes=[];for(;el;)if(themeMatch=reg.exec(el.className),!themeMatch)el=el.parentElement||void 0;else{const matched=el.className.match(reg);matched&&(allThemes=matched);break}if(!themeMatch)return{allThemes};const theme=themeMatch[0];return{theme,el,themeFamily:theme.replace(/-dark$/,""),allThemes}}getFromTheme(defaultValue,sassVariableName){var _a273;return(_a273=this.getSassVariable(sassVariableName))!=null?_a273:defaultValue}getDefaultRowHeight(){return this.getFromTheme(DEFAULT_ROW_HEIGHT,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}refreshRowHeightVariable(){const oldRowHeight=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),height=this.gridOptionsService.get("rowHeight");if(height==null||isNaN(height)||!isFinite(height))return oldRowHeight!==null&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const newRowHeight=`${height}px`;return oldRowHeight!=newRowHeight?(this.eGridDiv.style.setProperty("--ag-line-height",newRowHeight),height):oldRowHeight!=""?parseFloat(oldRowHeight):-1}getMinColWidth(){const measuredMin=this.getFromTheme(null,"headerCellMinWidth");return exists(measuredMin)?Math.max(measuredMin,MIN_COL_WIDTH):MIN_COL_WIDTH}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}},__name(_a221,"Environment"),_a221);__decorateClass([Autowired("eGridDiv")],Environment.prototype,"eGridDiv",2);__decorateClass([PostConstruct],Environment.prototype,"postConstruct",1);Environment=__decorateClass([Bean("environment")],Environment);var _a222,RowContainerHeightService=(_a222=class extends BeanStub{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(loggerFactory){this.logger=loggerFactory.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=getMaxDivHeight(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const newScrollY=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,newBodyHeight=this.getUiBodyHeight();(newScrollY!==this.scrollY||newBodyHeight!==this.uiBodyHeight)&&(this.scrollY=newScrollY,this.uiBodyHeight=newBodyHeight,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const scrollPercent=this.scrollY/this.maxScrollY,divStretchOffset=scrollPercent*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${divStretchOffset} (${this.pixelsToShave} * ${scrollPercent})`),this.setDivStretchOffset(divStretchOffset)}setUiContainerHeight(height){height!==this.uiContainerHeight&&(this.uiContainerHeight=height,this.eventService.dispatchEvent({type:Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(newOffset){const newOffsetFloor=typeof newOffset=="number"?Math.floor(newOffset):null;this.divStretchOffset!==newOffsetFloor&&(this.divStretchOffset=newOffsetFloor,this.eventService.dispatchEvent({type:Events.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(modelHeight){this.modelHeight=modelHeight,this.stretching=modelHeight!=null&&this.maxDivHeight>0&&modelHeight>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(modelPixel){return modelPixel-this.divStretchOffset}getUiBodyHeight(){const pos=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return pos.bottom-pos.top}getScrollPositionForPixel(rowTop){if(this.pixelsToShave<=0)return rowTop;const modelMaxScroll=this.modelHeight-this.getUiBodyHeight(),scrollPercent=rowTop/modelMaxScroll;return this.maxScrollY*scrollPercent}},__name(_a222,"RowContainerHeightService"),_a222);__decorateClass([Autowired("ctrlsService")],RowContainerHeightService.prototype,"ctrlsService",2);__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],RowContainerHeightService.prototype,"agWire",1);__decorateClass([PostConstruct],RowContainerHeightService.prototype,"postConstruct",1);RowContainerHeightService=__decorateClass([Bean("rowContainerHeightService")],RowContainerHeightService);var _a223,SelectableService=(_a223=class extends BeanStub{init(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(skipLeafNodes=!1){const isRowSelecting=!!this.gridOptionsService.get("rowSelection"),isRowSelectable=this.gridOptionsService.get("isRowSelectable");if(!isRowSelecting||!isRowSelectable)return;const isGroupSelectsChildren=this.gridOptionsService.get("groupSelectsChildren"),isCsrmGroupSelectsChildren=this.rowModel.getType()==="clientSide"&&isGroupSelectsChildren,nodesToDeselect=[],nodeCallback=__name(node=>{if(skipLeafNodes&&!node.group)return;if(isCsrmGroupSelectsChildren&&node.group){const hasSelectableChild=node.childrenAfterGroup.some(rowNode=>rowNode.selectable===!0);node.setRowSelectable(hasSelectableChild,!0);return}const rowSelectable=isRowSelectable?isRowSelectable(node):!0;node.setRowSelectable(rowSelectable,!0),!rowSelectable&&node.isSelected()&&nodesToDeselect.push(node)},"nodeCallback");if(isCsrmGroupSelectsChildren){const csrm=this.rowModel;new ChangedPath(!1,csrm.getRootNode()).forEachChangedNodeDepthFirst(nodeCallback,!0,!0)}else this.rowModel.forEachNode(nodeCallback);nodesToDeselect.length&&this.selectionService.setNodesSelected({nodes:nodesToDeselect,newValue:!1,source:"selectableChanged"}),isCsrmGroupSelectsChildren&&this.selectionService instanceof SelectionService&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}},__name(_a223,"SelectableService"),_a223);__decorateClass([Autowired("rowModel")],SelectableService.prototype,"rowModel",2);__decorateClass([Autowired("selectionService")],SelectableService.prototype,"selectionService",2);__decorateClass([PostConstruct],SelectableService.prototype,"init",1);SelectableService=__decorateClass([Bean("selectableService")],SelectableService);var _a224,PaginationComp=(_a224=class extends Component{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const isRtl=this.gridOptionsService.get("enableRtl");this.setTemplate(this.getTemplate());const{btFirst,btPrevious,btNext,btLast,pageSizeComp}=this;this.activateTabIndex([btFirst,btPrevious,btNext,btLast]),btFirst.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"last":"first",this.gridOptionsService)),btPrevious.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"next":"previous",this.gridOptionsService)),btNext.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"previous":"next",this.gridOptionsService)),btLast.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.onPaginationChanged()}onPaginationChanged(){const paginationPanelEnabled=this.gridOptionsService.get("pagination")&&!this.gridOptionsService.get("suppressPaginationPanel");this.setDisplayed(paginationPanelEnabled),paginationPanelEnabled&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(item=>{const{el,fn}=item;this.addManagedListener(el,"click",fn),this.addManagedListener(el,"keydown",e=>{(e.key===KeyCode.ENTER||e.key===KeyCode.SPACE)&&(e.preventDefault(),fn())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const pagesExist=this.paginationProxy.getTotalPages()>0,currentPage=this.paginationProxy.getCurrentPage(),toDisplay=pagesExist?currentPage+1:0;this.lbCurrent.textContent=this.formatNumber(toDisplay)}formatNumber(value){const userFunc=this.gridOptionsService.getCallback("paginationNumberFormatter");if(userFunc)return userFunc({value});const localeTextFunc=this.localeService.getLocaleTextFunc(),thousandSeparator=localeTextFunc("thousandSeparator",","),decimalSeparator=localeTextFunc("decimalSeparator",".");return formatNumberCommas(value,thousandSeparator,decimalSeparator)}getTemplate(){const localeTextFunc=this.localeService.getLocaleTextFunc(),strPage=localeTextFunc("page","Page"),strTo=localeTextFunc("to","to"),strOf=localeTextFunc("of","of"),strFirst=localeTextFunc("firstPage","First Page"),strPrevious=localeTextFunc("previousPage","Previous Page"),strNext=localeTextFunc("nextPage","Next Page"),strLast=localeTextFunc("lastPage","Last Page"),compId=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${compId}">
                <ag-page-size-selector ref="pageSizeComp"></ag-page-size-selector>
                <span class="ag-paging-row-summary-panel" role="status">
                    <span id="ag-${compId}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${compId}-to">${strTo}</span>
                    <span id="ag-${compId}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${compId}-of">${strOf}</span>
                    <span id="ag-${compId}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>
                </span>
                <span class="ag-paging-page-summary-panel" role="presentation">
                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${strFirst}"></div>
                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${strPrevious}"></div>
                    <span class="ag-paging-description" role="status">
                        <span id="ag-${compId}-start-page">${strPage}</span>
                        <span id="ag-${compId}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>
                        <span id="ag-${compId}-of-page">${strOf}</span>
                        <span id="ag-${compId}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>
                    </span>
                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${strNext}"></div>
                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${strLast}"></div>
                </span>
            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const currentPage=this.paginationProxy.getCurrentPage(),maxRowFound=this.paginationProxy.isLastPageFound(),totalPages=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=currentPage===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const zeroPagesToDisplay=this.isZeroPagesToDisplay(),onLastPage=currentPage===totalPages-1;this.nextButtonDisabled=onLastPage||zeroPagesToDisplay,this.lastButtonDisabled=!maxRowFound||zeroPagesToDisplay||currentPage===totalPages-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(button,disabled){setAriaDisabled(button,disabled),button.classList.toggle("ag-disabled",disabled)}updateRowLabels(){const currentPage=this.paginationProxy.getCurrentPage(),pageSize=this.paginationProxy.getPageSize(),maxRowFound=this.paginationProxy.isLastPageFound(),rowCount=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let startRow,endRow;if(this.isZeroPagesToDisplay()?startRow=endRow=0:(startRow=pageSize*currentPage+1,endRow=startRow+pageSize-1,maxRowFound&&endRow>rowCount&&(endRow=rowCount)),this.lbFirstRowOnPage.textContent=this.formatNumber(startRow),this.rowNodeBlockLoader.isLoading()){const translate=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=translate("pageLastRowUnknown","?")}else this.lbLastRowOnPage.textContent=this.formatNumber(endRow)}isZeroPagesToDisplay(){const maxRowFound=this.paginationProxy.isLastPageFound(),totalPages=this.paginationProxy.getTotalPages();return maxRowFound&&totalPages===0}setTotalLabels(){const lastPageFound=this.paginationProxy.isLastPageFound(),totalPages=this.paginationProxy.getTotalPages(),rowCount=lastPageFound?this.paginationProxy.getMasterRowCount():null;if(rowCount===1){const firstRow=this.paginationProxy.getRow(0);if(firstRow&&firstRow.group&&!(firstRow.groupData||firstRow.aggData)){this.setTotalLabelsToZero();return}}if(lastPageFound)this.lbTotal.textContent=this.formatNumber(totalPages),this.lbRecordCount.textContent=this.formatNumber(rowCount);else{const moreText=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=moreText,this.lbRecordCount.innerHTML=moreText}}setTotalLabelsToZero(){this.lbFirstRowOnPage.textContent=this.formatNumber(0),this.lbCurrent.textContent=this.formatNumber(0),this.lbLastRowOnPage.textContent=this.formatNumber(0),this.lbTotal.textContent=this.formatNumber(0),this.lbRecordCount.textContent=this.formatNumber(0)}},__name(_a224,"PaginationComp"),_a224);__decorateClass([Autowired("paginationProxy")],PaginationComp.prototype,"paginationProxy",2);__decorateClass([Autowired("rowNodeBlockLoader")],PaginationComp.prototype,"rowNodeBlockLoader",2);__decorateClass([RefSelector("btFirst")],PaginationComp.prototype,"btFirst",2);__decorateClass([RefSelector("btPrevious")],PaginationComp.prototype,"btPrevious",2);__decorateClass([RefSelector("btNext")],PaginationComp.prototype,"btNext",2);__decorateClass([RefSelector("btLast")],PaginationComp.prototype,"btLast",2);__decorateClass([RefSelector("lbRecordCount")],PaginationComp.prototype,"lbRecordCount",2);__decorateClass([RefSelector("lbFirstRowOnPage")],PaginationComp.prototype,"lbFirstRowOnPage",2);__decorateClass([RefSelector("lbLastRowOnPage")],PaginationComp.prototype,"lbLastRowOnPage",2);__decorateClass([RefSelector("lbCurrent")],PaginationComp.prototype,"lbCurrent",2);__decorateClass([RefSelector("lbTotal")],PaginationComp.prototype,"lbTotal",2);__decorateClass([RefSelector("pageSizeComp")],PaginationComp.prototype,"pageSizeComp",2);__decorateClass([PostConstruct],PaginationComp.prototype,"postConstruct",1);var _a225,_OverlayWrapperComponent=(_a225=class extends Component{constructor(){super(_a225.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1}updateLayoutClasses(cssClass,params){const overlayWrapperClassList=this.eOverlayWrapper.classList;overlayWrapperClassList.toggle("ag-layout-auto-height",params.autoHeight),overlayWrapperClassList.toggle("ag-layout-normal",params.normal),overlayWrapperClassList.toggle("ag-layout-print",params.print)}postConstruct(){this.createManagedBean(new LayoutFeature(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.registerOverlayWrapperComp(this)}setWrapperTypeClass(overlayWrapperCssClass){const overlayWrapperClassList=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&overlayWrapperClassList.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=overlayWrapperCssClass,overlayWrapperClassList.toggle(overlayWrapperCssClass,!0)}showOverlay(overlayComp,overlayWrapperCssClass,updateListenerDestroyFunc){this.inProgress||(this.setWrapperTypeClass(overlayWrapperCssClass),this.destroyActiveOverlay(),this.inProgress=!0,overlayComp&&overlayComp.then(comp=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(comp.getGui()),this.activeOverlay=comp,this.updateListenerDestroyFunc=updateListenerDestroyFunc,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){var _a273;if(this.inProgress){this.destroyRequested=!0;return}this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),(_a273=this.updateListenerDestroyFunc)==null||_a273.call(this),clearElement(this.eOverlayWrapper))}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}},__name(_a225,"_OverlayWrapperComponent"),_a225);_OverlayWrapperComponent.TEMPLATE=`
        <div class="ag-overlay" role="presentation">
            <div class="ag-overlay-panel" role="presentation">
                <div class="ag-overlay-wrapper" ref="eOverlayWrapper" role="presentation"></div>
            </div>
        </div>`;__decorateClass([Autowired("overlayService")],_OverlayWrapperComponent.prototype,"overlayService",2);__decorateClass([RefSelector("eOverlayWrapper")],_OverlayWrapperComponent.prototype,"eOverlayWrapper",2);__decorateClass([PostConstruct],_OverlayWrapperComponent.prototype,"postConstruct",1);var OverlayWrapperComponent=_OverlayWrapperComponent,_a226,RowPositionUtils=(_a226=class extends BeanStub{getFirstRow(){let rowIndex=0,rowPinned;return this.pinnedRowModel.getPinnedTopRowCount()?rowPinned="top":this.rowModel.getRowCount()?(rowPinned=null,rowIndex=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(rowPinned="bottom"),rowPinned===void 0?null:{rowIndex,rowPinned}}getLastRow(){let rowIndex,rowPinned=null;const pinnedBottomCount=this.pinnedRowModel.getPinnedBottomRowCount(),pinnedTopCount=this.pinnedRowModel.getPinnedTopRowCount();return pinnedBottomCount?(rowPinned="bottom",rowIndex=pinnedBottomCount-1):this.rowModel.getRowCount()?(rowPinned=null,rowIndex=this.paginationProxy.getPageLastRow()):pinnedTopCount&&(rowPinned="top",rowIndex=pinnedTopCount-1),rowIndex===void 0?null:{rowIndex,rowPinned}}getRowNode(gridRow){switch(gridRow.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];default:return this.rowModel.getRow(gridRow.rowIndex)}}sameRow(rowA,rowB){return!rowA&&!rowB?!0:rowA&&!rowB||!rowA&&rowB?!1:rowA.rowIndex===rowB.rowIndex&&rowA.rowPinned==rowB.rowPinned}before(rowA,rowB){switch(rowA.rowPinned){case"top":if(rowB.rowPinned!=="top")return!0;break;case"bottom":if(rowB.rowPinned!=="bottom")return!1;break;default:if(exists(rowB.rowPinned))return rowB.rowPinned!=="top";break}return rowA.rowIndex<rowB.rowIndex}rowMax(rows){let max;return rows.forEach(row=>{(max===void 0||this.before(max,row))&&(max=row)}),max}rowMin(rows){let min;return rows.forEach(row=>{(min===void 0||this.before(row,min))&&(min=row)}),min}},__name(_a226,"RowPositionUtils"),_a226);__decorateClass([Autowired("rowModel")],RowPositionUtils.prototype,"rowModel",2);__decorateClass([Autowired("pinnedRowModel")],RowPositionUtils.prototype,"pinnedRowModel",2);__decorateClass([Autowired("paginationProxy")],RowPositionUtils.prototype,"paginationProxy",2);RowPositionUtils=__decorateClass([Bean("rowPositionUtils")],RowPositionUtils);var _a227,CellPositionUtils=(_a227=class extends BeanStub{createId(cellPosition){const{rowIndex,rowPinned,column}=cellPosition;return this.createIdFromValues({rowIndex,column,rowPinned})}createIdFromValues(cellPosition){const{rowIndex,rowPinned,column}=cellPosition;return`${rowIndex}.${rowPinned??"null"}.${column.getId()}`}equals(cellA,cellB){const colsMatch=cellA.column===cellB.column,floatingMatch=cellA.rowPinned===cellB.rowPinned,indexMatch=cellA.rowIndex===cellB.rowIndex;return colsMatch&&floatingMatch&&indexMatch}},__name(_a227,"CellPositionUtils"),_a227);CellPositionUtils=__decorateClass([Bean("cellPositionUtils")],CellPositionUtils);var _a228,UndoRedoAction=(_a228=class{constructor(cellValueChanges){this.cellValueChanges=cellValueChanges}},__name(_a228,"UndoRedoAction"),_a228),_a229,RangeUndoRedoAction=(_a229=class extends UndoRedoAction{constructor(cellValueChanges,initialRange,finalRange,ranges){super(cellValueChanges),this.initialRange=initialRange,this.finalRange=finalRange,this.ranges=ranges}},__name(_a229,"RangeUndoRedoAction"),_a229),_a230,_UndoRedoStack=(_a230=class{constructor(maxStackSize){this.actionStack=[],this.maxStackSize=maxStackSize||_a230.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(item){item.cellValueChanges&&item.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(item))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},__name(_a230,"_UndoRedoStack"),_a230);_UndoRedoStack.DEFAULT_STACK_SIZE=10;var UndoRedoStack=_UndoRedoStack,_a231,UndoRedoService=(_a231=class extends BeanStub{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=event=>{const eventCell={column:event.column,rowIndex:event.rowIndex,rowPinned:event.rowPinned},isCellEditing=this.activeCellEdit!==null&&this.cellPositionUtils.equals(this.activeCellEdit,eventCell),isRowEditing=this.activeRowEdit!==null&&this.rowPositionUtils.sameRow(this.activeRowEdit,eventCell);if(!(isCellEditing||isRowEditing||this.isPasting||this.isRangeInAction))return;const{rowPinned,rowIndex,column,oldValue,value}=event,cellValueChange={rowPinned,rowIndex,columnId:column.getColId(),newValue:value,oldValue};this.cellValueChanges.push(cellValueChange)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gridOptionsService.get("undoRedoCellEditing"))return;const undoRedoLimit=this.gridOptionsService.get("undoRedoCellEditingLimit");undoRedoLimit<=0||(this.undoStack=new UndoRedoStack(undoRedoLimit),this.redoStack=new UndoRedoStack(undoRedoLimit),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,Events.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,Events.EVENT_MODEL_UPDATED,e=>{e.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl()}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(source){const startEvent={type:Events.EVENT_UNDO_STARTED,source};this.eventService.dispatchEvent(startEvent);const operationPerformed=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),endEvent={type:Events.EVENT_UNDO_ENDED,source,operationPerformed};this.eventService.dispatchEvent(endEvent)}redo(source){const startEvent={type:Events.EVENT_REDO_STARTED,source};this.eventService.dispatchEvent(startEvent);const operationPerformed=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),endEvent={type:Events.EVENT_REDO_ENDED,source,operationPerformed};this.eventService.dispatchEvent(endEvent)}undoRedo(undoRedoStack,opposingUndoRedoStack,rangeProperty,cellValueChangeProperty,source){if(!undoRedoStack)return!1;const undoRedoAction=undoRedoStack.pop();return!undoRedoAction||!undoRedoAction.cellValueChanges?!1:(this.processAction(undoRedoAction,cellValueChange=>cellValueChange[cellValueChangeProperty],source),undoRedoAction instanceof RangeUndoRedoAction?this.processRange(undoRedoAction.ranges||[undoRedoAction[rangeProperty]]):this.processCell(undoRedoAction.cellValueChanges),opposingUndoRedoStack.push(undoRedoAction),!0)}processAction(action,valueExtractor,source){action.cellValueChanges.forEach(cellValueChange=>{const{rowIndex,rowPinned,columnId}=cellValueChange,rowPosition={rowIndex,rowPinned},currentRow=this.getRowNode(rowPosition);currentRow.displayed&&currentRow.setDataValue(columnId,valueExtractor(cellValueChange),source)})}processRange(ranges){let lastFocusedCell;this.rangeService.removeAllCellRanges(!0),ranges.forEach((range,idx)=>{if(!range)return;const startRow=range.startRow,endRow=range.endRow;idx===ranges.length-1&&(lastFocusedCell={rowPinned:startRow.rowPinned,rowIndex:startRow.rowIndex,columnId:range.startColumn.getColId()},this.setLastFocusedCell(lastFocusedCell));const cellRangeParams={rowStartIndex:startRow.rowIndex,rowStartPinned:startRow.rowPinned,rowEndIndex:endRow.rowIndex,rowEndPinned:endRow.rowPinned,columnStart:range.startColumn,columns:range.columns};this.rangeService.addCellRange(cellRangeParams)})}processCell(cellValueChanges){const cellValueChange=cellValueChanges[0],{rowIndex,rowPinned}=cellValueChange,rowPosition={rowIndex,rowPinned},row=this.getRowNode(rowPosition),lastFocusedCell={rowPinned:cellValueChange.rowPinned,rowIndex:row.rowIndex,columnId:cellValueChange.columnId};this.setLastFocusedCell(lastFocusedCell,!!this.rangeService)}setLastFocusedCell(lastFocusedCell,setRangeToCell){const{rowIndex,columnId,rowPinned}=lastFocusedCell,scrollFeature=this.gridBodyCtrl.getScrollFeature(),column=this.columnModel.getGridColumn(columnId);if(!column)return;scrollFeature.ensureIndexVisible(rowIndex),scrollFeature.ensureColumnVisible(column);const cellPosition={rowIndex,column,rowPinned};this.focusService.setFocusedCell(__spreadProps(__spreadValues({},cellPosition),{forceBrowserFocus:!0})),setRangeToCell&&this.rangeService.setRangeToCell(cellPosition)}addRowEditingListeners(){this.addManagedListener(this.eventService,Events.EVENT_ROW_EDITING_STARTED,e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,Events.EVENT_ROW_EDITING_STOPPED,()=>{const action=new UndoRedoAction(this.cellValueChanges);this.pushActionsToUndoStack(action),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,Events.EVENT_CELL_EDITING_STARTED,e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,Events.EVENT_CELL_EDITING_STOPPED,e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const action=new UndoRedoAction(this.cellValueChanges);this.pushActionsToUndoStack(action)}})}addPasteListeners(){this.addManagedListener(this.eventService,Events.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,Events.EVENT_PASTE_END,()=>{const action=new UndoRedoAction(this.cellValueChanges);this.pushActionsToUndoStack(action),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,Events.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,Events.EVENT_FILL_END,event=>{const action=new RangeUndoRedoAction(this.cellValueChanges,event.initialRange,event.finalRange);this.pushActionsToUndoStack(action),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let action;this.rangeService&&this.gridOptionsService.get("enableRangeSelection")?action=new RangeUndoRedoAction(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):action=new UndoRedoAction(this.cellValueChanges),this.pushActionsToUndoStack(action),this.isRangeInAction=!1})}pushActionsToUndoStack(action){this.undoStack.push(action),this.cellValueChanges=[],this.redoStack.clear()}getRowNode(gridRow){switch(gridRow.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];default:return this.rowModel.getRow(gridRow.rowIndex)}}},__name(_a231,"UndoRedoService"),_a231);__decorateClass([Autowired("focusService")],UndoRedoService.prototype,"focusService",2);__decorateClass([Autowired("ctrlsService")],UndoRedoService.prototype,"ctrlsService",2);__decorateClass([Autowired("rowModel")],UndoRedoService.prototype,"rowModel",2);__decorateClass([Autowired("pinnedRowModel")],UndoRedoService.prototype,"pinnedRowModel",2);__decorateClass([Autowired("cellPositionUtils")],UndoRedoService.prototype,"cellPositionUtils",2);__decorateClass([Autowired("rowPositionUtils")],UndoRedoService.prototype,"rowPositionUtils",2);__decorateClass([Autowired("columnModel")],UndoRedoService.prototype,"columnModel",2);__decorateClass([Optional("rangeService")],UndoRedoService.prototype,"rangeService",2);__decorateClass([PostConstruct],UndoRedoService.prototype,"init",1);UndoRedoService=__decorateClass([Bean("undoRedoService")],UndoRedoService);var _a232,HeaderPositionUtils=(_a232=class extends BeanStub{findHeader(focusedHeader,direction){let nextColumn,getGroupMethod,getColMethod;if(focusedHeader.column instanceof ColumnGroup?(getGroupMethod=`getDisplayedGroup${direction}`,nextColumn=this.columnModel[getGroupMethod](focusedHeader.column)):(getColMethod=`getDisplayedCol${direction}`,nextColumn=this.columnModel[getColMethod](focusedHeader.column)),!nextColumn)return;let{headerRowIndex}=focusedHeader;if(this.getHeaderRowType(headerRowIndex)!=="filter"){const columnsInPath=[nextColumn];for(;nextColumn.getParent();)nextColumn=nextColumn.getParent(),columnsInPath.push(nextColumn);nextColumn=columnsInPath[columnsInPath.length-1-headerRowIndex]}const{column,headerRowIndex:indexToFocus}=this.getHeaderIndexToFocus(nextColumn,headerRowIndex);return{column,headerRowIndex:indexToFocus}}getHeaderIndexToFocus(column,currentIndex){let nextColumn;if(column instanceof ColumnGroup&&this.isAnyChildSpanningHeaderHeight(column)&&column.isPadding()){const targetColumn=column;nextColumn=targetColumn.getLeafColumns()[0];let col=nextColumn;for(;col!==targetColumn;)currentIndex++,col=col.getParent()}return{column:nextColumn||column,headerRowIndex:currentIndex}}isAnyChildSpanningHeaderHeight(columnGroup){return columnGroup?columnGroup.getLeafColumns().some(col=>col.isSpanHeaderHeight()):!1}getColumnVisibleParent(currentColumn,currentIndex){const currentRowType=this.getHeaderRowType(currentIndex),isFloatingFilter=currentRowType==="filter",isColumn=currentRowType==="column";let nextFocusColumn=isFloatingFilter?currentColumn:currentColumn.getParent(),nextRow=currentIndex-1,headerRowIndexWithoutSpan=nextRow;if(isColumn&&this.isAnyChildSpanningHeaderHeight(currentColumn.getParent())){for(;nextFocusColumn&&nextFocusColumn.isPadding();)nextFocusColumn=nextFocusColumn.getParent(),nextRow--;headerRowIndexWithoutSpan=nextRow,nextRow<0&&(nextFocusColumn=currentColumn,nextRow=currentIndex,headerRowIndexWithoutSpan=void 0)}return{column:nextFocusColumn,headerRowIndex:nextRow,headerRowIndexWithoutSpan}}getColumnVisibleChild(column,currentIndex,direction="After"){const currentRowType=this.getHeaderRowType(currentIndex);let nextFocusColumn=column,nextRow=currentIndex+1,headerRowIndexWithoutSpan=nextRow;if(currentRowType==="group"){const leafColumns=column.getDisplayedLeafColumns(),leafColumn=direction==="After"?leafColumns[0]:last(leafColumns),columnsInTheWay=[];let currentColumn=leafColumn;for(;currentColumn.getParent()!==column;)currentColumn=currentColumn.getParent(),columnsInTheWay.push(currentColumn);if(nextFocusColumn=leafColumn,leafColumn.isSpanHeaderHeight())for(let i=columnsInTheWay.length-1;i>=0;i--){const colToFocus=columnsInTheWay[i];if(!colToFocus.isPadding()){nextFocusColumn=colToFocus;break}nextRow++}else nextFocusColumn=last(columnsInTheWay),nextFocusColumn||(nextFocusColumn=leafColumn)}return{column:nextFocusColumn,headerRowIndex:nextRow,headerRowIndexWithoutSpan}}getHeaderRowType(rowIndex){const centerHeaderContainer=this.ctrlsService.getHeaderRowContainerCtrl();if(centerHeaderContainer)return centerHeaderContainer.getRowType(rowIndex)}findColAtEdgeForHeaderRow(level,position){const displayedColumns=this.columnModel.getAllDisplayedColumns(),column=displayedColumns[position==="start"?0:displayedColumns.length-1];if(!column)return;const type=this.ctrlsService.getHeaderRowContainerCtrl(column.getPinned()).getRowType(level);if(type=="group"){const columnGroup=this.columnModel.getColumnGroupAtLevel(column,level);return{headerRowIndex:level,column:columnGroup}}return{headerRowIndex:type==null?-1:level,column}}},__name(_a232,"HeaderPositionUtils"),_a232);__decorateClass([Autowired("columnModel")],HeaderPositionUtils.prototype,"columnModel",2);__decorateClass([Autowired("ctrlsService")],HeaderPositionUtils.prototype,"ctrlsService",2);HeaderPositionUtils=__decorateClass([Bean("headerPositionUtils")],HeaderPositionUtils);var _a233,ColumnDefFactory=(_a233=class{buildColumnDefs(cols,rowGroupColumns,pivotColumns){const res=[],colGroupDefs={};return cols.forEach(col=>{const colDef=this.createDefFromColumn(col,rowGroupColumns,pivotColumns);let addToResult=!0,childDef=colDef,pointer=col.getOriginalParent(),lastPointer=null;for(;pointer;){let parentDef=null;if(pointer.isPadding()){pointer=pointer.getOriginalParent();continue}const existingParentDef=colGroupDefs[pointer.getGroupId()];if(existingParentDef){existingParentDef.children.push(childDef),addToResult=!1;break}if(parentDef=this.createDefFromGroup(pointer),parentDef&&(parentDef.children=[childDef],colGroupDefs[parentDef.groupId]=parentDef,childDef=parentDef,pointer=pointer.getOriginalParent()),pointer!=null&&lastPointer===pointer){addToResult=!1;break}lastPointer=pointer}addToResult&&res.push(childDef)}),res}createDefFromGroup(group){const defCloned=deepCloneDefinition(group.getColGroupDef(),["children"]);return defCloned&&(defCloned.groupId=group.getGroupId()),defCloned}createDefFromColumn(col,rowGroupColumns,pivotColumns){const colDefCloned=deepCloneDefinition(col.getColDef());return colDefCloned.colId=col.getColId(),colDefCloned.width=col.getActualWidth(),colDefCloned.rowGroup=col.isRowGroupActive(),colDefCloned.rowGroupIndex=col.isRowGroupActive()?rowGroupColumns.indexOf(col):null,colDefCloned.pivot=col.isPivotActive(),colDefCloned.pivotIndex=col.isPivotActive()?pivotColumns.indexOf(col):null,colDefCloned.aggFunc=col.isValueActive()?col.getAggFunc():null,colDefCloned.hide=col.isVisible()?void 0:!0,colDefCloned.pinned=col.isPinned()?col.getPinned():null,colDefCloned.sort=col.getSort()?col.getSort():null,colDefCloned.sortIndex=col.getSortIndex()!=null?col.getSortIndex():null,colDefCloned}},__name(_a233,"ColumnDefFactory"),_a233);ColumnDefFactory=__decorateClass([Bean("columnDefFactory")],ColumnDefFactory);var _a234,RowCssClassCalculator=(_a234=class{getInitialRowClasses(params){const classes=[];return exists(params.extraCssClass)&&classes.push(params.extraCssClass),classes.push("ag-row"),classes.push(params.rowFocused?"ag-row-focus":"ag-row-no-focus"),params.fadeRowIn&&classes.push("ag-opacity-zero"),classes.push(params.rowIsEven?"ag-row-even":"ag-row-odd"),params.rowNode.isRowPinned()&&classes.push("ag-row-pinned"),params.rowNode.isSelected()&&classes.push("ag-row-selected"),params.rowNode.footer&&classes.push("ag-row-footer"),classes.push("ag-row-level-"+params.rowLevel),params.rowNode.stub&&classes.push("ag-row-loading"),params.fullWidthRow&&classes.push("ag-full-width-row"),params.expandable&&(classes.push("ag-row-group"),classes.push(params.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),params.rowNode.dragging&&classes.push("ag-row-dragging"),pushAll(classes,this.processClassesFromGridOptions(params.rowNode)),pushAll(classes,this.preProcessRowClassRules(params.rowNode)),classes.push(params.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),params.firstRowOnPage&&classes.push("ag-row-first"),params.lastRowOnPage&&classes.push("ag-row-last"),params.fullWidthRow&&(params.pinned==="left"&&classes.push("ag-cell-last-left-pinned"),params.pinned==="right"&&classes.push("ag-cell-first-right-pinned")),classes}processClassesFromGridOptions(rowNode){const res=[],process=__name(rowCls=>{typeof rowCls=="string"?res.push(rowCls):Array.isArray(rowCls)&&rowCls.forEach(e=>res.push(e))},"process"),rowClass=this.gridOptionsService.get("rowClass");if(rowClass){if(typeof rowClass=="function")return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];process(rowClass)}const rowClassFunc=this.gridOptionsService.getCallback("getRowClass");if(rowClassFunc){const params={data:rowNode.data,node:rowNode,rowIndex:rowNode.rowIndex},rowClassFuncResult=rowClassFunc(params);process(rowClassFuncResult)}return res}preProcessRowClassRules(rowNode){const res=[];return this.processRowClassRules(rowNode,className=>{res.push(className)},className=>{}),res}processRowClassRules(rowNode,onApplicableClass,onNotApplicableClass){const rowClassParams=this.gridOptionsService.addGridCommonParams({data:rowNode.data,node:rowNode,rowIndex:rowNode.rowIndex});this.stylingService.processClassRules(void 0,this.gridOptionsService.get("rowClassRules"),rowClassParams,onApplicableClass,onNotApplicableClass)}calculateRowLevel(rowNode){return rowNode.group?rowNode.level:rowNode.parent?rowNode.parent.level+1:0}},__name(_a234,"RowCssClassCalculator"),_a234);__decorateClass([Autowired("stylingService")],RowCssClassCalculator.prototype,"stylingService",2);__decorateClass([Autowired("gridOptionsService")],RowCssClassCalculator.prototype,"gridOptionsService",2);RowCssClassCalculator=__decorateClass([Bean("rowCssClassCalculator")],RowCssClassCalculator);var _a235,RowNodeSorter=(_a235=class extends BeanStub{init(){this.isAccentedSort=this.gridOptionsService.get("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",propChange=>this.isAccentedSort=propChange.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup())}doFullSort(rowNodes,sortOptions){const mapper=__name((rowNode,pos)=>({currentPos:pos,rowNode}),"mapper"),sortedRowNodes=rowNodes.map(mapper);return sortedRowNodes.sort(this.compareRowNodes.bind(this,sortOptions)),sortedRowNodes.map(item=>item.rowNode)}compareRowNodes(sortOptions,sortedNodeA,sortedNodeB){const nodeA=sortedNodeA.rowNode,nodeB=sortedNodeB.rowNode;for(let i=0,len=sortOptions.length;i<len;i++){const sortOption=sortOptions[i],isDescending=sortOption.sort==="desc",valueA=this.getValue(nodeA,sortOption.column),valueB=this.getValue(nodeB,sortOption.column);let comparatorResult;const providedComparator=this.getComparator(sortOption,nodeA);if(providedComparator?comparatorResult=providedComparator(valueA,valueB,nodeA,nodeB,isDescending):comparatorResult=_.defaultComparator(valueA,valueB,this.isAccentedSort),!isNaN(comparatorResult)&&comparatorResult!==0)return sortOption.sort==="asc"?comparatorResult:comparatorResult*-1}return sortedNodeA.currentPos-sortedNodeB.currentPos}getComparator(sortOption,rowNode){const column=sortOption.column,comparatorOnCol=column.getColDef().comparator;if(comparatorOnCol!=null)return comparatorOnCol;if(!column.getColDef().showRowGroup)return;const groupLeafField=!rowNode.group&&column.getColDef().field;if(!groupLeafField)return;const primaryColumn=this.columnModel.getPrimaryColumn(groupLeafField);if(primaryColumn)return primaryColumn.getColDef().comparator}getValue(node,column){var _a273,_b;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(column,node,!1,!1);if(node.rowGroupColumn===column){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){const leafChild=(_a273=node.allLeafChildren)==null?void 0:_a273[0];return leafChild?this.valueService.getValue(column,leafChild,!1,!1):void 0}const displayCol=this.columnModel.getGroupDisplayColumnForGroup(column.getId());return displayCol?(_b=node.groupData)==null?void 0:_b[displayCol.getId()]:void 0}if(!(node.group&&column.getColDef().showRowGroup))return this.valueService.getValue(column,node,!1,!1)}},__name(_a235,"RowNodeSorter"),_a235);__decorateClass([Autowired("valueService")],RowNodeSorter.prototype,"valueService",2);__decorateClass([Autowired("columnModel")],RowNodeSorter.prototype,"columnModel",2);__decorateClass([PostConstruct],RowNodeSorter.prototype,"init",1);RowNodeSorter=__decorateClass([Bean("rowNodeSorter")],RowNodeSorter);var _a236,CtrlsService=(_a236=class extends BeanStub{constructor(){super(...arguments),this.ready=!1,this.readyCallbacks=[]}checkReady(){if(this.ready=this.gridCtrl!=null&&this.gridBodyCtrl!=null&&this.centerRowContainerCtrl!=null&&this.leftRowContainerCtrl!=null&&this.rightRowContainerCtrl!=null&&this.bottomCenterRowContainerCtrl!=null&&this.bottomLeftRowContainerCtrl!=null&&this.bottomRightRowContainerCtrl!=null&&this.topCenterRowContainerCtrl!=null&&this.topLeftRowContainerCtrl!=null&&this.topRightRowContainerCtrl!=null&&this.stickyTopCenterRowContainerCtrl!=null&&this.stickyTopLeftRowContainerCtrl!=null&&this.stickyTopRightRowContainerCtrl!=null&&this.centerHeaderRowContainerCtrl!=null&&this.leftHeaderRowContainerCtrl!=null&&this.rightHeaderRowContainerCtrl!=null&&this.fakeHScrollComp!=null&&this.fakeVScrollComp!=null&&this.gridHeaderCtrl!=null,this.ready){const p=this.createReadyParams();this.readyCallbacks.forEach(c=>c(p)),this.readyCallbacks.length=0}}whenReady(callback){this.ready?callback(this.createReadyParams()):this.readyCallbacks.push(callback)}createReadyParams(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}}registerFakeHScrollComp(comp){this.fakeHScrollComp=comp,this.checkReady()}registerFakeVScrollComp(comp){this.fakeVScrollComp=comp,this.checkReady()}registerGridHeaderCtrl(gridHeaderCtrl){this.gridHeaderCtrl=gridHeaderCtrl,this.checkReady()}registerCenterRowContainerCtrl(ctrl){this.centerRowContainerCtrl=ctrl,this.checkReady()}registerLeftRowContainerCtrl(ctrl){this.leftRowContainerCtrl=ctrl,this.checkReady()}registerRightRowContainerCtrl(ctrl){this.rightRowContainerCtrl=ctrl,this.checkReady()}registerTopCenterRowContainerCtrl(ctrl){this.topCenterRowContainerCtrl=ctrl,this.checkReady()}registerTopLeftRowContainerCon(ctrl){this.topLeftRowContainerCtrl=ctrl,this.checkReady()}registerTopRightRowContainerCtrl(ctrl){this.topRightRowContainerCtrl=ctrl,this.checkReady()}registerStickyTopCenterRowContainerCtrl(ctrl){this.stickyTopCenterRowContainerCtrl=ctrl,this.checkReady()}registerStickyTopLeftRowContainerCon(ctrl){this.stickyTopLeftRowContainerCtrl=ctrl,this.checkReady()}registerStickyTopRightRowContainerCtrl(ctrl){this.stickyTopRightRowContainerCtrl=ctrl,this.checkReady()}registerBottomCenterRowContainerCtrl(ctrl){this.bottomCenterRowContainerCtrl=ctrl,this.checkReady()}registerBottomLeftRowContainerCtrl(ctrl){this.bottomLeftRowContainerCtrl=ctrl,this.checkReady()}registerBottomRightRowContainerCtrl(ctrl){this.bottomRightRowContainerCtrl=ctrl,this.checkReady()}registerHeaderContainer(ctrl,pinned){switch(pinned){case"left":this.leftHeaderRowContainerCtrl=ctrl;break;case"right":this.rightHeaderRowContainerCtrl=ctrl;break;default:this.centerHeaderRowContainerCtrl=ctrl;break}this.checkReady()}registerGridBodyCtrl(ctrl){this.gridBodyCtrl=ctrl,this.checkReady()}registerGridCtrl(ctrl){this.gridCtrl=ctrl,this.checkReady()}getFakeHScrollComp(){return this.fakeHScrollComp}getFakeVScrollComp(){return this.fakeVScrollComp}getGridHeaderCtrl(){return this.gridHeaderCtrl}getGridCtrl(){return this.gridCtrl}getCenterRowContainerCtrl(){return this.centerRowContainerCtrl}getTopCenterRowContainerCtrl(){return this.topCenterRowContainerCtrl}getBottomCenterRowContainerCtrl(){return this.bottomCenterRowContainerCtrl}getStickyTopCenterRowContainerCtrl(){return this.stickyTopCenterRowContainerCtrl}getGridBodyCtrl(){return this.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]}getHeaderRowContainerCtrl(pinned){switch(pinned){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}}},__name(_a236,"CtrlsService"),_a236);CtrlsService.NAME="ctrlsService";CtrlsService=__decorateClass([Bean(CtrlsService.NAME)],CtrlsService);var _a237,CtrlsFactory=(_a237=class extends BeanStub{constructor(){super(...arguments),this.registry={}}register(meta){this.registry[meta.controllerName]=meta.controllerClass}getInstance(name){const ControllerClass=this.registry[name];if(ControllerClass!=null)return new ControllerClass}},__name(_a237,"CtrlsFactory"),_a237);CtrlsFactory=__decorateClass([Bean("ctrlsFactory")],CtrlsFactory);var _a238,AbstractFakeScrollComp=(_a238=class extends Component{constructor(template,direction){super(template),this.direction=direction,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",isMacOsUserAgent()||isIOSUserAgent())}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=isInvisibleScrollbar(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const activateEvents=["mouseenter","mousedown","touchstart"],deactivateEvents=["mouseleave","touchend"],eGui=this.getGui();activateEvents.forEach(eventName=>this.addManagedListener(eGui,eventName,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),deactivateEvents.forEach(eventName=>this.addManagedListener(eGui,eventName,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,params=>{params.direction===this.direction&&(this.hideTimeout!==null&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(value){const viewport=this.getViewport();waitUntil(()=>isVisible(viewport),()=>this.setScrollPosition(value),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(fn){this.addManagedListener(this.getViewport(),"scroll",fn)}},__name(_a238,"AbstractFakeScrollComp"),_a238);__decorateClass([RefSelector("eViewport")],AbstractFakeScrollComp.prototype,"eViewport",2);__decorateClass([RefSelector("eContainer")],AbstractFakeScrollComp.prototype,"eContainer",2);__decorateClass([Autowired("scrollVisibleService")],AbstractFakeScrollComp.prototype,"scrollVisibleService",2);__decorateClass([Autowired("ctrlsService")],AbstractFakeScrollComp.prototype,"ctrlsService",2);__decorateClass([Autowired("animationFrameService")],AbstractFakeScrollComp.prototype,"animationFrameService",2);var _a239,_FakeHScrollComp=(_a239=class extends AbstractFakeScrollComp{constructor(){super(_a239.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const spacerWidthsListener=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,spacerWidthsListener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,spacerWidthsListener),this.addManagedListener(this.eventService,Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",spacerWidthsListener),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new CenterWidthFeature(width=>this.eContainer.style.width=`${width}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gridOptionsService.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const bottomPinnedHeight=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${bottomPinnedHeight}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const vScrollShowing=this.scrollVisibleService.isVerticalScrollShowing();let rightSpacing=this.columnModel.getDisplayedColumnsRightWidth();const scrollOnRight=!this.enableRtl&&vScrollShowing,scrollbarWidth=this.gridOptionsService.getScrollbarWidth();scrollOnRight&&(rightSpacing+=scrollbarWidth),setFixedWidth(this.eRightSpacer,rightSpacing),this.eRightSpacer.classList.toggle("ag-scroller-corner",rightSpacing<=scrollbarWidth);let leftSpacing=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&vScrollShowing&&(leftSpacing+=scrollbarWidth),setFixedWidth(this.eLeftSpacer,leftSpacing),this.eLeftSpacer.classList.toggle("ag-scroller-corner",leftSpacing<=scrollbarWidth)}setScrollVisible(){const hScrollShowing=this.scrollVisibleService.isHorizontalScrollShowing(),invisibleScrollbar2=this.invisibleScrollbar,isSuppressHorizontalScroll=this.gridOptionsService.get("suppressHorizontalScroll"),scrollbarWidth=hScrollShowing&&this.gridOptionsService.getScrollbarWidth()||0,scrollContainerSize=isSuppressHorizontalScroll?0:scrollbarWidth===0&&invisibleScrollbar2?16:scrollbarWidth;this.addOrRemoveCssClass("ag-scrollbar-invisible",invisibleScrollbar2),setFixedHeight(this.getGui(),scrollContainerSize),setFixedHeight(this.eViewport,scrollContainerSize),setFixedHeight(this.eContainer,scrollContainerSize),this.setDisplayed(hScrollShowing,{skipAriaHidden:!0})}getScrollPosition(){return getScrollLeft(this.getViewport(),this.enableRtl)}setScrollPosition(value){isVisible(this.getViewport())||this.attemptSettingScrollPosition(value),setScrollLeft(this.getViewport(),value,this.enableRtl)}},__name(_a239,"_FakeHScrollComp"),_a239);_FakeHScrollComp.TEMPLATE=`<div class="ag-body-horizontal-scroll" aria-hidden="true">
            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>
            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">
                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>
            </div>
            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>
        </div>`;__decorateClass([RefSelector("eLeftSpacer")],_FakeHScrollComp.prototype,"eLeftSpacer",2);__decorateClass([RefSelector("eRightSpacer")],_FakeHScrollComp.prototype,"eRightSpacer",2);__decorateClass([Autowired("columnModel")],_FakeHScrollComp.prototype,"columnModel",2);__decorateClass([Autowired("pinnedRowModel")],_FakeHScrollComp.prototype,"pinnedRowModel",2);__decorateClass([PostConstruct],_FakeHScrollComp.prototype,"postConstruct",1);var FakeHScrollComp=_FakeHScrollComp,_a240,PinnedWidthService=(_a240=class extends BeanStub{postConstruct(){const listener=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,listener),this.addManagedPropertyListener("domLayout",listener)}checkContainerWidths(){const printLayout=this.gridOptionsService.isDomLayout("print"),newLeftWidth=printLayout?0:this.columnModel.getDisplayedColumnsLeftWidth(),newRightWidth=printLayout?0:this.columnModel.getDisplayedColumnsRightWidth();newLeftWidth!=this.leftWidth&&(this.leftWidth=newLeftWidth,this.eventService.dispatchEvent({type:Events.EVENT_LEFT_PINNED_WIDTH_CHANGED})),newRightWidth!=this.rightWidth&&(this.rightWidth=newRightWidth,this.eventService.dispatchEvent({type:Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}},__name(_a240,"PinnedWidthService"),_a240);__decorateClass([Autowired("columnModel")],PinnedWidthService.prototype,"columnModel",2);__decorateClass([PostConstruct],PinnedWidthService.prototype,"postConstruct",1);PinnedWidthService=__decorateClass([Bean("pinnedWidthService")],PinnedWidthService);var _a241,RowNodeEventThrottle=(_a241=class extends BeanStub{constructor(){super(...arguments),this.events=[]}postConstruct(){this.rowModel.getType()=="clientSide"&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(event){if(this.clientSideRowModel==null){this.eventService.dispatchEvent(event);return}this.events.push(event);const func=__name(()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(e=>this.eventService.dispatchEvent(e)),this.events=[]},"func");this.dispatchExpandedDebounced==null&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(func)),this.dispatchExpandedDebounced()}},__name(_a241,"RowNodeEventThrottle"),_a241);__decorateClass([Autowired("animationFrameService")],RowNodeEventThrottle.prototype,"animationFrameService",2);__decorateClass([Autowired("rowModel")],RowNodeEventThrottle.prototype,"rowModel",2);__decorateClass([PostConstruct],RowNodeEventThrottle.prototype,"postConstruct",1);RowNodeEventThrottle=__decorateClass([Bean("rowNodeEventThrottle")],RowNodeEventThrottle);var COLUMN_DEFINITION_DEPRECATIONS={columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},dndSource:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."},dndSourceOnRowDrag:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."}},CSRM_REQUIRES_ROW_GROUP_MODULE=__name((_options,gridOptions)=>{var _a273;return((_a273=gridOptions.rowModelType)!=null?_a273:"clientSide")==="clientSide"?{module:"@ag-grid-enterprise/row-grouping"}:null},"CSRM_REQUIRES_ROW_GROUP_MODULE"),COLUMN_DEFINITION_VALIDATIONS={enableRowGroup:CSRM_REQUIRES_ROW_GROUP_MODULE,rowGroup:CSRM_REQUIRES_ROW_GROUP_MODULE,rowGroupIndex:CSRM_REQUIRES_ROW_GROUP_MODULE,enablePivot:CSRM_REQUIRES_ROW_GROUP_MODULE,enableValue:CSRM_REQUIRES_ROW_GROUP_MODULE,pivot:CSRM_REQUIRES_ROW_GROUP_MODULE,pivotIndex:CSRM_REQUIRES_ROW_GROUP_MODULE,aggFunc:CSRM_REQUIRES_ROW_GROUP_MODULE,cellEditor:options=>options.cellEditor==="agRichSelect"||options.cellEditor==="agRichSelectCellEditor"?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:options=>{var _a273;const enterpriseMenuTabs=["columnsMenuTab","generalMenuTab"];return(_a273=options.menuTabs)!=null&&_a273.some(tab=>enterpriseMenuTabs.includes(tab))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],dependencies:(_options,{rowSelection})=>rowSelection==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],dependencies:(_options,{rowSelection})=>rowSelection==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],dependencies:(_options,{rowSelection})=>rowSelection==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>COL_DEF_VALIDATORS},COL_DEF_VALIDATORS={objectName:"colDef",allProperties:ColDefUtil.ALL_PROPERTIES,docsUrl:"column-properties/",deprecations:COLUMN_DEFINITION_DEPRECATIONS,validations:COLUMN_DEFINITION_VALIDATIONS},GRID_OPTION_DEPRECATIONS={enableChartToolPanelsButton:{version:"29"},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",renamed:"enterNavigatesVertically"},enterMovesDownAfterEdit:{version:"30",renamed:"enterNavigatesVerticallyAfterEdit"},suppressParentsInRowNodes:{version:"30.2",message:"Using suppressParentsInRowNodes is no longer recommended. To serialize nodes it is now recommended to instead remove the parent node reference before serialization."},advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."}},GRID_OPTION_DEFAULTS={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!1,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,suppressChartToolPanelsButton:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,functionsPassive:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,pivotMaxGeneratedColumns:-1},GRID_OPTION_VALIDATIONS={sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",dependencies:options=>{var _a273;const rowModel=(_a273=options.rowModelType)!=null?_a273:"clientSide";switch(rowModel){case"clientSide":const csrmWarning=`treeData requires 'getDataPath' in the ${rowModel} row model.`;return options.getDataPath?null:csrmWarning;case"serverSide":const ssrmWarning=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${rowModel} row model.`;return options.isServerSideGroup&&options.getServerSideGroupKey?null:ssrmWarning}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],dependencies:options=>{var _a273;switch((_a273=options.rowModelType)!=null?_a273:"clientSide"){case"clientSide":return null;case"serverSide":return options.suppressServerSideInfiniteScroll?"groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll":null}return null}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},suppressParentsInRowNodes:{dependencies:{groupSelectsChildren:[void 0,!1]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},columnDefs:()=>COL_DEF_VALIDATORS,defaultColDef:()=>COL_DEF_VALIDATORS,defaultColGroupDef:()=>COL_DEF_VALIDATORS,autoGroupColumnDef:()=>COL_DEF_VALIDATORS},GRID_OPTIONS_VALIDATORS={objectName:"gridOptions",allProperties:[...PropertyKeys.ALL_PROPERTIES,...ComponentUtil.EVENT_CALLBACKS],propertyExceptions:["api","columnApi"],docsUrl:"grid-options/",deprecations:GRID_OPTION_DEPRECATIONS,validations:GRID_OPTION_VALIDATIONS},_a242,GridOptionsService=(_a242=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new EventService,this.globalEventHandlerFactory=restrictToSyncOnly=>(eventName,event)=>{if(this.destroyed)return;const alwaysSync=ALWAYS_SYNC_GLOBAL_EVENTS.has(eventName);if(alwaysSync&&!restrictToSyncOnly||!alwaysSync&&restrictToSyncOnly)return;const eventHandlerName=ComponentUtil.getCallbackForEvent(eventName),eventHandler=this.gridOptions[eventHandlerName];typeof eventHandler=="function"&&this.frameworkOverrides.wrapOutgoing(()=>{eventHandler(event)})}}get context(){return this.gridOptions.context}init(){this.columnApi=new ColumnApi(this.api);const async=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),async),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.getScrollbarWidth()}destroy(){this.destroyed=!0,this.columnApi=void 0}get(property){var _a273;return(_a273=this.gridOptions[property])!=null?_a273:GRID_OPTION_DEFAULTS[property]}getCallback(property){return this.mergeGridCommonParams(this.gridOptions[property])}exists(property){return exists(this.gridOptions[property])}mergeGridCommonParams(callback){return callback&&__name(callbackParams=>{const mergedParams=callbackParams;return mergedParams.api=this.api,mergedParams.columnApi=this.columnApi,mergedParams.context=this.context,callback(mergedParams)},"wrapped")}static toBoolean(value){return typeof value=="boolean"?value:typeof value=="string"?value.toUpperCase()==="TRUE"||value=="":!1}static toNumber(value){if(typeof value=="number")return value;if(typeof value=="string"){const parsed=parseInt(value);return isNaN(parsed)?void 0:parsed}}static toConstrainedNum(min,max){return value=>{const num=GridOptionsService.toNumber(value);if(!(num==null||num<min||num>max))return num}}static getCoercedValue(key,value){const coerceFunc=GridOptionsService.PROPERTY_COERCIONS.get(key);return coerceFunc?coerceFunc(value):value}static getCoercedGridOptions(gridOptions){const newGo={};return Object.entries(gridOptions).forEach(([key,value])=>{const coercedValue=GridOptionsService.getCoercedValue(key,value);newGo[key]=coercedValue}),newGo}updateGridOptions({options,source="api"}){const changeSet={id:GridOptionsService.changeSetId++,properties:[]},events=[];Object.entries(options).forEach(([key,value])=>{source==="api"&&INITIAL_GRID_OPTION_KEYS[key]&&warnOnce(`${key} is an initial property and cannot be updated.`);const coercedValue=GridOptionsService.getCoercedValue(key,value),shouldForce=typeof coercedValue=="object"&&source==="api",previousValue=this.gridOptions[key];if(shouldForce||previousValue!==coercedValue){this.gridOptions[key]=coercedValue;const event={type:key,currentValue:coercedValue,previousValue,changeSet,source};events.push(event)}}),this.validationService.processGridOptions(this.gridOptions),changeSet.properties=events.map(event=>event.type),events.forEach(event=>{this.gridOptions.debug&&console.log(`AG Grid: Updated property ${event.type} from `,event.previousValue," to  ",event.currentValue),this.propertyEventService.dispatchEvent(event)})}addEventListener(key,listener){this.propertyEventService.addEventListener(key,listener)}removeEventListener(key,listener){this.propertyEventService.removeEventListener(key,listener)}getScrollbarWidth(){if(this.scrollbarWidth==null){const scrollbarWidth=typeof this.gridOptions.scrollbarWidth=="number"&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:getScrollbarWidth();scrollbarWidth!=null&&(this.scrollbarWidth=scrollbarWidth,this.eventService.dispatchEvent({type:Events.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(rowModelType){return this.gridOptions.rowModelType===rowModelType||rowModelType==="clientSide"&&missing(this.gridOptions.rowModelType)}isDomLayout(domLayout){var _a273;return((_a273=this.gridOptions.domLayout)!=null?_a273:"normal")===domLayout}isRowSelection(){return this.gridOptions.rowSelection==="single"||this.gridOptions.rowSelection==="multiple"}useAsyncEvents(){return!this.get("suppressAsyncEvents")}isGetRowHeightFunction(){return typeof this.gridOptions.getRowHeight=="function"}getRowHeightForNode(rowNode,allowEstimate=!1,defaultRowHeight){if(defaultRowHeight==null&&(defaultRowHeight=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(allowEstimate)return{height:defaultRowHeight,estimated:!0};const params={node:rowNode,data:rowNode.data},height=this.getCallback("getRowHeight")(params);if(this.isNumeric(height))return height===0&&warnOnce("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,height),estimated:!1}}return rowNode.detail&&this.get("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:defaultRowHeight,estimated:!1}}getMasterDetailRowHeight(){return this.get("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||missing(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const rowHeight=this.environment.refreshRowHeightVariable();return rowHeight!==-1?rowHeight:(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(value){return!isNaN(value)&&typeof value=="number"&&isFinite(value)}getDomDataKey(){return this.domDataKey}getDomData(element,key){const domData=element[this.getDomDataKey()];return domData?domData[key]:void 0}setDomData(element,key,value){const domDataKey=this.getDomDataKey();let domData=element[domDataKey];missing(domData)&&(domData={},element[domDataKey]=domData),domData[key]=value}getDocument(){let result=null;return this.gridOptions.getDocument&&exists(this.gridOptions.getDocument)?result=this.gridOptions.getDocument():this.eGridDiv&&(result=this.eGridDiv.ownerDocument),result&&exists(result)?result:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getAsyncTransactionWaitMillis(){return exists(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return this.get("ensureDomOrder")?!1:this.get("animateRows")}isGroupRowsSticky(){return!(this.get("suppressGroupRowsSticky")||this.get("paginateChildRows")||this.get("groupHideOpenParents")||this.isDomLayout("print"))}isColumnsSortingCoupledToGroup(){const autoGroupColumnDef=this.gridOptions.autoGroupColumnDef;return!(autoGroupColumnDef!=null&&autoGroupColumnDef.comparator)&&!this.get("treeData")}getGroupAggFiltering(){const userValue=this.gridOptions.groupAggFiltering;if(typeof userValue=="function")return this.getCallback("groupAggFiltering");if(userValue===!0)return()=>!0}isGroupIncludeFooterTrueOrCallback(){const userValue=this.gridOptions.groupIncludeFooter;return userValue===!0||typeof userValue=="function"}getGroupIncludeFooter(){const userValue=this.gridOptions.groupIncludeFooter;return typeof userValue=="function"?this.getCallback("groupIncludeFooter"):userValue===!0?()=>!0:()=>!1}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?this.gridOptions.groupDisplayType==="multipleColumns":this.get("groupHideOpenParents")}isGroupUseEntireRow(pivotMode){return pivotMode?!1:this.gridOptions.groupDisplayType==="groupRows"}getGridCommonParams(){return{api:this.api,columnApi:this.columnApi,context:this.context}}addGridCommonParams(params){const updatedParams=params;return updatedParams.api=this.api,updatedParams.columnApi=this.columnApi,updatedParams.context=this.context,updatedParams}},__name(_a242,"GridOptionsService"),_a242);GridOptionsService.PROPERTY_COERCIONS=new Map([...PropertyKeys.BOOLEAN_PROPERTIES.map(key=>[key,GridOptionsService.toBoolean]),...PropertyKeys.NUMBER_PROPERTIES.map(key=>[key,GridOptionsService.toNumber]),["groupAggFiltering",val=>typeof val=="function"?val:GridOptionsService.toBoolean(val)],["pageSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["autoSizePadding",GridOptionsService.toConstrainedNum(0,Number.MAX_VALUE)],["keepDetailRowsCount",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["rowBuffer",GridOptionsService.toConstrainedNum(0,Number.MAX_VALUE)],["infiniteInitialRowCount",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["cacheOverflowSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["cacheBlockSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["serverSideInitialRowCount",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelPageSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelBufferSize",GridOptionsService.toConstrainedNum(0,Number.MAX_VALUE)]]);GridOptionsService.changeSetId=0;__decorateClass([Autowired("gridOptions")],GridOptionsService.prototype,"gridOptions",2);__decorateClass([Autowired("eventService")],GridOptionsService.prototype,"eventService",2);__decorateClass([Autowired("environment")],GridOptionsService.prototype,"environment",2);__decorateClass([Autowired("frameworkOverrides")],GridOptionsService.prototype,"frameworkOverrides",2);__decorateClass([Autowired("eGridDiv")],GridOptionsService.prototype,"eGridDiv",2);__decorateClass([Autowired("validationService")],GridOptionsService.prototype,"validationService",2);__decorateClass([Autowired("gridApi")],GridOptionsService.prototype,"api",2);__decorateClass([PostConstruct],GridOptionsService.prototype,"init",1);__decorateClass([PreDestroy],GridOptionsService.prototype,"destroy",1);GridOptionsService=__decorateClass([Bean("gridOptionsService")],GridOptionsService);var _a243,LocaleService=(_a243=class extends BeanStub{getLocaleTextFunc(){const getLocaleText=this.gridOptionsService.getCallback("getLocaleText");if(getLocaleText)return(key,defaultValue,variableValues)=>getLocaleText({key,defaultValue,variableValues});const localeText=this.gridOptionsService.get("localeText");return(key,defaultValue,variableValues)=>{let localisedText=localeText&&localeText[key];if(localisedText&&variableValues&&variableValues.length){let found=0;for(;!(found>=variableValues.length||localisedText.indexOf("${variable}")===-1);)localisedText=localisedText.replace("${variable}",variableValues[found++])}return localisedText??defaultValue}}},__name(_a243,"LocaleService"),_a243);LocaleService=__decorateClass([Bean("localeService")],LocaleService);var _a244,_FakeVScrollComp=(_a244=class extends AbstractFakeScrollComp{constructor(){super(_a244.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new SetHeightFeature(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this),this.addManagedListener(this.eventService,Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const vScrollShowing=this.scrollVisibleService.isVerticalScrollShowing(),invisibleScrollbar2=this.invisibleScrollbar,scrollbarWidth=vScrollShowing&&this.gridOptionsService.getScrollbarWidth()||0,adjustedScrollbarWidth=scrollbarWidth===0&&invisibleScrollbar2?16:scrollbarWidth;this.addOrRemoveCssClass("ag-scrollbar-invisible",invisibleScrollbar2),setFixedWidth(this.getGui(),adjustedScrollbarWidth),setFixedWidth(this.eViewport,adjustedScrollbarWidth),setFixedWidth(this.eContainer,adjustedScrollbarWidth),this.setDisplayed(vScrollShowing,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService}=this,gridBodyViewportEl=ctrlsService.getGridBodyCtrl().getBodyViewportElement(),eViewportScrollTop=this.getScrollPosition(),gridBodyViewportScrollTop=gridBodyViewportEl.scrollTop;eViewportScrollTop!=gridBodyViewportScrollTop&&this.setScrollPosition(gridBodyViewportScrollTop,!0)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(value,force){!force&&!isVisible(this.getViewport())&&this.attemptSettingScrollPosition(value),this.getViewport().scrollTop=value}},__name(_a244,"_FakeVScrollComp"),_a244);_FakeVScrollComp.TEMPLATE=`<div class="ag-body-vertical-scroll" aria-hidden="true">
            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">
                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>
            </div>
        </div>`;__decorateClass([PostConstruct],_FakeVScrollComp.prototype,"postConstruct",1);var FakeVScrollComp=_FakeVScrollComp,MONTH_LOCALE_TEXT={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},MONTH_KEYS=["january","february","march","april","may","june","july","august","september","october","november","december"],_a245,DataTypeService=(_a245=class extends BeanStub{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gridOptionsService.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gridOptionsService.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",event=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(convertSourceType(event.source))})}processDataTypeDefinitions(){var _a273;const defaultDataTypes=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(defaultDataTypes).forEach(([cellDataType,dataTypeDefinition])=>{this.dataTypeDefinitions[cellDataType]=__spreadProps(__spreadValues({},dataTypeDefinition),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(dataTypeDefinition)})});const dataTypeDefinitions=(_a273=this.gridOptionsService.get("dataTypeDefinitions"))!=null?_a273:{};this.dataTypeMatchers={},Object.entries(dataTypeDefinitions).forEach(([cellDataType,dataTypeDefinition])=>{const mergedDataTypeDefinition=this.processDataTypeDefinition(dataTypeDefinition,dataTypeDefinitions,[cellDataType],defaultDataTypes);mergedDataTypeDefinition&&(this.dataTypeDefinitions[cellDataType]=mergedDataTypeDefinition,dataTypeDefinition.dataTypeMatcher&&(this.dataTypeMatchers[cellDataType]=dataTypeDefinition.dataTypeMatcher))}),this.checkObjectValueHandlers(defaultDataTypes),["dateString","text","number","boolean","date"].forEach(cellDataType=>{const overriddenDataTypeMatcher=this.dataTypeMatchers[cellDataType];overriddenDataTypeMatcher&&delete this.dataTypeMatchers[cellDataType],this.dataTypeMatchers[cellDataType]=overriddenDataTypeMatcher??defaultDataTypes[cellDataType].dataTypeMatcher})}mergeDataTypeDefinitions(parentDataTypeDefinition,childDataTypeDefinition){const mergedDataTypeDefinition=__spreadValues(__spreadValues({},parentDataTypeDefinition),childDataTypeDefinition);return parentDataTypeDefinition.columnTypes&&childDataTypeDefinition.columnTypes&&childDataTypeDefinition.appendColumnTypes&&(mergedDataTypeDefinition.columnTypes=[...this.convertColumnTypes(parentDataTypeDefinition.columnTypes),...this.convertColumnTypes(childDataTypeDefinition.columnTypes)]),mergedDataTypeDefinition}processDataTypeDefinition(dataTypeDefinition,dataTypeDefinitions,alreadyProcessedDataTypes,defaultDataTypes){let mergedDataTypeDefinition;const extendsCellDataType=dataTypeDefinition.extendsDataType;if(dataTypeDefinition.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),dataTypeDefinition.extendsDataType===dataTypeDefinition.baseDataType){let baseDataTypeDefinition=defaultDataTypes[extendsCellDataType];const overriddenBaseDataTypeDefinition=dataTypeDefinitions[extendsCellDataType];if(baseDataTypeDefinition&&overriddenBaseDataTypeDefinition&&(baseDataTypeDefinition=overriddenBaseDataTypeDefinition),!this.validateDataTypeDefinition(dataTypeDefinition,baseDataTypeDefinition,extendsCellDataType))return;mergedDataTypeDefinition=this.mergeDataTypeDefinitions(baseDataTypeDefinition,dataTypeDefinition)}else{if(alreadyProcessedDataTypes.includes(extendsCellDataType)){warnOnce('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');return}const extendedDataTypeDefinition=dataTypeDefinitions[extendsCellDataType];if(!this.validateDataTypeDefinition(dataTypeDefinition,extendedDataTypeDefinition,extendsCellDataType))return;const mergedExtendedDataTypeDefinition=this.processDataTypeDefinition(extendedDataTypeDefinition,dataTypeDefinitions,[...alreadyProcessedDataTypes,extendsCellDataType],defaultDataTypes);if(!mergedExtendedDataTypeDefinition)return;mergedDataTypeDefinition=this.mergeDataTypeDefinitions(mergedExtendedDataTypeDefinition,dataTypeDefinition)}return __spreadProps(__spreadValues({},mergedDataTypeDefinition),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(mergedDataTypeDefinition)})}validateDataTypeDefinition(dataTypeDefinition,parentDataTypeDefinition,parentCellDataType){return parentDataTypeDefinition?parentDataTypeDefinition.baseDataType!==dataTypeDefinition.baseDataType?(warnOnce('The "baseDataType" property of a data type definition must match that of its parent.'),!1):!0:(warnOnce(`The data type definition ${parentCellDataType} does not exist.`),!1)}createGroupSafeValueFormatter(dataTypeDefinition){if(dataTypeDefinition.valueFormatter)return params=>{var _a273,_b;if((_a273=params.node)!=null&&_a273.group){const aggFunc=params.column.getAggFunc();if(aggFunc){if(aggFunc==="first"||aggFunc==="last")return dataTypeDefinition.valueFormatter(params);if(dataTypeDefinition.baseDataType==="number"&&aggFunc!=="count"){if(typeof params.value=="number")return dataTypeDefinition.valueFormatter(params);if(typeof params.value=="object"){if(!params.value)return;if("toNumber"in params.value)return dataTypeDefinition.valueFormatter(__spreadProps(__spreadValues({},params),{value:params.value.toNumber()}));if("value"in params.value)return dataTypeDefinition.valueFormatter(__spreadProps(__spreadValues({},params),{value:params.value.value}))}}}if(!this.gridOptionsService.get("suppressGroupMaintainValueType"))return}else if(this.groupHideOpenParents&&params.column.isRowGroupActive()){if(typeof params.value!="string"||(_b=dataTypeDefinition.dataTypeMatcher)!=null&&_b.call(dataTypeDefinition,params.value))return dataTypeDefinition.valueFormatter(params);if(!this.gridOptionsService.get("suppressGroupMaintainValueType"))return}return dataTypeDefinition.valueFormatter(params)}}updateColDefAndGetDataTypeDefinitionColumnType(colDef,userColDef,colId){let{cellDataType}=userColDef;const{field}=userColDef;if(cellDataType===void 0&&(cellDataType=colDef.cellDataType),(cellDataType==null||cellDataType===!0)&&(cellDataType=this.canInferCellDataType(colDef,userColDef)?this.inferCellDataType(field,colId):!1),!cellDataType){colDef.cellDataType=!1;return}const dataTypeDefinition=this.dataTypeDefinitions[cellDataType];if(!dataTypeDefinition){warnOnce(`Missing data type definition - "${cellDataType}"`);return}return colDef.cellDataType=cellDataType,dataTypeDefinition.groupSafeValueFormatter&&(colDef.valueFormatter=dataTypeDefinition.groupSafeValueFormatter),dataTypeDefinition.valueParser&&(colDef.valueParser=dataTypeDefinition.valueParser),dataTypeDefinition.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(colDef,dataTypeDefinition,colId),dataTypeDefinition.columnTypes}updateColDefAndGetColumnType(colDef,userColDef,colId){var _a273,_b;const dataTypeDefinitionColumnType=this.updateColDefAndGetDataTypeDefinitionColumnType(colDef,userColDef,colId),columnTypes=(_b=(_a273=userColDef.type)!=null?_a273:dataTypeDefinitionColumnType)!=null?_b:colDef.type;return colDef.type=columnTypes,columnTypes?this.convertColumnTypes(columnTypes):void 0}addColumnListeners(column){if(!this.isWaitingForRowData)return;const columnStateUpdates=this.columnStateUpdatesPendingInference[column.getColId()];if(!columnStateUpdates)return;const columnListener=__name(event=>{columnStateUpdates.add(event.key)},"columnListener");column.addEventListener(Column.EVENT_STATE_UPDATED,columnListener),this.columnStateUpdateListenerDestroyFuncs.push(()=>column.removeEventListener(Column.EVENT_STATE_UPDATED,columnListener))}canInferCellDataType(colDef,userColDef){var _a273;if(this.rowModel.getType()!=="clientSide")return!1;const propsToCheckForInference={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(userColDef,propsToCheckForInference))return!1;const columnTypes=userColDef.type===null?colDef.type:userColDef.type;if(columnTypes){const columnTypeDefs=(_a273=this.gridOptionsService.get("columnTypes"))!=null?_a273:{};if(this.convertColumnTypes(columnTypes).some(columnType=>{const columnTypeDef=columnTypeDefs[columnType.trim()];return columnTypeDef&&this.doColDefPropsPreventInference(columnTypeDef,propsToCheckForInference)}))return!1}return!this.doColDefPropsPreventInference(colDef,propsToCheckForInference)}doColDefPropsPreventInference(colDef,propsToCheckForInference){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([prop,comparisonValue])=>this.doesColDefPropPreventInference(colDef,propsToCheckForInference,prop,comparisonValue))}doesColDefPropPreventInference(colDef,checkProps,prop,comparisonValue){if(!checkProps[prop])return!1;const value=colDef[prop];return value===null?(checkProps[prop]=!1,!1):comparisonValue===void 0?!!value:value===comparisonValue}inferCellDataType(field,colId){var _a273;if(!field)return;let value;const initialData=this.getInitialData();if(initialData){const fieldContainsDots=field.indexOf(".")>=0&&!this.gridOptionsService.get("suppressFieldDotNotation");value=getValueUsingField(initialData,field,fieldContainsDots)}else this.initWaitForRowData(colId);if(value==null)return;const[cellDataType]=(_a273=Object.entries(this.dataTypeMatchers).find(([_cellDataType,dataTypeMatcher])=>dataTypeMatcher(value)))!=null?_a273:["object"];return cellDataType}getInitialData(){const rowData=this.gridOptionsService.get("rowData");if(rowData!=null&&rowData.length)return rowData[0];if(this.initialData)return this.initialData;{const rowNodes=this.rowModel.getRootNode().allLeafChildren;if(rowNodes!=null&&rowNodes.length)return rowNodes[0].data}return null}initWaitForRowData(colId){if(this.columnStateUpdatesPendingInference[colId]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const columnTypeOverridesExist=this.isColumnTypeOverrideInDataTypeDefinitions;columnTypeOverridesExist&&this.columnModel.queueResizeOperations();const destroyFunc=this.addManagedListener(this.eventService,Events.EVENT_ROW_DATA_UPDATE_STARTED,event=>{const{firstRowData}=event;if(!firstRowData)return;destroyFunc==null||destroyFunc(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(firstRowData,columnTypeOverridesExist),this.columnStateUpdatesPendingInference={},columnTypeOverridesExist&&this.columnModel.processResizeOperations();const dataTypesInferredEvent={type:Events.EVENT_DATA_TYPES_INFERRED};this.eventService.dispatchEvent(dataTypesInferredEvent)})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(firstRowData,columnTypeOverridesExist){this.initialData=firstRowData;const state=[];this.columnStateUpdateListenerDestroyFuncs.forEach(destroyFunc=>destroyFunc()),this.columnStateUpdateListenerDestroyFuncs=[];const newRowGroupColumnStateWithoutIndex={},newPivotColumnStateWithoutIndex={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([colId,columnStateUpdates])=>{const column=this.columnModel.getGridColumn(colId);if(!column)return;const oldColDef=column.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(column,"cellDataTypeInferred"))return;const newColDef=column.getColDef();if(columnTypeOverridesExist&&newColDef.type&&newColDef.type!==oldColDef.type){const updatedColumnState=this.getUpdatedColumnState(column,columnStateUpdates);updatedColumnState.rowGroup&&updatedColumnState.rowGroupIndex==null&&(newRowGroupColumnStateWithoutIndex[colId]=updatedColumnState),updatedColumnState.pivot&&updatedColumnState.pivotIndex==null&&(newPivotColumnStateWithoutIndex[colId]=updatedColumnState),state.push(updatedColumnState)}}),columnTypeOverridesExist&&state.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(newRowGroupColumnStateWithoutIndex,newPivotColumnStateWithoutIndex)),state.length&&this.columnModel.applyColumnState({state},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(column,columnStateUpdates){const columnState=this.columnModel.getColumnStateFromColDef(column);return columnStateUpdates.forEach(key=>{delete columnState[key],key==="rowGroup"?delete columnState.rowGroupIndex:key==="pivot"&&delete columnState.pivotIndex}),columnState}checkObjectValueHandlers(defaultDataTypes){const resolvedObjectDataTypeDefinition=this.dataTypeDefinitions.object,defaultObjectDataTypeDefinition=defaultDataTypes.object;this.hasObjectValueParser=resolvedObjectDataTypeDefinition.valueParser!==defaultObjectDataTypeDefinition.valueParser,this.hasObjectValueFormatter=resolvedObjectDataTypeDefinition.valueFormatter!==defaultObjectDataTypeDefinition.valueFormatter}convertColumnTypes(type){let typeKeys=[];return type instanceof Array?type.some(a=>typeof a!="string")?console.warn("if colDef.type is supplied an array it should be of type 'string[]'"):typeKeys=type:typeof type=="string"?typeKeys=type.split(","):console.warn("colDef.type should be of type 'string' | 'string[]'"),typeKeys}getDateStringTypeDefinition(column){var _a273;return column?(_a273=this.getDataTypeDefinition(column))!=null?_a273:this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(column){return this.getDateStringTypeDefinition(column).dateParser}getDateFormatterFunction(column){return this.getDateStringTypeDefinition(column).dateFormatter}getDataTypeDefinition(column){const colDef=column.getColDef();if(colDef.cellDataType)return this.dataTypeDefinitions[colDef.cellDataType]}getBaseDataType(column){var _a273;return(_a273=this.getDataTypeDefinition(column))==null?void 0:_a273.baseDataType}checkType(column,value){var _a273;if(value==null)return!0;const dataTypeMatcher=(_a273=this.getDataTypeDefinition(column))==null?void 0:_a273.dataTypeMatcher;return dataTypeMatcher?dataTypeMatcher(value):!0}validateColDef(colDef){colDef.cellDataType==="object"&&(colDef.valueFormatter===this.dataTypeDefinitions.object.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&warnOnce('Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),colDef.editable&&colDef.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&warnOnce('Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'))}setColDefPropertiesForBaseDataType(colDef,dataTypeDefinition,colId){const formatValue=__name((column,node,value)=>{let valueFormatter=column.getColDef().valueFormatter;return valueFormatter===dataTypeDefinition.groupSafeValueFormatter&&(valueFormatter=dataTypeDefinition.valueFormatter),this.valueFormatterService.formatValue(column,node,value,valueFormatter)},"formatValue"),usingSetFilter=ModuleRegistry.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()),translate=this.localeService.getLocaleTextFunc(),mergeFilterParams=__name(params=>{const{filterParams}=colDef;colDef.filterParams=typeof filterParams=="object"?__spreadValues(__spreadValues({},filterParams),params):params},"mergeFilterParams");switch(dataTypeDefinition.baseDataType){case"number":{colDef.cellEditor="agNumberCellEditor",usingSetFilter&&mergeFilterParams({comparator:(a,b)=>{const valA=a==null?0:parseInt(a),valB=b==null?0:parseInt(b);return valA===valB?0:valA>valB?1:-1}});break}case"boolean":{colDef.cellEditor="agCheckboxCellEditor",colDef.cellRenderer="agCheckboxCellRenderer",colDef.suppressKeyboardEvent=params=>!!params.colDef.editable&&params.event.key===KeyCode.SPACE,mergeFilterParams(usingSetFilter?{valueFormatter:params=>exists(params.value)?translate(String(params.value),params.value?"True":"False"):translate("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(_filterValues,cellValue)=>cellValue,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(_filterValues,cellValue)=>cellValue===!1,numberOfInputs:0}]});break}case"date":{colDef.cellEditor="agDateCellEditor",colDef.keyCreator=params=>formatValue(params.column,params.node,params.value),usingSetFilter&&mergeFilterParams({valueFormatter:params=>{const valueFormatted=formatValue(params.column,params.node,params.value);return exists(valueFormatted)?valueFormatted:translate("blanks","(Blanks)")},treeList:!0,treeListFormatter:(pathKey,level)=>{if(level===1&&pathKey!=null){const monthKey=MONTH_KEYS[Number(pathKey)-1];return translate(monthKey,MONTH_LOCALE_TEXT[monthKey])}return pathKey??translate("blanks","(Blanks)")}});break}case"dateString":{colDef.cellEditor="agDateStringCellEditor",colDef.keyCreator=params=>formatValue(params.column,params.node,params.value);const convertToDate=dataTypeDefinition.dateParser;mergeFilterParams(usingSetFilter?{valueFormatter:params=>{const valueFormatted=formatValue(params.column,params.node,params.value);return exists(valueFormatted)?valueFormatted:translate("blanks","(Blanks)")},treeList:!0,treeListPathGetter:value=>{const date=convertToDate(value??void 0);return date?[String(date.getFullYear()),String(date.getMonth()+1),String(date.getDate())]:null},treeListFormatter:(pathKey,level)=>{if(level===1&&pathKey!=null){const monthKey=MONTH_KEYS[Number(pathKey)-1];return translate(monthKey,MONTH_LOCALE_TEXT[monthKey])}return pathKey??translate("blanks","(Blanks)")}}:{comparator:(filterDate,cellValue)=>{const cellAsDate=convertToDate(cellValue);return cellValue==null||cellAsDate<filterDate?-1:cellAsDate>filterDate?1:0}});break}case"object":{colDef.cellEditorParams={useFormatter:!0},colDef.comparator=(a,b)=>{const column=this.columnModel.getPrimaryColumn(colId),colDef2=column==null?void 0:column.getColDef();if(!column||!colDef2)return 0;const valA=a==null?"":formatValue(column,null,a),valB=b==null?"":formatValue(column,null,b);return valA===valB?0:valA>valB?1:-1},colDef.keyCreator=params=>formatValue(params.column,params.node,params.value),usingSetFilter?mergeFilterParams({valueFormatter:params=>{const valueFormatted=formatValue(params.column,params.node,params.value);return exists(valueFormatted)?valueFormatted:translate("blanks","(Blanks)")}}):colDef.filterValueGetter=params=>formatValue(params.column,params.node,this.valueService.getValue(params.column,params.node));break}}}getDefaultDataTypes(){const defaultDateFormatMatcher=__name(value=>!!value.match("^\\d{4}-\\d{2}-\\d{2}$"),"defaultDateFormatMatcher"),translate=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:params=>{var _a273,_b;return((_b=(_a273=params.newValue)==null?void 0:_a273.trim)==null?void 0:_b.call(_a273))===""?null:Number(params.newValue)},valueFormatter:params=>params.value==null?"":typeof params.value!="number"||isNaN(params.value)?translate("invalidNumber","Invalid Number"):String(params.value),dataTypeMatcher:value=>typeof value=="number"},text:{baseDataType:"text",valueParser:params=>params.newValue===""?null:toStringOrNull(params.newValue),dataTypeMatcher:value=>typeof value=="string"},boolean:{baseDataType:"boolean",valueParser:params=>{var _a273,_b;return params.newValue==null?params.newValue:((_b=(_a273=params.newValue)==null?void 0:_a273.trim)==null?void 0:_b.call(_a273))===""?null:String(params.newValue).toLowerCase()==="true"},valueFormatter:params=>params.value==null?"":String(params.value),dataTypeMatcher:value=>typeof value=="boolean"},date:{baseDataType:"date",valueParser:params=>parseDateTimeFromString(params.newValue==null?null:String(params.newValue)),valueFormatter:params=>{var _a273;return params.value==null?"":!(params.value instanceof Date)||isNaN(params.value.getTime())?translate("invalidDate","Invalid Date"):(_a273=serialiseDate(params.value,!1))!=null?_a273:""},dataTypeMatcher:value=>value instanceof Date},dateString:{baseDataType:"dateString",dateParser:value=>{var _a273;return(_a273=parseDateTimeFromString(value))!=null?_a273:void 0},dateFormatter:value=>{var _a273;return(_a273=serialiseDate(value??null,!1))!=null?_a273:void 0},valueParser:params=>defaultDateFormatMatcher(String(params.newValue))?params.newValue:null,valueFormatter:params=>defaultDateFormatMatcher(String(params.value))?params.value:"",dataTypeMatcher:value=>typeof value=="string"&&defaultDateFormatMatcher(value)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:params=>{var _a273;return(_a273=toStringOrNull(params.value))!=null?_a273:""}}}}},__name(_a245,"DataTypeService"),_a245);__decorateClass([Autowired("rowModel")],DataTypeService.prototype,"rowModel",2);__decorateClass([Autowired("columnModel")],DataTypeService.prototype,"columnModel",2);__decorateClass([Autowired("columnUtils")],DataTypeService.prototype,"columnUtils",2);__decorateClass([Autowired("valueService")],DataTypeService.prototype,"valueService",2);__decorateClass([Autowired("valueFormatterService")],DataTypeService.prototype,"valueFormatterService",2);__decorateClass([PostConstruct],DataTypeService.prototype,"init",1);DataTypeService=__decorateClass([Bean("dataTypeService")],DataTypeService);var _a246,ValueParserService=(_a246=class extends BeanStub{parseValue(column,rowNode,newValue,oldValue){const colDef=column.getColDef(),params=this.gridOptionsService.addGridCommonParams({node:rowNode,data:rowNode==null?void 0:rowNode.data,oldValue,newValue,colDef,column}),valueParser=colDef.valueParser;return exists(valueParser)?typeof valueParser=="function"?valueParser(params):this.expressionService.evaluate(valueParser,params):newValue}},__name(_a246,"ValueParserService"),_a246);__decorateClass([Autowired("expressionService")],ValueParserService.prototype,"expressionService",2);ValueParserService=__decorateClass([Bean("valueParserService")],ValueParserService);var _a247,SyncService=(_a247=class extends BeanStub{constructor(){super(...arguments),this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",event=>this.setColumnDefs(event))}start(){this.ctrlsService.whenReady(()=>{const columnDefs=this.gridOptionsService.get("columnDefs");columnDefs?this.setColumnsAndData(columnDefs):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(columnDefs){this.columnModel.setColumnDefs(columnDefs??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.dispatchGridReadyEvent();const isEnterprise=ModuleRegistry.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId());new Logger("AG Grid",()=>this.gridOptionsService.get("debug")).log(`initialised successfully, enterprise = ${isEnterprise}`)}dispatchGridReadyEvent(){const readyEvent={type:Events.EVENT_GRID_READY};this.eventService.dispatchEvent(readyEvent)}setColumnDefs(event){const columnDefs=this.gridOptionsService.get("columnDefs");if(columnDefs){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(columnDefs);return}this.columnModel.setColumnDefs(columnDefs,convertSourceType(event.source))}}},__name(_a247,"SyncService"),_a247);__decorateClass([Autowired("ctrlsService")],SyncService.prototype,"ctrlsService",2);__decorateClass([Autowired("columnModel")],SyncService.prototype,"columnModel",2);__decorateClass([Autowired("rowModel")],SyncService.prototype,"rowModel",2);__decorateClass([PostConstruct],SyncService.prototype,"postConstruct",1);SyncService=__decorateClass([Bean("syncService")],SyncService);var _a248,OverlayService=(_a248=class extends BeanStub{constructor(){super(...arguments),this.manuallyDisplayed=!1}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_ROW_DATA_UPDATED,()=>this.onRowDataUpdated()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}registerOverlayWrapperComp(overlayWrapperComp){this.overlayWrapperComp=overlayWrapperComp,(!this.gridOptionsService.get("columnDefs")||this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData"))&&this.showLoadingOverlay()}showLoadingOverlay(){if(this.gridOptionsService.get("suppressLoadingOverlay"))return;const params={},compDetails=this.userComponentFactory.getLoadingOverlayCompDetails(params);this.showOverlay(compDetails,"ag-overlay-loading-wrapper","loadingOverlayComponentParams")}showNoRowsOverlay(){if(this.gridOptionsService.get("suppressNoRowsOverlay"))return;const params={},compDetails=this.userComponentFactory.getNoRowsOverlayCompDetails(params);this.showOverlay(compDetails,"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams")}showOverlay(compDetails,wrapperCssClass,gridOption){const promise=compDetails.newAgStackInstance(),listenerDestroyFunc=this.addManagedPropertyListener(gridOption,({currentValue})=>{promise.then(comp=>{comp.refresh&&comp.refresh(this.gridOptionsService.addGridCommonParams(__spreadValues({},currentValue??{})))})});this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.overlayWrapperComp.showOverlay(promise,wrapperCssClass,listenerDestroyFunc)}hideOverlay(){this.manuallyDisplayed=!1,this.overlayWrapperComp.hideOverlay()}showOrHideOverlay(){const isEmpty=this.paginationProxy.isEmpty(),isSuppressNoRowsOverlay=this.gridOptionsService.get("suppressNoRowsOverlay");isEmpty&&!isSuppressNoRowsOverlay?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){this.columnModel.isReady()&&!this.paginationProxy.isEmpty()&&!this.manuallyDisplayed&&this.hideOverlay()}},__name(_a248,"OverlayService"),_a248);__decorateClass([Autowired("userComponentFactory")],OverlayService.prototype,"userComponentFactory",2);__decorateClass([Autowired("paginationProxy")],OverlayService.prototype,"paginationProxy",2);__decorateClass([Autowired("columnModel")],OverlayService.prototype,"columnModel",2);__decorateClass([PostConstruct],OverlayService.prototype,"postConstruct",1);OverlayService=__decorateClass([Bean("overlayService")],OverlayService);var _a249,StateService=(_a249=class extends BeanStub{constructor(){super(...arguments),this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=debounce(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=debounce(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=debounce(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){var _a273;this.isClientSideRowModel=this.rowModel.getType()==="clientSide",this.cachedState=(_a273=this.gridOptionsService.get("initialState"))!=null?_a273:{},this.ctrlsService.whenReady(()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const newColumnsLoadedDestroyFunc=this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,({source})=>{source==="gridInitializing"&&(newColumnsLoadedDestroyFunc==null||newColumnsLoadedDestroyFunc(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))}),rowCountReadyDestroyFunc=this.addManagedListener(this.eventService,Events.EVENT_ROW_COUNT_READY,()=>{rowCountReadyDestroyFunc==null||rowCountReadyDestroyFunc(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())}),firstDataRenderedDestroyFunc=this.addManagedListener(this.eventService,Events.EVENT_FIRST_DATA_RENDERED,()=>{firstDataRenderedDestroyFunc==null||firstDataRenderedDestroyFunc(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState()),this.addManagedListener(this.eventService,Events.EVENT_TOOL_PANEL_VISIBLE_CHANGED,()=>this.updateCachedState("sideBar",this.getSideBarState())),this.addManagedListener(this.eventService,Events.EVENT_SIDE_BAR_UPDATED,()=>this.updateCachedState("sideBar",this.getSideBarState()))}setupStateOnColumnsInitialised(){var _a273;const initialState=(_a273=this.gridOptionsService.get("initialState"))!=null?_a273:{};this.setColumnState(initialState),this.setColumnGroupState(initialState),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,()=>this.updateColumnState(["aggregation"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,()=>this.updateColumnState(["columnOrder"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PINNED,()=>this.updateColumnState(["columnPinning"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_RESIZED,()=>this.updateColumnState(["columnSizing"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,()=>this.updateColumnState(["columnVisibility"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateColumnState(["rowGroup"])),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,()=>this.updateColumnState(["sort"])),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,()=>this.updateCachedState("columnGroup",this.getColumnGroupState()))}setupStateOnRowCountReady(){var _a273;const{filter:filterState,rowGroupExpansion:rowGroupExpansionState,rowSelection:rowSelectionState,pagination:paginationState}=(_a273=this.gridOptionsService.get("initialState"))!=null?_a273:{},advancedFilterModel=this.gridOptionsService.get("advancedFilterModel");(filterState||advancedFilterModel)&&this.setFilterState(filterState,advancedFilterModel),rowGroupExpansionState&&this.setRowGroupExpansionState(rowGroupExpansionState),rowSelectionState&&this.setRowSelectionState(rowSelectionState),paginationState&&this.setPaginationState(paginationState),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState()),this.addManagedListener(this.eventService,Events.EVENT_FILTER_CHANGED,()=>this.updateCachedState("filter",this.getFilterState())),this.addManagedListener(this.eventService,Events.EVENT_ROW_GROUP_OPENED,()=>this.onRowGroupOpenedDebounced()),this.addManagedListener(this.eventService,Events.EVENT_EXPAND_COLLAPSE_ALL,()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),this.addManagedListener(this.eventService,Events.EVENT_SELECTION_CHANGED,()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()}),this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,event=>{(event.newPage||event.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())})}setupStateOnFirstDataRendered(){var _a273;const{scroll:scrollState,rangeSelection:rangeSelectionState,focusedCell:focusedCellState,columnOrder:columnOrderState}=(_a273=this.gridOptionsService.get("initialState"))!=null?_a273:{};focusedCellState&&this.setFocusedCellState(focusedCellState),rangeSelectionState&&this.setRangeSelectionState(rangeSelectionState),scrollState&&this.setScrollState(scrollState),this.setColumnPivotState(!!(columnOrderState!=null&&columnOrderState.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState()),this.updateCachedState("rangeSelection",this.getRangeSelectionState()),this.updateCachedState("scroll",this.getScrollState()),this.addManagedListener(this.eventService,Events.EVENT_CELL_FOCUSED,()=>this.updateCachedState("focusedCell",this.getFocusedCellState())),this.addManagedListener(this.eventService,Events.EVENT_RANGE_SELECTION_CHANGED,event=>{event.finished&&this.updateCachedState("rangeSelection",this.getRangeSelectionState())}),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL_END,()=>this.updateCachedState("scroll",this.getScrollState()))}getColumnState(){const pivotMode=this.columnModel.isPivotMode(),sortColumns=[],groupColIds=[],aggregationColumns=[],pivotColIds=[],leftColIds=[],rightColIds=[],hiddenColIds=[],columnSizes=[],columns=[],columnState=this.columnModel.getColumnState();for(let i=0;i<columnState.length;i++){const{colId,sort,sortIndex,rowGroup,rowGroupIndex,aggFunc,pivot,pivotIndex,pinned,hide,width,flex}=columnState[i];columns.push(colId),sort&&(sortColumns[sortIndex??0]={colId,sort}),rowGroup&&(groupColIds[rowGroupIndex??0]=colId),typeof aggFunc=="string"&&aggregationColumns.push({colId,aggFunc}),pivot&&(pivotColIds[pivotIndex??0]=colId),pinned&&(pinned==="right"?rightColIds:leftColIds).push(colId),hide&&hiddenColIds.push(colId),(flex||width)&&columnSizes.push({colId,flex:flex??void 0,width})}return{sort:sortColumns.length?{sortModel:sortColumns}:void 0,rowGroup:groupColIds.length?{groupColIds}:void 0,aggregation:aggregationColumns.length?{aggregationModel:aggregationColumns}:void 0,pivot:pivotColIds.length||pivotMode?{pivotMode,pivotColIds}:void 0,columnPinning:leftColIds.length||rightColIds.length?{leftColIds,rightColIds}:void 0,columnVisibility:hiddenColIds.length?{hiddenColIds}:void 0,columnSizing:columnSizes.length?{columnSizingModel:columnSizes}:void 0,columnOrder:columns.length?{orderedColIds:columns}:void 0}}setColumnState(initialState){const{sort:sortState,rowGroup:groupState,aggregation:aggregationState,pivot:pivotState,columnPinning:columnPinningState,columnVisibility:columnVisibilityState,columnSizing:columnSizingState,columnOrder:columnOrderState}=initialState,columnStateMap={},getColumnState=__name(colId=>{let columnState=columnStateMap[colId];return columnState||(columnState={colId},columnStateMap[colId]=columnState,columnState)},"getColumnState");sortState&&sortState.sortModel.forEach(({colId,sort},sortIndex)=>{const columnState=getColumnState(colId);columnState.sort=sort,columnState.sortIndex=sortIndex}),groupState&&groupState.groupColIds.forEach((colId,rowGroupIndex)=>{const columnState=getColumnState(colId);columnState.rowGroup=!0,columnState.rowGroupIndex=rowGroupIndex}),aggregationState&&aggregationState.aggregationModel.forEach(({colId,aggFunc})=>{getColumnState(colId).aggFunc=aggFunc}),pivotState&&(pivotState.pivotColIds.forEach((colId,pivotIndex)=>{const columnState=getColumnState(colId);columnState.pivot=!0,columnState.pivotIndex=pivotIndex}),this.gridOptionsService.updateGridOptions({options:{pivotMode:pivotState.pivotMode},source:"gridInitializing"})),columnPinningState&&(columnPinningState.leftColIds.forEach(colId=>{getColumnState(colId).pinned="left"}),columnPinningState.rightColIds.forEach(colId=>{getColumnState(colId).pinned="right"})),columnVisibilityState&&columnVisibilityState.hiddenColIds.forEach(colId=>{getColumnState(colId).hide=!0}),columnSizingState&&columnSizingState.columnSizingModel.forEach(({colId,flex,width})=>{const columnState=getColumnState(colId);columnState.flex=flex??null,columnState.width=width});const columns=columnOrderState==null?void 0:columnOrderState.orderedColIds,applyOrder=!!(columns!=null&&columns.length),columnStates=applyOrder?columns.map(colId=>getColumnState(colId)):Object.values(columnStateMap);if(columnStates.length){this.columnStates=columnStates;const defaultState={sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};this.columnModel.applyColumnState({state:columnStates,applyOrder,defaultState},"gridInitializing")}}setColumnPivotState(applyOrder){const columnStates=this.columnStates;this.columnStates=void 0;const columnGroupStates=this.columnGroupStates;if(this.columnGroupStates=void 0,!!this.columnModel.isSecondaryColumnsPresent()){if(columnStates){let secondaryColumnStates=[];for(const columnState of columnStates)this.columnModel.getSecondaryColumn(columnState.colId)&&secondaryColumnStates.push(columnState);this.columnModel.applyColumnState({state:secondaryColumnStates,applyOrder},"gridInitializing")}columnGroupStates&&this.columnModel.setColumnGroupState(columnGroupStates,"gridInitializing")}}getColumnGroupState(){const columnGroupState=this.columnModel.getColumnGroupState(),openColumnGroups=[];return columnGroupState.forEach(({groupId,open})=>{open&&openColumnGroups.push(groupId)}),openColumnGroups.length?{openColumnGroupIds:openColumnGroups}:void 0}setColumnGroupState(initialState){var _a273;if(!initialState.hasOwnProperty("columnGroup"))return;const openColumnGroups=new Set((_a273=initialState.columnGroup)==null?void 0:_a273.openColumnGroupIds),stateItems=this.columnModel.getColumnGroupState().map(({groupId})=>{const open=openColumnGroups.has(groupId);return open&&openColumnGroups.delete(groupId),{groupId,open}});openColumnGroups.forEach(groupId=>{stateItems.push({groupId,open:!0})}),stateItems.length&&(this.columnGroupStates=stateItems),this.columnModel.setColumnGroupState(stateItems,"gridInitializing")}getFilterState(){var _a273;let filterModel=this.filterManager.getFilterModel();filterModel&&Object.keys(filterModel).length===0&&(filterModel=void 0);const advancedFilterModel=(_a273=this.filterManager.getAdvancedFilterModel())!=null?_a273:void 0;return filterModel||advancedFilterModel?{filterModel,advancedFilterModel}:void 0}setFilterState(filterState,gridOptionAdvancedFilterModel){const{filterModel,advancedFilterModel}=filterState??{advancedFilterModel:gridOptionAdvancedFilterModel};filterModel&&this.filterManager.setFilterModel(filterModel,"columnFilter"),advancedFilterModel&&this.filterManager.setAdvancedFilterModel(advancedFilterModel)}getRangeSelectionState(){var _a273;const cellRanges=(_a273=this.rangeService)==null?void 0:_a273.getCellRanges().map(cellRange=>{const{id,type,startRow,endRow,columns,startColumn}=cellRange;return{id,type,startRow,endRow,colIds:columns.map(column=>column.getColId()),startColId:startColumn.getColId()}});return cellRanges!=null&&cellRanges.length?{cellRanges}:void 0}setRangeSelectionState(rangeSelectionState){var _a273;if(!this.gridOptionsService.get("enableRangeSelection"))return;const cellRanges=rangeSelectionState.cellRanges.map(cellRange=>__spreadProps(__spreadValues({},cellRange),{columns:cellRange.colIds.map(colId=>this.columnModel.getGridColumn(colId)),startColumn:this.columnModel.getGridColumn(cellRange.startColId)}));(_a273=this.rangeService)==null||_a273.setCellRanges(cellRanges)}getScrollState(){var _a273,_b,_c;if(!this.isClientSideRowModel)return;const scrollFeature=(_a273=this.ctrlsService.getGridBodyCtrl())==null?void 0:_a273.getScrollFeature(),{left}=(_b=scrollFeature==null?void 0:scrollFeature.getHScrollPosition())!=null?_b:{left:0},{top}=(_c=scrollFeature==null?void 0:scrollFeature.getVScrollPosition())!=null?_c:{top:0};return top||left?{top,left}:void 0}setScrollState(scrollState){var _a273;if(!this.isClientSideRowModel)return;const{top,left}=scrollState;(_a273=this.ctrlsService.getGridBodyCtrl())==null||_a273.getScrollFeature().setScrollPosition(top,left)}getSideBarState(){var _a273,_b;return(_b=(_a273=this.sideBarService)==null?void 0:_a273.getSideBarComp())==null?void 0:_b.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const focusedCell=this.focusService.getFocusedCell();if(focusedCell){const{column,rowIndex,rowPinned}=focusedCell;return{colId:column.getColId(),rowIndex,rowPinned}}}setFocusedCellState(focusedCellState){if(!this.isClientSideRowModel)return;const{colId,rowIndex,rowPinned}=focusedCellState;this.focusService.setFocusedCell({column:this.columnModel.getGridColumn(colId),rowIndex,rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const page=this.paginationProxy.getCurrentPage(),pageSize=this.gridOptionsService.get("paginationAutoPageSize")?void 0:this.paginationProxy.getPageSize();if(!(!page&&!pageSize))return{page,pageSize}}setPaginationState(paginationState){paginationState.pageSize&&!this.gridOptionsService.get("paginationAutoPageSize")&&this.paginationProxy.setPageSize(paginationState.pageSize,"initialState"),typeof paginationState.page=="number"&&this.paginationProxy.setPage(paginationState.page)}getRowSelectionState(){var _a273;const selectionState=this.selectionService.getSelectionState();return!selectionState||!Array.isArray(selectionState)&&(selectionState.selectAll===!1||selectionState.selectAllChildren===!1)&&!((_a273=selectionState==null?void 0:selectionState.toggledNodes)!=null&&_a273.length)?void 0:selectionState}setRowSelectionState(rowSelectionState){this.selectionService.setSelectionState(rowSelectionState,"gridInitializing")}getRowGroupExpansionState(){const expandedRowGroups=this.expansionService.getExpandedRows();return expandedRowGroups.length?{expandedRowGroupIds:expandedRowGroups}:void 0}setRowGroupExpansionState(rowGroupExpansionState){this.expansionService.expandRows(rowGroupExpansionState.expandedRowGroupIds)}updateColumnState(features){const newColumnState=this.getColumnState();let hasChanged=!1;Object.entries(newColumnState).forEach(([key,value])=>{jsonEquals(value,this.cachedState[key])||(hasChanged=!0)}),this.cachedState=__spreadValues(__spreadValues({},this.cachedState),newColumnState),hasChanged&&this.dispatchStateUpdateEvent(features)}updateCachedState(key,value){const existingValue=this.cachedState[key];this.setCachedStateValue(key,value),jsonEquals(value,existingValue)||this.dispatchStateUpdateEvent([key])}setCachedStateValue(key,value){this.cachedState=__spreadProps(__spreadValues({},this.cachedState),{[key]:value})}refreshStaleState(){this.staleStateKeys.forEach(key=>{switch(key){case"rowSelection":this.setCachedStateValue(key,this.getRowSelectionState());break}}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(sources){this.suppressEvents||(sources.forEach(source=>this.queuedUpdateSources.add(source)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const sources=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear();const event={type:Events.EVENT_STATE_UPDATED,sources,state:this.cachedState};this.eventService.dispatchEvent(event)}suppressEventsAndDispatchInitEvent(updateFunc){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),updateFunc(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}},__name(_a249,"StateService"),_a249);__decorateClass([Autowired("filterManager")],StateService.prototype,"filterManager",2);__decorateClass([Optional("rangeService")],StateService.prototype,"rangeService",2);__decorateClass([Autowired("ctrlsService")],StateService.prototype,"ctrlsService",2);__decorateClass([Optional("sideBarService")],StateService.prototype,"sideBarService",2);__decorateClass([Autowired("focusService")],StateService.prototype,"focusService",2);__decorateClass([Autowired("columnModel")],StateService.prototype,"columnModel",2);__decorateClass([Autowired("paginationProxy")],StateService.prototype,"paginationProxy",2);__decorateClass([Autowired("rowModel")],StateService.prototype,"rowModel",2);__decorateClass([Autowired("selectionService")],StateService.prototype,"selectionService",2);__decorateClass([Autowired("expansionService")],StateService.prototype,"expansionService",2);__decorateClass([Autowired("columnAnimationService")],StateService.prototype,"columnAnimationService",2);__decorateClass([PostConstruct],StateService.prototype,"postConstruct",1);StateService=__decorateClass([Bean("stateService")],StateService);var _a250,ValidationService=(_a250=class extends BeanStub{init(){this.processGridOptions(this.gridOptions)}processGridOptions(options){this.processOptions(options,GRID_OPTIONS_VALIDATORS)}processColumnDefs(options){this.processOptions(options,COL_DEF_VALIDATORS)}processOptions(options,validator){const{validations,deprecations,allProperties,propertyExceptions,objectName,docsUrl}=validator;allProperties&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(options,[...propertyExceptions??[],...Object.keys(deprecations)],allProperties,objectName,docsUrl);const warnings=new Set;Object.keys(options).forEach(key=>{var _a273;const deprecation=deprecations[key];if(deprecation)if("renamed"in deprecation){const{renamed,version}=deprecation;warnings.add(`As of v${version}, ${String(key)} is deprecated. Please use ${String(renamed)} instead.`),options[renamed]=options[key]}else{const{message,version}=deprecation;warnings.add(`As of v${version}, ${String(key)} is deprecated. ${message??""}`)}const value=options[key];if(value==null||value===!1)return;const rulesOrGetter=validations[key];let rules;if(rulesOrGetter)if(typeof rulesOrGetter=="function"){const fromGetter=rulesOrGetter(options,this.gridOptions);if(!fromGetter)return;if("objectName"in fromGetter){const value2=options[key];if(Array.isArray(value2)){value2.forEach(item=>{this.processOptions(item,fromGetter)});return}this.processOptions(options[key],fromGetter);return}rules=fromGetter}else rules=rulesOrGetter;else return;const{module,dependencies,supportedRowModels}=rules;if(supportedRowModels){const rowModel=(_a273=this.gridOptions.rowModelType)!=null?_a273:"clientSide";if(!supportedRowModels.includes(rowModel)){warnings.add(`${String(key)} is not supported with the '${rowModel}' row model.`);return}}if(module){const modules=Array.isArray(module)?module:[module];let allRegistered=!0;if(modules.forEach(m=>{ModuleRegistry.__assertRegistered(m,String(key),this.context.getGridId())||(allRegistered=!1,warnings.add(`${String(key)} is only available when ${m} is loaded.`))}),!allRegistered)return}if(dependencies){const warning=this.checkForWarning(key,dependencies,options);if(warning){warnings.add(warning);return}}}),warnings.size>0&&warnings.forEach(warning=>{warnOnce(warning)})}checkForWarning(key,validator,options){if(typeof validator=="function")return validator(options,this.gridOptions);const failed=Object.entries(validator).find(([key2,value])=>{const gridOptionValue=options[key2];return!value.includes(gridOptionValue)});if(!failed)return null;const[failedKey,possibleOptions]=failed;return possibleOptions.length>1?`'${String(key)}' requires '${failedKey}' to be one of [${possibleOptions.join(", ")}].`:`'${String(key)}' requires '${failedKey}' to be ${possibleOptions[0]}.`}checkProperties(object,exceptions,validProperties,containerName,docsUrl){const VUE_FRAMEWORK_PROPS=["__ob__","__v_skip","__metadata__"],invalidProperties=fuzzyCheckStrings(Object.getOwnPropertyNames(object),[...VUE_FRAMEWORK_PROPS,...exceptions,...validProperties],validProperties);if(iterateObject(invalidProperties,(key,value)=>{warnOnce(`invalid ${containerName} property '${key}' did you mean any of these: ${value.slice(0,8).join(", ")}`)}),Object.keys(invalidProperties).length>0&&docsUrl){const url=this.getFrameworkOverrides().getDocLink(docsUrl);warnOnce(`to see all the valid ${containerName} properties please check: ${url}`)}}},__name(_a250,"ValidationService"),_a250);__decorateClass([Autowired("gridOptions")],ValidationService.prototype,"gridOptions",2);__decorateClass([PostConstruct],ValidationService.prototype,"init",1);ValidationService=__decorateClass([Bean("validationService")],ValidationService);var _a251,ApiEventService=(_a251=class extends BeanStub{constructor(){super(...arguments),this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new FrameworkEventListenerService(this.getFrameworkOverrides())}addEventListener(eventType,userListener){const listener=this.frameworkEventWrappingService.wrap(userListener),async=this.gridOptionsService.useAsyncEvents()&&!ALWAYS_SYNC_GLOBAL_EVENTS.has(eventType),listeners=async?this.asyncEventListeners:this.syncEventListeners;listeners.has(eventType)||listeners.set(eventType,new Set),listeners.get(eventType).add(listener),this.eventService.addEventListener(eventType,listener,async)}removeEventListener(eventType,userListener){var _a273;const listener=this.frameworkEventWrappingService.unwrap(userListener),asyncListeners=this.asyncEventListeners.get(eventType),hasAsync=!!(asyncListeners!=null&&asyncListeners.delete(listener));hasAsync||(_a273=this.syncEventListeners.get(eventType))==null||_a273.delete(listener),this.eventService.removeEventListener(eventType,listener,hasAsync)}addGlobalListener(userListener){const listener=this.frameworkEventWrappingService.wrapGlobal(userListener);if(this.gridOptionsService.useAsyncEvents()){const syncListener=__name((eventType,event)=>{ALWAYS_SYNC_GLOBAL_EVENTS.has(eventType)&&listener(eventType,event)},"syncListener"),asyncListener=__name((eventType,event)=>{ALWAYS_SYNC_GLOBAL_EVENTS.has(eventType)||listener(eventType,event)},"asyncListener");this.globalEventListenerPairs.set(userListener,{syncListener,asyncListener}),this.eventService.addGlobalListener(syncListener,!1),this.eventService.addGlobalListener(asyncListener,!0)}else this.syncGlobalEventListeners.add(listener),this.eventService.addGlobalListener(listener,!1)}removeGlobalListener(userListener){const listener=this.frameworkEventWrappingService.unwrapGlobal(userListener);if(this.globalEventListenerPairs.has(listener)){const{syncListener,asyncListener}=this.globalEventListenerPairs.get(listener);this.eventService.removeGlobalListener(syncListener,!1),this.eventService.removeGlobalListener(asyncListener,!0),this.globalEventListenerPairs.delete(userListener)}else this.syncGlobalEventListeners.delete(listener),this.eventService.removeGlobalListener(listener,!1)}destroyEventListeners(map,async){map.forEach((listeners,eventType)=>{listeners.forEach(listener=>this.eventService.removeEventListener(eventType,listener,async)),listeners.clear()}),map.clear()}destroyGlobalListeners(set,async){set.forEach(listener=>this.eventService.removeGlobalListener(listener,async)),set.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener,asyncListener})=>{this.eventService.removeGlobalListener(syncListener,!1),this.eventService.removeGlobalListener(asyncListener,!0)}),this.globalEventListenerPairs.clear()}},__name(_a251,"ApiEventService"),_a251);__decorateClass([PostConstruct],ApiEventService.prototype,"postConstruct",1);ApiEventService=__decorateClass([Bean("apiEventService")],ApiEventService);var _a252,PageSizeSelectorComp=(_a252=class extends Component{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const newValue=this.selectPageSizeComp.getValue();if(!newValue)return;const paginationPageSize=Number(newValue);isNaN(paginationPageSize)||paginationPageSize<1||paginationPageSize===this.paginationProxy.getPageSize()||(this.paginationProxy.setPageSize(paginationPageSize,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}init(){this.addManagedPropertyListener("paginationPageSizeSelector",()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,event=>this.handlePaginationChanged(event))}handlePaginationChanged(paginationChangedEvent){if(!this.selectPageSizeComp||!(paginationChangedEvent!=null&&paginationChangedEvent.newPageSize))return;const paginationPageSize=this.paginationProxy.getPageSize();this.getPageSizeSelectorValues().includes(paginationPageSize)?this.selectPageSizeComp.setValue(paginationPageSize.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(show){this.selectPageSizeComp&&this.reset(),show&&(this.reloadPageSizesSelector(),this.selectPageSizeComp&&this.appendChild(this.selectPageSizeComp))}reset(){clearElement(this.getGui()),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0)}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gridOptionsService.get("pagination")&&!this.gridOptionsService.get("suppressPaginationPanel")&&!this.gridOptionsService.get("paginationAutoPageSize")&&this.gridOptionsService.get("paginationPageSizeSelector")!==!1}reloadPageSizesSelector(){const pageSizeOptions=this.getPageSizeSelectorValues(),paginationPageSizeOption=this.paginationProxy.getPageSize(),shouldAddAndSelectEmptyOption=!paginationPageSizeOption||!pageSizeOptions.includes(paginationPageSizeOption);shouldAddAndSelectEmptyOption&&(pageSizeOptions.unshift(""),warnOnce(`The paginationPageSize grid option is set to a value that is not in the list of page size options.
                Please make sure that the paginationPageSize grid option is set to one of the values in the 
                paginationPageSizeSelector array, or set the paginationPageSizeSelector to false to hide the page size selector.`)),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0);const localeTextFunc=this.localeService.getLocaleTextFunc(),localisedLabel=localeTextFunc("pageSizeSelectorLabel","Page Size:"),options=pageSizeOptions.map(value=>({value:String(value),text:String(value)})),localisedAriaLabel=localeTextFunc("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new AgSelect).addOptions(options).setValue(String(shouldAddAndSelectEmptyOption?"":paginationPageSizeOption)).setAriaLabel(localisedAriaLabel).setLabel(localisedLabel).onValueChange(()=>this.handlePageSizeItemSelected()),this.hasEmptyOption=shouldAddAndSelectEmptyOption}getPageSizeSelectorValues(){const defaultValues=[20,50,100],paginationPageSizeSelectorValues=this.gridOptionsService.get("paginationPageSizeSelector");return!Array.isArray(paginationPageSizeSelectorValues)||!this.validateValues(paginationPageSizeSelectorValues)?defaultValues:[...paginationPageSizeSelectorValues].sort((a,b)=>a-b)}validateValues(values2){if(!values2.length)return warnOnce(`The paginationPageSizeSelector grid option is an empty array. This is most likely a mistake.
                If you want to hide the page size selector, please set the paginationPageSizeSelector to false.`),!1;for(let i=0;i<values2.length;i++){const value=values2[i],isNumber=typeof value=="number",isPositive=value>0;if(!isNumber)return warnOnce(`The paginationPageSizeSelector grid option contains a non-numeric value.
                    Please make sure that all values in the paginationPageSizeSelector array are numbers.`),!1;if(!isPositive)return warnOnce(`The paginationPageSizeSelector grid option contains a negative number or zero.
                    Please make sure that all values in the paginationPageSizeSelector array are positive.`),!1}return!0}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},__name(_a252,"PageSizeSelectorComp"),_a252);__decorateClass([Autowired("localeService")],PageSizeSelectorComp.prototype,"localeService",2);__decorateClass([Autowired("gridOptionsService")],PageSizeSelectorComp.prototype,"gridOptionsService",2);__decorateClass([Autowired("paginationProxy")],PageSizeSelectorComp.prototype,"paginationProxy",2);__decorateClass([PostConstruct],PageSizeSelectorComp.prototype,"init",1);var _a253,AriaAnnouncementService=(_a253=class extends BeanStub{constructor(){super(),this.descriptionContainer=null,this.announceValue=debounce(this.announceValue.bind(this),200)}postConstruct(){const eDocument=this.gridOptionsService.getDocument(),div=this.descriptionContainer=eDocument.createElement("div");div.classList.add("ag-aria-description-container"),setAriaLive(div,"polite"),setAriaRelevant(div,"additions text"),setAriaAtomic(div,!0),this.eGridDiv.appendChild(div)}announceValue(value){this.descriptionContainer&&(this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=value)},50))}destroy(){super.destroy();const{descriptionContainer}=this;descriptionContainer&&(clearElement(descriptionContainer),descriptionContainer.parentElement&&descriptionContainer.parentElement.removeChild(descriptionContainer)),this.descriptionContainer=null,this.eGridDiv=null}},__name(_a253,"AriaAnnouncementService"),_a253);__decorateClass([Autowired("eGridDiv")],AriaAnnouncementService.prototype,"eGridDiv",2);__decorateClass([PostConstruct],AriaAnnouncementService.prototype,"postConstruct",1);AriaAnnouncementService=__decorateClass([Bean("ariaAnnouncementService")],AriaAnnouncementService);var nextGridId=1,_a254,GridCoreCreator=(_a254=class{create(eGridDiv,gridOptions,createUi,acceptChanges,params){var _a273;const debug=!!gridOptions.debug,gridId=(_a273=gridOptions.gridId)!=null?_a273:String(nextGridId++),registeredModules=this.getRegisteredModules(params,gridId),beanClasses=this.createBeansList(gridOptions.rowModelType,registeredModules,gridId),providedBeanInstances=this.createProvidedBeans(eGridDiv,gridOptions,params);if(!beanClasses){errorOnce("Failed to create grid.");return}const contextParams={providedBeanInstances,beanClasses,debug,gridId},contextLogger=new Logger("Context",()=>contextParams.debug),context=new Context(contextParams,contextLogger),beans=context.getBean("beans");return this.registerModuleUserComponents(beans,registeredModules),this.registerStackComponents(beans,registeredModules),this.registerControllers(beans,registeredModules),createUi(context),beans.syncService.start(),acceptChanges&&acceptChanges(context),beans.gridApi}registerControllers(beans,registeredModules){registeredModules.forEach(module=>{module.controllers&&module.controllers.forEach(meta=>beans.ctrlsFactory.register(meta))})}registerStackComponents(beans,registeredModules){const agStackComponents=this.createAgStackComponentsList(registeredModules);beans.agStackComponentsRegistry.setupComponents(agStackComponents)}getRegisteredModules(params,gridId){const passedViaConstructor=params?params.modules:null,registered=ModuleRegistry.__getRegisteredModules(gridId),allModules=[],mapNames={},addModule=__name((moduleBased,mod,gridId2)=>{__name(currentModule=>{mapNames[currentModule.moduleName]||(mapNames[currentModule.moduleName]=!0,allModules.push(currentModule),ModuleRegistry.__register(currentModule,moduleBased,gridId2))},"addIndividualModule")(mod),mod.dependantModules&&mod.dependantModules.forEach(m=>addModule(moduleBased,m,gridId2))},"addModule");return passedViaConstructor&&passedViaConstructor.forEach(m=>addModule(!0,m,gridId)),registered&&registered.forEach(m=>addModule(!ModuleRegistry.__isPackageBased(),m,void 0)),allModules}registerModuleUserComponents(beans,registeredModules){this.extractModuleEntity(registeredModules,module=>module.userComponents?module.userComponents:[]).forEach(compMeta=>{beans.userComponentRegistry.registerDefaultComponent(compMeta.componentName,compMeta.componentClass)})}createProvidedBeans(eGridDiv,gridOptions,params){let frameworkOverrides=params?params.frameworkOverrides:null;missing(frameworkOverrides)&&(frameworkOverrides=new VanillaFrameworkOverrides);const seed={gridOptions,eGridDiv,globalEventListener:params?params.globalEventListener:null,globalSyncEventListener:params?params.globalSyncEventListener:null,frameworkOverrides};return params&&params.providedBeanInstances&&Object.assign(seed,params.providedBeanInstances),seed}createAgStackComponentsList(registeredModules){let components=[{componentName:"AgCheckbox",componentClass:AgCheckbox},{componentName:"AgRadioButton",componentClass:AgRadioButton},{componentName:"AgToggleButton",componentClass:AgToggleButton},{componentName:"AgInputTextField",componentClass:AgInputTextField},{componentName:"AgInputTextArea",componentClass:AgInputTextArea},{componentName:"AgInputNumberField",componentClass:AgInputNumberField},{componentName:"AgInputDateField",componentClass:AgInputDateField},{componentName:"AgInputRange",componentClass:AgInputRange},{componentName:"AgRichSelect",componentClass:AgRichSelect},{componentName:"AgSelect",componentClass:AgSelect},{componentName:"AgSlider",componentClass:AgSlider},{componentName:"AgGridBody",componentClass:GridBodyComp},{componentName:"AgHeaderRoot",componentClass:GridHeaderComp},{componentName:"AgSortIndicator",componentClass:SortIndicatorComp},{componentName:"AgPagination",componentClass:PaginationComp},{componentName:"AgPageSizeSelector",componentClass:PageSizeSelectorComp},{componentName:"AgOverlayWrapper",componentClass:OverlayWrapperComponent},{componentName:"AgGroupComponent",componentClass:AgGroupComponent},{componentName:"AgRowContainer",componentClass:RowContainerComp},{componentName:"AgFakeHorizontalScroll",componentClass:FakeHScrollComp},{componentName:"AgFakeVerticalScroll",componentClass:FakeVScrollComp},{componentName:"AgAutocomplete",componentClass:AgAutocomplete}];const moduleAgStackComps=this.extractModuleEntity(registeredModules,module=>module.agStackComponents?module.agStackComponents:[]);return components=components.concat(moduleAgStackComps),components}createBeansList(rowModelType="clientSide",registeredModules,gridId){const rowModelModules=registeredModules.filter(module=>!module.rowModel||module.rowModel===rowModelType),rowModelModuleNames={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!rowModelModuleNames[rowModelType]){errorOnce("Could not find row model for rowModelType = "+rowModelType);return}if(!ModuleRegistry.__assertRegistered(rowModelModuleNames[rowModelType],`rowModelType = '${rowModelType}'`,gridId))return;const beans=[Beans,RowPositionUtils,CellPositionUtils,HeaderPositionUtils,PaginationAutoPageSizeService,GridApi,UserComponentRegistry,AgComponentUtils,ComponentMetadataProvider,ResizeObserverService,UserComponentFactory,RowContainerHeightService,HorizontalResizeService,LocaleService,ValidationService,PinnedRowModel,DragService,DisplayedGroupCreator,EventService,GridOptionsService,PopupService,SelectionService,FilterManager,ColumnModel,HeaderNavigationService,PaginationProxy,RowRenderer,ExpressionService,ColumnFactory,TemplateService,AlignedGridsService,NavigationService,ValueCache,ValueService,LoggerFactory,ColumnUtils,AutoWidthCalculator,StandardMenuFactory,DragAndDropService,ColumnApi,FocusService,MouseEventService,Environment,CellNavigationService,ValueFormatterService,StylingService,ScrollVisibleService,SortController,ColumnHoverService,ColumnAnimationService,SelectableService,AutoGroupColService,ChangeDetectionService,AnimationFrameService,UndoRedoService,AgStackComponentsRegistry,ColumnDefFactory,RowCssClassCalculator,RowNodeBlockLoader,RowNodeSorter,CtrlsService,PinnedWidthService,RowNodeEventThrottle,CtrlsFactory,DataTypeService,ValueParserService,QuickFilterService,SyncService,OverlayService,StateService,ExpansionService,ApiEventService,AriaAnnouncementService,MenuService],moduleBeans=this.extractModuleEntity(rowModelModules,module=>module.beans?module.beans:[]);beans.push(...moduleBeans);const beansNoDuplicates=[];return beans.forEach(bean=>{beansNoDuplicates.indexOf(bean)<0&&beansNoDuplicates.push(bean)}),beansNoDuplicates}extractModuleEntity(moduleEntities,extractor){return[].concat(...moduleEntities.map(extractor))}},__name(_a254,"GridCoreCreator"),_a254),_a255,BaseComponentWrapper=(_a255=class{wrap(OriginalConstructor,mandatoryMethodList,optionalMethodList=[],componentType){const wrapper=this.createWrapper(OriginalConstructor,componentType);return mandatoryMethodList.forEach(methodName=>{this.createMethod(wrapper,methodName,!0)}),optionalMethodList.forEach(methodName=>{this.createMethod(wrapper,methodName,!1)}),wrapper}unwrap(comp){return comp}createMethod(wrapper,methodName,mandatory){wrapper.addMethod(methodName,this.createMethodProxy(wrapper,methodName,mandatory))}createMethodProxy(wrapper,methodName,mandatory){return function(){return wrapper.hasMethod(methodName)?wrapper.callMethod(methodName,arguments):(mandatory&&console.warn("AG Grid: Framework component is missing the method "+methodName+"()"),null)}}},__name(_a255,"BaseComponentWrapper"),_a255),globalObj=typeof global>"u"?{}:global;globalObj.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement;globalObj.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement;globalObj.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement;globalObj.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement;globalObj.Node=typeof Node>"u"?{}:Node;globalObj.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var _a256,_ClientSideNodeManager=(_a256=class{constructor(rootNode,gridOptionsService,eventService,columnModel,selectionService,beans){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=rootNode,this.gridOptionsService=gridOptionsService,this.eventService=eventService,this.columnModel=columnModel,this.beans=beans,this.selectionService=selectionService,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=_a256.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return _.cloneObject(this.allNodesMap)}getRowNode(id){return this.allNodesMap[id]}setRowData(rowData){if(typeof rowData=="string"){console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first");return}this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(rowData);const rootNode=this.rootNode,sibling=this.rootNode.sibling;rootNode.childrenAfterFilter=null,rootNode.childrenAfterGroup=null,rootNode.childrenAfterAggFilter=null,rootNode.childrenAfterSort=null,rootNode.childrenMapped=null,rootNode.updateHasChildren(),this.nextId=0,this.allNodesMap={},rowData?rootNode.allLeafChildren=rowData.map(dataItem=>this.createNode(dataItem,this.rootNode,_a256.TOP_LEVEL)):(rootNode.allLeafChildren=[],rootNode.childrenAfterGroup=[]),sibling&&(sibling.childrenAfterFilter=rootNode.childrenAfterFilter,sibling.childrenAfterGroup=rootNode.childrenAfterGroup,sibling.childrenAfterAggFilter=rootNode.childrenAfterAggFilter,sibling.childrenAfterSort=rootNode.childrenAfterSort,sibling.childrenMapped=rootNode.childrenMapped,sibling.allLeafChildren=rootNode.allLeafChildren)}updateRowData(rowDataTran,rowNodeOrder){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(rowDataTran.add);const rowNodeTransaction={remove:[],update:[],add:[]},nodesToUnselect=[];return this.executeRemove(rowDataTran,rowNodeTransaction,nodesToUnselect),this.executeUpdate(rowDataTran,rowNodeTransaction,nodesToUnselect),this.executeAdd(rowDataTran,rowNodeTransaction),this.updateSelection(nodesToUnselect,"rowDataChanged"),rowNodeOrder&&_.sortRowNodesByOrder(this.rootNode.allLeafChildren,rowNodeOrder),rowNodeTransaction}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(rowData){const event={type:Events.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:rowData!=null&&rowData.length?rowData[0]:null};this.eventService.dispatchEvent(event)}updateSelection(nodesToUnselect,source){const selectionChanged=nodesToUnselect.length>0;if(selectionChanged&&this.selectionService.setNodesSelected({newValue:!1,nodes:nodesToUnselect,suppressFinishActions:!0,source}),this.selectionService.updateGroupsFromChildrenSelections(source),selectionChanged){const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}}executeAdd(rowDataTran,rowNodeTransaction){var _a273;const{add,addIndex}=rowDataTran;if(_.missingOrEmpty(add))return;const newNodes=add.map(item=>this.createNode(item,this.rootNode,_a256.TOP_LEVEL));if(typeof addIndex=="number"&&addIndex>=0){const{allLeafChildren}=this.rootNode,len=allLeafChildren.length;let normalisedAddIndex=addIndex;if(this.gridOptionsService.get("treeData")&&addIndex>0&&len>0){for(let i=0;i<len;i++)if(((_a273=allLeafChildren[i])==null?void 0:_a273.rowIndex)==addIndex-1){normalisedAddIndex=i+1;break}}const nodesBeforeIndex=allLeafChildren.slice(0,normalisedAddIndex),nodesAfterIndex=allLeafChildren.slice(normalisedAddIndex,allLeafChildren.length);this.rootNode.allLeafChildren=[...nodesBeforeIndex,...newNodes,...nodesAfterIndex]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...newNodes];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),rowNodeTransaction.add=newNodes}executeRemove(rowDataTran,rowNodeTransaction,nodesToUnselect){const{remove}=rowDataTran;if(_.missingOrEmpty(remove))return;const rowIdsRemoved={};remove.forEach(item=>{const rowNode=this.lookupRowNode(item);rowNode&&(rowNode.isSelected()&&nodesToUnselect.push(rowNode),rowNode.clearRowTopAndRowIndex(),rowIdsRemoved[rowNode.id]=!0,delete this.allNodesMap[rowNode.id],rowNodeTransaction.remove.push(rowNode))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(rowNode=>!rowIdsRemoved[rowNode.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(rowDataTran,rowNodeTransaction,nodesToUnselect){const{update}=rowDataTran;_.missingOrEmpty(update)||update.forEach(item=>{const rowNode=this.lookupRowNode(item);rowNode&&(rowNode.updateData(item),!rowNode.selectable&&rowNode.isSelected()&&nodesToUnselect.push(rowNode),this.setMasterForRow(rowNode,item,_a256.TOP_LEVEL,!1),rowNodeTransaction.update.push(rowNode))})}lookupRowNode(data){const getRowIdFunc=this.gridOptionsService.getCallback("getRowId");let rowNode;if(getRowIdFunc){const id=getRowIdFunc({data,level:0});if(rowNode=this.allNodesMap[id],!rowNode)return console.error(`AG Grid: could not find row id=${id}, data item was not found for this id`),null}else if(rowNode=this.rootNode.allLeafChildren.find(node=>node.data===data),!rowNode)return console.error("AG Grid: could not find data item as object was not found",data),console.error("Consider using getRowId to help the Grid find matching row data"),null;return rowNode||null}createNode(dataItem,parent,level){const node=new RowNode(this.beans);node.group=!1,this.setMasterForRow(node,dataItem,level,!0);const suppressParentsInRowNodes=this.gridOptionsService.get("suppressParentsInRowNodes");return parent&&!suppressParentsInRowNodes&&(node.parent=parent),node.level=level,node.setDataAndId(dataItem,this.nextId.toString()),this.allNodesMap[node.id]&&console.warn(`AG Grid: duplicate node id '${node.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[node.id]=node,this.nextId++,node}setMasterForRow(rowNode,data,level,setExpanded){if(this.gridOptionsService.get("treeData"))rowNode.setMaster(!1),setExpanded&&(rowNode.expanded=!1);else{if(this.gridOptionsService.get("masterDetail")){const isRowMasterFunc=this.gridOptionsService.get("isRowMaster");isRowMasterFunc?rowNode.setMaster(isRowMasterFunc(data)):rowNode.setMaster(!0)}else rowNode.setMaster(!1);if(setExpanded){const rowGroupColumns=this.columnModel.getRowGroupColumns(),numRowGroupColumns=rowGroupColumns?rowGroupColumns.length:0,masterRowLevel=level+numRowGroupColumns;rowNode.expanded=rowNode.master?this.isExpanded(masterRowLevel):!1}}}isExpanded(level){const expandByDefault=this.gridOptionsService.get("groupDefaultExpanded");return expandByDefault===-1?!0:level<expandByDefault}},__name(_a256,"_ClientSideNodeManager"),_a256);_ClientSideNodeManager.TOP_LEVEL=0;_ClientSideNodeManager.ROOT_NODE_ID="ROOT_NODE_ID";var ClientSideNodeManager=_ClientSideNodeManager,_a257,ClientSideRowModel=(_a257=class extends BeanStub{constructor(){super(...arguments),this.onRowHeightChanged_debounced=_.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}init(){const refreshEverythingFunc=this.refreshModel.bind(this,{step:"group"}),animate=!this.gridOptionsService.get("suppressAnimationFrame"),refreshEverythingAfterColsChangedFunc=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate});this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,refreshEverythingAfterColsChangedFunc),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,refreshEverythingFunc),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:"pivot"})),this.addManagedListener(this.eventService,Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,refreshEverythingFunc),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_GRID_READY,()=>this.onGridReady()),this.addPropertyListeners(),this.rootNode=new RowNode(this.beans),this.nodeManager=new ClientSideNodeManager(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)}addPropertyListeners(){const resetProps=new Set(["treeData","masterDetail"]),groupStageRefreshProps=new Set(["suppressParentsInRowNodes","groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),filterStageRefreshProps=new Set(["excludeChildrenWhenTreeDataFiltering"]),pivotStageRefreshProps=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),aggregateStageRefreshProps=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly"]),sortStageRefreshProps=new Set(["postSortRows","groupDisplayType","accentedSort"]),filterAggStageRefreshProps=new Set([]),flattenStageRefreshProps=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter"]),allProps=[...resetProps,...groupStageRefreshProps,...filterStageRefreshProps,...pivotStageRefreshProps,...pivotStageRefreshProps,...aggregateStageRefreshProps,...sortStageRefreshProps,...filterAggStageRefreshProps,...flattenStageRefreshProps];this.addManagedPropertyListeners(allProps,params=>{var _a273;const properties=(_a273=params.changeSet)==null?void 0:_a273.properties;if(!properties)return;const arePropertiesImpacted=__name(propSet=>properties.some(prop=>propSet.has(prop)),"arePropertiesImpacted");if(arePropertiesImpacted(resetProps)){this.setRowData(this.rootNode.allLeafChildren.map(child=>child.data));return}if(arePropertiesImpacted(groupStageRefreshProps)){this.refreshModel({step:"group"});return}if(arePropertiesImpacted(filterStageRefreshProps)){this.refreshModel({step:"filter"});return}if(arePropertiesImpacted(pivotStageRefreshProps)){this.refreshModel({step:"pivot"});return}if(arePropertiesImpacted(aggregateStageRefreshProps)){this.refreshModel({step:"aggregate"});return}if(arePropertiesImpacted(sortStageRefreshProps)){this.refreshModel({step:"sort"});return}if(arePropertiesImpacted(filterAggStageRefreshProps)){this.refreshModel({step:"filter_aggregates"});return}arePropertiesImpacted(flattenStageRefreshProps)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const rowData=this.gridOptionsService.get("rowData");rowData&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(rowData))}ensureRowHeightsValid(startPixel,endPixel,startLimitIndex,endLimitIndex){let atLeastOneChange,res=!1;do{atLeastOneChange=!1;const rowAtStartPixel=this.getRowIndexAtPixel(startPixel),rowAtEndPixel=this.getRowIndexAtPixel(endPixel),firstRow=Math.max(rowAtStartPixel,startLimitIndex),lastRow=Math.min(rowAtEndPixel,endLimitIndex);for(let rowIndex=firstRow;rowIndex<=lastRow;rowIndex++){const rowNode=this.getRow(rowIndex);if(rowNode.rowHeightEstimated){const rowHeight=this.gridOptionsService.getRowHeightForNode(rowNode);rowNode.setRowHeight(rowHeight.height),atLeastOneChange=!0,res=!0}}atLeastOneChange&&this.setRowTopAndRowIndex()}while(atLeastOneChange);return res}setRowTopAndRowIndex(){const defaultRowHeight=this.environment.getDefaultRowHeight();let nextRowTop=0;const displayedRowsMapped=new Set,allowEstimate=this.gridOptionsService.isDomLayout("normal");for(let i=0;i<this.rowsToDisplay.length;i++){const rowNode=this.rowsToDisplay[i];if(rowNode.id!=null&&displayedRowsMapped.add(rowNode.id),rowNode.rowHeight==null){const rowHeight=this.gridOptionsService.getRowHeightForNode(rowNode,allowEstimate,defaultRowHeight);rowNode.setRowHeight(rowHeight.height,rowHeight.estimated)}rowNode.setRowTop(nextRowTop),rowNode.setRowIndex(i),nextRowTop+=rowNode.rowHeight}return displayedRowsMapped}clearRowTopAndRowIndex(changedPath,displayedRowsMapped){const changedPathActive=changedPath.isActive(),clearIfNotDisplayed=__name(rowNode=>{rowNode&&rowNode.id!=null&&!displayedRowsMapped.has(rowNode.id)&&rowNode.clearRowTopAndRowIndex()},"clearIfNotDisplayed"),recurse=__name(rowNode=>{if(clearIfNotDisplayed(rowNode),clearIfNotDisplayed(rowNode.detailNode),clearIfNotDisplayed(rowNode.sibling),rowNode.hasChildren()&&rowNode.childrenAfterGroup){const isRootNode=rowNode.level==-1;changedPathActive&&!isRootNode&&!rowNode.expanded||rowNode.childrenAfterGroup.forEach(recurse)}},"recurse");recurse(this.rootNode)}ensureRowsAtPixel(rowNodes,pixel,increment=0){const indexAtPixelNow=this.getRowIndexAtPixel(pixel),rowNodeAtPixelNow=this.getRow(indexAtPixelNow),animate=!this.gridOptionsService.get("suppressAnimationFrame");return rowNodeAtPixelNow===rowNodes[0]?!1:(rowNodes.forEach(rowNode=>{_.removeFromArray(this.rootNode.allLeafChildren,rowNode)}),rowNodes.forEach((rowNode,idx)=>{_.insertIntoArray(this.rootNode.allLeafChildren,rowNode,Math.max(indexAtPixelNow+increment,0)+idx)}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate}),!0)}highlightRowAtPixel(rowNode,pixel){const indexAtPixelNow=pixel!=null?this.getRowIndexAtPixel(pixel):null,rowNodeAtPixelNow=indexAtPixelNow!=null?this.getRow(indexAtPixelNow):null;if(!rowNodeAtPixelNow||!rowNode||rowNodeAtPixelNow===rowNode||pixel==null){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null);return}const highlight=this.getHighlightPosition(pixel,rowNodeAtPixelNow);this.lastHighlightedRow&&this.lastHighlightedRow!==rowNodeAtPixelNow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),rowNodeAtPixelNow.setHighlighted(highlight),this.lastHighlightedRow=rowNodeAtPixelNow}getHighlightPosition(pixel,rowNode){if(!rowNode){const index=this.getRowIndexAtPixel(pixel);if(rowNode=this.getRow(index||0),!rowNode)return 1}const{rowTop,rowHeight}=rowNode;return pixel-rowTop<rowHeight/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const filteredChildren=this.rootNode.childrenAfterAggFilter;return filteredChildren?filteredChildren.length:0}getTopLevelRowDisplayedIndex(topLevelIndex){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return topLevelIndex;let rowNode=this.rootNode.childrenAfterSort[topLevelIndex];if(this.gridOptionsService.get("groupHideOpenParents"))for(;rowNode.expanded&&rowNode.childrenAfterSort&&rowNode.childrenAfterSort.length>0;)rowNode=rowNode.childrenAfterSort[0];return rowNode.rowIndex}getRowBounds(index){if(_.missing(this.rowsToDisplay))return null;const rowNode=this.rowsToDisplay[index];return rowNode?{rowTop:rowNode.rowTop,rowHeight:rowNode.rowHeight}:null}onRowGroupOpened(){const animate=this.gridOptionsService.isAnimateRows();this.refreshModel({step:"map",keepRenderedRows:!0,animate})}onFilterChanged(event){if(event.afterDataChange)return;const animate=this.gridOptionsService.isAnimateRows(),step=event.columns.length===0||event.columns.some(col=>col.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step,keepRenderedRows:!0,animate})}onSortChanged(){const animate=this.gridOptionsService.isAnimateRows();this.refreshModel({step:"sort",keepRenderedRows:!0,animate,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(rowNodeTransactions){const noTransactions=_.missingOrEmpty(rowNodeTransactions),changedPath=new ChangedPath(!1,this.rootNode);return(noTransactions||this.gridOptionsService.get("treeData"))&&changedPath.setInactive(),changedPath}isSuppressModelUpdateAfterUpdateTransaction(params){if(!this.gridOptionsService.get("suppressModelUpdateAfterUpdateTransaction")||params.rowNodeTransactions==null)return!1;const transWithAddsOrDeletes=params.rowNodeTransactions.filter(tx=>tx.add!=null&&tx.add.length>0||tx.remove!=null&&tx.remove.length>0);return transWithAddsOrDeletes==null||transWithAddsOrDeletes.length==0}buildRefreshModelParams(step){let paramsStep="group";const stepsMapped={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(_.exists(step)&&(paramsStep=stepsMapped[step]),_.missing(paramsStep)){console.error(`AG Grid: invalid step ${step}, available steps are ${Object.keys(stepsMapped).join(", ")}`);return}const animate=!this.gridOptionsService.get("suppressAnimationFrame");return{step:paramsStep,keepRenderedRows:!0,keepEditingRows:!0,animate}}refreshModel(paramsOrStep){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.shouldRowModelIgnoreRefresh())return;let params=typeof paramsOrStep=="object"&&"step"in paramsOrStep?paramsOrStep:this.buildRefreshModelParams(paramsOrStep);if(!params||this.isSuppressModelUpdateAfterUpdateTransaction(params))return;const changedPath=this.createChangePath(params.rowNodeTransactions);switch(this.isRefreshingModel=!0,params.step){case"group":this.doRowGrouping(params.rowNodeTransactions,params.rowNodeOrder,changedPath,!!params.afterColumnsChanged);case"filter":this.doFilter(changedPath);case"pivot":this.doPivot(changedPath);case"aggregate":this.doAggregate(changedPath);case"filter_aggregates":this.doFilterAggregates(changedPath);case"sort":this.doSort(params.rowNodeTransactions,changedPath);case"map":this.doRowsToDisplay()}const displayedNodesMapped=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(changedPath,displayedNodesMapped),this.isRefreshingModel=!1;const event={type:Events.EVENT_MODEL_UPDATED,animate:params.animate,keepRenderedRows:params.keepRenderedRows,newData:params.newData,newPage:!1,keepUndoRedoStack:params.keepUndoRedoStack};this.eventService.dispatchEvent(event)}isEmpty(){const rowsMissing=_.missing(this.rootNode.allLeafChildren)||this.rootNode.allLeafChildren.length===0;return _.missing(this.rootNode)||rowsMissing||!this.columnModel.isReady()}isRowsToRender(){return _.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(firstInRange,lastInRange){let started=!lastInRange,finished=!1;const result=[],groupsSelectChildren=this.gridOptionsService.get("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(rowNode=>{if(finished)return;if(started&&(rowNode===lastInRange||rowNode===firstInRange)&&(finished=!0,rowNode.group&&groupsSelectChildren)){result.push(...rowNode.allLeafChildren);return}if(!started){if(rowNode!==lastInRange&&rowNode!==firstInRange)return;started=!0}if(!rowNode.group||!groupsSelectChildren){result.push(rowNode);return}}),result}setDatasource(datasource){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(index){return this.rowsToDisplay[index]}isRowPresent(rowNode){return this.rowsToDisplay.indexOf(rowNode)>=0}getRowIndexAtPixel(pixelToMatch){if(this.isEmpty()||this.rowsToDisplay.length===0)return-1;let bottomPointer=0,topPointer=this.rowsToDisplay.length-1;if(pixelToMatch<=0)return 0;if(_.last(this.rowsToDisplay).rowTop<=pixelToMatch)return this.rowsToDisplay.length-1;let oldBottomPointer=-1,oldTopPointer=-1;for(;;){const midPointer=Math.floor((bottomPointer+topPointer)/2),currentRowNode=this.rowsToDisplay[midPointer];if(this.isRowInPixel(currentRowNode,pixelToMatch)||(currentRowNode.rowTop<pixelToMatch?bottomPointer=midPointer+1:currentRowNode.rowTop>pixelToMatch&&(topPointer=midPointer-1),oldBottomPointer===bottomPointer&&oldTopPointer===topPointer))return midPointer;oldBottomPointer=bottomPointer,oldTopPointer=topPointer}}isRowInPixel(rowNode,pixelToMatch){const topPixel=rowNode.rowTop,bottomPixel=rowNode.rowTop+rowNode.rowHeight;return topPixel<=pixelToMatch&&bottomPixel>pixelToMatch}forEachLeafNode(callback){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((rowNode,index)=>callback(rowNode,index))}forEachNode(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback,recursionType:0,index:0,includeFooterNodes})}forEachNodeAfterFilter(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback,recursionType:1,index:0,includeFooterNodes})}forEachNodeAfterFilterAndSort(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback,recursionType:2,index:0,includeFooterNodes})}forEachPivotNode(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback,recursionType:3,index:0,includeFooterNodes})}recursivelyWalkNodesAndCallback(params){var _a273;const{nodes,callback,recursionType,includeFooterNodes}=params;let{index}=params;for(let i=0;i<nodes.length;i++){const node=nodes[i];if(callback(node,index++),node.hasChildren()&&!node.footer){let nodeChildren=null;switch(recursionType){case 0:nodeChildren=node.childrenAfterGroup;break;case 1:nodeChildren=node.childrenAfterAggFilter;break;case 2:nodeChildren=node.childrenAfterSort;break;case 3:nodeChildren=node.leafGroup?null:node.childrenAfterSort;break}nodeChildren&&(index=this.recursivelyWalkNodesAndCallback({nodes:[...nodeChildren],callback,recursionType,index,includeFooterNodes}))}}const parentNode=(_a273=nodes[0])==null?void 0:_a273.parent;if(!includeFooterNodes||!parentNode)return index;if(parentNode===this.rootNode){if(!this.gridOptionsService.get("groupIncludeTotalFooter"))return index}else if(!this.gridOptionsService.getGroupIncludeFooter()({node:parentNode}))return index;return parentNode.createFooter(),callback(parentNode.sibling,index++),index}doAggregate(changedPath){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath})}doFilterAggregates(changedPath){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(expand){const usingTreeData=this.gridOptionsService.get("treeData"),usingPivotMode=this.columnModel.isPivotActive(),recursiveExpandOrCollapse=__name(rowNodes=>{rowNodes&&rowNodes.forEach(rowNode=>{const actionRow=__name(()=>{rowNode.expanded=expand,recursiveExpandOrCollapse(rowNode.childrenAfterGroup)},"actionRow");if(usingTreeData){_.exists(rowNode.childrenAfterGroup)&&actionRow();return}if(usingPivotMode){!rowNode.leafGroup&&actionRow();return}rowNode.group&&actionRow()})},"recursiveExpandOrCollapse");this.rootNode&&recursiveExpandOrCollapse(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"});const eventSource=expand?"expandAll":"collapseAll",event={type:Events.EVENT_EXPAND_COLLAPSE_ALL,source:eventSource};this.eventService.dispatchEvent(event)}doSort(rowNodeTransactions,changedPath){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions,changedPath})}doRowGrouping(rowNodeTransactions,rowNodeOrder,changedPath,afterColumnsChanged){if(this.groupStage){if(rowNodeTransactions?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions,rowNodeOrder,changedPath}):this.groupStage.execute({rowNode:this.rootNode,changedPath,afterColumnsChanged}),this.gridOptionsService.get("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",changedPath)){const event={type:Events.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(event)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren();this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:Events.EVENT_ROW_COUNT_READY}))}doFilter(changedPath){this.filterStage.execute({rowNode:this.rootNode,changedPath})}doPivot(changedPath){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath})}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(id){if(typeof id=="string"&&id.indexOf(RowNode.ID_PREFIX_ROW_GROUP)==0){let res;return this.forEachNode(node=>{node.id===id&&(res=node)}),res}return this.nodeManager.getRowNode(id)}setRowData(rowData){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(rowData),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){const rowDataUpdatedEvent={type:Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(rowDataUpdatedEvent),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(rowDataTransaction,callback){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const waitMillis=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},waitMillis)}this.rowDataTransactionBatch.push({rowDataTransaction,callback})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const callbackFuncsBound=[],rowNodeTrans=[];let forceRowNodeOrder=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(tranItem=>{const rowNodeTran=this.nodeManager.updateRowData(tranItem.rowDataTransaction,void 0);rowNodeTrans.push(rowNodeTran),tranItem.callback&&callbackFuncsBound.push(tranItem.callback.bind(null,rowNodeTran)),typeof tranItem.rowDataTransaction.addIndex=="number"&&(forceRowNodeOrder=!0)}),this.commonUpdateRowData(rowNodeTrans,void 0,forceRowNodeOrder),callbackFuncsBound.length>0&&window.setTimeout(()=>{callbackFuncsBound.forEach(func=>func())},0),rowNodeTrans.length>0){const event={type:Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:rowNodeTrans};this.eventService.dispatchEvent(event)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(rowDataTran,rowNodeOrder){this.valueCache.onDataChanged();const rowNodeTran=this.nodeManager.updateRowData(rowDataTran,rowNodeOrder),forceRowNodeOrder=typeof rowDataTran.addIndex=="number";return this.commonUpdateRowData([rowNodeTran],rowNodeOrder,forceRowNodeOrder),rowNodeTran}createRowNodeOrder(){if(this.gridOptionsService.get("suppressMaintainUnsortedOrder"))return;const orderMap={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let index=0;index<this.rootNode.allLeafChildren.length;index++){const node=this.rootNode.allLeafChildren[index];orderMap[node.id]=index}return orderMap}commonUpdateRowData(rowNodeTrans,rowNodeOrder,forceRowNodeOrder){if(!this.hasStarted)return;const animate=!this.gridOptionsService.get("suppressAnimationFrame");forceRowNodeOrder&&(rowNodeOrder=this.createRowNodeOrder());const event={type:Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(event),this.refreshModel({step:"group",rowNodeTransactions:rowNodeTrans,rowNodeOrder,keepRenderedRows:!0,keepEditingRows:!0,animate})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const atLeastOne=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),atLeastOne&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let atLeastOne=!1;return this.forEachNode(rowNode=>{rowNode.setRowHeight(rowNode.rowHeight,!0);const detailNode=rowNode.detailNode;detailNode&&detailNode.setRowHeight(detailNode.rowHeight,!0),rowNode.sibling&&rowNode.sibling.setRowHeight(rowNode.sibling.rowHeight,!0),atLeastOne=!0}),atLeastOne}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}},__name(_a257,"ClientSideRowModel"),_a257);__decorateClass([Autowired("columnModel")],ClientSideRowModel.prototype,"columnModel",2);__decorateClass([Autowired("selectionService")],ClientSideRowModel.prototype,"selectionService",2);__decorateClass([Autowired("filterManager")],ClientSideRowModel.prototype,"filterManager",2);__decorateClass([Autowired("valueCache")],ClientSideRowModel.prototype,"valueCache",2);__decorateClass([Autowired("beans")],ClientSideRowModel.prototype,"beans",2);__decorateClass([Autowired("filterStage")],ClientSideRowModel.prototype,"filterStage",2);__decorateClass([Autowired("sortStage")],ClientSideRowModel.prototype,"sortStage",2);__decorateClass([Autowired("flattenStage")],ClientSideRowModel.prototype,"flattenStage",2);__decorateClass([Optional("groupStage")],ClientSideRowModel.prototype,"groupStage",2);__decorateClass([Optional("aggregationStage")],ClientSideRowModel.prototype,"aggregationStage",2);__decorateClass([Optional("pivotStage")],ClientSideRowModel.prototype,"pivotStage",2);__decorateClass([Optional("filterAggregatesStage")],ClientSideRowModel.prototype,"filterAggregatesStage",2);__decorateClass([PostConstruct],ClientSideRowModel.prototype,"init",1);ClientSideRowModel=__decorateClass([Bean("rowModel")],ClientSideRowModel);var _a258,FilterStage=(_a258=class extends BeanStub{execute(params){const{changedPath}=params;this.filterService.filter(changedPath)}},__name(_a258,"FilterStage"),_a258);__decorateClass([Autowired("filterService")],FilterStage.prototype,"filterService",2);FilterStage=__decorateClass([Bean("filterStage")],FilterStage);var _a259,SortStage=(_a259=class extends BeanStub{execute(params){const sortOptions=this.sortController.getSortOptions(),sortActive=_.exists(sortOptions)&&sortOptions.length>0,deltaSort=sortActive&&_.exists(params.rowNodeTransactions)&&this.gridOptionsService.get("deltaSort"),sortContainsGroupColumns=sortOptions.some(opt=>this.gridOptionsService.isColumnsSortingCoupledToGroup()?opt.column.isPrimary()&&opt.column.isRowGroupActive():!!opt.column.getColDef().showRowGroup);this.sortService.sort(sortOptions,sortActive,deltaSort,params.rowNodeTransactions,params.changedPath,sortContainsGroupColumns)}},__name(_a259,"SortStage"),_a259);__decorateClass([Autowired("sortService")],SortStage.prototype,"sortService",2);__decorateClass([Autowired("sortController")],SortStage.prototype,"sortController",2);SortStage=__decorateClass([Bean("sortStage")],SortStage);var _a260,FlattenStage=(_a260=class extends BeanStub{execute(params){const rootNode=params.rowNode,result=[],skipLeafNodes=this.columnModel.isPivotMode(),showRootNode=skipLeafNodes&&rootNode.leafGroup,topList=showRootNode?[rootNode]:rootNode.childrenAfterSort,details=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(details,topList,result,skipLeafNodes,0);const atLeastOneRowPresent=result.length>0;return!showRootNode&&atLeastOneRowPresent&&details.groupIncludeTotalFooter&&(rootNode.createFooter(),this.addRowNodeToRowsToDisplay(details,rootNode.sibling,result,0)),result}getFlattenDetails(){const groupRemoveSingleChildren=this.gridOptionsService.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!groupRemoveSingleChildren&&this.gridOptionsService.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren,isGroupMultiAutoColumn:this.gridOptionsService.isGroupMultiAutoColumn(),hideOpenParents:this.gridOptionsService.get("groupHideOpenParents"),groupIncludeTotalFooter:this.gridOptionsService.get("groupIncludeTotalFooter"),getGroupIncludeFooter:this.gridOptionsService.getGroupIncludeFooter()}}recursivelyAddToRowsToDisplay(details,rowsToFlatten,result,skipLeafNodes,uiLevel){if(!_.missingOrEmpty(rowsToFlatten))for(let i=0;i<rowsToFlatten.length;i++){const rowNode=rowsToFlatten[i],isParent=rowNode.hasChildren(),isSkippedLeafNode=skipLeafNodes&&!isParent,isRemovedSingleChildrenGroup=details.groupRemoveSingleChildren&&isParent&&rowNode.childrenAfterGroup.length===1,isRemovedLowestSingleChildrenGroup=details.groupRemoveLowestSingleChildren&&isParent&&rowNode.leafGroup&&rowNode.childrenAfterGroup.length===1,neverAllowToExpand=skipLeafNodes&&rowNode.leafGroup,isHiddenOpenParent=details.hideOpenParents&&rowNode.expanded&&!rowNode.master&&!neverAllowToExpand;if(!isSkippedLeafNode&&!isHiddenOpenParent&&!isRemovedSingleChildrenGroup&&!isRemovedLowestSingleChildrenGroup&&this.addRowNodeToRowsToDisplay(details,rowNode,result,uiLevel),!(skipLeafNodes&&rowNode.leafGroup)){if(isParent){const excludedParent=isRemovedSingleChildrenGroup||isRemovedLowestSingleChildrenGroup;if(rowNode.expanded||excludedParent){const uiLevelForChildren=excludedParent?uiLevel:uiLevel+1;this.recursivelyAddToRowsToDisplay(details,rowNode.childrenAfterSort,result,skipLeafNodes,uiLevelForChildren),details.getGroupIncludeFooter({node:rowNode})?(rowNode.createFooter(),this.addRowNodeToRowsToDisplay(details,rowNode.sibling,result,uiLevelForChildren)):rowNode.destroyFooter()}}else if(rowNode.master&&rowNode.expanded){const detailNode=this.createDetailNode(rowNode);this.addRowNodeToRowsToDisplay(details,detailNode,result,uiLevel)}}}}addRowNodeToRowsToDisplay(details,rowNode,result,uiLevel){result.push(rowNode),rowNode.setUiLevel(details.isGroupMultiAutoColumn?0:uiLevel)}createDetailNode(masterNode){if(_.exists(masterNode.detailNode))return masterNode.detailNode;const detailNode=new RowNode(this.beans);return detailNode.detail=!0,detailNode.selectable=!1,detailNode.parent=masterNode,_.exists(masterNode.id)&&(detailNode.id="detail_"+masterNode.id),detailNode.data=masterNode.data,detailNode.level=masterNode.level+1,masterNode.detailNode=detailNode,detailNode}},__name(_a260,"FlattenStage"),_a260);__decorateClass([Autowired("columnModel")],FlattenStage.prototype,"columnModel",2);__decorateClass([Autowired("beans")],FlattenStage.prototype,"beans",2);FlattenStage=__decorateClass([Bean("flattenStage")],FlattenStage);var _a261,SortService=(_a261=class extends BeanStub{sort(sortOptions,sortActive,useDeltaSort,rowNodeTransactions,changedPath,sortContainsGroupColumns){const groupMaintainOrder=this.gridOptionsService.get("groupMaintainOrder"),groupColumnsPresent=this.columnModel.getAllGridColumns().some(c=>c.isRowGroupActive());let allDirtyNodes={};useDeltaSort&&rowNodeTransactions&&(allDirtyNodes=this.calculateDirtyNodes(rowNodeTransactions));const isPivotMode=this.columnModel.isPivotMode(),postSortFunc=this.gridOptionsService.getCallback("postSortRows"),callback=__name(rowNode=>{var _a273;this.pullDownGroupDataForHideOpenParents(rowNode.childrenAfterAggFilter,!0);const skipSortingPivotLeafs=isPivotMode&&rowNode.leafGroup;if(groupMaintainOrder&&groupColumnsPresent&&!rowNode.leafGroup&&!sortContainsGroupColumns){const nextGroup=(_a273=this.columnModel.getRowGroupColumns())==null?void 0:_a273[rowNode.level+1],wasSortExplicitlyRemoved=(nextGroup==null?void 0:nextGroup.getSort())===null,childrenToBeSorted=rowNode.childrenAfterAggFilter.slice(0);if(rowNode.childrenAfterSort&&!wasSortExplicitlyRemoved){const indexedOrders={};rowNode.childrenAfterSort.forEach((node,idx)=>{indexedOrders[node.id]=idx}),childrenToBeSorted.sort((row1,row2)=>{var _a274,_b;return((_a274=indexedOrders[row1.id])!=null?_a274:0)-((_b=indexedOrders[row2.id])!=null?_b:0)})}rowNode.childrenAfterSort=childrenToBeSorted}else!sortActive||skipSortingPivotLeafs?rowNode.childrenAfterSort=rowNode.childrenAfterAggFilter.slice(0):useDeltaSort?rowNode.childrenAfterSort=this.doDeltaSort(rowNode,allDirtyNodes,changedPath,sortOptions):rowNode.childrenAfterSort=this.rowNodeSorter.doFullSort(rowNode.childrenAfterAggFilter,sortOptions);if(rowNode.sibling&&(rowNode.sibling.childrenAfterSort=rowNode.childrenAfterSort),this.updateChildIndexes(rowNode),postSortFunc){const params={nodes:rowNode.childrenAfterSort};postSortFunc(params)}},"callback");changedPath&&changedPath.forEachChangedNodeDepthFirst(callback),this.updateGroupDataForHideOpenParents(changedPath)}calculateDirtyNodes(rowNodeTransactions){const dirtyNodes={},addNodesFunc=__name(rowNodes=>{rowNodes&&rowNodes.forEach(rowNode=>dirtyNodes[rowNode.id]=!0)},"addNodesFunc");return rowNodeTransactions&&rowNodeTransactions.forEach(tran=>{addNodesFunc(tran.add),addNodesFunc(tran.update),addNodesFunc(tran.remove)}),dirtyNodes}doDeltaSort(rowNode,allTouchedNodes,changedPath,sortOptions){const unsortedRows=rowNode.childrenAfterAggFilter,oldSortedRows=rowNode.childrenAfterSort;if(!oldSortedRows)return this.rowNodeSorter.doFullSort(unsortedRows,sortOptions);const untouchedRowsMap={},touchedRows=[];unsortedRows.forEach(row=>{allTouchedNodes[row.id]||!changedPath.canSkip(row)?touchedRows.push(row):untouchedRowsMap[row.id]=!0});const sortedUntouchedRows=oldSortedRows.filter(child=>untouchedRowsMap[child.id]),mapNodeToSortedNode=__name((rowNode2,pos)=>({currentPos:pos,rowNode:rowNode2}),"mapNodeToSortedNode"),sortedChangedRows=touchedRows.map(mapNodeToSortedNode).sort((a,b)=>this.rowNodeSorter.compareRowNodes(sortOptions,a,b));return this.mergeSortedArrays(sortOptions,sortedChangedRows,sortedUntouchedRows.map(mapNodeToSortedNode)).map(({rowNode:rowNode2})=>rowNode2)}mergeSortedArrays(sortOptions,arr1,arr2){const res=[];let i=0,j=0;for(;i<arr1.length&&j<arr2.length;)this.rowNodeSorter.compareRowNodes(sortOptions,arr1[i],arr2[j])<0?res.push(arr1[i++]):res.push(arr2[j++]);for(;i<arr1.length;)res.push(arr1[i++]);for(;j<arr2.length;)res.push(arr2[j++]);return res}updateChildIndexes(rowNode){if(_.missing(rowNode.childrenAfterSort))return;const listToSort=rowNode.childrenAfterSort;for(let i=0;i<listToSort.length;i++){const child=listToSort[i],firstChild=i===0,lastChild=i===rowNode.childrenAfterSort.length-1;child.setFirstChild(firstChild),child.setLastChild(lastChild),child.setChildIndex(i)}}updateGroupDataForHideOpenParents(changedPath){if(!this.gridOptionsService.get("groupHideOpenParents"))return;if(this.gridOptionsService.get("treeData"))return _.warnOnce("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const callback=__name(rowNode=>{this.pullDownGroupDataForHideOpenParents(rowNode.childrenAfterSort,!1),rowNode.childrenAfterSort.forEach(child=>{child.hasChildren()&&callback(child)})},"callback");changedPath&&changedPath.executeFromRootNode(rowNode=>callback(rowNode))}pullDownGroupDataForHideOpenParents(rowNodes,clearOperation){!this.gridOptionsService.get("groupHideOpenParents")||_.missing(rowNodes)||rowNodes.forEach(childRowNode=>{this.columnModel.getGroupDisplayColumns().forEach(groupDisplayCol=>{const showRowGroup=groupDisplayCol.getColDef().showRowGroup;if(typeof showRowGroup!="string"){console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");return}const displayingGroupKey=showRowGroup,rowGroupColumn=this.columnModel.getPrimaryColumn(displayingGroupKey);if(rowGroupColumn!==childRowNode.rowGroupColumn)if(clearOperation)childRowNode.setGroupValue(groupDisplayCol.getId(),void 0);else{const parentToStealFrom=childRowNode.getFirstChildOfFirstChild(rowGroupColumn);parentToStealFrom&&childRowNode.setGroupValue(groupDisplayCol.getId(),parentToStealFrom.key)}})})}},__name(_a261,"SortService"),_a261);__decorateClass([Autowired("columnModel")],SortService.prototype,"columnModel",2);__decorateClass([Autowired("rowNodeSorter")],SortService.prototype,"rowNodeSorter",2);SortService=__decorateClass([Bean("sortService")],SortService);var _a262,FilterService=(_a262=class extends BeanStub{filter(changedPath){const filterActive=this.filterManager.isChildFilterPresent();this.filterNodes(filterActive,changedPath)}filterNodes(filterActive,changedPath){const filterCallback=__name((rowNode,includeChildNodes)=>{rowNode.hasChildren()&&filterActive&&!includeChildNodes?rowNode.childrenAfterFilter=rowNode.childrenAfterGroup.filter(childNode=>{const passBecauseChildren=childNode.childrenAfterFilter&&childNode.childrenAfterFilter.length>0,passBecauseDataPasses=childNode.data&&this.filterManager.doesRowPassFilter({rowNode:childNode});return passBecauseChildren||passBecauseDataPasses}):rowNode.childrenAfterFilter=rowNode.childrenAfterGroup,rowNode.sibling&&(rowNode.sibling.childrenAfterFilter=rowNode.childrenAfterFilter)},"filterCallback");if(this.doingTreeDataFiltering()){const treeDataDepthFirstFilter=__name((rowNode,alreadyFoundInParent)=>{if(rowNode.childrenAfterGroup)for(let i=0;i<rowNode.childrenAfterGroup.length;i++){const childNode=rowNode.childrenAfterGroup[i],foundInParent=alreadyFoundInParent||this.filterManager.doesRowPassFilter({rowNode:childNode});childNode.childrenAfterGroup?treeDataDepthFirstFilter(rowNode.childrenAfterGroup[i],foundInParent):filterCallback(childNode,foundInParent)}filterCallback(rowNode,alreadyFoundInParent)},"treeDataDepthFirstFilter"),treeDataFilterCallback=__name(rowNode=>treeDataDepthFirstFilter(rowNode,!1),"treeDataFilterCallback");changedPath.executeFromRootNode(treeDataFilterCallback)}else{const defaultFilterCallback=__name(rowNode=>filterCallback(rowNode,!1),"defaultFilterCallback");changedPath.forEachChangedNodeDepthFirst(defaultFilterCallback,!0)}}doingTreeDataFiltering(){return this.gridOptionsService.get("treeData")&&!this.gridOptionsService.get("excludeChildrenWhenTreeDataFiltering")}},__name(_a262,"FilterService"),_a262);__decorateClass([Autowired("filterManager")],FilterService.prototype,"filterManager",2);FilterService=__decorateClass([Bean("filterService")],FilterService);var _a263,ImmutableService=(_a263=class extends BeanStub{postConstruct(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const getRowIdProvided=this.gridOptionsService.exists("getRowId");return this.gridOptionsService.get("resetRowDataOnUpdate")?!1:getRowIdProvided}setRowData(rowData){const transactionAndMap=this.createTransactionForRowData(rowData);if(!transactionAndMap)return;const[transaction,orderIdMap]=transactionAndMap;this.clientSideRowModel.updateRowData(transaction,orderIdMap)}createTransactionForRowData(rowData){if(_.missing(this.clientSideRowModel)){console.error("AG Grid: ImmutableService only works with ClientSideRowModel");return}const getRowIdFunc=this.gridOptionsService.getCallback("getRowId");if(getRowIdFunc==null){console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");return}const transaction={remove:[],update:[],add:[]},existingNodesMap=this.clientSideRowModel.getCopyOfNodesMap(),orderMap=this.gridOptionsService.get("suppressMaintainUnsortedOrder")?void 0:{};return _.exists(rowData)&&rowData.forEach((data,index)=>{const id=getRowIdFunc({data,level:0}),existingNode=existingNodesMap[id];orderMap&&(orderMap[id]=index),existingNode?(existingNode.data!==data&&transaction.update.push(data),existingNodesMap[id]=void 0):transaction.add.push(data)}),_.iterateObject(existingNodesMap,(id,rowNode)=>{rowNode&&transaction.remove.push(rowNode.data)}),[transaction,orderMap]}onRowDataUpdated(){const rowData=this.gridOptionsService.get("rowData");rowData&&(this.isActive()?this.setRowData(rowData):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(rowData)))}},__name(_a263,"ImmutableService"),_a263);__decorateClass([Autowired("rowModel")],ImmutableService.prototype,"rowModel",2);__decorateClass([Autowired("rowRenderer")],ImmutableService.prototype,"rowRenderer",2);__decorateClass([Autowired("selectionService")],ImmutableService.prototype,"selectionService",2);__decorateClass([PostConstruct],ImmutableService.prototype,"postConstruct",1);ImmutableService=__decorateClass([Bean("immutableService")],ImmutableService);var VERSION="31.2.0",ClientSideRowModelModule={version:VERSION,moduleName:"@ag-grid-community/client-side-row-model",rowModel:"clientSide",beans:[ClientSideRowModel,FilterStage,SortStage,FlattenStage,SortService,FilterService,ImmutableService]},__defProp22=Object.defineProperty,__getOwnPropDesc2=Object.getOwnPropertyDescriptor,__decorateClass2=__name((decorators,target,key,kind)=>{for(var result=kind>1?void 0:kind?__getOwnPropDesc2(target,key):target,i=decorators.length-1,decorator;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp22(target,key,result),result},"__decorateClass2"),__decorateParam2=__name((index,decorator)=>(target,key)=>decorator(target,key,index),"__decorateParam2"),_a264,InfiniteBlock=(_a264=class extends RowNodeBlock{constructor(id,parentCache,params){super(id),this.parentCache=parentCache,this.params=params,this.startRow=id*params.blockSize,this.endRow=this.startRow+params.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(rowNode,data,index){_.exists(data)?rowNode.setDataAndId(data,index.toString()):rowNode.setDataAndId(void 0,void 0)}loadFromDatasource(){const params=this.createLoadParams();if(_.missing(this.params.datasource.getRows)){console.warn("AG Grid: datasource is missing getRows method");return}window.setTimeout(()=>{this.params.datasource.getRows(params)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.getGridCommonParams().context}}forEachNode(callback,sequence,rowCount){this.rowNodes.forEach((rowNode,index)=>{this.startRow+index<rowCount&&callback(rowNode,sequence.next())})}getLastAccessed(){return this.lastAccessed}getRow(rowIndex,dontTouchLastAccessed=!1){dontTouchLastAccessed||(this.lastAccessed=this.params.lastAccessedSequence.next());const localIndex=rowIndex-this.startRow;return this.rowNodes[localIndex]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let i=0;i<this.params.blockSize;i++){const rowIndex=this.startRow+i,rowNode=new RowNode(this.beans);rowNode.setRowHeight(this.params.rowHeight),rowNode.uiLevel=0,rowNode.setRowIndex(rowIndex),rowNode.setRowTop(this.params.rowHeight*rowIndex),this.rowNodes.push(rowNode)}}processServerResult(params){this.rowNodes.forEach((rowNode,index)=>{const data=params.rowData?params.rowData[index]:void 0;!rowNode.id&&rowNode.alreadyRendered&&data&&(this.rowNodes[index]=new RowNode(this.beans),this.rowNodes[index].setRowIndex(rowNode.rowIndex),this.rowNodes[index].setRowTop(rowNode.rowTop),this.rowNodes[index].setRowHeight(rowNode.rowHeight),rowNode.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[index],data,this.startRow+index)});const finalRowCount=params.rowCount!=null&&params.rowCount>=0?params.rowCount:void 0;this.parentCache.pageLoaded(this,finalRowCount)}destroyRowNodes(){this.rowNodes.forEach(rowNode=>{rowNode.clearRowTopAndRowIndex()})}},__name(_a264,"InfiniteBlock"),_a264);__decorateClass2([Autowired("beans")],InfiniteBlock.prototype,"beans",2);__decorateClass2([PostConstruct],InfiniteBlock.prototype,"postConstruct",1);__decorateClass2([PreDestroy],InfiniteBlock.prototype,"destroyRowNodes",1);var _a265,_InfiniteCache=(_a265=class extends BeanStub{constructor(params){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=params.initialRowCount,this.params=params}setBeans(loggerFactory){this.logger=loggerFactory.create("InfiniteCache")}getRow(rowIndex,dontCreatePage=!1){const blockId=Math.floor(rowIndex/this.params.blockSize);let block=this.blocks[blockId];if(!block){if(dontCreatePage)return;block=this.createBlock(blockId)}return block.getRow(rowIndex)}createBlock(blockNumber){const newBlock=this.createBean(new InfiniteBlock(blockNumber,this,this.params));return this.blocks[newBlock.getId()]=newBlock,this.blockCount++,this.purgeBlocksIfNeeded(newBlock),this.params.rowNodeBlockLoader.addBlock(newBlock),newBlock}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(block=>block.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroyAllBlocks(){this.getBlocksInOrder().forEach(block=>this.destroyBlock(block))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(block,lastRow){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${block.getId()}, lastRow = ${lastRow}`),this.checkRowCount(block,lastRow),this.onCacheUpdated())}purgeBlocksIfNeeded(blockToExclude){const blocksForPurging=this.getBlocksInOrder().filter(b=>b!=blockToExclude),lastAccessedComparator=__name((a,b)=>b.getLastAccessed()-a.getLastAccessed(),"lastAccessedComparator");blocksForPurging.sort(lastAccessedComparator);const maxBlocksProvided=this.params.maxBlocksInCache>0,blocksToKeep=maxBlocksProvided?this.params.maxBlocksInCache-1:null,emptyBlocksToKeep=_a265.MAX_EMPTY_BLOCKS_TO_KEEP-1;blocksForPurging.forEach((block,index)=>{const purgeBecauseBlockEmpty=block.getState()===InfiniteBlock.STATE_WAITING_TO_LOAD&&index>=emptyBlocksToKeep,purgeBecauseCacheFull=maxBlocksProvided?index>=blocksToKeep:!1;if(purgeBecauseBlockEmpty||purgeBecauseCacheFull){if(this.isBlockCurrentlyDisplayed(block)||this.isBlockFocused(block))return;this.removeBlockFromCache(block)}})}isBlockFocused(block){const focusedCell=this.focusService.getFocusCellToUseAfterRefresh();if(!focusedCell||focusedCell.rowPinned!=null)return!1;const blockIndexStart=block.getStartRow(),blockIndexEnd=block.getEndRow();return focusedCell.rowIndex>=blockIndexStart&&focusedCell.rowIndex<blockIndexEnd}isBlockCurrentlyDisplayed(block){const startIndex=block.getStartRow(),endIndex=block.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(startIndex,endIndex)}removeBlockFromCache(blockToRemove){blockToRemove&&this.destroyBlock(blockToRemove)}checkRowCount(block,lastRow){if(typeof lastRow=="number"&&lastRow>=0)this.rowCount=lastRow,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const lastRowIndexPlusOverflow=(block.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<lastRowIndexPlusOverflow&&(this.rowCount=lastRowIndexPlusOverflow)}}setRowCount(rowCount,lastRowIndexKnown){this.rowCount=rowCount,_.exists(lastRowIndexKnown)&&(this.lastRowIndexKnown=lastRowIndexKnown),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(callback){const sequence=new NumberSequence;this.getBlocksInOrder().forEach(block=>block.forEachNode(callback,sequence,this.rowCount))}getBlocksInOrder(){const blockComparator=__name((a,b)=>a.getId()-b.getId(),"blockComparator");return _.getAllValuesInObject(this.blocks).sort(blockComparator)}destroyBlock(block){delete this.blocks[block.getId()],this.destroyBean(block),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(block)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const event={type:Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(event)}}destroyAllBlocksPastVirtualRowCount(){const blocksToDestroy=[];this.getBlocksInOrder().forEach(block=>{block.getId()*this.params.blockSize>=this.rowCount&&blocksToDestroy.push(block)}),blocksToDestroy.length>0&&blocksToDestroy.forEach(block=>this.destroyBlock(block))}purgeCache(){this.getBlocksInOrder().forEach(block=>this.removeBlockFromCache(block)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(firstInRange,lastInRange){const result=[];let lastBlockId=-1,inActiveRange=!1;const numberSequence=new NumberSequence;_.missing(firstInRange)&&(inActiveRange=!0);let foundGapInSelection=!1;return this.getBlocksInOrder().forEach(block=>{if(!foundGapInSelection){if(inActiveRange&&lastBlockId+1!==block.getId()){foundGapInSelection=!0;return}lastBlockId=block.getId(),block.forEachNode(rowNode=>{const hitFirstOrLast=rowNode===firstInRange||rowNode===lastInRange;(inActiveRange||hitFirstOrLast)&&result.push(rowNode),hitFirstOrLast&&(inActiveRange=!inActiveRange)},numberSequence,this.rowCount)}}),foundGapInSelection||inActiveRange?[]:result}},__name(_a265,"_InfiniteCache2"),_a265);_InfiniteCache.MAX_EMPTY_BLOCKS_TO_KEEP=2;__decorateClass2([Autowired("rowRenderer")],_InfiniteCache.prototype,"rowRenderer",2);__decorateClass2([Autowired("focusService")],_InfiniteCache.prototype,"focusService",2);__decorateClass2([__decorateParam2(0,Qualifier("loggerFactory"))],_InfiniteCache.prototype,"setBeans",1);__decorateClass2([PreDestroy],_InfiniteCache.prototype,"destroyAllBlocks",1);var InfiniteCache=_InfiniteCache,_a266,InfiniteRowModel=(_a266=class extends BeanStub{getRowBounds(index){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*index}}ensureRowHeightsValid(startPixel,endPixel,startLimitIndex,endLimitIndex){return!1}init(){this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gridOptionsService.exists("initialGroupOrderComparator")&&_.warnOnce("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gridOptionsService.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this)),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gridOptionsService.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let resetRequired;this.cacheParams?resetRequired=this.isSortModelDifferent():resetRequired=!0,resetRequired&&this.reset()}isSortModelDifferent(){return!_.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(datasource){this.destroyDatasource(),this.datasource=datasource,datasource&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(firstInRange,lastInRange){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(firstInRange,lastInRange):[]}reset(){if(!this.datasource)return;this.gridOptionsService.getCallback("getRowId")!=null||this.selectionService.reset("rowDataChanged"),this.resetCache()}createModelUpdatedEvent(){return{type:Events.EVENT_MODEL_UPDATED,newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gridOptionsService.get("infiniteInitialRowCount"),maxBlocksInCache:this.gridOptionsService.get("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.gridOptionsService.get("cacheOverflowSize"),blockSize:this.gridOptionsService.get("cacheBlockSize"),lastAccessedSequence:new NumberSequence},this.infiniteCache=this.createBean(new InfiniteCache(this.cacheParams)),this.eventService.dispatchEventOnce({type:Events.EVENT_ROW_COUNT_READY});const event=this.createModelUpdatedEvent();this.eventService.dispatchEvent(event)}updateRowHeights(){this.forEachNode(node=>{node.setRowHeight(this.rowHeight),node.setRowTop(this.rowHeight*node.rowIndex)});const event=this.createModelUpdatedEvent();this.eventService.dispatchEvent(event)}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const event=this.createModelUpdatedEvent();this.eventService.dispatchEvent(event)}getRow(rowIndex){if(this.infiniteCache&&!(rowIndex>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(rowIndex)}getRowNode(id){let result;return this.forEachNode(rowNode=>{rowNode.id===id&&(result=rowNode)}),result}forEachNode(callback){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(callback)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(topLevelIndex){return topLevelIndex}getRowIndexAtPixel(pixel){if(this.rowHeight!==0){const rowIndexForPixel=Math.floor(pixel/this.rowHeight),lastRowIndex=this.getRowCount()-1;return rowIndexForPixel>lastRowIndex?lastRowIndex:rowIndexForPixel}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(rowNode){return!!this.getRowNode(rowNode.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?this.infiniteCache.isLastRowIndexKnown():!1}setRowCount(rowCount,lastRowIndexKnown){this.infiniteCache&&this.infiniteCache.setRowCount(rowCount,lastRowIndexKnown)}},__name(_a266,"InfiniteRowModel"),_a266);__decorateClass2([Autowired("filterManager")],InfiniteRowModel.prototype,"filterManager",2);__decorateClass2([Autowired("sortController")],InfiniteRowModel.prototype,"sortController",2);__decorateClass2([Autowired("selectionService")],InfiniteRowModel.prototype,"selectionService",2);__decorateClass2([Autowired("rowRenderer")],InfiniteRowModel.prototype,"rowRenderer",2);__decorateClass2([Autowired("rowNodeBlockLoader")],InfiniteRowModel.prototype,"rowNodeBlockLoader",2);__decorateClass2([PostConstruct],InfiniteRowModel.prototype,"init",1);__decorateClass2([PreDestroy],InfiniteRowModel.prototype,"destroyDatasource",1);InfiniteRowModel=__decorateClass2([Bean("rowModel")],InfiniteRowModel);var VERSION2="31.2.0",InfiniteRowModelModule={version:VERSION2,moduleName:"@ag-grid-community/infinite-row-model",rowModel:"infinite",beans:[InfiniteRowModel]},__defProp3=Object.defineProperty,__getOwnPropDesc3=Object.getOwnPropertyDescriptor,__decorateClass3=__name((decorators,target,key,kind)=>{for(var result=kind>1?void 0:kind?__getOwnPropDesc3(target,key):target,i=decorators.length-1,decorator;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp3(target,key,result),result},"__decorateClass3"),_a267,BaseCreator=(_a267=class{setBeans(beans){this.beans=beans}getFileName(fileName){const extension=this.getDefaultFileExtension();return(fileName==null||!fileName.length)&&(fileName=this.getDefaultFileName()),fileName.indexOf(".")===-1?`${fileName}.${extension}`:fileName}getData(params){const serializingSession=this.createSerializingSession(params);return this.beans.gridSerializer.serialize(serializingSession,params)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},__name(_a267,"BaseCreator"),_a267),_a268,BaseGridSerializingSession=(_a268=class{constructor(config){this.groupColumns=[];const{columnModel,valueService,gridOptionsService,valueFormatterService,valueParserService,processCellCallback,processHeaderCallback,processGroupHeaderCallback,processRowGroupCallback}=config;this.columnModel=columnModel,this.valueService=valueService,this.gridOptionsService=gridOptionsService,this.valueFormatterService=valueFormatterService,this.valueParserService=valueParserService,this.processCellCallback=processCellCallback,this.processHeaderCallback=processHeaderCallback,this.processGroupHeaderCallback=processGroupHeaderCallback,this.processRowGroupCallback=processRowGroupCallback}prepare(columnsToExport){this.groupColumns=columnsToExport.filter(col=>!!col.getColDef().showRowGroup)}extractHeaderValue(column){const value=this.getHeaderName(this.processHeaderCallback,column);return value??""}extractRowCellValue(column,index,accumulatedRowIndex,type,node){const value=(!this.gridOptionsService.get("groupHideOpenParents")||node.footer)&&this.shouldRenderGroupSummaryCell(node,column,index)?this.createValueForGroupNode(column,node):this.valueService.getValue(column,node);return this.processCell({accumulatedRowIndex,rowNode:node,column,value,processCellCallback:this.processCellCallback,type})}shouldRenderGroupSummaryCell(node,column,currentColumnIndex){var _a273;if(!(node&&node.group))return!1;if(this.groupColumns.indexOf(column)!==-1){if(((_a273=node.groupData)==null?void 0:_a273[column.getId()])!=null||this.gridOptionsService.isRowModelType("serverSide")&&node.group)return!0;if(node.footer&&node.level===-1){const colDef=column.getColDef();return colDef==null||colDef.showRowGroup===!0||colDef.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const isGroupUseEntireRow=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return currentColumnIndex===0&&isGroupUseEntireRow}getHeaderName(callback,column){return callback?callback(this.gridOptionsService.addGridCommonParams({column})):this.columnModel.getDisplayNameForColumn(column,"csv",!0)}createValueForGroupNode(column,node){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gridOptionsService.addGridCommonParams({column,node}));const isTreeData=this.gridOptionsService.get("treeData"),isSuppressGroupMaintainValueType=this.gridOptionsService.get("suppressGroupMaintainValueType"),getValueFromNode=__name(node2=>{var _a273,_b;if(isTreeData||isSuppressGroupMaintainValueType)return node2.key;const value=(_a273=node2.groupData)==null?void 0:_a273[column.getId()];return!value||!node2.rowGroupColumn||node2.rowGroupColumn.getColDef().useValueFormatterForExport===!1?value:(_b=this.valueFormatterService.formatValue(node2.rowGroupColumn,node2,value))!=null?_b:value},"getValueFromNode"),isFooter=node.footer,keys2=[getValueFromNode(node)];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;node.parent;)node=node.parent,keys2.push(getValueFromNode(node));const groupValue=keys2.reverse().join(" -> ");return isFooter?`Total ${groupValue}`:groupValue}processCell(params){var _a273;const{accumulatedRowIndex,rowNode,column,value,processCellCallback,type}=params;return processCellCallback?{value:(_a273=processCellCallback(this.gridOptionsService.addGridCommonParams({accumulatedRowIndex,column,node:rowNode,value,type,parseValue:valueToParse=>this.valueParserService.parseValue(column,rowNode,valueToParse,this.valueService.getValue(column,rowNode)),formatValue:valueToFormat=>{var _a274;return(_a274=this.valueFormatterService.formatValue(column,rowNode,valueToFormat))!=null?_a274:valueToFormat}})))!=null?_a273:""}:column.getColDef().useValueFormatterForExport!==!1?{value:value??"",valueFormatted:this.valueFormatterService.formatValue(column,rowNode,value)}:{value:value??""}}},__name(_a268,"BaseGridSerializingSession"),_a268),_a269,Downloader=(_a269=class{static download(fileName,content){const win=document.defaultView||window;if(!win){console.warn("AG Grid: There is no `window` associated with the current `document`");return}const element=document.createElement("a"),url=win.URL.createObjectURL(content);element.setAttribute("href",url),element.setAttribute("download",fileName),element.style.display="none",document.body.appendChild(element),element.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:win})),document.body.removeChild(element),win.setTimeout(()=>{win.URL.revokeObjectURL(url)},0)}},__name(_a269,"Downloader"),_a269),LINE_SEPARATOR=`\r
`,_a270,CsvSerializingSession=(_a270=class extends BaseGridSerializingSession{constructor(config){super(config),this.isFirstLine=!0,this.result="";const{suppressQuotes,columnSeparator}=config;this.suppressQuotes=suppressQuotes,this.columnSeparator=columnSeparator}addCustomContent(content){content&&(typeof content=="string"?(/^\s*\n/.test(content)||this.beginNewLine(),content=content.replace(/\r?\n/g,LINE_SEPARATOR),this.result+=content):content.forEach(row=>{this.beginNewLine(),row.forEach((cell,index)=>{index!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(cell.data.value||""),cell.mergeAcross&&this.appendEmptyCells(cell.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(columnGroup,header,index,span){index!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(header),this.appendEmptyCells(span)}appendEmptyCells(count){for(let i=1;i<=count;i++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(column,index){index!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(column))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(column,index,node){var _a273;index!=0&&(this.result+=this.columnSeparator);const rowCellValue=this.extractRowCellValue(column,index,index,"csv",node);this.result+=this.putInQuotes((_a273=rowCellValue.valueFormatted)!=null?_a273:rowCellValue.value)}putInQuotes(value){if(this.suppressQuotes)return value;if(value==null)return'""';let stringValue;return typeof value=="string"?stringValue=value:typeof value.toString=="function"?stringValue=value.toString():(console.warn("AG Grid: unknown value type during csv conversion"),stringValue=""),'"'+stringValue.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=LINE_SEPARATOR),this.isFirstLine=!1}},__name(_a270,"CsvSerializingSession"),_a270),_a271,CsvCreator=(_a271=class extends BaseCreator{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})}getMergedParams(params){const baseParams=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},baseParams,params)}export(userParams){if(this.isExportSuppressed()){console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");return}const mergedParams=this.getMergedParams(userParams),data=this.getData(mergedParams),packagedFile=new Blob(["\uFEFF",data],{type:"text/plain"}),fileName=typeof mergedParams.fileName=="function"?mergedParams.fileName(this.gridOptionsService.getGridCommonParams()):mergedParams.fileName;Downloader.download(this.getFileName(fileName),packagedFile)}exportDataAsCsv(params){this.export(params)}getDataAsCsv(params,skipDefaultParams=!1){const mergedParams=skipDefaultParams?Object.assign({},params):this.getMergedParams(params);return this.getData(mergedParams)}getDefaultFileExtension(){return"csv"}createSerializingSession(params){const{columnModel,valueService,gridOptionsService,valueFormatterService,valueParserService}=this,{processCellCallback,processHeaderCallback,processGroupHeaderCallback,processRowGroupCallback,suppressQuotes,columnSeparator}=params;return new CsvSerializingSession({columnModel,valueService,gridOptionsService,valueFormatterService,valueParserService,processCellCallback:processCellCallback||void 0,processHeaderCallback:processHeaderCallback||void 0,processGroupHeaderCallback:processGroupHeaderCallback||void 0,processRowGroupCallback:processRowGroupCallback||void 0,suppressQuotes:suppressQuotes||!1,columnSeparator:columnSeparator||","})}isExportSuppressed(){return this.gridOptionsService.get("suppressCsvExport")}},__name(_a271,"CsvCreator"),_a271);__decorateClass3([Autowired("columnModel")],CsvCreator.prototype,"columnModel",2);__decorateClass3([Autowired("valueService")],CsvCreator.prototype,"valueService",2);__decorateClass3([Autowired("gridSerializer")],CsvCreator.prototype,"gridSerializer",2);__decorateClass3([Autowired("gridOptionsService")],CsvCreator.prototype,"gridOptionsService",2);__decorateClass3([Autowired("valueFormatterService")],CsvCreator.prototype,"valueFormatterService",2);__decorateClass3([Autowired("valueParserService")],CsvCreator.prototype,"valueParserService",2);__decorateClass3([PostConstruct],CsvCreator.prototype,"postConstruct",1);CsvCreator=__decorateClass3([Bean("csvCreator")],CsvCreator);var _a272,GridSerializer=(_a272=class extends BeanStub{serialize(gridSerializingSession,params={}){const{allColumns,columnKeys,skipRowGroups}=params,columnsToExport=this.getColumnsToExport(allColumns,skipRowGroups,columnKeys);return _.compose(this.prepareSession(columnsToExport),this.prependContent(params),this.exportColumnGroups(params,columnsToExport),this.exportHeaders(params,columnsToExport),this.processPinnedTopRows(params,columnsToExport),this.processRows(params,columnsToExport),this.processPinnedBottomRows(params,columnsToExport),this.appendContent(params))(gridSerializingSession).parse()}processRow(gridSerializingSession,params,columnsToExport,node){const rowSkipper=params.shouldRowBeSkipped||(()=>!1),skipSingleChildrenGroup=this.gridOptionsService.get("groupRemoveSingleChildren"),skipLowestSingleChildrenGroup=this.gridOptionsService.get("groupRemoveLowestSingleChildren"),isExplicitExportSelection=params.rowPositions!=null||!!params.onlySelected,hideOpenParents=this.gridOptionsService.get("groupHideOpenParents")&&!isExplicitExportSelection,isLeafNode=this.columnModel.isPivotMode()?node.leafGroup:!node.group,isFooter=!!node.footer;params.skipRowGroups;const shouldSkipLowestGroup=skipLowestSingleChildrenGroup&&node.leafGroup,shouldSkipCurrentGroup=node.allChildrenCount===1&&(skipSingleChildrenGroup||shouldSkipLowestGroup);if(!isLeafNode&&!isFooter&&(params.skipRowGroups||shouldSkipCurrentGroup||hideOpenParents)||params.onlySelected&&!node.isSelected()||params.skipPinnedTop&&node.rowPinned==="top"||params.skipPinnedBottom&&node.rowPinned==="bottom"||node.level===-1&&!isLeafNode&&!isFooter||rowSkipper(this.gridOptionsService.addGridCommonParams({node})))return;const rowAccumulator=gridSerializingSession.onNewBodyRow(node);if(columnsToExport.forEach((column,index)=>{rowAccumulator.onColumn(column,index,node)}),params.getCustomContentBelowRow){const content=params.getCustomContentBelowRow(this.gridOptionsService.addGridCommonParams({node}));content&&gridSerializingSession.addCustomContent(content)}}appendContent(params){return gridSerializingSession=>{const appendContent=params.appendContent;return appendContent&&gridSerializingSession.addCustomContent(appendContent),gridSerializingSession}}prependContent(params){return gridSerializingSession=>{const prependContent=params.prependContent;return prependContent&&gridSerializingSession.addCustomContent(prependContent),gridSerializingSession}}prepareSession(columnsToExport){return gridSerializingSession=>(gridSerializingSession.prepare(columnsToExport),gridSerializingSession)}exportColumnGroups(params,columnsToExport){return gridSerializingSession=>{if(!params.skipColumnGroupHeaders){const groupInstanceIdCreator=new GroupInstanceIdCreator,displayedGroups=this.displayedGroupCreator.createDisplayedGroups(columnsToExport,groupInstanceIdCreator,null);this.recursivelyAddHeaderGroups(displayedGroups,gridSerializingSession,params.processGroupHeaderCallback)}return gridSerializingSession}}exportHeaders(params,columnsToExport){return gridSerializingSession=>{if(!params.skipColumnHeaders){const gridRowIterator=gridSerializingSession.onNewHeaderRow();columnsToExport.forEach((column,index)=>{gridRowIterator.onColumn(column,index,void 0)})}return gridSerializingSession}}processPinnedTopRows(params,columnsToExport){return gridSerializingSession=>{const processRow=this.processRow.bind(this,gridSerializingSession,params,columnsToExport);return params.rowPositions?params.rowPositions.filter(position=>position.rowPinned==="top").sort((a,b)=>a.rowIndex-b.rowIndex).map(position=>this.pinnedRowModel.getPinnedTopRow(position.rowIndex)).forEach(processRow):this.pinnedRowModel.forEachPinnedTopRow(processRow),gridSerializingSession}}processRows(params,columnsToExport){return gridSerializingSession=>{const rowModel=this.rowModel,rowModelType=rowModel.getType(),usingCsrm=rowModelType==="clientSide",usingSsrm=rowModelType==="serverSide",onlySelectedNonStandardModel=!usingCsrm&&params.onlySelected,processRow=this.processRow.bind(this,gridSerializingSession,params,columnsToExport),{exportedRows="filteredAndSorted"}=params;if(params.rowPositions)params.rowPositions.filter(position=>position.rowPinned==null).sort((a,b)=>a.rowIndex-b.rowIndex).map(position=>rowModel.getRow(position.rowIndex)).forEach(processRow);else if(this.columnModel.isPivotMode())usingCsrm?rowModel.forEachPivotNode(processRow,!0):usingSsrm?rowModel.forEachNodeAfterFilterAndSort(processRow,!0):rowModel.forEachNode(processRow);else if(params.onlySelectedAllPages||onlySelectedNonStandardModel){const selectedNodes=this.selectionService.getSelectedNodes();this.replicateSortedOrder(selectedNodes),selectedNodes.forEach(processRow)}else exportedRows==="all"?rowModel.forEachNode(processRow):usingCsrm||usingSsrm?rowModel.forEachNodeAfterFilterAndSort(processRow,!0):rowModel.forEachNode(processRow);return gridSerializingSession}}replicateSortedOrder(rows){const sortOptions=this.sortController.getSortOptions(),compareNodes=__name((rowA,rowB)=>{var _a273,_b,_c,_d;return rowA.rowIndex!=null&&rowB.rowIndex!=null?rowA.rowIndex-rowB.rowIndex:rowA.level===rowB.level?((_a273=rowA.parent)==null?void 0:_a273.id)===((_b=rowB.parent)==null?void 0:_b.id)?this.rowNodeSorter.compareRowNodes(sortOptions,{rowNode:rowA,currentPos:(_c=rowA.rowIndex)!=null?_c:-1},{rowNode:rowB,currentPos:(_d=rowB.rowIndex)!=null?_d:-1}):compareNodes(rowA.parent,rowB.parent):rowA.level>rowB.level?compareNodes(rowA.parent,rowB):compareNodes(rowA,rowB.parent)},"compareNodes");rows.sort(compareNodes)}processPinnedBottomRows(params,columnsToExport){return gridSerializingSession=>{const processRow=this.processRow.bind(this,gridSerializingSession,params,columnsToExport);return params.rowPositions?params.rowPositions.filter(position=>position.rowPinned==="bottom").sort((a,b)=>a.rowIndex-b.rowIndex).map(position=>this.pinnedRowModel.getPinnedBottomRow(position.rowIndex)).forEach(processRow):this.pinnedRowModel.forEachPinnedBottomRow(processRow),gridSerializingSession}}getColumnsToExport(allColumns=!1,skipRowGroups=!1,columnKeys){const isPivotMode=this.columnModel.isPivotMode();if(columnKeys&&columnKeys.length)return this.columnModel.getGridColumns(columnKeys);const isTreeData=this.gridOptionsService.get("treeData");let columnsToExport=[];return allColumns&&!isPivotMode?columnsToExport=this.columnModel.getAllGridColumns():columnsToExport=this.columnModel.getAllDisplayedColumns(),skipRowGroups&&!isTreeData&&(columnsToExport=columnsToExport.filter(column=>column.getColId()!==GROUP_AUTO_COLUMN_ID)),columnsToExport}recursivelyAddHeaderGroups(displayedGroups,gridSerializingSession,processGroupHeaderCallback){const directChildrenHeaderGroups=[];displayedGroups.forEach(columnGroupChild=>{const columnGroup=columnGroupChild;columnGroup.getChildren&&columnGroup.getChildren().forEach(it=>directChildrenHeaderGroups.push(it))}),displayedGroups.length>0&&displayedGroups[0]instanceof ColumnGroup&&this.doAddHeaderHeader(gridSerializingSession,displayedGroups,processGroupHeaderCallback),directChildrenHeaderGroups&&directChildrenHeaderGroups.length>0&&this.recursivelyAddHeaderGroups(directChildrenHeaderGroups,gridSerializingSession,processGroupHeaderCallback)}doAddHeaderHeader(gridSerializingSession,displayedGroups,processGroupHeaderCallback){const gridRowIterator=gridSerializingSession.onNewHeaderGroupingRow();let columnIndex=0;displayedGroups.forEach(columnGroupChild=>{const columnGroup=columnGroupChild;let name;processGroupHeaderCallback?name=processGroupHeaderCallback(this.gridOptionsService.addGridCommonParams({columnGroup})):name=this.columnModel.getDisplayNameForColumnGroup(columnGroup,"header");const collapsibleGroupRanges=columnGroup.getLeafColumns().reduce((collapsibleGroups,currentColumn,currentIdx,arr)=>{let lastGroup=_.last(collapsibleGroups);return currentColumn.getColumnGroupShow()==="open"?(!lastGroup||lastGroup[1]!=null)&&(lastGroup=[currentIdx],collapsibleGroups.push(lastGroup)):lastGroup&&lastGroup[1]==null&&(lastGroup[1]=currentIdx-1),currentIdx===arr.length-1&&lastGroup&&lastGroup[1]==null&&(lastGroup[1]=currentIdx),collapsibleGroups},[]);gridRowIterator.onColumn(columnGroup,name||"",columnIndex++,columnGroup.getLeafColumns().length-1,collapsibleGroupRanges)})}},__name(_a272,"GridSerializer"),_a272);__decorateClass3([Autowired("displayedGroupCreator")],GridSerializer.prototype,"displayedGroupCreator",2);__decorateClass3([Autowired("columnModel")],GridSerializer.prototype,"columnModel",2);__decorateClass3([Autowired("rowModel")],GridSerializer.prototype,"rowModel",2);__decorateClass3([Autowired("pinnedRowModel")],GridSerializer.prototype,"pinnedRowModel",2);__decorateClass3([Autowired("selectionService")],GridSerializer.prototype,"selectionService",2);__decorateClass3([Autowired("rowNodeSorter")],GridSerializer.prototype,"rowNodeSorter",2);__decorateClass3([Autowired("sortController")],GridSerializer.prototype,"sortController",2);GridSerializer=__decorateClass3([Bean("gridSerializer")],GridSerializer);var VERSION3="31.2.0",CsvExportModule={version:VERSION3,moduleName:"@ag-grid-community/csv-export",beans:[CsvCreator,GridSerializer]};ModuleRegistry.__registerModules([ClientSideRowModelModule,InfiniteRowModelModule,CsvExportModule],!1,void 0);export{AgPromise as A,BaseComponentWrapper as B,CssClassManager as C,GroupCellRendererCtrl as G,HeaderRowType as H,ModuleRegistry as M,PopupEditorWrapper as P,RowContainerCtrl as R,TabGuardCtrl as T,VanillaFrameworkOverrides as V,_,HeaderRowContainerCtrl as a,GridHeaderCtrl as b,RowContainerName as c,GridBodyCtrl as d,GridCtrl as e,ComponentUtil as f,getRowContainerTypeForName as g,TabGuardClassNames as h,CtrlsService as i,ColumnApi as j,GridCoreCreator as k};
//# sourceMappingURL=ag-grid-community-Bu5Vi0Ri.js.map
