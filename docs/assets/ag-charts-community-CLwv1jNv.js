var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});var __defProp2=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__export=__name((target,all)=>{for(var name in all)__defProp2(target,name,{get:all[name],enumerable:!0})},"__export"),__decorateClass=__name((decorators,target,key,kind)=>{for(var result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1,decorator;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp2(target,key,result),result},"__decorateClass"),AG_CHARTS_LOCALE_EN_US={ariaAnnounceHoverDatum:"${datum}",ariaAnnounceChart:"chart, ${seriesCount}[number] series",ariaAnnounceHierarchyChart:"hierarchy chart, ${caption}",ariaAnnounceGaugeChart:"gauge chart, ${caption}",ariaAnnounceHierarchyDatum:"level ${level}[number], ${count}[number] children, ${description}",ariaAnnounceFlowProportionLink:"link ${index} of ${count}, from ${from} to ${to}, ${sizeName} ${size}",ariaAnnounceFlowProportionNode:"node ${index} of ${count}, ${description}",ariaDescriptionLegendItem:"Press Space or Enter to toggle visibility",ariaLabelAnnotationOptionsToolbar:"Annotation Options",ariaLabelAnnotationSettingsDialog:"Annotation Settings",ariaLabelColorPicker:"Color picker",ariaLabelFinancialCharts:"Financial Charts",ariaLabelLegend:"Legend",ariaLabelLegendPagination:"Legend Pagination",ariaLabelLegendPagePrevious:"Previous Legend Page",ariaLabelLegendPageNext:"Next Legend Page",ariaLabelLegendItem:"${label}, Legend item ${index}[number] of ${count}[number]",ariaLabelLegendItemUnknown:"Unknown legend item",ariaLabelNavigator:"Navigator",ariaLabelNavigatorRange:"Range",ariaLabelNavigatorMinimum:"Minimum",ariaLabelNavigatorMaximum:"Maximum",ariaLabelRangesToolbar:"Ranges",ariaLabelSettingsTabBar:"Settings",ariaLabelZoomToolbar:"Zoom",ariaValuePanRange:"${min}[percent] to ${max}[percent]",iconAltTextLineStyleSolid:"Solid",iconAltTextLineStyleDashed:"Long-dashed",iconAltTextLineStyleDotted:"Short-dashed",iconAltTextPositionTop:"Top",iconAltTextPositionCenter:"Center",iconAltTextPositionBottom:"Bottom",iconAltTextAlignLeft:"Left",iconAltTextAlignCenter:"Center",iconAltTextAlignRight:"Right",iconAltTextClose:"Close",overlayLoadingData:"Loading data...",overlayNoData:"No data to display",overlayNoVisibleSeries:"No visible series",toolbarSeriesTypeDropdown:"Chart Type",toolbarSeriesTypeOHLC:"OHLC",toolbarSeriesTypeHLC:"HLC",toolbarSeriesTypeHighLow:"High Low",toolbarSeriesTypeCandles:"Candles",toolbarSeriesTypeHollowCandles:"Hollow Candles",toolbarSeriesTypeLine:"Line",toolbarSeriesTypeLineWithMarkers:"Line with Markers",toolbarSeriesTypeStepLine:"Step Line",toolbarAnnotationsTrendLine:"Trend Line",toolbarAnnotationsHorizontalLine:"Horizontal Line",toolbarAnnotationsVerticalLine:"Vertical Line",toolbarAnnotationsParallelChannel:"Parallel Channel",toolbarAnnotationsDisjointChannel:"Disjoint Channel",toolbarAnnotationsClearAll:"Clear All",toolbarAnnotationsColor:"Color",toolbarAnnotationsFillColor:"Fill Color",toolbarAnnotationsLineColor:"Line Color",toolbarAnnotationsLineStyle:"Line Style",toolbarAnnotationsLineStrokeWidth:"Line Stroke Width",toolbarAnnotationsSettings:"Settings",toolbarAnnotationsTextColor:"Text Color",toolbarAnnotationsTextSize:"Text Size",toolbarAnnotationsLock:"Lock",toolbarAnnotationsUnlock:"Unlock",toolbarAnnotationsDelete:"Delete",toolbarAnnotationsDragHandle:"Drag Toolbar",toolbarAnnotationsLineAnnotations:"Trend Lines",toolbarAnnotationsTextAnnotations:"Text Annotations",toolbarAnnotationsShapeAnnotations:"Shapes",toolbarAnnotationsCallout:"Callout",toolbarAnnotationsComment:"Comment",toolbarAnnotationsNote:"Note",toolbarAnnotationsText:"Text",toolbarAnnotationsArrow:"Arrow",toolbarAnnotationsArrowUp:"Arrow Up",toolbarAnnotationsArrowDown:"Arrow Down",toolbarRange1Month:"1M",toolbarRange1MonthAria:"1 month",toolbarRange3Months:"3M",toolbarRange3MonthsAria:"3 months",toolbarRange6Months:"6M",toolbarRange6MonthsAria:"6 months",toolbarRangeYearToDate:"YTD",toolbarRangeYearToDateAria:"Year to date",toolbarRange1Year:"1Y",toolbarRange1YearAria:"1 year",toolbarRangeAll:"All",toolbarRangeAllAria:"All",toolbarZoomZoomOut:"Zoom out",toolbarZoomZoomIn:"Zoom in",toolbarZoomPanLeft:"Pan left",toolbarZoomPanRight:"Pan right",toolbarZoomPanStart:"Pan to the start",toolbarZoomPanEnd:"Pan to the end",toolbarZoomReset:"Reset the zoom",contextMenuDownload:"Download",contextMenuToggleSeriesVisibility:"Toggle Visibility",contextMenuToggleOtherSeries:"Toggle Other Series",contextMenuZoomToCursor:"Zoom to here",contextMenuPanToCursor:"Pan to here",dialogHeaderChannel:"Channel",dialogHeaderLine:"Line",dialogHeaderText:"Text",dialogInputAlign:"Align",dialogInputColorPicker:"Color",dialogInputColorPickerAltText:"Text Color",dialogInputExtendChannelStart:"Extend channel start",dialogInputExtendChannelEnd:"Extend channel end",dialogInputExtendLineStart:"Extend line start",dialogInputExtendLineEnd:"Extend line end",dialogInputFontSize:"Size",dialogInputFontSizeAltText:"Font Size",dialogInputLineStyle:"Dash",dialogInputPosition:"Position",dialogInputStrokeWidth:"Weight",dialogInputStrokeWidthAltText:"Line Weight",inputTextareaPlaceholder:"Add Text"},ICONS_LEGACY=["delete-legacy","disjoint-channel","disjoint-channel-legacy","horizontal-line-legacy","line-color-legacy","lock","lock-legacy","pan-end-legacy","pan-left-legacy","pan-right-legacy","pan-start-legacy","parallel-channel","parallel-channel-legacy","reset-legacy","trend-line","trend-line-legacy","unlock","unlock-legacy","vertical-line","vertical-line-legacy","zoom-in-legacy","zoom-in-alt","zoom-in-alt-legacy","zoom-out-legacy","zoom-out-alt","zoom-out-alt-legacy"],AgTooltipPositionType=(AgTooltipPositionType2=>(AgTooltipPositionType2.POINTER="pointer",AgTooltipPositionType2.NODE="node",AgTooltipPositionType2.TOP="top",AgTooltipPositionType2.RIGHT="right",AgTooltipPositionType2.BOTTOM="bottom",AgTooltipPositionType2.LEFT="left",AgTooltipPositionType2.TOP_LEFT="top-left",AgTooltipPositionType2.TOP_RIGHT="top-right",AgTooltipPositionType2.BOTTOM_RIGHT="bottom-right",AgTooltipPositionType2.BOTTOM_LEFT="bottom-left",AgTooltipPositionType2))(AgTooltipPositionType||{}),time_exports={};__export(time_exports,{TimeInterval:__name(()=>TimeInterval,"TimeInterval"),day:__name(()=>day,"day"),friday:__name(()=>friday,"friday"),hour:__name(()=>hour,"hour"),millisecond:__name(()=>millisecond,"millisecond"),minute:__name(()=>minute,"minute"),monday:__name(()=>monday,"monday"),month:__name(()=>month,"month"),saturday:__name(()=>saturday,"saturday"),second:__name(()=>second,"second"),sunday:__name(()=>sunday,"sunday"),thursday:__name(()=>thursday,"thursday"),tuesday:__name(()=>tuesday,"tuesday"),utcDay:__name(()=>utcDay,"utcDay"),utcHour:__name(()=>utcHour,"utcHour"),utcMinute:__name(()=>utcMinute,"utcMinute"),utcMonth:__name(()=>utcMonth,"utcMonth"),utcYear:__name(()=>utcYear,"utcYear"),wednesday:__name(()=>wednesday,"wednesday"),year:__name(()=>year,"year")});var doOnceState=new Map;function doOnce(func,key){doOnceState.has(key)||(doOnceState.set(key,!0),func())}__name(doOnce,"doOnce");doOnce.clear=()=>doOnceState.clear();function identity(x){return x}__name(identity,"identity");function throttle(callback2,waitMs=0,options){const{leading=!0,trailing=!0}=options??{};let timerId,lastArgs,shouldWait=!1;function timeoutHandler(){trailing&&lastArgs?(timerId=setTimeout(timeoutHandler,waitMs),callback2(...lastArgs)):shouldWait=!1,lastArgs=null}__name(timeoutHandler,"timeoutHandler");function throttleCallback(...args){shouldWait?lastArgs=args:(shouldWait=!0,timerId=setTimeout(timeoutHandler,waitMs),leading?callback2(...args):lastArgs=args)}return __name(throttleCallback,"throttleCallback"),Object.assign(throttleCallback,{cancel(){clearTimeout(timerId),shouldWait=!1,lastArgs=null}})}__name(throttle,"throttle");function joinFunctions(...fns){return()=>{for(const fn of fns)fn()}}__name(joinFunctions,"joinFunctions");var Logger={log(...logContent){console.log(...logContent)},warn(message,...logContent){console.warn(`AG Charts - ${message}`,...logContent)},error(message,...logContent){typeof message=="object"?console.error("AG Charts error",message,...logContent):console.error(`AG Charts - ${message}`,...logContent)},table(...logContent){console.table(...logContent)},warnOnce(message,...logContent){doOnce(()=>Logger.warn(message,...logContent),`Logger.warn: ${message}`)},errorOnce(message,...logContent){doOnce(()=>Logger.error(message,...logContent),`Logger.error: ${message}`)}},_a,TimeInterval=(_a=class{constructor(_encode,_decode,_rangeCallback){this._encode=_encode,this._decode=_decode,this._rangeCallback=_rangeCallback}floor(date){const d=new Date(date),e=this._encode(d);return this._decode(e)}ceil(date){const d=new Date(Number(date)-1),e=this._encode(d);return this._decode(e+1)}range(start,stop,extend){var _a274;const rangeCallback=(_a274=this._rangeCallback)==null?void 0:_a274.call(this,start,stop),e0=this._encode(extend?this.floor(start):this.ceil(start)),e1=this._encode(extend?this.ceil(stop):this.floor(stop));if(e1<e0)return[];const range3=[];for(let e=e0;e<=e1;e++){const d=this._decode(e);range3.push(d)}return rangeCallback==null||rangeCallback(),range3}},__name(_a,"TimeInterval"),_a),_a2,CountableTimeInterval=(_a2=class extends TimeInterval{getOffset(snapTo,step){const s=typeof snapTo=="number"||snapTo instanceof Date?this._encode(new Date(snapTo)):0;return Math.floor(s)%step}every(step,options){let offset4=0,rangeCallback;const unsafeStep=step;step=Math.max(1,Math.round(step)),unsafeStep!==step&&Logger.warnOnce(`interval step of [${unsafeStep}] rounded to [${step}].`);const{snapTo="start"}=options??{};if(typeof snapTo=="string"){const initialOffset=offset4;rangeCallback=__name((start,stop)=>{const s=snapTo==="start"?start:stop;return offset4=this.getOffset(s,step),()=>offset4=initialOffset},"rangeCallback")}else typeof snapTo=="number"?offset4=this.getOffset(new Date(snapTo),step):snapTo instanceof Date&&(offset4=this.getOffset(snapTo,step));const encode13=__name(date=>{const e=this._encode(date);return Math.floor((e-offset4)/step)},"encode13"),decode13=__name(encoded=>this._decode(encoded*step+offset4),"decode13");return new TimeInterval(encode13,decode13,rangeCallback)}},__name(_a2,"CountableTimeInterval"),_a2);function encode(date){return date.getTime()}__name(encode,"encode");function decode(encoded){return new Date(encoded)}__name(decode,"decode");var millisecond=new CountableTimeInterval(encode,decode),millisecond_default=millisecond;new Date(0).getFullYear();var durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,offset=new Date().getTimezoneOffset()*durationMinute;function encode2(date){return Math.floor((date.getTime()-offset)/durationSecond)}__name(encode2,"encode2");function decode2(encoded){return new Date(offset+encoded*durationSecond)}__name(decode2,"decode2");var second=new CountableTimeInterval(encode2,decode2),second_default=second,offset2=new Date().getTimezoneOffset()*durationMinute;function encode3(date){return Math.floor((date.getTime()-offset2)/durationMinute)}__name(encode3,"encode3");function decode3(encoded){return new Date(offset2+encoded*durationMinute)}__name(decode3,"decode3");var minute=new CountableTimeInterval(encode3,decode3),minute_default=minute,offset3=new Date().getTimezoneOffset()*durationMinute;function encode4(date){return Math.floor((date.getTime()-offset3)/durationHour)}__name(encode4,"encode4");function decode4(encoded){return new Date(offset3+encoded*durationHour)}__name(decode4,"decode4");var hour=new CountableTimeInterval(encode4,decode4),hour_default=hour;function encode5(date){const tzOffsetMs=date.getTimezoneOffset()*durationMinute;return Math.floor((date.getTime()-tzOffsetMs)/durationDay)}__name(encode5,"encode5");function decode5(encoded){const d=new Date(1970,0,1);return d.setDate(d.getDate()+encoded),d}__name(decode5,"decode5");var day=new CountableTimeInterval(encode5,decode5),day_default=day;function weekday(weekStart){const dayShift=(7+weekStart-4)%7;function encode13(date){const tzOffsetMs=date.getTimezoneOffset()*durationMinute;return Math.floor((date.getTime()-tzOffsetMs)/durationWeek-dayShift/7)}__name(encode13,"encode13");function decode13(encoded){const d=new Date(1970,0,1);return d.setDate(d.getDate()+encoded*7+dayShift),d}return __name(decode13,"decode13"),new CountableTimeInterval(encode13,decode13)}__name(weekday,"weekday");var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),week_default=sunday;function encode6(date){return date.getFullYear()*12+date.getMonth()}__name(encode6,"encode6");function decode6(encoded){const year2=Math.floor(encoded/12),month2=encoded-year2*12;return new Date(year2,month2,1)}__name(decode6,"decode6");var month=new CountableTimeInterval(encode6,decode6),month_default=month;function encode7(date){return date.getFullYear()}__name(encode7,"encode7");function decode7(encoded){const d=new Date;return d.setFullYear(encoded),d.setMonth(0,1),d.setHours(0,0,0,0),d}__name(decode7,"decode7");var year=new CountableTimeInterval(encode7,decode7),year_default=year;function encode8(date){return Math.floor(date.getTime()/durationMinute)}__name(encode8,"encode8");function decode8(encoded){return new Date(encoded*durationMinute)}__name(decode8,"decode8");var utcMinute=new CountableTimeInterval(encode8,decode8);function encode9(date){return Math.floor(date.getTime()/durationHour)}__name(encode9,"encode9");function decode9(encoded){return new Date(encoded*durationHour)}__name(decode9,"decode9");var utcHour=new CountableTimeInterval(encode9,decode9);function encode10(date){return Math.floor(date.getTime()/durationDay)}__name(encode10,"encode10");function decode10(encoded){const d=new Date(0);return d.setUTCDate(d.getUTCDate()+encoded),d.setUTCHours(0,0,0,0),d}__name(decode10,"decode10");var utcDay=new CountableTimeInterval(encode10,decode10);function encode11(date){return date.getUTCFullYear()*12+date.getUTCMonth()}__name(encode11,"encode11");function decode11(encoded){const year2=Math.floor(encoded/12),month2=encoded-year2*12;return new Date(Date.UTC(year2,month2,1))}__name(decode11,"decode11");var utcMonth=new CountableTimeInterval(encode11,decode11);function encode12(date){return date.getUTCFullYear()}__name(encode12,"encode12");function decode12(encoded){const d=new Date;return d.setUTCFullYear(encoded),d.setUTCMonth(0,1),d.setUTCHours(0,0,0,0),d}__name(decode12,"decode12");var utcYear=new CountableTimeInterval(encode12,decode12),fromToMotion_exports={};__export(fromToMotion_exports,{NODE_UPDATE_STATE_TO_PHASE_MAPPING:__name(()=>NODE_UPDATE_STATE_TO_PHASE_MAPPING,"NODE_UPDATE_STATE_TO_PHASE_MAPPING"),fromToMotion:__name(()=>fromToMotion,"fromToMotion"),staticFromToMotion:__name(()=>staticFromToMotion,"staticFromToMotion")});var ID_MAP=new Map;function resetIds(){ID_MAP.clear()}__name(resetIds,"resetIds");function createId(instance){const constructor=instance.constructor,className=Object.hasOwn(constructor,"className")?constructor.className:constructor.name;if(!className)throw new Error(`The ${constructor} is missing the 'className' property.`);const nextId=(ID_MAP.get(className)??0)+1;return ID_MAP.set(className,nextId),`${className}-${nextId}`}__name(createId,"createId");function uuid(){return URL.createObjectURL(new Blob).split("/").at(-1)}__name(uuid,"uuid");function*iterate(...iterators){for(const iterator of iterators)yield*iterator}__name(iterate,"iterate");function toIterable(value){return value!=null&&typeof value=="object"&&Symbol.iterator in value?value:[value]}__name(toIterable,"toIterable");var interpolate=Symbol("interpolate"),isInterpolating=__name(x=>x[interpolate]!=null,"isInterpolating");function nearestSquared(x,y,objects,maxDistanceSquared=1/0){const result={nearest:void 0,distanceSquared:maxDistanceSquared};for(const obj of objects){const thisDistance=obj.distanceSquared(x,y);if(thisDistance===0)return{nearest:obj,distanceSquared:0};thisDistance<result.distanceSquared&&(result.nearest=obj,result.distanceSquared=thisDistance)}return result}__name(nearestSquared,"nearestSquared");function nearestSquaredInContainer(x,y,container,maxDistanceSquared=1/0){var _a274;const{x:tx=x,y:ty=y}=((_a274=container.transformPoint)==null?void 0:_a274.call(container,x,y))??{},result={nearest:void 0,distanceSquared:maxDistanceSquared};for(const child of container.children){const{nearest,distanceSquared:distanceSquared3}=child.nearestSquared(tx,ty,result.distanceSquared);if(distanceSquared3===0)return{nearest,distanceSquared:distanceSquared3};distanceSquared3<result.distanceSquared&&(result.nearest=nearest,result.distanceSquared=distanceSquared3)}return result}__name(nearestSquaredInContainer,"nearestSquaredInContainer");function clamp(min,value,max){return Math.min(max,Math.max(min,value))}__name(clamp,"clamp");function clampArray(value,array2){const[min,max]=findMinMax(array2);return clamp(min,value,max)}__name(clampArray,"clampArray");function findMinMax(array2){if(array2.length===0)return[];const result=[1/0,-1/0];for(const val of array2)val<result[0]&&(result[0]=val),val>result[1]&&(result[1]=val);return result}__name(findMinMax,"findMinMax");function findRangeExtent(array2){const[min,max]=findMinMax(array2);return max-min}__name(findRangeExtent,"findRangeExtent");function isEqual(a,b,epsilon2=1e-10){return Math.abs(a-b)<epsilon2}__name(isEqual,"isEqual");function isNegative(value){return Math.sign(value)===-1||Object.is(value,-0)}__name(isNegative,"isNegative");function round(value,decimals=2){const base=10**decimals;return Math.round(value*base)/base}__name(round,"round");function toFixed(value,fractionOrSignificantDigits=2){const power=Math.floor(Math.log(Math.abs(value))/Math.LN10);return power>=0||!isFinite(power)?value.toFixed(fractionOrSignificantDigits):value.toFixed(Math.abs(power)-1+fractionOrSignificantDigits)}__name(toFixed,"toFixed");function mod(n,m){return Math.floor(n%m+(n<0?m:0))}__name(mod,"mod");function countFractionDigits(value){var _a274;if(Math.floor(value)===value)return 0;let valueString=String(value),exponent=0;if(value<1e-6||value>=1e21){let exponentString;[valueString,exponentString]=valueString.split("e"),exponentString!=null&&(exponent=Number(exponentString))}const decimalPlaces2=((_a274=valueString.split(".")[1])==null?void 0:_a274.length)??0;return Math.max(decimalPlaces2-exponent,0)}__name(countFractionDigits,"countFractionDigits");function formatNormalizedPercentage(ratio2,locale){return locale=locale??navigator.language,new Intl.NumberFormat(locale,{style:"percent"}).format(ratio2)}__name(formatNormalizedPercentage,"formatNormalizedPercentage");function formatPercentage(percent,locale){return formatNormalizedPercentage(percent/100,locale)}__name(formatPercentage,"formatPercentage");var _a3,_BBox=(_a3=class{constructor(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height}static fromDOMRect({x,y,width,height}){return new _a3(x,y,width,height)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:this.x+this.width,bottom:this.y+this.height,toJSON(){return{}}}}clone(){const{x,y,width,height}=this;return new _a3(x,y,width,height)}equals(other){return this.x===other.x&&this.y===other.y&&this.width===other.width&&this.height===other.height}containsPoint(x,y){return x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height}intersection(other){if(!this.collidesBBox(other))return;const newX1=clamp(other.x,this.x,other.x+other.width),newY1=clamp(other.y,this.y,other.y+other.height),newX2=clamp(other.x,this.x+this.width,other.x+other.width),newY2=clamp(other.y,this.y+this.height,other.y+other.height);return new _a3(newX1,newY1,newX2-newX1,newY2-newY1)}collidesBBox(other){return this.x<other.x+other.width&&this.x+this.width>other.x&&this.y<other.y+other.height&&this.y+this.height>other.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(x,y){if(this.containsPoint(x,y))return 0;const dx=x-clamp(this.x,x,this.x+this.width),dy=y-clamp(this.y,y,this.y+this.height);return dx*dx+dy*dy}static nearestBox(x,y,boxes){return nearestSquared(x,y,boxes)}clip(clipRect){if(clipRect===void 0)return this;const x1=Math.max(this.x,clipRect.x),y1=Math.max(this.y,clipRect.y),x2=Math.min(this.x+this.width,clipRect.x+clipRect.width),y2=Math.min(this.y+this.height,clipRect.y+clipRect.height);return this.x=x1,this.y=y1,this.width=Math.max(0,x2-x1),this.height=Math.max(0,y2-y1),this}shrink(amount,position){const apply2=__name((pos,amt)=>{switch(pos){case"top":this.y+=amt;case"bottom":this.height-=amt;break;case"left":this.x+=amt;case"right":this.width-=amt;break;case"vertical":this.y+=amt,this.height-=amt*2;break;case"horizontal":this.x+=amt,this.width-=amt*2;break;case void 0:this.x+=amt,this.width-=amt*2,this.y+=amt,this.height-=amt*2;break}},"apply2");return typeof amount=="number"?apply2(position,amount):typeof amount=="object"&&Object.entries(amount).forEach(([pos,amt])=>apply2(pos,amt)),this}grow(amount,position){if(typeof amount=="number")this.shrink(-amount,position);else{const paddingCopy={...amount};for(const key in paddingCopy)paddingCopy[key]*=-1;this.shrink(paddingCopy)}return this}translate(x,y){return this.x+=x,this.y+=y,this}combine(other){const{x,y,width,height}=this;this.x=Math.min(x,other.x),this.y=Math.min(y,other.y),this.width=Math.max(x+width,other.x+other.width)-this.x,this.height=Math.max(y+height,other.y+other.height)-this.y}static merge(boxes){let left=1/0,top=1/0,right=-1/0,bottom=-1/0;for(const box of boxes)box.x<left&&(left=box.x),box.y<top&&(top=box.y),box.x+box.width>right&&(right=box.x+box.width),box.y+box.height>bottom&&(bottom=box.y+box.height);return new _a3(left,top,right-left,bottom-top)}[interpolate](other,d){return new _a3(this.x*(1-d)+other.x*d,this.y*(1-d)+other.y*d,this.width*(1-d)+other.width*d,this.height*(1-d)+other.height*d)}},__name(_a3,"_BBox"),_a3);_BBox.zero=Object.freeze(new _BBox(0,0,0,0));_BBox.NaN=Object.freeze(new _BBox(NaN,NaN,NaN,NaN));var BBox=_BBox,RedrawType=(RedrawType2=>(RedrawType2[RedrawType2.NONE=0]="NONE",RedrawType2[RedrawType2.TRIVIAL=1]="TRIVIAL",RedrawType2[RedrawType2.MINOR=2]="MINOR",RedrawType2[RedrawType2.MAJOR=3]="MAJOR",RedrawType2))(RedrawType||{});function SceneChangeDetection(opts){return function(target,key){const privateKey=`__${key}`;target[key]||prepareGetSet(target,key,privateKey,opts)}}__name(SceneChangeDetection,"SceneChangeDetection");function prepareGetSet(target,key,privateKey,opts){const{redraw=1,type="normal",changeCb,convertor,checkDirtyOnAssignment=!1}=opts??{},requiredOpts={redraw,type,changeCb,checkDirtyOnAssignment,convertor};let setter;switch(type){case"normal":setter=buildNormalSetter(privateKey,requiredOpts);break;case"transform":setter=buildTransformSetter(privateKey,requiredOpts);break;case"path":setter=buildPathSetter(privateKey,requiredOpts);break}setter=buildCheckDirtyChain(buildChangeCallbackChain(buildConvertorChain(setter,requiredOpts),requiredOpts),requiredOpts),Object.defineProperty(target,key,{set:setter,get:__name(function(){return this[privateKey]},"getter"),enumerable:!0,configurable:!0})}__name(prepareGetSet,"prepareGetSet");function buildConvertorChain(setterFn,opts){const{convertor}=opts;return convertor?function(value){setterFn.call(this,convertor(value))}:setterFn}__name(buildConvertorChain,"buildConvertorChain");var NO_CHANGE=Symbol("no-change");function buildChangeCallbackChain(setterFn,opts){const{changeCb}=opts;return changeCb?function(value){const change=setterFn.call(this,value);return change!==NO_CHANGE&&changeCb.call(this,this),change}:setterFn}__name(buildChangeCallbackChain,"buildChangeCallbackChain");function buildCheckDirtyChain(setterFn,opts){const{checkDirtyOnAssignment}=opts;return checkDirtyOnAssignment?function(value){const change=setterFn.call(this,value);return change!==NO_CHANGE&&value!=null&&value._dirty>0&&this.markDirty(value,value._dirty),change}:setterFn}__name(buildCheckDirtyChain,"buildCheckDirtyChain");function buildNormalSetter(privateKey,opts){const{redraw=1,changeCb}=opts;return function(value){const oldValue=this[privateKey];return value!==oldValue?(this[privateKey]=value,this.markDirty(this,redraw),changeCb==null||changeCb(this),value):NO_CHANGE}}__name(buildNormalSetter,"buildNormalSetter");function buildTransformSetter(privateKey,opts){const{redraw=1}=opts;return function(value){const oldValue=this[privateKey];return value!==oldValue?(this[privateKey]=value,this.markDirtyTransform(redraw),value):NO_CHANGE}}__name(buildTransformSetter,"buildTransformSetter");function buildPathSetter(privateKey,opts){const{redraw=1}=opts;return function(value){const oldValue=this[privateKey];return value!==oldValue?(this[privateKey]=value,this._dirtyPath||(this._dirtyPath=!0,this.markDirty(this,redraw)),value):NO_CHANGE}}__name(buildPathSetter,"buildPathSetter");var _a4,ChangeDetectable=(_a4=class{constructor(){this._dirty=3}markDirty(_source,type=1){this._dirty<type&&(this._dirty=type)}markClean(_opts){this._dirty=0}isDirty(){return this._dirty>0}},__name(_a4,"ChangeDetectable"),_a4),PointerEvents=(PointerEvents2=>(PointerEvents2[PointerEvents2.All=0]="All",PointerEvents2[PointerEvents2.None=1]="None",PointerEvents2))(PointerEvents||{}),_a5,_Node=(_a5=class extends ChangeDetectable{constructor({isVirtual,tag,zIndex,name}={}){super(),this.serialNumber=_a5._nextSerialNumber++,this.id=createId(this),this.isContainerNode=!1,this._virtualChildren=[],this._children=[],this.childSet={},this._childNodeCounts={groups:0,nonGroups:0},this.visible=!0,this.dirtyZIndex=!1,this.zIndex=0,this.zIndexSubOrder=void 0,this.pointerEvents=0,this.name=name,this.isVirtual=isVirtual??!1,this.tag=tag??NaN,this.zIndex=zIndex??0}get datum(){var _a274;return this._datum??((_a274=this._parent)==null?void 0:_a274.datum)}get previousDatum(){return this._previousDatum}set datum(datum){this._datum!==datum&&(this._previousDatum=this._datum),this._datum=datum}_setLayerManager(value){this._layerManager=value,this._debug=value==null?void 0:value.debug;for(const child of this._children)child._setLayerManager(value);for(const child of this._virtualChildren)child._setLayerManager(value)}get layerManager(){return this._layerManager}*ancestors(){let node=this;for(;node=node.parent;)yield node}*traverseUp(){yield this,yield*this.ancestors()}get parent(){return this._parent}get children(){return this._virtualChildren.length?this._children.concat(this._virtualChildren.flatMap(next=>next.children)):this._children}get virtualChildren(){return this._virtualChildren}hasVirtualChildren(){return this._virtualChildren.length>0}setProperties(styles,pickKeys){if(pickKeys)for(const key of pickKeys)this[key]=styles[key];else Object.assign(this,styles);return this}append(nodes){nodes=toIterable(nodes);for(const node of nodes){if(node.parent)throw new Error(`${node} already belongs to another parent: ${node.parent}.`);if(node.layerManager)throw new Error(`${node} already belongs to a scene: ${node.layerManager}.`);if(this.childSet[node.id])throw new Error(`Duplicate ${node.constructor.name} node: ${node}`);node.isVirtual?this._virtualChildren.push(node):this._children.push(node),this.childSet[node.id]=!0,node._parent=this,node._setLayerManager(this.layerManager)}this.cachedBBox=void 0,this.dirtyZIndex=!0,this.markDirty(this,3)}appendChild(node){return this.append(node),node}removeChild(node){const error=__name(()=>{throw new Error("The node to be removed is not a child of this node.")},"error");if(node.parent!==this&&error(),node.isVirtual){const i=this._virtualChildren.indexOf(node);i<0&&error(),this._virtualChildren.splice(i,1)}else{const i=this._children.indexOf(node);i<0&&error(),this._children.splice(i,1)}return delete this.childSet[node.id],node._parent=void 0,node._setLayerManager(),this.cachedBBox=void 0,this.dirtyZIndex=!0,this.markDirty(node,3),node}clear(){for(const child of iterate(this._virtualChildren,this._children))child._parent=void 0,child._setLayerManager();this.cachedBBox=void 0,this._virtualChildren.length=0,this._children.length=0,this.childSet={}}destroy(){var _a274;(_a274=this.parent)==null||_a274.removeChild(this)}containsPoint(_x,_y){return!1}pickNode(x,y,_localCoords=!1){if(!this.visible||this.pointerEvents===1||!this.containsPoint(x,y))return;const{children}=this;if(children.length>1e3)for(let i=children.length-1;i>=0;i--){const child=children[i],hit=child.containsPoint(x,y)?child.pickNode(x,y):void 0;if(hit)return hit}else if(children.length)for(let i=children.length-1;i>=0;i--){const hit=children[i].pickNode(x,y);if(hit)return hit}else if(!this.isContainerNode)return this}getBBox(){return this.cachedBBox==null&&(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}preRender(){this._childNodeCounts.groups=0,this._childNodeCounts.nonGroups=1;for(const child of this.children){const childCounts=child.preRender();this._childNodeCounts.groups+=childCounts.groups,this._childNodeCounts.nonGroups+=childCounts.nonGroups}return this._childNodeCounts}render(renderCtx){const{stats}=renderCtx;if(this._dirty=0,renderCtx.debugNodeSearch){const idOrName=this.name??this.id;renderCtx.debugNodeSearch.some(v=>typeof v=="string"?v===idOrName:v.test(idOrName))&&(renderCtx.debugNodes[this.name??this.id]=this)}stats&&stats.nodesRendered++}markDirty(_source,type=1,parentType=type){const _dirty=this._dirty,dirtyTypeBelowHighWatermark=_dirty>type||_dirty===type&&type===parentType;this.cachedBBox==null&&dirtyTypeBelowHighWatermark||(this.cachedBBox=void 0,this._dirty=Math.max(_dirty,type),this.parent?this.parent.markDirty(this,parentType):this.layerManager&&this.layerManager.markDirty())}get dirty(){return this._dirty}markClean(opts){const{force=!1,recursive=!0}=opts??{};if(!(this._dirty===0&&!force)){if(this._dirty=0,recursive!==!1)for(const child of this._virtualChildren)child.markClean({force});if(recursive===!0)for(const child of this._children)child.markClean({force})}}onVisibleChange(){}get nodeCount(){let count=1,dirtyCount=this._dirty>=0?1:0,visibleCount=this.visible?1:0;const countChild=__name(child=>{const{count:childCount,visibleCount:childVisibleCount,dirtyCount:childDirtyCount}=child.nodeCount;count+=childCount,visibleCount+=childVisibleCount,dirtyCount+=childDirtyCount},"countChild");for(const child of this._children)countChild(child);for(const child of this._virtualChildren)countChild(child);return{count,visibleCount,dirtyCount}}onZIndexChange(){this.parent&&(this.parent.dirtyZIndex=!0)}},__name(_a5,"_Node"),_a5);_Node._nextSerialNumber=0;__decorateClass([SceneChangeDetection({redraw:3,changeCb:__name(target=>target.onVisibleChange(),"changeCb")})],_Node.prototype,"visible",2);__decorateClass([SceneChangeDetection({redraw:1,changeCb:__name(target=>target.onZIndexChange(),"changeCb")})],_Node.prototype,"zIndex",2);__decorateClass([SceneChangeDetection({redraw:1,changeCb:__name(target=>target.onZIndexChange(),"changeCb")})],_Node.prototype,"zIndexSubOrder",2);var Node=_Node,lerp=__name((x,y,t)=>x*(1-t)+y*t,"lerp"),srgbToLinear=__name(value=>{const sign=value<0?-1:1,abs=Math.abs(value);return abs<=.04045?value/12.92:sign*((abs+.055)/1.055)**2.4},"srgbToLinear"),srgbFromLinear=__name(value=>{const sign=value<0?-1:1,abs=Math.abs(value);return abs>.0031308?sign*(1.055*abs**(1/2.4)-.055):12.92*value},"srgbFromLinear"),_a6,_Color=(_a6=class{constructor(r,g,b,a=1){this.r=clamp(0,r||0,1),this.g=clamp(0,g||0,1),this.b=clamp(0,b||0,1),this.a=clamp(0,a||0,1)}static validColorString(str){return str.indexOf("#")>=0?!!_a6.parseHex(str):str.indexOf("rgb")>=0?!!_a6.stringToRgba(str):!!_a6.nameToHex[str.toLowerCase()]}static fromString(str){if(str.indexOf("#")>=0)return _a6.fromHexString(str);const hex=_a6.nameToHex[str.toLowerCase()];if(hex)return _a6.fromHexString(hex);if(str.indexOf("rgb")>=0)return _a6.fromRgbaString(str);throw new Error(`Invalid color string: '${str}'`)}static parseHex(input){input=input.replace(/ /g,"").slice(1);let parts;switch(input.length){case 6:case 8:parts=[];for(let i=0;i<input.length;i+=2)parts.push(parseInt(`${input[i]}${input[i+1]}`,16));break;case 3:case 4:parts=input.split("").map(p=>parseInt(p,16)).map(p=>p+p*16);break}if((parts==null?void 0:parts.length)>=3&&parts.every(p=>p>=0))return parts.length===3&&parts.push(255),parts}static fromHexString(str){const values=_a6.parseHex(str);if(values){const[r,g,b,a]=values;return new _a6(r/255,g/255,b/255,a/255)}throw new Error(`Malformed hexadecimal color string: '${str}'`)}static stringToRgba(str){let po=-1,pc=-1;for(let i=0;i<str.length;i++){const c=str[i];if(po===-1&&c==="(")po=i;else if(c===")"){pc=i;break}}if(po===-1||pc===-1)return;const parts=str.substring(po+1,pc).split(","),rgba=[];for(let i=0;i<parts.length;i++){const part=parts[i];let value=parseFloat(part);if(!Number.isFinite(value))return;part.indexOf("%")>=0?(value=clamp(0,value,100),value/=100):i===3?value=clamp(0,value,1):(value=clamp(0,value,255),value/=255),rgba.push(value)}return rgba}static fromRgbaString(str){const rgba=_a6.stringToRgba(str);if(rgba){if(rgba.length===3)return new _a6(rgba[0],rgba[1],rgba[2]);if(rgba.length===4)return new _a6(rgba[0],rgba[1],rgba[2],rgba[3])}throw new Error(`Malformed rgb/rgba color string: '${str}'`)}static fromArray(arr){if(arr.length===4)return new _a6(arr[0],arr[1],arr[2],arr[3]);if(arr.length===3)return new _a6(arr[0],arr[1],arr[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(h,s,b,alpha=1){const rgb=_a6.HSBtoRGB(h,s,b);return new _a6(rgb[0],rgb[1],rgb[2],alpha)}static fromHSL(h,s,l,alpha=1){const rgb=_a6.HSLtoRGB(h,s,l);return new _a6(rgb[0],rgb[1],rgb[2],alpha)}static fromOKLCH(l,c,h,alpha=1){const rgb=_a6.OKLCHtoRGB(l,c,h);return new _a6(rgb[0],rgb[1],rgb[2],alpha)}static padHex(str){return str.length===1?"0"+str:str}toHexString(){let hex="#"+_a6.padHex(Math.round(this.r*255).toString(16))+_a6.padHex(Math.round(this.g*255).toString(16))+_a6.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(hex+=_a6.padHex(Math.round(this.a*255).toString(16))),hex}toRgbaString(fractionDigits=3){const components=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],k=Math.pow(10,fractionDigits);return this.a!==1?(components.push(Math.round(this.a*k)/k),`rgba(${components.join(", ")})`):`rgb(${components.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return _a6.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(r,g,b){const LSRGB0=srgbToLinear(r),LSRGB1=srgbToLinear(g),LSRGB2=srgbToLinear(b),LMS0=Math.cbrt(.4122214708*LSRGB0+.5363325363*LSRGB1+.0514459929*LSRGB2),LMS1=Math.cbrt(.2119034982*LSRGB0+.6806995451*LSRGB1+.1073969566*LSRGB2),LMS2=Math.cbrt(.0883024619*LSRGB0+.2817188376*LSRGB1+.6299787005*LSRGB2),OKLAB0=.2104542553*LMS0+.793617785*LMS1-.0040720468*LMS2,OKLAB1=1.9779984951*LMS0-2.428592205*LMS1+.4505937099*LMS2,OKLAB2=.0259040371*LMS0+.7827717662*LMS1-.808675766*LMS2,hue=Math.atan2(OKLAB2,OKLAB1)*180/Math.PI,OKLCH0=OKLAB0,OKLCH1=Math.hypot(OKLAB1,OKLAB2),OKLCH2=hue>=0?hue:hue+360;return[OKLCH0,OKLCH1,OKLCH2]}static OKLCHtoRGB(l,c,h){const OKLAB0=l,OKLAB1=c*Math.cos(h*Math.PI/180),OKLAB2=c*Math.sin(h*Math.PI/180),LMS0=(OKLAB0+.3963377774*OKLAB1+.2158037573*OKLAB2)**3,LMS1=(OKLAB0-.1055613458*OKLAB1-.0638541728*OKLAB2)**3,LMS2=(OKLAB0-.0894841775*OKLAB1-1.291485548*OKLAB2)**3,LSRGB0=4.0767416621*LMS0-3.3077115913*LMS1+.2309699292*LMS2,LSRGB1=-1.2684380046*LMS0+2.6097574011*LMS1-.3413193965*LMS2,LSRGB2=-.0041960863*LMS0-.7034186147*LMS1+1.707614701*LMS2,SRGB0=srgbFromLinear(LSRGB0),SRGB1=srgbFromLinear(LSRGB1),SRGB2=srgbFromLinear(LSRGB2);return[SRGB0,SRGB1,SRGB2]}static RGBtoHSL(r,g,b){const min=Math.min(r,g,b),max=Math.max(r,g,b),l=(max+min)/2;let h,s;if(max===min)h=0,s=0;else{const delta4=max-min;s=l>.5?delta4/(2-max-min):delta4/(max+min),max===r?h=(g-b)/delta4+(g<b?6:0):max===g?h=(b-r)/delta4+2:h=(r-g)/delta4+4,h*=360/6}return[h,s,l]}static HSLtoRGB(h,s,l){if(h=(h%360+360)%360,s===0)return[l,l,l];const q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;function hueToRgb(t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+(q-p)*6*t:t<1/2?q:t<2/3?p+(q-p)*(2/3-t)*6:p}__name(hueToRgb,"hueToRgb");const r=hueToRgb(h/360+1/3),g=hueToRgb(h/360),b=hueToRgb(h/360-1/3);return[r,g,b]}static RGBtoHSB(r,g,b){const min=Math.min(r,g,b),max=Math.max(r,g,b),S=max===0?0:(max-min)/max;let H=0;if(min!==max){const delta4=max-min,rc=(max-r)/delta4,gc=(max-g)/delta4,bc=(max-b)/delta4;r===max?H=bc-gc:g===max?H=2+rc-bc:H=4+gc-rc,H/=6,H<0&&(H=H+1)}return[H*360,S,max]}static HSBtoRGB(H,S,B){H=(H%360+360)%360/360;let r=0,g=0,b=0;if(S===0)r=g=b=B;else{const h=(H-Math.floor(H))*6,f=h-Math.floor(h),p=B*(1-S),q=B*(1-S*f),t=B*(1-S*(1-f));switch(h>>0){case 0:r=B,g=t,b=p;break;case 1:r=q,g=B,b=p;break;case 2:r=p,g=B,b=t;break;case 3:r=p,g=q,b=B;break;case 4:r=t,g=p,b=B;break;case 5:r=B,g=p,b=q;break}}return[r,g,b]}static mix(c0,c1,t){return new _a6(lerp(c0.r,c1.r,t),lerp(c0.g,c1.g,t),lerp(c0.b,c1.b,t),lerp(c0.a,c1.a,t))}},__name(_a6,"_Color"),_a6);_Color.nameToHex={__proto__:null,aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",transparent:"#00000000",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};var Color=_Color;function interpolateNumber(a,b){return d=>Number(a)*(1-d)+Number(b)*d}__name(interpolateNumber,"interpolateNumber");function interpolateColor(a,b){if(typeof a=="string")try{a=Color.fromString(a)}catch{a=Color.fromArray([0,0,0])}if(typeof b=="string")try{b=Color.fromString(b)}catch{b=Color.fromArray([0,0,0])}return d=>Color.mix(a,b,d).toRgbaString()}__name(interpolateColor,"interpolateColor");var BREAK_TRANSFORM_CHAIN=Symbol("BREAK"),CONFIG_KEY="__decorator_config";function initialiseConfig(target,propertyKeyOrSymbol){Object.getOwnPropertyDescriptor(target,CONFIG_KEY)==null&&Object.defineProperty(target,CONFIG_KEY,{value:{}});const config=target[CONFIG_KEY],propertyKey=propertyKeyOrSymbol.toString();if(typeof config[propertyKey]<"u")return config[propertyKey];const valuesMap=new WeakMap;config[propertyKey]={setters:[],getters:[],observers:[],valuesMap};const descriptor=Object.getOwnPropertyDescriptor(target,propertyKeyOrSymbol),prevSet=descriptor==null?void 0:descriptor.set,prevGet=descriptor==null?void 0:descriptor.get;return Object.defineProperty(target,propertyKeyOrSymbol,{set:__name(function(value){const{setters,observers}=config[propertyKey];let oldValue;setters.some(f=>f.length>2)&&(oldValue=prevGet?prevGet.call(this):valuesMap.get(this));for(const transformFn of setters)if(value=transformFn(this,propertyKeyOrSymbol,value,oldValue),value===BREAK_TRANSFORM_CHAIN)return;prevSet?prevSet.call(this,value):valuesMap.set(this,value);for(const observerFn of observers)observerFn(this,value,oldValue)},"setter"),get:__name(function(){let value=prevGet?prevGet.call(this):valuesMap.get(this);for(const transformFn of config[propertyKey].getters)if(value=transformFn(this,propertyKeyOrSymbol,value),value===BREAK_TRANSFORM_CHAIN)return;return value},"getter"),enumerable:!0,configurable:!1}),config[propertyKey]}__name(initialiseConfig,"initialiseConfig");function addTransformToInstanceProperty(setTransform,getTransform,configMetadata){return(target,propertyKeyOrSymbol)=>{const config=initialiseConfig(target,propertyKeyOrSymbol);config.setters.push(setTransform),getTransform&&config.getters.unshift(getTransform),configMetadata&&Object.assign(config,configMetadata)}}__name(addTransformToInstanceProperty,"addTransformToInstanceProperty");function addObserverToInstanceProperty(setObserver){return(target,propertyKeyOrSymbol)=>{initialiseConfig(target,propertyKeyOrSymbol).observers.push(setObserver)}}__name(addObserverToInstanceProperty,"addObserverToInstanceProperty");function isDecoratedObject(target){return typeof target<"u"&&CONFIG_KEY in target}__name(isDecoratedObject,"isDecoratedObject");function listDecoratedProperties(target){const targets=new Set;for(;isDecoratedObject(target);)targets.add(target==null?void 0:target[CONFIG_KEY]),target=Object.getPrototypeOf(target);return Array.from(targets).flatMap(configMap=>Object.keys(configMap))}__name(listDecoratedProperties,"listDecoratedProperties");function extractDecoratedProperties(target){return listDecoratedProperties(target).reduce((result,key)=>(result[key]=target[key]??null,result),{})}__name(extractDecoratedProperties,"extractDecoratedProperties");function extractDecoratedPropertyMetadata(target,propertyKeyOrSymbol){const propertyKey=propertyKeyOrSymbol.toString();for(;isDecoratedObject(target);){const config=target[CONFIG_KEY];if(Object.hasOwn(config,propertyKey))return config[propertyKey];target=Object.getPrototypeOf(target)}}__name(extractDecoratedPropertyMetadata,"extractDecoratedPropertyMetadata");function isDefined(val){return val!=null}__name(isDefined,"isDefined");function isArray(value){return Array.isArray(value)}__name(isArray,"isArray");function isBoolean(value){return typeof value=="boolean"}__name(isBoolean,"isBoolean");function isDate(value){return value instanceof Date}__name(isDate,"isDate");function isValidDate(value){return isDate(value)&&!isNaN(Number(value))}__name(isValidDate,"isValidDate");function isRegExp(value){return value instanceof RegExp}__name(isRegExp,"isRegExp");function isFunction(value){return typeof value=="function"}__name(isFunction,"isFunction");function isObject(value){return typeof value=="object"&&value!==null&&!isArray(value)}__name(isObject,"isObject");function isObjectLike(value){return isArray(value)||isPlainObject(value)}__name(isObjectLike,"isObjectLike");function isPlainObject(value){return typeof value=="object"&&value!==null&&Object.getPrototypeOf(value)===Object.prototype}__name(isPlainObject,"isPlainObject");function isString(value){return typeof value=="string"}__name(isString,"isString");function isNumber(value){return typeof value=="number"}__name(isNumber,"isNumber");function isFiniteNumber(value){return Number.isFinite(value)}__name(isFiniteNumber,"isFiniteNumber");function isHtmlElement(value){return typeof window<"u"&&value instanceof HTMLElement}__name(isHtmlElement,"isHtmlElement");function isEnumKey(enumObject,enumKey){return isString(enumKey)&&Object.keys(enumObject).includes(enumKey)}__name(isEnumKey,"isEnumKey");function isEnumValue(enumObject,enumValue){return Object.values(enumObject).includes(enumValue)}__name(isEnumValue,"isEnumValue");function isSymbol(value){return typeof value=="symbol"}__name(isSymbol,"isSymbol");function objectEqualWith(a,b,cmp){for(const key in b)if(!(key in a))return!1;for(const key in a)if(!(key in b)||!cmp(a[key],b[key]))return!1;return!0}__name(objectEqualWith,"objectEqualWith");function deepMerge(...sources){return mergeDefaults(...sources.reverse())}__name(deepMerge,"deepMerge");function mergeDefaults(...sources){const target={};for(const source of sources){if(!isObject(source))continue;const keys=isDecoratedObject(source)?listDecoratedProperties(source):Object.keys(source);for(const key of keys)isPlainObject(target[key])&&isPlainObject(source[key])?target[key]=mergeDefaults(target[key],source[key]):target[key]??(target[key]=source[key])}return target}__name(mergeDefaults,"mergeDefaults");function mergeArrayDefaults(dataArray,...itemDefaults){return itemDefaults&&isArray(dataArray)?dataArray.map(item=>mergeDefaults(item,...itemDefaults)):dataArray}__name(mergeArrayDefaults,"mergeArrayDefaults");function mapValues(object2,mapper){return Object.entries(object2).reduce((result,[key,value])=>(result[key]=mapper(value,key,object2),result),{})}__name(mapValues,"mapValues");function without(object2,keys){const clone={...object2};for(const key of keys)delete clone[key];return clone}__name(without,"without");function getPath(object2,path){return(isArray(path)?path:path.split(".")).reduce((value,pathKey)=>value[pathKey],object2)}__name(getPath,"getPath");var SKIP_JS_BUILTINS=new Set(["__proto__","constructor","prototype"]);function setPath(object2,path,newValue){const pathArray=isArray(path)?path.slice():path.split("."),lastKey=pathArray.pop();if(pathArray.some(p=>SKIP_JS_BUILTINS.has(p)))return;const lastObject=pathArray.reduce((value,pathKey)=>value[pathKey],object2);return lastObject[lastKey]=newValue,lastObject[lastKey]}__name(setPath,"setPath");function partialAssign(keysToCopy,target,source){if(source===void 0)return target;for(const key of keysToCopy){const value=source[key];value!==void 0&&(target[key]=value)}return target}__name(partialAssign,"partialAssign");var easing_exports={};__export(easing_exports,{easeIn:__name(()=>easeIn,"easeIn"),easeInOut:__name(()=>easeInOut,"easeInOut"),easeInOutQuad:__name(()=>easeInOutQuad,"easeInOutQuad"),easeInQuad:__name(()=>easeInQuad,"easeInQuad"),easeOut:__name(()=>easeOut,"easeOut"),easeOutQuad:__name(()=>easeOutQuad,"easeOutQuad"),inverseEaseOut:__name(()=>inverseEaseOut,"inverseEaseOut"),linear:__name(()=>linear,"linear")});var linear=__name(n=>n,"linear"),easeIn=__name(n=>1-Math.cos(n*Math.PI/2),"easeIn"),easeOut=__name(n=>Math.sin(n*Math.PI/2),"easeOut"),easeInOut=__name(n=>-(Math.cos(n*Math.PI)-1)/2,"easeInOut"),easeInQuad=__name(n=>n*n,"easeInQuad"),easeOutQuad=__name(n=>1-(1-n)**2,"easeOutQuad"),easeInOutQuad=__name(n=>n<.5?2*n*n:1-(-2*n+2)**2/2,"easeInOutQuad"),inverseEaseOut=__name(x=>2*Math.asin(x)/Math.PI,"inverseEaseOut"),QUICK_TRANSITION=.2,PHASE_ORDER=["initial","remove","update","add","trailing","end","none"],PHASE_METADATA={initial:{animationDuration:1,animationDelay:0},add:{animationDuration:.25,animationDelay:.75},remove:{animationDuration:.25,animationDelay:0},update:{animationDuration:.5,animationDelay:.25},trailing:{animationDuration:QUICK_TRANSITION,animationDelay:1,skipIfNoEarlierAnimations:!0},end:{animationDelay:1+QUICK_TRANSITION,animationDuration:0,skipIfNoEarlierAnimations:!0},none:{animationDuration:0,animationDelay:0}},RepeatType=(RepeatType2=>(RepeatType2.Loop="loop",RepeatType2.Reverse="reverse",RepeatType2))(RepeatType||{});function isNodeArray(array2){return array2.every(n=>n instanceof Node)}__name(isNodeArray,"isNodeArray");function deconstructSelectionsOrNodes(selectionsOrNodes){return isNodeArray(selectionsOrNodes)?{nodes:selectionsOrNodes,selections:[]}:{nodes:[],selections:selectionsOrNodes}}__name(deconstructSelectionsOrNodes,"deconstructSelectionsOrNodes");function animationValuesEqual(a,b){return a===b?!0:Array.isArray(a)&&Array.isArray(b)?a.length===b.length&&a.every((v,i)=>animationValuesEqual(v,b[i])):isInterpolating(a)&&isInterpolating(b)?a.equals(b):isPlainObject(a)&&isPlainObject(b)?objectEqualWith(a,b,animationValuesEqual):!1}__name(animationValuesEqual,"animationValuesEqual");var _a7,Animation=(_a7=class{constructor(opts){var _a274,_b,_c;this.isComplete=!1,this.elapsed=0,this.iteration=0,this.isPlaying=!1,this.isReverse=!1,this.id=opts.id,this.groupId=opts.groupId,this.autoplay=opts.autoplay??!0,this.ease=opts.ease??linear,this.phase=opts.phase;const durationProportion=opts.duration??PHASE_METADATA[this.phase].animationDuration;this.duration=durationProportion*opts.defaultDuration,this.delay=(opts.delay??0)*opts.defaultDuration,this.onComplete=opts.onComplete,this.onPlay=opts.onPlay,this.onStop=opts.onStop,this.onUpdate=opts.onUpdate,this.interpolate=this.createInterpolator(opts.from,opts.to),this.from=opts.from,opts.skip===!0&&((_a274=this.onUpdate)==null||_a274.call(this,opts.to,!1,this),(_b=this.onStop)==null||_b.call(this,this),(_c=this.onComplete)==null||_c.call(this,this),this.isComplete=!0),opts.collapsable!==!1&&(this.duration=this.checkCollapse(opts,this.duration))}checkCollapse(opts,calculatedDuration){return animationValuesEqual(opts.from,opts.to)?0:calculatedDuration}play(initialUpdate=!1){var _a274,_b;this.isPlaying||this.isComplete||(this.isPlaying=!0,(_a274=this.onPlay)==null||_a274.call(this,this),this.autoplay&&(this.autoplay=!1,initialUpdate&&((_b=this.onUpdate)==null||_b.call(this,this.from,!0,this))))}pause(){this.isPlaying=!1}stop(){var _a274;this.isPlaying=!1,this.isComplete||(this.isComplete=!0,(_a274=this.onStop)==null||_a274.call(this,this))}update(time2){var _a274,_b;if(this.isComplete)return time2;!this.isPlaying&&this.autoplay&&this.play(!0);const previousElapsed=this.elapsed;if(this.elapsed+=time2,this.delay>this.elapsed)return 0;const value=this.interpolate(this.isReverse?1-this.delta:this.delta);(_a274=this.onUpdate)==null||_a274.call(this,value,!1,this);const totalDuration=this.delay+this.duration;return this.elapsed>=totalDuration?(this.stop(),this.isComplete=!0,(_b=this.onComplete)==null||_b.call(this,this),time2-(totalDuration-previousElapsed)):0}get delta(){return this.ease(clamp(0,(this.elapsed-this.delay)/this.duration,1))}createInterpolator(from2,to){if(typeof to!="object"||isInterpolating(to))return this.interpolateValue(from2,to);const interpolatorEntries=[];for(const key in to){const interpolator=this.interpolateValue(from2[key],to[key]);interpolator!=null&&interpolatorEntries.push([key,interpolator])}return d=>{const result={};for(const[key,interpolator]of interpolatorEntries)result[key]=interpolator(d);return result}}interpolateValue(a,b){if(!(a==null||b==null)){if(isInterpolating(a))return d=>a[interpolate](b,d);try{switch(typeof a){case"number":return interpolateNumber(a,b);case"string":return interpolateColor(a,b);case"boolean":if(a===b)return()=>a;break}}catch{}throw new Error(`Unable to interpolate values: ${a}, ${b}`)}}},__name(_a7,"Animation"),_a7),NODE_UPDATE_STATE_TO_PHASE_MAPPING={added:"add",updated:"update",removed:"remove",unknown:"initial","no-op":"none"};function fromToMotion(groupId,subId,animationManager,selectionsOrNodes,fns,getDatumId,diff2){const{fromFn,toFn,applyFn=__name((node,props)=>node.setProperties(props),"applyFn")}=fns,{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes),processNodes=__name((liveNodes,subNodes)=>{let prevFromProps,liveNodeIndex=0,nodeIndex=0;for(const node of subNodes){const isLive=liveNodes[liveNodeIndex]===node,ctx={last:nodeIndex>=subNodes.length-1,lastLive:liveNodeIndex>=liveNodes.length-1,prev:subNodes[nodeIndex-1],prevFromProps,prevLive:liveNodes[liveNodeIndex-1],next:subNodes[nodeIndex+1],nextLive:liveNodes[liveNodeIndex+(isLive?1:0)]},animationId=`${groupId}_${subId}_${node.id}`;animationManager.stopByAnimationId(animationId);let status="unknown";isLive?getDatumId&&diff2&&(status=calculateStatus(node,node.datum,getDatumId,diff2)):status="removed";const{phase,start,finish,delay,duration,...from2}=fromFn(node,node.datum,status,ctx),{phase:toPhase,start:toStart,finish:toFinish,delay:toDelay,duration:toDuration,...to}=toFn(node,node.datum,status,ctx),collapsable=finish==null;animationManager.animate({id:animationId,groupId,phase:phase??toPhase??"update",duration:duration??toDuration,delay:delay??toDelay,from:from2,to,ease:easeOut,collapsable,onPlay:__name(()=>{applyFn(node,{...start,...toStart,...from2})},"onPlay"),onUpdate(props){applyFn(node,props)},onStop:__name(()=>{applyFn(node,{...start,...toStart,...from2,...to,...finish,...toFinish})},"onStop")}),isLive&&liveNodeIndex++,nodeIndex++,prevFromProps=from2}},"processNodes");let selectionIndex=0;for(const selection of selections){const selectionNodes=selection.nodes(),liveNodes=selectionNodes.filter(n=>!selection.isGarbage(n));processNodes(liveNodes,selectionNodes),animationManager.animate({id:`${groupId}_${subId}_selection_${selectionIndex}`,groupId,phase:"end",from:0,to:1,ease:easeOut,onStop(){selection.cleanup()}}),selectionIndex++}processNodes(nodes,nodes)}__name(fromToMotion,"fromToMotion");function staticFromToMotion(groupId,subId,animationManager,selectionsOrNodes,from2,to,extraOpts){const{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes),{start,finish,phase}=extraOpts;animationManager.animate({id:`${groupId}_${subId}`,groupId,phase:phase??"update",from:from2,to,ease:easeOut,onPlay:__name(()=>{if(start){for(const node of nodes)node.setProperties(start);for(const selection of selections)for(const node of selection.nodes())node.setProperties(start)}},"onPlay"),onUpdate(props){for(const node of nodes)node.setProperties(props);for(const selection of selections)for(const node of selection.nodes())node.setProperties(props)},onStop:__name(()=>{for(const node of nodes)node.setProperties({...to,...finish});for(const selection of selections){for(const node of selection.nodes())node.setProperties({...to,...finish});selection.cleanup()}},"onStop")})}__name(staticFromToMotion,"staticFromToMotion");function calculateStatus(node,datum,getDatumId,diff2){const id=getDatumId(node,datum);return diff2.added.has(id)?"added":diff2.removed.has(id)?"removed":"updated"}__name(calculateStatus,"calculateStatus");var CONSTANTS={periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function dayOfYear(date,startOfYear=new Date(date.getFullYear(),0,1)){const startOffset=date.getTimezoneOffset()-startOfYear.getTimezoneOffset(),timeDiff=date.getTime()-startOfYear.getTime()+startOffset*6e4,timeOneDay=36e5*24;return Math.floor(timeDiff/timeOneDay)}__name(dayOfYear,"dayOfYear");function weekOfYear(date,startDay){const startOfYearDay=new Date(date.getFullYear(),0,1).getDay(),firstWeekStartOffset=(startDay-startOfYearDay+7)%7,startOffset=new Date(date.getFullYear(),0,firstWeekStartOffset+1);return startOffset<=date?Math.floor(dayOfYear(date,startOffset)/7)+1:0}__name(weekOfYear,"weekOfYear");var SUNDAY=0,MONDAY=1,THURSDAY=4;function isoWeekOfYear(date,year2=date.getFullYear()){const firstOfYearDay=new Date(year2,0,1).getDay(),firstThursdayOffset=(THURSDAY-firstOfYearDay+7)%7,startOffset=new Date(year2,0,firstThursdayOffset-(THURSDAY-MONDAY)+1);return startOffset<=date?Math.floor(dayOfYear(date,startOffset)/7)+1:isoWeekOfYear(date,year2-1)}__name(isoWeekOfYear,"isoWeekOfYear");function timezone(date){const offset4=date.getTimezoneOffset(),unsignedOffset=Math.abs(offset4);return`${offset4>0?"-":"+"}${pad(Math.floor(unsignedOffset/60),2,"0")}${pad(Math.floor(unsignedOffset%60),2,"0")}`}__name(timezone,"timezone");var FORMATTERS={a:__name(d=>CONSTANTS.shortDays[d.getDay()],"a"),A:__name(d=>CONSTANTS.days[d.getDay()],"A"),b:__name(d=>CONSTANTS.shortMonths[d.getMonth()],"b"),B:__name(d=>CONSTANTS.months[d.getMonth()],"B"),c:"%x, %X",d:__name((d,p)=>pad(d.getDate(),2,p??"0"),"d"),e:"%_d",f:__name((d,p)=>pad(d.getMilliseconds()*1e3,6,p??"0"),"f"),H:__name((d,p)=>pad(d.getHours(),2,p??"0"),"H"),I:__name((d,p)=>{const hours=d.getHours()%12;return hours===0?"12":pad(hours,2,p??"0")},"I"),j:__name((d,p)=>pad(dayOfYear(d)+1,3,p??"0"),"j"),m:__name((d,p)=>pad(d.getMonth()+1,2,p??"0"),"m"),M:__name((d,p)=>pad(d.getMinutes(),2,p??"0"),"M"),L:__name((d,p)=>pad(d.getMilliseconds(),3,p??"0"),"L"),p:__name(d=>d.getHours()<12?"AM":"PM","p"),Q:__name(d=>String(d.getTime()),"Q"),s:__name(d=>String(Math.floor(d.getTime()/1e3)),"s"),S:__name((d,p)=>pad(d.getSeconds(),2,p??"0"),"S"),u:__name(d=>{let day2=d.getDay();return day2<1&&(day2+=7),String(day2%7)},"u"),U:__name((d,p)=>pad(weekOfYear(d,SUNDAY),2,p??"0"),"U"),V:__name((d,p)=>pad(isoWeekOfYear(d),2,p??"0"),"V"),w:__name((d,p)=>pad(d.getDay(),2,p??"0"),"w"),W:__name((d,p)=>pad(weekOfYear(d,MONDAY),2,p??"0"),"W"),x:"%-m/%-d/%Y",X:"%-I:%M:%S %p",y:__name((d,p)=>pad(d.getFullYear()%100,2,p??"0"),"y"),Y:__name((d,p)=>pad(d.getFullYear(),4,p??"0"),"Y"),Z:__name(d=>timezone(d),"Z"),"%":__name(()=>"%","%")},PADS={_:" ",0:"0","-":""};function pad(value,size,padChar){const output=String(Math.floor(value));return output.length>=size?output:`${padChar.repeat(size-output.length)}${output}`}__name(pad,"pad");function buildFormatter(formatString){const formatParts=[];for(;formatString.length>0;){let nextEscapeIdx=formatString.indexOf("%");if(nextEscapeIdx!==0){const literalPart=nextEscapeIdx>0?formatString.substring(0,nextEscapeIdx):formatString;formatParts.push(literalPart)}if(nextEscapeIdx<0)break;const maybePadSpecifier=formatString[nextEscapeIdx+1],maybePad=PADS[maybePadSpecifier];maybePad!=null&&nextEscapeIdx++;const maybeFormatterSpecifier=formatString[nextEscapeIdx+1],maybeFormatter=FORMATTERS[maybeFormatterSpecifier];if(typeof maybeFormatter=="function")formatParts.push([maybeFormatter,maybePad]);else if(typeof maybeFormatter=="string"){const formatter=buildFormatter(maybeFormatter);formatParts.push([formatter,maybePad])}else formatParts.push(`${maybePad??""}${maybeFormatterSpecifier}`);formatString=formatString.substring(nextEscapeIdx+2)}return dateTime=>{const dateTimeAsDate=typeof dateTime=="number"?new Date(dateTime):dateTime;return formatParts.map(c=>typeof c=="string"?c:c[0](dateTimeAsDate,c[1])).join("")}}__name(buildFormatter,"buildFormatter");function dateToNumber(value){return value instanceof Date?value.getTime():value}__name(dateToNumber,"dateToNumber");function defaultTimeTickFormat(ticks,domain,formatOffset){const formatString=calculateDefaultTimeTickFormat(ticks,domain,formatOffset),formatter=buildFormatter(formatString);return date=>formatter(date)}__name(defaultTimeTickFormat,"defaultTimeTickFormat");function calculateDefaultTimeTickFormat(ticks=[],domain=ticks,formatOffset=0){let minInterval=1/0;for(let i=1;i<ticks.length;i++)minInterval=Math.min(minInterval,Math.abs(ticks[i]-ticks[i-1]));const startYear=new Date(domain[0]).getFullYear(),yearChange=new Date(domain.at(-1)).getFullYear()-startYear>0,timeFormat=isFinite(minInterval)?getIntervalLowestGranularityFormat(minInterval,ticks):getLowestGranularityFormat(ticks[0]);return formatStringBuilder(Math.max(timeFormat-formatOffset,0),yearChange,ticks)}__name(calculateDefaultTimeTickFormat,"calculateDefaultTimeTickFormat");function getIntervalLowestGranularityFormat(value,ticks){return value<durationSecond?0:value<durationMinute?1:value<durationHour?2:value<durationDay?3:value<durationWeek?4:value<durationDay*28||value<durationDay*31&&hasDuplicateMonth(ticks)?5:value<durationYear?6:7}__name(getIntervalLowestGranularityFormat,"getIntervalLowestGranularityFormat");function getLowestGranularityFormat(value){return second_default.floor(value)<value?0:minute_default.floor(value)<value?1:hour_default.floor(value)<value?2:day_default.floor(value)<value?3:month_default.floor(value)<value?week_default.floor(value)<value?4:5:year_default.floor(value)<value?6:7}__name(getLowestGranularityFormat,"getLowestGranularityFormat");function hasDuplicateMonth(ticks){let prevMonth=new Date(ticks[0]).getMonth();for(let i=1;i<ticks.length;i++){const tickMonth=new Date(ticks[i]).getMonth();if(prevMonth===tickMonth)return!0;prevMonth=tickMonth}return!1}__name(hasDuplicateMonth,"hasDuplicateMonth");function formatStringBuilder(defaultTimeFormat,yearChange,ticks){const firstTick=dateToNumber(ticks[0]),lastTick=dateToNumber(ticks.at(-1)),extent2=Math.abs(lastTick-firstTick),activeYear=yearChange||defaultTimeFormat===7,activeDate=extent2===0,formatParts=[["hour",6*durationHour,14*durationDay,3,"%I %p"],["hour",durationMinute,6*durationHour,3,"%I:%M"],["second",1e3,6*durationHour,1,":%S"],["ms",0,6*durationHour,0,".%L"],["am/pm",durationMinute,6*durationHour,3,"%p"]," ",["day",durationDay,durationWeek,4,"%a"],["month",activeDate?0:durationWeek,52*durationWeek,5,"%b %d"],["month",5*durationWeek,10*durationYear,6,"%B"]," ",["year",activeYear?0:durationYear,1/0,7,"%Y"]].filter(v=>{if(typeof v=="string")return!0;const[_,min,max,format]=v;return format>=defaultTimeFormat&&min<=extent2&&extent2<max}).reduce((r,next)=>(typeof next=="string"?r.result.push(next):r.used.has(next[0])||(r.result.push(next),r.used.add(next[0])),r),{result:[],used:new Set}).result,firstFormat=formatParts.findIndex(v=>typeof v!="string"),lastFormat=formatParts.length-[...formatParts].reverse().findIndex(v=>typeof v!="string");return formatParts.slice(firstFormat,lastFormat).map(v=>typeof v=="string"?v:v[4]).join("").replaceAll(/\s+/g," ").trim()}__name(formatStringBuilder,"formatStringBuilder");var Invalidating=__name((target,propertyKey)=>{const mappedProperty=Symbol(String(propertyKey));target[mappedProperty]=void 0,Object.defineProperty(target,propertyKey,{get(){return this[mappedProperty]},set(newValue){this[mappedProperty]!==newValue&&(this[mappedProperty]=newValue,this.invalid=!0)},enumerable:!0,configurable:!1})},"Invalidating"),_a8,_BandScale=(_a8=class{constructor(){this.type="band",this.invalid=!0,this.range=[0,1],this.round=!1,this.interval=void 0,this.index=new Map,this.ordinalRange=[],this._domain=[],this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(value){return value instanceof _a8}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}set domain(values){this.index=new Map,this.invalid=!0,this._domain=[];for(const value of values){const key=dateToNumber(value);this.getIndex(key)===void 0&&this.index.set(key,this._domain.push(value)-1)}}get domain(){return this._domain}getDomain(){return this._domain}ticks(){return this.refresh(),this._domain}convert(d){this.refresh();const i=this.getIndex(d);return i==null?NaN:this.ordinalRange[i]??NaN}invert(position){this.refresh();const index=this.ordinalRange.findIndex(p=>p===position);return this.domain[index]}invertNearest(position){this.refresh();let nearest=-1,minDistance=1/0;const index=this.ordinalRange.findIndex((p,i)=>{if(p===position)return!0;const distance3=Math.abs(position-p);return distance3<minDistance&&(minDistance=distance3,nearest=i),!1});return this.domain[index]??this.domain[nearest]}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(value){value=clamp(0,value,1),this._paddingInner=value,this._paddingOuter=value}get padding(){return this._paddingInner}set paddingInner(value){this._paddingInner=clamp(0,value,1)}get paddingInner(){return this._paddingInner}set paddingOuter(value){this._paddingOuter=clamp(0,value,1)}get paddingOuter(){return this._paddingOuter}update(){const count=this._domain.length;if(count===0)return;const[r0,r1]=this.range;let{_paddingInner:paddingInner}=this;const{_paddingOuter:paddingOuter,round:round3}=this,rangeDistance=r1-r0;let rawStep,step,inset;count===1?(paddingInner=0,rawStep=rangeDistance*(1-paddingOuter*2),step=round3?Math.round(rawStep):rawStep,inset=rangeDistance*paddingOuter):(rawStep=rangeDistance/Math.max(1,count-paddingInner+paddingOuter*2),step=round3?Math.floor(rawStep):rawStep,inset=r0+(rangeDistance-step*(count-paddingInner))/2);let bandwidth=step*(1-paddingInner);round3&&(inset=Math.round(inset),bandwidth=Math.round(bandwidth)),this._step=step,this._inset=inset,this._bandwidth=bandwidth,this._rawBandwidth=rawStep*(1-paddingInner),this.ordinalRange=this._domain.map((_,i)=>inset+step*i)}getIndex(value){return this.index.get(value instanceof Date?value.getTime():value)}},__name(_a8,"_BandScale"),_a8);__decorateClass([Invalidating],_BandScale.prototype,"range",2);__decorateClass([Invalidating],_BandScale.prototype,"round",2);__decorateClass([Invalidating],_BandScale.prototype,"interval",2);var BandScale=_BandScale,_a9,BaseProperties=(_a9=class{set(properties){const{className=this.constructor.name}=this.constructor;if(typeof properties!="object")return Logger.warn(`unable to set ${className} - expecting a properties object`),this;const keys=new Set(Object.keys(properties));for(const propertyKey of listDecoratedProperties(this))if(keys.has(propertyKey)){const value=properties[propertyKey],self=this;if(isProperties(self[propertyKey]))if(self[propertyKey]instanceof PropertiesArray){const array2=self[propertyKey].reset(value);array2!=null?self[propertyKey]=array2:Logger.warn(`unable to set [${propertyKey}] - expecting a properties array`)}else self[propertyKey].set(value);else self[propertyKey]=value;keys.delete(propertyKey)}for(const unknownKey of keys)Logger.warn(`unable to set [${unknownKey}] in ${className} - property is unknown`);return this}isValid(warningPrefix){return listDecoratedProperties(this).every(propertyKey=>{const{optional}=extractDecoratedPropertyMetadata(this,propertyKey),valid=optional===!0||typeof this[propertyKey]<"u";return valid||Logger.warnOnce(`${warningPrefix??""}[${propertyKey}] is required.`),valid})}toJson(){return listDecoratedProperties(this).reduce((object2,propertyKey)=>{const propertyValue=this[propertyKey];return object2[propertyKey]=isProperties(propertyValue)?propertyValue.toJson():propertyValue,object2},{})}},__name(_a9,"BaseProperties"),_a9),_a10,PropertiesArray=(_a10=class extends Array{constructor(itemFactory,...properties){super(properties.length);const value=__name(value2=>{var _a274,_b;return!!((_b=(_a274=value2==null?void 0:value2.prototype)==null?void 0:_a274.constructor)!=null&&_b.name)},"isConstructor")(itemFactory)?params=>new itemFactory().set(params):itemFactory;Object.defineProperty(this,"itemFactory",{value,enumerable:!1,configurable:!1}),this.set(properties)}set(properties){if(isArray(properties)){this.length=properties.length;for(let i=0;i<properties.length;i++)this[i]=this.itemFactory(properties[i])}return this}reset(properties){if(Array.isArray(properties))return new _a10(this.itemFactory,...properties)}toJson(){return this.map(value=>{var _a274;return((_a274=value==null?void 0:value.toJson)==null?void 0:_a274.call(value))??value})}},__name(_a10,"_PropertiesArray"),_a10);function isProperties(value){return value instanceof BaseProperties||value instanceof PropertiesArray}__name(isProperties,"isProperties");function Validate(predicate,options={}){const{optional=!1,property:overrideProperty}=options;return addTransformToInstanceProperty((target,property,value)=>{const context={...options,target,property};if(optional&&typeof value>"u"||predicate(value,context))return isProperties(target[property])&&!isProperties(value)?(target[property].set(value),target[property]):value;const cleanKey=overrideProperty??String(property).replace(/^_*/,""),targetName=target.constructor.className??target.constructor.name.replace(/Properties$/,"");let valueString=stringify(value);const maxLength=50;if(valueString!=null&&valueString.length>maxLength){const excessCharacters=valueString.length-maxLength;valueString=valueString.slice(0,maxLength)+`... (+${excessCharacters} characters)`}return Logger.warn(`Property [${cleanKey}] of [${targetName}] cannot be set to [${valueString}]${predicate.message?`; expecting ${getPredicateMessage(predicate,context)}`:""}, ignoring.`),BREAK_TRANSFORM_CHAIN},void 0,{optional})}__name(Validate,"Validate");var AND=__name((...predicates)=>{const messages=[];return predicateWithMessage((value,ctx)=>(messages.length=0,predicates.every(predicate=>{const isValid2=predicate(value,ctx);return isValid2||messages.push(getPredicateMessage(predicate,ctx)),isValid2})),()=>messages.filter(Boolean).join(" AND "))},"AND"),OR=__name((...predicates)=>predicateWithMessage((value,ctx)=>predicates.some(predicate=>predicate(value,ctx)),ctx=>predicates.map(getPredicateMessageMapper(ctx)).filter(Boolean).join(" OR ")),"OR"),OBJECT=attachObjectRestrictions(predicateWithMessage((value,ctx)=>isProperties(value)||isObject(value)&&isProperties(ctx.target[ctx.property]),"a properties object")),PLAIN_OBJECT=attachObjectRestrictions(predicateWithMessage(value=>isObject(value),"an object")),BOOLEAN=predicateWithMessage(isBoolean,"a boolean"),FUNCTION=predicateWithMessage(isFunction,"a function"),STRING=predicateWithMessage(isString,"a string"),NUMBER=attachNumberRestrictions(predicateWithMessage(isFiniteNumber,"a number")),REAL_NUMBER=predicateWithMessage(value=>isNumber(value)&&!isNaN(value),"a real number"),NAN=predicateWithMessage(value=>isNumber(value)&&isNaN(value),"NaN"),POSITIVE_NUMBER=NUMBER.restrict({min:0}),RATIO=NUMBER.restrict({min:0,max:1}),DEGREE=NUMBER.restrict({min:-360,max:360}),NUMBER_OR_NAN=OR(NUMBER,NAN),ARRAY=attachArrayRestrictions(predicateWithMessage(isArray,"an array")),ARRAY_OF=__name((predicate,message)=>predicateWithMessage((value,ctx)=>isArray(value)&&value.every(item=>predicate(item,ctx)),ctx=>{const arrayMessage=getPredicateMessage(ARRAY,ctx)??"";return message?`${arrayMessage} of ${message}`:arrayMessage}),"ARRAY_OF"),isComparable=__name(value=>isFiniteNumber(value)||isValidDate(value),"isComparable"),LESS_THAN=__name(otherField=>predicateWithMessage((v,ctx)=>!isComparable(v)||!isComparable(ctx.target[otherField])||v<ctx.target[otherField],`to be less than ${otherField}`),"LESS_THAN"),GREATER_THAN=__name(otherField=>predicateWithMessage((v,ctx)=>!isComparable(v)||!isComparable(ctx.target[otherField])||v>ctx.target[otherField],`to be greater than ${otherField}`),"GREATER_THAN"),DATE=predicateWithMessage(isValidDate,"Date object"),DATE_OR_DATETIME_MS=OR(DATE,POSITIVE_NUMBER),colorMessage="A color string can be in one of the following formats to be valid: #rgb, #rrggbb, rgb(r, g, b), rgba(r, g, b, a) or a CSS color name such as 'white', 'orange', 'cyan', etc",COLOR_STRING=predicateWithMessage(v=>isString(v)&&Color.validColorString(v),`color String. ${colorMessage}`),COLOR_STRING_ARRAY=predicateWithMessage(ARRAY_OF(COLOR_STRING),`color strings. ${colorMessage}`),BOOLEAN_ARRAY=ARRAY_OF(BOOLEAN,"boolean values"),NUMBER_ARRAY=ARRAY_OF(NUMBER,"numbers"),STRING_ARRAY=ARRAY_OF(STRING,"strings"),DATE_ARRAY=predicateWithMessage(ARRAY_OF(DATE),"Date objects"),OBJECT_ARRAY=predicateWithMessage(ARRAY_OF(OBJECT),"objects"),LINE_CAP=UNION(["butt","round","square"],"a line cap"),LINE_JOIN=UNION(["round","bevel","miter"],"a line join"),LINE_STYLE=UNION(["solid","dashed","dotted"],"a line style"),LINE_DASH=predicateWithMessage(ARRAY_OF(POSITIVE_NUMBER),"numbers specifying the length in pixels of alternating dashes and gaps, for example, [6, 3] means dashes with a length of 6 pixels with gaps between of 3 pixels."),POSITION=UNION(["top","right","bottom","left"],"a position"),FONT_STYLE=UNION(["normal","italic","oblique"],"a font style"),FONT_WEIGHT=OR(UNION(["normal","bold","bolder","lighter"],"a font weight"),NUMBER.restrict({min:1,max:1e3})),TEXT_WRAP=UNION(["never","always","hyphenate","on-space"],"a text wrap strategy"),TEXT_ALIGN=UNION(["left","center","right"],"a text align"),VERTICAL_ALIGN=UNION(["top","middle","bottom"],"a vertical align"),OVERFLOW_STRATEGY=UNION(["ellipsis","hide"],"an overflow strategy"),DIRECTION=UNION(["horizontal","vertical"],"a direction"),PLACEMENT=UNION(["inside","outside"],"a placement"),INTERACTION_RANGE=OR(UNION(["exact","nearest"],"interaction range"),NUMBER),LABEL_PLACEMENT=UNION(["top","bottom","left","right"]);function UNION(options,message="a"){return predicateWithMessage(v=>options.includes(v),`${message} keyword such as ${joinUnionOptions(options)}`)}__name(UNION,"UNION");var MIN_SPACING=OR(AND(NUMBER.restrict({min:1}),LESS_THAN("maxSpacing")),NAN),MAX_SPACING=OR(AND(NUMBER.restrict({min:1}),GREATER_THAN("minSpacing")),NAN);function predicateWithMessage(predicate,message){return predicate.message=message,predicate}__name(predicateWithMessage,"predicateWithMessage");function joinUnionOptions(options){const values=options.map(option=>`'${option}'`);if(values.length===1)return values[0];const lastValue=values.pop();return`${values.join(", ")} or ${lastValue}`}__name(joinUnionOptions,"joinUnionOptions");function getPredicateMessage(predicate,ctx){return isFunction(predicate.message)?predicate.message(ctx):predicate.message}__name(getPredicateMessage,"getPredicateMessage");function getPredicateMessageMapper(ctx){return predicate=>getPredicateMessage(predicate,ctx)}__name(getPredicateMessageMapper,"getPredicateMessageMapper");function attachArrayRestrictions(predicate){return Object.assign(predicate,{restrict({length:length2,minLength}={}){let message="an array";return isNumber(minLength)&&minLength>0?message="a non-empty array":isNumber(length2)&&(message=`an array of length ${length2}`),predicateWithMessage(value=>isArray(value)&&(isNumber(length2)?value.length===length2:!0)&&(isNumber(minLength)?value.length>=minLength:!0),message)}})}__name(attachArrayRestrictions,"attachArrayRestrictions");function attachNumberRestrictions(predicate){return Object.assign(predicate,{restrict({min,max}={}){const message=["a number"],hasMin=isNumber(min),hasMax=isNumber(max);return hasMin&&hasMax?message.push(`between ${min} and ${max} inclusive`):hasMin?message.push(`greater than or equal to ${min}`):hasMax&&message.push(`less than or equal to ${max}`),predicateWithMessage(value=>isFiniteNumber(value)&&(hasMin?value>=min:!0)&&(hasMax?value<=max:!0),message.join(" "))}})}__name(attachNumberRestrictions,"attachNumberRestrictions");function attachObjectRestrictions(predicate){return Object.assign(predicate,{restrict(objectType){return predicateWithMessage(value=>value instanceof objectType,ctx=>getPredicateMessage(predicate,ctx)??`an instance of ${objectType.name}`)}})}__name(attachObjectRestrictions,"attachObjectRestrictions");function stringify(value){if(typeof value=="number"){if(isNaN(value))return"NaN";if(value===1/0)return"Infinity";if(value===-1/0)return"-Infinity"}return JSON.stringify(value)}__name(stringify,"stringify");var ChartAxisDirection=(ChartAxisDirection2=>(ChartAxisDirection2.X="x",ChartAxisDirection2.Y="y",ChartAxisDirection2))(ChartAxisDirection||{}),_a11,ModuleMap=(_a11=class{constructor(){this.moduleMap=new Map}*modules(){for(const m of this.moduleMap.values())yield m.moduleInstance}addModule(module,moduleFactory){if(this.moduleMap.has(module.optionsKey))throw new Error(`AG Charts - module already initialised: ${module.optionsKey}`);this.moduleMap.set(module.optionsKey,{module,moduleInstance:moduleFactory(module)})}removeModule(module){var _a274;const moduleKey=isString(module)?module:module.optionsKey;(_a274=this.moduleMap.get(moduleKey))==null||_a274.moduleInstance.destroy(),this.moduleMap.delete(moduleKey)}getModule(module){var _a274;return(_a274=this.moduleMap.get(isString(module)?module:module.optionsKey))==null?void 0:_a274.moduleInstance}isEnabled(module){return this.moduleMap.has(isString(module)?module:module.optionsKey)}mapModules(callback2){return Array.from(this.moduleMap.values(),(m,i)=>callback2(m.moduleInstance,i))}destroy(){var _a274;for(const moduleKey of this.moduleMap.keys())(_a274=this.moduleMap.get(moduleKey))==null||_a274.moduleInstance.destroy();this.moduleMap.clear()}},__name(_a11,"ModuleMap"),_a11),resetMotion_exports={};__export(resetMotion_exports,{resetMotion:__name(()=>resetMotion,"resetMotion")});function resetMotion(selectionsOrNodes,propsFn){const{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes);for(const selection of selections){for(const node of selection.nodes()){const from2=propsFn(node,node.datum);node.setProperties(from2)}selection.cleanup()}for(const node of nodes){const from2=propsFn(node,node.datum);node.setProperties(from2)}}__name(resetMotion,"resetMotion");var _a12,_ContinuousScale=(_a12=class{constructor(domain,range3){this.invalid=!0,this.nice=!1,this.interval=void 0,this.tickCount=_a12.defaultTickCount,this.minTickCount=0,this.maxTickCount=1/0,this.niceDomain=[],this.defaultClampMode="raw",this.domain=domain,this.range=range3}static is(value){return value instanceof _a12}transform(x){return x}transformInvert(x){return x}calcBandwidth(smallestInterval=1){const domain=this.getDomain(),rangeDistance=this.getPixelRange(),intervals=Math.abs(domain[1]-domain[0])/smallestInterval+1,maxBands=Math.floor(rangeDistance),bands=Math.min(intervals,maxBands);return rangeDistance/Math.max(1,bands)}getDomain(){return this.nice&&(this.refresh(),this.niceDomain.length)?this.niceDomain:this.domain}convert(x,opts){const clampMode=(opts==null?void 0:opts.clampMode)??this.defaultClampMode;if(!this.domain||this.domain.length<2)return NaN;this.refresh();const domain=this.getDomain().map(d=>this.transform(d)),[d0,d1]=domain,{range:range3}=this,[r0,r1]=range3;if(x=this.transform(x),clampMode==="clamped"){const[start,stop]=findMinMax(domain.map(Number));if(Number(x)<start)return r0;if(Number(x)>stop)return r1}return d0===d1?(r0+r1)/2:x===d0?r0:x===d1?r1:r0+(Number(x)-Number(d0))/(Number(d1)-Number(d0))*(r1-r0)}invert(x){this.refresh();const domain=this.getDomain().map(d2=>this.transform(d2)),[d0,d1]=domain,{range:range3}=this,[r0,r1]=range3,isReversed=r0>r1,rMin=isReversed?r1:r0,rMax=isReversed?r0:r1;let d;return x<rMin?isReversed?d1:d0:x>rMax?isReversed?d0:d1:(r0===r1?d=this.toDomain((Number(d0)+Number(d1))/2):d=this.toDomain(Number(d0)+(x-r0)/(r1-r0)*(Number(d1)-Number(d0))),this.transformInvert(d))}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}getPixelRange(){const[a,b]=this.range;return Math.abs(b-a)}},__name(_a12,"_ContinuousScale"),_a12);_ContinuousScale.defaultTickCount=5;_ContinuousScale.defaultMaxTickCount=6;__decorateClass([Invalidating],_ContinuousScale.prototype,"domain",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"range",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"nice",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"interval",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"tickCount",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"minTickCount",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"maxTickCount",2);var ContinuousScale=_ContinuousScale;function parseFormat(format){let prefix,suffix;const surrounded=surroundedRegEx.exec(format);surrounded&&([,prefix,format,suffix]=surrounded);const match=formatRegEx.exec(format);if(!match)throw new Error(`The number formatter is invalid: ${format}`);const[,fill,align,sign,symbol,zero,width,comma,precision,trim,type]=match;return{fill,align,sign,symbol,zero,width:parseInt(width),comma,precision:parseInt(precision),trim:!!trim,type,prefix,suffix}}__name(parseFormat,"parseFormat");function numberFormat(format){const options=typeof format=="string"?parseFormat(format):format,{fill,align,sign="-",symbol,zero,width,comma,type,prefix="",suffix="",precision}=options;let{trim}=options;const precisionIsNaN=precision==null||isNaN(precision);let formatBody;if(!type)formatBody=decimalTypes.g,trim=!0;else if(type in decimalTypes&&type in integerTypes)formatBody=precisionIsNaN?integerTypes[type]:decimalTypes[type];else if(type in decimalTypes)formatBody=decimalTypes[type];else if(type in integerTypes)formatBody=integerTypes[type];else throw new Error(`The number formatter type is invalid: ${type}`);let formatterPrecision;return precision==null||precisionIsNaN?formatterPrecision=type?6:12:formatterPrecision=precision,n=>{let result=formatBody(n,formatterPrecision);return trim&&(result=removeTrailingZeros(result)),comma&&(result=insertSeparator(result,comma)),result=addSign(n,result,sign),symbol&&symbol!=="#"&&(result=`${symbol}${result}`),symbol==="#"&&type==="x"&&(result=`0x${result}`),type==="s"&&(result=`${result}${getSIPrefix(n)}`),(type==="%"||type==="p")&&(result=`${result}%`),width!=null&&!isNaN(width)&&(result=addPadding(result,width,fill??zero,align)),result=`${prefix}${result}${suffix}`,result}}__name(numberFormat,"numberFormat");var formatRegEx=/^(?:(.)?([<>=^]))?([+\-( ])?([$€£¥₣₹#])?(0)?(\d+)?(,)?(?:\.(\d+))?(~)?([%a-z])?$/i,surroundedRegEx=/^((?:[^#]|#[^{])*)#{([^}]+)}(.*)$/,integerTypes={b:__name(n=>absFloor(n).toString(2),"b"),c:__name(n=>String.fromCharCode(n),"c"),d:__name(n=>Math.round(Math.abs(n)).toFixed(0),"d"),o:__name(n=>absFloor(n).toString(8),"o"),x:__name(n=>absFloor(n).toString(16),"x"),X:__name(n=>integerTypes.x(n).toUpperCase(),"X"),n:__name(n=>integerTypes.d(n),"n"),"%":__name(n=>`${absFloor(n*100).toFixed(0)}`,"%")},decimalTypes={e:__name((n,f)=>Math.abs(n).toExponential(f),"e"),E:__name((n,f)=>decimalTypes.e(n,f).toUpperCase(),"E"),f:__name((n,f)=>Math.abs(n).toFixed(f),"f"),F:__name((n,f)=>decimalTypes.f(n,f).toUpperCase(),"F"),g:__name((n,f)=>{if(n===0)return"0";const a=Math.abs(n),p=Math.floor(Math.log10(a));return p>=-4&&p<f?a.toFixed(f-1-p):a.toExponential(f-1)},"g"),G:__name((n,f)=>decimalTypes.g(n,f).toUpperCase(),"G"),n:__name((n,f)=>decimalTypes.g(n,f),"n"),p:__name((n,f)=>decimalTypes.r(n*100,f),"p"),r:__name((n,f)=>{if(n===0)return"0";const a=Math.abs(n),q=Math.floor(Math.log10(a))-(f-1);if(q<=0)return a.toFixed(-q);const x=10**q;return(Math.round(a/x)*x).toFixed()},"r"),s:__name((n,f)=>{const p=getSIPrefixPower(n);return decimalTypes.r(n/10**p,f)},"s"),"%":__name((n,f)=>decimalTypes.f(n*100,f),"%")},minSIPrefix=-24,maxSIPrefix=24,siPrefixes={[minSIPrefix]:"y",[-21]:"z",[-18]:"a",[-15]:"f",[-12]:"p",[-9]:"n",[-6]:"µ",[-3]:"m",0:"",3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",[maxSIPrefix]:"Y"},minusSign="−";function absFloor(n){return Math.floor(Math.abs(n))}__name(absFloor,"absFloor");function removeTrailingZeros(numString){return numString.replace(/\.0+$/,"").replace(/(\.[1-9])0+$/,"$1")}__name(removeTrailingZeros,"removeTrailingZeros");function insertSeparator(numString,separator){let dotIndex=numString.indexOf(".");dotIndex<0&&(dotIndex=numString.length);const integerChars=numString.substring(0,dotIndex).split(""),fractionalPart=numString.substring(dotIndex);for(let i=integerChars.length-3;i>0;i-=3)integerChars.splice(i,0,separator);return`${integerChars.join("")}${fractionalPart}`}__name(insertSeparator,"insertSeparator");function getSIPrefix(n){return siPrefixes[getSIPrefixPower(n)]}__name(getSIPrefix,"getSIPrefix");function getSIPrefixPower(n){return clamp(minSIPrefix,n?Math.floor(Math.log10(Math.abs(n))/3)*3:0,maxSIPrefix)}__name(getSIPrefixPower,"getSIPrefixPower");function addSign(num,numString,signType=""){if(signType==="(")return num>=0?numString:`(${numString})`;const plusSign=signType==="+"?"+":"";return`${num>=0?plusSign:minusSign}${numString}`}__name(addSign,"addSign");function addPadding(numString,width,fill=" ",align=">"){let result=numString;if(align===">"||!align)result=result.padStart(width,fill);else if(align==="<")result=result.padEnd(width,fill);else if(align==="^"){const padWidth=Math.max(0,width-result.length),padLeft=Math.ceil(padWidth/2),padRight=Math.floor(padWidth/2);result=result.padStart(padLeft+result.length,fill),result=result.padEnd(padRight+result.length,fill)}return result}__name(addPadding,"addPadding");var tInterval=__name((timeInterval,baseDuration,step)=>({duration:baseDuration*step,timeInterval,step}),"tInterval"),TickIntervals=[tInterval(second_default,durationSecond,1),tInterval(second_default,durationSecond,5),tInterval(second_default,durationSecond,15),tInterval(second_default,durationSecond,30),tInterval(minute_default,durationMinute,1),tInterval(minute_default,durationMinute,5),tInterval(minute_default,durationMinute,15),tInterval(minute_default,durationMinute,30),tInterval(hour_default,durationHour,1),tInterval(hour_default,durationHour,3),tInterval(hour_default,durationHour,6),tInterval(hour_default,durationHour,12),tInterval(day_default,durationDay,1),tInterval(day_default,durationDay,2),tInterval(week_default,durationWeek,1),tInterval(week_default,durationWeek,2),tInterval(week_default,durationWeek,3),tInterval(month_default,durationMonth,1),tInterval(month_default,durationMonth,2),tInterval(month_default,durationMonth,3),tInterval(month_default,durationMonth,4),tInterval(month_default,durationMonth,6),tInterval(year_default,durationYear,1)],TickMultipliers=[1,2,5,10];function isCloseToInteger(n,delta4){return Math.abs(Math.round(n)-n)<delta4}__name(isCloseToInteger,"isCloseToInteger");function createTicks(start,stop,count,minCount,maxCount){if(count<2)return[start,stop];const step=tickStep(start,stop,count,minCount,maxCount);return Number.isFinite(step)?(isCloseToInteger(start/step,1e-12)||(start=Math.ceil(start/step)*step),isCloseToInteger(stop/step,1e-12)||(stop=Math.floor(stop/step)*step),range(start,stop,step)):[]}__name(createTicks,"createTicks");function getTickInterval(start,stop,count,minCount,maxCount,targetInterval){const target=Math.abs(stop-start)/Math.max(count,1);let i=0;for(const tickInterval of TickIntervals){if(target<=tickInterval.duration)break;i++}if(i===0){const step2=Math.max(tickStep(start,stop,count,minCount,maxCount),1);return millisecond_default.every(step2)}else if(i===TickIntervals.length){const step2=tickStep(start/durationYear,stop/durationYear,count,minCount,maxCount);return year_default.every(step2)}const i0=TickIntervals[i-1],i1=TickIntervals[i],{timeInterval,step}=target-i0.duration<i1.duration-target?i0:i1;return timeInterval.every(step)}__name(getTickInterval,"getTickInterval");function tickStep(start,end,count,minCount=0,maxCount=1/0){if(start===end)return clamp(1,minCount,maxCount);if(count<1)return NaN;const extent2=Math.abs(end-start),step=10**Math.floor(Math.log10(extent2/count));let m=NaN,minDiff=1/0,isInBounds=!1;for(const multiplier of TickMultipliers){const c=Math.ceil(extent2/(multiplier*step)),validBounds=c>=minCount&&c<=maxCount;if(isInBounds&&!validBounds)continue;const diffCount=Math.abs(c-count);(minDiff>diffCount||isInBounds!==validBounds)&&(isInBounds||(isInBounds=validBounds),minDiff=diffCount,m=multiplier)}return m*step}__name(tickStep,"tickStep");function decimalPlaces(decimal){for(let i=decimal.length-1;i>=0;i-=1)if(decimal[i]!=="0")return i+1;return 0}__name(decimalPlaces,"decimalPlaces");function tickFormat(ticks,format){const options=parseFormat(format??",f");(options.precision==null||isNaN(options.precision))&&(!options.type||"eEFgGnprs".includes(options.type)?options.precision=Math.max(...ticks.map(x=>{if(!Number.isFinite(x))return 0;const[integer,decimal]=x.toExponential((options.type?6:12)-1).split(/\.|e/g);return(integer!=="1"&&integer!=="-1"?1:0)+decimalPlaces(decimal)+1})):"f%".includes(options.type)&&(options.precision=Math.max(...ticks.map(x=>{if(!Number.isFinite(x)||x===0)return 0;const l=Math.floor(Math.log10(Math.abs(x))),digits=options.type?6:12,decimal=x.toExponential(digits-1).split(/\.|e/g)[1],decimalLength=decimalPlaces(decimal);return Math.max(0,decimalLength-l)}))));const formatter=numberFormat(options);return n=>formatter(Number(n))}__name(tickFormat,"tickFormat");function range(start,end,step){if(!Number.isFinite(step)||step<=0)return[];const f=10**countFractionDigits(step),d0=Math.min(start,end),d1=Math.max(start,end),out=[];for(let i=0;;i+=1){const p=Math.round((d0+step*i)*f)/f;if(p<=d1)out.push(p);else break}return out}__name(range,"range");function isDenseInterval(count,availableRange){return count>=availableRange?(Logger.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}__name(isDenseInterval,"isDenseInterval");function niceTicksDomain(start,end){const extent2=Math.abs(end-start),step=10**Math.floor(Math.log10(extent2));let minError=1/0,ticks=[start,end];for(const multiplier of TickMultipliers){const m=multiplier*step,d0=Math.floor(start/m)*m,d1=Math.ceil(end/m)*m,error=1-extent2/Math.abs(d1-d0);minError>error&&(minError=error,ticks=[d0,d1])}return ticks}__name(niceTicksDomain,"niceTicksDomain");function estimateTickCount(rangeExtent,minSpacing,maxSpacing,defaultTickCount,defaultMinSpacing){defaultMinSpacing=Math.max(defaultMinSpacing,rangeExtent/(defaultTickCount+1)),isNaN(minSpacing)&&(minSpacing=defaultMinSpacing),isNaN(maxSpacing)&&(maxSpacing=rangeExtent),minSpacing>maxSpacing&&(minSpacing===defaultMinSpacing?minSpacing=maxSpacing:maxSpacing=minSpacing);const maxTickCount=clamp(1,Math.floor(rangeExtent/minSpacing),Math.min(Math.floor(rangeExtent),100)),minTickCount=Math.min(maxTickCount,Math.ceil(rangeExtent/maxSpacing)),tickCount=clamp(minTickCount,defaultTickCount,maxTickCount);return{minTickCount,maxTickCount,tickCount}}__name(estimateTickCount,"estimateTickCount");var _a13,_LogScale=(_a13=class extends ContinuousScale{constructor(){super([1,10],[0,1]),this.type="log",this.base=10,this.baseLog=identity,this.basePow=identity,this.log=x=>Math.min(...this.domain)>=0?this.baseLog(x):-this.baseLog(-x),this.pow=x=>Math.min(...this.domain)>=0?this.basePow(x):-this.basePow(-x),this.defaultClampMode="clamped"}toDomain(d){return d}transform(x){return Math.min(...this.domain)>=0?Math.log(x):-Math.log(-x)}transformInvert(x){return Math.min(...this.domain)>=0?Math.exp(x):-Math.exp(-x)}refresh(){this.base<=0&&(this.base=0,Logger.warnOnce("expecting a finite Number greater than to 0")),super.refresh()}update(){!this.domain||this.domain.length<2||(this.baseLog=_a13.getBaseLogMethod(this.base),this.basePow=_a13.getBasePowerMethod(this.base),this.nice&&this.updateNiceDomain())}updateNiceDomain(){const[d0,d1]=this.domain,roundStart=d0>d1?Math.ceil:Math.floor,roundStop=d0>d1?Math.floor:Math.ceil,n0=this.pow(roundStart(this.log(d0))),n1=this.pow(roundStop(this.log(d1)));this.niceDomain=[n0,n1]}ticks(){const count=this.tickCount??10;if(!this.domain||this.domain.length<2||count<1)return[];this.refresh();const base=this.base,[d0,d1]=this.getDomain(),start=Math.min(d0,d1),stop=Math.max(d0,d1);let p0=this.log(start),p1=this.log(stop);if(this.interval){const inBounds=__name(tick=>tick>=start&&tick<=stop,"inBounds"),step=Math.min(Math.abs(this.interval),Math.abs(p1-p0)),ticks2=range(p0,p1,step).map(this.pow).filter(inBounds);if(!isDenseInterval(ticks2.length,this.getPixelRange()))return ticks2}const isBaseInteger=base%1===0,isDiffLarge=p1-p0>=count;if(!isBaseInteger||isDiffLarge)return createTicks(p0,p1,Math.min(p1-p0,count)).map(this.pow);const ticks=[],isPositive=start>0;p0=Math.floor(p0)-1,p1=Math.round(p1)+1;const availableSpacing=findRangeExtent(this.range)/count;let lastTickPosition=1/0;for(let p=p0;p<=p1;p++){const nextMagnitudeTickPosition=this.convert(this.pow(p+1));for(let k=1;k<base;k++){const q=isPositive?k:base-k+1,t=this.pow(p)*q,tickPosition=this.convert(t),prevSpacing=Math.abs(lastTickPosition-tickPosition),nextSpacing=Math.abs(tickPosition-nextMagnitudeTickPosition),fits=prevSpacing>=availableSpacing&&nextSpacing>=availableSpacing;t>=start&&t<=stop&&(k===1||fits||ticks.length===0)&&(ticks.push(t),lastTickPosition=tickPosition)}}return ticks}tickFormat({count,ticks,specifier}){return count!==1/0&&ticks==null&&this.ticks(),specifier??(specifier=this.base===10?".0e":","),isString(specifier)?numberFormat(specifier):specifier}static getBaseLogMethod(base){switch(base){case 10:return Math.log10;case Math.E:return Math.log;case 2:return Math.log2;default:const logBase=Math.log(base);return x=>Math.log(x)/logBase}}static getBasePowerMethod(base){switch(base){case 10:return x=>x>=0?10**x:1/10**-x;case Math.E:return Math.exp;default:return x=>base**x}}},__name(_a13,"_LogScale"),_a13);__decorateClass([Invalidating],_LogScale.prototype,"base",2);var LogScale=_LogScale;function extent(values){if(values.length===0)return null;let min=1/0,max=-1/0;for(let n of values)n instanceof Date&&(n=n.getTime()),typeof n=="number"&&(n<min&&(min=n),n>max&&(max=n));const result=[min,max];return result.every(isFinite)?result:null}__name(extent,"extent");function normalisedExtentWithMetadata(d,min,max){let clipped=!1;return d.length>2&&(d=extent(d)??[NaN,NaN]),isNaN(min)||(clipped||(clipped=min>d[0]),d=[min,d[1]]),isNaN(max)||(clipped||(clipped=max<d[1]),d=[d[0],max]),d[0]>d[1]&&(d=[]),{extent:d,clipped}}__name(normalisedExtentWithMetadata,"normalisedExtentWithMetadata");function arraysEqual(a,b){if(a==null||b==null||a.length!==b.length)return!1;for(let i=0;i<a.length;i++)if(Array.isArray(a[i])&&Array.isArray(b[i])){if(!arraysEqual(a[i],b[i]))return!1}else if(a[i]!==b[i])return!1;return!0}__name(arraysEqual,"arraysEqual");function toArray(value){return typeof value>"u"?[]:Array.isArray(value)?value:[value]}__name(toArray,"toArray");function unique(array2){return Array.from(new Set(array2))}__name(unique,"unique");function groupBy(array2,iteratee){return array2.reduce((result,item)=>{const groupKey=iteratee(item);return result[groupKey]??(result[groupKey]=[]),result[groupKey].push(item),result},{})}__name(groupBy,"groupBy");function circularSliceArray(data,size,offset4=0){if(data.length===0)return[];const result=[];for(let i=0;i<size;i++)result.push(data.at((i+offset4)%data.length));return result}__name(circularSliceArray,"circularSliceArray");var _a14,TimeScale=(_a14=class extends ContinuousScale{constructor(){super([],[0,1]),this.type="time"}toDomain(d){return new Date(d)}convert(x,opts){return super.convert(new Date(x),opts)}invert(y){return new Date(super.invert(y))}ticks(){if(!this.domain||this.domain.length<2)return[];this.refresh();const{interval,nice,tickCount,minTickCount,maxTickCount}=this,[start,stop]=findMinMax(this.getDomain().map(dateToNumber));return interval!=null?_a14.getTicksForInterval({start,stop,interval,availableRange:this.getPixelRange()})??_a14.getDefaultTicks({start,stop,tickCount,minTickCount,maxTickCount}):nice&&tickCount===2?this.niceDomain:nice&&tickCount===1?this.niceDomain.slice(0,1):_a14.getDefaultTicks({start,stop,tickCount,minTickCount,maxTickCount})}static getDefaultTicks({start,stop,tickCount,minTickCount,maxTickCount}){const t=getTickInterval(start,stop,tickCount,minTickCount,maxTickCount);return t?t.range(new Date(start),new Date(stop)):[]}static getTicksForInterval({start,stop,interval,availableRange}){if(!interval)return[];if(interval instanceof TimeInterval){const ticks2=interval.range(new Date(start),new Date(stop));return isDenseInterval(ticks2.length,availableRange)?void 0:ticks2}const absInterval=Math.abs(interval);if(isDenseInterval((stop-start)/absInterval,availableRange))return;const timeInterval=TickIntervals.findLast(tickInterval=>absInterval%tickInterval.duration===0);if(timeInterval)return timeInterval.timeInterval.every(absInterval/(timeInterval.duration/timeInterval.step)).range(new Date(start),new Date(stop));let date=new Date(start);const stopDate=new Date(stop),ticks=[];for(;date<=stopDate;)ticks.push(date),date=new Date(date),date.setMilliseconds(date.getMilliseconds()+absInterval);return ticks}tickFormat({ticks,domain,specifier,formatOffset}){return specifier==null?defaultTimeTickFormat(ticks,domain,formatOffset):buildFormatter(specifier)}update(){!this.domain||this.domain.length<2||this.nice&&this.updateNiceDomain()}updateNiceDomain(){let[d0,d1]=this.domain;for(let i=0;i<4;i++){this.updateNiceDomainIteration(d0,d1);const[n0,n1]=this.niceDomain;if(dateToNumber(d0)===dateToNumber(n0)&&dateToNumber(d1)===dateToNumber(n1))break;d0=n0,d1=n1}}updateNiceDomainIteration(d0,d1){const start=Math.min(dateToNumber(d0),dateToNumber(d1)),stop=Math.max(dateToNumber(d0),dateToNumber(d1)),isReversed=d0>d1,{interval}=this;let i;if(interval instanceof TimeInterval)i=interval;else{const tickCount=typeof interval=="number"?(stop-start)/Math.max(interval,1):this.tickCount;i=getTickInterval(start,stop,tickCount,this.minTickCount,this.maxTickCount)}if(i){const intervalRange=i.range(new Date(start),new Date(stop),!0),domain=isReversed?[...intervalRange].reverse():intervalRange,n0=domain[0],n1=domain.at(-1);this.niceDomain=[n0,n1]}}},__name(_a14,"_TimeScale"),_a14);function compareNumbers(a,b){return a-b}__name(compareNumbers,"compareNumbers");var _a15,_OrdinalTimeScale=(_a15=class extends BandScale{constructor(){super(...arguments),this.type="ordinal-time",this.tickCount=ContinuousScale.defaultTickCount,this.minTickCount=0,this.maxTickCount=1/0,this.interval=void 0,this._domain=[],this.timestamps=[],this.sortedTimestamps=[],this.visibleRange=[0,1]}static is(value){return value instanceof _a15}setVisibleRange(visibleRange){this.visibleRange=visibleRange}set domain(values){if(this.invalid=!0,values.length===0){this._domain=[];return}this._domain=values,this.timestamps=unique(values.map(dateToNumber)),this.sortedTimestamps=this.timestamps.slice().sort(compareNumbers)}get domain(){return this._domain}ticks(){this.refresh();const[t0,t1]=[this.timestamps[0],this.timestamps.at(-1)],start=Math.min(t0,t1),stop=Math.max(t0,t1),isReversed=t0>t1;let ticks;if(this.interval==null)ticks=this.getDefaultTicks(this.maxTickCount,isReversed);else{const[r0,r1]=this.range,availableRange=Math.abs(r1-r0);ticks=TimeScale.getTicksForInterval({start,stop,interval:this.interval,availableRange})??[]}const tickPositions=new Set;return ticks.filter(tick=>{const position=this.convert(tick);return isNaN(position)||tickPositions.has(position)?!1:(tickPositions.add(position),!0)})}getDefaultTicks(maxTickCount,isReversed){const ticks=[],count=this.timestamps.length,tickEvery=Math.ceil(count*(this.visibleRange[1]-this.visibleRange[0])/maxTickCount),tickOffset=Math.floor(tickEvery/2);for(const[index,value]of this.timestamps.entries())tickEvery>0&&(index+tickOffset)%tickEvery||(isReversed?ticks.push(new Date(this.timestamps[count-index-1])):ticks.push(new Date(value)));return ticks}convert(d){this.refresh();const n=Number(d);if(n<this.sortedTimestamps[0])return NaN;let i=this.findInterval(n);return this.timestamps[0]!==this.sortedTimestamps[0]&&(i=this.timestamps.length-i-1),this.ordinalRange[i]??NaN}findInterval(target){const{sortedTimestamps}=this;let low=0,high=sortedTimestamps.length-1;for(;low<=high;){const mid=Math.floor((low+high)/2);if(sortedTimestamps[mid]===target)return mid;sortedTimestamps[mid]<target?low=mid+1:high=mid-1}return low}tickFormat({ticks,domain,specifier}){return specifier==null?defaultTimeTickFormat(ticks,domain):buildFormatter(specifier)}invert(position){this.refresh();const index=this.ordinalRange.findIndex(p=>position<=p);return this.domain[index]}invertNearest(y){return new Date(super.invertNearest(y))}},__name(_a15,"_OrdinalTimeScale"),_a15);__decorateClass([Invalidating],_OrdinalTimeScale.prototype,"tickCount",2);__decorateClass([Invalidating],_OrdinalTimeScale.prototype,"minTickCount",2);__decorateClass([Invalidating],_OrdinalTimeScale.prototype,"maxTickCount",2);__decorateClass([Invalidating],_OrdinalTimeScale.prototype,"interval",2);var OrdinalTimeScale=_OrdinalTimeScale;function ascendingStringNumberUndefined(a,b){return typeof a=="number"&&typeof b=="number"?a-b:typeof a=="string"&&typeof b=="string"?a.localeCompare(b):a==null&&b==null?0:a==null?-1:b==null?1:String(a).localeCompare(String(b))}__name(ascendingStringNumberUndefined,"ascendingStringNumberUndefined");function toLiteral(v){return typeof v=="function"?v():v}__name(toLiteral,"toLiteral");function compoundAscending(a,b,comparator){for(const idx in a){const diff2=comparator(toLiteral(a[idx]),toLiteral(b[idx]));if(diff2!==0)return diff2}return 0}__name(compoundAscending,"compoundAscending");var IDENTITY_MATRIX_ELEMENTS=Object.freeze([1,0,0,1,0,0]);function closeValue(val,ref,errorMargin=1e-8){return val===ref||Math.abs(ref-val)<errorMargin}__name(closeValue,"closeValue");var _a16,_Matrix=(_a16=class{get e(){return[...this.elements]}constructor(elements3=[...IDENTITY_MATRIX_ELEMENTS]){this.elements=elements3}setElements(elements3){const e=this.elements;return e[0]=elements3[0],e[1]=elements3[1],e[2]=elements3[2],e[3]=elements3[3],e[4]=elements3[4],e[5]=elements3[5],this}get identity(){const e=this.elements;return closeValue(e[0],1)&&closeValue(e[1],0)&&closeValue(e[2],0)&&closeValue(e[3],1)&&closeValue(e[4],0)&&closeValue(e[5],0)}AxB(A,B,C){const a=A[0]*B[0]+A[2]*B[1],b=A[1]*B[0]+A[3]*B[1],c=A[0]*B[2]+A[2]*B[3],d=A[1]*B[2]+A[3]*B[3],e=A[0]*B[4]+A[2]*B[5]+A[4],f=A[1]*B[4]+A[3]*B[5]+A[5];C=C??A,C[0]=a,C[1]=b,C[2]=c,C[3]=d,C[4]=e,C[5]=f}multiplySelf(other){return this.AxB(this.elements,other.elements),this}multiply(other){const elements3=new Array(6);return other instanceof _a16?this.AxB(this.elements,other.elements,elements3):this.AxB(this.elements,[other.a,other.b,other.c,other.d,other.e,other.f],elements3),new _a16(elements3)}preMultiplySelf(other){return this.AxB(other.elements,this.elements,this.elements),this}inverse(){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,new _a16([d,-b,-c,a,c*f-d*e,b*e-a*f])}inverseTo(other){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,other.setElements([d,-b,-c,a,c*f-d*e,b*e-a*f]),this}invertSelf(){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,el[0]=d,el[1]=-b,el[2]=-c,el[3]=a,el[4]=c*f-d*e,el[5]=b*e-a*f,this}transformPoint(x,y){const e=this.elements;return{x:x*e[0]+y*e[2]+e[4],y:x*e[1]+y*e[3]+e[5]}}transformBBox(bbox,target){const el=this.elements,xx=el[0],xy=el[1],yx=el[2],yy=el[3],h_w=bbox.width*.5,h_h=bbox.height*.5,cx=bbox.x+h_w,cy=bbox.y+h_h,w=Math.abs(h_w*xx)+Math.abs(h_h*yx),h=Math.abs(h_w*xy)+Math.abs(h_h*yy);return target??(target=new BBox(0,0,0,0)),target.x=cx*xx+cy*yx+el[4]-w,target.y=cx*xy+cy*yy+el[5]-h,target.width=w+w,target.height=h+h,target}toContext(ctx){if(this.identity)return;const e=this.elements;ctx.transform(e[0],e[1],e[2],e[3],e[4],e[5])}static flyweight(sourceMatrix){return _a16.instance.setElements(sourceMatrix.elements)}static updateTransformMatrix(matrix,scalingX,scalingY,rotation,translationX,translationY,opts){const sx=scalingX,sy=scalingY;let scx,scy;sx===1&&sy===1?(scx=0,scy=0):(scx=(opts==null?void 0:opts.scalingCenterX)??0,scy=(opts==null?void 0:opts.scalingCenterY)??0);const r=rotation,cos=Math.cos(r),sin=Math.sin(r);let rcx,rcy;r===0?(rcx=0,rcy=0):(rcx=(opts==null?void 0:opts.rotationCenterX)??0,rcy=(opts==null?void 0:opts.rotationCenterY)??0);const tx=translationX,ty=translationY,tx4=scx*(1-sx)-rcx,ty4=scy*(1-sy)-rcy;return matrix.setElements([cos*sx,sin*sx,-sin*sy,cos*sy,cos*tx4-sin*ty4+rcx+tx,sin*tx4+cos*ty4+rcy+ty]),matrix}static fromContext(ctx){const domMatrix=ctx.getTransform();return new _a16([domMatrix.a,domMatrix.b,domMatrix.c,domMatrix.d,domMatrix.e,domMatrix.f])}},__name(_a16,"_Matrix"),_a16);_Matrix.instance=new _Matrix;var Matrix=_Matrix;function isMatrixTransform(node){return isMatrixTransformType(node.constructor)}__name(isMatrixTransform,"isMatrixTransform");var MATRIX_TRANSFORM_TYPE=Symbol("isMatrixTransform");function isMatrixTransformType(cstr){return cstr[MATRIX_TRANSFORM_TYPE]===!0}__name(isMatrixTransformType,"isMatrixTransformType");function MatrixTransform(Parent){var _a274,_b;const ParentNode=Parent;if(isMatrixTransformType(Parent))return Parent;const TRANSFORM_MATRIX=Symbol("matrix_combined_transform"),_MatrixTransformInternal=class _MatrixTransformInternal extends ParentNode{constructor(){super(...arguments),this[_b]=new Matrix,this._dirtyTransform=!0}markDirtyTransform(){this._dirtyTransform=!0,super.markDirty(this,3)}updateMatrix(_matrix){}computeTransformMatrix(){this._dirtyTransform&&(this[TRANSFORM_MATRIX].setElements(IDENTITY_MATRIX_ELEMENTS),this.updateMatrix(this[TRANSFORM_MATRIX]),this._dirtyTransform=!1)}toParent(bbox){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?bbox.clone():this[TRANSFORM_MATRIX].transformBBox(bbox)}toParentPoint(x,y){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?{x,y}:this[TRANSFORM_MATRIX].transformPoint(x,y)}fromParent(bbox){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?bbox.clone():this[TRANSFORM_MATRIX].inverse().transformBBox(bbox)}fromParentPoint(x,y){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?{x,y}:this[TRANSFORM_MATRIX].inverse().transformPoint(x,y)}computeBBox(){const bbox=super.computeBBox();return bbox&&this.toParent(bbox)}pickNode(x,y,localCoords=!1){return localCoords||({x,y}=this.fromParentPoint(x,y)),super.pickNode(x,y)}render(renderCtx){this._dirtyTransform&&(this.computeTransformMatrix(),renderCtx.forceRender||(renderCtx={...renderCtx,forceRender:"dirtyTransform"}));const matrix=this[TRANSFORM_MATRIX];let performRestore=!1;matrix.identity||(renderCtx.ctx.save(),performRestore=!0,matrix.toContext(renderCtx.ctx)),super.render(renderCtx),performRestore&&renderCtx.ctx.restore()}};__name(_MatrixTransformInternal,"MatrixTransformInternal");let MatrixTransformInternal=_MatrixTransformInternal;return _a274=MATRIX_TRANSFORM_TYPE,_b=TRANSFORM_MATRIX,MatrixTransformInternal[_a274]=!0,MatrixTransformInternal}__name(MatrixTransform,"MatrixTransform");function Rotatable(Parent){var _a274;const ParentNode=Parent,ROTATABLE_MATRIX=Symbol("matrix_rotation"),_RotatableInternal=class _RotatableInternal extends MatrixTransform(ParentNode){constructor(){super(...arguments),this[_a274]=new Matrix,this.rotationCenterX=null,this.rotationCenterY=null,this.rotation=0}updateMatrix(matrix){super.updateMatrix(matrix);const{rotation,rotationCenterX,rotationCenterY}=this;rotation!==0&&(Matrix.updateTransformMatrix(this[ROTATABLE_MATRIX],1,1,rotation,0,0,{rotationCenterX,rotationCenterY}),matrix.multiplySelf(this[ROTATABLE_MATRIX]))}};__name(_RotatableInternal,"RotatableInternal");let RotatableInternal=_RotatableInternal;return _a274=ROTATABLE_MATRIX,__decorateClass([SceneChangeDetection({type:"transform"})],RotatableInternal.prototype,"rotationCenterX",2),__decorateClass([SceneChangeDetection({type:"transform"})],RotatableInternal.prototype,"rotationCenterY",2),__decorateClass([SceneChangeDetection({type:"transform"})],RotatableInternal.prototype,"rotation",2),RotatableInternal}__name(Rotatable,"Rotatable");function Scalable(Parent){var _a274;const ParentNode=Parent,SCALABLE_MATRIX=Symbol("matrix_scale"),_ScalableInternal=class _ScalableInternal extends MatrixTransform(ParentNode){constructor(){super(...arguments),this[_a274]=new Matrix,this.scalingX=1,this.scalingY=1,this.scalingCenterX=null,this.scalingCenterY=null}updateMatrix(matrix){super.updateMatrix(matrix);const{scalingX,scalingY,scalingCenterX,scalingCenterY}=this;scalingX===1&&scalingY===1||(Matrix.updateTransformMatrix(this[SCALABLE_MATRIX],scalingX,scalingY,0,0,0,{scalingCenterX,scalingCenterY}),matrix.multiplySelf(this[SCALABLE_MATRIX]))}};__name(_ScalableInternal,"ScalableInternal");let ScalableInternal=_ScalableInternal;return _a274=SCALABLE_MATRIX,__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingX",2),__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingY",2),__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingCenterX",2),__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingCenterY",2),ScalableInternal}__name(Scalable,"Scalable");function Translatable(Parent){var _a274;const ParentNode=Parent,TRANSLATABLE_MATRIX=Symbol("matrix_translation"),_TranslatableInternal=class _TranslatableInternal extends MatrixTransform(ParentNode){constructor(){super(...arguments),this[_a274]=new Matrix,this.translationX=0,this.translationY=0}updateMatrix(matrix){super.updateMatrix(matrix);const{translationX,translationY}=this;translationX===0&&translationY===0||(Matrix.updateTransformMatrix(this[TRANSLATABLE_MATRIX],1,1,0,translationX,translationY),matrix.multiplySelf(this[TRANSLATABLE_MATRIX]))}};__name(_TranslatableInternal,"TranslatableInternal");let TranslatableInternal=_TranslatableInternal;return _a274=TRANSLATABLE_MATRIX,__decorateClass([SceneChangeDetection({type:"transform"})],TranslatableInternal.prototype,"translationX",2),__decorateClass([SceneChangeDetection({type:"transform"})],TranslatableInternal.prototype,"translationY",2),TranslatableInternal}__name(Translatable,"Translatable");var _a17,Transformable=(_a17=class{static fromCanvas(node,bbox){const parents=[];for(const parent of node.ancestors())isMatrixTransform(parent)&&parents.unshift(parent);for(const parent of parents)bbox=parent.fromParent(bbox);return isMatrixTransform(node)&&(bbox=node.fromParent(bbox)),bbox}static toCanvas(node,bbox){bbox==null?bbox=node.getBBox():isMatrixTransform(node)&&(bbox=node.toParent(bbox));for(const parent of node.ancestors())isMatrixTransform(parent)&&(bbox=parent.toParent(bbox));return bbox}static fromCanvasPoint(node,x,y){const parents=[];for(const parent of node.ancestors())isMatrixTransform(parent)&&parents.unshift(parent);for(const parent of parents)({x,y}=parent.fromParentPoint(x,y));return isMatrixTransform(node)&&({x,y}=node.fromParentPoint(x,y)),{x,y}}static toCanvasPoint(node,x,y){isMatrixTransform(node)&&({x,y}=node.toParentPoint(x,y));for(const parent of node.ancestors())isMatrixTransform(parent)&&({x,y}=parent.toParentPoint(x,y));return{x,y}}},__name(_a17,"Transformable"),_a17),_a18,_Group=(_a18=class extends Node{constructor(opts){super({isVirtual:opts==null?void 0:opts.isVirtual,name:opts==null?void 0:opts.name}),this.opts=opts,this.opacity=1,this.lastBBox=void 0;const{zIndex,zIndexSubOrder}=opts??{};this.isContainerNode=!0,zIndex!==void 0&&(this.zIndex=zIndex),zIndexSubOrder!==void 0&&(this.zIndexSubOrder=zIndexSubOrder)}static is(value){return value instanceof _a18}onZIndexChange(){var _a274;super.onZIndexChange(),this.layer&&((_a274=this._layerManager)==null||_a274.moveLayer(this.layer,this.zIndex,this.zIndexSubOrder))}isLayer(){return this.layer!=null}_setLayerManager(layersManager){if(this._layerManager&&this.layer&&(this._layerManager.removeLayer(this.layer),this.layer=void 0),this.layer)throw new Error("AG Charts - unable to deregister scene rendering layer!");super._setLayerManager(layersManager)}initialiseLayer(){var _a274;this.layer||!this._layerManager||((_a274=this.opts)==null?void 0:_a274.layer)!==!0||(this.layer=this._layerManager.addLayer({name:this.name,zIndex:this.zIndex,zIndexSubOrder:this.zIndexSubOrder,getComputedOpacity:__name(()=>this.getComputedOpacity(),"getComputedOpacity"),getVisibility:__name(()=>this.getVisibility(),"getVisibility")}))}getComputedOpacity(){let opacity=1;for(const node of this.traverseUp())node instanceof _a18&&(opacity*=node.opacity);return opacity}getVisibility(){for(const node of this.traverseUp())if(!node.visible)return!1;return!0}onVisibleChange(){this.layer&&(this.layer.enabled=this.visible)}markDirty(source,type=1){if(this.isVirtual){super.markDirty(source,type);return}let parentType=type;(type<2||this.layer!=null)&&(parentType=1),super.markDirty(source,type,parentType)}containsPoint(_x,_y){return!0}computeBBox(){return _a18.computeChildrenBBox(this.children)}preRender(){var _a274,_b;const counts=super.preRender();return counts.groups+=1,counts.nonGroups-=1,((_a274=this.opts)==null?void 0:_a274.layer)!==!0||(this.layer==null&&counts.nonGroups>0&&this.initialiseLayer(),(_b=this.opts)!=null&&_b.nonEmptyChildDerivedZIndex&&counts.nonGroups>0&&this.deriveZIndexFromChildren()),counts}deriveZIndexFromChildren(){const children=this.children.filter(c=>c._childNodeCounts.nonGroups>0);this.sortChildren(children);const lastChild=children.at(-1);this.zIndex=(lastChild==null?void 0:lastChild.zIndex)??-1/0,this.zIndexSubOrder=lastChild==null?void 0:lastChild.zIndexSubOrder}render(renderCtx){var _a274,_b;const{opts:{name=void 0}={},_debug:debug3}=this,{dirty,dirtyZIndex,layer,children,clipRect}=this;let{ctx,forceRender,clipBBox}=renderCtx;const{resized,stats}=renderCtx,isDirty=dirty>=2||dirtyZIndex||resized;let isChildDirty=isDirty,isChildLayerDirty=!1;for(const child of children)if(isChildDirty||(isChildDirty=child.layerManager==null&&child.dirty>=1),isChildLayerDirty||(isChildLayerDirty=child.layerManager!=null&&child.dirty>=1),isChildDirty)break;if(name&&(debug3==null||debug3({name,group:this,isDirty,isChildDirty,renderCtx,forceRender})),layer){const currentBBox=this.getBBox();(this.lastBBox===void 0||!this.lastBBox.equals(currentBBox))&&(forceRender="dirtyTransform",this.lastBBox=currentBBox)}if(!isDirty&&!isChildDirty&&!isChildLayerDirty&&!forceRender){name&&stats&&(debug3==null||debug3({name,result:"skipping",renderCtx,counts:this.nodeCount,group:this})),layer&&stats&&(stats.layersSkipped++,stats.nodesSkipped+=this.nodeCount.count),this.markClean({recursive:!1});return}const groupVisible=this.visible;if(layer){const canvasCtxTransform=ctx.getTransform();if(ctx=layer.context,ctx.save(),ctx.setTransform(layer.pixelRatio,0,0,layer.pixelRatio,0,0),forceRender!=="dirtyTransform"&&(forceRender=isChildDirty||dirtyZIndex),forceRender&&layer.clear(),clipBBox){const{width,height,x,y}=clipBBox;debug3==null||debug3(()=>({name,clipBBox,ctxTransform:ctx.getTransform(),renderCtx,group:this})),ctx.beginPath(),ctx.rect(x,y,width,height),ctx.clip()}ctx.setTransform(canvasCtxTransform)}else ctx.globalAlpha*=this.opacity;if(clipRect){const{x,y,width,height}=clipRect;ctx.save(),debug3==null||debug3(()=>({name,clipRect,ctxTransform:ctx.getTransform(),renderCtx,group:this})),ctx.beginPath(),ctx.rect(x,y,width,height),ctx.clip(),clipBBox=Transformable.toCanvas(this,clipRect)}const hasVirtualChildren=this.hasVirtualChildren();dirtyZIndex?(this.sortChildren(children),forceRender!=="dirtyTransform"&&(forceRender=!0)):hasVirtualChildren&&this.sortChildren(children);const childRenderContext=forceRender!==renderCtx.forceRender||clipBBox!==renderCtx.clipBBox||ctx!==renderCtx.ctx?{...renderCtx,ctx,forceRender,clipBBox}:renderCtx;let skipped=0;for(const child of children){if(!child.visible||!groupVisible){child.markClean(),stats&&(skipped+=child.nodeCount.count);continue}if(!forceRender&&child.dirty===0){stats&&(skipped+=child.nodeCount.count);continue}ctx.save(),child.render(childRenderContext),ctx.restore()}if(stats&&(stats.nodesSkipped+=skipped),super.render(renderCtx),clipRect&&ctx.restore(),hasVirtualChildren)for(const child of this.virtualChildren)child.markClean({recursive:"virtual"});layer&&(stats&&stats.layersRendered++,ctx.restore(),forceRender&&layer.snapshot(),(_b=(_a274=layer.context).verifyDepthZero)==null||_b.call(_a274)),name&&stats&&(debug3==null||debug3({name,result:"rendered",skipped,renderCtx,counts:this.nodeCount,group:this}))}sortChildren(children){this.dirtyZIndex=!1,children.sort((a,b)=>compoundAscending([a.zIndex,...a.zIndexSubOrder??[void 0,void 0],a.serialNumber],[b.zIndex,...b.zIndexSubOrder??[void 0,void 0],b.serialNumber],ascendingStringNumberUndefined))}static computeChildrenBBox(nodes,opts){let left=1/0,right=-1/0,top=1/0,bottom=-1/0;const skipInvisible=(opts==null?void 0:opts.skipInvisible)??!0;for(const n of nodes){if(skipInvisible&&!n.visible)continue;const bbox=n.getBBox();if(!bbox)continue;const{x,y,width,height}=bbox;x<left&&(left=x),y<top&&(top=y),x+width>right&&(right=x+width),y+height>bottom&&(bottom=y+height)}return new BBox(left,top,right-left,bottom-top)}setClipRect(bbox){this.clipRect=bbox}setClipRectInGroupCoordinateSpace(bbox){this.clipRect=bbox?Transformable.fromCanvas(this,bbox):void 0}},__name(_a18,"_Group"),_a18);_Group.className="Group";__decorateClass([SceneChangeDetection({redraw:3,convertor:__name(v=>clamp(0,v,1),"convertor")})],_Group.prototype,"opacity",2);var Group=_Group,_a19,ScalableGroup=(_a19=class extends Scalable(Group){},__name(_a19,"ScalableGroup"),_a19),_a20,RotatableGroup=(_a20=class extends Rotatable(Group){},__name(_a20,"RotatableGroup"),_a20),_a21,TranslatableGroup=(_a21=class extends Translatable(Group){},__name(_a21,"TranslatableGroup"),_a21),_a22,TransformableGroup=(_a22=class extends Rotatable(Translatable(Group)){},__name(_a22,"TransformableGroup"),_a22),verifiedGlobals={};typeof window<"u"?verifiedGlobals.window=window:typeof global<"u"&&(verifiedGlobals.window=global.window);typeof document<"u"?verifiedGlobals.document=document:typeof global<"u"&&(verifiedGlobals.document=global.document);function getDocument(propertyName){var _a274;return propertyName?(_a274=verifiedGlobals.document)==null?void 0:_a274[propertyName]:verifiedGlobals.document}__name(getDocument,"getDocument");function getWindow(propertyName){var _a274;return propertyName?(_a274=verifiedGlobals.window)==null?void 0:_a274[propertyName]:verifiedGlobals.window}__name(getWindow,"getWindow");function createElement(tagName,className,style){const element2=getDocument().createElement(tagName);if(typeof className=="object"&&(style=className,className=void 0),className)for(const name of className.split(" "))element2.classList.add(name);return style&&Object.assign(element2.style,style),element2}__name(createElement,"createElement");function createElementNS(namespaceURI,qualifiedName){return getDocument().createElementNS(namespaceURI,qualifiedName)}__name(createElementNS,"createElementNS");function downloadUrl(dataUrl,fileName){const{body}=getDocument(),element2=createElement("a",{display:"none"});element2.href=dataUrl,element2.download=fileName,body.appendChild(element2),element2.click(),setTimeout(()=>body.removeChild(element2))}__name(downloadUrl,"downloadUrl");function setDocument(document2){verifiedGlobals.document=document2}__name(setDocument,"setDocument");function setWindow(window2){verifiedGlobals.window=window2}__name(setWindow,"setWindow");function setElementBBox(element2,bbox){element2&&(element2.style.width=`${bbox.width}px`,element2.style.height=`${bbox.height}px`,element2.style.left=`${bbox.x}px`,element2.style.top=`${bbox.y}px`)}__name(setElementBBox,"setElementBBox");function focusCursorAtEnd(element2){var _a274;if(element2.focus(),((_a274=element2.lastChild)==null?void 0:_a274.textContent)==null)return;const range3=getDocument().createRange();range3.setStart(element2.lastChild,element2.lastChild.textContent.length),range3.setEnd(element2.lastChild,element2.lastChild.textContent.length);const selection=getWindow().getSelection();selection==null||selection.removeAllRanges(),selection==null||selection.addRange(range3)}__name(focusCursorAtEnd,"focusCursorAtEnd");var _id=0;function createElementId(label){return`${label??"ag-charts-element"}-${_id++}`}__name(createElementId,"createElementId");var LONG_TIME_PERIOD_THRESHOLD=2e3,timeOfLastLog=Date.now(),logTimeGap=__name(()=>{const timeSinceLastLog=Date.now()-timeOfLastLog;if(timeSinceLastLog>LONG_TIME_PERIOD_THRESHOLD){const prettyDuration=(Math.floor(timeSinceLastLog/100)/10).toFixed(1);Logger.log(`**** ${prettyDuration}s since last log message ****`)}timeOfLastLog=Date.now()},"logTimeGap"),Debug={create(...debugSelectors){return Object.assign(__name((...logContent)=>{Debug.check(...debugSelectors)&&(typeof logContent[0]=="function"&&(logContent=toArray(logContent[0]())),logTimeGap(),Logger.log(...logContent))},"resultFn"),{check:__name(()=>Debug.check(...debugSelectors),"check")})},check(...debugSelectors){return debugSelectors.length===0&&debugSelectors.push(!0),toArray(getWindow("agChartsDebug")).some(selector=>debugSelectors.includes(selector))}},_a23,Selection=(_a23=class{constructor(parentNode,classOrFactory,autoCleanup=!0){this.parentNode=parentNode,this.autoCleanup=autoCleanup,this.garbageBin=new Set,this._nodesMap=new Map,this._nodes=[],this.data=[],this.debug=Debug.create(!0,"scene","scene:selections"),this.nodeFactory=Object.prototype.isPrototypeOf.call(Node,classOrFactory)?()=>new classOrFactory:classOrFactory}static select(parent,classOrFactory,garbageCollection=!0){return new _a23(parent,classOrFactory,garbageCollection)}static selectAll(parent,predicate){const results=[],traverse=__name(node=>{predicate(node)&&results.push(node),node.children.forEach(traverse)},"traverse");return traverse(parent),results}static selectByClass(node,Class,...ExtraClasses){return _a23.selectAll(node,n=>n instanceof Class||ExtraClasses.some(C=>n instanceof C))}static selectByTag(node,tag){return _a23.selectAll(node,n=>n.tag===tag)}createNode(datum,initializer,idx){const node=this.nodeFactory(datum);return node.datum=datum,initializer==null||initializer(node),idx==null?this._nodes.push(node):this._nodes.splice(idx,0,node),this.parentNode.appendChild(node),node}update(data,initializer,getDatumId){if(this.garbageBin.size>0&&this.debug(`Selection - update() called with pending garbage: ${data}`),getDatumId){const dataMap=new Map(data.map((datum,idx)=>[getDatumId(datum),[datum,idx]]));for(const[node,datumId]of this._nodesMap.entries())if(dataMap.has(datumId)){const[newDatum]=dataMap.get(datumId);node.datum=newDatum,this.garbageBin.delete(node),dataMap.delete(datumId)}else this.garbageBin.add(node);for(const[datumId,[datum,idx]]of dataMap.entries())this._nodesMap.set(this.createNode(datum,initializer,idx),datumId)}else{const maxLength=Math.max(data.length,this.data.length);for(let i=0;i<maxLength;i++)i>=data.length?this.garbageBin.add(this._nodes[i]):i>=this._nodes.length?this.createNode(data[i],initializer):(this._nodes[i].datum=data[i],this.garbageBin.delete(this._nodes[i]))}return this.data=data.slice(),this.autoCleanup&&this.cleanup(),this}cleanup(){return this.garbageBin.size===0?this:(this._nodes=this._nodes.filter(node=>this.garbageBin.has(node)?(this._nodesMap.delete(node),this.garbageBin.delete(node),node.destroy(),!1):!0),this)}clear(){return this.update([]),this}isGarbage(node){return this.garbageBin.has(node)}hasGarbage(){return this.garbageBin.size>0}each(iterate2){for(const entry of this._nodes.entries())iterate2(entry[1],entry[1].datum,entry[0]);return this}*[Symbol.iterator](){for(let index=0;index<this._nodes.length;index++){const node=this._nodes[index],datum=this._nodes[index].datum;yield{node,datum,index}}}select(predicate){return _a23.selectAll(this.parentNode,predicate)}selectByClass(Class){return _a23.selectByClass(this.parentNode,Class)}selectByTag(tag){return _a23.selectByTag(this.parentNode,tag)}nodes(){return this._nodes}at(index){return this._nodes.at(index)}},__name(_a23,"_Selection"),_a23),twoPi=Math.PI*2;function normalizeAngle360(radians){return radians%=twoPi,radians+=twoPi,radians%=twoPi,radians}__name(normalizeAngle360,"normalizeAngle360");function normalizeAngle360Inclusive(radians){return radians%=twoPi,radians+=twoPi,radians!==twoPi&&(radians%=twoPi),radians}__name(normalizeAngle360Inclusive,"normalizeAngle360Inclusive");function normalizeAngle180(radians){return radians%=twoPi,radians<-Math.PI?radians+=twoPi:radians>=Math.PI&&(radians-=twoPi),radians}__name(normalizeAngle180,"normalizeAngle180");function isBetweenAngles(targetAngle,startAngle,endAngle){const t=normalizeAngle360(targetAngle),a0=normalizeAngle360(startAngle),a1=normalizeAngle360(endAngle);return a0<a1?a0<=t&&t<=a1:a0>a1?a0<=t||t<=a1:!0}__name(isBetweenAngles,"isBetweenAngles");function toRadians(degrees){return degrees/180*Math.PI}__name(toRadians,"toRadians");function toDegrees(radians){return radians/Math.PI*180}__name(toDegrees,"toDegrees");function angleDiff(angle0,angle1,counterClockwise){counterClockwise&&([angle0,angle1]=[angle1,angle0]);const a0=normalizeAngle360(angle0);return(normalizeAngle360(angle1)+twoPi-a0)%twoPi}__name(angleDiff,"angleDiff");function angleBetween(angle0,angle1){return angle0=normalizeAngle360(angle0),angle1=normalizeAngle360(angle1),angle1-angle0+(angle0>angle1?2*Math.PI:0)}__name(angleBetween,"angleBetween");function displacePointFromVector(centerX,centerY,radius,angle2){const x=centerX+radius*Math.cos(angle2),y=centerY+radius*Math.sin(angle2);return{x,y}}__name(displacePointFromVector,"displacePointFromVector");var delta=1e-6;function clockwiseAngle(angle2,relativeToStartAngle){return angleBetween(angle2,relativeToStartAngle)<delta?relativeToStartAngle:normalizeAngle360(angle2-relativeToStartAngle)+relativeToStartAngle}__name(clockwiseAngle,"clockwiseAngle");function clockwiseAngles(startAngle,endAngle,relativeToStartAngle=0){const sweepAngle=Math.abs(endAngle-startAngle)>=2*Math.PI?2*Math.PI:normalizeAngle360(endAngle-startAngle);return startAngle=clockwiseAngle(startAngle,relativeToStartAngle),endAngle=startAngle+sweepAngle,{startAngle,endAngle}}__name(clockwiseAngles,"clockwiseAngles");function pointsDistanceSquared(x1,y1,x2,y2){const dx=x1-x2,dy=y1-y2;return dx*dx+dy*dy}__name(pointsDistanceSquared,"pointsDistanceSquared");function lineDistanceSquared(x,y,x1,y1,x2,y2,best){if(x1===x2&&y1===y2)return Math.min(best,pointsDistanceSquared(x,y,x1,y1));const dx=x2-x1,dy=y2-y1,t=Math.max(0,Math.min(1,((x-x1)*dx+(y-y1)*dy)/(dx*dx+dy*dy))),ix=x1+t*dx,iy=y1+t*dy;return Math.min(best,pointsDistanceSquared(x,y,ix,iy))}__name(lineDistanceSquared,"lineDistanceSquared");function arcDistanceSquared(x,y,cx,cy,radius,startAngle,endAngle,counterClockwise,best){counterClockwise&&([endAngle,startAngle]=[startAngle,endAngle]);const angle2=Math.atan2(y-cy,x-cx);if(!isBetweenAngles(angle2,startAngle,endAngle)){const startX=cx+Math.cos(startAngle)*radius,startY=cy+Math.sin(startAngle)*radius,endX=cx+Math.cos(startAngle)*radius,endY=cy+Math.sin(startAngle)*radius;return Math.min(best,pointsDistanceSquared(x,y,startX,startY),pointsDistanceSquared(x,y,endX,endY))}const distToArc=radius-Math.sqrt(pointsDistanceSquared(x,y,cx,cy));return Math.min(best,distToArc*distToArc)}__name(arcDistanceSquared,"arcDistanceSquared");var convertColorStringToOklcha=__name(v=>{const color=Color.fromString(v),[l,c,h]=Color.RGBtoOKLCH(color.r,color.g,color.b);return{l,c,h,a:color.a}},"convertColorStringToOklcha"),delta2=1e-6,isAchromatic=__name(x=>x.c<delta2||x.l<delta2||x.l>1-delta2,"isAchromatic"),interpolateOklch=__name((x,y,d)=>{d=clamp(0,d,1);let h;if(isAchromatic(x))h=y.h;else if(isAchromatic(y))h=x.h;else{const xH=x.h;let yH=y.h;const deltaH=y.h-x.h;deltaH>180?yH-=360:deltaH<-180&&(yH+=360),h=xH*(1-d)+yH*d}const c=x.c*(1-d)+y.c*d,l=x.l*(1-d)+y.l*d,a=x.a*(1-d)+y.a*d;return Color.fromOKLCH(l,c,h,a)},"interpolateOklch"),_a24,ColorScale=(_a24=class{constructor(){this.type="color",this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(convertColorStringToOklcha)}update(){const{domain,range:range3}=this;domain.length<2&&(Logger.warnOnce("`colorDomain` should have at least 2 values."),domain.length===0?domain.push(0,1):domain.length===1&&domain.push(domain[0]+1));for(let i=1;i<domain.length;i++){const a=domain[i-1],b=domain[i];if(a>=b){Logger.warnOnce("`colorDomain` values should be supplied in ascending order."),domain.sort((a2,b2)=>a2-b2);break}}if(range3.length<domain.length)for(let i=range3.length;i<domain.length;i++)range3.push(range3.length>0?range3[0]:"black");this.parsedRange=this.range.map(convertColorStringToOklcha)}convert(x){this.refresh();const{domain,range:range3,parsedRange}=this,d0=domain[0],d1=domain.at(-1),r0=range3[0],r1=range3[range3.length-1];if(x<=d0)return r0;if(x>=d1)return r1;let index,q;if(domain.length===2){const t=(x-d0)/(d1-d0),step=1/(range3.length-1);index=range3.length<=2?0:Math.min(Math.floor(t*(range3.length-1)),range3.length-2),q=(t-index*step)/step}else{for(index=0;index<domain.length-2&&!(x<domain[index+1]);index++);const a=domain[index],b=domain[index+1];q=(x-a)/(b-a)}const c0=parsedRange[index],c1=parsedRange[index+1];return interpolateOklch(c0,c1,q).toRgbaString()}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}},__name(_a24,"ColorScale"),_a24);__decorateClass([Invalidating],ColorScale.prototype,"domain",2);__decorateClass([Invalidating],ColorScale.prototype,"range",2);var _a25,Gradient=(_a25=class{constructor(colorSpace,stops=[],bbox){this.colorSpace=colorSpace,this.stops=stops,this.bbox=bbox,this._cache=void 0}createGradient(ctx,shapeBbox){const bbox=this.bbox??shapeBbox;if(this._cache!=null&&this._cache.ctx===ctx&&this._cache.bbox.equals(bbox))return this._cache.gradient;const{stops,colorSpace}=this;if(stops.length===0)return;if(stops.length===1)return stops[0].color;let gradient2=this.createCanvasGradient(ctx,bbox);if(gradient2==null)return;const isOkLch=colorSpace==="oklch",step=.05;let c0=stops[0];gradient2.addColorStop(c0.offset,c0.color);for(let i=1;i<stops.length;i+=1){const c1=stops[i];if(isOkLch){const scale2=new ColorScale;scale2.domain=[c0.offset,c1.offset],scale2.range=[c0.color,c1.color];for(let offset4=c0.offset+step;offset4<c1.offset;offset4+=step)gradient2.addColorStop(offset4,scale2.convert(offset4))}gradient2.addColorStop(c1.offset,c1.color),c0=c1}return"createPattern"in gradient2&&(gradient2=gradient2.createPattern()),this._cache={ctx,bbox,gradient:gradient2},gradient2}},__name(_a25,"Gradient"),_a25),_a26,LinearGradient=(_a26=class extends Gradient{constructor(colorSpace,stops,angle2=0,bbox){super(colorSpace,stops,bbox),this.angle=angle2}createCanvasGradient(ctx,bbox){const{angle:angle2}=this,radians=normalizeAngle360(toRadians(angle2+90)),cos=Math.cos(radians),sin=Math.sin(radians),w=bbox.width,h=bbox.height,cx=bbox.x+w*.5,cy=bbox.y+h*.5,diagonal=Math.sqrt(h*h+w*w)/2,diagonalAngle=Math.atan2(h,w);let quarteredAngle;radians<Math.PI/2?quarteredAngle=radians:radians<Math.PI?quarteredAngle=Math.PI-radians:radians<1.5*Math.PI?quarteredAngle=radians-Math.PI:quarteredAngle=2*Math.PI-radians;const l=diagonal*Math.abs(Math.cos(quarteredAngle-diagonalAngle));return ctx.createLinearGradient(cx+cos*l,cy+sin*l,cx-cos*l,cy-sin*l)}},__name(_a26,"LinearGradient"),_a26),LINEAR_GRADIENT_REGEXP=/^linear-gradient\((-?[\d.]+)deg,(.*?)\)$/i,_a27,_Shape=(_a27=class extends Node{constructor(){super(...arguments),this.fillOpacity=1,this.strokeOpacity=1,this.fill=_a27.defaultStyles.fill,this.stroke=_a27.defaultStyles.stroke,this.strokeWidth=_a27.defaultStyles.strokeWidth,this.lineDash=_a27.defaultStyles.lineDash,this.lineDashOffset=_a27.defaultStyles.lineDashOffset,this.lineCap=_a27.defaultStyles.lineCap,this.lineJoin=_a27.defaultStyles.lineJoin,this.miterLimit=void 0,this.opacity=_a27.defaultStyles.opacity,this.fillShadow=_a27.defaultStyles.fillShadow}restoreOwnStyles(){const{defaultStyles}=this.constructor;Object.assign(this,defaultStyles)}onFillChange(){const{fill}=this;let linearGradientMatch;if(fill instanceof Gradient)this.gradient=fill;else if(fill!=null&&fill.startsWith("linear-gradient")&&(linearGradientMatch=LINEAR_GRADIENT_REGEXP.exec(fill))){const angle2=parseFloat(linearGradientMatch[1]),colors=[],colorsPart=linearGradientMatch[2],colorRegex=/(#[0-9a-f]+)|(rgba?\(.+?\))|([a-z]+)/gi;let c;for(;c=colorRegex.exec(colorsPart);)colors.push(c[0]);this.gradient=new LinearGradient("rgb",colors.map((color,index)=>({color,offset:index/(colors.length-1)})),angle2)}else this.gradient=void 0}align(start,length2){var _a274,_b;const pixelRatio=((_b=(_a274=this.layerManager)==null?void 0:_a274.canvas)==null?void 0:_b.pixelRatio)??1,alignedStart=Math.round(start*pixelRatio)/pixelRatio;return length2==null?alignedStart:length2===0?0:length2<1?Math.ceil(length2*pixelRatio)/pixelRatio:Math.round((length2+start)*pixelRatio)/pixelRatio-alignedStart}fillStroke(ctx,path){this.renderFill(ctx,path),this.renderStroke(ctx,path)}renderFill(ctx,path){if(this.fill){const{globalAlpha}=ctx;this.applyFill(ctx),this.applyFillAlpha(ctx),this.applyShadow(ctx),this.executeFill(ctx,path),ctx.globalAlpha=globalAlpha}ctx.shadowColor="rgba(0, 0, 0, 0)"}executeFill(ctx,path){path?ctx.fill(path):ctx.fill()}applyFill(ctx){var _a274;ctx.fillStyle=((_a274=this.gradient)==null?void 0:_a274.createGradient(ctx,this.getBBox()))??(typeof this.fill=="string"?this.fill:void 0)??"black"}applyFillAlpha(ctx){ctx.globalAlpha*=this.opacity*this.fillOpacity}applyShadow(ctx){var _a274;const pixelRatio=((_a274=this.layerManager)==null?void 0:_a274.canvas.pixelRatio)??1,fillShadow=this.fillShadow;fillShadow!=null&&fillShadow.enabled&&(ctx.shadowColor=fillShadow.color,ctx.shadowOffsetX=fillShadow.xOffset*pixelRatio,ctx.shadowOffsetY=fillShadow.yOffset*pixelRatio,ctx.shadowBlur=fillShadow.blur*pixelRatio)}renderStroke(ctx,path){if(this.stroke&&this.strokeWidth){const{globalAlpha}=ctx;ctx.strokeStyle=this.stroke,ctx.globalAlpha*=this.opacity*this.strokeOpacity,ctx.lineWidth=this.strokeWidth,this.lineDash&&ctx.setLineDash(this.lineDash),this.lineDashOffset&&(ctx.lineDashOffset=this.lineDashOffset),this.lineCap&&(ctx.lineCap=this.lineCap),this.lineJoin&&(ctx.lineJoin=this.lineJoin),this.miterLimit!=null&&(ctx.miterLimit=this.miterLimit),this.executeStroke(ctx,path),ctx.globalAlpha=globalAlpha}}executeStroke(ctx,path){path?ctx.stroke(path):ctx.stroke()}containsPoint(x,y){return this.isPointInPath(x,y)}},__name(_a27,"_Shape"),_a27);_Shape.defaultStyles={fill:"black",stroke:void 0,strokeWidth:0,lineDash:void 0,lineDashOffset:0,lineCap:void 0,lineJoin:void 0,opacity:1,fillShadow:void 0};__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"fillOpacity",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"strokeOpacity",2);__decorateClass([SceneChangeDetection({redraw:2,changeCb:__name(s=>s.onFillChange(),"changeCb")})],_Shape.prototype,"fill",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"stroke",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"strokeWidth",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineDash",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineDashOffset",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineCap",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineJoin",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"miterLimit",2);__decorateClass([SceneChangeDetection({redraw:2,convertor:__name(v=>clamp(0,v,1),"convertor")})],_Shape.prototype,"opacity",2);__decorateClass([SceneChangeDetection({redraw:2,checkDirtyOnAssignment:!0})],_Shape.prototype,"fillShadow",2);var Shape=_Shape,_a28,Line=(_a28=class extends Shape{constructor(opts={}){super(opts),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.restoreOwnStyles()}set x(value){this.x1=value,this.x2=value}set y(value){this.y1=value,this.y2=value}computeBBox(){return new BBox(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(x,y){return this.x1===this.x2||this.y1===this.y2?this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(x,y):!1}distanceSquared(px,py){const{x1,y1,x2,y2}=this;return lineDistanceSquared(px,py,x1,y1,x2,y2,1/0)}render(renderCtx){var _a274;const{ctx,forceRender,stats,devicePixelRatio}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}let{x1,y1,x2,y2}=this;if(x1===x2){const{strokeWidth}=this,x=Math.round(x1*devicePixelRatio)/devicePixelRatio+Math.trunc(strokeWidth*devicePixelRatio)%2/(devicePixelRatio*2);x1=x,x2=x}else if(y1===y2){const{strokeWidth}=this,y=Math.round(y1*devicePixelRatio)/devicePixelRatio+Math.trunc(strokeWidth*devicePixelRatio)%2/(devicePixelRatio*2);y1=y,y2=y}ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y2),this.fillStroke(ctx),(_a274=this.fillShadow)==null||_a274.markClean(),super.render(renderCtx)}},__name(_a28,"Line"),_a28);Line.className="Line";Line.defaultStyles=Object.assign({},Shape.defaultStyles,{fill:void 0,strokeWidth:1});__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"x1",2);__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"y1",2);__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"x2",2);__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"y2",2);function createCanvasContext(width=0,height=0){return new OffscreenCanvas(width,height).getContext("2d")}__name(createCanvasContext,"createCanvasContext");var _a29,LRUCache=(_a29=class{constructor(maxCacheSize=5){this.maxCacheSize=maxCacheSize,this.store=new Map}get(key){if(!this.store.has(key))return;const hit=this.store.get(key);return this.store.delete(key),this.store.set(key,hit),hit}has(key){return this.store.has(key)}set(key,value){if(this.store.set(key,value),this.store.size>this.maxCacheSize){const iterator=this.store.keys();let evictCount=this.store.size-this.maxCacheSize;for(;evictCount>0;){const evictKeyIterator=iterator.next();evictKeyIterator.done||this.store.delete(evictKeyIterator.value),evictCount--}}return value}clear(){this.store.clear()}},__name(_a29,"LRUCache"),_a29),_a30,CachedTextMeasurerPool=(_a30=class{static measureText(text,options){return this.getMeasurer(options).measureText(text)}static measureLines(text,options){return this.getMeasurer(options).measureLines(text)}static getMeasurer(options){const font=typeof options.font=="string"?options.font:TextUtils.toFontString(options.font),key=`${font}-${options.textAlign??"start"}-${options.textBaseline??"alphabetic"}`;return this.instanceMap.get(key)??this.createFontMeasurer(font,options,key)}static createFontMeasurer(font,options,key){const ctx=createCanvasContext();ctx.font=font,ctx.textAlign=options.textAlign??"start",ctx.textBaseline=options.textBaseline??"alphabetic";const measurer=new CachedTextMeasurer(ctx,options);return this.instanceMap.set(key,measurer),measurer}},__name(_a30,"CachedTextMeasurerPool"),_a30);CachedTextMeasurerPool.instanceMap=new LRUCache(10);var _a31,CachedTextMeasurer=(_a31=class{constructor(ctx,options){this.ctx=ctx,this.measureMap=new LRUCache(100),options.textAlign&&(ctx.textAlign=options.textAlign),options.textBaseline&&(ctx.textBaseline=options.textBaseline),ctx.font=typeof options.font=="string"?options.font:TextUtils.toFontString(options.font),this.textMeasurer=new SimpleTextMeasurer(t=>this.cachedCtxMeasureText(t),options.textBaseline??"alphabetic")}textWidth(text,estimate){return this.textMeasurer.textWidth(text,estimate)}measureText(text){return this.textMeasurer.measureText(text)}measureLines(text){return this.textMeasurer.measureLines(text)}cachedCtxMeasureText(text){if(!this.measureMap.has(text)){const rawResult=this.ctx.measureText(text);this.measureMap.set(text,{actualBoundingBoxAscent:rawResult.actualBoundingBoxAscent,emHeightAscent:rawResult.emHeightAscent,emHeightDescent:rawResult.emHeightDescent,actualBoundingBoxDescent:rawResult.actualBoundingBoxDescent,actualBoundingBoxLeft:rawResult.actualBoundingBoxLeft,actualBoundingBoxRight:rawResult.actualBoundingBoxRight,alphabeticBaseline:rawResult.alphabeticBaseline,fontBoundingBoxAscent:rawResult.fontBoundingBoxAscent,fontBoundingBoxDescent:rawResult.fontBoundingBoxDescent,hangingBaseline:rawResult.hangingBaseline,ideographicBaseline:rawResult.ideographicBaseline,width:rawResult.width})}return this.measureMap.get(text)}},__name(_a31,"CachedTextMeasurer"),_a31),_a32,TextUtils=(_a32=class{static toFontString({fontSize=10,fontStyle,fontWeight,fontFamily,lineHeight}){let fontString="";return fontStyle&&(fontString+=`${fontStyle} `),fontWeight&&(fontString+=`${fontWeight} `),fontString+=`${fontSize}px`,lineHeight&&(fontString+=`/${lineHeight}px`),fontString+=` ${fontFamily}`,fontString.trim()}static getLineHeight(fontSize){return Math.ceil(fontSize*this.defaultLineHeight)}static getVerticalModifier(textBaseline){switch(textBaseline){case"hanging":case"top":return 0;case"middle":return .5;case"alphabetic":case"bottom":case"ideographic":default:return 1}}},__name(_a32,"TextUtils"),_a32);TextUtils.EllipsisChar="…";TextUtils.defaultLineHeight=1.15;TextUtils.lineSplitter=/\r?\n/g;var _a33,SimpleTextMeasurer=(_a33=class{constructor(measureTextFn,textBaseline="alphabetic"){this.measureTextFn=measureTextFn,this.textBaseline=textBaseline,this.charMap=new Map}getMetrics(text){const m=this.measureTextFn(text);return m.fontBoundingBoxAscent??(m.fontBoundingBoxAscent=m.emHeightAscent),m.fontBoundingBoxDescent??(m.fontBoundingBoxDescent=m.emHeightDescent),{width:m.width,height:m.actualBoundingBoxAscent+m.actualBoundingBoxDescent,lineHeight:m.fontBoundingBoxAscent+m.fontBoundingBoxDescent,offsetTop:m.actualBoundingBoxAscent,offsetLeft:m.actualBoundingBoxLeft}}getMultilineMetrics(lines){let width=0,height=0,offsetTop=0,offsetLeft=0,baselineDistance=0;const verticalModifier=TextUtils.getVerticalModifier(this.textBaseline),lineMetrics=[];let index=0;const length2=lines.length;for(const line of lines){const m=this.measureTextFn(line);m.fontBoundingBoxAscent??(m.fontBoundingBoxAscent=m.emHeightAscent),m.fontBoundingBoxDescent??(m.fontBoundingBoxDescent=m.emHeightDescent),width<m.width&&(width=m.width),offsetLeft<m.actualBoundingBoxLeft&&(offsetLeft=m.actualBoundingBoxLeft),index===0?(height+=m.actualBoundingBoxAscent,offsetTop+=m.actualBoundingBoxAscent):baselineDistance+=m.fontBoundingBoxAscent,index===length2-1?height+=m.actualBoundingBoxDescent:baselineDistance+=m.fontBoundingBoxDescent,lineMetrics.push({text:line,width:m.width,height:m.actualBoundingBoxAscent+m.actualBoundingBoxDescent,lineHeight:m.fontBoundingBoxAscent+m.fontBoundingBoxDescent,offsetTop:m.actualBoundingBoxAscent,offsetLeft:m.actualBoundingBoxLeft}),index++}return height+=baselineDistance,offsetTop+=baselineDistance*verticalModifier,{width,height,offsetTop,offsetLeft,lineMetrics}}textWidth(text,estimate){if(estimate){let estimatedWidth=0;for(let i=0;i<text.length;i++)estimatedWidth+=this.textWidth(text.charAt(i));return estimatedWidth}return text.length>1?this.measureTextFn(text).width:this.charMap.get(text)??this.charWidth(text)}measureText(text){return this.getMetrics(text)}measureLines(text){const lines=typeof text=="string"?text.split(TextUtils.lineSplitter):text;return this.getMultilineMetrics(lines)}charWidth(char){const{width}=this.measureTextFn(char);return this.charMap.set(char,width),width}},__name(_a33,"SimpleTextMeasurer"),_a33),_a34,_Text=(_a34=class extends Shape{constructor(){super(...arguments),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontSize=10,this.fontFamily="sans-serif",this.textAlign=_a34.defaultStyles.textAlign,this.textBaseline=_a34.defaultStyles.textBaseline}onTextChange(){var _a274;this.lines=((_a274=this.text)==null?void 0:_a274.split(`
`).map(s=>s.trim()))??[]}static computeBBox(lines,x,y,opts){const{offsetTop,offsetLeft,width,height}=CachedTextMeasurerPool.measureLines(lines,opts);return new BBox(x-offsetLeft,y-offsetTop,width,height)}computeBBox(){const{x,y,lines,textBaseline,textAlign}=this;return _a34.computeBBox(lines,x,y,{font:this,textBaseline,textAlign})}isPointInPath(x,y){const bbox=this.getBBox();return bbox?bbox.containsPoint(x,y):!1}render(renderCtx){const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}if(!this.lines.length||!this.layerManager){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}const{fill,stroke,strokeWidth}=this,{pixelRatio}=this.layerManager.canvas;if(ctx.font=TextUtils.toFontString(this),ctx.textAlign=this.textAlign,ctx.textBaseline=this.textBaseline,fill){this.applyFill(ctx),ctx.globalAlpha*=this.opacity*this.fillOpacity;const{fillShadow}=this;fillShadow!=null&&fillShadow.enabled&&(ctx.shadowColor=fillShadow.color,ctx.shadowOffsetX=fillShadow.xOffset*pixelRatio,ctx.shadowOffsetY=fillShadow.yOffset*pixelRatio,ctx.shadowBlur=fillShadow.blur*pixelRatio),this.renderLines((line,x,y)=>ctx.fillText(line,x,y))}if(stroke&&strokeWidth){ctx.strokeStyle=stroke,ctx.lineWidth=strokeWidth,ctx.globalAlpha*=this.opacity*this.strokeOpacity;const{lineDash,lineDashOffset,lineCap,lineJoin}=this;lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),this.renderLines((line,x,y)=>ctx.strokeText(line,x,y))}super.render(renderCtx)}renderLines(renderCallback){const{lines,x,y}=this,lineHeight=this.lineHeight??TextUtils.getLineHeight(this.fontSize);let offsetY=(lineHeight-lineHeight*lines.length)*TextUtils.getVerticalModifier(this.textBaseline);for(const line of lines)renderCallback(line,x,y+offsetY),offsetY+=lineHeight}setFont(props){this.fontFamily=props.fontFamily,this.fontSize=props.fontSize,this.fontStyle=props.fontStyle,this.fontWeight=props.fontWeight}setAlign(props){this.textAlign=props.textAlign,this.textBaseline=props.textBaseline}},__name(_a34,"_Text"),_a34);_Text.className="Text";_Text.defaultLineHeightRatio=1.15;_Text.defaultStyles=Object.assign({},Shape.defaultStyles,{textAlign:"start",fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:"sans-serif",textBaseline:"alphabetic"});__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"x",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"y",2);__decorateClass([SceneChangeDetection({redraw:3,changeCb:__name(o=>o.onTextChange(),"changeCb")})],_Text.prototype,"text",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontStyle",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontWeight",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontSize",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontFamily",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"textAlign",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"textBaseline",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"lineHeight",2);var Text=_Text,_a35,RotatableText=(_a35=class extends Rotatable(Text){},__name(_a35,"RotatableText"),_a35),_a36,TransformableText=(_a36=class extends Rotatable(Translatable(Text)){},__name(_a36,"TransformableText"),_a36);function circleRectOverlap(c,unitCenter,x,y,w,h){if(c.size===0)return!1;let cx=c.x,cy=c.y;unitCenter!=null&&(cx-=(unitCenter.x-.5)*c.size,cy-=(unitCenter.y-.5)*c.size);let edgeX=cx;cx<x?edgeX=x:cx>x+w&&(edgeX=x+w);let edgeY=cy;cy<y?edgeY=y:cy>y+h&&(edgeY=y+h);const dx=cx-edgeX,dy=cy-edgeY;return Math.sqrt(dx*dx+dy*dy)<=c.size*.5}__name(circleRectOverlap,"circleRectOverlap");function rectRectOverlap(r1,x2,y2,w2,h2){const xOverlap=r1.x+r1.width>x2&&r1.x<x2+w2,yOverlap=r1.y+r1.height>y2&&r1.y<y2+h2;return xOverlap&&yOverlap}__name(rectRectOverlap,"rectRectOverlap");function rectContainsRect(r1,r2x,r2y,r2w,r2h){return r2x+r2w<r1.x+r1.width&&r2x>r1.x&&r2y>r1.y&&r2y+r2h<r1.y+r1.height}__name(rectContainsRect,"rectContainsRect");function isPointLabelDatum(x){return x!=null&&typeof x.point=="object"&&typeof x.label=="object"}__name(isPointLabelDatum,"isPointLabelDatum");var labelPlacements={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},"top-left":{x:-1,y:-1},"top-right":{x:1,y:-1},"bottom-left":{x:-1,y:1},"bottom-right":{x:1,y:1}};function placeLabels(data,bounds,padding=5){const result=[];data=data.map(d=>d.slice().sort((a,b)=>b.point.size-a.point.size));for(let j=0;j<data.length;j++){const labels=result[j]=[],datum=data[j];if(datum!=null&&datum.length&&datum[0].label)for(let index=0,ln=datum.length;index<ln;index++){const d=datum[index],{point,label,marker}=d,{text,width,height}=label,r=point.size*.5;let dx=0,dy=0;if(r>0&&d.placement!=null){const placement=labelPlacements[d.placement];dx=(width*.5+r+padding)*placement.x,dy=(height*.5+r+padding)*placement.y}const x=point.x-width*.5+dx-(((marker==null?void 0:marker.center.x)??.5)-.5)*point.size,y=point.y-height*.5+dy-(((marker==null?void 0:marker.center.y)??.5)-.5)*point.size;!(!bounds||rectContainsRect(bounds,x,y,width,height))||data.some(dataDatums=>dataDatums.some(dataDatum=>{var _a274;return circleRectOverlap(dataDatum.point,(_a274=dataDatum.marker)==null?void 0:_a274.center,x,y,width,height)}))||result.some(l2=>l2.some(l3=>rectRectOverlap(l3,x,y,width,height)))||labels.push({index,text,x,y,width,height,datum:d})}}return result}__name(placeLabels,"placeLabels");function axisLabelsOverlap(data,padding=0){const result=[];for(let index=0;index<data.length;index++){const datum=data[index],{point:{x,y},label:{text}}=datum;let{width,height}=datum.label;if(width+=padding,height+=padding,result.some(l=>rectRectOverlap(l,x,y,width,height)))return!0;result.push({index,text,x,y,width,height,datum})}return!1}__name(axisLabelsOverlap,"axisLabelsOverlap");function areArrayNumbersEqual(arrA,arrB){return arrA.length===arrB.length&&arrA.every((item,i)=>Number(item)===Number(arrB[i]))}__name(areArrayNumbersEqual,"areArrayNumbersEqual");var CLASS_INSTANCE_TYPE="class-instance";function jsonDiff(source,target,skip){if(isArray(target)){if(!isArray(source)||source.length!==target.length||target.some((v,i)=>jsonDiff(source[i],v)!=null))return target}else if(isPlainObject(target)){if(!isPlainObject(source))return target;const result={},allKeys=new Set([...Object.keys(source),...Object.keys(target)]);for(const key of allKeys)if(!(source[key]===target[key]||skip!=null&&skip.includes(key)))if(typeof source[key]==typeof target[key]){const diff2=jsonDiff(source[key],target[key]);diff2!==null&&(result[key]=diff2)}else result[key]=target[key];return Object.keys(result).length?result:null}else if(source!==target)return target;return null}__name(jsonDiff,"jsonDiff");function deepClone(source,options){return isArray(source)?source.map(item=>deepClone(item,options)):isPlainObject(source)?mapValues(source,(value,key)=>{var _a274;return(_a274=options==null?void 0:options.shallow)!=null&&_a274.includes(key)?shallowClone(value):deepClone(value,options)}):source instanceof Map?new Map(deepClone(Array.from(source))):shallowClone(source)}__name(deepClone,"deepClone");function shallowClone(source){return isArray(source)?[...source]:isPlainObject(source)?{...source}:isDate(source)?new Date(source):isRegExp(source)?new RegExp(source.source,source.flags):source}__name(shallowClone,"shallowClone");function jsonWalk(json,visit,opts,...jsons){var _a274;if(isArray(json))visit(json,...jsons),json.forEach((node,index)=>{jsonWalk(node,visit,opts,...keyMapper(jsons,index))});else if(isPlainObject(json)){visit(json,...jsons);for(const key of Object.keys(json)){if((_a274=opts==null?void 0:opts.skip)!=null&&_a274.includes(key))continue;const value=json[key];(isArray(value)||isPlainObject(value))&&jsonWalk(value,visit,opts,...keyMapper(jsons,key))}}}__name(jsonWalk,"jsonWalk");function jsonApply(target,source,params={}){const{path,matcherPath=path==null?void 0:path.replace(/(\[[0-9+]+])/i,"[]"),skip=[]}=params;if(target==null)throw new Error(`AG Charts - target is uninitialised: ${path??"<root>"}`);if(source==null)return target;if(isProperties(target))return target.set(source);const targetAny=target,targetType=classify(target);for(const property in source){if(SKIP_JS_BUILTINS.has(property))continue;const propertyMatcherPath=`${matcherPath?matcherPath+".":""}${property}`;if(skip.includes(propertyMatcherPath))continue;const newValue=source[property],propertyPath=`${path?path+".":""}${property}`,targetClass=targetAny.constructor,currentValue=targetAny[property];try{const currentValueType=classify(currentValue),newValueType=classify(newValue);if(targetType===CLASS_INSTANCE_TYPE&&!(property in target)){Logger.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - property is unknown`);continue}if(currentValueType!=null&&newValueType!=null&&newValueType!==currentValueType&&(currentValueType!==CLASS_INSTANCE_TYPE||newValueType!=="object")){Logger.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - can't apply type of [${newValueType}], allowed types are: [${currentValueType}]`);continue}isProperties(currentValue)?targetAny[property].set(newValue):newValueType==="object"?(currentValue==null&&(targetAny[property]={}),jsonApply(currentValue??targetAny[property],newValue,{...params,path:propertyPath,matcherPath:propertyMatcherPath})):targetAny[property]=newValue}catch(error){Logger.warn(`unable to set [${propertyPath}] in [${targetClass==null?void 0:targetClass.name}]; nested error is: ${error.message}`)}}return target}__name(jsonApply,"jsonApply");function keyMapper(data,key){return data.map(dataObject=>dataObject==null?void 0:dataObject[key])}__name(keyMapper,"keyMapper");function classify(value){return value==null?null:isHtmlElement(value)||isDate(value)?"primitive":isArray(value)?"array":isObject(value)?isPlainObject(value)?"object":CLASS_INSTANCE_TYPE:isFunction(value)?"function":"primitive"}__name(classify,"classify");function ProxyProperty(proxyPath,configMetadata){const pathArray=isArray(proxyPath)?proxyPath:proxyPath.split(".");if(pathArray.length===1){const[property]=pathArray;return addTransformToInstanceProperty((target,_,value)=>target[property]=value,target=>target[property],configMetadata)}return addTransformToInstanceProperty((target,_,value)=>setPath(target,pathArray,value),target=>getPath(target,pathArray),configMetadata)}__name(ProxyProperty,"ProxyProperty");function ProxyOnWrite(proxyProperty){return addTransformToInstanceProperty((target,_,value)=>target[proxyProperty]=value)}__name(ProxyOnWrite,"ProxyOnWrite");function ProxyPropertyOnWrite(childName,childProperty){return addTransformToInstanceProperty((target,key,value)=>target[childName][childProperty??key]=value)}__name(ProxyPropertyOnWrite,"ProxyPropertyOnWrite");function ActionOnSet(opts){const{newValue:newValueFn,oldValue:oldValueFn,changeValue:changeValueFn}=opts;return addTransformToInstanceProperty((target,_,newValue,oldValue)=>(newValue!==oldValue&&(oldValue!==void 0&&(oldValueFn==null||oldValueFn.call(target,oldValue)),newValue!==void 0&&(newValueFn==null||newValueFn.call(target,newValue)),changeValueFn==null||changeValueFn.call(target,newValue,oldValue)),newValue))}__name(ActionOnSet,"ActionOnSet");function ObserveChanges(observerFn){return addObserverToInstanceProperty(observerFn)}__name(ObserveChanges,"ObserveChanges");var debugColor="color: green",debugQuietColor="color: grey",_a37,_StateMachine=(_a37=class{constructor(defaultState,states,enterEach){this.defaultState=defaultState,this.states=states,this.enterEach=enterEach,this.debug=Debug.create(!0,"animation"),this.state=defaultState,this.debug(`%c${this.constructor.name} | init -> ${defaultState}`,debugColor)}transition(event,data){var _a274,_b,_c,_d;if(!this.transitionChild(event,data)||this.state===_a37.child||this.state===_a37.parent)return;const currentState=this.state,currentStateConfig=this.states[this.state];let destination=currentStateConfig[event];const debugPrefix=`%c${this.constructor.name} | ${this.state} -> ${event} ->`;if(Array.isArray(destination))destination=destination.find(transition=>{if(!transition.guard)return!0;const valid=transition.guard(data);return valid||this.debug(`${debugPrefix} ${transition.target} (guarded)`,debugQuietColor),valid});else if(typeof destination=="object"&&!(destination instanceof _a37)&&destination.guard&&!destination.guard(data)){this.debug(`${debugPrefix} ${destination.target} (guarded)`,debugQuietColor);return}if(!destination){this.debug(`${debugPrefix} ${this.state}`,debugQuietColor);return}const destinationState=this.getDestinationState(destination),exitFn=destinationState===this.state?void 0:currentStateConfig.onExit;this.debug(`${debugPrefix} ${destinationState}`,debugColor),this.state=destinationState,typeof destination=="function"?destination(data):typeof destination=="object"&&!(destination instanceof _a37)&&((_a274=destination.action)==null||_a274.call(destination,data)),exitFn==null||exitFn(),(_b=this.enterEach)==null||_b.call(this,currentState,destinationState),destinationState!==currentState&&destinationState!==_a37.child&&destinationState!==_a37.parent&&((_d=(_c=this.states[destinationState]).onEnter)==null||_d.call(_c,currentState,data))}transitionAsync(event,data){setTimeout(()=>{this.transition(event,data)},0)}is(value){return this.state===_a37.child&&this.childState?this.childState.is(value):this.state===value}resetHierarchy(){this.debug(`%c${this.constructor.name} | ${this.state} -> [resetHierarchy] -> ${this.defaultState}`,"color: green"),this.state=this.defaultState}transitionChild(event,data){var _a274,_b;return this.state!==_a37.child||!this.childState||(this.childState.transition(event,data),!this.childState.is(_a37.parent))?!0:(this.debug(`%c${this.constructor.name} | ${this.state} -> ${event} -> ${this.defaultState}`,debugColor),this.state=this.defaultState,(_b=(_a274=this.states[this.state]).onEnter)==null||_b.call(_a274),this.childState.resetHierarchy(),!1)}getDestinationState(destination){let state=this.state;return typeof destination=="string"?state=destination:destination instanceof _a37?(this.childState=destination,state=_a37.child):typeof destination=="object"&&(destination.target instanceof _a37?(this.childState=destination.target,state=_a37.child):destination.target!=null&&(state=destination.target)),state}},__name(_a37,"_StateMachine"),_a37);_StateMachine.child="__child";_StateMachine.parent="__parent";var StateMachine=_StateMachine,_a38,TextWrapper=(_a38=class{static wrapText(text,options){return this.wrapLines(text,options).join(`
`)}static wrapLines(text,options){const clippedResult=this.textWrap(text,options);return options.overflow==="hide"&&clippedResult.some(l=>l.endsWith(TextUtils.EllipsisChar))?[]:clippedResult}static appendEllipsis(text){return text.replace(/[.,]{1,5}$/,"")+TextUtils.EllipsisChar}static truncateLine(text,measurer,maxWidth,ellipsisForce){const ellipsisWidth=measurer.textWidth(TextUtils.EllipsisChar);let estimatedWidth=0,i=0;for(;i<text.length;i++){const charWidth=measurer.textWidth(text.charAt(i));if(estimatedWidth+charWidth>maxWidth)break;estimatedWidth+=charWidth}if(text.length===i&&(!ellipsisForce||estimatedWidth+ellipsisWidth<=maxWidth))return ellipsisForce?text+TextUtils.EllipsisChar:text;for(text=text.slice(0,i).trimEnd();text.length&&measurer.textWidth(text)+ellipsisWidth>maxWidth;)text=text.slice(0,-1).trimEnd();return text+TextUtils.EllipsisChar}static textWrap(text,options){const lines=text.split(TextUtils.lineSplitter),measurer=CachedTextMeasurerPool.getMeasurer(options);if(options.textWrap==="never")return lines.map(line=>this.truncateLine(line.trimEnd(),measurer,options.maxWidth));const result=[],wrapHyphenate=options.textWrap==="hyphenate",wrapOnSpace=options.textWrap==null||options.textWrap==="on-space";for(let line of lines){if(line=line.trimEnd(),line===""){result.push(line);continue}for(let i=0,estimatedWidth=0,lastSpaceIndex=0;i<line.length;i++){const char=line.charAt(i);if(estimatedWidth+=measurer.textWidth(char),char===" "&&(lastSpaceIndex=i),estimatedWidth>options.maxWidth){if(i===0)break;const actualWidth=measurer.textWidth(line.slice(0,i+1));if(actualWidth<=options.maxWidth){estimatedWidth=actualWidth;continue}if(lastSpaceIndex){const nextWord=this.getWordAt(line,lastSpaceIndex+1),textWidth=measurer.textWidth(nextWord);if(textWidth<=options.maxWidth){result.push(line.slice(0,lastSpaceIndex).trimEnd()),line=line.slice(lastSpaceIndex).trimStart(),i=-1,estimatedWidth=0,lastSpaceIndex=0;continue}else wrapOnSpace&&textWidth>options.maxWidth&&result.push(line.slice(0,lastSpaceIndex).trimEnd(),this.truncateLine(line.slice(lastSpaceIndex).trimStart(),measurer,options.maxWidth,!0))}else wrapOnSpace&&result.push(this.truncateLine(line,measurer,options.maxWidth,!0));if(wrapOnSpace){line="";break}const postfix=wrapHyphenate?"-":"";let newLine=line.slice(0,i).trim();for(;newLine.length&&measurer.textWidth(newLine+postfix)>options.maxWidth;)newLine=newLine.slice(0,-1).trimEnd();if(result.push(newLine+postfix),!newLine.length){line="";break}line=line.slice(newLine.length).trimStart(),i=-1,estimatedWidth=0,lastSpaceIndex=0}}line&&result.push(line)}return this.avoidOrphans(result,measurer,options),this.clipLines(result,measurer,options)}static getWordAt(text,position){const nextSpaceIndex=text.indexOf(" ",position);return nextSpaceIndex===-1?text.slice(position):text.slice(position,nextSpaceIndex)}static clipLines(lines,measurer,options){if(!options.maxHeight)return lines;const{height,lineMetrics}=measurer.measureLines(lines);if(height<=options.maxHeight)return lines;for(let i=0,cumulativeHeight=0;i<lineMetrics.length;i++){const{lineHeight}=lineMetrics[i];if(cumulativeHeight+=lineHeight,cumulativeHeight>options.maxHeight){if(options.overflow==="hide")return[];const clippedResults=lines.slice(0,i||1),lastLine=clippedResults.pop();return clippedResults.concat(this.truncateLine(lastLine,measurer,options.maxWidth,!0))}}return lines}static avoidOrphans(lines,measurer,options){if(options.avoidOrphans===!1||lines.length<2)return;const{length:length2}=lines,lastLine=lines[length2-1],beforeLast=lines[length2-2];if(beforeLast.length<lastLine.length)return;const lastSpaceIndex=beforeLast.lastIndexOf(" ");if(lastSpaceIndex===-1||lastSpaceIndex===beforeLast.indexOf(" ")||lastLine.includes(" "))return;const lastWord=beforeLast.slice(lastSpaceIndex+1);measurer.textWidth(lastLine+lastWord)<=options.maxWidth&&(lines[length2-2]=beforeLast.slice(0,lastSpaceIndex),lines[length2-1]=lastWord+" "+lastLine)}},__name(_a38,"TextWrapper"),_a38);function setAttribute(e,qualifiedName,value){value===void 0||value===""?e==null||e.removeAttribute(qualifiedName):e==null||e.setAttribute(qualifiedName,value.toString())}__name(setAttribute,"setAttribute");function setAttributes(e,attrs){if(attrs==null)return;let key;for(key in attrs)key!=="class"&&setAttribute(e,key,attrs[key])}__name(setAttributes,"setAttributes");function calculatePlacement(naturalWidth,naturalHeight,container,bounds){let{top,right,bottom,left,width,height}=bounds;return left!=null?width!=null?right=container.width-left+width:right!=null&&(width=container.width-left-right):right!=null&&width!=null&&(left=container.width-right-width),top!=null?height!=null?bottom=container.height-top-height:bottom!=null&&(height=container.height-bottom-top):bottom!=null&&height!=null&&(top=container.height-bottom-height),width==null?height==null?(width=naturalWidth,height=naturalHeight):width=Math.ceil(naturalWidth*height/naturalHeight):height==null&&(height=Math.ceil(naturalHeight*width/naturalWidth)),left==null&&(right==null?left=Math.floor((container.width-width)/2):left=container.width-right-width),top==null&&(bottom==null?top=Math.floor((container.height-height)/2):top=container.height-height-bottom),{x:left,y:top,width,height}}__name(calculatePlacement,"calculatePlacement");var DEFAULT_TOOLTIP_CLASS="ag-chart-tooltip",DEFAULT_TOOLTIP_DARK_CLASS="ag-chart-dark-tooltip",EMPTY_TOOLTIP_CONTENT={html:"",ariaLabel:""};function toAccessibleText(inputHtml){const lineConverter=__name((_match,offset4,str)=>offset4===0||str[offset4-1]!=="."?". ":" ","lineConverter");return inputHtml.replace(/<br\s*\/?>/g,lineConverter).replace(/<\/p\s+>/g,lineConverter).replace(/<\/li\s*>/g,lineConverter).replace(/<[^<>]+>/g,"").replace(/\n+/g," ").replace(/\s+/g," ")}__name(toAccessibleText,"toAccessibleText");function toTooltipHtml(input,defaults){if(typeof input=="string")return{html:input,ariaLabel:input};const{content=(defaults==null?void 0:defaults.content)??"",title=defaults==null?void 0:defaults.title,color=(defaults==null?void 0:defaults.color)??"white",backgroundColor=(defaults==null?void 0:defaults.backgroundColor)??"#888"}=input,titleHtml=title?`<div class="${DEFAULT_TOOLTIP_CLASS}-title"
        style="color: ${color}; background-color: ${backgroundColor}">${title}</div>`:"",titleAria=title?`${title}: `:"",contentHtml=content?`<div class="${DEFAULT_TOOLTIP_CLASS}-content">${content}</div>`:"";return{html:`${titleHtml}${contentHtml}`,ariaLabel:toAccessibleText(`${titleAria}${content}`)}}__name(toTooltipHtml,"toTooltipHtml");var _a39,TooltipPosition=(_a39=class extends BaseProperties{constructor(){super(...arguments),this.type="pointer",this.xOffset=0,this.yOffset=0}},__name(_a39,"TooltipPosition"),_a39);__decorateClass([Validate(UNION(["pointer","node","top","right","bottom","left","top-left","top-right","bottom-right","bottom-left"],"a position type"))],TooltipPosition.prototype,"type",2);__decorateClass([Validate(NUMBER)],TooltipPosition.prototype,"xOffset",2);__decorateClass([Validate(NUMBER)],TooltipPosition.prototype,"yOffset",2);var _a40,Tooltip=(_a40=class extends BaseProperties{constructor(){super(),this.enabled=!0,this.delay=0,this.range=void 0,this.wrapping="hyphenate",this.position=new TooltipPosition,this.darkTheme=!1,this.bounds="extended",this.enableInteraction=!1,this.lastVisibilityChange=Date.now(),this.wrapTypes=["always","hyphenate","on-space","never"],this.showTimeout=0,this._showArrow=!0}get interactive(){return this.enableInteraction}setup(domManager){this.element=domManager.addChild("canvas-overlay",DEFAULT_TOOLTIP_CLASS),this.element.classList.add(DEFAULT_TOOLTIP_CLASS),setAttribute(this.element,"aria-hidden",!0)}destroy(domManager){domManager.removeChild("canvas-overlay",DEFAULT_TOOLTIP_CLASS)}isVisible(){var _a274;return!((_a274=this.element)!=null&&_a274.classList.contains(DEFAULT_TOOLTIP_CLASS+"-hidden"))}show(boundingRect,canvasRect,meta,content,instantly=!1){var _a274,_b,_c;const{element:element2}=this,existingPosition=element2==null?void 0:element2.getBoundingClientRect();if(content!=null&&element2!=null)element2.innerHTML=content.html;else if(!(element2!=null&&element2.innerHTML)){this.toggle(!1);return}const positionType=((_a274=meta.position)==null?void 0:_a274.type)??this.position.type,xOffset=((_b=meta.position)==null?void 0:_b.xOffset)??0,yOffset=((_c=meta.position)==null?void 0:_c.yOffset)??0,tooltipBounds=this.getTooltipBounds({positionType,meta,yOffset,xOffset,canvasRect}),relativeRect={x:boundingRect.x-canvasRect.x,y:boundingRect.y-canvasRect.y,width:boundingRect.width,height:boundingRect.height},position=calculatePlacement(element2.clientWidth,element2.clientHeight,relativeRect,tooltipBounds),minX=relativeRect.x,minY=relativeRect.y,maxX=relativeRect.width-element2.clientWidth-1+minX,maxY=relativeRect.height-element2.clientHeight+minY,left=clamp(minX,position.x,maxX),top=clamp(minY,position.y,maxY);let willExistOutsideBoundingRectDuringTransition=!1;if(existingPosition!=null){const maxXWithPreviousPosition=relativeRect.width-existingPosition.width-1+minX,maxYWithPreviousPosition=relativeRect.height-existingPosition.height+minY;willExistOutsideBoundingRectDuringTransition=maxXWithPreviousPosition>maxX||maxYWithPreviousPosition>maxY}const constrained=left!==position.x||top!==position.y,defaultShowArrow=(positionType==="node"||positionType==="pointer")&&!constrained&&!xOffset&&!yOffset,showArrow=meta.showArrow??this.showArrow??defaultShowArrow;this.updateShowArrow(showArrow),willExistOutsideBoundingRectDuringTransition&&(element2.style.transition="none"),element2.style.transform=`translate(${Math.round(left)}px, ${Math.round(top)}px)`,willExistOutsideBoundingRectDuringTransition&&(element2.style.transition=""),element2.style.pointerEvents=meta.enableInteraction?"auto":"none",element2.setAttribute("data-pointer-capture","retain"),this.enableInteraction=meta.enableInteraction??!1,this.delay>0&&!instantly?(this.toggle(!1),this.showTimeout=setTimeout(()=>{this.toggle(!0)},this.delay)):this.toggle(!0)}toggle(visible){if(!this.element)return;const{classList}=this.element,toggleClass=__name((name,include)=>classList.toggle(`${DEFAULT_TOOLTIP_CLASS}-${name}`,include),"toggleClass"),wasVisible=this.isVisible();let timeSinceLastVisibilityChangeMs=1/0;if(visible||clearTimeout(this.showTimeout),wasVisible!==visible){const now=Date.now();timeSinceLastVisibilityChangeMs=now-this.lastVisibilityChange,this.lastVisibilityChange=now}const animatedMoveThresholdMs=100,thrashingThresholdMs=5,noAnimation=!wasVisible&&visible&&timeSinceLastVisibilityChangeMs>animatedMoveThresholdMs;timeSinceLastVisibilityChangeMs>thrashingThresholdMs&&toggleClass("no-animation",noAnimation),toggleClass("no-interaction",!this.enableInteraction),toggleClass("hidden",!visible),toggleClass("arrow",this._showArrow),classList.toggle(DEFAULT_TOOLTIP_DARK_CLASS,this.darkTheme);for(const wrapType of this.wrapTypes)classList.toggle(`${DEFAULT_TOOLTIP_CLASS}-wrap-${wrapType}`,wrapType===this.wrapping)}updateShowArrow(show){this._showArrow=show}getTooltipBounds(opts){if(!this.element)return{};const{positionType,meta,yOffset,xOffset,canvasRect}=opts,{clientWidth:tooltipWidth,clientHeight:tooltipHeight}=this.element,bounds={width:tooltipWidth,height:tooltipHeight};switch(positionType){case"node":case"pointer":return bounds.top=meta.offsetY+yOffset-tooltipHeight-8,bounds.left=meta.offsetX+xOffset-tooltipWidth/2,bounds;case"top":return bounds.top=yOffset,bounds.left=canvasRect.width/2-tooltipWidth/2+xOffset,bounds;case"right":return bounds.top=canvasRect.height/2-tooltipHeight/2+yOffset,bounds.left=canvasRect.width-tooltipWidth/2+xOffset,bounds;case"left":return bounds.top=canvasRect.height/2-tooltipHeight/2+yOffset,bounds.left=xOffset,bounds;case"bottom":return bounds.top=canvasRect.height-tooltipHeight+yOffset,bounds.left=canvasRect.width/2-tooltipWidth/2+xOffset,bounds;case"top-left":return bounds.top=yOffset,bounds.left=xOffset,bounds;case"top-right":return bounds.top=yOffset,bounds.left=canvasRect.width-tooltipWidth+xOffset,bounds;case"bottom-right":return bounds.top=canvasRect.height-tooltipHeight+yOffset,bounds.left=canvasRect.width-tooltipWidth+xOffset,bounds;case"bottom-left":return bounds.top=canvasRect.height-tooltipHeight+yOffset,bounds.left=xOffset,bounds}}},__name(_a40,"Tooltip"),_a40);__decorateClass([Validate(BOOLEAN)],Tooltip.prototype,"enabled",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],Tooltip.prototype,"showArrow",2);__decorateClass([ObserveChanges((target,newValue,oldValue)=>{var _a274,_b;newValue&&((_a274=target.element)==null||_a274.classList.add(newValue)),oldValue&&((_b=target.element)==null||_b.classList.remove(oldValue))}),Validate(STRING,{optional:!0})],Tooltip.prototype,"class",2);__decorateClass([Validate(POSITIVE_NUMBER)],Tooltip.prototype,"delay",2);__decorateClass([Validate(INTERACTION_RANGE,{optional:!0})],Tooltip.prototype,"range",2);__decorateClass([Validate(TEXT_WRAP)],Tooltip.prototype,"wrapping",2);__decorateClass([Validate(OBJECT)],Tooltip.prototype,"position",2);__decorateClass([Validate(BOOLEAN)],Tooltip.prototype,"darkTheme",2);__decorateClass([Validate(UNION(["extended","canvas"]))],Tooltip.prototype,"bounds",2);var _a41,Caption=(_a41=class extends BaseProperties{constructor(){super(...arguments),this.id=createId(this),this.node=new RotatableText({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(moduleCtx){const{regionManager,proxyInteractionService,layoutManager}=moduleCtx,region=regionManager.getRegion("root"),destroyFns=[layoutManager.addListener("layout:complete",()=>this.updateA11yText(proxyInteractionService)),region.addListener("hover",event=>this.handleMouseMove(moduleCtx,event)),region.addListener("leave",event=>this.handleMouseLeave(moduleCtx,event))];return joinFunctions(...destroyFns)}computeTextWrap(containerWidth,containerHeight){const{text,padding,wrapping}=this,maxWidth=Math.min(this.maxWidth??1/0,containerWidth)-padding*2,maxHeight=this.maxHeight??containerHeight-padding*2;if(!isFinite(maxWidth)&&!isFinite(maxHeight)){this.node.text=text;return}const wrappedText=TextWrapper.wrapText(text??"",{maxWidth,maxHeight,font:this,textWrap:wrapping});this.node.text=wrappedText,this.truncated=wrappedText.includes(TextUtils.EllipsisChar)}updateA11yText(proxyService){var _a274;if(this.enabled&&this.text){const bbox=Transformable.toCanvas(this.node);if(bbox){const{id}=this;this.proxyText??(this.proxyText=proxyService.createProxyElement({type:"text",id,parent:"canvas-proxy"})),this.proxyText.textContent=this.text,this.proxyText.updateBounds(bbox)}}else(_a274=this.proxyText)==null||_a274.remove(),this.proxyText=void 0}handleMouseMove(moduleCtx,event){if(event!==void 0&&this.enabled&&this.node.visible&&this.truncated){const{offsetX,offsetY}=event;moduleCtx.tooltipManager.updateTooltip(this.id,{offsetX,offsetY,lastPointerEvent:event,showArrow:!1},toTooltipHtml({content:this.text}))}}handleMouseLeave(moduleCtx,_event){moduleCtx.tooltipManager.removeTooltip(this.id)}},__name(_a41,"Caption"),_a41);Caption.SMALL_PADDING=10;Caption.LARGE_PADDING=20;__decorateClass([Validate(BOOLEAN),ProxyPropertyOnWrite("node","visible")],Caption.prototype,"enabled",2);__decorateClass([Validate(STRING,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"text",2);__decorateClass([Validate(TEXT_ALIGN,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"textAlign",2);__decorateClass([Validate(FONT_STYLE,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER),ProxyPropertyOnWrite("node")],Caption.prototype,"fontSize",2);__decorateClass([Validate(STRING),ProxyPropertyOnWrite("node")],Caption.prototype,"fontFamily",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),ProxyPropertyOnWrite("node","fill")],Caption.prototype,"color",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"spacing",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"maxHeight",2);__decorateClass([Validate(TEXT_WRAP)],Caption.prototype,"wrapping",2);__decorateClass([Validate(POSITIVE_NUMBER)],Caption.prototype,"padding",2);__decorateClass([Validate(STRING)],Caption.prototype,"layoutStyle",2);var _a42,Range=(_a42=class extends Shape{constructor(opts={}){super(opts),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.startLine=!1,this.endLine=!1,this.isRange=!1,this.restoreOwnStyles()}computeBBox(){return new BBox(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1)}isPointInPath(_x,_y){return!1}render(renderCtx){var _a274;const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}let{x1,y1,x2,y2}=this;x1=this.align(x1),y1=this.align(y1),x2=this.align(x2),y2=this.align(y2);const{fill,opacity,isRange}=this;if(!!(isRange&&fill)){const{fillOpacity}=this;this.applyFill(ctx),ctx.globalAlpha=opacity*fillOpacity,ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y1),ctx.lineTo(x2,y2),ctx.lineTo(x1,y2),ctx.closePath(),ctx.fill()}const{stroke,strokeWidth,startLine,endLine}=this;if(!!((startLine||endLine)&&stroke&&strokeWidth)){const{strokeOpacity,lineDash,lineDashOffset,lineCap,lineJoin}=this;ctx.strokeStyle=stroke,ctx.globalAlpha=opacity*strokeOpacity,ctx.lineWidth=strokeWidth,lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),ctx.beginPath(),startLine&&(ctx.moveTo(x1,y1),ctx.lineTo(x2,y1)),endLine&&(ctx.moveTo(x2,y2),ctx.lineTo(x1,y2)),ctx.stroke()}(_a274=this.fillShadow)==null||_a274.markClean(),super.render(renderCtx)}},__name(_a42,"Range"),_a42);Range.className="Range";Range.defaultStyles={...Shape.defaultStyles,strokeWidth:1};__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"x1",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"y1",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"x2",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"y2",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"startLine",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"endLine",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"isRange",2);var _a43,Label=(_a43=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}getFont(){return TextUtils.toFontString(this)}},__name(_a43,"Label"),_a43);__decorateClass([Validate(BOOLEAN)],Label.prototype,"enabled",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],Label.prototype,"color",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],Label.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0})],Label.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],Label.prototype,"fontSize",2);__decorateClass([Validate(STRING)],Label.prototype,"fontFamily",2);__decorateClass([Validate(FUNCTION,{optional:!0})],Label.prototype,"formatter",2);function calculateLabelRotation(opts){const{parallelFlipRotation=0,regularFlipRotation=0}=opts,configuredRotation=opts.rotation?normalizeAngle360(toRadians(opts.rotation)):0,parallelFlipFlag=!configuredRotation&&parallelFlipRotation>=0&&parallelFlipRotation<=Math.PI?-1:1,regularFlipFlag=!configuredRotation&&regularFlipRotation>=0&&regularFlipRotation<=Math.PI?-1:1;let defaultRotation=0;return opts.parallel?defaultRotation=parallelFlipFlag*Math.PI/2:regularFlipFlag===-1&&(defaultRotation=Math.PI),{configuredRotation,defaultRotation,parallelFlipFlag,regularFlipFlag}}__name(calculateLabelRotation,"calculateLabelRotation");function getLabelSpacing(minSpacing,rotated){return isNaN(minSpacing)?rotated?0:10:minSpacing}__name(getLabelSpacing,"getLabelSpacing");function getTextBaseline(parallel,labelRotation,sideFlag,parallelFlipFlag){return parallel&&!labelRotation?sideFlag*parallelFlipFlag===-1?"hanging":"bottom":"middle"}__name(getTextBaseline,"getTextBaseline");function getTextAlign(parallel,labelRotation,labelAutoRotation,sideFlag,regularFlipFlag){const labelRotated=labelRotation>0&&labelRotation<=Math.PI,labelAutoRotated=labelAutoRotation>0&&labelAutoRotation<=Math.PI,alignFlag=labelRotated||labelAutoRotated?-1:1;if(parallel)if(labelRotation||labelAutoRotation){if(sideFlag*alignFlag===-1)return"end"}else return"center";else if(sideFlag*regularFlipFlag===-1)return"end";return"start"}__name(getTextAlign,"getTextAlign");function calculateLabelBBox(text,bbox,labelMatrix){const{x:labelX,y:labelY,width,height}=bbox,translatedBBox=new BBox(labelX,labelY,0,0);labelMatrix.transformBBox(translatedBBox,bbox);const{x,y}=bbox;return{point:{x,y},label:{text,width,height}}}__name(calculateLabelBBox,"calculateLabelBBox");var Layers=(Layers2=>(Layers2[Layers2.SERIES_BACKGROUND_ZINDEX=0]="SERIES_BACKGROUND_ZINDEX",Layers2[Layers2.AXIS_GRID_ZINDEX=1]="AXIS_GRID_ZINDEX",Layers2[Layers2.AXIS_ZINDEX=2]="AXIS_ZINDEX",Layers2[Layers2.SERIES_CROSSLINE_RANGE_ZINDEX=3]="SERIES_CROSSLINE_RANGE_ZINDEX",Layers2[Layers2.SERIES_LAYER_ZINDEX=4]="SERIES_LAYER_ZINDEX",Layers2[Layers2.SERIES_HIGHLIGHT_ZINDEX=5]="SERIES_HIGHLIGHT_ZINDEX",Layers2[Layers2.AXIS_FOREGROUND_ZINDEX=6]="AXIS_FOREGROUND_ZINDEX",Layers2[Layers2.SERIES_CROSSHAIR_ZINDEX=7]="SERIES_CROSSHAIR_ZINDEX",Layers2[Layers2.CHART_OVERLAY_ZINDEX=8]="CHART_OVERLAY_ZINDEX",Layers2[Layers2.SERIES_LABEL_ZINDEX=9]="SERIES_LABEL_ZINDEX",Layers2[Layers2.SERIES_CROSSLINE_LINE_ZINDEX=10]="SERIES_CROSSLINE_LINE_ZINDEX",Layers2[Layers2.SERIES_ANNOTATION_ZINDEX=11]="SERIES_ANNOTATION_ZINDEX",Layers2[Layers2.CHART_ANNOTATION_ZINDEX=12]="CHART_ANNOTATION_ZINDEX",Layers2[Layers2.CHART_ANNOTATION_FOCUSED_ZINDEX=13]="CHART_ANNOTATION_FOCUSED_ZINDEX",Layers2[Layers2.LEGEND_ZINDEX=14]="LEGEND_ZINDEX",Layers2[Layers2.NAVIGATOR_ZINDEX=15]="NAVIGATOR_ZINDEX",Layers2[Layers2.FOREGROUND_ZINDEX=16]="FOREGROUND_ZINDEX",Layers2))(Layers||{});function isStringObject(value){return value!=null&&Object.hasOwn(value,"toString")&&isString(value.toString())}__name(isStringObject,"isStringObject");function isNumberObject(value){return value!=null&&Object.hasOwn(value,"valueOf")&&isFiniteNumber(value.valueOf())}__name(isNumberObject,"isNumberObject");function isContinuous(value){return isFiniteNumber(value)||isValidDate(value)||isNumberObject(value)}__name(isContinuous,"isContinuous");function checkDatum(value,isContinuousScale){return value!=null&&(!isContinuousScale||isContinuous(value))}__name(checkDatum,"checkDatum");function transformIntegratedCategoryValue(value){return isStringObject(value)&&Object.hasOwn(value,"id")?value.id:value}__name(transformIntegratedCategoryValue,"transformIntegratedCategoryValue");var MATCHING_CROSSLINE_TYPE=__name(property=>property==="value"?predicateWithMessage((_,ctx)=>ctx.target.type==="line",ctx=>ctx.target.type==="range"?"crossLine type 'range' to have a 'range' property instead of 'value'":"crossLine property 'type' to be 'line'"):predicateWithMessage((_,ctx)=>ctx.target.type==="range",ctx=>ctx.target.type==="line"?"crossLine type 'line' to have a 'value' property instead of 'range'":"crossLine property 'type' to be 'range'"),"MATCHING_CROSSLINE_TYPE"),validateCrossLineValues=__name((type,value,range3,scale2,visibilityCheck)=>{const lineCrossLine=type==="line"&&value!==void 0,rangeCrossLine=type==="range"&&range3!==void 0;if(!lineCrossLine&&!rangeCrossLine)return!0;const[start,end]=range3??[value,void 0],isContinuous2=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),validStart=checkDatum(start,isContinuous2)&&!isNaN(scale2.convert(start)),validEnd=checkDatum(end,isContinuous2)&&!isNaN(scale2.convert(end));if(lineCrossLine&&validStart||rangeCrossLine&&validStart&&validEnd)return(visibilityCheck==null?void 0:visibilityCheck())??!0;const message=["Expecting crossLine"];return rangeCrossLine?(validStart||message.push(`range start ${stringify(start)}`),validEnd||message.push(`${validStart?"":"and "}range end ${stringify(end)}`)):message.push(`value ${stringify(start)}`),message.push("to match the axis scale domain."),Logger.warnOnce(message.join(" ")),!1},"validateCrossLineValues"),horizontalCrosslineTranslationDirections={top:{xTranslationDirection:0,yTranslationDirection:-1},bottom:{xTranslationDirection:0,yTranslationDirection:1},left:{xTranslationDirection:-1,yTranslationDirection:0},right:{xTranslationDirection:1,yTranslationDirection:0},topLeft:{xTranslationDirection:1,yTranslationDirection:-1},topRight:{xTranslationDirection:-1,yTranslationDirection:-1},bottomLeft:{xTranslationDirection:1,yTranslationDirection:1},bottomRight:{xTranslationDirection:-1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},insideLeft:{xTranslationDirection:1,yTranslationDirection:0},insideRight:{xTranslationDirection:-1,yTranslationDirection:0},insideTop:{xTranslationDirection:0,yTranslationDirection:1},insideBottom:{xTranslationDirection:0,yTranslationDirection:-1},insideTopLeft:{xTranslationDirection:1,yTranslationDirection:1},insideBottomLeft:{xTranslationDirection:1,yTranslationDirection:-1},insideTopRight:{xTranslationDirection:-1,yTranslationDirection:1},insideBottomRight:{xTranslationDirection:-1,yTranslationDirection:-1}},verticalCrossLineTranslationDirections={top:{xTranslationDirection:1,yTranslationDirection:0},bottom:{xTranslationDirection:-1,yTranslationDirection:0},left:{xTranslationDirection:0,yTranslationDirection:-1},right:{xTranslationDirection:0,yTranslationDirection:1},topLeft:{xTranslationDirection:-1,yTranslationDirection:-1},topRight:{xTranslationDirection:-1,yTranslationDirection:1},bottomLeft:{xTranslationDirection:1,yTranslationDirection:-1},bottomRight:{xTranslationDirection:1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},insideLeft:{xTranslationDirection:0,yTranslationDirection:1},insideRight:{xTranslationDirection:0,yTranslationDirection:-1},insideTop:{xTranslationDirection:-1,yTranslationDirection:0},insideBottom:{xTranslationDirection:1,yTranslationDirection:0},insideTopLeft:{xTranslationDirection:-1,yTranslationDirection:1},insideBottomLeft:{xTranslationDirection:1,yTranslationDirection:1},insideTopRight:{xTranslationDirection:-1,yTranslationDirection:-1},insideBottomRight:{xTranslationDirection:1,yTranslationDirection:-1}};function calculateLabelTranslation({yDirection,padding=0,position="top",bbox}){const crossLineTranslationDirections=yDirection?horizontalCrosslineTranslationDirections:verticalCrossLineTranslationDirections,{xTranslationDirection,yTranslationDirection}=crossLineTranslationDirections[position],xTranslation=xTranslationDirection*(padding+bbox.width/2),yTranslation=yTranslationDirection*(padding+bbox.height/2);return{xTranslation,yTranslation}}__name(calculateLabelTranslation,"calculateLabelTranslation");function calculateLabelChartPadding({yDirection,bbox,padding=0,position="top"}){const chartPadding={};return position.startsWith("inside")||(position==="top"&&!yDirection?chartPadding.top=padding+bbox.height:position==="bottom"&&!yDirection?chartPadding.bottom=padding+bbox.height:position==="left"&&yDirection?chartPadding.left=padding+bbox.width:position==="right"&&yDirection&&(chartPadding.right=padding+bbox.width)),chartPadding}__name(calculateLabelChartPadding,"calculateLabelChartPadding");var POSITION_TOP_COORDINATES=__name(({yDirection,xEnd,yStart,yEnd})=>yDirection?{x:xEnd/2,y:yStart}:{x:xEnd,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2},"POSITION_TOP_COORDINATES"),POSITION_LEFT_COORDINATES=__name(({yDirection,xStart,xEnd,yStart,yEnd})=>yDirection?{x:xStart,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}:{x:xEnd/2,y:yStart},"POSITION_LEFT_COORDINATES"),POSITION_RIGHT_COORDINATES=__name(({yDirection,xEnd,yStart,yEnd})=>yDirection?{x:xEnd,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}:{x:xEnd/2,y:isNaN(yEnd)?yStart:yEnd},"POSITION_RIGHT_COORDINATES"),POSITION_BOTTOM_COORDINATES=__name(({yDirection,xStart,xEnd,yStart,yEnd})=>yDirection?{x:xEnd/2,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2},"POSITION_BOTTOM_COORDINATES"),POSITION_INSIDE_COORDINATES=__name(({xEnd,yStart,yEnd})=>({x:xEnd/2,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}),"POSITION_INSIDE_COORDINATES"),POSITION_TOP_LEFT_COORDINATES=__name(({yDirection,xStart,xEnd,yStart})=>yDirection?{x:xStart/2,y:yStart}:{x:xEnd,y:yStart},"POSITION_TOP_LEFT_COORDINATES"),POSITION_BOTTOM_LEFT_COORDINATES=__name(({yDirection,xStart,yStart,yEnd})=>yDirection?{x:xStart,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:yStart},"POSITION_BOTTOM_LEFT_COORDINATES"),POSITION_TOP_RIGHT_COORDINATES=__name(({yDirection,xEnd,yStart,yEnd})=>yDirection?{x:xEnd,y:yStart}:{x:xEnd,y:isNaN(yEnd)?yStart:yEnd},"POSITION_TOP_RIGHT_COORDINATES"),POSITION_BOTTOM_RIGHT_COORDINATES=__name(({yDirection,xStart,xEnd,yStart,yEnd})=>yDirection?{x:xEnd,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:isNaN(yEnd)?yStart:yEnd},"POSITION_BOTTOM_RIGHT_COORDINATES"),labelDirectionHandling={top:{c:POSITION_TOP_COORDINATES},bottom:{c:POSITION_BOTTOM_COORDINATES},left:{c:POSITION_LEFT_COORDINATES},right:{c:POSITION_RIGHT_COORDINATES},topLeft:{c:POSITION_TOP_LEFT_COORDINATES},topRight:{c:POSITION_TOP_RIGHT_COORDINATES},bottomLeft:{c:POSITION_BOTTOM_LEFT_COORDINATES},bottomRight:{c:POSITION_BOTTOM_RIGHT_COORDINATES},inside:{c:POSITION_INSIDE_COORDINATES},insideLeft:{c:POSITION_LEFT_COORDINATES},insideRight:{c:POSITION_RIGHT_COORDINATES},insideTop:{c:POSITION_TOP_COORDINATES},insideBottom:{c:POSITION_BOTTOM_COORDINATES},insideTopLeft:{c:POSITION_TOP_LEFT_COORDINATES},insideBottomLeft:{c:POSITION_BOTTOM_LEFT_COORDINATES},insideTopRight:{c:POSITION_TOP_RIGHT_COORDINATES},insideBottomRight:{c:POSITION_BOTTOM_RIGHT_COORDINATES}},CROSSLINE_LABEL_POSITION=UNION(["top","left","right","bottom","topLeft","topRight","bottomLeft","bottomRight","inside","insideLeft","insideRight","insideTop","insideBottom","insideTopLeft","insideBottomLeft","insideTopRight","insideBottomRight"],"crossLine label position"),_a44,CartesianCrossLineLabel=(_a44=class extends BaseProperties{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}},__name(_a44,"CartesianCrossLineLabel"),_a44);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianCrossLineLabel.prototype,"enabled",2);__decorateClass([Validate(STRING,{optional:!0})],CartesianCrossLineLabel.prototype,"text",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],CartesianCrossLineLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0})],CartesianCrossLineLabel.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],CartesianCrossLineLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],CartesianCrossLineLabel.prototype,"fontFamily",2);__decorateClass([Validate(NUMBER)],CartesianCrossLineLabel.prototype,"padding",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],CartesianCrossLineLabel.prototype,"color",2);__decorateClass([Validate(CROSSLINE_LABEL_POSITION,{optional:!0})],CartesianCrossLineLabel.prototype,"position",2);__decorateClass([Validate(DEGREE,{optional:!0})],CartesianCrossLineLabel.prototype,"rotation",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianCrossLineLabel.prototype,"parallel",2);var _a45,_CartesianCrossLine=(_a45=class extends BaseProperties{constructor(){super(),this.id=createId(this),this.label=new CartesianCrossLineLabel,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction="x",this.group=new Group({name:`${this.id}`,layer:!0,zIndex:_a45.LINE_LAYER_ZINDEX}),this.labelGroup=new Group({name:`${this.id}`,layer:!0,zIndex:_a45.LABEL_LAYER_ZINDEX}),this.crossLineRange=new Range,this.crossLineLabel=new TransformableText,this.labelPoint=void 0,this.data=[],this.startLine=!1,this.endLine=!1,this.isRange=!1,this.group.append(this.crossLineRange),this.labelGroup.append(this.crossLineLabel),this.crossLineRange.pointerEvents=1}update(visible){const{enabled,data,type,value,range:range3,scale:scale2}=this;if(!type||!scale2||!enabled||!visible||!validateCrossLineValues(type,value,range3,scale2)||data.length===0){this.group.visible=!1,this.labelGroup.visible=!1;return}this.group.visible=visible,this.labelGroup.visible=visible,this.group.zIndex=this.getZIndex(this.isRange),this.updateNodes()}calculateLayout(visible,reversedAxis){if(!visible)return;const{scale:scale2,gridLength,sideFlag,direction,label:{position="top"},clippedRange,strokeWidth=0}=this;if(this.data=[],!scale2)return;const bandwidth=scale2.bandwidth??0,step=scale2.step??0,padding=(reversedAxis?-1:1)*(scale2 instanceof BandScale?(step-bandwidth)/2:0),[xStart,xEnd]=[0,sideFlag*gridLength];let[yStart,yEnd]=this.getRange();const ordinalTimeScalePadding=yEnd===void 0&&OrdinalTimeScale.is(scale2)?bandwidth/2+padding:0;let[clampedYStart,clampedYEnd]=[Number(scale2.convert(yStart,{clampMode:"clamped"}))-padding+ordinalTimeScalePadding,scale2.convert(yEnd,{clampMode:"clamped"})+bandwidth+padding];clampedYStart=clampArray(clampedYStart,clippedRange),clampedYEnd=clampArray(clampedYEnd,clippedRange),[yStart,yEnd]=[Number(scale2.convert(yStart))+ordinalTimeScalePadding,scale2.convert(yEnd)+bandwidth];const validRange=(yStart===clampedYStart||yEnd===clampedYEnd||clampedYStart!==clampedYEnd)&&Math.abs(clampedYEnd-clampedYStart)>0;if(validRange&&clampedYStart>clampedYEnd&&([clampedYStart,clampedYEnd]=[clampedYEnd,clampedYStart],[yStart,yEnd]=[yEnd,yStart]),yStart-padding>=clampedYStart&&(yStart-=padding),yEnd+padding<=clampedYEnd&&(yEnd+=padding),this.isRange=validRange,this.startLine=strokeWidth>0&&yStart>=clampedYStart&&yStart<=clampedYStart+padding,this.endLine=strokeWidth>0&&yEnd>=clampedYEnd-bandwidth-padding&&yEnd<=clampedYEnd,!(!validRange&&!this.startLine&&!this.endLine)&&(this.data=[clampedYStart,clampedYEnd],this.label.enabled)){const yDirection=direction==="y",{c=POSITION_TOP_COORDINATES}=labelDirectionHandling[position]??{},{x:labelX,y:labelY}=c({yDirection,xStart,xEnd,yStart:clampedYStart,yEnd:clampedYEnd});this.labelPoint={x:labelX,y:labelY}}}updateNodes(){this.updateRangeNode(),this.label.enabled&&(this.updateLabel(),this.positionLabel())}updateRangeNode(){const{crossLineRange,sideFlag,gridLength,data,startLine,endLine,isRange,fill,fillOpacity,stroke,strokeWidth,lineDash}=this;crossLineRange.x1=0,crossLineRange.x2=sideFlag*gridLength,crossLineRange.y1=data[0],crossLineRange.y2=data[1],crossLineRange.startLine=startLine,crossLineRange.endLine=endLine,crossLineRange.isRange=isRange,crossLineRange.fill=fill,crossLineRange.fillOpacity=fillOpacity??1,crossLineRange.stroke=stroke,crossLineRange.strokeWidth=strokeWidth??1,crossLineRange.strokeOpacity=this.strokeOpacity??1,crossLineRange.lineDash=lineDash}updateLabel(){const{crossLineLabel,label}=this;label.text&&(crossLineLabel.fontStyle=label.fontStyle,crossLineLabel.fontWeight=label.fontWeight,crossLineLabel.fontSize=label.fontSize,crossLineLabel.fontFamily=label.fontFamily,crossLineLabel.fill=label.color,crossLineLabel.text=label.text)}positionLabel(){const{crossLineLabel,labelPoint:{x=void 0,y=void 0}={},label:{parallel,rotation,position="top",padding=0},direction,parallelFlipRotation,regularFlipRotation}=this;if(x===void 0||y===void 0)return;const{defaultRotation,configuredRotation}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation});crossLineLabel.rotation=defaultRotation+configuredRotation,crossLineLabel.textBaseline="middle",crossLineLabel.textAlign="center";const bbox=crossLineLabel.getBBox();if(!bbox)return;const yDirection=direction==="y",{xTranslation,yTranslation}=calculateLabelTranslation({yDirection,padding,position,bbox});crossLineLabel.translationX=x+xTranslation,crossLineLabel.translationY=y+yTranslation}getZIndex(isRange=!1){return isRange?_a45.RANGE_LAYER_ZINDEX:_a45.LINE_LAYER_ZINDEX}getRange(){const{value,range:range3,scale:scale2}=this,isContinuous2=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),start=(range3==null?void 0:range3[0])??value;let end=range3==null?void 0:range3[1];return!isContinuous2&&end===void 0&&(end=start),isContinuous2&&start===end&&(end=void 0),[start,end]}computeLabelBBox(){const{label}=this;if(!label.enabled)return;const tempText=new TransformableText;tempText.fontFamily=label.fontFamily,tempText.fontSize=label.fontSize,tempText.fontStyle=label.fontStyle,tempText.fontWeight=label.fontWeight,tempText.text=label.text;const{labelPoint:{x=void 0,y=void 0}={},label:{parallel,rotation,position="top",padding=0},direction,parallelFlipRotation,regularFlipRotation}=this;if(x===void 0||y===void 0)return;const{configuredRotation}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation});tempText.rotation=configuredRotation,tempText.textBaseline="middle",tempText.textAlign="center";const bbox=tempText.getBBox();if(!bbox)return;const yDirection=direction==="y",{xTranslation,yTranslation}=calculateLabelTranslation({yDirection,padding,position,bbox});return tempText.x=x+xTranslation,tempText.y=y+yTranslation,tempText.getBBox()}calculatePadding(padding){const{isRange,startLine,endLine,direction,label:{padding:labelPadding=0,position="top"}}=this;if(!isRange&&!startLine&&!endLine)return;const crossLineLabelBBox=this.computeLabelBBox();if((crossLineLabelBBox==null?void 0:crossLineLabelBBox.x)==null||(crossLineLabelBBox==null?void 0:crossLineLabelBBox.y)==null)return;const chartPadding=calculateLabelChartPadding({yDirection:direction==="y",padding:labelPadding,position,bbox:crossLineLabelBBox});padding.left=Math.max(padding.left??0,chartPadding.left??0),padding.right=Math.max(padding.right??0,chartPadding.right??0),padding.top=Math.max(padding.top??0,chartPadding.top??0),padding.bottom=Math.max(padding.bottom??0,chartPadding.bottom??0)}},__name(_a45,"_CartesianCrossLine"),_a45);_CartesianCrossLine.LINE_LAYER_ZINDEX=10;_CartesianCrossLine.RANGE_LAYER_ZINDEX=3;_CartesianCrossLine.LABEL_LAYER_ZINDEX=9;_CartesianCrossLine.className="CrossLine";__decorateClass([Validate(BOOLEAN,{optional:!0})],_CartesianCrossLine.prototype,"enabled",2);__decorateClass([Validate(UNION(["range","line"],"a crossLine type"),{optional:!0})],_CartesianCrossLine.prototype,"type",2);__decorateClass([Validate(AND(MATCHING_CROSSLINE_TYPE("range"),ARRAY.restrict({length:2})),{optional:!0})],_CartesianCrossLine.prototype,"range",2);__decorateClass([Validate(MATCHING_CROSSLINE_TYPE("value"),{optional:!0})],_CartesianCrossLine.prototype,"value",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],_CartesianCrossLine.prototype,"fill",2);__decorateClass([Validate(RATIO,{optional:!0})],_CartesianCrossLine.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],_CartesianCrossLine.prototype,"stroke",2);__decorateClass([Validate(NUMBER,{optional:!0})],_CartesianCrossLine.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO,{optional:!0})],_CartesianCrossLine.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH,{optional:!0})],_CartesianCrossLine.prototype,"lineDash",2);__decorateClass([Validate(OBJECT)],_CartesianCrossLine.prototype,"label",2);var CartesianCrossLine=_CartesianCrossLine,GRID_STYLE_KEYS=["stroke","lineDash"],GRID_STYLE=ARRAY_OF(value=>isObject(value)&&Object.keys(value).every(key=>GRID_STYLE_KEYS.includes(key)),"objects with gridline style properties such as 'stroke' or 'lineDash'"),_a46,AxisGridLine=(_a46=class{constructor(){this.enabled=!0,this.width=1,this.style=[{stroke:void 0,lineDash:[]}]}},__name(_a46,"AxisGridLine"),_a46);__decorateClass([Validate(BOOLEAN)],AxisGridLine.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisGridLine.prototype,"width",2);__decorateClass([Validate(GRID_STYLE)],AxisGridLine.prototype,"style",2);function Default(defaultValue,replaces=[void 0]){return addTransformToInstanceProperty((_,__,v)=>replaces.includes(v)?isFunction(defaultValue)?defaultValue(v):defaultValue:v)}__name(Default,"Default");var TICK_INTERVAL=predicateWithMessage(value=>isFiniteNumber(value)&&value>0||value instanceof TimeInterval,"a non-zero positive Number value or, for a time axis, a Time Interval such as 'agCharts.time.month'"),_a47,AxisInterval=(_a47=class extends BaseProperties{constructor(){super(...arguments),this.minSpacing=NaN,this.maxSpacing=NaN}},__name(_a47,"AxisInterval"),_a47);__decorateClass([Validate(TICK_INTERVAL,{optional:!0})],AxisInterval.prototype,"step",2);__decorateClass([Validate(ARRAY,{optional:!0})],AxisInterval.prototype,"values",2);__decorateClass([Validate(MIN_SPACING),Default(NaN)],AxisInterval.prototype,"minSpacing",2);__decorateClass([Validate(MAX_SPACING),Default(NaN)],AxisInterval.prototype,"maxSpacing",2);var _a48,AxisLabel=(_a48=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.fontSize=12,this.fontFamily="Verdana, sans-serif",this.padding=5,this.minSpacing=NaN,this.color="#575757",this.avoidCollisions=!0,this.mirrored=!1,this.parallel=!1}getSideFlag(){return this.mirrored?1:-1}},__name(_a48,"AxisLabel"),_a48);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"enabled",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],AxisLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0})],AxisLabel.prototype,"fontWeight",2);__decorateClass([Validate(NUMBER.restrict({min:1}))],AxisLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],AxisLabel.prototype,"fontFamily",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisLabel.prototype,"padding",2);__decorateClass([Validate(NUMBER_OR_NAN),Default(NaN)],AxisLabel.prototype,"minSpacing",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisLabel.prototype,"color",2);__decorateClass([Validate(DEGREE,{optional:!0})],AxisLabel.prototype,"rotation",2);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"avoidCollisions",2);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"mirrored",2);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"parallel",2);__decorateClass([Validate(FUNCTION,{optional:!0})],AxisLabel.prototype,"formatter",2);__decorateClass([Validate(STRING,{optional:!0})],AxisLabel.prototype,"format",2);var _a49,AxisLine=(_a49=class{constructor(){this.enabled=!0,this.width=1,this.stroke=void 0}},__name(_a49,"AxisLine"),_a49);__decorateClass([Validate(BOOLEAN)],AxisLine.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisLine.prototype,"width",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisLine.prototype,"stroke",2);var _a50,AxisTick=(_a50=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.width=1,this.size=6}},__name(_a50,"AxisTick"),_a50);__decorateClass([Validate(BOOLEAN)],AxisTick.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisTick.prototype,"width",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisTick.prototype,"size",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisTick.prototype,"stroke",2);var _a51,AxisTitle=(_a51=class extends BaseProperties{constructor(){super(...arguments),this.caption=new Caption,this.enabled=!1,this.spacing=Caption.SMALL_PADDING,this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always"}},__name(_a51,"AxisTitle"),_a51);__decorateClass([Validate(BOOLEAN)],AxisTitle.prototype,"enabled",2);__decorateClass([Validate(STRING,{optional:!0})],AxisTitle.prototype,"text",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],AxisTitle.prototype,"spacing",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],AxisTitle.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0})],AxisTitle.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisTitle.prototype,"fontSize",2);__decorateClass([Validate(STRING)],AxisTitle.prototype,"fontFamily",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisTitle.prototype,"color",2);__decorateClass([Validate(TEXT_WRAP)],AxisTitle.prototype,"wrapping",2);__decorateClass([Validate(FUNCTION,{optional:!0})],AxisTitle.prototype,"formatter",2);function prepareAxisAnimationContext(axis){const[requestedRangeMin,requestedRangeMax]=findMinMax(axis.range),min=Math.floor(requestedRangeMin),max=Math.ceil(requestedRangeMax);return{min,max,visible:min!==max}}__name(prepareAxisAnimationContext,"prepareAxisAnimationContext");var fullCircle=Math.PI*2,halfCircle=fullCircle/2;function normaliseEndRotation(start,end){return Math.abs(end-start)<halfCircle?end:start>end?end+fullCircle:end-fullCircle}__name(normaliseEndRotation,"normaliseEndRotation");function prepareAxisAnimationFunctions(ctx){const outOfBounds=__name((y,range3)=>{const[min=ctx.min,max=ctx.max]=findMinMax(range3??[]);return y<min||y>max},"outOfBounds");return{tick:{fromFn(node,datum,status){let y=node.y1+node.translationY,opacity=node.opacity;return(status==="added"||outOfBounds(node.datum.translationY,node.datum.range))&&(y=datum.translationY,opacity=0),{y:0,translationY:y,opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]}},toFn(_node,datum,status){const y=datum.translationY;let opacity=1;return status==="removed"&&(opacity=0),{y:0,translationY:y,opacity,finish:{y,translationY:0}}},applyFn(node,props){node.setProperties(props),node.visible=!outOfBounds(node.y)}},line:{fromFn(node,datum){return{...node.previousDatum??datum,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.updated}},toFn(_node,datum){return{...datum}}},label:{fromFn(node,newDatum,status){const datum=node.previousDatum??newDatum,x=datum.x,y=datum.y,rotationCenterX=datum.rotationCenterX;let translationY=Math.round(node.translationY),rotation=datum.rotation,opacity=node.opacity;return status==="removed"||outOfBounds(datum.y,datum.range)?rotation=newDatum.rotation:(status==="added"||outOfBounds(node.datum.y,node.datum.range))&&(translationY=Math.round(datum.translationY),opacity=0,rotation=newDatum.rotation),{x,y,rotationCenterX,translationY,rotation,opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]}},toFn(node,datum,status){var _a274;const x=datum.x,y=datum.y,rotationCenterX=datum.rotationCenterX,translationY=Math.round(datum.translationY);let rotation=0,opacity=1;return status==="added"?(opacity=1,rotation=datum.rotation):status==="removed"?(opacity=0,rotation=datum.rotation):rotation=normaliseEndRotation(((_a274=node.previousDatum)==null?void 0:_a274.rotation)??datum.rotation,datum.rotation),{x,y,rotationCenterX,translationY,rotation,opacity,finish:{rotation:datum.rotation}}}},group:{fromFn(node,_datum){const{rotation,translationX,translationY}=node;return{rotation,translationX,translationY,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.updated}},toFn(_node,datum){const{rotation,translationX,translationY}=datum;return{rotation,translationX,translationY}}}}}__name(prepareAxisAnimationFunctions,"prepareAxisAnimationFunctions");function resetAxisGroupFn(){return(_node,datum)=>({rotation:datum.rotation,rotationCenterX:datum.rotationCenterX,rotationCenterY:datum.rotationCenterY,translationX:datum.translationX,translationY:datum.translationY})}__name(resetAxisGroupFn,"resetAxisGroupFn");function resetAxisSelectionFn(ctx){const{visible:rangeVisible,min,max}=ctx;return(_node,datum)=>{const y=datum.translationY,visible=rangeVisible&&y>=min&&y<=max;return{y,translationY:0,opacity:1,visible}}}__name(resetAxisSelectionFn,"resetAxisSelectionFn");function resetAxisLabelSelectionFn(){return(_node,datum)=>({x:datum.x,y:datum.y,translationY:datum.translationY,rotation:datum.rotation,rotationCenterX:datum.rotationCenterX})}__name(resetAxisLabelSelectionFn,"resetAxisLabelSelectionFn");function resetAxisLineSelectionFn(){return(_node,datum)=>({...datum})}__name(resetAxisLineSelectionFn,"resetAxisLineSelectionFn");var _a52,TranslatableLine=(_a52=class extends Translatable(Line){},__name(_a52,"TranslatableLine"),_a52),_a53,_Axis=(_a53=class{constructor(moduleCtx,scale2){this.moduleCtx=moduleCtx,this.scale=scale2,this.id=createId(this),this.nice=!0,this.reverse=!1,this.keys=[],this.interval=new AxisInterval,this.dataDomain={domain:[],clipped:!1},this.layoutConstraints={stacked:!0,align:"start",width:100,unit:"percent"},this.boundSeries=[],this.includeInvisibleDomains=!1,this.interactionEnabled=!0,this.axisGroup=new TransformableGroup({name:`${this.id}-axis`,zIndex:2}),this.lineNode=this.axisGroup.appendChild(new TranslatableLine({name:`${this.id}-Axis-line`})),this.tickLineGroup=this.axisGroup.appendChild(new Group({name:`${this.id}-Axis-tick-lines`,zIndex:2})),this.tickLabelGroup=this.axisGroup.appendChild(new Group({name:`${this.id}-Axis-tick-labels`,zIndex:2})),this.crossLineGroup=new TransformableGroup({name:`${this.id}-CrossLines`}),this.labelGroup=new Group({name:`${this.id}-Labels`,zIndex:11}),this.gridGroup=new TransformableGroup({name:`${this.id}-Axis-grid`}),this.gridLineGroup=this.gridGroup.appendChild(new Group({name:`${this.id}-gridLines`,zIndex:1})),this.tickLineGroupSelection=Selection.select(this.tickLineGroup,TranslatableLine,!1),this.tickLabelGroupSelection=Selection.select(this.tickLabelGroup,TransformableText,!1),this.gridLineGroupSelection=Selection.select(this.gridLineGroup,TranslatableLine,!1),this._crossLines=[],this.line=new AxisLine,this.tick=new AxisTick,this.gridLine=new AxisGridLine,this.label=this.createLabel(),this.defaultTickMinSpacing=_a53.defaultTickMinSpacing,this.translation={x:0,y:0},this.rotation=0,this.layout={label:{fractionDigits:0,padding:this.label.padding,format:this.label.format}},this.destroyFns=[],this.range=[0,1],this.visibleRange=[0,1],this.title=new AxisTitle,this.gridLength=0,this.gridPadding=0,this.seriesAreaPadding=0,this.tickGenerationResult=void 0,this.moduleMap=new ModuleMap,this.range=this.scale.range.slice(),this.crossLines.forEach(crossLine=>this.initCrossLine(crossLine)),this.destroyFns.push(this.title.caption.registerInteraction(this.moduleCtx)),this.title.caption.node.rotation=-Math.PI/2,this.axisGroup.appendChild(this.title.caption.node),this.animationManager=moduleCtx.animationManager,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(()=>this.resetSelectionNodes(),"action")},reset:"empty"},ready:{update:__name(data=>this.animateReadyUpdate(data),"update"),resize:__name(()=>this.resetSelectionNodes(),"resize"),reset:"empty"}}),this._crossLines=[];let previousSize;this.destroyFns.push(moduleCtx.layoutManager.addListener("layout:complete",e=>{previousSize!=null&&jsonDiff(e.chart,previousSize)!=null&&this.animationState.transition("resize"),previousSize={...e.chart}}))}get type(){return this.constructor.type??""}set crossLines(value){const{CrossLineConstructor}=this.constructor;this._crossLines.forEach(crossLine=>this.detachCrossLine(crossLine)),this._crossLines=value.map(crossLine=>{const instance=new CrossLineConstructor;return instance.set(crossLine),instance}),this._crossLines.forEach(crossLine=>{this.attachCrossLine(crossLine),this.initCrossLine(crossLine)})}get crossLines(){return this._crossLines}resetAnimation(phase){phase==="initial"&&this.animationState.transition("reset")}attachCrossLine(crossLine){this.crossLineGroup.appendChild(crossLine.group),this.crossLineGroup.appendChild(crossLine.labelGroup)}detachCrossLine(crossLine){this.crossLineGroup.removeChild(crossLine.group),this.crossLineGroup.removeChild(crossLine.labelGroup)}destroy(){this.moduleMap.destroy(),this.destroyFns.forEach(f=>f())}updateRange(){var _a274;const{range:rr,visibleRange:vr,scale:scale2}=this,span=(rr[1]-rr[0])/(vr[1]-vr[0]),shift=span*vr[0],start=rr[0]-shift;(_a274=scale2.setVisibleRange)==null||_a274.call(scale2,vr),scale2.range=[start,start+span],this.crossLines.forEach(crossLine=>{crossLine.clippedRange=[rr[0],rr[1]]})}setCrossLinesVisible(visible){this.crossLineGroup.visible=visible}attachAxis(axisNode,gridNode){gridNode.appendChild(this.gridGroup),axisNode.appendChild(this.axisGroup),axisNode.appendChild(this.crossLineGroup),axisNode.appendChild(this.labelGroup)}attachLabel(axisLabelNode){this.labelGroup.append(axisLabelNode)}detachAxis(axisNode,gridNode){gridNode.removeChild(this.gridGroup),axisNode.removeChild(this.axisGroup),axisNode.removeChild(this.crossLineGroup),axisNode.removeChild(this.labelGroup)}inRange(x,tolerance=0){const[min,max]=findMinMax(this.range);return x>=min-tolerance&&x<=max+tolerance}onFormatChange(ticks,fractionDigits,_domain,format){const{scale:scale2}=this,logScale=scale2 instanceof LogScale,defaultFormatter=__name(formatOffset=>logScale?String:x=>typeof x=="number"?x.toFixed(fractionDigits+formatOffset):String(x),"defaultFormatter");if(format&&scale2&&scale2.tickFormat)try{const formatter=scale2.tickFormat({ticks,specifier:format});this.labelFormatter=formatter,this.datumFormatter=formatter}catch{this.labelFormatter=defaultFormatter(0),this.datumFormatter=defaultFormatter(1),Logger.warnOnce(`the axis label format string ${format} is invalid. No formatting will be applied`)}else this.labelFormatter=defaultFormatter(0),this.datumFormatter=defaultFormatter(1)}setTickInterval(interval){var _a274;this.scale.interval=((_a274=this.interval)==null?void 0:_a274.step)??interval}onGridLengthChange(value,prevValue){prevValue^value&&this.onGridVisibilityChange(),this.crossLines.forEach(crossLine=>this.initCrossLine(crossLine))}onGridVisibilityChange(){this.gridLineGroupSelection.clear()}createLabel(){return new AxisLabel}update(animated=!0){if(!this.tickGenerationResult)return;const{rotation,parallelFlipRotation,regularFlipRotation}=this.calculateRotations(),sideFlag=this.label.getSideFlag();this.updatePosition();const lineData=this.getAxisLineCoordinates(),{tickData,combinedRotation,textBaseline,textAlign,primaryTickCount}=this.tickGenerationResult,previousTicks=this.tickLabelGroupSelection.nodes().map(node=>node.datum.tickId);if(this.updateSelections(lineData,tickData.ticks,{combinedRotation,textAlign,textBaseline,range:this.scale.range}),!animated||this.animationManager.isSkipped())this.resetSelectionNodes();else{const diff2=this.calculateUpdateDiff(previousTicks,tickData);this.animationState.transition("update",diff2)}return this.updateAxisLine(),this.updateLabels(),this.updateVisibility(),this.updateGridLines(sideFlag),this.updateTickLines(),this.updateTitle({anyTickVisible:tickData.ticks.length>0}),this.updateCrossLines({rotation,parallelFlipRotation,regularFlipRotation}),this.updateLayoutState(tickData.fractionDigits),primaryTickCount}getAxisLineCoordinates(){const[min,max]=findMinMax(this.range);return{x:0,y1:min,y2:max}}getTickLineCoordinates(datum){const x=this.label.getSideFlag()*this.getTickSize(),x1=Math.min(0,x),x2=x1+Math.abs(x),y=datum.translationY;return{x1,x2,y}}getTickLabelProps(datum,params){const{label}=this,{combinedRotation,textBaseline,textAlign,range:range3}=params,text=datum.tickLabel,labelX=label.getSideFlag()*(this.getTickSize()+label.padding+this.seriesAreaPadding),visible=text!==""&&text!=null;return{tickId:datum.tickId,translationY:datum.translationY,fill:label.color,fontFamily:label.fontFamily,fontSize:label.fontSize,fontStyle:label.fontStyle,fontWeight:label.fontWeight,rotation:combinedRotation,rotationCenterX:labelX,text,textAlign,textBaseline,visible,x:labelX,y:0,range:range3}}getTickSize(){return this.tick.enabled?this.tick.size:6}setTitleProps(caption,params){const{title}=this;if(!title.enabled){caption.enabled=!1,caption.node.visible=!1;return}caption.color=title.color,caption.fontFamily=title.fontFamily,caption.fontSize=title.fontSize,caption.fontStyle=title.fontStyle,caption.fontWeight=title.fontWeight,caption.enabled=title.enabled,caption.wrapping=title.wrapping;const titleNode=caption.node,padding=(title.spacing??0)+params.spacing,sideFlag=this.label.getSideFlag(),parallelFlipRotation=normalizeAngle360(this.rotation),titleRotationFlag=sideFlag===-1&&parallelFlipRotation>Math.PI&&parallelFlipRotation<Math.PI*2?-1:1,rotation=titleRotationFlag*sideFlag*Math.PI/2,textBaseline=titleRotationFlag===1?"bottom":"top",{range:range3}=this,x=Math.floor(titleRotationFlag*sideFlag*(range3[0]+range3[1])/2),y=Math.floor(sideFlag===-1?titleRotationFlag*-padding:-padding),{callbackCache}=this.moduleCtx,{formatter=__name(p=>p.defaultValue,"formatter")}=title,text=callbackCache.call(formatter,this.getTitleFormatterParams());titleNode.setProperties({visible:!0,text,textBaseline,x,y,rotation})}calculateLayout(primaryTickCount){var _a274;const{rotation,parallelFlipRotation,regularFlipRotation}=this.calculateRotations(),sideFlag=this.label.getSideFlag(),labelX=sideFlag*(this.getTickSize()+this.label.padding+this.seriesAreaPadding);this.updateScale(),this.tickGenerationResult=this.generateTicks({primaryTickCount,parallelFlipRotation,regularFlipRotation,labelX,sideFlag});const{tickData,combinedRotation,textBaseline,textAlign,...ticksResult}=this.tickGenerationResult;this.updateLayoutState(tickData.fractionDigits);const boxes=[],{x,y1,y2}=this.getAxisLineCoordinates(),lineBox=new BBox(x+Math.min(sideFlag*this.seriesAreaPadding,0),y1,this.seriesAreaPadding,y2-y1);if(boxes.push(lineBox),this.tick.enabled&&tickData.ticks.forEach(datum=>{const{x1,x2,y}=this.getTickLineCoordinates(datum),tickLineBox=new BBox(x1,y,x2-x1,0);boxes.push(tickLineBox)}),this.label.enabled){const tempText=new TransformableText;tickData.ticks.forEach(datum=>{const labelProps=this.getTickLabelProps(datum,{combinedRotation,textAlign,textBaseline,range:this.scale.range});if(!labelProps.visible)return;tempText.setProperties({...labelProps,translationY:Math.round(datum.translationY)});const box=tempText.getBBox();box&&boxes.push(box)})}if((_a274=this.title)!=null&&_a274.enabled){const caption=new Caption,spacing=BBox.merge(boxes).width;this.setTitleProps(caption,{spacing});const titleBox=caption.node.getBBox();titleBox&&boxes.push(titleBox)}const bbox=BBox.merge(boxes),transformedBBox=this.getTransformBox(bbox),anySeriesActive=this.isAnySeriesActive();return this.crossLines.forEach(crossLine=>{var _a276;var _a275;crossLine.sideFlag=-sideFlag,crossLine.direction=rotation===-Math.PI/2?"x":"y",crossLine instanceof CartesianCrossLine&&((_a275=crossLine.label).parallel??(_a275.parallel=this.label.parallel)),crossLine.parallelFlipRotation=parallelFlipRotation,crossLine.regularFlipRotation=regularFlipRotation,(_a276=crossLine.calculateLayout)==null||_a276.call(crossLine,anySeriesActive,this.reverse)}),{primaryTickCount:ticksResult.primaryTickCount,bbox:transformedBBox}}updateLayoutState(fractionDigits){this.layout.label={fractionDigits,padding:this.label.padding,format:this.label.format}}getTransformBox(bbox){const matrix=new Matrix,{rotation:axisRotation,translationX,translationY,rotationCenterX,rotationCenterY}=this.getAxisTransform();return Matrix.updateTransformMatrix(matrix,1,1,axisRotation,translationX,translationY,{scalingCenterX:0,scalingCenterY:0,rotationCenterX,rotationCenterY}),matrix.transformBBox(bbox)}setDomain(domain){this.dataDomain=this.normaliseDataDomain(domain),this.reverse&&this.dataDomain.domain.reverse(),this.scale.domain=this.dataDomain.domain}updateScale(){this.updateRange(),this.calculateDomain(),this.setTickInterval(this.interval.step);const{scale:scale2,nice}=this;ContinuousScale.is(scale2)&&(scale2.nice=nice,scale2.update())}calculateRotations(){const rotation=toRadians(this.rotation),parallelFlipRotation=normalizeAngle360(rotation),regularFlipRotation=normalizeAngle360(rotation-Math.PI/2);return{rotation,parallelFlipRotation,regularFlipRotation}}generateTicks({primaryTickCount,parallelFlipRotation,regularFlipRotation,labelX,sideFlag}){const{scale:scale2,interval:{minSpacing,maxSpacing},label:{parallel,rotation,fontFamily,fontSize,fontStyle,fontWeight}}=this,secondaryAxis=primaryTickCount!==void 0,{defaultRotation,configuredRotation,parallelFlipFlag,regularFlipFlag}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation}),initialRotation=configuredRotation+defaultRotation,labelMatrix=new Matrix,{maxTickCount}=this.estimateTickCount({minSpacing,maxSpacing}),maxIterations=!(ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2))||isNaN(maxTickCount)?10:maxTickCount;let textAlign=getTextAlign(parallel,configuredRotation,0,sideFlag,regularFlipFlag);const textBaseline=getTextBaseline(parallel,configuredRotation,sideFlag,parallelFlipFlag),font=TextUtils.toFontString({fontFamily,fontSize,fontStyle,fontWeight}),textMeasurer=CachedTextMeasurerPool.getMeasurer({font}),textProps={fontFamily,fontSize,fontStyle,fontWeight,textBaseline,textAlign};let tickData={rawTicks:[],fractionDigits:0,ticks:[],labelCount:0},index=0,autoRotation=0,labelOverlap=!0,labelData=[],terminate=!1;for(;labelOverlap&&index<=maxIterations&&!terminate;){autoRotation=0,textAlign=getTextAlign(parallel,configuredRotation,0,sideFlag,regularFlipFlag);const tickStrategies=this.getTickStrategies({secondaryAxis,index});for(const strategy of tickStrategies){({tickData,index,autoRotation,terminate}=strategy({index,tickData,textProps,labelOverlap,terminate,primaryTickCount}));const rotated=configuredRotation!==0||autoRotation!==0,labelRotation=initialRotation+autoRotation,labelSpacing=getLabelSpacing(this.label.minSpacing,rotated);Matrix.updateTransformMatrix(labelMatrix,1,1,labelRotation,0,0),textAlign=getTextAlign(parallel,configuredRotation,autoRotation,sideFlag,regularFlipFlag),labelData=this.createLabelData(tickData.ticks,labelX,labelMatrix,textMeasurer),labelOverlap=this.label.avoidCollisions?axisLabelsOverlap(labelData,labelSpacing):!1}}const combinedRotation=defaultRotation+configuredRotation+autoRotation;return!secondaryAxis&&tickData.rawTicks.length>0&&(primaryTickCount=tickData.rawTicks.length),{tickData,primaryTickCount,combinedRotation,textBaseline,textAlign,labelData}}getTickStrategies({index:iteration,secondaryAxis}){const{scale:scale2,label}=this,{minSpacing}=this.interval,continuous=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),avoidLabelCollisions=label.enabled&&label.avoidCollisions,filterTicks=!continuous&&iteration!==0&&avoidLabelCollisions,autoRotate=label.autoRotate===!0&&label.rotation===void 0,strategies=[];let tickGenerationType;this.interval.values?tickGenerationType=3:secondaryAxis?tickGenerationType=1:filterTicks?tickGenerationType=2:tickGenerationType=0;const tickGenerationStrategy=__name(({index,tickData,primaryTickCount,terminate})=>this.createTickData(tickGenerationType,index,tickData,terminate,primaryTickCount),"tickGenerationStrategy");if(strategies.push(tickGenerationStrategy),!continuous&&!isNaN(minSpacing)){const tickFilterStrategy=__name(({index,tickData,primaryTickCount,terminate})=>this.createTickData(2,index,tickData,terminate,primaryTickCount),"tickFilterStrategy");strategies.push(tickFilterStrategy)}if(!avoidLabelCollisions)return strategies;if(autoRotate){const autoRotateStrategy=__name(({index,tickData,labelOverlap,terminate})=>({index,tickData,autoRotation:this.getAutoRotation(labelOverlap),terminate}),"autoRotateStrategy");strategies.push(autoRotateStrategy)}return strategies}createTickData(tickGenerationType,index,tickData,terminate,primaryTickCount){const{scale:scale2}=this,{step,values,minSpacing,maxSpacing}=this.interval,{maxTickCount,minTickCount,defaultTickCount}=this.estimateTickCount({minSpacing,maxSpacing}),continuous=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),maxIterations=!continuous||isNaN(maxTickCount)?10:maxTickCount;let tickCount=continuous?Math.max(defaultTickCount-index,minTickCount):maxTickCount;const regenerateTicks=step===void 0&&values===void 0&&tickCount>minTickCount&&(continuous||tickGenerationType===2);let unchanged=!0;for(;unchanged&&index<=maxIterations;){const prevTicks=tickData.rawTicks;tickCount=continuous?Math.max(defaultTickCount-index,minTickCount):maxTickCount;const{rawTicks,fractionDigits,ticks,labelCount}=this.getTicks({tickGenerationType,previousTicks:prevTicks,tickCount,minTickCount,maxTickCount,primaryTickCount});tickData.rawTicks=rawTicks,tickData.fractionDigits=fractionDigits,tickData.ticks=ticks,tickData.labelCount=labelCount,unchanged=regenerateTicks?areArrayNumbersEqual(rawTicks,prevTicks):!1,index++}return terminate||(terminate=step!==void 0||values!==void 0),{tickData,index,autoRotation:0,terminate}}createLabelData(tickData,labelX,labelMatrix,textMeasurer){const labelData=[];for(const{tickLabel,translationY}of tickData){if(!tickLabel)continue;const{width,height}=textMeasurer.measureLines(tickLabel),bbox=new BBox(labelX,translationY,width,height),labelDatum=calculateLabelBBox(tickLabel,bbox,labelMatrix);labelData.push(labelDatum)}return labelData}getAutoRotation(labelOverlap){return labelOverlap?normalizeAngle360(toRadians(this.label.autoRotateAngle??0)):0}getTicks({tickGenerationType,previousTicks,tickCount,minTickCount,maxTickCount,primaryTickCount}){const{range:range3,scale:scale2,visibleRange}=this;let rawTicks;switch(tickGenerationType){case 3:if(rawTicks=this.interval.values,ContinuousScale.is(scale2)){const[d0,d1]=findMinMax(scale2.getDomain().map(Number));rawTicks=rawTicks.filter(value=>value>=d0&&value<=d1).sort((a,b)=>a-b)}break;case 1:ContinuousScale.is(scale2)?rawTicks=this.updateSecondaryAxisTicks(primaryTickCount):rawTicks=this.createTicks(tickCount,minTickCount,maxTickCount);break;case 2:rawTicks=this.filterTicks(previousTicks,tickCount);break;default:rawTicks=this.createTicks(tickCount,minTickCount,maxTickCount);break}const fractionDigits=rawTicks.reduce((max,tick)=>Math.max(max,typeof tick=="number"?countFractionDigits(tick):0),0),halfBandwidth=(scale2.bandwidth??0)/2,ticks=[];let labelCount=0;const tickIdCounts=new Map,start=Math.max(0,Math.floor(visibleRange[0]*rawTicks.length)),end=Math.min(rawTicks.length,Math.ceil(visibleRange[1]*rawTicks.length)),filteredTicks=rawTicks.slice(start,end);this.onFormatChange(filteredTicks,fractionDigits,rawTicks,this.label.format);for(let i=0;i<filteredTicks.length;i++){const tick=filteredTicks[i],translationY=scale2.convert(tick)+halfBandwidth;if(range3.length>0&&!this.inRange(translationY,.001))continue;const tickLabel=this.formatTick(tick,fractionDigits,start+i);let tickId=tickLabel;if(tickIdCounts.has(tickId)){const count=tickIdCounts.get(tickId);tickIdCounts.set(tickId,count+1),tickId=`${tickId}_${count}`}else tickIdCounts.set(tickId,1);ticks.push({tick,tickId,tickLabel,translationY:Math.floor(translationY)}),!(tickLabel===""||tickLabel==null)&&labelCount++}return{rawTicks,fractionDigits,ticks,labelCount}}filterTicks(ticks,tickCount){const{minSpacing,maxSpacing}=this.interval,keepEvery=!isNaN(minSpacing)||!isNaN(maxSpacing)?Math.ceil(ticks.length/tickCount):2;return ticks.filter((_,i)=>i%keepEvery===0)}createTicks(tickCount,minTickCount,maxTickCount){var _a274;const{scale:scale2}=this;return tickCount&&(ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2))&&(typeof tickCount=="number"?(scale2.tickCount=tickCount,scale2.minTickCount=minTickCount??0,scale2.maxTickCount=maxTickCount??1/0):scale2 instanceof TimeScale&&this.setTickInterval(tickCount)),((_a274=scale2.ticks)==null?void 0:_a274.call(scale2))??[]}estimateTickCount({minSpacing,maxSpacing}){if(!this.label.avoidCollisions)return{minTickCount:ContinuousScale.defaultMaxTickCount,maxTickCount:ContinuousScale.defaultMaxTickCount,defaultTickCount:ContinuousScale.defaultMaxTickCount};const rangeWithBleed=this.calculateRangeWithBleed(),defaultMinSpacing=Math.max(this.defaultTickMinSpacing,rangeWithBleed/ContinuousScale.defaultMaxTickCount);let clampMaxTickCount=!isNaN(maxSpacing);isNaN(minSpacing)&&(minSpacing=defaultMinSpacing),isNaN(maxSpacing)&&(maxSpacing=rangeWithBleed),minSpacing>maxSpacing&&(minSpacing===defaultMinSpacing?minSpacing=maxSpacing:maxSpacing=minSpacing);const minRectDistance=2;clampMaxTickCount&&(clampMaxTickCount=minRectDistance<defaultMinSpacing);const maxTickCount=clamp(1,Math.floor(rangeWithBleed/minSpacing),clampMaxTickCount?Math.min(Math.floor(rangeWithBleed/minRectDistance),100):100),minTickCount=Math.min(maxTickCount,Math.ceil(rangeWithBleed/maxSpacing)),defaultTickCount=clamp(minTickCount,ContinuousScale.defaultTickCount,maxTickCount);return{minTickCount,maxTickCount,defaultTickCount}}updateVisibility(){this.moduleCtx.animationManager.isSkipped()&&this.resetSelectionNodes(),this.tickLineGroup.visible=this.tick.enabled,this.gridLineGroup.visible=this.gridLine.enabled,this.tickLabelGroup.visible=this.label.enabled}updateCrossLines({rotation,parallelFlipRotation,regularFlipRotation}){const sideFlag=this.label.getSideFlag(),anySeriesActive=this.isAnySeriesActive();this.crossLines.forEach(crossLine=>{var _a274;crossLine.sideFlag=-sideFlag,crossLine.direction=rotation===-Math.PI/2?"x":"y",crossLine instanceof CartesianCrossLine&&((_a274=crossLine.label).parallel??(_a274.parallel=this.label.parallel)),crossLine.parallelFlipRotation=parallelFlipRotation,crossLine.regularFlipRotation=regularFlipRotation,crossLine.update(anySeriesActive)})}updateTickLines(){const{tick,label}=this,sideFlag=label.getSideFlag();this.tickLineGroupSelection.each(line=>{line.strokeWidth=tick.width,line.stroke=tick.stroke,line.x1=sideFlag*this.getTickSize(),line.x2=0})}calculateAvailableRange(){return findRangeExtent(this.range)}calculateRangeWithBleed(){const visibleScale=1/findRangeExtent(this.visibleRange);return round(this.calculateAvailableRange()*visibleScale,2)}calculateDomain(){const domains=this.boundSeries.filter(s=>this.includeInvisibleDomains||s.isEnabled()).flatMap(series=>series.getDomain(this.direction));this.setDomain(domains)}getAxisTransform(){return{rotation:toRadians(this.rotation),rotationCenterX:0,rotationCenterY:0,translationX:Math.floor(this.translation.x),translationY:Math.floor(this.translation.y)}}updatePosition(){const{crossLineGroup,axisGroup,gridGroup,translation,gridLineGroupSelection,gridPadding,gridLength}=this,{rotation}=this.calculateRotations(),sideFlag=this.label.getSideFlag(),translationX=Math.floor(translation.x),translationY=Math.floor(translation.y);crossLineGroup.setProperties({rotation,translationX,translationY}),gridGroup.setProperties({rotation,translationX,translationY}),axisGroup.datum=this.getAxisTransform(),gridLineGroupSelection.each(line=>{line.x1=gridPadding,line.x2=-sideFlag*gridLength+gridPadding})}updateSecondaryAxisTicks(_primaryTickCount){throw new Error("AG Charts - unexpected call to updateSecondaryAxisTicks() - check axes configuration.")}updateSelections(lineData,data,params){this.lineNode.datum=lineData,this.gridLineGroupSelection.update(this.gridLength?data:[],group=>group.append(new Line),datum=>datum.tickId),this.tickLineGroupSelection.update(data,group=>group.appendChild(new Line),datum=>datum.tickId),this.tickLabelGroupSelection.update(data.map(d=>this.getTickLabelProps(d,params)),group=>group.appendChild(new RotatableText),datum=>datum.tickId)}updateAxisLine(){const{enabled,stroke,width}=this.line;this.lineNode.setProperties({stroke,strokeWidth:enabled?width:0})}updateGridLines(sideFlag){const{gridLine:{style,width},gridPadding,gridLength}=this;gridLength===0||style.length===0||this.gridLineGroupSelection.each((line,_,index)=>{const{stroke,lineDash}=style[index%style.length];line.setProperties({x1:gridPadding,x2:-sideFlag*gridLength+gridPadding,fill:void 0,stroke,strokeWidth:width,lineDash})})}updateLabels(){this.label.enabled&&this.tickLabelGroupSelection.each((node,datum)=>{node.setProperties(datum,["fill","fontFamily","fontSize","fontStyle","fontWeight","text","textAlign","textBaseline"])})}updateTitle(params){const{title,lineNode,tickLineGroup,tickLabelGroup}=this;let spacing=0;if(title.enabled&&params.anyTickVisible){const tickBBox=Group.computeChildrenBBox([tickLineGroup,tickLabelGroup,lineNode]);spacing+=tickBBox.width+(this.tickLabelGroup.visible?0:this.seriesAreaPadding)}this.setTitleProps(title.caption,{spacing})}formatTick(datum,fractionDigits,index){return String(this.getFormatter(index,!0)(datum,fractionDigits))}formatDatum(datum){return String(this.getFormatter()(datum))}getFormatter(index=0,isTickLabel){const{label,labelFormatter,datumFormatter,moduleCtx:{callbackCache}}=this;return label.formatter?(datum,fractionDigits)=>callbackCache.call(label.formatter,{value:datum,index,fractionDigits})??datum:!isTickLabel&&datumFormatter?datum=>callbackCache.call(datumFormatter,datum)??String(datum):labelFormatter?datum=>callbackCache.call(labelFormatter,datum)??String(datum):datum=>String(datum)}getBBox(){return this.axisGroup.getBBox()}getRegionNode(){return this.axisGroup}initCrossLine(crossLine){crossLine.scale=this.scale,crossLine.gridLength=this.gridLength}isAnySeriesActive(){return this.boundSeries.some(s=>this.includeInvisibleDomains||s.isEnabled())}clipTickLines(x,y,width,height){this.tickLineGroup.setClipRectInGroupCoordinateSpace(new BBox(x,y,width,height))}clipGrid(x,y,width,height){this.gridGroup.setClipRectInGroupCoordinateSpace(new BBox(x,y,width,height))}getTitleFormatterParams(){var _a274;const boundSeries=this.boundSeries.reduce((acc,next)=>{const keys=next.getKeys(this.direction),names=next.getNames(this.direction);for(let idx=0;idx<keys.length;idx++)acc.push({key:keys[idx],name:names[idx]});return acc},[]);return{direction:this.direction,boundSeries,defaultValue:(_a274=this.title)==null?void 0:_a274.text}}normaliseDataDomain(d){return{domain:[...d],clipped:!1}}getLayoutState(){return{id:this.id,rect:this.getBBox(),gridPadding:this.gridPadding,seriesAreaPadding:this.seriesAreaPadding,tickSize:this.getTickSize(),direction:this.direction,domain:this.dataDomain.domain,scale:this.scale,...this.layout}}getModuleMap(){return this.moduleMap}createModuleContext(){return this.axisContext??(this.axisContext=this.createAxisContext()),{...this.moduleCtx,parent:this.axisContext}}createAxisContext(){const{scale:scale2}=this;return{axisId:this.id,direction:this.direction,continuous:ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),keys:__name(()=>this.boundSeries.flatMap(s=>s.getKeys(this.direction)),"keys"),seriesKeyProperties:__name(()=>this.boundSeries.reduce((keys,series)=>(series.getKeyProperties(this.direction).forEach(key=>{keys.indexOf(key)<0&&keys.push(key)}),keys),[]),"seriesKeyProperties"),scaleValueFormatter:__name(specifier=>this.getScaleValueFormatter(specifier),"scaleValueFormatter"),scaleBandwidth:__name(()=>scale2.bandwidth??0,"scaleBandwidth"),scaleDomain:__name(()=>{var _a274;return(_a274=scale2.getDomain)==null?void 0:_a274.call(scale2)},"scaleDomain"),scaleConvert:__name(val=>scale2.convert(val),"scaleConvert"),scaleInvert:OrdinalTimeScale.is(scale2)?val=>{var _a274;return(_a274=scale2.invertNearest)==null?void 0:_a274.call(scale2,val)}:val=>{var _a274;return(_a274=scale2.invert)==null?void 0:_a274.call(scale2,val)},scaleInvertNearest:__name(val=>{var _a274;return(_a274=scale2.invertNearest)==null?void 0:_a274.call(scale2,val)},"scaleInvertNearest"),attachLabel:__name(node=>this.attachLabel(node),"attachLabel"),inRange:__name((x,tolerance)=>this.inRange(x,tolerance),"inRange")}}getScaleValueFormatter(format){const{scale:scale2}=this;if(format&&scale2&&scale2.tickFormat)try{return scale2.tickFormat({specifier:format})}catch{Logger.warnOnce(`the format string ${format} is invalid, ignoring.`)}return this.getFormatter()}animateReadyUpdate(diff2){const{animationManager}=this.moduleCtx,selectionCtx=prepareAxisAnimationContext(this),fns=prepareAxisAnimationFunctions(selectionCtx);fromToMotion(this.id,"axis-group",animationManager,[this.axisGroup],fns.group),fromToMotion(this.id,"line",animationManager,[this.lineNode],fns.line),fromToMotion(this.id,"line-paths",animationManager,[this.gridLineGroupSelection,this.tickLineGroupSelection],fns.tick,(_,d)=>d.tickId,diff2),fromToMotion(this.id,"tick-labels",animationManager,[this.tickLabelGroupSelection],fns.label,(_,d)=>d.tickId,diff2)}resetSelectionNodes(){const{gridLineGroupSelection,tickLineGroupSelection,tickLabelGroupSelection,lineNode}=this,selectionCtx=prepareAxisAnimationContext(this);resetMotion([this.axisGroup],resetAxisGroupFn()),resetMotion([gridLineGroupSelection,tickLineGroupSelection],resetAxisSelectionFn(selectionCtx)),resetMotion([tickLabelGroupSelection],resetAxisLabelSelectionFn()),resetMotion([lineNode],resetAxisLineSelectionFn())}calculateUpdateDiff(previous,tickData){const added=new Set,removed=new Set,tickCount=Math.max(previous.length,tickData.ticks.length);for(let i=0;i<tickCount;i++){const tickDatum=tickData.ticks[i],prev=previous[i],tick=tickDatum==null?void 0:tickDatum.tickId;prev!==tick&&(removed.has(tick)?removed.delete(tick):tick&&added.add(tick),added.has(prev)?added.delete(prev):prev&&removed.add(prev))}return{changed:added.size>0||removed.size>0,added,removed}}isReversed(){return this.reverse}},__name(_a53,"_Axis"),_a53);_Axis.defaultTickMinSpacing=50;_Axis.CrossLineConstructor=CartesianCrossLine;__decorateClass([Validate(BOOLEAN)],_Axis.prototype,"nice",2);__decorateClass([Validate(BOOLEAN)],_Axis.prototype,"reverse",2);__decorateClass([Validate(STRING_ARRAY)],_Axis.prototype,"keys",2);__decorateClass([Validate(OBJECT)],_Axis.prototype,"interval",2);__decorateClass([Validate(OBJECT)],_Axis.prototype,"title",2);__decorateClass([ObserveChanges((target,value,oldValue)=>target.onGridLengthChange(value,oldValue))],_Axis.prototype,"gridLength",2);var Axis=_Axis,_a54,CartesianAxisLabel=(_a54=class extends AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}},__name(_a54,"CartesianAxisLabel"),_a54);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianAxisLabel.prototype,"autoRotate",2);__decorateClass([Validate(DEGREE)],CartesianAxisLabel.prototype,"autoRotateAngle",2);var _a55,_CartesianAxis=(_a55=class extends Axis{constructor(){super(...arguments),this.thickness=0}static is(value){return value instanceof _a55}get direction(){return this.position==="top"||this.position==="bottom"?"x":"y"}updateDirection(){switch(this.position){case"top":this.rotation=-90,this.label.mirrored=!0,this.label.parallel=!0;break;case"right":this.rotation=0,this.label.mirrored=!0,this.label.parallel=!1;break;case"bottom":this.rotation=-90,this.label.mirrored=!1,this.label.parallel=!0;break;case"left":this.rotation=0,this.label.mirrored=!1,this.label.parallel=!1;break}this.axisContext&&(this.axisContext.position=this.position,this.axisContext.direction=this.direction)}update(animated){return this.updateDirection(),super.update(animated)}calculateLayout(primaryTickCount){return this.updateDirection(),super.calculateLayout(primaryTickCount)}createAxisContext(){return{...super.createAxisContext(),position:this.position}}createLabel(){return new CartesianAxisLabel}},__name(_a55,"_CartesianAxis"),_a55);__decorateClass([Validate(POSITIVE_NUMBER)],_CartesianAxis.prototype,"thickness",2);__decorateClass([Validate(POSITION)],_CartesianAxis.prototype,"position",2);var CartesianAxis=_CartesianAxis,_a56,_CategoryAxis=(_a56=class extends CartesianAxis{constructor(moduleCtx,scale2=new BandScale){super(moduleCtx,scale2),this.groupPaddingInner=.1,this.includeInvisibleDomains=!0}static is(value){return value instanceof _a56}normaliseDataDomain(d){const domain=[],uniqueValues=new Set;for(const v of d){const key=v instanceof Date?v.getTime():v;uniqueValues.has(key)||(uniqueValues.add(key),domain.push(v))}return{domain,clipped:!1}}calculateDomain(){let{paddingInner,paddingOuter}=this;if(!isFiniteNumber(paddingInner)||!isFiniteNumber(paddingOuter)){const padding=this.reduceBandScalePadding();paddingInner??(paddingInner=padding.inner),paddingOuter??(paddingOuter=padding.outer)}return this.scale.paddingInner=paddingInner??0,this.scale.paddingOuter=paddingOuter??0,super.calculateDomain()}reduceBandScalePadding(){return this.boundSeries.reduce((result,series)=>{var _a274;const padding=(_a274=series.getBandScalePadding)==null?void 0:_a274.call(series);return padding&&(result.inner>padding.inner&&(result.inner=padding.inner),result.outer<padding.outer&&(result.outer=padding.outer)),result},{inner:1/0,outer:-1/0})}},__name(_a56,"_CategoryAxis"),_a56);_CategoryAxis.className="CategoryAxis";_CategoryAxis.type="category";__decorateClass([Validate(RATIO)],_CategoryAxis.prototype,"groupPaddingInner",2);__decorateClass([Validate(RATIO,{optional:!0})],_CategoryAxis.prototype,"paddingInner",2);__decorateClass([Validate(RATIO,{optional:!0})],_CategoryAxis.prototype,"paddingOuter",2);var CategoryAxis=_CategoryAxis,_a57,TreeNode=(_a57=class{constructor(label="",parent,number2=0){this.x=0,this.y=0,this.subtreeLeft=NaN,this.subtreeRight=NaN,this.screenX=0,this.screenY=0,this.children=[],this.leafCount=0,this.prelim=0,this.mod=0,this.ancestor=this,this.change=0,this.shift=0,this.label=label,this.parent=parent,this.depth=parent?parent.depth+1:0,this.number=number2}getLeftSibling(){return this.number>0&&this.parent?this.parent.children[this.number-1]:void 0}getLeftmostSibling(){return this.number>0&&this.parent?this.parent.children[0]:void 0}nextLeft(){return this.children?this.children[0]:this.thread}nextRight(){return this.children?this.children[this.children.length-1]:this.thread}getSiblings(){return this.parent?this.parent.children.filter((_,i)=>i!==this.number):[]}},__name(_a57,"TreeNode"),_a57);function ticksToTree(ticks,pad2=!0){const root=new TreeNode;let depth=0;return pad2&&ticks.forEach(tick=>depth=Math.max(depth,tick.labels.length)),ticks.forEach(tick=>{if(pad2)for(;tick.labels.length<depth;)tick.labels.unshift("");insertTick(root,tick)}),root}__name(ticksToTree,"ticksToTree");function insertTick(root,tick){const pathParts=tick.labels.slice().reverse(),lastPartIndex=pathParts.length-1;pathParts.forEach((pathPart,partIndex)=>{const children=root.children,existingNode=children.find(child=>child.label===pathPart),isNotLeaf=partIndex!==lastPartIndex;if(existingNode&&isNotLeaf)root=existingNode;else{const node=new TreeNode(pathPart,root);node.number=children.length,children.push(node),isNotLeaf&&(root=node)}})}__name(insertTick,"insertTick");function moveSubtree(wm,wp,shift){const subtrees=wp.number-wm.number,ratio2=shift/subtrees;wp.change-=ratio2,wp.shift+=shift,wm.change+=ratio2,wp.prelim+=shift,wp.mod+=shift}__name(moveSubtree,"moveSubtree");function ancestor(vim,v,defaultAncestor){return v.getSiblings().indexOf(vim.ancestor)>=0?vim.ancestor:defaultAncestor}__name(ancestor,"ancestor");function executeShifts(v){const children=v.children;if(children){let shift=0,change=0;for(let i=children.length-1;i>=0;i--){const w=children[i];w.prelim+=shift,w.mod+=shift,change+=w.change,shift+=w.shift+change}}}__name(executeShifts,"executeShifts");function apportion(v,defaultAncestor,distance3){const w=v.getLeftSibling();if(w){let vop=v,vip=v,vim=w,vom=vip.getLeftmostSibling(),sip=vip.mod,sop=vop.mod,sim=vim.mod,som=vom.mod;for(;vim.nextRight()&&vip.nextLeft();){vim=vim.nextRight(),vip=vip.nextLeft(),vom=vom.nextLeft(),vop=vop.nextRight(),vop.ancestor=v;const shift=vim.prelim+sim-(vip.prelim+sip)+distance3;shift>0&&(moveSubtree(ancestor(vim,v,defaultAncestor),v,shift),sip+=shift,sop+=shift),sim+=vim.mod,sip+=vip.mod,som+=vom.mod,sop+=vop.mod}vim.nextRight()&&!vop.nextRight()?(vop.thread=vim.nextRight(),vop.mod+=sim-sop):(vip.nextLeft()&&!vom.nextLeft()&&(vom.thread=vip.nextLeft(),vom.mod+=sip-som),defaultAncestor=v)}return defaultAncestor}__name(apportion,"apportion");function firstWalk(node,distance3){const children=node.children;if(children.length){let defaultAncestor=children[0];children.forEach(child=>{firstWalk(child,distance3),defaultAncestor=apportion(child,defaultAncestor,distance3)}),executeShifts(node);const midpoint=(children[0].prelim+children.at(-1).prelim)/2,leftSibling=node.getLeftSibling();leftSibling?(node.prelim=leftSibling.prelim+distance3,node.mod=node.prelim-midpoint):node.prelim=midpoint}else{const leftSibling=node.getLeftSibling();node.prelim=leftSibling?leftSibling.prelim+distance3:0}}__name(firstWalk,"firstWalk");var _a58,Dimensions=(_a58=class{constructor(){this.top=1/0,this.right=-1/0,this.bottom=-1/0,this.left=1/0}update(node,xy){const{x,y}=xy(node);x>this.right&&(this.right=x),x<this.left&&(this.left=x),y>this.bottom&&(this.bottom=y),y<this.top&&(this.top=y)}},__name(_a58,"Dimensions"),_a58);function secondWalk(v,m,layout){v.x=v.prelim+m,v.y=v.depth,layout.update(v),v.children.forEach(w=>secondWalk(w,m+v.mod,layout))}__name(secondWalk,"secondWalk");function thirdWalk(v){const children=v.children;let leafCount=0;children.forEach(w=>{thirdWalk(w),w.children.length?leafCount+=w.leafCount:leafCount++}),v.leafCount=leafCount,children.length?(v.subtreeLeft=children[0].subtreeLeft,v.subtreeRight=children[v.children.length-1].subtreeRight,v.x=(v.subtreeLeft+v.subtreeRight)/2):(v.subtreeLeft=v.x,v.subtreeRight=v.x)}__name(thirdWalk,"thirdWalk");function treeLayout(root){const layout=new TreeLayout;return firstWalk(root,1),secondWalk(root,-root.prelim,layout),thirdWalk(root),layout}__name(treeLayout,"treeLayout");var _a59,TreeLayout=(_a59=class{constructor(){this.dimensions=new Dimensions,this.leafCount=0,this.nodes=[],this.leafNodes=[],this.nonLeafNodes=[],this.depth=0}update(node){this.dimensions.update(node,n=>({x:n.x,y:n.y})),node.children.length?this.nonLeafNodes.push(node):(this.leafCount++,this.leafNodes.push(node)),node.depth>this.depth&&(this.depth=node.depth),this.nodes.push(node)}resize(width,height,shiftX=0,shiftY=0,flipX=!1){const xSteps=this.leafCount-1,ySteps=this.depth,dimensions=this.dimensions;let scalingX=1,scalingY=1;if(width>0&&xSteps){const existingSpacingX=(dimensions.right-dimensions.left)/xSteps;scalingX=width/xSteps/existingSpacingX,flipX&&(scalingX=-scalingX)}if(height>0&&ySteps){const existingSpacingY=(dimensions.bottom-dimensions.top)/ySteps;scalingY=height/ySteps/existingSpacingY}const screenDimensions=new Dimensions;this.nodes.forEach(node=>{node.screenX=node.x*scalingX,node.screenY=node.y*scalingY,screenDimensions.update(node,n=>({x:n.screenX,y:n.screenY}))});const offsetX=-screenDimensions.left,offsetY=-screenDimensions.top;this.nodes.forEach(node=>{node.screenX+=offsetX+shiftX,node.screenY+=offsetY+shiftY})}},__name(_a59,"TreeLayout"),_a59),_a60,GroupedCategoryAxisLabel=(_a60=class extends AxisLabel{constructor(){super(...arguments),this.grid=!1}},__name(_a60,"GroupedCategoryAxisLabel"),_a60);__decorateClass([Validate(BOOLEAN)],GroupedCategoryAxisLabel.prototype,"grid",2);var _a61,GroupedCategoryAxis=(_a61=class extends CartesianAxis{constructor(moduleCtx){const scale2=new BandScale;scale2.paddingOuter=.1,scale2.paddingInner=scale2.paddingOuter*2,super(moduleCtx,scale2),this.tickScale=new BandScale,this.line=new AxisLine,this.label=new GroupedCategoryAxisLabel,this.labelColor="rgba(87, 87, 87, 1)",this.includeInvisibleDomains=!0;const{tickLineGroup,tickLabelGroup,gridLineGroup,tickScale}=this;tickScale.paddingInner=1,tickScale.paddingOuter=0,this.gridLineSelection=Selection.select(gridLineGroup,Line),this.axisLineSelection=Selection.select(tickLineGroup,Line),this.separatorSelection=Selection.select(tickLineGroup,Line),this.labelSelection=Selection.select(tickLabelGroup,TransformableText),this.lineNode.visible=!1}updateRange(){const{range:rr,visibleRange:vr,scale:scale2}=this,span=(rr[1]-rr[0])/(vr[1]-vr[0]),shift=span*vr[0],start=rr[0]-shift;this.tickScale.range=scale2.range=[start,start+span],this.resizeTickTree()}resizeTickTree(){const s=this.scale,range3=s.domain.length?[s.convert(s.domain[0]),s.convert(s.domain[s.domain.length-1])]:s.range,layout=this.tickTreeLayout,lineHeight=this.lineHeight;layout&&layout.resize(Math.abs(range3[1]-range3[0]),layout.depth*lineHeight,(Math.min(range3[0],range3[1])||0)+(s.bandwidth??0)/2,-layout.depth*lineHeight,range3[1]-range3[0]<0)}get lineHeight(){return this.label.fontSize*1.5}onGridVisibilityChange(){this.gridLineSelection.clear(),this.labelSelection.clear()}calculateDomain(){const{direction}=this;let isNumericX=null;const flatDomains=this.boundSeries.filter(s=>s.visible).flatMap(series=>{if(direction==="y"||isNumericX)return series.getDomain(direction);if(isNumericX===null){const domain2=series.getDomain(direction);return isNumericX=isNumber(domain2[0]),domain2}return[]});this.setDomain(extent(flatDomains)??unique(flatDomains));const{domain}=this.dataDomain;this.tickTreeLayout=treeLayout(ticksToTree(domain)),this.tickScale.domain=domain.concat(""),this.resizeTickTree()}update(){this.computedLayout&&(this.updatePosition(),this.updateTitleCaption(),this.updateCategoryLabels(),this.updateSeparators(),this.updateAxisLines(),this.updateCategoryGridLines(),this.resetSelectionNodes())}updateTitleCaption(){this.title.caption.node.visible=!1}updateCategoryLabels(){if(!this.computedLayout)return;const{tickLabelLayout}=this.computedLayout;this.labelSelection.update(tickLabelLayout).each((node,datum)=>{node.setProperties(datum)})}updateSeparators(){if(!this.computedLayout)return;const{separatorLayout}=this.computedLayout,{range:range3}=this,epsilon2=1e-7;this.separatorSelection.update(separatorLayout).each((line,datum)=>{line.x1=datum.x1,line.x2=datum.x2,line.y1=datum.y,line.y2=datum.y,line.visible=this.tick.enabled&&datum.y>=range3[0]-epsilon2&&datum.y<=range3[1]+epsilon2,line.stroke=this.tick.stroke,line.fill=void 0,line.strokeWidth=1})}updateAxisLines(){if(!this.computedLayout)return;const{axisLineLayout}=this.computedLayout;this.axisLineSelection.update(axisLineLayout).each((line,datum)=>{line.setProperties({...datum,stroke:this.line.stroke,strokeWidth:this.line.width}),line.x1=datum.x,line.x2=datum.x,line.y1=datum.y1,line.y2=datum.y2,line.strokeWidth=this.line.width,line.stroke=this.line.stroke})}updateCategoryGridLines(){const{gridLength,gridLine,label,range:range3,tickScale}=this,ticks=tickScale.ticks(),sideFlag=label.getSideFlag(),gridSelection=this.gridLineSelection.update(gridLength?ticks:[]);if(gridLength){const{width,style}=gridLine,styleCount=style.length;gridSelection.each((line,datum,index)=>{const y=Math.round(tickScale.convert(datum));line.x1=0,line.x2=-sideFlag*gridLength,line.y1=y,line.y2=y,line.visible=gridLine.enabled&&y>=range3[0]&&y<=range3[1];const{stroke,lineDash}=style[index%styleCount];line.stroke=stroke,line.strokeWidth=width,line.lineDash=lineDash,line.fill=void 0})}}computeLayout(){this.updateDirection(),this.calculateDomain(),this.updateRange();const{scale:scale2,label,label:{parallel},moduleCtx:{callbackCache},range:range3,title,title:{formatter=__name(p=>p.defaultValue,"formatter")}={}}=this,rangeStart=scale2.range[0],rangeEnd=scale2.range[1],bandwidth=Math.abs(rangeEnd-rangeStart)/scale2.domain.length||0,keepEvery=Math.ceil(label.fontSize/bandwidth),rotation=toRadians(this.rotation),isHorizontal=Math.abs(Math.cos(rotation))<1e-8,sideFlag=label.getSideFlag(),lineHeight=this.lineHeight,tickTreeLayout=this.tickTreeLayout,labels=scale2.ticks(),treeLabels=tickTreeLayout?tickTreeLayout.nodes:[],isLabelTree=tickTreeLayout?tickTreeLayout.depth>1:!1,{defaultRotation,configuredRotation,parallelFlipFlag}=calculateLabelRotation({rotation:label.rotation,parallel,regularFlipRotation:normalizeAngle360(rotation-Math.PI/2),parallelFlipRotation:normalizeAngle360(rotation)}),tickLabelLayout=[],copyLabelProps=__name(node=>({fill:node.fill,fontFamily:node.fontFamily,fontSize:node.fontSize,fontStyle:node.fontStyle,fontWeight:node.fontWeight,rotation:node.rotation,rotationCenterX:node.rotationCenterX,rotationCenterY:node.rotationCenterY,text:node.text,textAlign:node.textAlign,textBaseline:node.textBaseline,translationX:node.translationX,translationY:node.translationY,visible:node.visible,x:node.x,y:node.y}),"copyLabelProps"),labelBBoxes=new Map;let maxLeafLabelWidth=0;const tempText=new TransformableText,setLabelProps=__name((datum,index)=>{if(tempText.setProperties({fill:label.color,fontFamily:label.fontFamily,fontSize:label.fontSize,fontStyle:label.fontStyle,fontWeight:label.fontWeight,textAlign:"center",textBaseline:parallelFlipFlag===-1?"bottom":"hanging",translationX:datum.screenY-label.fontSize*.25,translationY:datum.screenX}),index===0){if(!((title==null?void 0:title.enabled)&&labels.length>0))return!1;const text=callbackCache.call(formatter,this.getTitleFormatterParams());tempText.setProperties({fill:title.color,fontFamily:title.fontFamily,fontSize:title.fontSize,fontStyle:title.fontStyle,fontWeight:title.fontWeight,text,textBaseline:"hanging",translationX:datum.screenY-label.fontSize*.25,translationY:datum.screenX})}else if(index%keepEvery===0){if(!(datum.screenX>=range3[0]&&datum.screenX<=range3[1]))return!1;label.formatter?tempText.text=callbackCache.call(label.formatter,{value:String(datum.label),index})??String(datum.label):tempText.text=String(datum.label)}else return!1;return!0},"setLabelProps");treeLabels.forEach((datum,index)=>{if(!setLabelProps(datum,index))return;const bbox2=tempText.getBBox();if(!bbox2)return;labelBBoxes.set(index,bbox2),!datum.children.length&&bbox2.width>maxLeafLabelWidth&&(maxLeafLabelWidth=bbox2.width)});const labelX=sideFlag*label.padding,labelGrid=this.label.grid,separatorData=[];treeLabels.forEach((datum,index)=>{let visible=setLabelProps(datum,index);const id=index;tempText.x=labelX,tempText.rotationCenterX=labelX;const isLeaf=!datum.children.length;if(isLeaf)tempText.rotation=configuredRotation,tempText.textAlign="end",tempText.textBaseline="middle";else{tempText.translationX-=maxLeafLabelWidth-lineHeight+this.label.padding;const availableRange=datum.leafCount*bandwidth,bbox2=labelBBoxes.get(id);bbox2&&bbox2.width>availableRange?(visible=!1,labelBBoxes.delete(id)):isHorizontal?tempText.rotation=defaultRotation:tempText.rotation=-Math.PI/2}if(datum.parent&&isLabelTree){const y=isLeaf?datum.screenX-bandwidth/2:datum.screenX-datum.leafCount*bandwidth/2;if(isLeaf)(datum.number!==datum.children.length-1||labelGrid)&&separatorData.push({y,x1:0,x2:-maxLeafLabelWidth-this.label.padding*2});else{const x=-maxLeafLabelWidth-this.label.padding*2+datum.screenY;separatorData.push({y,x1:x+lineHeight,x2:x})}}let props;if(visible){const bbox2=Transformable.toCanvas(tempText);bbox2&&labelBBoxes.set(index,bbox2),props={...copyLabelProps(tempText),visible}}else labelBBoxes.delete(index),props={visible};tickLabelLayout.push(props)});let minX=0;separatorData.forEach(d=>minX=Math.min(minX,d.x2)),separatorData.push({y:Math.max(rangeStart,rangeEnd),x1:0,x2:minX});const separatorLayout=[],separatorBoxes=[],epsilon2=1e-7;separatorData.forEach(datum=>{if(datum.y>=range3[0]-epsilon2&&datum.y<=range3[1]+epsilon2){const{x1,x2,y}=datum,separatorBox=new BBox(Math.min(x1,x2),y,Math.abs(x1-x2),0);separatorBoxes.push(separatorBox),separatorLayout.push({x1,x2,y})}});const axisLineLayout=[],axisLineBoxes=[],lineCount=tickTreeLayout?tickTreeLayout.depth+1:1;for(let i=0;i<lineCount;i++){const visible=labels.length>0&&(i===0||labelGrid&&isLabelTree),x=i>0?-maxLeafLabelWidth-this.label.padding*2-(i-1)*lineHeight:0,lineBox=new BBox(x,Math.min(...range3),0,Math.abs(range3[1]-range3[0]));axisLineBoxes.push(lineBox),axisLineLayout.push({x,y1:range3[0],y2:range3[1],visible})}const bbox=BBox.merge([...labelBBoxes.values(),...separatorBoxes,...axisLineBoxes]);return{bbox:this.getTransformBox(bbox),tickLabelLayout,separatorLayout,axisLineLayout}}calculateLayout(){const{axisLineLayout,separatorLayout,tickLabelLayout,bbox}=this.computeLayout();return this.computedLayout={axisLineLayout,separatorLayout,tickLabelLayout},{bbox,primaryTickCount:void 0}}},__name(_a61,"GroupedCategoryAxis"),_a61);GroupedCategoryAxis.className="GroupedCategoryAxis";GroupedCategoryAxis.type="grouped-category";__decorateClass([Validate(COLOR_STRING,{optional:!0})],GroupedCategoryAxis.prototype,"labelColor",2);var _a62,BaseModuleInstance=(_a62=class{constructor(){this.destroyFns=[]}destroy(){for(const destroyFn of this.destroyFns)destroyFn()}},__name(_a62,"BaseModuleInstance"),_a62),_a63,ModuleRegistry=(_a63=class{constructor(){this.modules=[],this.dependencies=new Map,this.dependents=new Map}register(...modules){for(const module of modules){this.registerDependencies(module);const otherModule=this.modules.find(other=>module.type===other.type&&module.optionsKey===other.optionsKey&&module.identifier===other.identifier);if(otherModule){if(module.packageType==="enterprise"&&otherModule.packageType==="community"){const index=this.modules.indexOf(otherModule);this.modules.splice(index,1,module)}}else this.modules.push(module)}}hasEnterpriseModules(){return this.modules.some(m=>m.packageType==="enterprise")}*byType(...types){const{dependents}=this,yielded=new Set;let count=0;const maxCount=3,modulesByType=this.modules.filter(module=>types.includes(module.type));do{for(const module of modulesByType)if(!(yielded.has(module.optionsKey)||dependents.has(module.optionsKey))){yield module,yielded.add(module.optionsKey);for(const[key,dependencies]of dependents.entries())dependencies.delete(module.optionsKey),dependencies.size===0&&dependents.delete(key)}count++}while(yielded.size<modulesByType.length&&count<maxCount);if(dependents.size>0)throw new Error(`Could not resolve module dependencies: [${[...dependents.keys()]}]`)}registerDependencies(module){if(!(module.dependencies==null||module.dependencies.length===0)){for(const key of module.dependencies){const dependencies=this.dependencies.get(key)??new Set;dependencies.add(module.optionsKey),this.dependencies.set(key,dependencies)}this.dependents.set(module.optionsKey,new Set(module.dependencies))}}},__name(_a63,"ModuleRegistry"),_a63),moduleRegistry=new ModuleRegistry;function sleep(sleepTimeoutMs){return new Promise(resolve=>{setTimeout(()=>resolve(void 0),sleepTimeoutMs)})}__name(sleep,"sleep");var _a64,Mutex=(_a64=class{constructor(){this.available=!0,this.acquireQueue=[]}acquire(cb){return new Promise(resolve=>{this.acquireQueue.push([cb,resolve]),this.available&&this.dispatchNext().catch(e=>Logger.errorOnce(e))})}async acquireImmediately(cb){return this.available?(await this.acquire(cb),!0):!1}async waitForClearAcquireQueue(){return this.acquire(async()=>{})}async dispatchNext(){this.available=!1;let[next,done]=this.acquireQueue.shift()??[];for(;next;){try{await next(),done==null||done()}catch(error){Logger.error("mutex callback error",error),done==null||done()}[next,done]=this.acquireQueue.shift()??[]}this.available=!0}},__name(_a64,"Mutex"),_a64),_a65,Observable=(_a65=class{constructor(){this.eventListeners=new Map}addEventListener(eventType,listener){if(typeof listener!="function")throw new Error("AG Charts - listener must be a Function");const eventTypeListeners=this.eventListeners.get(eventType);eventTypeListeners?eventTypeListeners.add(listener):this.eventListeners.set(eventType,new Set([listener]))}removeEventListener(type,listener){var _a274;(_a274=this.eventListeners.get(type))==null||_a274.delete(listener),this.eventListeners.size===0&&this.eventListeners.delete(type)}hasEventListener(type){return this.eventListeners.has(type)}clearEventListeners(){this.eventListeners.clear()}fireEvent(event){var _a274;(_a274=this.eventListeners.get(event.type))==null||_a274.forEach(listener=>listener(event))}},__name(_a65,"Observable"),_a65),_a66,Padding=(_a66=class extends BaseProperties{constructor(top=0,right=top,bottom=top,left=right){super(),this.top=top,this.right=right,this.bottom=bottom,this.left=left}},__name(_a66,"Padding"),_a66);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"top",2);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"right",2);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"bottom",2);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"left",2);function debouncedAnimationFrame(cb){return buildScheduler((innerCb,_delayMs)=>getWindow().requestAnimationFrame(innerCb),cb)}__name(debouncedAnimationFrame,"debouncedAnimationFrame");function debouncedCallback(cb){return buildScheduler((innerCb,delayMs=0)=>setTimeout(innerCb,delayMs),cb)}__name(debouncedCallback,"debouncedCallback");function buildScheduler(scheduleFn,cb){let scheduleCount=0,promiseRunning=!1,awaitingPromise,awaitingDone;const busy=__name(()=>promiseRunning,"busy"),done=__name(()=>{promiseRunning=!1,awaitingDone==null||awaitingDone(),awaitingDone=void 0,awaitingPromise=void 0,scheduleCount>0&&scheduleFn(scheduleCb)},"done"),scheduleCb=__name(()=>{const count=scheduleCount;scheduleCount=0,promiseRunning=!0;const maybePromise=cb({count});if(!maybePromise){done();return}maybePromise.then(done,done)},"scheduleCb");return{schedule(delayMs){scheduleCount===0&&!busy()&&scheduleFn(scheduleCb,delayMs),scheduleCount++},async await(){if(busy())for(awaitingPromise==null&&(awaitingPromise=new Promise(resolve=>{awaitingDone=resolve}));busy();)await awaitingPromise}}}__name(buildScheduler,"buildScheduler");var _a67,EventEmitter=(_a67=class{constructor(){this.events=new Map}on(eventName,listener){var _a274;return this.events.has(eventName)||this.events.set(eventName,new Set),(_a274=this.events.get(eventName))==null||_a274.add(listener),()=>this.off(eventName,listener)}off(eventName,listener){const eventListeners=this.events.get(eventName);eventListeners&&(eventListeners.delete(listener),eventListeners.size===0&&this.events.delete(eventName))}emit(eventName,event){var _a274;(_a274=this.events.get(eventName))==null||_a274.forEach(callback2=>callback2(event))}clear(eventName){eventName?this.events.delete(eventName):this.events.clear()}},__name(_a67,"EventEmitter"),_a67),LayoutElement=(LayoutElement2=>(LayoutElement2[LayoutElement2.Caption=0]="Caption",LayoutElement2[LayoutElement2.Legend=1]="Legend",LayoutElement2[LayoutElement2.Toolbar=2]="Toolbar",LayoutElement2[LayoutElement2.Navigator=3]="Navigator",LayoutElement2[LayoutElement2.Overlay=4]="Overlay",LayoutElement2))(LayoutElement||{}),_a68,LayoutManager=(_a68=class{constructor(){this.events=new EventEmitter,this.elements=new Map}addListener(eventName,listener){return this.events.on(eventName,listener)}registerElement(element2,listener){return this.elements.has(element2)?this.elements.get(element2).add(listener):this.elements.set(element2,new Set([listener])),()=>{var _a274;return(_a274=this.elements.get(element2))==null?void 0:_a274.delete(listener)}}createContext(width,height){var _a274;const context=new LayoutContext(width,height);for(const element2 of Object.values(LayoutElement))typeof element2=="number"&&((_a274=this.elements.get(element2))==null||_a274.forEach(listener=>listener(context)));return context}emitLayoutComplete(context,options){const eventType="layout:complete",{width,height}=context;this.events.emit(eventType,{type:eventType,axes:options.axes??[],chart:{width,height},clipSeries:options.clipSeries??!1,series:options.series})}},__name(_a68,"LayoutManager"),_a68),_a69,LayoutContext=(_a69=class{constructor(width,height){this.width=width,this.height=height,this.layoutBox=new BBox(0,0,width,height)}},__name(_a69,"LayoutContext"),_a69),_a70,ChartCaptions=(_a70=class{constructor(){this.title=new Caption,this.subtitle=new Caption,this.footnote=new Caption}positionCaptions(ctx){const{title,subtitle,footnote}=this,maxHeight=ctx.layoutBox.height/10;if(title.enabled){const{spacing=subtitle.enabled?Caption.SMALL_PADDING:Caption.LARGE_PADDING}=title;this.positionCaption("top",title,ctx.layoutBox,maxHeight),this.shrinkLayoutByCaption("top",title,ctx.layoutBox,spacing)}subtitle.enabled&&(this.positionCaption("top",subtitle,ctx.layoutBox,maxHeight),this.shrinkLayoutByCaption("top",subtitle,ctx.layoutBox,subtitle.spacing)),footnote.enabled&&(this.positionCaption("bottom",footnote,ctx.layoutBox,maxHeight),this.shrinkLayoutByCaption("bottom",footnote,ctx.layoutBox,footnote.spacing))}positionAbsoluteCaptions(ctx){const{title,subtitle,footnote}=this,{rect}=ctx.series;for(const caption of[title,subtitle,footnote])if(caption.layoutStyle==="overlay"){if(caption.textAlign==="left")caption.node.x=rect.x+caption.padding;else if(caption.textAlign==="right"){const bbox=caption.node.getBBox();caption.node.x=rect.x+rect.width-bbox.width-caption.padding}}}computeX(align,layoutBox){return align==="left"?layoutBox.x:align==="right"?layoutBox.x+layoutBox.width:layoutBox.x+layoutBox.width/2}positionCaption(vAlign,caption,layoutBox,maxHeight){const containerHeight=Math.max(TextUtils.getLineHeight(caption.fontSize),maxHeight);caption.node.x=this.computeX(caption.textAlign,layoutBox)+caption.padding,caption.node.y=layoutBox.y+(vAlign==="top"?0:layoutBox.height)+caption.padding,caption.node.textBaseline=vAlign,caption.computeTextWrap(layoutBox.width,containerHeight)}shrinkLayoutByCaption(vAlign,caption,layoutBox,spacing=0){if(caption.layoutStyle==="block"){const bbox=caption.node.getBBox();layoutBox.shrink(Math.ceil(vAlign==="top"?bbox.y-layoutBox.y+bbox.height+spacing:layoutBox.y+layoutBox.height-bbox.y+spacing),vAlign)}}},__name(_a70,"ChartCaptions"),_a70);__decorateClass([Validate(OBJECT)],ChartCaptions.prototype,"title",2);__decorateClass([Validate(OBJECT)],ChartCaptions.prototype,"subtitle",2);__decorateClass([Validate(OBJECT)],ChartCaptions.prototype,"footnote",2);var VERSION="10.2.0",NOT_FOUND=Symbol("previous-memento-not-found"),_a71,HistoryManager=(_a71=class{constructor(domManager){this.history=[],this.historyIndex=-1,this.originators=new Map,this.clearState=new Map,this.maxHistoryLength=100,this.debug=Debug.create(!0,"history"),domManager.addEventListener("keydown",this.onKeyDown.bind(this))}addMementoOriginator(originator){this.originators.set(originator.mementoOriginatorKey,originator),this.clearState.set(originator.mementoOriginatorKey,originator.createMemento()),this.debugEvent("History add originator:",originator.mementoOriginatorKey)}clear(){this.debug("History clear:",Object.keys(this.originators)),this.history=[],this.historyIndex=-1;for(const[mementoOriginatorKey,originator]of this.originators.entries())this.clearState.set(mementoOriginatorKey,originator.createMemento())}record(label,...originators){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.length>this.maxHistoryLength&&(this.history=this.history.slice(-this.maxHistoryLength));const mementos=new Map;for(const originator of originators){if(!this.originators.has(originator.mementoOriginatorKey))throw new Error(`Originator [${originator.mementoOriginatorKey}] has not been added to the HistoryManager.`);mementos.set(originator.mementoOriginatorKey,originator.createMemento())}this.history.push({label,mementos}),this.historyIndex=this.history.length-1,this.debugEvent(`History record: [${label}]`)}undo(){const undoAction=this.history[this.historyIndex];if(undoAction){for(const mementoOriginatorKey of undoAction.mementos.keys()){const previousMemento=this.findPreviousMemento(mementoOriginatorKey);if(previousMemento===NOT_FOUND)throw new Error(`Could not find previous memento for [${mementoOriginatorKey}].`);this.restoreMemento(mementoOriginatorKey,previousMemento)}this.historyIndex-=1,this.debugEvent(`History undo: [${undoAction.label}]`)}}redo(){const redoAction=this.history[this.historyIndex+1];if(redoAction){for(const[mementoOriginatorKey,memento]of redoAction.mementos.entries())this.restoreMemento(mementoOriginatorKey,memento);this.historyIndex+=1,this.debugEvent(`History redo: [${redoAction.label}]`)}}onKeyDown(event){const modifierKey=event.ctrlKey||event.metaKey;modifierKey&&(event.key==="y"||event.key==="z"&&event.shiftKey)?this.redo():modifierKey&&event.key==="z"&&this.undo()}findPreviousMemento(mementoOriginatorKey){for(let i=this.historyIndex-1;i>=0;i--)if(this.history[i].mementos.has(mementoOriginatorKey))return this.history[i].mementos.get(mementoOriginatorKey);return this.clearState.has(mementoOriginatorKey)?this.clearState.get(mementoOriginatorKey):NOT_FOUND}restoreMemento(mementoOriginatorKey,memento){var _a274;(_a274=this.originators.get(mementoOriginatorKey))==null||_a274.restoreMemento(VERSION,VERSION,memento)}debugEvent(...logContent){this.debug(...logContent,this.history.map((action,index)=>index===this.historyIndex?`** ${action.label} **`:action.label))}},__name(_a71,"HistoryManager"),_a71),_a72,MementoCaretaker=(_a72=class{constructor(version){this.version=version.split("-")[0]}save(...originators){const packet={version:this.version};for(const originator of Object.values(originators))packet[originator.mementoOriginatorKey]=this.encode(originator,originator.createMemento());return packet}restore(blob,...originators){if(typeof blob!="object"){Logger.warnOnce(`Could not restore data of type [${typeof blob}], expecting an object, ignoring.`);return}if(blob==null){Logger.warnOnce("Could not restore data of type [null], expecting an object, ignoring.");return}if(!("version"in blob)||typeof blob.version!="string"){Logger.warnOnce("Could not restore data, missing [version] string in object, ignoring.");return}for(const originator of originators){if(!(originator.mementoOriginatorKey in blob))continue;const memento=this.decode(originator,blob[originator.mementoOriginatorKey]);if(!originator.guardMemento(memento)){Logger.warnOnce(`Could not restore [${originator.mementoOriginatorKey}] data, value was invalid, ignoring.`,memento);return}originator.restoreMemento(this.version,blob.version,memento)}}encode(originator,memento){try{return JSON.parse(JSON.stringify(memento,this.encodeTypes))}catch(error){throw new Error(`Failed to encode [${originator.mementoOriginatorKey}] value [${error}].`,{cause:error})}}decode(originator,encoded){try{return JSON.parse(JSON.stringify(encoded),this.decodeTypes)}catch(error){throw new Error(`Failed to decode [${originator.mementoOriginatorKey}] value [${error}].`,{cause:error})}}encodeTypes(key,value){return isDate(this[key])?{__type:"date",value:String(this[key])}:value}decodeTypes(key,value){return isObject(this[key])&&"__type"in this[key]&&this[key].__type==="date"?new Date(this[key].value):value}},__name(_a72,"MementoCaretaker"),_a72),_a73,StateManager=(_a73=class{constructor(){this.caretaker=new MementoCaretaker(VERSION),this.state=new Map}setState(originator,value){jsonDiff(this.state.get(originator.mementoOriginatorKey),value)!=null&&(this.state.set(originator.mementoOriginatorKey,value),this.restoreState(originator))}restoreState(originator){const{caretaker,state}=this;if(!state.has(originator.mementoOriginatorKey))return;const value=state.get(originator.mementoOriginatorKey);caretaker.restore({version:caretaker.version,[originator.mementoOriginatorKey]:value},originator)}},__name(_a73,"StateManager"),_a73),_a74,Listeners=(_a74=class{constructor(){this.registeredListeners=new Map}addListener(eventType,handler){const record={symbol:Symbol(eventType),handler};return this.registeredListeners.has(eventType)?this.registeredListeners.get(eventType).push(record):this.registeredListeners.set(eventType,[record]),()=>this.removeListener(record.symbol)}removeListener(eventSymbol){for(const[type,listeners]of this.registeredListeners.entries()){const matchIndex=listeners.findIndex(listener=>listener.symbol===eventSymbol);if(matchIndex>=0){listeners.splice(matchIndex,1),listeners.length===0&&this.registeredListeners.delete(type);break}}}dispatch(eventType,...params){for(const listener of this.getListenersByType(eventType))try{listener.handler(...params)}catch(e){Logger.errorOnce(e)}}dispatchWrapHandlers(eventType,wrapFn,...params){for(const listener of this.getListenersByType(eventType))try{wrapFn(listener.handler,...params)}catch(e){Logger.errorOnce(e)}}getListenersByType(eventType){return this.registeredListeners.get(eventType)??[]}destroy(){this.registeredListeners.clear()}},__name(_a74,"Listeners"),_a74),_a75,BaseManager=(_a75=class{constructor(){this.listeners=new Listeners,this.destroyFns=[]}addListener(type,handler){return this.listeners.addListener(type,handler)}destroy(){this.listeners.destroy(),this.destroyFns.forEach(fn=>fn())}},__name(_a75,"BaseManager"),_a75),styles_default=`.ag-charts-wrapper,.ag-charts-wrapper:focus,.ag-charts-wrapper:after,.ag-charts-wrapper:before,.ag-charts-wrapper *,.ag-charts-wrapper *:focus,.ag-charts-wrapper *:after,.ag-charts-wrapper *:before{box-sizing:border-box;outline:none}.ag-charts-wrapper{position:relative}.ag-charts-canvas-center{width:100%;height:100%;position:absolute;touch-action:auto;display:flex;align-items:var(--ag-charts-align);justify-content:var(--ag-charts-justify)}.ag-charts-canvas-container,.ag-charts-canvas{position:relative}.ag-charts-canvas-container>*,.ag-charts-canvas>*{display:block}.ag-charts-canvas-proxy{position:absolute;top:0;left:0;opacity:0;pointer-events:none}.ag-charts-tab-guard{width:0;height:0;opacity:0}.ag-charts-canvas-overlay{pointer-events:none;position:absolute;inset:0}.ag-charts-canvas-overlay>*{position:absolute;pointer-events:auto}.ag-charts-theme-default,.ag-charts-theme-default-dark{--ag-charts-active-color: var(--ag-active-color, #2196f3);--ag-charts-background-color: var(--ag-background-color, #fff);--ag-charts-foreground-color: var(--ag-foreground-color, #181d1f);--ag-charts-border-color: var(--ag-border-color, #dddddd);--ag-charts-hover-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-active-color) 12%);--ag-charts-font-family: "Verdana", sans-serif;--ag-charts-font-size: var(--ag-font-size, 14px);--ag-charts-size: var(--ag-grid-size, 8px);--ag-charts-border: var(--ag-charts-border-color) var(--ag-borders, solid 1px);--ag-charts-border-critical: var(--ag-borders-critical, solid 1px);--ag-charts-layer-ui-overlay: 5;--ag-charts-layer-tooltip: 4;--ag-charts-layer-toolbar: 3;--ag-charts-layer-crosshair: 2;--ag-charts-layer-annotations: 1;--ag-charts-align: center;--ag-charts-justify: center;--ag-charts-axis-label-background-color: #474747;--ag-charts-axis-label-color: #ffffff;--ag-charts-toolbar-foreground-color: var(--ag-header-foreground-color, var(--ag-charts-foreground-color));--ag-charts-toolbar-background-color: var( --ag-header-background-color, color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-foreground-color) 2%) );--ag-charts-toolbar-size: 34px;--ag-charts-toolbar-size-small: 24px;--ag-charts-toolbar-border: var(--ag-charts-border-critical, solid 1px) var(--ag-charts-border-color);--ag-charts-toolbar-hover-color: color-mix( in srgb, var(--ag-charts-background-color), var(--ag-charts-active-color) 12% );--ag-charts-toolbar-focus-color: var(--ag-charts-active-color);--ag-charts-toolbar-active-background-color: var(--ag-charts-toolbar-hover-color);--ag-charts-toolbar-active-color: var(--ag-charts-active-color);--ag-charts-toolbar-disabled-foreground-color: var( --ag-disabled-foreground-color, color-mix(in srgb, transparent, var(--ag-charts-toolbar-foreground-color) 50%) );--ag-charts-toolbar-disabled-background-color: color-mix( in srgb, var(--ag-charts-toolbar-background-color), var(--ag-charts-toolbar-foreground-color) 6% );--ag-charts-toolbar-gap: var(--ag-charts-size);--ag-charts-toolbar-font-size: 13px;--ag-charts-toolbar-font-size-small: 12px;--ag-charts-toolbar-button-padding: 6px;--ag-charts-toolbar-button-padding-small: 1px;--ag-charts-popover-background-color: var(--ag-charts-toolbar-background-color);--ag-charts-popover-foreground-color: var(--ag-charts-toolbar-foreground-color);--ag-charts-popover-border: var(--ag-charts-toolbar-border);--ag-charts-popover-border-radius: var(--ag-border-radius, 4px);--ag-charts-popover-active-color: var(--ag-charts-toolbar-active-color);--ag-charts-popover-hover-color: var(--ag-charts-toolbar-hover-color);--ag-charts-popover-active-background-color: var(--ag-charts-toolbar-active-background-color);--ag-charts-popover-font-size: 14px;--ag-charts-popover-font-size-small: var(--ag-charts-toolbar-font-size-small);--ag-charts-dialog-input-group-label-color: color-mix(in srgb, transparent, var(--ag-charts-foreground-color) 55%);--ag-charts-dialog-tab-color--inactive: color-mix(in srgb, transparent, var(--ag-charts-foreground-color) 55%);--ag-charts-button-radius: var(--ag-border-radius, 4px);--ag-charts-focus-border-color: var(--ag-input-focus-border-color, var(--ag-charts-active-color));--ag-charts-focus-border: solid 1px var(--ag-charts-focus-border-color);--ag-charts-focus-border-shadow: var( --ag-input-focus-box-shadow, 0 0 0 3px color-mix(in srgb, transparent, var(--ag-input-focus-border-color, var(--ag-charts-active-color)) 20%) );--ag-charts-focus-box-shadow: var(--box-shadow), 0 0 0 2px #fff8, var(--ag-charts-focus-border-shadow);--ag-charts-icon-font-family: "agChartsDefault";--ag-charts-icon-font-weight: normal;--ag-charts-icon-font-color: color-mix(in srgb, transparent, var(--ag-charts-foreground-color), 90%);--ag-charts-icon-size: 20px;--ag-charts-input-background-color: var(--ag-charts-background-color);--ag-charts-input-background-color--hover: var(--ag-charts-hover-color);--ag-charts-input-background-color--active: var(--ag-charts-hover-color);--ag-charts-input-border-color: var(--ag-charts-border-color);--ag-charts-input-border-color--active: var(--ag-charts-active-color);--ag-charts-input-border-radius: var(--ag-border-radius, 4px);--ag-charts-input-color--active: var(--ag-charts-active-color);--ag-charts-input-focus-outline: var(--ag-charts-focus-border);--ag-charts-input-focus-box-shadow: var(--ag-charts-focus-border-shadow);--ag-charts-input-font-family: var(--ag-charts-font-family);--ag-charts-input-font-size: var(--ag-charts-font-size);--ag-charts-input-padding: 8px;--ag-charts-input-padding-large: 10px;--ag-charts-input-placeholder-color: #888888;--ag-charts-input-spacing: 8px;--ag-charts-input-transition-duration: .25s;--ag-charts-input-transition-duration--fast: .1s;--ag-charts-input-transition-timing-function: ease-out;--ag-charts-input-checkbox-background-color: #babbbc;--ag-charts-input-checkbox-background-color--checked: var(--ag-charts-active-color)}.ag-charts-theme-default-dark{--ag-charts-background-color: var(--ag-background-color, color-mix(in srgb, #fff, #182230 97%));--ag-charts-foreground-color: var(--ag-foreground-color, #fff);--ag-charts-border-color: var(--ag-border-color, rgba(255, 255, 255, .16));--ag-charts-hover-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-active-color) 18%);--ag-charts-axis-label-background-color: #9caebb;--ag-charts-axis-label-color: #000000;--ag-charts-toolbar-background-color: var(--ag-header-background-color, color-mix(in srgb, #fff, #182230 93%));--ag-charts-toolbar-hover-color: color-mix( in srgb, var(--ag-charts-background-color), var(--ag-charts-active-color) 18% );--ag-charts-dialog-input-group-label-text-color: #ffffff;--ag-charts-focus-border-shadow: var( --ag-input-focus-box-shadow, 0 0 0 3px color-mix(in srgb, transparent, var(--ag-input-focus-border-color, var(--ag-charts-active-color)) 20%) );--ag-charts-input-placeholder-color: #aaaaaa}.ag-charts-icon{display:block;width:var(--ag-charts-icon-size);height:var(--ag-charts-icon-size);speak:none;speak:never;mask:var(--icon) center / contain no-repeat;background-color:currentColor;transition:background-color .25s ease-in-out}.ag-charts-icon-align-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNyAxMGg2djFIN3pNNCA3aDEydjFINHptMSA2aDEwdjFINXoiLz48L3N2Zz4=)}.ag-charts-icon-align-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNCAxMGg2djFINHptMC0zaDEydjFINHptMCA2aDEwdjFINHoiLz48L3N2Zz4=)}.ag-charts-icon-align-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTAgMTBoNnYxaC02ek00IDdoMTJ2MUg0em0yIDZoMTB2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-arrow-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1LjI5MyA0LjVIMTIuNXYtMUgxN3Y0aC0xVjUuMjA3bC05LjY0NiA5LjY0Ny0uNzA4LS43MDh6IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDE2YTIuNSAyLjUgMCAxIDEtNSAwIDIuNSAyLjUgMCAwIDEgNSAwbS0yLjUgMS41YTEuNSAxLjUgMCAxIDAgMC0zIDEuNSAxLjUgMCAwIDAgMCAzIiBmaWxsPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-arrow-down-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02IDhMMS41IDhMMTAgMThMMTguNSA4TDE0IDhMMTQgM0w2IDNMNiA4Wk03IDRMNyA5SDMuNjYyNDRMMTAgMTYuNDU2TDE2LjMzNzYgOUwxMyA5TDEzIDRMNyA0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-arrow-up-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNCAxMkgxOC41TDEwIDJMMS41IDEySDZMNi4wMDAwMiAxN0gxNFYxMlpNMTMgMTZWMTFIMTYuMzM3NkwxMCAzLjU0NDA1TDMuNjYyNDQgMTFIN0w3LjAwMDAyIDE2SDEzWiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-callout-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtNC41MTRhMjYgMjYgMCAwIDAtMi4wMTcgMS41NGwtLjMxNC4yNmMtLjU1LjQ1Ny0xLjExNS45MjYtMS43NiAxLjQtLjY2OS40OTEtMS41NjItLjAxMi0xLjU2Mi0uOFYxNEg0LjVBMS41IDEuNSAwIDAgMSAzIDEyLjV6TTQuNSA0YS41LjUgMCAwIDAtLjUuNXY4YS41LjUgMCAwIDAgLjUuNWgxLjgzM3YzLjM3MmEzNiAzNiAwIDAgMCAxLjY3OC0xLjMzOGwuMzItLjI2NWEyNiAyNiAwIDAgMSAyLjIyNS0xLjY4NWwuMTI2LS4wODRIMTUuNWEuNS41IDAgMCAwIC41LS41di04YS41LjUgMCAwIDAtLjUtLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyAxdjNoMnYxMkg3djNINnYtM0g0VjRoMlYxek01IDVoM3YxMEg1ek0xMSAxNFY2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6bTEtN2gzdjZoLTN6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-close{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtNSA1IDEwIDEwTTUgMTUgMTUgNSIgc3Ryb2tlPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-comment-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy41MTMgMy45OTVhNi41IDYuNSAwIDAgMSA2LjA5OCAxMS40MWMtLjU4OC4zOTMtMS4yMTcuNTM2LTEuODI5LjU4NWExMyAxMyAwIDAgMS0xLjI3LjAxN0EyNyAyNyAwIDAgMCAxMCAxNkg0LjVhLjUuNSAwIDAgMS0uNS0uNVYxMHEwLS4yNDctLjAwNy0uNTEzYy0uMDA4LS40MTYtLjAxNi0uODU3LjAxNy0xLjI2OS4wNS0uNjEyLjE5Mi0xLjI0LjU4NS0xLjgzYTYuNSA2LjUgMCAwIDEgMi45MTgtMi4zOTNtMy41Ni42MWE1LjUgNS41IDAgMCAwLTUuNjQ2IDIuMzRjLS4yNjYuMzk3LS4zNzkuODQyLS40MiAxLjM1NC0uMDMuMzYtLjAyMi43MTgtLjAxNSAxLjEwOFE1IDkuNjg5IDUgMTB2NWg1cS4zMTEuMDAxLjU5My4wMDhjLjM5LjAwNy43NDcuMDE1IDEuMTA4LS4wMTUuNTEyLS4wNDEuOTU3LS4xNTQgMS4zNTUtLjQyYTUuNSA1LjUgMCAwIDAtMS45ODMtOS45NjciIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-crosshair-add-line{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-delete{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTguNDk2IDguOTk2QS41LjUgMCAwIDEgOSA5LjQ5MnY0YS41LjUgMCAxIDEtMSAuMDA4di00YS41LjUgMCAwIDEgLjQ5Ni0uNTA0TTEyIDkuNWEuNS41IDAgMCAwLTEgMHY0YS41LjUgMCAwIDAgMSAweiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTYgNVYzLjVBMi41IDIuNSAwIDAgMSA4LjUgMWgzQTIuNSAyLjUgMCAwIDEgMTQgMy41VjVoMi44MzNhLjUuNSAwIDAgMSAwIDFIMTV2MTAuMjVjMCAuNDE1LS4wNjYuODYzLS4zIDEuMjIxLS4yNTcuMzk0LS42NzIuNjEyLTEuMi42MTJoLTdjLS41MjggMC0uOTQzLS4yMTgtMS4yLS42MTItLjIzNC0uMzU4LS4zLS44MDYtLjMtMS4yMjFWNkgzLjMzM2EuNS41IDAgMCAxIDAtMXptMS0xLjVBMS41IDEuNSAwIDAgMSA4LjUgMmgzQTEuNSAxLjUgMCAwIDEgMTMgMy41VjVIN3pNNiAxNi4yNVY2aDh2MTAuMjVjMCAuMzM1LS4wNTkuNTU0LS4xMzguNjc1LS4wNTUuMDg1LS4xNC4xNTgtLjM2Mi4xNThoLTdjLS4yMjIgMC0uMzA3LS4wNzMtLjM2Mi0uMTU4LS4wOC0uMTIxLS4xMzgtLjM0LS4xMzgtLjY3NSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-disjoint-channel,.ag-charts-icon-disjoint-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTkuMDI4IDE3LjQ2YTIuMjUgMi4yNSAwIDAgMC00LjA5Mi0xLjg1bC05LjUxMS0yLjM3OGEyLjI1IDIuMjUgMCAxIDAtLjIyNS45NzRsOS40NzUgMi4zNjlhMi4yNTEgMi4yNTEgMCAwIDAgNC4zNTMuODg2bS0xLjY2Mi0xLjk2NWExLjI1IDEuMjUgMCAxIDEtLjg4NSAyLjMzOCAxLjI1IDEuMjUgMCAwIDEgLjg4NS0yLjMzOE00LjM0MyAxMy42NjlhMS4yNSAxLjI1IDAgMSAwLTIuMzM4LS44ODUgMS4yNSAxLjI1IDAgMCAwIDIuMzM4Ljg4NU0zLjk3IDguNzY5YTIuMjUgMi4yNSAwIDAgMCAxLjQ1NS0yLjExbDkuNTExLTIuMzc4YTIuMjUgMi4yNSAwIDEgMC0uMjYtLjk2NUw1LjIgNS42ODVhMi4yNSAyLjI1IDAgMSAwLTEuMjMgMy4wODRtLjM3My0yLjU0N2ExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjc1LTMuNDM4YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-drag-handle{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjcuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjxjaXJjbGUgY3g9IjEzLjc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iMTMuNzUiIGN5PSIxMS43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjExLjc1IiByPSIuNzUiIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjUiLz48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iMTEuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjwvc3ZnPg==)}.ag-charts-icon-hollow-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1vcGFjaXR5PSIuMTUiIGQ9Ik01IDVoM3YxMEg1eiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTcgMXYzaDJ2MTJIN3YzSDZ2LTNINFY0aDJWMXpNNSA1aDN2MTBINXptNyAyaDN2NmgtM3ptLTEgN1Y2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-horizontal-line,.ag-charts-icon-horizontal-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNLjUgOS41aDcuMzA2YTIuMjUgMi4yNSAwIDAgMSA0LjM4OCAwSDE5LjV2MWgtNy4zMDZhMi4yNSAyLjI1IDAgMCAxLTQuMzg4IDBILjV6bTkuNSAxLjc1YTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-line-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQuMjQyIDIuNzIyYy0uNjEyIDAtMS4yLjI0My0xLjYzMi42NzVsLTEuMzQzIDEuMzQ0YS41LjUgMCAwIDAtLjExMi4xMTJMNC4wNSAxMS45NTljLS4yMDcuMjA3LS4zNi40Ni0uNDQ2Ljc0di4wMDFsLS42OSAyLjc2N3YuMDAyYS44Mi44MiAwIDAgMCAxLjAyMiAxLjAyMWguMDAybDIuNjM0LS44MjJjLjI4LS4wODUuNTM0LS4yMzcuNzQtLjQ0M2w3LjEwNy03LjEwOGEuNS41IDAgMCAwIC4xMTItLjExMmwxLjM0My0xLjM0M2EyLjMwOCAyLjMwOCAwIDAgMC0xLjYzMi0zLjk0TTE0LjEyMiA3bDEuMDQ0LTEuMDQ1YTEuMzA4IDEuMzA4IDAgMSAwLTEuODQ5LTEuODVMMTIuMjcxIDUuMTV6bS0yLjU1OC0xLjE0Mi02LjgwNyA2LjgwOWEuOC44IDAgMCAwLS4xOTYuMzI1bC0uNzUgMi40NjggMi40Ny0uNzQ5YS44LjggMCAwIDAgLjMyNS0uMTk0bDYuODA4LTYuODF6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTcuMzYyIDQuODczLTQuNTk0IDYuNjU0LTQuODUtMy4zMTctNC4yNTEgNi45NzctLjg1NC0uNTJMNy42MTIgNi43OWw0Ljg5OSAzLjM1IDQuMDI4LTUuODM2eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-line-style-dashed{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDR2MUgyem0xMiAwaDR2MWgtNHpNOCA5aDR2MUg4eiIvPjwvc3ZnPg==)}.ag-charts-icon-line-style-dotted{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyLjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSI4LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSIxMi41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjE0LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-line-style-solid{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDE2djFIMnoiLz48L3N2Zz4=)}.ag-charts-icon-line-with-markers-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTk4IDQuODg4LTMuNTU2IDQuOTE4YTIuMjUgMi4yNSAwIDEgMS0zLjg2Ni43NWwtMS40MzItLjlhMi4yNCAyLjI0IDAgMCAxLTIuMDA5LjQzNWwtMy44MjggNi40MjgtLjg2LS41MTJMNi40NSA5LjYyM2EyLjI1IDIuMjUgMCAxIDEgMy41MS0uNzYxbDEuMzI5LjgzNWEyLjI0IDIuMjQgMCAwIDEgMi41NTctLjQ5N2wzLjU0Mi00Ljg5OHptLTQuOTYgNS4xNTNhMS4yNSAxLjI1IDAgMSAwLS42NCAyLjQxOSAxLjI1IDEuMjUgMCAwIDAgLjY0LTIuNDE5TTkuMSA4LjMyMXEuMDY2LS4xOTIuMDY3LS40MDRhMS4yNSAxLjI1IDAgMSAwLS4wNjcuNDA0IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-lock,.ag-charts-icon-locked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMjA3IDMuNzY0YTIuODk0IDIuODk0IDAgMCAwLTIuODk1IDIuODk0VjloNS43ODlWNi42NThhMi44OTQgMi44OTQgMCAwIDAtMi44OTUtMi44OTRNMTQuMSA5VjYuNjU4YTMuODk0IDMuODk0IDAgMSAwLTcuNzg5IDB2Mi4zNDlBMi41IDIuNSAwIDAgMCA0IDExLjV2M0EyLjUgMi41IDAgMCAwIDYuNSAxN2g4YTIuNSAyLjUgMCAwIDAgMi41LTIuNXYtM0EyLjUgMi41IDAgMCAwIDE0LjUgOXpNNi41IDEwQTEuNSAxLjUgMCAwIDAgNSAxMS41djNBMS41IDEuNSAwIDAgMCA2LjUgMTZoOGExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTNhMS41IDEuNSAwIDAgMC0xLjUtMS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-note-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtMy4yMWwtMS40NjkgMi41N2ExIDEgMCAwIDEtMS42ODIuMDg1TDcuMjQzIDE0SDQuNUExLjUgMS41IDAgMCAxIDMgMTIuNXpNNC41IDRhLjUuNSAwIDAgMC0uNS41djhhLjUuNSAwIDAgMCAuNS41aDMuMjU3bDIuMTk2IDMuMDc0TDExLjcxIDEzaDMuNzlhLjUuNSAwIDAgMCAuNS0uNXYtOGEuNS41IDAgMCAwLS41LS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNi41IDYuNUEuNS41IDAgMCAxIDcgNmg2YS41LjUgMCAwIDEgMCAxSDdhLjUuNSAwIDAgMS0uNS0uNU02LjUgOS41QS41LjUgMCAwIDEgNyA5aDZhLjUuNSAwIDAgMSAwIDFIN2EuNS41IDAgMCAxLS41LS41IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-ohlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTEzIDExaC0zdi0xaDNWM2gxdjJoNHYxaC00djExaC0xek02IDE3di0yaDN2LTFINlY0SDV2MUgydjFoM3YxMXoiLz48L3N2Zz4=)}.ag-charts-icon-fill-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtOC4wNzEgNC4wNi0uOTI0LS45MjQuNzA3LS43MDcgNy4yODggNy4yODgtNC45NSA0Ljk1YTMuNSAzLjUgMCAwIDEtNC45NSAwbC0xLjQxNC0xLjQxNGEzLjUgMy41IDAgMCAxIDAtNC45NXptLjcwNy43MDhMNC41MzYgOS4wMWEyLjUgMi41IDAgMCAwIDAgMy41MzZMNS45NSAxMy45NmEyLjUgMi41IDAgMCAwIDMuNTM1IDBsNC4yNDMtNC4yNDN6bTYuOSA3LjIwMi0uMzQ1LjM2My0uMzQ0LS4zNjNhLjUuNSAwIDAgMSAuNjg4IDBtLS4zNDUgMS4wOGE4IDggMCAwIDAtLjI4LjMyMyA0LjMgNC4zIDAgMCAwLS40MDkuNTgyYy0uMTEzLjIwMS0uMTQ0LjMyNi0uMTQ0LjM3OGEuODMzLjgzMyAwIDAgMCAxLjY2NyAwYzAtLjA1Mi0uMDMxLS4xNzctLjE0NC0uMzc4YTQuMyA0LjMgMCAwIDAtLjQxLS41ODIgOCA4IDAgMCAwLS4yOC0uMzIybS0uMzQ0LTEuMDguMzQ0LjM2My4zNDQtLjM2My4wMDIuMDAyLjAwNC4wMDQuMDEzLjAxMmE2IDYgMCAwIDEgLjIwNi4yMDhjLjEzMS4xMzYuMzA4LjMyNy40ODUuNTQ1LjE3Ni4yMTUuMzYzLjQ2Ny41MDcuNzI0LjEzNy4yNDMuMjczLjU1My4yNzMuODY4YTEuODMzIDEuODMzIDAgMSAxLTMuNjY3IDBjMC0uMzE1LjEzNi0uNjI1LjI3My0uODY4LjE0NC0uMjU3LjMzLS41MDkuNTA3LS43MjRhOSA5IDAgMCAxIC42NDUtLjcwOGwuMDQ2LS4wNDUuMDEzLS4wMTIuMDA0LS4wMDR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-pan-end{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0ibTYuNjQ2IDEzLjgxMy0uMzUzLjM1NC43MDcuNzA3LjM1NC0uMzU0ek0xMS4xNjYgMTBsLjM1NC4zNTQuMzU0LS4zNTQtLjM1NC0uMzU0ek03LjM1NSA1LjQ4IDcgNS4xMjZsLS43MDcuNzA3LjM1My4zNTR6bTAgOS4wNCA0LjE2Ni00LjE2Ni0uNzA3LS43MDgtNC4xNjcgNC4xNjd6bTQuMTY2LTQuODc0TDcuMzU0IDUuNDhsLS43MDguNzA3IDQuMTY3IDQuMTY3ek0xMy4wODMgNXYxMGgxVjV6Ii8+PC9zdmc+)}.ag-charts-icon-pan-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNzkgNS44MzMgOC42MjUgMTBsNC4xNjYgNC4xNjctLjcwNy43MDdMNy4yMSAxMGw0Ljg3My00Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMSAxNC4xNjcgMTEuMzc2IDEwIDcuMjEgNS44MzNsLjcwNy0uNzA3TDEyLjc5IDEwbC00Ljg3MyA0Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-start{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgNXYxMGgxVjV6TTkuNjI0IDEwbDQuMTY2LTQuMTY3LS43MDctLjcwN0w4LjIxIDEwbDQuODc0IDQuODc0LjcwNy0uNzA3eiIvPjwvc3ZnPg==)}.ag-charts-icon-parallel-channel,.ag-charts-icon-parallel-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTcuNzIgNS4zMzFBMi4yNSAyLjI1IDAgMSAwIDE0LjcwNSAzLjZsLTkuNDkgNC41NjJhMi4yNSAyLjI1IDAgMSAwIC4yMDkgMS4wMWw5LjY2Mi00LjY0NmEyLjI1IDIuMjUgMCAwIDAgMi42MzQuODA1bS4zNzMtMi41NDdhMS4yNSAxLjI1IDAgMSAxLTIuMzM4Ljg4NSAxLjI1IDEuMjUgMCAwIDEgMi4zMzgtLjg4NU00LjM0MyA4LjY3YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODVNNS4zMDcgMTYuNzI4YTIuMjUgMi4yNSAwIDEgMS0uNTI1LS44NThsOS45MjMtNC43N2EyLjI1IDIuMjUgMCAxIDEgLjM4MS45MjZ6bS0uOTY0LjI3NGExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjAyMy01LjEwNmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-position-bottom{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzem0zLTNoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgMTNoOHYxSDZ6Ii8+PC9zdmc+)}.ag-charts-icon-position-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMyAxMGgxNHYxSDN6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDdoOHYxSDZ6bTAgNmg4djFINnoiLz48L3N2Zz4=)}.ag-charts-icon-position-top{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzeiIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik02IDdoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDEzaDh2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-price-label-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNC41IDNBMS41IDEuNSAwIDAgMCAzIDQuNVYxM2ExLjUgMS41IDAgMCAwIDEuNSAxLjVoLjgzM3YuMDU3Yy4yNDItLjI5OS41OTctLjUwMyAxLS41NDhWMTMuNUg0LjVBLjUuNSAwIDAgMSA0IDEzVjQuNWEuNS41IDAgMCAxIC41LS41aDExYS41LjUgMCAwIDEgLjUuNXY4YS41LjUgMCAwIDEtLjUuNWgtNC44MThsLS4xMjYuMDg0YTI2IDI2IDAgMCAwLTIuMjI1IDEuNjg1bC0uMzIuMjY1LS4wNjguMDU2YTEuNSAxLjUgMCAwIDEtMi42MDkgMS4zNTRjLjAzMy43NjMuOTA1IDEuMjM4IDEuNTYuNzU2LjY0Ni0uNDc0IDEuMjEtLjk0MyAxLjc2MS0xLjRsLjMxMy0uMjZBMjYgMjYgMCAwIDEgMTAuOTg2IDE0SDE1LjVhMS41IDEuNSAwIDAgMCAxLjUtMS41di04QTEuNSAxLjUgMCAwIDAgMTUuNSAzeiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOC43MTYgMTQuODE1YTIuMjUgMi4yNSAwIDEgMS00LjIxIDEuNTkzIDIuMjUgMi4yNSAwIDAgMSA0LjIxLTEuNTkzbS0xLjY2MiAxLjk2NmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-reset{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDQgNC40NDVhNS44MSA1LjgxIDAgMCAwLTcuMjU3IDIuNDUzLjUuNSAwIDAgMS0uODY1LS41MDJBNi44MSA2LjgxIDAgMSAxIDMgOS44MTNhLjUuNSAwIDAgMSAxIDAgNS44MSA1LjgxIDAgMSAwIDguMDQtNS4zNjgiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQuMjg5IDMuMDAyYS41LjUgMCAwIDEgLjUuNXYyLjY1NWgyLjY1NWEuNS41IDAgMCAxIDAgMUg0LjI5YS41LjUgMCAwIDEtLjUtLjVWMy41MDJhLjUuNSAwIDAgMSAuNS0uNSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-settings{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTAuMTgzIDEuNjY3aC0uMzY2QTEuNjY3IDEuNjY3IDAgMCAwIDguMTUgMy4zMzN2LjE1YTEuNjcgMS42NyAwIDAgMS0uODMzIDEuNDQybC0uMzU5LjIwOGExLjY3IDEuNjcgMCAwIDEtMS42NjYgMGwtLjEyNS0uMDY2YTEuNjY3IDEuNjY3IDAgMCAwLTIuMjc1LjYwOGwtLjE4NC4zMTdhMS42NjcgMS42NjcgMCAwIDAgLjYwOSAyLjI3NWwuMTI1LjA4M2ExLjY3IDEuNjcgMCAwIDEgLjgzMyAxLjQzM3YuNDI1YTEuNjcgMS42NyAwIDAgMS0uODMzIDEuNDVsLS4xMjUuMDc1YTEuNjY3IDEuNjY3IDAgMCAwLS42MDkgMi4yNzVsLjE4NC4zMTdhMS42NjcgMS42NjcgMCAwIDAgMi4yNzUuNjA4bC4xMjUtLjA2NmExLjY3IDEuNjcgMCAwIDEgMS42NjYgMGwuMzU5LjIwOGExLjY3IDEuNjcgMCAwIDEgLjgzMyAxLjQ0MnYuMTVhMS42NjYgMS42NjYgMCAwIDAgMS42NjcgMS42NjZoLjM2NmExLjY2NiAxLjY2NiAwIDAgMCAxLjY2Ny0xLjY2NnYtLjE1YTEuNjcgMS42NyAwIDAgMSAuODMzLTEuNDQybC4zNTktLjIwOGExLjY3IDEuNjcgMCAwIDEgMS42NjYgMGwuMTI1LjA2NmExLjY2NyAxLjY2NyAwIDAgMCAyLjI3NS0uNjA4bC4xODQtLjMyNWExLjY2NyAxLjY2NyAwIDAgMC0uNjA5LTIuMjc1bC0uMTI1LS4wNjdhMS42NyAxLjY3IDAgMCAxLS44MzMtMS40NXYtLjQxNmExLjY3IDEuNjcgMCAwIDEgLjgzMy0xLjQ1bC4xMjUtLjA3NWExLjY2NyAxLjY2NyAwIDAgMCAuNjA5LTIuMjc1bC0uMTg0LS4zMTdhMS42NjcgMS42NjcgMCAwIDAtMi4yNzUtLjYwOGwtLjEyNS4wNjZhMS42NyAxLjY3IDAgMCAxLTEuNjY2IDBsLS4zNTktLjIwOGExLjY3IDEuNjcgMCAwIDEtLjgzMy0xLjQ0MnYtLjE1YTEuNjY3IDEuNjY3IDAgMCAwLTEuNjY3LTEuNjY2IiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMCAxMi41YTIuNSAyLjUgMCAxIDAgMC01IDIuNSAyLjUgMCAwIDAgMCA1IiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjwvc3ZnPg==)}.ag-charts-icon-step-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzE4MUQxRiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiA0aDV2OGgzVjhoNXYxaC00djRoLTVWNUg3djEwSDJ2LTFoNHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-text-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDRIMTZWN0gxNVY1SDEwLjVWMTVIMTRWMTZINlYxNUg5LjVWNUg1VjdINFY0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-trend-line,.ag-charts-icon-trend-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS4zMTQgMTAuOTM4YTIuMjUgMi4yNSAwIDEgMSAuMDEtMWg5LjM1MmEyLjI1IDIuMjUgMCAxIDEgLjAxIDF6bS0yLjE4OS43MjlhMS4yNSAxLjI1IDAgMSAwIDAtMi41IDEuMjUgMS4yNSAwIDAgMCAwIDIuNW0xMy43NSAwYTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-unlock,.ag-charts-icon-unlocked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNjUxIDMuNWEyLjg5NCAyLjg5NCAwIDAgMC0yLjg5NCAyLjg5NFY5SDE0LjVhMi41IDIuNSAwIDAgMSAyLjUgMi41djNhMi41IDIuNSAwIDAgMS0yLjUgMi41aC04QTIuNSAyLjUgMCAwIDEgNCAxNC41di0zQTIuNSAyLjUgMCAwIDEgNi41IDloLjI1N1Y2LjM5NGEzLjg5NCAzLjg5NCAwIDEgMSA3Ljc4OSAwIC41LjUgMCAwIDEtMSAwQTIuODk0IDIuODk0IDAgMCAwIDEwLjY1IDMuNU02LjUgMTBBMS41IDEuNSAwIDAgMCA1IDExLjV2M0ExLjUgMS41IDAgMCAwIDYuNSAxNmg4YTEuNSAxLjUgMCAwIDAgMS41LTEuNXYtM2ExLjUgMS41IDAgMCAwLTEuNS0xLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-vertical-line,.ag-charts-icon-vertical-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNSA3LjgwNmEyLjI1IDIuMjUgMCAwIDEgMCA0LjM4OFYxOS41aC0xdi03LjMwNmEyLjI1IDIuMjUgMCAwIDEgMC00LjM4OFYuNWgxem0tLjUuOTQ0YTEuMjUgMS4yNSAwIDEgMSAwIDIuNSAxLjI1IDEuMjUgMCAwIDEgMC0yLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-zoom-in{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-zoom-out{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS41IDEwYS41LjUgMCAwIDEgLjUtLjVoOGEuNS41IDAgMCAxIDAgMUg2YS41LjUgMCAwIDEtLjUtLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-high-low-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyA0aDJ2MTJINFY0aDNNNSA1aDN2MTBINXpNMTEgMTRWNmg1djhoLTVtMS03aDN2NmgtM3oiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-hlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTYzIDEuODM3LTUuMzM0IDExLjYyMUw2Ljk1NyA4LjEybC00LjE5OSA5LjYyMi0uOTE2LS40IDQuNzU2LTEwLjlMMTIuNDkgMTEuOCAxNy4yNTQgMS40MnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTUuODI1IDIuNzA0LjU1IDEzLjc4NWwuOTAyLjQzIDQuNzI0LTkuOTE5IDYuMDM0IDUuMDI5IDMuMjU1LTguMTQtLjkyOC0uMzctMi43NDUgNi44NnptNy44NTIgMTQuNjM2IDUuNzgtMTMuMTM5LS45MTUtLjQwMi01LjIxOSAxMS44Ni02LjAwNS01LjUwNC0zLjI3OCA3LjY0OC45Mi4zOTQgMi43MjItNi4zNTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-zoom-in-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04Ljc1IDQuNWEuNzUuNzUgMCAwIDAtMS41IDB2Mi43NUg0LjVhLjc1Ljc1IDAgMCAwIDAgMS41aDIuNzV2Mi43NWEuNzUuNzUgMCAwIDAgMS41IDBWOC43NWgyLjc1YS43NS43NSAwIDAgMCAwLTEuNUg4Ljc1VjQuNVoiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-zoom-out-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zLjc1IDhhLjc1Ljc1IDAgMCAxIC43NS0uNzVoN2EuNzUuNzUgMCAwIDEgMCAxLjVoLTdBLjc1Ljc1IDAgMCAxIDMuNzUgOFoiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-zoom-in-alt,.ag-charts-icon-zoom-in-alt-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20taW4iPjxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiLz48bGluZSB4MT0iMjEiIHgyPSIxNi42NSIgeTE9IjIxIiB5Mj0iMTYuNjUiLz48bGluZSB4MT0iMTEiIHgyPSIxMSIgeTE9IjgiIHkyPSIxNCIvPjxsaW5lIHgxPSI4IiB4Mj0iMTQiIHkxPSIxMSIgeTI9IjExIi8+PC9zdmc+)}.ag-charts-icon-zoom-out-alt,.ag-charts-icon-zoom-out-alt-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20tb3V0Ij48Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4Ii8+PGxpbmUgeDE9IjIxIiB4Mj0iMTYuNjUiIHkxPSIyMSIgeTI9IjE2LjY1Ii8+PGxpbmUgeDE9IjgiIHgyPSIxNCIgeTE9IjExIiB5Mj0iMTEiLz48L3N2Zz4=)}.ag-charts-icon-reset-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00LjQxMiA0LjA1OCAyLjc1IDIuMzk2VjYuNzVoLjc0NGEuNzYuNzYgMCAwIDAgLjAxMiAwaDMuNTk4TDUuNDc4IDUuMTI1YTQuMTI1IDQuMTI1IDAgMCAxIDIuNTIzLS44NzUgMy43NSAzLjc1IDAgMSAxLTMuMTE5IDUuODMzLjc1Ljc1IDAgMCAwLTEuMjQ3LjgzNEE1LjI1IDUuMjUgMCAxIDAgOCAyLjc1aC0uMDAzYTUuNjI1IDUuNjI1IDAgMCAwLTMuNTg1IDEuMzA4WiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-left-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMC4wMyA0LjQ3YS43NS43NSAwIDAgMSAwIDEuMDZMNy41NiA4bDIuNDcgMi40N2EuNzUuNzUgMCAxIDEtMS4wNiAxLjA2bC0zLTNhLjc1Ljc1IDAgMCAxIDAtMS4wNmwzLTNhLjc1Ljc1IDAgMCAxIDEuMDYgMFoiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-pan-right-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01Ljk3IDExLjUzYS43NS43NSAwIDAgMSAwLTEuMDZMOC40NCA4IDUuOTcgNS41M2EuNzUuNzUgMCAwIDEgMS4wNi0xLjA2bDMgM2EuNzUuNzUgMCAwIDEgMCAxLjA2bC0zIDNhLjc1Ljc1IDAgMCAxLTEuMDYgMFoiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-pan-start-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNoZXZyb24tZmlyc3QiPjxwYXRoIGQ9Im0xNyAxOC02LTYgNi02Ii8+PHBhdGggZD0iTTcgNnYxMiIvPjwvc3ZnPg==)}.ag-charts-icon-pan-end-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNoZXZyb24tbGFzdCI+PHBhdGggZD0ibTcgMTggNi02LTYtNiIvPjxwYXRoIGQ9Ik0xNyA2djEyIi8+PC9zdmc+)}.ag-charts-icon-trend-line-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMi41IiBjeT0iOCIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIvPjxjaXJjbGUgY3g9IjEzLjUiIGN5PSI4IiByPSIxLjc1IiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgZD0iTTQgOGg4Ii8+PC9zdmc+)}.ag-charts-icon-horizontal-line-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMC4zODYgOC43NWEyLjUwMSAyLjUwMSAwIDAgMS00Ljc3MiAwSC43NWEuNzUuNzUgMCAwIDEgMC0xLjVoNC44NjRhMi41MDEgMi41MDEgMCAwIDEgNC43NzIgMGg0Ljg2NGEuNzUuNzUgMCAwIDEgMCAxLjVoLTQuODY0Wk05IDhhMSAxIDAgMSAxLTIgMCAxIDEgMCAwIDEgMiAwWiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-vertical-line-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04Ljc1IDUuNjE0YTIuNTAxIDIuNTAxIDAgMCAxIDAgNC43NzJ2NC44NjRhLjc1Ljc1IDAgMCAxLTEuNSAwdi00Ljg2NGEyLjUwMSAyLjUwMSAwIDAgMSAwLTQuNzcyVi43NWEuNzUuNzUgMCAwIDEgMS41IDB2NC44NjRaTTggN2ExIDEgMCAxIDEgMCAyIDEgMSAwIDAgMSAwLTJaIiBmaWxsPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-parallel-channel-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTciIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNC40MjQgNC45MmEyLjUgMi41IDAgMSAwLTMuMzc3LTIuMTRsLTYuNjMgMi45YTIuNTAxIDIuNTAxIDAgMSAwIC42MDcgMS4zNzJsNi41ODUtMi44OGEyLjUwMSAyLjUwMSAwIDAgMCAyLjgxNS43NDhabS4wNS0yLjY5M2ExIDEgMCAxIDEtMS44Ny43MDggMSAxIDAgMCAxIDEuODctLjcwOFptLTExIDQuNzVhMSAxIDAgMSAxLTEuODcuNzA4IDEgMSAwIDAgMSAxLjg3LS43MDhabTEuNTUgNi4wNzVhMi41MDEgMi41MDEgMCAxIDEtLjYwNy0xLjM3Mmw2LjYzLTIuOWEyLjUwMSAyLjUwMSAwIDEgMSAuNTYyIDEuMzkxbC02LjU4NSAyLjg4Wm0tMS41NS0uMDc1YTEgMSAwIDEgMS0xLjg3LjcwOCAxIDEgMCAwIDEgMS44Ny0uNzA4Wm0xMC40Mi0zLjQ2YTEgMSAwIDEgMC0uNzA5LTEuODcgMSAxIDAgMCAwIC43MDggMS44N1oiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-disjoint-channel-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTciIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNC40MjQgNC45MmEyLjUgMi41IDAgMSAwLTMuMzgzLTIuNDUzTDQuNjkgNC4wNTVhMi41IDIuNSAwIDEgMCAuMzQ0IDEuNDZsNi4zOTItMS41OThhMi41MDEgMi41MDEgMCAwIDAgMyAxLjAwM1ptLjA1LTIuNjkzYTEgMSAwIDEgMS0xLjg3LjcwOCAxIDEgMCAwIDEgMS44Ny0uNzA4Wm0tMTEgMi43NWExIDEgMCAxIDEtMS44Ny43MDggMSAxIDAgMCAxIDEuODctLjcwOFptMS41NiA1LjQyYTIuNSAyLjUgMCAxIDAtLjM0NSAxLjQ2MWw2LjM1MiAxLjU4OGEyLjUgMi41IDAgMSAwIC4zODQtMS40NWwtNi4zOTItMS41OThabS0xLjU2LjUzOGExIDEgMCAxIDAtMS44Ny0uNzA4IDEgMSAwIDAgMCAxLjg3LjcwOFptMTAuNDIgMS40NjFhMSAxIDAgMSAxLS43MDkgMS44NyAxIDEgMCAwIDEgLjcwOC0xLjg3WiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-line-color-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgY2xpcC1wYXRoPSJ1cmwoI2EpIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyLjc4OC41ODNhMi42MyAyLjYzIDAgMCAwLTEuODYuNzdMOS41NDQgMi43MzhhLjc1Ny43NTcgMCAwIDAtLjE0LjE0TDIuMDMyIDEwLjI1di4wMDFjLS4yNDIuMjQxLS40Mi41MzgtLjUyLjg2NGwtLjAwMi4wMDItLjg4IDIuOTAyLS4wMDEuMDAzYTEuMDgzIDEuMDgzIDAgMCAwIDEuMzUgMS4zNDdoLjAwMWwyLjkwMi0uODhoLjAwMWMuMzI2LS4xLjYyMy0uMjc3Ljg2NS0uNTE4di0uMDAxbDcuMzc1LTcuMzc2YS43NjMuNzYzIDAgMCAwIC4xMzktLjEzOWwxLjM4NC0xLjM4NEEyLjYzIDIuNjMgMCAwIDAgMTIuNzg4LjU4M1ptLS4xMjYgNC4zNTIuOTI0LS45MjRhMS4xMyAxLjEzIDAgMCAwLTEuNTk3LTEuNTk3bC0uOTI0LjkyNCAxLjU5NyAxLjU5N1ptLTIuNjU3LS41MzYtNi45MTMgNi45MTRIMy4wOWEuNTgzLjU4MyAwIDAgMC0uMTQ2LjI0MmwtLjY1MyAyLjE1MyAyLjE1NS0uNjU0YS41ODMuNTgzIDAgMCAwIC4yNDEtLjE0NGw2LjkxNC02LjkxNC0xLjU5Ny0xLjU5N1oiIGZpbGw9IiMwMDAiLz48L2c+PGRlZnM+PGNsaXBQYXRoIGlkPSJhIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMCAwaDE2djE2SDB6Ii8+PC9jbGlwUGF0aD48L2RlZnM+PC9zdmc+)}.ag-charts-icon-delete-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjA4MyAyLjY2N2MwLS4wOS4wNTMtLjI0Mi4xOTctLjM4Ny4xNDUtLjE0NC4yOTctLjE5Ny4zODctLjE5N2gyLjY2N2MuMDg5IDAgLjI0MS4wNTMuMzg2LjE5Ny4xNDUuMTQ1LjE5Ny4yOTcuMTk3LjM4N3YuNTgzSDYuMDg0di0uNTgzWk01LjMzIDQuNzVIMTEuOTE3djguNTgzYzAgLjA5LS4wNTIuMjQyLS4xOTcuMzg3LS4xNDUuMTQ0LS4yOTcuMTk3LS4zODYuMTk3SDQuNjY3Yy0uMDkgMC0uMjQyLS4wNTMtLjM4Ny0uMTk3LS4xNDQtLjE0NS0uMTk3LS4yOTctLjE5Ny0uMzg3VjQuNzVINS4zM1ptLS43NDUtMS41di0uNTgzYzAtLjU3OC4yOC0xLjA5Mi42MzYtMS40NDcuMzU1LS4zNTYuODctLjYzNyAxLjQ0Ny0uNjM3aDIuNjY3Yy41NzcgMCAxLjA5MS4yODEgMS40NDcuNjM3LjM1NS4zNTUuNjM2Ljg3LjYzNiAxLjQ0N3YuNTgzSDE0YS43NS43NSAwIDAgMSAwIDEuNWgtLjU4M3Y4LjU4M2MwIC41NzgtLjI4MSAxLjA5Mi0uNjM2IDEuNDQ3LS4zNTYuMzU2LS44Ny42MzctMS40NDcuNjM3SDQuNjY3Yy0uNTc3IDAtMS4wOTItLjI4MS0xLjQ0Ny0uNjM3LS4zNTUtLjM1NS0uNjM3LS44Ny0uNjM3LTEuNDQ3VjQuNzVIMmEuNzUuNzUgMCAwIDEgMC0xLjVoMi41ODNabTIuMDgzIDMuMzMzYS43NS43NSAwIDAgMSAuNzUuNzV2NGEuNzUuNzUgMCAxIDEtMS41IDB2LTRhLjc1Ljc1IDAgMCAxIC43NS0uNzVabTMuNDE3Ljc1YS43NS43NSAwIDAgMC0xLjUgMHY0YS43NS43NSAwIDEgMCAxLjUgMHYtNFoiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-lock-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjE3MyAyLjg0YTIuNTgzIDIuNTgzIDAgMCAxIDQuNDEgMS44Mjd2MS45MTZINS40MTZWNC42NjdjMC0uNjg1LjI3My0xLjM0My43NTctMS44MjdaTTMuOTE3IDYuNTgzVjQuNjY3YTQuMDgzIDQuMDgzIDAgMCAxIDguMTY2IDB2MS45MTZoLjU4NGMxLjE1IDAgMi4wODMuOTMzIDIuMDgzIDIuMDg0djQuNjY2YzAgMS4xNS0uOTMzIDIuMDg0LTIuMDgzIDIuMDg0SDMuMzMzYTIuMDgzIDIuMDgzIDAgMCAxLTIuMDgzLTIuMDg0VjguNjY3YzAtMS4xNTEuOTMzLTIuMDg0IDIuMDgzLTIuMDg0aC41ODNabTcuNDE2IDEuNWgtOGEuNTgzLjU4MyAwIDAgMC0uNTgzLjU4NHY0LjY2NmMwIC4zMjIuMjYxLjU4NC41ODMuNTg0aDkuMzM0YS41ODMuNTgzIDAgMCAwIC41ODMtLjU4NFY4LjY2N2EuNTgzLjU4MyAwIDAgMC0uNTgzLS41ODRoLTEuMzM0WiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-unlock-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTciIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjkyMyAyLjg0YTIuNTgzIDIuNTgzIDAgMCAxIDMuNjUzIDAgMyAzIDAgMCAxIC41Ny43OThjLjEzNC4yNzguMTcuNDc0LjE3LjU0NWEuNzUuNzUgMCAwIDAgMS41IDBjMC0uMzgxLS4xMzItLjgwOS0uMzItMS4xOThhNC41MDEgNC41MDEgMCAwIDAtLjg1OS0xLjIwNiA0LjA4MyA0LjA4MyAwIDAgMC02Ljk3IDIuODg4djEuOTE2aC0uNTg0QzIuOTMzIDYuNTgzIDIgNy41MTYgMiA4LjY2N3Y0LjY2NmMwIDEuMTUuOTMzIDIuMDg0IDIuMDgzIDIuMDg0aDkuMzM0YzEuMTUgMCAyLjA4My0uOTMzIDIuMDgzLTIuMDg0VjguNjY3YzAtMS4xNTEtLjkzMy0yLjA4NC0yLjA4My0yLjA4NGgtNy4yNVY0LjY2N2MwLS42ODUuMjcyLTEuMzQzLjc1Ni0xLjgyN1pNNS40MTcgOC4wODNINC4wODJhLjU4My41ODMgMCAwIDAtLjU4My41ODR2NC42NjZjMCAuMzIyLjI2MS41ODQuNTgzLjU4NGg5LjMzNGEuNTgzLjU4MyAwIDAgMCAuNTgzLS41ODRWOC42NjdhLjU4My41ODMgMCAwIDAtLjU4My0uNTg0aC04WiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-plus-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXBsdXMiPjxwYXRoIGQ9Ik01IDEyaDE0Ii8+PHBhdGggZD0iTTEyIDV2MTQiLz48L3N2Zz4=)}.ag-charts-icon-crossline-add-line-legacy{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOC43NSA0LjVhLjc1Ljc1IDAgMCAwLTEuNSAwdjIuNzVINC41YS43NS43NSAwIDAgMCAwIDEuNWgyLjc1djIuNzVhLjc1Ljc1IDAgMCAwIDEuNSAwVjguNzVoMi43NWEuNzUuNzUgMCAwIDAgMC0xLjVIOC43NXoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-input{--input-layer-active: 1;--input-layer-focus: 2;color:inherit;font-family:var(--ag-charts-input-font-family);font-size:var(--ag-charts-input-font-size);transition-duration:var(--ag-charts-input-transition-duration);transition-property:none;transition-timing-function:var(--ag-charts-input-transition-timing-function)}.ag-charts-input:focus-visible{outline:var(--ag-charts-input-focus-outline);box-shadow:var(--ag-charts-input-focus-box-shadow);z-index:var(--input-layer-focus)}.ag-charts-button{background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-input-border-color);border-radius:var(--ag-charts-input-border-radius);cursor:pointer;padding:var(--ag-charts-input-padding);transition-property:background,border-color}.ag-charts-button:hover{background:var(--ag-charts-input-background-color--hover)}.ag-charts-button:has(.ag-charts-icon){padding:2px}.ag-charts-checkbox{appearance:none;background:var(--ag-charts-input-checkbox-background-color);border-radius:9px;cursor:pointer;height:18px;margin:0;transition-duration:var(--ag-charts-input-transition-duration--fast);transition-property:margin;width:29px}.ag-charts-checkbox:before{display:block;background:var(--ag-charts-input-background-color);border-radius:7px;content:" ";height:14px;margin:2px;transition-duration:var(--ag-charts-input-transition-duration--fast);transition-property:margin;transition-timing-function:var(--ag-charts-input-transition-easing);width:14px}.ag-charts-checkbox:checked{background:var(--ag-charts-input-checkbox-background-color--checked)}.ag-charts-checkbox:checked:before{margin-left:13px}.ag-charts-select{background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-input-border-color);border-radius:var(--ag-charts-input-border-radius);padding:3px 2px 4px;font-size:inherit}.ag-charts-textarea{--line-height: 1.38;background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-input-border-color);border-radius:var(--ag-charts-input-border-radius);line-height:var(--line-height);font-family:var(--ag-charts-input-font-family);font-size:var(--ag-charts-input-font-size);padding:var(--ag-charts-input-padding-large) var(--ag-charts-input-padding)}.ag-charts-textarea[placeholder]:empty:before{color:var(--ag-charts-input-placeholder);content:attr(placeholder)}.ag-charts-focus.ag-charts-focus__indicator{position:absolute;display:block;pointer-events:none;user-select:none;width:100%;height:100%}.ag-charts-focus.ag-charts-focus__indicator>div{position:absolute;outline:var(--ag-charts-focus-border);outline-width:2px;box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-focus.ag-charts-focus__indicator>svg{width:100%;height:100%;fill:none;stroke:var(--ag-charts-focus-border-color);stroke-width:2px}.ag-charts-focus--hidden{visibility:hidden}.ag-charts-toolbar{align-items:center;background:none;border:none;display:flex;flex-wrap:nowrap;opacity:1;position:absolute;transform:translateY(0);transition:opacity .2s ease-in-out,transform .2s ease-in-out}.ag-charts-toolbar--hidden,.ag-charts-toolbar--prevent-flash{visibility:hidden}.ag-charts-toolbar--floating-hidden{opacity:0;transition:opacity .4s ease-in-out}.ag-charts-toolbar--small{--ag-charts-toolbar-size: var(--ag-charts-toolbar-size-small);--ag-charts-toolbar-font-size: var(--ag-charts-toolbar-font-size-small);--ag-charts-toolbar-button-padding: var(--ag-charts-toolbar-button-padding-small)}.ag-charts-toolbar--top,.ag-charts-toolbar--bottom{flex-direction:row;width:100%}.ag-charts-toolbar--left,.ag-charts-toolbar--right{flex-direction:column}.ag-charts-toolbar--floating,.ag-charts-toolbar--floating-top,.ag-charts-toolbar--floating-bottom{background:none;border:none;flex-direction:row;pointer-events:none;width:100%}.ag-charts-toolbar--floating{padding:0;width:auto;z-index:var(--ag-charts-layer-toolbar)}.ag-charts-toolbar--floating-top{height:calc(var(--ag-charts-toolbar-size) + 10px);padding-top:10px}.ag-charts-toolbar--floating-bottom{height:calc(var(--ag-charts-toolbar-size) + 10px);padding-bottom:10px;overflow:hidden}.ag-charts-toolbar__align{display:flex;flex-direction:inherit;flex-wrap:inherit;gap:var(--ag-charts-toolbar-gap);max-width:100%;width:100%}.ag-charts-toolbar__align--start{justify-content:start}.ag-charts-toolbar__align--center{justify-content:center}.ag-charts-toolbar__align--end{justify-content:end}.ag-charts-toolbar__align--center,.ag-charts-toolbar__align--end{margin-left:auto}.ag-charts-toolbar--left .ag-charts-toolbar__align--center,.ag-charts-toolbar--left .ag-charts-toolbar__align--end,.ag-charts-toolbar--right .ag-charts-toolbar__align--center,.ag-charts-toolbar--right .ag-charts-toolbar__align--end{margin-left:0;margin-top:auto}.ag-charts-toolbar--floating-top .ag-charts-toolbar__align,.ag-charts-toolbar--floating-bottom .ag-charts-toolbar__align{transition:transform .4s ease-in-out;width:auto}.ag-charts-toolbar__section{display:inherit;flex-direction:inherit;flex-wrap:inherit;justify-content:inherit;max-width:inherit;width:inherit}.ag-charts-toolbar__button{align-items:center;background:var(--ag-charts-toolbar-background-color);border:var(--ag-charts-toolbar-border);color:var(--ag-charts-toolbar-foreground-color);display:flex;font:var(--ag-charts-toolbar-font-size) var(--ag-charts-font-family);justify-content:center;margin:0 0 0 -1px;min-height:var(--ag-charts-toolbar-size);min-width:var(--ag-charts-toolbar-size);padding:var(--ag-charts-toolbar-button-padding);pointer-events:all;position:relative;white-space:nowrap;--stroke-width-color: var(--ag-charts-toolbar-foreground-color)}.ag-charts-toolbar__button--drag-handle{min-width:24px;padding-left:0;padding-right:0}.ag-charts-toolbar__button--with-transition{transition:background-color .25s ease-in-out,border-color .25s ease-in-out,color .25s ease-in-out}.ag-charts-toolbar__button[data-toolbar-group=ranges]{padding:var(--ag-charts-toolbar-button-padding) calc(var(--ag-charts-toolbar-button-padding) * 1.5)}.ag-charts-toolbar--top,.ag-charts-toolbar--bottom,.ag-charts-toolbar--floating,.ag-charts-toolbar--floating-top,.ag-charts-toolbar--floating-bottom{.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-button-radius);border-top-left-radius:var(--ag-charts-button-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-button-radius);border-top-right-radius:var(--ag-charts-button-radius)}}.ag-charts-toolbar--left,.ag-charts-toolbar--right{.ag-charts-toolbar__button{border-radius:0;margin:-1px 0 0;max-width:100%}.ag-charts-toolbar__button--first{border-top-left-radius:var(--ag-charts-button-radius);border-top-right-radius:var(--ag-charts-button-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-left-radius:var(--ag-charts-button-radius);border-bottom-right-radius:var(--ag-charts-button-radius)}}.ag-charts-toolbar__button--hidden-value,.ag-charts-toolbar__button--hidden-toggled{display:none}.ag-charts-toolbar__button:hover:not([aria-disabled=true],.ag-charts-toolbar__button--drag-handle){background:var(--ag-charts-toolbar-hover-color);z-index:1}.ag-charts-toolbar__button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-toolbar__button.ag-charts-toolbar__button--active{background:var(--ag-charts-toolbar-active-background-color);border-color:var(--ag-charts-toolbar-active-color);color:var(--ag-charts-toolbar-active-color);z-index:2;--stroke-width-color: var(--ag-charts-toolbar-active-color)}.ag-charts-toolbar__button[aria-disabled=true]{background:var(--ag-charts-toolbar-disabled-background-color);color:var(--ag-charts-toolbar-disabled-foreground-color)}.ag-charts-toolbar__button:not([aria-disabled=true]){cursor:pointer}.ag-charts-toolbar__button.ag-charts-toolbar__button--drag-handle{cursor:grab}.ag-charts-toolbar__button.ag-charts-toolbar__button--dragging{cursor:grabbing}.ag-charts-toolbar__button--fill-visible:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--fill)}.ag-charts-toolbar__button--fill-visible[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-toolbar__button--stroke-width-visible:before{content:"";height:min(var(--strokeWidth),20px);width:12px;background:var(--stroke-width-color);margin-right:var(--ag-charts-toolbar-button-padding)}.ag-charts-toolbar__button--stroke-width-visible[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{margin-left:var(--ag-charts-toolbar-gap)}.ag-charts-toolbar__icon,.ag-charts-toolbar__label{pointer-events:none}.ag-chart-overlay{color:#181d1f;pointer-events:none}.ag-chart-overlay.ag-chart-dark-overlay{color:#fff}.ag-chart-overlay--loading{color:#8c8c8c}.ag-chart-overlay__loading-background{background:#fff;pointer-events:none}.ag-chart-overlay.ag-chart-dark-overlay .ag-chart-overlay__loading-background{background:#192232}.ag-chart-tooltip{transition:transform .1s ease;width:max-content;z-index:99999;font:12px Verdana,sans-serif;color:#464646;box-shadow:0 4px 8px #00000014}.ag-chart-tooltip-wrap-always{overflow-wrap:break-word;word-break:break-word;hyphens:none}.ag-chart-tooltip-wrap-hyphenate{overflow-wrap:break-word;word-break:break-word;hyphens:auto}.ag-chart-tooltip-wrap-on-space{overflow-wrap:normal;word-break:normal}.ag-chart-tooltip-wrap-never{white-space:pre;text-overflow:ellipsis}.ag-chart-tooltip-no-interaction{pointer-events:none;user-select:none}.ag-chart-tooltip-no-animation{transition:none!important}.ag-chart-tooltip-hidden{visibility:hidden}.ag-chart-tooltip-title{overflow:hidden;position:relative;padding:8px 14px;border-top-left-radius:2px;border-top-right-radius:2px;color:#fff;background-color:#888;z-index:1;text-overflow:inherit}.ag-chart-tooltip-title:only-child{border-bottom-left-radius:2px;border-bottom-right-radius:2px}.ag-chart-tooltip-content{overflow:hidden;padding:6px 14px;line-height:1.7em;background:#fff;border-bottom-left-radius:2px;border-bottom-right-radius:2px;border:1px solid rgba(0,0,0,.15);text-overflow:inherit}.ag-chart-tooltip-arrow:before{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:5px solid #d9d9d9;border-left-color:transparent;border-right-color:transparent;border-bottom-color:transparent;width:0;height:0;margin:0 auto}.ag-chart-tooltip-arrow:after{content:"";position:absolute;top:calc(100% - 1px);left:50%;transform:translate(-50%);border:5px solid white;border-left-color:transparent;border-right-color:transparent;border-bottom-color:transparent;width:0;height:0;margin:0 auto}
`,_a76,SizeMonitor=(_a76=class{constructor(){var _a274;this.elements=new Map,this.documentReady=!1,this.queuedObserveRequests=[],this.onLoad=()=>{this.documentReady=!0,this.queuedObserveRequests.forEach(([el,cb])=>this.observe(el,cb)),this.queuedObserveRequests=[]},!(typeof ResizeObserver>"u")&&(this.resizeObserver=new ResizeObserver(entries=>{for(const{target,contentRect:{width,height}}of entries){const entry=this.elements.get(target);this.checkSize(entry,target,width,height)}}),this.documentReady=getDocument("readyState")==="complete",this.documentReady||(_a274=getWindow())==null||_a274.addEventListener("load",this.onLoad))}destroy(){var _a274,_b;(_a274=getWindow())==null||_a274.removeEventListener("load",this.onLoad),(_b=this.resizeObserver)==null||_b.disconnect(),this.resizeObserver=null}checkSize(entry,element2,width,height){var _a274,_b;entry&&(width!==((_a274=entry.size)==null?void 0:_a274.width)||height!==((_b=entry.size)==null?void 0:_b.height))&&(entry.size={width,height},entry.cb(entry.size,element2))}observe(element2,cb){var _a274;if(!this.documentReady){this.queuedObserveRequests.push([element2,cb]);return}this.elements.has(element2)?this.removeFromQueue(element2):(_a274=this.resizeObserver)==null||_a274.observe(element2);const entry={cb};this.elements.set(element2,entry)}unobserve(element2){var _a274;(_a274=this.resizeObserver)==null||_a274.unobserve(element2),this.elements.delete(element2),this.removeFromQueue(element2),this.elements.size||this.destroy()}removeFromQueue(element2){this.queuedObserveRequests=this.queuedObserveRequests.filter(([el])=>el!==element2)}},__name(_a76,"SizeMonitor"),_a76),domLayout_default='<div role="presentation" class="ag-charts-wrapper ag-charts-styles" data-ag-charts><div role="presentation" class="ag-charts-canvas-center"><div role="figure" class="ag-charts-canvas-container"><div role="presentation" class="ag-charts-canvas"></div><div role="presentation" class="ag-charts-canvas-proxy"></div><div role="presentation" class="ag-charts-canvas-overlay"></div></div></div></div>',CANVAS_CENTER_CLASS="canvas-center",DOM_ELEMENT_CLASSES=["styles",CANVAS_CENTER_CLASS,"canvas","canvas-proxy","canvas-overlay"],domElementConfig=new Map([["styles",{childElementType:"style"}],["canvas",{childElementType:"canvas",eventTypes:["focus","blur"]}],["canvas-proxy",{childElementType:"div"}],["canvas-overlay",{childElementType:"div"}],[CANVAS_CENTER_CLASS,{childElementType:"div"}]]);function setupObserver(element2,cb){if(typeof IntersectionObserver>"u")return;const observer=new IntersectionObserver(entries=>{for(const entry of entries)entry.target===element2&&cb(entry.intersectionRatio)},{root:element2});return observer.observe(element2),observer}__name(setupObserver,"setupObserver");var NULL_DOMRECT={x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0,toJSON(){return NULL_DOMRECT}},_a77,DOMManager=(_a77=class extends BaseManager{constructor(container){super(),this.styles=new Map,this.container=void 0,this.containerSize=void 0,this.sizeMonitor=new SizeMonitor;const templateEl=createElement("div");templateEl.innerHTML=domLayout_default,this.element=templateEl.children.item(0),this.rootElements=DOM_ELEMENT_CLASSES.reduce((r,c)=>{const cssClass=`ag-charts-${c}`,el=this.element.classList.contains(cssClass)?this.element:this.element.querySelector(`.${cssClass}`);if(!el)throw new Error(`AG Charts - unable to find DOM element ${cssClass}`);return r[c]={element:el,children:new Map,listeners:[]},r},{});let hidden=!1;this.observer=setupObserver(this.element,intersectionRatio=>{intersectionRatio===0&&!hidden&&this.listeners.dispatch("hidden",{type:"hidden"}),hidden=intersectionRatio===0}),this.setSizeOptions(),this.addStyles("ag-charts-community",styles_default),container&&this.setContainer(container)}destroy(){var _a274;super.destroy(),(_a274=this.observer)==null||_a274.unobserve(this.element),this.container&&this.sizeMonitor.unobserve(this.container),Object.values(this.rootElements).forEach(el=>{el.children.forEach(c=>c.remove()),el.element.remove()}),this.element.remove()}setSizeOptions(minWidth=300,minHeight=300,optionsWidth,optionsHeight){const{style}=this.element;style.width=`${optionsWidth??minWidth}px`,style.height=`${optionsHeight??minHeight}px`}updateContainerSize(){var _a274,_b;const{style:centerStyle}=this.rootElements[CANVAS_CENTER_CLASS].element;centerStyle.width=`${((_a274=this.containerSize)==null?void 0:_a274.width)??0}px`,centerStyle.height=`${((_b=this.containerSize)==null?void 0:_b.height)??0}px`}setContainer(newContainer){if(newContainer===this.container)return;if(this.container&&(this.container.removeChild(this.element),this.sizeMonitor.unobserve(this.container)),!(this.getShadowDocumentRoot(newContainer)!=null))for(const id of this.rootElements.styles.children.keys())this.removeChild("styles",id);this.container=newContainer;for(const[id,styles]of this.styles)this.addStyles(id,styles);newContainer.appendChild(this.element),this.sizeMonitor.observe(newContainer,size=>{this.containerSize=size,this.updateContainerSize(),this.listeners.dispatch("resize",{type:"resize"})}),this.listeners.dispatch("container-changed",{type:"container-changed"})}setThemeClass(themeClassName){const themeClassNamePrefix="ag-charts-theme-";this.element.classList.forEach(className=>{className.startsWith(themeClassNamePrefix)&&className!==themeClassName&&this.element.classList.remove(className)}),this.element.classList.add(themeClassName)}setTabIndex(tabIndex){const canvasElement=this.rootElements.canvas.element.querySelector("canvas");canvasElement&&(canvasElement.tabIndex=tabIndex)}addEventListenerOnElement(elementType,type,listener,options){const{element:element2}=this.rootElements[elementType];return element2.addEventListener(type,listener,options),()=>{element2.removeEventListener(type,listener,options)}}addEventListener(type,listener,options){this.element.addEventListener(type,listener,options),domElementConfig.forEach((config,elType)=>{var _a274;if(!((_a274=config.eventTypes)!=null&&_a274.includes(type)))return;const els=this.rootElements[elType];els.listeners.push([type,listener,options]),els.children.forEach(el=>{el.addEventListener(type,listener)})})}removeEventListener(type,listener,options){this.element.removeEventListener(type,listener,options),domElementConfig.forEach((config,elType)=>{var _a274;if(!((_a274=config.eventTypes)!=null&&_a274.includes(type)))return;const els=this.rootElements[elType];els.listeners=els.listeners.filter(([t,l])=>t!==type&&l!==listener),els.children.forEach(el=>{el.removeEventListener(type,listener,options)})})}getBoundingClientRect(){return this.rootElements.canvas.element.getBoundingClientRect()}getOverlayClientRect(){var _a274;const window2=getWindow(),windowBBox=new BBox(0,0,window2.innerWidth,window2.innerHeight),container=this.getRawOverlayClientRect(),containerBBox=BBox.fromDOMRect(container??this.getBoundingClientRect());return((_a274=windowBBox.intersection(containerBBox))==null?void 0:_a274.toDOMRect())??NULL_DOMRECT}getRawOverlayClientRect(){var _a274,_b,_c;let element2=this.element;for(;element2!=null;){const styleMap=(_a274=element2.computedStyleMap)==null?void 0:_a274.call(element2),overflowX=(_b=styleMap==null?void 0:styleMap.get("overflow-x"))==null?void 0:_b.toString(),overflowY=(_c=styleMap==null?void 0:styleMap.get("overflow-y"))==null?void 0:_c.toString();if(overflowX!=null&&overflowX!=="visible"||overflowY&&overflowY!=="visible")return element2.getBoundingClientRect();element2=element2.parentElement}const docRoot=this.getShadowDocumentRoot();if(docRoot)return docRoot.getBoundingClientRect()}getShadowDocumentRoot(current=this.container){var _a274;const docRoot=((_a274=current==null?void 0:current.ownerDocument)==null?void 0:_a274.body)??getDocument("body");for(;current!=null;){if(current===docRoot)return;if(current.parentNode instanceof DocumentFragment)return current;current=current.parentNode}}getChildBoundingClientRect(type){const{children}=this.rootElements[type],childRects=[];for(const child of children.values())childRects.push(BBox.fromDOMRect(child.getBoundingClientRect()));return BBox.merge(childRects)}calculateCanvasPosition(el){let x=0,y=0;const{x:cx=0,y:cy=0}=this.getChildBoundingClientRect("canvas")??{},elRect=el.getBoundingClientRect();return x=elRect.x-cx,y=elRect.y-cy,{x,y}}isManagedChildDOMElement(el,domElementClass,id){const{children}=this.rootElements[domElementClass],search=children==null?void 0:children.get(id);return search!=null&&el.contains(search)}isEventOverElement(event){const element2=event.target;return element2!=null&&this.element.contains(element2)}addStyles(id,styles){if(this.styles.set(id,styles),this.container==null)return;const dataAttribute="data-ag-charts",documentRoot=this.getShadowDocumentRoot();let styleElement;if(documentRoot!=null)styleElement=this.addChild("styles",id);else{const head=getDocument("head");for(const child of head.children)if(child.getAttribute(dataAttribute)===id)return;styleElement=createElement("style"),head.appendChild(styleElement)}styleElement.getAttribute(dataAttribute)!==id&&(styleElement.setAttribute(dataAttribute,id),styleElement.innerHTML=styles)}removeStyles(id){this.removeChild("styles",id)}updateCursor(style){this.element.style.cursor=style}getCursor(){return this.element.style.cursor}addChild(domElementClass,id,child){const{element:element2,children,listeners}=this.rootElements[domElementClass];if(!children)throw new Error("AG Charts - unable to create DOM elements after destroy()");if(children.has(id))return children.get(id);const{childElementType="div"}=domElementConfig.get(domElementClass)??{};if(child&&child.tagName.toLowerCase()!==childElementType.toLowerCase())throw new Error("AG Charts - mismatching DOM element type");const newChild=child??createElement(childElementType);for(const[type,fn,opts]of listeners)newChild.addEventListener(type,fn,opts);return children.set(id,newChild),element2==null||element2.appendChild(newChild),newChild}removeChild(domElementClass,id){var _a274;const{children}=this.rootElements[domElementClass];children&&((_a274=children.get(id))==null||_a274.remove(),children.delete(id))}incrementDataCounter(name){const{dataset}=this.element;dataset[name]??(dataset[name]="0"),dataset[name]=String(Number(dataset[name])+1)}getIconClassNames(icon){return`ag-charts-icon ag-charts-icon-${icon}`}},__name(_a77,"DOMManager"),_a77);function linearRoot(a,b){const t=-b/a;return a!==0&&t>=0&&t<=1?[t]:[]}__name(linearRoot,"linearRoot");function quadraticRoots(a,b,c){if(a===0)return linearRoot(b,c);const D=b*b-4*a*c,roots=[];if(D===0){const t=-b/(2*a);t>=0&&t<=1&&roots.push(t)}else if(D>0){const rD=Math.sqrt(D),t1=(-b-rD)/(2*a),t2=(-b+rD)/(2*a);t1>=0&&t1<=1&&roots.push(t1),t2>=0&&t2<=1&&roots.push(t2)}return roots}__name(quadraticRoots,"quadraticRoots");function cubicRoots(a,b,c,d){if(a===0)return quadraticRoots(b,c,d);const A=b/a,B=c/a,C=d/a,Q=(3*B-A*A)/9,R=(9*A*B-27*C-2*A*A*A)/54,D=Q*Q*Q+R*R,third=1/3,roots=[];if(D>=0){const rD=Math.sqrt(D),S=Math.sign(R+rD)*Math.pow(Math.abs(R+rD),third),T=Math.sign(R-rD)*Math.pow(Math.abs(R-rD),third),Im=Math.abs(Math.sqrt(3)*(S-T)/2),t=-third*A+(S+T);if(t>=0&&t<=1&&roots.push(t),Im===0){const t2=-third*A-(S+T)/2;t2>=0&&t2<=1&&roots.push(t2)}}else{const theta=Math.acos(R/Math.sqrt(-Q*Q*Q)),thirdA=third*A,twoSqrtQ=2*Math.sqrt(-Q),t1=twoSqrtQ*Math.cos(third*theta)-thirdA,t2=twoSqrtQ*Math.cos(third*(theta+2*Math.PI))-thirdA,t3=twoSqrtQ*Math.cos(third*(theta+4*Math.PI))-thirdA;t1>=0&&t1<=1&&roots.push(t1),t2>=0&&t2<=1&&roots.push(t2),t3>=0&&t3<=1&&roots.push(t3)}return roots}__name(cubicRoots,"cubicRoots");function segmentIntersection(ax1,ay1,ax2,ay2,bx1,by1,bx2,by2){const d=(ax2-ax1)*(by2-by1)-(ay2-ay1)*(bx2-bx1);if(d===0)return 0;const ua=((bx2-bx1)*(ay1-by1)-(ax1-bx1)*(by2-by1))/d,ub=((ax2-ax1)*(ay1-by1)-(ay2-ay1)*(ax1-bx1))/d;return ua>=0&&ua<=1&&ub>=0&&ub<=1?1:0}__name(segmentIntersection,"segmentIntersection");function cubicSegmentIntersections(px1,py1,px2,py2,px3,py3,px4,py4,x1,y1,x2,y2){let intersections=0;const A=y1-y2,B=x2-x1,C=x1*(y2-y1)-y1*(x2-x1),bx=bezierCoefficients(px1,px2,px3,px4),by=bezierCoefficients(py1,py2,py3,py4),a=A*bx[0]+B*by[0],b=A*bx[1]+B*by[1],c=A*bx[2]+B*by[2],d=A*bx[3]+B*by[3]+C,roots=cubicRoots(a,b,c,d);for(const t of roots){const tt=t*t,ttt=t*tt,x=bx[0]*ttt+bx[1]*tt+bx[2]*t+bx[3],y=by[0]*ttt+by[1]*tt+by[2]*t+by[3];let s;x1===x2?s=(y-y1)/(y2-y1):s=(x-x1)/(x2-x1),s>=0&&s<=1&&intersections++}return intersections}__name(cubicSegmentIntersections,"cubicSegmentIntersections");function bezierCoefficients(P1,P2,P3,P4){return[-P1+3*P2-3*P3+P4,3*P1-6*P2+3*P3,-3*P1+3*P2,P1]}__name(bezierCoefficients,"bezierCoefficients");function arcIntersections(cx,cy,r,startAngle,endAngle,counterClockwise,x1,y1,x2,y2){if(isNaN(cx)||isNaN(cy))return 0;counterClockwise&&([endAngle,startAngle]=[startAngle,endAngle]);const k=(y2-y1)/(x2-x1),y0=y1-k*x1,a=Math.pow(k,2)+1,b=2*(k*(y0-cy)-cx),c=Math.pow(cx,2)+Math.pow(y0-cy,2)-Math.pow(r,2),d=Math.pow(b,2)-4*a*c;if(d<0)return 0;const i1x=(-b+Math.sqrt(d))/2/a,i2x=(-b-Math.sqrt(d))/2/a;let intersections=0;return[i1x,i2x].forEach(x=>{if(!(x>=Math.min(x1,x2)&&x<=Math.max(x1,x2)))return;const y=k*x+y0,adjacent=x-cx,opposite=y-cy,angle2=Math.atan2(opposite,adjacent);isBetweenAngles(angle2,startAngle,endAngle)&&intersections++}),intersections}__name(arcIntersections,"arcIntersections");function evaluateBezier(p0,p1,p2,p3,t){return(1-t)**3*p0+3*(1-t)**2*t*p1+3*(1-t)*t**2*p2+t**3*p3}__name(evaluateBezier,"evaluateBezier");function solveBezier(p0,p1,p2,p3,value){if(value<=Math.min(p0,p3))return p0<p3?0:1;if(value>=Math.max(p0,p3))return p0<p3?1:0;let t0=0,t1=1,t=NaN;for(let i=0;i<12;i+=1)t=(t0+t1)/2,evaluateBezier(p0,p1,p2,p3,t)<value?t0=t:t1=t;return t}__name(solveBezier,"solveBezier");function splitBezier(p0x,p0y,p1x,p1y,p2x,p2y,p3x,p3y,t){const x01=(1-t)*p0x+t*p1x,y01=(1-t)*p0y+t*p1y,x12=(1-t)*p1x+t*p2x,y12=(1-t)*p1y+t*p2y,x23=(1-t)*p2x+t*p3x,y23=(1-t)*p2y+t*p3y,x012=(1-t)*x01+t*x12,y012=(1-t)*y01+t*y12,x123=(1-t)*x12+t*x23,y123=(1-t)*y12+t*y23,x0123=(1-t)*x012+t*x123,y0123=(1-t)*y012+t*y123;return[[{x:p0x,y:p0y},{x:x01,y:y01},{x:x012,y:y012},{x:x0123,y:y0123}],[{x:x0123,y:y0123},{x:x123,y:y123},{x:x23,y:y23},{x:p3x,y:p3y}]]}__name(splitBezier,"splitBezier");function calculateDerivativeExtrema(p0,p1,p2,p3){const a=-p0+3*p1-3*p2+p3,b=3*p0-6*p1+3*p2,c=-3*p0+3*p1;if(a===0){if(b!==0){const t=-c/b;if(t>0&&t<1)return[t]}return[]}const discriminant=b*b-4*a*c;if(discriminant>=0){const sqrtDiscriminant=Math.sqrt(discriminant),t1=(-b+sqrtDiscriminant)/(2*a),t2=(-b-sqrtDiscriminant)/(2*a);return[t1,t2].filter(t=>t>0&&t<1)}return[]}__name(calculateDerivativeExtrema,"calculateDerivativeExtrema");function calculateDerivativeExtremaXY(sx,sy,cp1x,cp1y,cp2x,cp2y,x,y){const tx=calculateDerivativeExtrema(sx,cp1x,cp2x,x),ty=calculateDerivativeExtrema(sy,cp1y,cp2y,y);return[...tx,...ty]}__name(calculateDerivativeExtremaXY,"calculateDerivativeExtremaXY");var _a78,ExtendedPath2D=(_a78=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.openedPath=!1,this.closedPath=!1}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length||this.previousCommands.toString()!==this.commands.toString()||this.previousParams.toString()!==this.params.toString()}getPath2D(){return this.path2d}moveTo(x,y){this.openedPath=!0,this.path2d.moveTo(x,y),this.commands.push(0),this.params.push(x,y)}lineTo(x,y){this.openedPath?(this.path2d.lineTo(x,y),this.commands.push(1),this.params.push(x,y)):this.moveTo(x,y)}rect(x,y,width,height){this.moveTo(x,y),this.lineTo(x+width,y),this.lineTo(x+width,y+height),this.lineTo(x,y+height),this.closePath()}roundRect(x,y,width,height,radii){radii=Math.min(radii,width/2,height/2),this.moveTo(x,y+radii),this.arc(x+radii,y+radii,radii,Math.PI,1.5*Math.PI),this.lineTo(x+radii,y),this.lineTo(x+width-radii,y),this.arc(x+width-radii,y+radii,radii,1.5*Math.PI,2*Math.PI),this.lineTo(x+width,y+radii),this.lineTo(x+width,y+height-radii),this.arc(x+width-radii,y+height-radii,radii,0,Math.PI/2),this.lineTo(x+width-radii,y+height),this.lineTo(x+radii,y+height),this.arc(x+ +radii,y+height-radii,radii,Math.PI/2,Math.PI),this.lineTo(x,y+height-radii),this.closePath()}arc(x,y,r,sAngle,eAngle,counterClockwise){this.openedPath=!0,this.path2d.arc(x,y,r,sAngle,eAngle,counterClockwise),this.commands.push(2),this.params.push(x,y,r,sAngle,eAngle,counterClockwise?1:0)}cubicCurveTo(cx1,cy1,cx2,cy2,x,y){this.openedPath||this.moveTo(cx1,cy1),this.path2d.bezierCurveTo(cx1,cy1,cx2,cy2,x,y),this.commands.push(3),this.params.push(cx1,cy1,cx2,cy2,x,y)}closePath(){this.openedPath&&(this.path2d.closePath(),this.commands.push(4),this.openedPath=!1,this.closedPath=!0)}clear(trackChanges){trackChanges&&(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this.closedPath),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1,this.commands=[],this.params=[]}isPointInPath(x,y){const commands=this.commands,params=this.params,cn=commands.length,ox=-1e4,oy=-1e4;let sx=NaN,sy=NaN,px=0,py=0,intersectionCount=0;for(let ci=0,pi=0;ci<cn;ci++)switch(commands[ci]){case 0:intersectionCount+=segmentIntersection(sx,sy,px,py,ox,oy,x,y),px=params[pi++],sx=px,py=params[pi++],sy=py;break;case 1:intersectionCount+=segmentIntersection(px,py,params[pi++],params[pi++],ox,oy,x,y),px=params[pi-2],py=params[pi-1];break;case 3:intersectionCount+=cubicSegmentIntersections(px,py,params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],ox,oy,x,y),px=params[pi-2],py=params[pi-1];break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++],startAngle=params[pi++],endAngle=params[pi++],counterClockwise=!!params[pi++];if(intersectionCount+=arcIntersections(cx,cy,r,startAngle,endAngle,counterClockwise,ox,oy,x,y),!isNaN(sx)){const startX=cx+Math.cos(startAngle)*r,startY=cy+Math.sin(startAngle)*r;intersectionCount+=segmentIntersection(px,py,startX,startY,ox,oy,x,y)}px=cx+Math.cos(endAngle)*r,py=cy+Math.sin(endAngle)*r;break}case 4:intersectionCount+=segmentIntersection(sx,sy,px,py,ox,oy,x,y);break}return intersectionCount%2===1}distanceSquared(x,y){let best=1/0;const commands=this.commands,params=this.params,cn=commands.length;let sx=NaN,sy=NaN,px=0,py=0;for(let ci=0,pi=0;ci<cn;ci++)switch(commands[ci]){case 0:px=sx=params[pi++],py=sy=params[pi++];break;case 1:{const nx=params[pi++],ny=params[pi++];best=lineDistanceSquared(x,y,px,py,nx,ny,best);break}case 3:Logger.error("Command.Curve distanceSquare not implemented");break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++],startAngle=params[pi++],endAngle=params[pi++],startX=cx+Math.cos(startAngle)*r,startY=cy+Math.sin(startAngle)*r,counterClockwise=!!params[pi++];best=lineDistanceSquared(x,y,px,py,startX,startY,best),best=arcDistanceSquared(x,y,cx,cy,r,startAngle,endAngle,counterClockwise,best),px=cx+Math.cos(endAngle)*r,py=cy+Math.sin(endAngle)*r;break}case 4:best=lineDistanceSquared(x,y,px,py,sx,sy,best);break}return best}getPoints(){const{commands,params}=this,coords=[];let pi=0;for(let ci=0;ci<commands.length;ci++)switch(commands[ci]){case 0:case 1:coords.push({x:params[pi++],y:params[pi++]});break;case 3:pi+=4,coords.push({x:params[pi++],y:params[pi++]});break;case 2:coords.push({x:params[pi++],y:params[pi++]}),pi+=4;break}return coords}computeSVGDataPath(transform){const buffer=[],{commands,params}=this,addCommand=__name((command,...points)=>{buffer.push(command);for(let i=0;i<points.length;i+=2){const{x,y}=transform(points[i],points[i+1]);buffer.push(x,y)}},"addCommand");let pi=0;for(let ci=0;ci<commands.length;ci++)switch(commands[ci]){case 0:addCommand("M",params[pi++],params[pi++]);break;case 1:addCommand("L",params[pi++],params[pi++]);break;case 3:addCommand("C",params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],params[pi++]);break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++],A0=params[pi++],A1=params[pi++],sweepSign=params[pi++]?-1:1,sweep=normalizeAngle360((A1-A0)*sweepSign)*sweepSign,arcSections=Math.max(Math.abs(sweep)/(Math.PI/2)|0,1),step=sweep/arcSections,h=4/3*Math.tan(step/4),move=buffer.length===0?"M":"L";addCommand(move,cx+Math.cos(A0)*r,cy+Math.sin(A0)*r);for(let i=0;i<arcSections;i+=1){const a0=A0+step*(i+0),a1=A0+step*(i+1),rSinStart=r*Math.sin(a0),rCosStart=r*Math.cos(a0),rSinEnd=r*Math.sin(a1),rCosEnd=r*Math.cos(a1);addCommand("C",cx+rCosStart-h*rSinStart,cy+rSinStart+h*rCosStart,cx+rCosEnd+h*rSinEnd,cy+rSinEnd-h*rCosEnd,cx+rCosEnd,cy+rSinEnd)}break}case 4:buffer.push("Z");break}return buffer.join(" ")}computeBBox(){const{commands,params}=this;let[top,left,right,bot]=[1/0,1/0,-1/0,-1/0],[sx,sy]=[NaN,NaN],[mx,my]=[NaN,NaN];const joinPoint=__name((x,y,updatestart)=>{top=Math.min(y,top),left=Math.min(x,left),right=Math.max(x,right),bot=Math.max(y,bot),updatestart&&([sx,sy]=[x,y])},"joinPoint");let pi=0;for(let ci=0;ci<commands.length;ci++)switch(commands[ci]){case 0:joinPoint(params[pi++],params[pi++],!0),[mx,my]=[sx,sy];break;case 1:joinPoint(params[pi++],params[pi++],!0);break;case 3:const cp1x=params[pi++],cp1y=params[pi++],cp2x=params[pi++],cp2y=params[pi++],x=params[pi++],y=params[pi++];joinPoint(x,y,!0),calculateDerivativeExtremaXY(sx,sy,cp1x,cp1y,cp2x,cp2y,x,y).forEach(t=>{const px=evaluateBezier(sx,cp1x,cp2x,x,t),py=evaluateBezier(sy,cp1y,cp2y,y,t);joinPoint(px,py)});break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++];let A0=normalizeAngle360(params[pi++]),A1=normalizeAngle360(params[pi++]);params[pi++]&&([A0,A1]=[A1,A0]);const joinAngle=__name((angle2,updatestart)=>{const px=cx+r*Math.cos(angle2),py=cy+r*Math.sin(angle2);joinPoint(px,py,updatestart)},"joinAngle");joinAngle(A0),joinAngle(A1,!0);const criticalAngles=[0,Math.PI/2,Math.PI,3*Math.PI/2];for(const crit of criticalAngles)(A0<A1&&A0<=crit&&crit<=A1||A0>A1&&(A0<=crit||crit<=A1))&&joinAngle(crit);break}case 4:[sx,sy]=[mx,my];break}return new BBox(left,top,right-left,bot-top)}},__name(_a78,"ExtendedPath2D"),_a78);function ScenePathChangeDetection(opts){const{redraw=3,changeCb,convertor}=opts??{};return SceneChangeDetection({redraw,type:"path",convertor,changeCb})}__name(ScenePathChangeDetection,"ScenePathChangeDetection");var _a79,Path=(_a79=class extends Shape{constructor(){super(...arguments),this.path=new ExtendedPath2D,this._clipX=NaN,this._clipY=NaN,this._dirtyPath=!0}set clipX(value){this._clipX=value,this.dirtyPath=!0}set clipY(value){this._clipY=value,this.dirtyPath=!0}set dirtyPath(value){this._dirtyPath!==value&&(this._dirtyPath=value,value&&this.markDirty(this,3))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){var _a274,_b;this._dirtyPath||(this.dirtyPath=this.path.isDirty()||(((_a274=this.fillShadow)==null?void 0:_a274.isDirty())??!1)||(((_b=this._clipPath)==null?void 0:_b.isDirty())??!1))}isPointInPath(x,y){return this.path.closedPath&&this.path.isPointInPath(x,y)}distanceSquared(x,y){return this.distanceSquaredTransformedPoint(x,y)}computeSVGDataPath(transform){return this.dirtyPath&&(this.updatePath(),this.dirtyPath=!1),this.path.computeSVGDataPath(transform)}distanceSquaredTransformedPoint(x,y){return this.path.closedPath&&this.path.isPointInPath(x,y)?0:this.path.distanceSquared(x,y)}isDirtyPath(){return!1}updatePath(){}render(renderCtx){var _a274,_b,_c;const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}if((this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),!isNaN(this._clipX)&&!isNaN(this._clipY)&&this.clipMode!=null){ctx.save();const margin=this.strokeWidth/2;if(this._clipPath??(this._clipPath=new ExtendedPath2D),this._clipPath.clear(),this._clipPath.rect(-margin,-margin,this._clipX+margin,this._clipY+margin+margin),this.clipMode==="normal"&&ctx.clip((_a274=this._clipPath)==null?void 0:_a274.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(ctx),this.clipMode==="punch-out"){ctx.clip((_b=this._clipPath)==null?void 0:_b.getPath2D());const{x=-1e4,y=-1e4,width=2e4,height=2e4}=this.getBBox()??{};ctx.clearRect(x,y,width,height)}ctx.restore()}else this.drawPath(ctx);(_c=this.fillShadow)==null||_c.markClean(),super.render(renderCtx)}drawPath(ctx){this.fillStroke(ctx,this.path.getPath2D())}},__name(_a79,"Path"),_a79);Path.className="Path";__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipMode",2);__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipX",1);__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipY",1);var focusStyles_exports={};__export(focusStyles_exports,{block:__name(()=>block,"block"),elements:__name(()=>elements,"elements"),modifiers:__name(()=>modifiers,"modifiers")});var block="ag-charts-focus",elements={indicator:"ag-charts-focus__indicator",svg:"ag-charts-focus__svg"},modifiers={hidden:"ag-charts-focus--hidden"};function getLastFocus(sourceEvent){if(sourceEvent.target instanceof HTMLElement&&"tabindex"in sourceEvent.target.attributes)return sourceEvent.target}__name(getLastFocus,"getLastFocus");var _a80,FocusIndicator=(_a80=class{constructor(domManager){this.domManager=domManager;const{block:block3,elements:elements3,modifiers:modifiers3}=focusStyles_exports;this.div=getDocument().createElement("div"),this.svg=getDocument().createElementNS("http://www.w3.org/2000/svg","svg"),this.path=getDocument().createElementNS("http://www.w3.org/2000/svg","path"),this.svg.append(this.path),this.element=domManager.addChild("canvas-overlay",block3),this.element.classList.add(block3,elements3.indicator,modifiers3.hidden),this.element.ariaHidden="true",this.element.append(this.svg)}destroy(){this.domManager.removeStyles(block),this.domManager.removeChild("canvas-overlay",block)}updateBounds(bounds){if(bounds===void 0)this.element.classList.add(modifiers.hidden);else if(bounds instanceof Path){const transform=__name((x,y)=>Transformable.toCanvasPoint(bounds,x,y),"transform");this.path.setAttribute("d",bounds.computeSVGDataPath(transform)),this.show(this.svg)}else setElementBBox(this.div,bounds),this.show(this.div)}show(child){this.element.classList.remove(modifiers.hidden),this.element.innerHTML="",this.element.append(child)}isShown(){return!this.element.classList.contains(modifiers.hidden)}guessDevice(event){const lastFocus=getLastFocus(event);if(lastFocus!==void 0){const style=getComputedStyle(lastFocus);if(this.isShown()||style.outlineStyle!=="none"&&style.outlineWidth!=="0px")return{type:"keyboard",lastFocus}}return{type:"mouse",lastFocus}}},__name(_a80,"FocusIndicator"),_a80),_a81,BoundedText=(_a81=class{set textContent(text){var _a274;this.textElement.textContent=text;const bboxCalculator=this.textElement,bbox=(_a274=bboxCalculator.getBBox)==null?void 0:_a274.call(bboxCalculator);bbox&&this.svgElement.setAttribute("viewBox",`${bbox.x} ${bbox.y} ${bbox.width} ${bbox.height}`)}get textContent(){return this.textElement.textContent}constructor(){this.textElement=createElementNS("http://www.w3.org/2000/svg","text"),this.textElement.role="presentation",this.svgElement=createElementNS("http://www.w3.org/2000/svg","svg"),this.svgElement.appendChild(this.textElement),this.svgElement.style.width="100%",this.svgElement.style.opacity="0",this.svgElement.role="presentation",this.boundedContainer=createElement("div"),this.boundedContainer.appendChild(this.svgElement),this.boundedContainer.role="presentation"}remove(){this.boundedContainer.remove()}getContainer(){return this.boundedContainer}updateBounds(bounds){setElementBBox(this.boundedContainer,bounds)}},__name(_a81,"BoundedText"),_a81);function checkType(type,meta){var _a274;return((_a274=meta.params)==null?void 0:_a274.type)===type}__name(checkType,"checkType");function allocateResult(type){if(type==="button")return createElement("button");if(type==="slider")return createElement("input");if(["toolbar","group","list"].includes(type))return createElement("div");if(type==="text")return new BoundedText;if(type==="listswitch")return{button:createElement("button"),listitem:createElement("div")};throw Error("AG Charts - error allocating meta")}__name(allocateResult,"allocateResult");function allocateMeta(params){const meta={params,result:void 0};return meta.result=allocateResult(meta.params.type),meta}__name(allocateMeta,"allocateMeta");var _a82,ProxyInteractionService=(_a82=class{constructor(updateService,localeManager,domManager,focusIndicator){this.localeManager=localeManager,this.domManager=domManager,this.focusIndicator=focusIndicator,this.debugShowDOMProxies=Debug.check("showDOMProxies"),this.destroyFns=[],this.destroyFns.push(updateService.addListener("update-complete",()=>this.update()))}destroy(){this.destroyFns.forEach(fn=>fn())}update(){this.focusable&&this.focusIndicator.updateBounds(this.focusable.toCanvasBBox())}addLocalisation(fn){fn(),this.destroyFns.push(this.localeManager.addListener("locale-changed",fn))}createProxyContainer(args){const meta=allocateMeta(args),{params,result:div}=meta;return this.domManager.addChild("canvas-overlay",params.id,div),div.classList.add(...params.classList),div.style.pointerEvents="none",div.role=params.type,"ariaOrientation"in params&&(div.ariaOrientation=params.ariaOrientation),typeof params.ariaHidden=="boolean"&&(div.ariaHidden=params.ariaHidden.toString()),this.addLocalisation(()=>{div.ariaLabel=this.localeManager.t(params.ariaLabel.id,params.ariaLabel.params)}),div}createProxyElement(args){const meta=allocateMeta(args);if(checkType("button",meta)){const{params,result:button}=meta;if(this.initInteract(params,button),typeof params.textContent=="string")button.textContent=params.textContent;else{const{textContent}=params;this.addLocalisation(()=>{button.textContent=this.localeManager.t(textContent.id,textContent.params)})}this.setParent(params,button)}if(checkType("slider",meta)){const{params,result:slider}=meta;this.initInteract(params,slider),slider.type="range",slider.role="presentation",slider.style.margin="0px",slider.ariaOrientation=params.ariaOrientation,this.addLocalisation(()=>{slider.ariaLabel=this.localeManager.t(params.ariaLabel.id,params.ariaLabel.params)}),this.setParent(params,slider)}if(checkType("text",meta)){const{params,result:text}=meta;this.initElement(params,text.getContainer()),this.setParent(params,text.getContainer())}if(checkType("listswitch",meta)){const{params,result:{button,listitem}}=meta;this.initInteract(params,button),button.style.width="100%",button.style.height="100%",button.textContent=params.textContent,button.role="switch",button.ariaChecked=params.ariaChecked.toString(),button.setAttribute("aria-describedby",params.ariaDescribedBy),listitem.role="listitem",listitem.style.position="absolute",listitem.replaceChildren(button),this.setParent(params,listitem)}return meta.result}initElement(params,element2){const{id}=params;element2.id=id,element2.style.pointerEvents="none",element2.style.opacity=this.debugShowDOMProxies?"0.25":"0",element2.style.position="absolute",element2.style.overflow="hidden"}initInteract(params,element2){const{focusable,onclick,onchange,onfocus,onblur,tabIndex}=params;this.initElement(params,element2),tabIndex!==void 0&&(element2.tabIndex=tabIndex),element2.addEventListener("focus",_event=>{this.focusable=focusable,element2.style.setProperty("pointerEvents",null),this.focusIndicator.updateBounds(focusable.toCanvasBBox())}),element2.addEventListener("blur",_event=>{this.focusable=void 0,element2.style.pointerEvents="none",this.focusIndicator.updateBounds(void 0)}),onclick&&element2.addEventListener("click",onclick),onfocus&&element2.addEventListener("focus",onfocus),onblur&&element2.addEventListener("blur",onblur),onchange&&element2.addEventListener("change",onchange)}setParent(params,element2){const{id,parent}=params;typeof parent=="string"?this.domManager.addChild(parent,id,element2):parent.appendChild(element2)}},__name(_a82,"ProxyInteractionService"),_a82),messageRegExp=/\$\{(\w+)}(?:\[(\w+)])?/gi,formatters={number:new Intl.NumberFormat("en-US"),percent:new Intl.NumberFormat("en-US",{style:"percent"}),date:new Intl.DateTimeFormat("en-US",{dateStyle:"full"}),time:new Intl.DateTimeFormat("en-US",{timeStyle:"full"}),datetime:new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"full"})},defaultMessageFormatter=__name(({defaultValue,variables})=>defaultValue==null?void 0:defaultValue.replaceAll(messageRegExp,(_,match,format)=>{const value=variables[match],formatter=format!=null?formatters[format]:null;return format!=null&&formatter==null&&Logger.warnOnce(`Format style [${format}] is not supported`),formatter!=null?formatter.format(value):typeof value=="number"?formatters.number.format(value):value instanceof Date?formatters.datetime.format(value):String(value)}),"defaultMessageFormatter"),_a83,LocaleManager=(_a83=class extends Listeners{constructor(){super(...arguments),this.localeText=void 0,this.getLocaleText=void 0}setLocaleText(localeText){this.localeText!==localeText&&(this.localeText=localeText,this.dispatch("locale-changed"))}setLocaleTextFormatter(getLocaleText){this.getLocaleText=getLocaleText,this.getLocaleText!==getLocaleText&&(this.getLocaleText=getLocaleText,this.dispatch("locale-changed"))}t(key,variables={}){const{localeText=AG_CHARTS_LOCALE_EN_US,getLocaleText}=this,defaultValue=localeText[key];return(getLocaleText==null?void 0:getLocaleText({key,defaultValue,variables}))??defaultMessageFormatter({key,defaultValue,variables})??key}},__name(_a83,"LocaleManager"),_a83);function hasConstrainedCanvasMemory(){if(typeof navigator>"u")return!1;const iPhoneOSMatch=navigator.userAgent.match(/\(iPhone; CPU iPhone OS (\d+_\d+_\d+) like Mac OS X\)/);if(iPhoneOSMatch==null)return!1;const[major,minor]=iPhoneOSMatch[1].split("_").map(Number);return major<16||major===16&&minor<6}__name(hasConstrainedCanvasMemory,"hasConstrainedCanvasMemory");var _a84,_HdpiCanvas=(_a84=class{constructor(options){this.enabled=!0,this.width=600,this.height=300;const{width,height,pixelRatio,canvasElement,willReadFrequently=!1}=options;this.pixelRatio=hasConstrainedCanvasMemory()?1:pixelRatio??getWindow("devicePixelRatio"),this.element=canvasElement??createElement("canvas"),this.element.style.display="block",this.element.style.width=(width??this.width)+"px",this.element.style.height=(height??this.height)+"px",this.element.width=Math.round((width??this.width)*this.pixelRatio),this.element.height=Math.round((height??this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently}),this.onEnabledChange(),this.resize(width??0,height??0),_a84.debugContext(this.context)}static is(value){return value instanceof _a84}drawImage(context,dx=0,dy=0){return context.drawImage(this.context.canvas,dx,dy)}toDataURL(type){return this.element.toDataURL(type)}resize(width,height){if(!(width>0&&height>0))return;const{element:element2,context,pixelRatio}=this;element2.width=Math.round(width*pixelRatio),element2.height=Math.round(height*pixelRatio),context.setTransform(pixelRatio,0,0,pixelRatio,0,0),element2.style.width=width+"px",element2.style.height=height+"px",this.width=width,this.height=height}snapshot(){}clear(){this.context.save(),this.context.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),this.context.clearRect(0,0,this.width,this.height),this.context.restore()}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}static debugContext(ctx){if(Debug.check("canvas")){const save=ctx.save.bind(ctx),restore=ctx.restore.bind(ctx);let depth=0;Object.assign(ctx,{save(){save(),depth++},restore(){if(depth===0)throw new Error("AG Charts - Unable to restore() past depth 0");restore(),depth--},verifyDepthZero(){if(depth!==0)throw new Error(`AG Charts - Save/restore depth is non-zero: ${depth}`)}})}}},__name(_a84,"_HdpiCanvas"),_a84);__decorateClass([ObserveChanges(target=>target.onEnabledChange())],_HdpiCanvas.prototype,"enabled",2);var HdpiCanvas=_HdpiCanvas,_a85,LayersManager=(_a85=class{constructor(canvas,markDirty){this.canvas=canvas,this.markDirty=markDirty,this.debug=Debug.create(!0,"scene"),this.layersMap=new Map,this.nextZIndex=0,this.nextLayerId=0}static sortLayers(a,b){return compoundAscending([a.zIndex,...a.zIndexSubOrder??[void 0,void 0],a.id],[b.zIndex,...b.zIndexSubOrder??[void 0,void 0],b.id],ascendingStringNumberUndefined)}get size(){return this.layersMap.size}forEach(callback2){Array.from(this.layersMap.values()).sort(_a85.sortLayers).forEach(callback2)}resize(width,height){this.canvas.resize(width,height),this.layersMap.forEach(({canvas})=>canvas.resize(width,height))}addLayer(opts){const{width,height,pixelRatio}=this.canvas,{zIndex=this.nextZIndex++,name,zIndexSubOrder,getComputedOpacity,getVisibility}=opts,canvas=new HdpiCanvas({width,height,pixelRatio}),newLayer={id:this.nextLayerId++,name,canvas,zIndex,zIndexSubOrder,getComputedOpacity,getVisibility};return zIndex>=this.nextZIndex&&(this.nextZIndex=zIndex+1),this.layersMap.set(canvas,newLayer),this.debug("Scene.addLayer() - layers",this.layersMap),newLayer.canvas}removeLayer(canvas){this.layersMap.has(canvas)&&(this.layersMap.delete(canvas),canvas.destroy(),this.markDirty(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}moveLayer(canvas,newZIndex,newZIndexSubOrder){const layer=this.layersMap.get(canvas);layer&&(layer.zIndex=newZIndex,layer.zIndexSubOrder=newZIndexSubOrder,this.markDirty(),this.debug("Scene.moveLayer() -  layers",this.layersMap))}clear(){this.layersMap.clear()}},__name(_a85,"_LayersManager"),_a85);function debugStats(layersManager,debugSplitTimes,ctx,renderCtxStats,extraDebugStats={},seriesRect=BBox.zero){if(!Debug.check("scene:stats","scene:stats:verbose"))return;const{layersRendered=0,layersSkipped=0,nodesRendered=0,nodesSkipped=0}=renderCtxStats??{},end=performance.now(),{start,...durations}=debugSplitTimes,splits=Object.entries(durations).map(([n,t])=>time(n,t)).filter(v=>v!=null).join(" + "),extras=Object.entries(extraDebugStats).map(([k,v])=>`${k}: ${v}`).join(" ; "),detailedStats=Debug.check("scene:stats:verbose"),stats=[`${time("⏱️",start,end)} (${splits})`,`${extras}`,`Layers: ${detailedStats?pct(layersRendered,layersSkipped):layersManager.size}`,detailedStats?`Nodes: ${pct(nodesRendered,nodesSkipped)}`:null].filter(isString),measurer=new SimpleTextMeasurer(t=>ctx.measureText(t)),statsSize=new Map(stats.map(t=>[t,measurer.measureLines(t)])),width=Math.max(...Array.from(statsSize.values(),s=>s.width)),height=accumulate(statsSize.values(),s=>s.height);ctx.save(),ctx.fillStyle="white",ctx.fillRect(0,0,width,height),ctx.fillStyle="black";let y=0;for(const[stat,size]of statsSize.entries())y+=size.height,ctx.fillText(stat,2+seriesRect.x,y);ctx.restore()}__name(debugStats,"debugStats");function prepareSceneNodeHighlight(ctx){const config=toArray(getWindow("agChartsSceneDebug")),result=[];for(const name of config)name==="layout"?result.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):result.push(name);ctx.debugNodeSearch=result}__name(prepareSceneNodeHighlight,"prepareSceneNodeHighlight");function debugSceneNodeHighlight(ctx,debugNodes){ctx.save();for(const[name,node]of Object.entries(debugNodes)){const bbox=Transformable.toCanvas(node);if(!bbox){Logger.log(`Scene.render() - no bbox for debugged node [${name}].`);continue}ctx.globalAlpha=.8,ctx.strokeStyle="red",ctx.lineWidth=1,ctx.strokeRect(bbox.x,bbox.y,bbox.width,bbox.height),ctx.fillStyle="red",ctx.strokeStyle="white",ctx.font="16px sans-serif",ctx.textBaseline="top",ctx.textAlign="left",ctx.lineWidth=2,ctx.strokeText(name,bbox.x,bbox.y,bbox.width),ctx.fillText(name,bbox.x,bbox.y,bbox.width)}ctx.restore()}__name(debugSceneNodeHighlight,"debugSceneNodeHighlight");function buildTree(node){var _a274;return Debug.check(!0,"scene")?{node,name:node.name??node.id,dirty:RedrawType[node.dirty],...(_a274=node.parent)!=null&&_a274.isVirtual?{virtualParentDirty:RedrawType[node.parent.dirty],virtualParent:node.parent}:{},...node.children.map(c=>buildTree(c)).reduce((result,childTree)=>{let{name:treeNodeName}=childTree;const{node:{visible,opacity,zIndex,zIndexSubOrder,translationX,translationY,rotation,scalingX,scalingY},node:childNode,virtualParent}=childTree;(!visible||opacity<=0)&&(treeNodeName=`(${treeNodeName})`),childNode instanceof Group&&childNode.isLayer()&&(treeNodeName=`*${treeNodeName}*`);const key=[`${treeNodeName??"<unknown>"}`,`z: ${zIndex}`,zIndexSubOrder&&`zo: ${zIndexSubOrder.map(v=>typeof v=="function"?`${v()} (fn)`:v).join(" / ")}`,virtualParent&&"(virtual parent)",translationX&&`x: ${translationX}`,translationY&&`y: ${translationY}`,rotation&&`r: ${rotation}`,scalingX!=null&&scalingX!==1&&`sx: ${scalingX}`,scalingY!=null&&scalingY!==1&&`sy: ${scalingY}`].filter(v=>!!v).join(" ");let selectedKey=key,index=1;for(;result[selectedKey]!=null&&index<100;)selectedKey=`${key} (${index++})`;return result[selectedKey]=childTree,result},{})}:{}}__name(buildTree,"buildTree");function buildDirtyTree(node){if(node.dirty===0)return{dirtyTree:{},paths:[]};const childrenDirtyTree=node.children.map(c=>buildDirtyTree(c)).filter(c=>c.paths.length>0),name=Group.is(node)?node.name??node.id:node.id,paths=childrenDirtyTree.length?childrenDirtyTree.flatMap(c=>c.paths).map(p=>`${name}.${p}`):[name];return{dirtyTree:{name,node,dirty:RedrawType[node.dirty],...childrenDirtyTree.map(c=>c.dirtyTree).filter(t=>t.dirty!=null).reduce((result,childTree)=>(result[childTree.name??"<unknown>"]=childTree,result),{})},paths}}__name(buildDirtyTree,"buildDirtyTree");function pct(rendered,skipped){const total=rendered+skipped;return`${rendered} / ${total} (${Math.round(100*rendered/total)}%)`}__name(pct,"pct");function time(name,start,end){const duration=end!=null?end-start:start;return`${name}: ${Math.round(duration*100)/100}ms`}__name(time,"time");function accumulate(iterator,mapper){let sum2=0;for(const item of iterator)sum2+=mapper(item);return sum2}__name(accumulate,"accumulate");var _a86,Scene=(_a86=class{constructor(canvasOptions){this.debug=Debug.create(!0,"scene"),this.id=createId(this),this.root=null,this.pendingSize=null,this.isDirty=!1,this.canvas=new HdpiCanvas(canvasOptions),this.layersManager=new LayersManager(this.canvas,()=>{this.isDirty=!0})}get width(){var _a274;return((_a274=this.pendingSize)==null?void 0:_a274[0])??this.canvas.width}get height(){var _a274;return((_a274=this.pendingSize)==null?void 0:_a274[1])??this.canvas.height}setContainer(value){var _a274;const{element:element2}=this.canvas;return(_a274=element2.parentElement)==null||_a274.removeChild(element2),value.appendChild(element2),this}setRoot(node){var _a274;return this.root===node?this:(this.isDirty=!0,(_a274=this.root)==null||_a274._setLayerManager(),this.root=node,node&&(node.visible=!0,node._setLayerManager(this.layersManager)),this)}attachNode(node){return this.appendChild(node),()=>this.removeChild(node)}appendChild(node){var _a274;return(_a274=this.root)==null||_a274.appendChild(node),this}removeChild(node){var _a274;return(_a274=this.root)==null||_a274.removeChild(node),this}download(fileName,fileFormat){downloadUrl(this.canvas.toDataURL(fileFormat),(fileName==null?void 0:fileName.trim())??"image")}getDataURL(fileFormat){return this.canvas.toDataURL(fileFormat)}resize(width,height){return width=Math.round(width),height=Math.round(height),width>0&&height>0&&(width!==this.width||height!==this.height)?(this.pendingSize=[width,height],this.isDirty=!0,!0):!1}async render(opts){var _a274;const{debugSplitTimes={start:performance.now()},extraDebugStats,seriesRect}=opts??{},{canvas,canvas:{context:ctx}={},root,pendingSize}=this;if(!ctx)return;const renderStartTime=performance.now();if(pendingSize&&(this.layersManager.resize(...pendingSize),this.pendingSize=null),root&&!root.visible){this.isDirty=!1;return}if(root&&!this.isDirty){this.debug.check()&&this.debug("Scene.render() - no-op",{redrawType:RedrawType[root.dirty],tree:buildTree(root)}),debugStats(this.layersManager,debugSplitTimes,ctx,void 0,extraDebugStats,seriesRect);return}const renderCtx={ctx,devicePixelRatio:this.canvas.pixelRatio??1,forceRender:!0,resized:!!pendingSize,debugNodes:{}};Debug.check("scene:stats:verbose")&&(renderCtx.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0}),prepareSceneNodeHighlight(renderCtx);let canvasCleared=!1;if((!root||root.dirty>=1)&&(canvasCleared=!0,canvas.clear()),root&&Debug.check("scene:dirtyTree")){const{dirtyTree,paths}=buildDirtyTree(root);Debug.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree,paths})}if(root&&canvasCleared&&(this.debug("Scene.render() - before",{redrawType:RedrawType[root.dirty],canvasCleared,tree:buildTree(root)}),root.visible&&(root.preRender(),ctx.save(),root.render(renderCtx),ctx.restore())),debugSplitTimes["✍️"]=performance.now()-renderStartTime,this.layersManager.size&&canvasCleared){const layerRenderStart=performance.now();ctx.save(),ctx.resetTransform(),this.layersManager.forEach(layer=>{layer.canvas.enabled&&layer.getVisibility()&&(ctx.globalAlpha=layer.getComputedOpacity(),layer.canvas.drawImage(ctx))}),ctx.restore(),debugSplitTimes["⛙"]=performance.now()-layerRenderStart}(_a274=ctx.verifyDepthZero)==null||_a274.call(ctx),this.isDirty=!1,debugStats(this.layersManager,debugSplitTimes,ctx,renderCtx.stats,extraDebugStats,seriesRect),debugSceneNodeHighlight(ctx,renderCtx.debugNodes),root&&this.debug.check()&&this.debug("Scene.render() - after",{redrawType:RedrawType[root.dirty],tree:buildTree(root),canvasCleared})}strip(){const{context,pixelRatio}=this.canvas;context.setTransform(pixelRatio,0,0,pixelRatio,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1}destroy(){this.strip(),this.canvas.destroy(),Object.assign(this,{canvas:void 0})}},__name(_a86,"Scene"),_a86);Scene.className="Scene";var _a87,CallbackCache=(_a87=class{constructor(){this.cache=new WeakMap}call(fn,...params){let serialisedParams,paramCache=this.cache.get(fn);try{serialisedParams=JSON.stringify(params)}catch{return this.invoke(fn,params,paramCache)}return paramCache==null&&(paramCache=new Map,this.cache.set(fn,paramCache)),paramCache.has(serialisedParams)?paramCache.get(serialisedParams):this.invoke(fn,params,paramCache,serialisedParams)}invoke(fn,params,paramCache,serialisedParams){try{const result=fn(...params);return paramCache&&serialisedParams!=null&&paramCache.set(serialisedParams,result),result}catch(e){Logger.warnOnce("User callback errored, ignoring",e);return}}invalidateCache(){this.cache=new WeakMap}},__name(_a87,"CallbackCache"),_a87),_a88,AnnotationManager=(_a88=class extends BaseManager{constructor(annotationRoot){super(),this.annotationRoot=annotationRoot,this.mementoOriginatorKey="annotations",this.annotations=[]}createMemento(){return this.annotations}guardMemento(blob){return isArray(blob)}restoreMemento(_version,_mementoVersion,memento){this.annotations=this.cleanData(memento).map(annotation=>{const annotationTheme=this.getAnnotationTypeStyles(annotation.type);return mergeDefaults(annotation,annotationTheme)}),this.listeners.dispatch("restore-annotations",{type:"restore-annotations",annotations:this.annotations})}updateData(annotations2){this.annotations=this.cleanData(annotations2??[])}attachNode(node){return this.annotationRoot.append(node),()=>{var _a274;return(_a274=this.annotationRoot)==null||_a274.removeChild(node),this}}setAnnotationStyles(styles){this.styles=styles}getAnnotationTypeStyles(type){var _a274;return(_a274=this.styles)==null?void 0:_a274[type]}cleanData(annotations2){for(const annotation of annotations2)"textAlign"in annotation&&delete annotation.textAlign;return annotations2}},__name(_a88,"AnnotationManager"),_a88),_a89,AxisManager=(_a89=class{constructor(sceneRoot){this.sceneRoot=sceneRoot,this.axes=new Map,this.axisGridGroup=new Group({name:"Axes-Grids",layer:!0,zIndex:1}),this.axisGroup=new Group({name:"Axes",layer:!0,zIndex:2}),this.sceneRoot.appendChild(this.axisGroup),this.sceneRoot.appendChild(this.axisGridGroup)}updateAxes(oldAxes,newAxes){var _a274;for(const axis of oldAxes)newAxes.includes(axis)||(axis.detachAxis(this.axisGroup,this.axisGridGroup),axis.destroy());for(const axis of newAxes)oldAxes!=null&&oldAxes.includes(axis)||axis.attachAxis(this.axisGroup,this.axisGridGroup);this.axes.clear();for(const axis of newAxes){const ctx=axis.createAxisContext();this.axes.has(ctx.direction)?(_a274=this.axes.get(ctx.direction))==null||_a274.push(ctx):this.axes.set(ctx.direction,[ctx])}}getAxisContext(direction){return this.axes.get(direction)??[]}destroy(){this.axes.clear(),this.sceneRoot.removeChild(this.axisGroup),this.sceneRoot.removeChild(this.axisGridGroup)}},__name(_a89,"AxisManager"),_a89),_a90,DataService=(_a90=class extends Listeners{constructor(animationManager){super(),this.animationManager=animationManager,this.dispatchOnlyLatest=!0,this.dispatchThrottle=0,this.requestThrottle=300,this.isLoadingInitialData=!1,this.isLoadingData=!1,this.freshRequests=[],this.requestCounter=0,this.debug=Debug.create(!0,"data-model","data-source"),this.throttledFetch=this.createThrottledFetch(this.requestThrottle),this.throttledDispatch=this.createThrottledDispatch(this.dispatchThrottle)}updateCallback(dataSourceCallback){typeof dataSourceCallback=="function"&&(this.debug("DataService - updated data source callback"),this.dataSourceCallback=dataSourceCallback,this.isLoadingInitialData=!0,this.animationManager.skip(),this.dispatch("data-source-change"))}clearCallback(){this.dataSourceCallback=void 0}load(params){this.isLoadingData=!0,this.throttledFetch(params)}isLazy(){return this.dataSourceCallback!=null}isLoading(){return this.isLazy()&&(this.isLoadingInitialData||this.isLoadingData)}createThrottledFetch(requestThrottle){return throttle(params=>this.fetch(params),requestThrottle,{leading:!1,trailing:!0})}createThrottledDispatch(dispatchThrottle){return throttle((id,data)=>{this.debug(`DataService - dispatching 'data-load' | ${id}`),this.dispatch("data-load",{type:"data-load",data})},dispatchThrottle,{leading:!0,trailing:!0})}async fetch(params){if(!this.dataSourceCallback)throw new Error("DataService - [dataSource.getData] callback not initialised");const start=performance.now(),id=this.requestCounter++;this.debug(`DataService - requesting | ${id}`),this.freshRequests.push(id);let response;try{response=await this.dataSourceCallback(params),this.debug(`DataService - response | ${performance.now()-start}ms | ${id}`)}catch(error){this.debug(`DataService - request failed | ${id}`),Logger.errorOnce(`DataService - request failed | [${error}]`)}this.isLoadingInitialData=!1;const requestIndex=this.freshRequests.findIndex(rid=>rid===id);if(requestIndex===-1||this.dispatchOnlyLatest&&requestIndex!==this.freshRequests.length-1){this.debug(`DataService - discarding stale request | ${id}`);return}this.freshRequests=this.freshRequests.slice(requestIndex+1),this.freshRequests.length===0&&(this.isLoadingData=!1),Array.isArray(response)?this.throttledDispatch(id,response):this.dispatch("data-error")}},__name(_a90,"DataService"),_a90);__decorateClass([ActionOnSet({newValue(dispatchThrottle){this.throttledDispatch=this.createThrottledDispatch(dispatchThrottle)}})],DataService.prototype,"dispatchThrottle",2);__decorateClass([ActionOnSet({newValue(requestThrottle){this.throttledFetch=this.createThrottledFetch(requestThrottle)}})],DataService.prototype,"requestThrottle",2);var _a91,AnimationBatch=(_a91=class{constructor(maxAnimationTime){this.maxAnimationTime=maxAnimationTime,this.debug=Debug.create(!0,"animation"),this.controllers=new Map,this.stoppedCbs=new Set,this.currentPhase=0,this.phases=new Map(PHASE_ORDER.map(p=>[p,[]])),this.skipAnimations=!1,this.animationTimeConsumed=0,this.isReady=!1}get size(){return this.controllers.size}get consumedTimeMs(){return this.animationTimeConsumed}isActive(){return this.controllers.size>0}getActiveControllers(){return this.phases.get(PHASE_ORDER[this.currentPhase])??[]}checkOverlappingId(id){id!=null&&this.controllers.has(id)&&(this.controllers.get(id).stop(),this.debug(`Skipping animation batch due to update of existing animation: ${id}`),this.skip())}addAnimation(animation){var _a274;if(animation.isComplete)return;if(PHASE_ORDER.indexOf(animation.phase)<this.currentPhase){this.debug("Skipping animation due to being for an earlier phase",animation.id),animation.stop();return}this.controllers.set(animation.id,animation),(_a274=this.phases.get(animation.phase))==null||_a274.push(animation)}removeAnimation(animation){this.controllers.delete(animation.id);const phase=this.phases.get(animation.phase),index=phase==null?void 0:phase.indexOf(animation);index!=null&&index>=0&&(phase==null||phase.splice(index,1))}progress(deltaTime){if(!this.isReady)return;let unusedTime=deltaTime===0?.01:deltaTime;const refresh=__name(()=>{const phase2=PHASE_ORDER[this.currentPhase];return{phaseControllers:[...this.getActiveControllers()],phase:phase2,phaseMeta:PHASE_METADATA[phase2]}},"refresh");let{phase,phaseControllers,phaseMeta}=refresh();const arePhasesComplete=__name(()=>PHASE_ORDER[this.currentPhase]==null,"arePhasesComplete"),progressPhase=__name(()=>{for({phase,phaseControllers,phaseMeta}=refresh();!arePhasesComplete()&&phaseControllers.length===0;)this.currentPhase++,{phase,phaseControllers,phaseMeta}=refresh(),this.debug(`AnimationBatch - phase changing to ${phase}`,{unusedTime},phaseControllers)},"progressPhase"),total=this.controllers.size;this.debug(`AnimationBatch - ${deltaTime}ms; phase ${phase} with ${phaseControllers==null?void 0:phaseControllers.length} of ${total}`);do{const phaseDeltaTime=unusedTime,skipPhase=phaseMeta.skipIfNoEarlierAnimations&&this.animationTimeConsumed===0;let completeCount=0;for(const controller of phaseControllers)skipPhase?controller.stop():unusedTime=Math.min(controller.update(phaseDeltaTime),unusedTime),controller.isComplete&&(completeCount++,this.removeAnimation(controller));this.animationTimeConsumed+=phaseDeltaTime-unusedTime,this.debug(`AnimationBatch - updated ${phaseControllers.length} controllers; ${completeCount} completed`),this.debug(`AnimationBatch - animationTimeConsumed: ${this.animationTimeConsumed}`),progressPhase()}while(unusedTime>0&&!arePhasesComplete());this.animationTimeConsumed>this.maxAnimationTime&&(this.debug("Animation batch exceeded max animation time, skipping",[...this.controllers]),this.stop())}ready(){if(this.isReady)return;this.isReady=!0,this.debug(`AnimationBatch - ready; skipped: ${this.skipAnimations}`,[...this.controllers]);let skipAll=!0;for(const[,controller]of this.controllers)if(controller.duration>0&&PHASE_METADATA[controller.phase].skipIfNoEarlierAnimations!==!0){skipAll=!1;break}if(!skipAll)for(const[,controller]of this.controllers)controller.autoplay&&controller.play(!0)}skip(skip=!0){if(this.skipAnimations===!1&&skip===!0){for(const controller of this.controllers.values())controller.stop();this.controllers.clear()}this.skipAnimations=skip}play(){for(const controller of this.controllers.values())controller.play()}pause(){for(const controller of this.controllers.values())controller.pause()}stop(){for(const controller of this.controllers.values())try{controller.stop(),this.removeAnimation(controller)}catch(error){Logger.error("Error during animation stop",error)}this.dispatchStopped()}stopByAnimationId(id){if(id!=null&&this.controllers.has(id)){const controller=this.controllers.get(id);controller&&(controller.stop(),this.removeAnimation(controller))}}stopByAnimationGroupId(id){for(const controller of this.controllers.values())controller.groupId===id&&this.stopByAnimationId(controller.id)}dispatchStopped(){this.stoppedCbs.forEach(cb=>cb()),this.stoppedCbs.clear()}isSkipped(){return this.skipAnimations}destroy(){this.stop(),this.controllers.clear()}},__name(_a91,"AnimationBatch"),_a91),InteractionState=(InteractionState2=>(InteractionState2[InteractionState2.Default=16]="Default",InteractionState2[InteractionState2.ZoomDrag=8]="ZoomDrag",InteractionState2[InteractionState2.Annotations=4]="Annotations",InteractionState2[InteractionState2.ContextMenu=2]="ContextMenu",InteractionState2[InteractionState2.Animation=1]="Animation",InteractionState2[InteractionState2.All=31]="All",InteractionState2))(InteractionState||{}),_a92,InteractionStateListener=(_a92=class extends BaseManager{addListener(type,handler,triggeringStates=16){return super.addListener(type,e=>{this.getState()&triggeringStates&&handler(e)})}},__name(_a92,"InteractionStateListener"),_a92);function buildPreventable(obj){const self={...obj,preventDefault(){var _a274;(_a274=self.sourceEvent)==null||_a274.preventDefault()}};return self}__name(buildPreventable,"buildPreventable");function dispatchTypedEvent(listeners,event){listeners.dispatchWrapHandlers(event.type,(handler,e)=>handler(e),buildPreventable(event))}__name(dispatchTypedEvent,"dispatchTypedEvent");var POINTER_INTERACTION_TYPES=["click","dblclick","contextmenu","hover","drag-start","drag","drag-end","leave","enter","page-left","wheel"],FOCUS_INTERACTION_TYPES=["blur","focus"],KEY_INTERACTION_TYPES=["keydown","keyup"],SHADOW_DOM_HANDLERS=["mousemove","mouseup"],WINDOW_EVENT_HANDLERS=["pagehide","mousemove","mouseup"],EVENT_HANDLERS=["click","dblclick","contextmenu","mousedown","mouseleave","mouseenter","touchstart","touchmove","touchend","touchcancel","wheel","blur","focus","keydown","keyup"],PointerCapture=(PointerCapture2=>(PointerCapture2.Retain="retain",PointerCapture2.Exclusive="exclusive",PointerCapture2))(PointerCapture||{}),pointerCaptures=new Set(Object.values(PointerCapture));function isPointerEvent(type){return POINTER_INTERACTION_TYPES.includes(type)}__name(isPointerEvent,"isPointerEvent");function isFocusEvent(type){return FOCUS_INTERACTION_TYPES.includes(type)}__name(isFocusEvent,"isFocusEvent");function isKeyEvent(type){return KEY_INTERACTION_TYPES.includes(type)}__name(isKeyEvent,"isKeyEvent");var _a93,_InteractionManager=(_a93=class extends InteractionStateListener{constructor(keyboardOptions,domManager){super(),this.keyboardOptions=keyboardOptions,this.domManager=domManager,this.debug=Debug.create(!0,"interaction"),this.eventHandler=event=>this.processEvent(event),this.overlayEventHandler=event=>this.processCanvasOverlayEvent(event),this.mouseDown=!1,this.touchDown=!1,this.pointerCaptureCanvasElement=void 0,this.clickHistory=[{offsetX:NaN,offsetY:NaN,type:"mousedown"}],this.dblclickHistory=[{offsetX:NaN,offsetY:NaN,type:"mousedown"},{offsetX:NaN,offsetY:NaN,type:"mouseup"},{offsetX:NaN,offsetY:NaN,type:"mousedown"}],this.stateQueue=17,this.rootElement=this.domManager.getShadowDocumentRoot();for(const type of EVENT_HANDLERS)type.startsWith("touch")||type==="wheel"?this.domManager.addEventListener(type,this.eventHandler,{passive:!1}):this.domManager.addEventListener(type,this.eventHandler);for(const type of WINDOW_EVENT_HANDLERS)getWindow().addEventListener(type,this.eventHandler);this.destroyFns.push(this.domManager.addEventListenerOnElement("canvas-overlay","mouseover",this.overlayEventHandler),this.domManager.addEventListenerOnElement("canvas-overlay","mouseout",this.overlayEventHandler)),this.containerChanged(!0),this.domManager.addListener("container-changed",()=>this.containerChanged())}containerChanged(force=!1){var _a274,_b;const newRoot=this.domManager.getShadowDocumentRoot();if(!(!force&&newRoot===this.rootElement)){for(const type of SHADOW_DOM_HANDLERS)(_a274=this.rootElement)==null||_a274.removeEventListener(type,this.eventHandler);this.rootElement=newRoot,this.debug("[InteractionManager] Switching rootElement to:",this.rootElement);for(const type of SHADOW_DOM_HANDLERS)(_b=this.rootElement)==null||_b.addEventListener(type,this.eventHandler)}}destroy(){var _a274;super.destroy();for(const type of WINDOW_EVENT_HANDLERS)getWindow().removeEventListener(type,this.eventHandler);for(const type of SHADOW_DOM_HANDLERS)(_a274=this.rootElement)==null||_a274.removeEventListener(type,this.eventHandler);for(const type of EVENT_HANDLERS)this.domManager.removeEventListener(type,this.eventHandler);this.domManager.removeStyles("interactionManager")}pushState(state){this.stateQueue|=state}popState(state){this.stateQueue&=~state}getState(){return this.stateQueue&-this.stateQueue}processCanvasOverlayEvent(event){const coords=this.calculateCoordinates(event);if(coords==null)return;let target=event.target,pointerCapture=null;for(;target!=null&&(pointerCapture=target.getAttribute("data-pointer-capture"),pointerCapture==null);)target=target.parentElement;if(target==null||pointerCapture==null||!pointerCaptures.has(pointerCapture))return;const isOverCanvasOverlay=event.type==="mouseover",pointerCaptureCanvasElement=isOverCanvasOverlay?target:void 0;if(this.pointerCaptureCanvasElement!==pointerCaptureCanvasElement&&(this.pointerCaptureCanvasElement=pointerCaptureCanvasElement,pointerCapture==="exclusive")){const pointerEvent=this.buildPointerEvent({type:isOverCanvasOverlay?"leave":"enter",event,...coords});this.debug("Dispatching canvas overlay event",pointerEvent,this.getState()),dispatchTypedEvent(this.listeners,pointerEvent)}}processEvent(event){this.debug("Received raw event",event);const type=this.decideInteractionEventTypes(event),target=event.target;if(event.type==="click"&&(target==null?void 0:target.ariaDisabled)==="true"){event.preventDefault();return}this.ignoreEvent(type,target)||type!=null&&this.dispatchEvent(event,type).catch(e=>Logger.errorOnce(e))}ignoreEvent(type,target){var _a274;if(type==="contextmenu")return!1;const ignoredTags=["button","input"];return[(_a274=target==null?void 0:target.tagName)==null?void 0:_a274.toLowerCase(),target==null?void 0:target.role].some(tag=>ignoredTags.includes(tag))}async dispatchEvent(event,type){if(isPointerEvent(type)){this.dispatchPointerEvent(event,type);return}const{relatedElement,targetElement}=this.extractElements(event);if(isFocusEvent(type)){const sourceEvent=event;this.dispatchTypedEvent(this.listeners,{type,sourceEvent,relatedElement,targetElement})}else if(isKeyEvent(type)){const sourceEvent=event;this.dispatchTypedEvent(this.listeners,{type,sourceEvent,relatedElement,targetElement})}}dispatchTypedEvent(listeners,event){const preventableEvent=buildPreventable(event);this.debug("Dispatching typed event",preventableEvent,this.getState()),listeners.dispatchWrapHandlers(event.type,(handler,e)=>handler(e),preventableEvent)}extractElements(event){let relatedElement,targetElement;return"relatedTarget"in event&&event.relatedTarget instanceof HTMLElement&&(relatedElement=event.relatedTarget),"target"in event&&event.target instanceof HTMLElement&&(targetElement=event.target),{relatedElement,targetElement}}dispatchPointerEvent(event,type){const coords=this.calculateCoordinates(event);if(coords==null)return;const pointerEvent=this.buildPointerEvent({type,event,...coords});this.debug("Dispatching pointer event",pointerEvent,this.getState()),dispatchTypedEvent(this.listeners,pointerEvent)}getEventHTMLTarget(event){if(event.target instanceof HTMLElement)return event.target;if(event.currentTarget instanceof HTMLElement)return event.currentTarget}recordDown(event){event instanceof MouseEvent&&(partialAssign(["offsetX","offsetY"],this.clickHistory[0],event),partialAssign(["offsetX","offsetY"],this.dblclickHistory[2],this.dblclickHistory[0]),partialAssign(["offsetX","offsetY"],this.dblclickHistory[0],event)),this.dragStartElement=this.getEventHTMLTarget(event)}recordUp(event){event instanceof MouseEvent&&partialAssign(["offsetX","offsetY"],this.dblclickHistory[1],event),this.dragStartElement=void 0}decideInteractionEventTypes(event){var _a274;const dragStart="drag-start";if(((_a274=this.pointerCaptureCanvasElement)==null?void 0:_a274.isConnected)===!1&&(this.pointerCaptureCanvasElement=void 0),this.pointerCaptureCanvasElement==null)switch(event.type){case"blur":case"focus":case"keydown":case"keyup":return this.keyboardOptions.enabled?event.type:void 0;case"click":case"dblclick":case"contextmenu":case"wheel":return event.type;case"mousedown":return this.isEventOverElement(event)?(this.mouseDown=!0,this.recordDown(event),dragStart):void 0;case"touchstart":return this.isEventOverElement(event)?(this.touchDown=!0,this.recordDown(event),dragStart):void 0;case"touchmove":case"mousemove":return!this.mouseDown&&!this.touchDown&&!this.isEventOverElement(event)?void 0:this.mouseDown||this.touchDown?"drag":"hover";case"mouseup":return!this.mouseDown&&!this.isEventOverElement(event)?void 0:(this.mouseDown=!1,this.recordUp(event),"drag-end");case"touchend":return!this.touchDown&&!this.isEventOverElement(event)?void 0:(this.touchDown=!1,this.recordUp(event),"drag-end");case"mouseleave":case"touchcancel":return"leave";case"mouseenter":return"enter";case"pagehide":return"page-left"}}isEventOverElement(event){return this.domManager.isEventOverElement(event)}calculateCoordinates(event){if(event instanceof MouseEvent)return this.getMouseEventCoords(event);if(typeof TouchEvent<"u"&&event instanceof TouchEvent){const lastTouch=event.touches[0]??event.changedTouches[0],{clientX,clientY,pageX,pageY}=lastTouch;return{..._a93.NULL_COORDS,clientX,clientY,pageX,pageY}}else if(event instanceof PageTransitionEvent)return event.persisted?void 0:_a93.NULL_COORDS}getMouseEventCoords(event){const{clientX,clientY,pageX,pageY}=event;let{offsetX,offsetY}=event;const target=this.getEventHTMLTarget(event),{x=0,y=0}=target?this.domManager.calculateCanvasPosition(target):{};if(this.dragStartElement!=null&&event.target!==this.dragStartElement){const offsetDragStart=this.domManager.calculateCanvasPosition(this.dragStartElement);offsetX-=offsetDragStart.x-x,offsetY-=offsetDragStart.y-y}else offsetX+=x,offsetY+=y;return{clientX,clientY,pageX,pageY,offsetX,offsetY}}isWheelEvent(event){return event.type==="wheel"}buildPointerEvent(opts){var _a274;const{type,event,clientX,clientY}=opts;let{offsetX,offsetY,pageX,pageY}=opts;if(!isFiniteNumber(offsetX)||!isFiniteNumber(offsetY)){const rect=this.domManager.getBoundingClientRect();offsetX=clientX-rect.left,offsetY=clientY-rect.top}if(!isFiniteNumber(pageX)||!isFiniteNumber(pageY)){const pageRect=(_a274=this.rootElement)==null?void 0:_a274.getBoundingClientRect();pageX=clientX-((pageRect==null?void 0:pageRect.left)??0),pageY=clientY-((pageRect==null?void 0:pageRect.top)??0)}let[deltaX,deltaY]=[NaN,NaN];if(this.isWheelEvent(event)){const factor=event.deltaMode===0?.01:1;deltaX=event.deltaX*factor,deltaY=event.deltaY*factor}let pointerHistory=[];event.type==="click"?pointerHistory=this.clickHistory:event.type==="dblclick"&&(pointerHistory=this.dblclickHistory);const{relatedElement,targetElement}=this.extractElements(event),button="button"in event?Number(event.button):0,builtEvent={type,offsetX,offsetY,pageX,pageY,deltaX,deltaY,button,pointerHistory,sourceEvent:event,relatedElement,targetElement};return this.debug("InteractionManager - builtEvent: ",builtEvent,this.getState()),builtEvent}},__name(_a93,"_InteractionManager"),_a93);_InteractionManager.NULL_COORDS={clientX:-1/0,clientY:-1/0,pageX:-1/0,pageY:-1/0,offsetX:-1/0,offsetY:-1/0};var InteractionManager=_InteractionManager;function validAnimationDuration(testee){return testee==null?!0:!isNaN(testee)&&testee>=0&&testee<=2}__name(validAnimationDuration,"validAnimationDuration");var _a94,AnimationManager=(_a94=class{constructor(interactionManager,chartUpdateMutex){this.interactionManager=interactionManager,this.chartUpdateMutex=chartUpdateMutex,this.defaultDuration=1e3,this.batch=new AnimationBatch(this.defaultDuration*1.5),this.debug=Debug.create(!0,"animation"),this.events=new EventEmitter,this.rafAvailable=typeof requestAnimationFrame<"u",this.isPlaying=!0,this.requestId=null,this.skipAnimations=!0,this.currentAnonymousAnimationId=0}addListener(eventName,listener){return this.events.on(eventName,listener)}animate({...opts}){const batch=this.batch;try{batch.checkOverlappingId(opts.id)}catch(error){this.failsafeOnError(error);return}let{id}=opts;id==null&&(id=`__${this.currentAnonymousAnimationId}`,this.currentAnonymousAnimationId+=1);const skip=this.isSkipped()||opts.phase==="none";skip&&this.debug("AnimationManager - skipping animation");const{delay,duration}=opts;if(!validAnimationDuration(delay))throw new Error(`Animation delay of ${delay} is unsupported (${id})`);if(!validAnimationDuration(duration))throw new Error(`Animation duration of ${duration} is unsupported (${id})`);const animation=new Animation({...opts,id,skip,autoplay:this.isPlaying?opts.autoplay:!1,phase:opts.phase,defaultDuration:this.defaultDuration});if(!this.forceTimeJump(animation,this.defaultDuration))return this.batch.addAnimation(animation),animation}play(){if(!this.isPlaying){this.isPlaying=!0,this.debug("AnimationManager.play()");try{this.batch.play()}catch(error){this.failsafeOnError(error)}this.requestAnimation()}}pause(){if(this.isPlaying){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.pause()");try{this.batch.pause()}catch(error){this.failsafeOnError(error)}}}stop(){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.stop()"),this.batch.stop()}stopByAnimationId(id){try{this.batch.stopByAnimationId(id)}catch(error){this.failsafeOnError(error)}}stopByAnimationGroupId(id){try{this.batch.stopByAnimationGroupId(id)}catch(error){this.failsafeOnError(error)}}reset(){this.isPlaying?(this.stop(),this.play()):this.stop()}skip(skip=!0){this.skipAnimations=skip}isSkipped(){return!this.rafAvailable||this.skipAnimations||this.batch.isSkipped()}isActive(){return this.isPlaying&&this.batch.isActive()}skipCurrentBatch(){this.debug.check()&&this.debug("AnimationManager - skipCurrentBatch()",{stack:new Error().stack}),this.batch.skip()}isSkippingFrames(){return!0}scheduleAnimationFrame(cb){this.requestId=getWindow().requestAnimationFrame(cb)}forceTimeJump(_animation,_defaultDuration){return!1}requestAnimation(){if(!this.rafAvailable||!this.batch.isActive()||this.requestId!==null)return;let prevTime;const onAnimationFrame=__name(async time2=>{const executeAnimationFrame=__name(async()=>{const deltaTime=time2-(prevTime??time2);prevTime=time2,this.debug("AnimationManager - onAnimationFrame()",{controllersCount:this.batch.size,deltaTime}),this.interactionManager.pushState(1);try{this.batch.progress(deltaTime)}catch(error){this.failsafeOnError(error)}this.events.emit("animation-frame",{type:"animation-frame",deltaMs:deltaTime})},"executeAnimationFrame");this.isSkippingFrames()?await this.chartUpdateMutex.acquireImmediately(executeAnimationFrame):await this.chartUpdateMutex.acquire(executeAnimationFrame),this.batch.isActive()?this.scheduleAnimationFrame(onAnimationFrame):(this.batch.stop(),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}))},"onAnimationFrame");this.events.emit("animation-start",{type:"animation-start",deltaMs:0}),this.scheduleAnimationFrame(onAnimationFrame)}cancelAnimation(){this.requestId!==null&&(cancelAnimationFrame(this.requestId),this.requestId=null,this.startBatch())}failsafeOnError(error,cancelAnimation=!0){Logger.error("Error during animation, skipping animations",error),cancelAnimation&&this.cancelAnimation()}startBatch(skipAnimations){this.debug(`AnimationManager - startBatch() with skipAnimations=${skipAnimations}.`),this.reset(),this.batch.destroy(),this.batch=new AnimationBatch(this.defaultDuration*1.5),skipAnimations===!0&&this.batch.skip()}endBatch(){this.batch.isActive()?(this.batch.ready(),this.requestAnimation()):(this.interactionManager.popState(1),this.batch.isSkipped()&&this.batch.skip(!1))}onBatchStop(cb){this.batch.stoppedCbs.add(cb)}destroy(){this.stop(),this.events.clear()}},__name(_a94,"AnimationManager"),_a94),_a95,AriaAnnouncementService=(_a95=class{constructor(localeManager,domManager,layoutManager){this.localeManager=localeManager,this.domManager=domManager,this.layoutManager=layoutManager,this.debug=Debug.create(!0,"aria"),this.destroyFns=[],this.liveElem=_a95.createAnnouncer(),this.domManager.addChild("canvas-proxy","ag-charts-canvas-proxy",this.liveElem),this.destroyFns.push(this.layoutManager.addListener("layout:complete",ev=>this.onResize(ev)),()=>this.domManager.removeChild("canvas-proxy","ag-charts-canvas-proxy"))}static createAnnouncer(){const e=getDocument().createElement("div");return e.classList.add("ag-charts-aria-announcer"),setAttribute(e,"role","status"),setAttribute(e,"aria-live","assertive"),e}destroy(){this.destroyFns.forEach(fn=>fn())}onResize(event){this.liveElem.style.width=`${event.chart.width}px`,this.liveElem.style.height=`${event.chart.height}px`}clear(){this.liveElem.textContent=" "}announceValue(id,params){const{localeManager,liveElem}=this,value=localeManager.t(id,params);this.debug(`AriaAnnouncementService - announceValue: ${value}`),this.clear(),setTimeout(()=>liveElem.innerText=value,16)}},__name(_a95,"_AriaAnnouncementService"),_a95),_a96,ChartEventManager=(_a96=class extends BaseManager{legendItemClick(series,itemId,enabled,legendItemName){const event={type:"legend-item-click",series,itemId,enabled,legendItemName};this.listeners.dispatch("legend-item-click",event)}legendItemDoubleClick(series,itemId,enabled,numVisibleItems,legendItemName){const event={type:"legend-item-double-click",series,itemId,enabled,legendItemName,numVisibleItems};this.listeners.dispatch("legend-item-double-click",event)}axisHover(axisId,direction){const event={type:"axis-hover",axisId,direction};this.listeners.dispatch("axis-hover",event)}},__name(_a96,"ChartEventManager"),_a96),_a97,ContextMenuRegistry=(_a97=class{constructor(regionManager){this.defaultActions=[],this.disabledActions=new Set,this.hiddenActions=new Set,this.listeners=new Listeners;const{Default:Default2,ContextMenu}=InteractionState;this.destroyFns=[regionManager.listenAll("contextmenu",e=>this.onContextMenu(e),Default2|ContextMenu)]}destroy(){this.destroyFns.forEach(d=>d())}onContextMenu(event){_a97.toContextType(event.region)==="all"&&this.dispatchContext("all",event,{})}static toContextType(region){return region==="legend"||region==="series"?region:"all"}static check(type,event){return event.type===type}static checkCallback(desiredType,type,_callback){return desiredType===type}dispatchContext(type,pointerEvent,context,position){const{sourceEvent}=pointerEvent,x=(position==null?void 0:position.x)??pointerEvent.offsetX,y=(position==null?void 0:position.y)??pointerEvent.offsetY;this.listeners.dispatch("",buildPreventable({type,x,y,context,sourceEvent}))}addListener(handler){return this.listeners.addListener("",handler)}filterActions(type){return this.defaultActions.filter(action=>action.id&&!this.hiddenActions.has(action.id)&&["all",type].includes(action.type))}registerDefaultAction(action){const didAdd=action.id!=null&&!this.defaultActions.some(({id})=>id===action.id);return didAdd&&this.defaultActions.push(action),()=>{const index=didAdd?this.defaultActions.findIndex(({id})=>id===action.id):-1;index!==-1&&this.defaultActions.splice(index,1)}}enableAction(actionId){this.disabledActions.delete(actionId)}disableAction(actionId){this.disabledActions.add(actionId)}setActionVisiblity(actionId,visible){visible?this.hiddenActions.delete(actionId):this.hiddenActions.add(actionId)}isDisabled(actionId){return this.disabledActions.has(actionId)}},__name(_a97,"_ContextMenuRegistry"),_a97),_a98,StateTracker=(_a98=class extends Map{constructor(defaultValue,defaultState){super(),this.defaultValue=defaultValue,this.defaultState=defaultState}set(key,value){return this.delete(key),typeof value<"u"&&super.set(key,value),this}stateId(){return Array.from(this.keys()).pop()??this.defaultState}stateValue(){return Array.from(this.values()).pop()??this.defaultValue}},__name(_a98,"StateTracker"),_a98),Cursor=(Cursor2=>(Cursor2.Auto="auto",Cursor2.Default="default",Cursor2.Grab="grab",Cursor2.Grabbing="grabbing",Cursor2.Move="move",Cursor2.NotAllowed="not-allowed",Cursor2.Pointer="pointer",Cursor2.EWResize="ew-resize",Cursor2.NSResize="ns-resize",Cursor2.ZoomIn="zoom-in",Cursor2.ZoomOut="zoom-out",Cursor2))(Cursor||{}),_a99,CursorManager=(_a99=class{constructor(domManager){this.domManager=domManager,this.stateTracker=new StateTracker("default")}updateCursor(callerId,style){this.stateTracker.set(callerId,style),this.domManager.updateCursor(this.stateTracker.stateValue())}getCursor(){return this.domManager.getCursor()}},__name(_a99,"CursorManager"),_a99);function distanceSquared(finger1,finger2){const dx=finger1.screenX-finger2.screenX,dy=finger1.screenY-finger2.screenY;return dx*dx+dy*dy}__name(distanceSquared,"distanceSquared");function distance(finger1,finger2){return Math.sqrt(distanceSquared(finger1,finger2))}__name(distance,"distance");var MIN_DISTANCE_TO_START_PINCH=1,_a100,GestureDetector=(_a100=class extends BaseManager{constructor(domManager){super(),this.domManager=domManager,this.touchstart=event=>this.onTouchStart(event),this.touchmove=event=>this.onTouchMove(event),this.touchend=event=>this.onTouchEnd(event),this.touchcancel=event=>this.onTouchCancel(event),this.pinch={finger1:{identifier:NaN,screenX:NaN,screenY:NaN},finger2:{identifier:NaN,screenX:NaN,screenY:NaN},origin:{x:NaN,y:NaN},distance:NaN,status:0},this.domManager.addEventListener("touchstart",this.touchstart,{passive:!0}),this.domManager.addEventListener("touchmove",this.touchmove,{passive:!1}),this.domManager.addEventListener("touchend",this.touchend),this.domManager.addEventListener("touchcancel",this.touchcancel)}destroy(){this.domManager.removeEventListener("touchstart",this.touchstart),this.domManager.removeEventListener("touchmove",this.touchmove),this.domManager.removeEventListener("touchend",this.touchend),this.domManager.removeEventListener("touchcancel",this.touchcancel)}findPinchTouches(moveEvent){const{touches}=moveEvent,{finger1,finger2}=this.pinch;if(this.pinch.status!==0&&touches.length===2){if(touches[0].identifier===finger1.identifier&&touches[1].identifier===finger2.identifier)return[touches[0],touches[1]];if(touches[0].identifier===finger2.identifier&&touches[1].identifier===finger1.identifier)return[touches[1],touches[0]]}}copyTouchData(event){const keys=["identifier","screenX","screenY"];partialAssign(keys,this.pinch.finger1,event.touches[0]),partialAssign(keys,this.pinch.finger2,event.touches[1]),this.pinch.distance=distance(this.pinch.finger1,this.pinch.finger2)}dispatchPinchEvent(type,deltaDistance,sourceEvent){const{finger1,finger2,origin:origin2}=this.pinch;this.listeners.dispatch(type,buildPreventable({sourceEvent,type,finger1,finger2,deltaDistance,origin:origin2}))}onTouchStart(event){this.stopPinchTracking(event);const{pinch}=this;event.touches.length===2&&(pinch.status=1,this.copyTouchData(event),pinch.origin.x=(event.touches[0].clientX+event.touches[1].clientX)/2,pinch.origin.y=(event.touches[0].clientY+event.touches[1].clientY)/2)}onTouchMove(event){const pinchTouches=this.findPinchTouches(event);if(pinchTouches!==void 0){const[touch1,touch2]=pinchTouches,{pinch}=this,newDistance=distance(touch1,touch2),deltaDistance=newDistance-pinch.distance;pinch.status===1?Math.abs(deltaDistance)>MIN_DISTANCE_TO_START_PINCH&&(pinch.status=2,this.copyTouchData(event),this.dispatchPinchEvent("pinch-start",0,event)):pinch.status===2?(pinch.distance=newDistance,this.copyTouchData(event),this.dispatchPinchEvent("pinch-move",deltaDistance,event)):Logger.error(`unexpected pinch.status: ${pinch.status}`)}}onTouchEnd(event){this.stopPinchTracking(event)}onTouchCancel(event){this.stopPinchTracking(event)}stopPinchTracking(event){const{pinch}=this;pinch.status===2&&this.dispatchPinchEvent("pinch-end",0,event),this.pinch.status=0}},__name(_a100,"GestureDetector"),_a100),_a101,HighlightManager=(_a101=class extends BaseManager{constructor(){super(...arguments),this.highlightStates=new StateTracker}updateHighlight(callerId,highlightedDatum){const{activeHighlight:previousHighlight}=this;this.highlightStates.set(callerId,highlightedDatum),this.activeHighlight=this.highlightStates.stateValue(),this.isEqual(this.activeHighlight,previousHighlight)||this.listeners.dispatch("highlight-change",{type:"highlight-change",currentHighlight:this.activeHighlight,previousHighlight,callerId})}getActiveHighlight(){return this.activeHighlight}isEqual(a,b){return a===b||a!=null&&b!=null&&(a==null?void 0:a.series)===(b==null?void 0:b.series)&&(a==null?void 0:a.itemId)===(b==null?void 0:b.itemId)&&(a==null?void 0:a.datum)===(b==null?void 0:b.datum)}},__name(_a101,"HighlightManager"),_a101),_a102,KeyNavManager=(_a102=class extends InteractionStateListener{constructor(interactionManager){super(),this.interactionManager=interactionManager,this.hasBrowserFocus=!1,this.isMouseBlurred=!1,this.isClicking=!1,this.destroyFns.push(interactionManager.addListener("drag-start",e=>this.onClickStart(e),31),interactionManager.addListener("click",e=>this.onClickStop(e),31),interactionManager.addListener("drag-end",e=>this.onClickStop(e),31),interactionManager.addListener("contextmenu",e=>this.onClickStop(e),31),interactionManager.addListener("wheel",e=>this.mouseBlur(e)),interactionManager.addListener("hover",e=>this.mouseBlur(e)),interactionManager.addListener("drag",e=>this.mouseBlur(e)),interactionManager.addListener("blur",e=>this.onBlur(e),31),interactionManager.addListener("focus",e=>this.onFocus(e),31),interactionManager.addListener("keydown",e=>this.onKeyDown(e),31))}getState(){return this.interactionManager.getState()}destroy(){super.destroy()}onClickStart(event){this.isClicking=!0,this.mouseBlur(event)}onClickStop(event){this.mouseBlur(event),this.isClicking=!1}mouseBlur(event){this.hasBrowserFocus&&(this.isMouseBlurred||(this.dispatch("blur",0,event),this.isMouseBlurred=!0))}onBlur(event){this.hasBrowserFocus=!1,this.isMouseBlurred=!1,this.dispatch("blur",0,event)}onFocus(event){if(this.hasBrowserFocus=!0,this.isClicking){this.isMouseBlurred=!0;return}this.dispatch("focus",0,event)}onKeyDown(event){if(!this.hasBrowserFocus)return;this.isMouseBlurred=!1;const{code,altKey,shiftKey,metaKey,ctrlKey}=event.sourceEvent;if(!(altKey||shiftKey||metaKey||ctrlKey)){switch(code){case"ArrowDown":return this.dispatch("nav-vert",1,event);case"ArrowUp":return this.dispatch("nav-vert",-1,event);case"ArrowLeft":return this.dispatch("nav-hori",-1,event);case"ArrowRight":return this.dispatch("nav-hori",1,event);case"ZoomIn":case"Add":return this.dispatch("nav-zoom",1,event);case"ZoomOut":case"Substract":return this.dispatch("nav-zoom",-1,event);case"Space":case"Enter":return this.dispatch("submit",0,event);case"Escape":return this.dispatch("cancel",0,event);case"Backspace":case"Delete":return this.dispatch("delete",0,event)}switch(event.sourceEvent.key){case"+":return this.dispatch("nav-zoom",1,event);case"-":return this.dispatch("nav-zoom",-1,event)}}}dispatch(type,delta4,sourceEvent){dispatchTypedEvent(this.listeners,{type,delta:delta4,sourceEvent})}},__name(_a102,"KeyNavManager"),_a102),REGIONS=(REGIONS2=>(REGIONS2.TITLE="title",REGIONS2.SUBTITLE="subtitle",REGIONS2.FOOTNOTE="footnote",REGIONS2.LEGEND="legend",REGIONS2.NAVIGATOR="navigator",REGIONS2.PAGINATION="pagination",REGIONS2.ROOT="root",REGIONS2.SERIES="series",REGIONS2.HORIZONTAL_AXES="horizontal-axes",REGIONS2.VERTICAL_AXES="vertical-axes",REGIONS2.TOOLBAR="toolbar",REGIONS2))(REGIONS||{}),_a103,NodeRegionBBoxProvider=(_a103=class{constructor(node,overrideId){this.node=node,this.overrideId=overrideId}get id(){return this.overrideId??this.node.id}get visible(){return this.node.visible}toCanvasBBox(){return Transformable.toCanvas(this.node)}fromCanvasPoint(x,y){return Transformable.fromCanvasPoint(this.node,x,y)}},__name(_a103,"NodeRegionBBoxProvider"),_a103),_a104,SimpleRegionBBoxProvider=(_a104=class extends NodeRegionBBoxProvider{constructor(node,bboxFn,overrideId){super(node,overrideId),this.bboxFn=bboxFn}toCanvasBBox(){return this.bboxFn()}},__name(_a104,"SimpleRegionBBoxProvider"),_a104),_a105,RegionListeners=(_a105=class extends Listeners{},__name(_a105,"RegionListeners"),_a105);function addHandler(listeners,interactionManager,type,handler,triggeringStates=16){return(listeners==null?void 0:listeners.addListener(type,e=>{interactionManager.getState()&triggeringStates&&handler(e)}))??(()=>{})}__name(addHandler,"addHandler");function nodeToBBoxProvider(node){return node instanceof Node?new NodeRegionBBoxProvider(node):node instanceof NodeRegionBBoxProvider?node:new NodeRegionBBoxProvider(node.node,node.id)}__name(nodeToBBoxProvider,"nodeToBBoxProvider");var _a106,RegionManager=(_a106=class{constructor(interactionManager,focusIndicator){this.interactionManager=interactionManager,this.focusIndicator=focusIndicator,this.debug=Debug.create(!0,"region"),this.isDragging=!1,this.leftCanvas=!1,this.regions=new Map,this.destroyFns=[],this.allRegionsListeners=new RegionListeners,this.destroyFns.push(...POINTER_INTERACTION_TYPES.map(eventName=>interactionManager.addListener(eventName,this.processPointerEvent.bind(this),31)))}destroy(){this.destroyFns.forEach(fn=>fn()),this.current=void 0;for(const region of this.regions.values())region.listeners.destroy();this.focusIndicator.destroy(),this.regions.clear()}addRegion(name,...nodes){if(this.regions.has(name))throw new Error(`AG Charts - Region: ${name} already exists`);const region={properties:{name,bboxproviders:nodes.map(nodeToBBoxProvider)},listeners:new RegionListeners};return this.regions.set(name,region),this.makeObserver(region)}updateRegion(name,...nodes){const region=this.regions.get(name);if(region)region.properties.bboxproviders=nodes.map(nodeToBBoxProvider);else throw new Error("AG Charts - unknown region: "+name)}getRegion(name){return this.makeObserver(this.regions.get(name))}listenAll(type,handler,triggeringStates=16){return addHandler(this.allRegionsListeners,this.interactionManager,type,handler,triggeringStates)}makeObserver(region){const{interactionManager}=this,_ObservableRegionImplementation=class _ObservableRegionImplementation{addListener(type,handler,triggeringStates=16){return addHandler(region==null?void 0:region.listeners,interactionManager,type,handler,triggeringStates)}};__name(_ObservableRegionImplementation,"ObservableRegionImplementation");let ObservableRegionImplementation=_ObservableRegionImplementation;return new ObservableRegionImplementation}checkPointerHistory(targetRegion,event){for(const historyEvent of event.pointerHistory){const{region:historyRegion}=this.pickRegion(historyEvent.offsetX,historyEvent.offsetY)??{};if(targetRegion.properties.name!==(historyRegion==null?void 0:historyRegion.properties.name))return!1}return!0}dispatch(current,partialEvent){var _a274;if(current==null)return;const mainBBoxProvider=current.region.properties.bboxproviders[0];let regionOffsetX=0,regionOffsetY=0;if("offsetX"in partialEvent&&"offsetY"in partialEvent)({x:regionOffsetX,y:regionOffsetY}=mainBBoxProvider.fromCanvasPoint(partialEvent.offsetX,partialEvent.offsetY));else{const regionBBox=mainBBoxProvider.toCanvasBBox();regionOffsetX=regionBBox.width/2,regionOffsetY=regionBBox.height/2}const event=buildPreventable({...partialEvent,region:current.region.properties.name,bboxProviderId:(_a274=current.bboxProvider)==null?void 0:_a274.id,regionOffsetX,regionOffsetY});this.debug("Dispatching region event: ",event),this.allRegionsListeners.dispatch(event.type,event),current.region.listeners.dispatch(event.type,event)}handleDragging(event){const{current}=this;switch(event.type){case"drag-start":this.isDragging=!0,this.leftCanvas=!1;break;case"leave":return this.leftCanvas=!0,this.isDragging;case"enter":return this.leftCanvas=!1,this.isDragging;case"drag":if(this.isDragging)return this.dispatch(current,event),!0;break;case"drag-end":if(this.isDragging)return this.isDragging=!1,this.dispatch(current,event),this.leftCanvas&&this.dispatch(current,{...event,type:"leave"}),!0;break}return!1}processPointerEvent(event){if(this.handleDragging(event))return;const{current}=this;if(event.type==="leave"){this.dispatch(current,{...event,type:"leave"}),this.current=void 0;return}const newCurrent=this.pickRegion(event.offsetX,event.offsetY),newRegion=newCurrent==null?void 0:newCurrent.region;current!==void 0&&(newRegion==null?void 0:newRegion.properties.name)!==current.region.properties.name&&this.dispatch(current,{...event,type:"leave"}),newRegion!==void 0&&newRegion.properties.name!==(current==null?void 0:current.region.properties.name)&&this.dispatch(newCurrent,{...event,type:"enter"}),newRegion!==void 0&&this.checkPointerHistory(newRegion,event)&&this.dispatch(newCurrent,event),this.current=newCurrent}pickRegion(x,y){let currentArea=1/0,currentRegion,currentBBoxProvider;for(const region of this.regions.values())for(const provider of region.properties.bboxproviders){if(provider.visible===!1)continue;const bbox=provider.toCanvasBBox(),area2=bbox.width*bbox.height;area2<currentArea&&bbox.containsPoint(x,y)&&(currentArea=area2,currentRegion=region,currentBBoxProvider=provider)}return currentRegion?{region:currentRegion,bboxProvider:currentBBoxProvider}:void 0}},__name(_a106,"RegionManager"),_a106),TOOLBAR_ALIGNMENTS=["start","center","end"],TOOLBAR_GROUPS=["seriesType","annotations","annotationOptions","ranges","zoom"],TOOLBAR_GROUP_ORDERING={seriesType:0,annotations:1,annotationOptions:2,ranges:3,zoom:4},ToolbarPosition=(ToolbarPosition2=>(ToolbarPosition2.Top="top",ToolbarPosition2.Left="left",ToolbarPosition2.Right="right",ToolbarPosition2.Bottom="bottom",ToolbarPosition2.Floating="floating",ToolbarPosition2.FloatingTop="floating-top",ToolbarPosition2.FloatingBottom="floating-bottom",ToolbarPosition2))(ToolbarPosition||{}),TOOLBAR_POSITIONS=Object.values(ToolbarPosition);function isAnimatingFloatingPosition(position){return["floating-top","floating-bottom"].includes(position)}__name(isAnimatingFloatingPosition,"isAnimatingFloatingPosition");var _a107,ToolbarManager=(_a107=class extends BaseManager{static isGroup(group,event){return event.group===group}static isChildElement(domManager,element2){for(const position of TOOLBAR_POSITIONS)if(domManager.isManagedChildDOMElement(element2,"canvas-overlay",`toolbar-${position}`))return!0;return!1}pressButton(group,id,value,rect,sourceEvent){this.listeners.dispatch("button-pressed",{type:"button-pressed",group,id,value,rect,sourceEvent})}cancel(group){this.listeners.dispatch("cancelled",{type:"cancelled",group})}toggleButton(group,id,options){const{active=!1,enabled=!0,visible=!0,checked=!1}=options;this.listeners.dispatch("button-toggled",{type:"button-toggled",group,id,active,enabled,visible,checked})}updateButton(group,id,options){this.listeners.dispatch("button-updated",{type:"button-updated",group,id,...options})}toggleGroup(caller,group,options){const{active,visible}=options;this.listeners.dispatch("group-toggled",{type:"group-toggled",caller,group,active,visible})}updateGroup(group){this.listeners.dispatch("group-updated",{type:"group-updated",group})}groupMoved(group){this.listeners.dispatch("group-moved",{type:"group-moved",group})}changeFloatingAnchor(group,anchor){this.listeners.dispatch("floating-anchor-changed",{type:"floating-anchor-changed",group,anchor})}buttonMoved(group,value,rect,groupRect){this.listeners.dispatch("button-moved",{type:"button-moved",group,value,rect,groupRect})}proxyGroupOptions(caller,group,options){this.listeners.dispatch("proxy-group-options",{type:"proxy-group-options",caller,group,options})}},__name(_a107,"ToolbarManager"),_a107),_a108,TooltipManager=(_a108=class{constructor(domManager,tooltip){this.domManager=domManager,this.tooltip=tooltip,this.stateTracker=new StateTracker,this.suppressState=new StateTracker(!1),this.appliedState=null,tooltip.setup(domManager),domManager.addListener("hidden",()=>this.tooltip.toggle(!1))}updateTooltip(callerId,meta,content){var _a274;this.tooltip.enabled&&(content??(content=(_a274=this.stateTracker.get(callerId))==null?void 0:_a274.content),this.stateTracker.set(callerId,{content,meta}),this.applyStates())}removeTooltip(callerId){this.tooltip.enabled&&(this.stateTracker.delete(callerId),this.applyStates())}suppressTooltip(callerId){this.suppressState.set(callerId,!0)}unsuppressTooltip(callerId){this.suppressState.delete(callerId)}getTooltipMeta(callerId){var _a274;return(_a274=this.stateTracker.get(callerId))==null?void 0:_a274.meta}destroy(){this.domManager.removeStyles("tooltip")}applyStates(){var _a274;const id=this.stateTracker.stateId(),state=id?this.stateTracker.get(id):null;if(this.suppressState.stateValue()||(state==null?void 0:state.meta)==null||(state==null?void 0:state.content)==null){this.appliedState=null,this.tooltip.toggle(!1);return}const canvasRect=this.domManager.getBoundingClientRect(),boundingRect=this.tooltip.bounds==="extended"?this.domManager.getOverlayClientRect():canvasRect;if(((_a274=this.appliedState)==null?void 0:_a274.content)===(state==null?void 0:state.content)){const renderInstantly=this.tooltip.isVisible();this.tooltip.show(boundingRect,canvasRect,state==null?void 0:state.meta,null,renderInstantly)}else this.tooltip.show(boundingRect,canvasRect,state==null?void 0:state.meta,state==null?void 0:state.content);this.appliedState=state}static makeTooltipMeta(event,datum){var _a274,_b,_c,_d;const{offsetX,offsetY}=event,{tooltip}=datum.series.properties,meta={offsetX,offsetY,enableInteraction:((_a274=tooltip.interaction)==null?void 0:_a274.enabled)??!1,lastPointerEvent:{type:event.type,offsetX,offsetY},showArrow:tooltip.showArrow,position:{type:tooltip.position.type,xOffset:tooltip.position.xOffset,yOffset:tooltip.position.yOffset}},refPoint=((_b=datum.yBar)==null?void 0:_b.upperPoint)??datum.midPoint??((_d=(_c=datum.series).datumMidPoint)==null?void 0:_d.call(_c,datum));if(tooltip.position.type==="node"&&refPoint){const{x,y}=refPoint,point=Transformable.toCanvasPoint(datum.series.contentGroup,x,y);return{...meta,offsetX:Math.round(point.x),offsetY:Math.round(point.y)}}return meta}},__name(_a108,"TooltipManager"),_a108),_a109,ZoomManager=(_a109=class extends BaseManager{constructor(){super(...arguments),this.mementoOriginatorKey="zoom",this.axisZoomManagers=new Map,this.state=new StateTracker(void 0,"initial"),this.rejectCallbacks=new Map}addLayoutListeners(layoutManager){this.destroyFns.push(layoutManager.addListener("layout:complete",event=>{this.axes=event.axes}))}createMemento(){const zoom2=this.getDefinedZoom();return{rangeX:this.getRangeDirection(zoom2,"x"),rangeY:this.getRangeDirection(zoom2,"y"),ratioX:{start:zoom2.x.min,end:zoom2.x.max},ratioY:{start:zoom2.y.min,end:zoom2.y.max}}}guardMemento(blob){return isObject(blob)&&(blob.ratioX!=null||blob.ratioY!=null||blob.rangeX!=null||blob.rangeY!=null)}restoreMemento(_version,_mementoVersion,memento){this.listeners.dispatch("restore-zoom",{...memento,type:"restore-zoom"})}updateAxes(axes){const zoomManagers=new Map(axes.map(axis=>[axis.id,this.axisZoomManagers.get(axis.id)]));this.axisZoomManagers.clear();for(const axis of axes)this.axisZoomManagers.set(axis.id,zoomManagers.get(axis.id)??new AxisZoomManager(axis));this.state.size>0&&axes.length>0&&this.updateZoom(this.state.stateId(),this.state.stateValue())}updateZoom(callerId,newZoom,canChangeInitial=!0,rejectCallback){var _a274;if(rejectCallback&&this.rejectCallbacks.set(callerId,rejectCallback),this.axisZoomManagers.size===0){const stateId=this.state.stateId();stateId==="initial"||stateId===callerId||canChangeInitial?(this.state.set(callerId,newZoom),stateId!==callerId&&((_a274=this.rejectCallbacks.get(stateId))==null||_a274(callerId))):rejectCallback==null||rejectCallback(stateId);return}this.state.set(callerId,newZoom),this.axisZoomManagers.forEach(axis=>{axis.updateZoom(callerId,newZoom==null?void 0:newZoom[axis.getDirection()])}),this.applyChanges(callerId)}updateAxisZoom(callerId,axisId,newZoom){var _a274;(_a274=this.axisZoomManagers.get(axisId))==null||_a274.updateZoom(callerId,newZoom),this.applyChanges(callerId)}fireZoomPanStartEvent(callerId){this.listeners.dispatch("zoom-pan-start",{type:"zoom-pan-start",callerId})}getZoom(){let x,y;if(this.axisZoomManagers.forEach(axis=>{axis.getDirection()==="x"?x??(x=axis.getZoom()):axis.getDirection()==="y"&&(y??(y=axis.getZoom()))}),x||y)return{x,y}}getAxisZoom(axisId){var _a274;return((_a274=this.axisZoomManagers.get(axisId))==null?void 0:_a274.getZoom())??{min:0,max:1}}getAxisZooms(){const axes={};for(const[axisId,axis]of this.axisZoomManagers.entries())axes[axisId]={direction:axis.getDirection(),zoom:axis.getZoom()};return axes}applyChanges(callerId){if(!Array.from(this.axisZoomManagers.values(),axis=>axis.applyChanges()).some(Boolean))return;const axes={};for(const[axisId,axis]of this.axisZoomManagers.entries())axes[axisId]=axis.getZoom();this.listeners.dispatch("zoom-change",{type:"zoom-change",...this.getZoom(),axes,callerId})}getRangeDirection(zoom2,direction){var _a274,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l,_m,_n;for(const axis of this.axes??[]){if(axis.direction!==direction)continue;const domain=(_b=(_a274=axis.scale).getDomain)==null?void 0:_b.call(_a274),d0=(_d=(_c=axis.scale).convert)==null?void 0:_d.call(_c,domain==null?void 0:domain.at(0)),d1=(_f=(_e=axis.scale).convert)==null?void 0:_f.call(_e,domain==null?void 0:domain.at(-1));if(!isFiniteNumber(d0)||!isFiniteNumber(d1))return;let start,end;if(d0<=d1){const diff2=d1-d0;start=(_h=(_g=axis.scale).invert)==null?void 0:_h.call(_g,0),end=(_j=(_i=axis.scale).invert)==null?void 0:_j.call(_i,d0+diff2*zoom2[direction].max)}else{const diff2=d0-d1;start=(_l=(_k=axis.scale).invert)==null?void 0:_l.call(_k,d0-diff2*zoom2[direction].min),end=(_n=(_m=axis.scale).invert)==null?void 0:_n.call(_m,0)}return{start,end}}}getDefinedZoom(){var _a274,_b,_c,_d;const zoom2=this.getZoom();return{x:{min:((_a274=zoom2==null?void 0:zoom2.x)==null?void 0:_a274.min)??0,max:((_b=zoom2==null?void 0:zoom2.x)==null?void 0:_b.max)??1},y:{min:((_c=zoom2==null?void 0:zoom2.y)==null?void 0:_c.min)??0,max:((_d=zoom2==null?void 0:zoom2.y)==null?void 0:_d.max)??1}}}},__name(_a109,"ZoomManager"),_a109),_a110,AxisZoomManager=(_a110=class{constructor(axis){this.axis=axis;const[min=0,max=1]=axis.visibleRange;this.state=new StateTracker({min,max}),this.currentZoom=this.state.stateValue()}getDirection(){return this.axis.direction}updateZoom(callerId,newZoom){this.state.set(callerId,newZoom)}getZoom(){return deepClone(this.state.stateValue())}applyChanges(){const prevZoom=this.currentZoom;return this.currentZoom=this.state.stateValue(),prevZoom.min!==this.currentZoom.min||prevZoom.max!==this.currentZoom.max}},__name(_a110,"AxisZoomManager"),_a110),_a111,SeriesStateManager=(_a111=class{constructor(){this.groups={}}registerSeries({id,seriesGrouping,visible,type}){var _a274;seriesGrouping&&((_a274=this.groups)[type]??(_a274[type]={}),this.groups[type][id]={grouping:seriesGrouping,visible})}deregisterSeries({id,type}){this.groups[type]&&delete this.groups[type][id],this.groups[type]&&Object.keys(this.groups[type]).length===0&&delete this.groups[type]}getVisiblePeerGroupIndex({type,seriesGrouping,visible}){if(!seriesGrouping)return{visibleGroupCount:visible?1:0,visibleSameStackCount:visible?1:0,index:0};const visibleGroupsSet=new Set,visibleSameStackSet=new Set;for(const entry of Object.values(this.groups[type]??{}))entry.visible&&(visibleGroupsSet.add(entry.grouping.groupIndex),entry.grouping.groupIndex===seriesGrouping.groupIndex&&visibleSameStackSet.add(entry.grouping.stackIndex));const visibleGroups=Array.from(visibleGroupsSet);return visibleGroups.sort((a,b)=>a-b),{visibleGroupCount:visibleGroups.length,visibleSameStackCount:visibleSameStackSet.size,index:visibleGroups.indexOf(seriesGrouping.groupIndex)}}},__name(_a111,"SeriesStateManager"),_a111),ChartUpdateType=(ChartUpdateType3=>(ChartUpdateType3[ChartUpdateType3.FULL=0]="FULL",ChartUpdateType3[ChartUpdateType3.UPDATE_DATA=1]="UPDATE_DATA",ChartUpdateType3[ChartUpdateType3.PROCESS_DATA=2]="PROCESS_DATA",ChartUpdateType3[ChartUpdateType3.PERFORM_LAYOUT=3]="PERFORM_LAYOUT",ChartUpdateType3[ChartUpdateType3.SERIES_UPDATE=4]="SERIES_UPDATE",ChartUpdateType3[ChartUpdateType3.PRE_SCENE_RENDER=5]="PRE_SCENE_RENDER",ChartUpdateType3[ChartUpdateType3.SCENE_RENDER=6]="SCENE_RENDER",ChartUpdateType3[ChartUpdateType3.NONE=7]="NONE",ChartUpdateType3))(ChartUpdateType||{}),_a112,UpdateService=(_a112=class extends Listeners{constructor(updateCallback){super(),this.updateCallback=updateCallback}update(type=0,options){this.updateCallback(type,options)}dispatchUpdateComplete(rects){this.dispatch("update-complete",{type:"update-complete",minRect:rects==null?void 0:rects.minRect,minVisibleRect:rects==null?void 0:rects.minVisibleRect})}dispatchPreDomUpdate(){this.dispatch("pre-dom-update",{type:"pre-dom-update"})}dispatchPreSceneRender(rects){this.dispatch("pre-scene-render",{type:"pre-scene-render",...rects})}},__name(_a112,"UpdateService"),_a112),_a113,ChartContext=(_a113=class{constructor(chart,vars){this.callbackCache=new CallbackCache,this.chartEventManager=new ChartEventManager,this.highlightManager=new HighlightManager,this.layoutManager=new LayoutManager,this.localeManager=new LocaleManager,this.seriesStateManager=new SeriesStateManager,this.stateManager=new StateManager,this.toolbarManager=new ToolbarManager,this.zoomManager=new ZoomManager;const{scene,root,syncManager,container,updateCallback,updateMutex,pixelRatio}=vars;this.chartService=chart,this.syncManager=syncManager,this.domManager=new DOMManager(container);const canvasElement=this.domManager.addChild("canvas","scene-canvas",scene==null?void 0:scene.canvas.element);this.scene=scene??new Scene({pixelRatio,canvasElement}),this.scene.setRoot(root),this.axisManager=new AxisManager(root),this.annotationManager=new AnnotationManager(chart.annotationRoot),this.cursorManager=new CursorManager(this.domManager),this.interactionManager=new InteractionManager(chart.keyboard,this.domManager),this.keyNavManager=new KeyNavManager(this.interactionManager),this.focusIndicator=new FocusIndicator(this.domManager),this.regionManager=new RegionManager(this.interactionManager,this.focusIndicator),this.contextMenuRegistry=new ContextMenuRegistry(this.regionManager),this.gestureDetector=new GestureDetector(this.domManager),this.ariaAnnouncementService=new AriaAnnouncementService(this.localeManager,this.domManager,this.layoutManager),this.updateService=new UpdateService(updateCallback),this.proxyInteractionService=new ProxyInteractionService(this.updateService,this.localeManager,this.domManager,this.focusIndicator),this.historyManager=new HistoryManager(this.domManager),this.animationManager=new AnimationManager(this.interactionManager,updateMutex),this.dataService=new DataService(this.animationManager),this.tooltipManager=new TooltipManager(this.domManager,chart.tooltip),this.zoomManager.addLayoutListeners(this.layoutManager)}destroy(){this.animationManager.destroy(),this.ariaAnnouncementService.destroy(),this.axisManager.destroy(),this.callbackCache.invalidateCache(),this.chartEventManager.destroy(),this.contextMenuRegistry.destroy(),this.domManager.destroy(),this.focusIndicator.destroy(),this.highlightManager.destroy(),this.interactionManager.destroy(),this.keyNavManager.destroy(),this.proxyInteractionService.destroy(),this.regionManager.destroy(),this.syncManager.destroy(),this.tooltipManager.destroy(),this.zoomManager.destroy()}},__name(_a113,"ChartContext"),_a113),_a114,ChartHighlight=(_a114=class extends BaseProperties{constructor(){super(...arguments),this.range="tooltip"}},__name(_a114,"ChartHighlight"),_a114);__decorateClass([Validate(UNION(["tooltip","node"],"a range"))],ChartHighlight.prototype,"range",2);var _a115,DiscreteDomain=(_a115=class{constructor(){this.domain=new Set}static is(value){return value instanceof _a115}extend(val){this.domain.add(val)}getDomain(){return Array.from(this.domain)}},__name(_a115,"_DiscreteDomain"),_a115),_a116,ContinuousDomain=(_a116=class{constructor(){this.domain=[1/0,-1/0]}static is(value){return value instanceof _a116}static extendDomain(values,domain=[1/0,-1/0]){for(const value of values)typeof value=="number"&&(domain[0]>value&&(domain[0]=value),domain[1]<value&&(domain[1]=value));return domain}extend(value){this.domain[0]>value&&(this.domain[0]=value),this.domain[1]<value&&(this.domain[1]=value)}getDomain(){return[...this.domain]}},__name(_a116,"_ContinuousDomain"),_a116);function toKeyString(keys){return keys.map(key=>isObject(key)?JSON.stringify(key):key).join("-")}__name(toKeyString,"toKeyString");function round2(val){return Number.isInteger(val)?val:Math.abs(val)>1e4?Math.trunc(val):Math.round(val*1e4)/1e4}__name(round2,"round2");function fixNumericExtent(extent2){if(extent2==null)return[];const[min,max]=extent2.map(Number);return min===0&&max===0?[0,1]:isFiniteNumber(min)&&isFiniteNumber(max)?[min,max]:[]}__name(fixNumericExtent,"fixNumericExtent");function getMissCount(scopeProvider,missMap){return(missMap==null?void 0:missMap.get(scopeProvider.id))??0}__name(getMissCount,"getMissCount");var INVALID_VALUE=Symbol("invalid");function getPathComponents(path){const components=[];let matchIndex=0,matchGroup;const regExp=/((?:(?:^|\.)\s*\w+|\[\s*(?:'(?:[^']|\\')*'|"(?:[^"]|\\")*"|-?\d+)\s*\])\s*)/g;for(;matchGroup=regExp.exec(path);){if(matchGroup.index!==matchIndex)return;matchIndex=matchGroup.index+matchGroup[0].length;const match=matchGroup[1].trim();if(match.startsWith("."))components.push(match.slice(1).trim());else if(match.startsWith("[")){const accessor=match.slice(1,-1).trim();accessor.startsWith("'")?components.push(accessor.slice(1,-1).replace(/\\'/g,"'")):accessor.startsWith('"')?components.push(accessor.slice(1,-1).replace(/\\"/g,'"')):components.push(accessor)}else components.push(match)}if(matchIndex===path.length)return components}__name(getPathComponents,"getPathComponents");function createPathAccessor(components){return datum=>{let current=datum;for(const component of components)current=current[component];return current}}__name(createPathAccessor,"createPathAccessor");var _a117,DataModel=(_a117=class{constructor(opts,mode="standalone"){this.opts=opts,this.mode=mode,this.debug=Debug.create(!0,"data-model"),this.scopeCache=new Map,this.keys=[],this.values=[],this.aggregates=[],this.groupProcessors=[],this.propertyProcessors=[],this.reducers=[],this.processors=[];let keys=!0;for(const next of opts.props){if(next.type==="key"&&!keys)throw new Error("AG Charts - internal config error: keys must come before values.");next.type==="value"&&keys&&(keys=!1)}const verifyMatchGroupId=__name(({matchGroupIds=[]})=>{for(const matchGroupId of matchGroupIds)if(this.values.every(def=>def.groupId!==matchGroupId))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${matchGroupId}).`)},"verifyMatchGroupId");for(const def of opts.props)switch(def.type){case"key":this.keys.push({...def,index:this.keys.length,missing:new Map});break;case"value":if(def.property==null)throw new Error(`AG Charts - internal config error: no properties specified for value definitions: ${JSON.stringify(def)}`);this.values.push({...def,index:this.values.length,missing:new Map});break;case"aggregate":verifyMatchGroupId(def),this.aggregates.push({...def,index:this.aggregates.length});break;case"group-value-processor":verifyMatchGroupId(def),this.groupProcessors.push({...def,index:this.groupProcessors.length});break;case"property-value-processor":this.propertyProcessors.push({...def,index:this.propertyProcessors.length});break;case"reducer":this.reducers.push({...def,index:this.reducers.length});break;case"processor":this.processors.push({...def,index:this.processors.length});break}}resolveProcessedDataDefById(scope,searchId){var _a274;const def=(_a274=this.scopeCache.get(scope.id))==null?void 0:_a274.get(searchId);if(!def)throw new Error(`AG Charts - didn't find property definition for [${searchId}, ${scope.id}]`);return{index:def.index,def}}resolveProcessedDataIndexById(scope,searchId){return this.resolveProcessedDataDefById(scope,searchId).index}resolveProcessedDataDefsByIds(scope,searchIds){return searchIds.map(searchId=>[searchId,this.resolveProcessedDataDefById(scope,searchId)])}resolveProcessedDataDefsValues(defs,{keys,values}){const result={};for(const[searchId,{index,def}]of defs){const processedData=def.type==="key"?keys:values;result[searchId]=processedData[index]}return result}getDomain(scope,searchId,type="value",processedData){const domains=this.getDomainsByType(type,processedData);return(domains==null?void 0:domains[this.resolveProcessedDataIndexById(scope,searchId)])??[]}getDomainsByType(type,processedData){switch(type){case"key":return processedData.domain.keys;case"value":return processedData.domain.values;case"aggregate":return processedData.domain.aggValues;case"group-value-processor":return processedData.domain.groups;default:return null}}processData(data,sources){var _a274;const{opts:{groupByKeys,groupByFn},aggregates,groupProcessors,reducers,processors,propertyProcessors}=this,start=performance.now();if(groupByKeys&&this.keys.length===0)return;let processedData=this.extractData(data,sources);if(groupByKeys?processedData=this.groupData(processedData):groupByFn&&(processedData=this.groupData(processedData,groupByFn(processedData))),groupProcessors.length>0&&this.postProcessGroups(processedData),aggregates.length>0&&this.aggregateData(processedData),propertyProcessors.length>0&&this.postProcessProperties(processedData),reducers.length>0&&this.reduceData(processedData),processors.length>0&&this.postProcessData(processedData),data.length>0){for(const def of iterate(this.keys,this.values))for(const[scope,missCount]of def.missing)if(missCount>=data.length){const scopeHint=scope==null?"":` for ${scope}`;Logger.warnOnce(`the key '${def.property}' was not found in any data element${scopeHint}.`)}}const end=performance.now();processedData.time=end-start,this.debug.check()&&logProcessedData(processedData),this.scopeCache.clear();for(const def of iterate(this.keys,this.values,this.aggregates))if(def.idsMap)for(const[scope,ids]of def.idsMap)for(const id of ids)if(!this.scopeCache.has(scope))this.scopeCache.set(scope,new Map([[id,def]]));else{if((_a274=this.scopeCache.get(scope))!=null&&_a274.has(id))throw new Error("duplicate definition ids on the same scope are not allowed.");this.scopeCache.get(scope).set(id,def)}return processedData}valueGroupIdxLookup({matchGroupIds}){const result=[];for(const[index,def]of this.values.entries())(!matchGroupIds||def.groupId&&matchGroupIds.includes(def.groupId))&&result.push(index);return result}valueIdxLookup(scopes,prop){const noScopesToMatch=scopes==null||scopes.length===0,propId=typeof prop=="string"?prop:prop.id,hasMatchingScopeId=__name(def=>{if(def.idsMap){for(const[scope,ids]of def.idsMap)if(scopes!=null&&scopes.includes(scope)&&ids.has(propId))return!0}return!1},"hasMatchingScopeId"),result=this.values.findIndex(def=>(def.scopes==null||noScopesToMatch&&!def.scopes.length||def.scopes.some(s=>scopes==null?void 0:scopes.includes(s)))&&(def.property===propId||def.id===propId||hasMatchingScopeId(def)));if(result===-1)throw new Error(`AG Charts - configuration error, unknown property ${JSON.stringify(prop)} in scope(s) ${JSON.stringify(scopes)}`);return result}extractData(data,sources){const{dataDomain,processValue,scopes,allScopesHaveSameDefs}=this.initDataDomainProcessor(),sourcesById=new Map(sources==null?void 0:sources.map(s=>[s.id,s])),{keys:keyDefs,values:valueDefs}=this,resultData=new Array(data.length);let resultDataIdx=0,partialValidDataCount=0;for(const[datumIdx,datum]of data.entries()){const sourceDatums={},validScopes=scopes.size>0?new Set(scopes):void 0,keys=new Array(keyDefs.length);let keyIdx=0,key;for(const def of keyDefs){if(key=processValue(def,datum,key),key===INVALID_VALUE)break;keys&&(keys[keyIdx++]=key)}if(key===INVALID_VALUE)continue;const values=valueDefs.length>0?new Array(valueDefs.length):void 0;let value;for(const[valueDefIdx,def]of valueDefs.entries()){for(const scope of def.scopes??scopes){const source=sourcesById.get(scope),valueDatum=(source==null?void 0:source.data[datumIdx])??datum;if(value=processValue(def,valueDatum,value,scope),!(value===INVALID_VALUE||!values)){if(source!=null&&def.includeProperty!==!1){const property=def.includeProperty&&def.id!=null?def.id:def.property;sourceDatums[scope]??(sourceDatums[scope]={}),sourceDatums[scope][property]=value}values[valueDefIdx]=value}}if(value===INVALID_VALUE){if(allScopesHaveSameDefs)break;for(const scope of def.scopes??scopes)validScopes==null||validScopes.delete(scope);if((validScopes==null?void 0:validScopes.size)===0)break}}if(value===INVALID_VALUE&&allScopesHaveSameDefs||(validScopes==null?void 0:validScopes.size)===0)continue;const result={datum:{...datum,...sourceDatums},keys,values};!allScopesHaveSameDefs&&validScopes&&validScopes.size<scopes.size&&(partialValidDataCount++,result.validScopes=new Set(validScopes)),resultData[resultDataIdx++]=result}resultData.length=resultDataIdx;const propertyDomain=__name(def=>{const defDomain=dataDomain.get(def),result=defDomain.getDomain();return ContinuousDomain.is(defDomain)&&result[0]>result[1]?[]:result},"propertyDomain");return{type:"ungrouped",input:{count:data.length},data:resultData,domain:{keys:keyDefs.map(propertyDomain),values:valueDefs.map(propertyDomain)},defs:{allScopesHaveSameDefs,keys:keyDefs,values:valueDefs},partialValidDataCount,time:0}}groupData(data,groupingFn){const processedData=new Map;for(const dataEntry of data.data){const{keys,values,datum,validScopes}=dataEntry,group=(groupingFn==null?void 0:groupingFn(dataEntry))??keys,groupStr=toKeyString(group);if(processedData.has(groupStr)){const existingData=processedData.get(groupStr);if(existingData.values.push(values),existingData.datum.push(datum),validScopes!=null&&existingData.validScopes!=null)for(const scope of existingData.validScopes)validScopes.has(scope)||existingData.validScopes.delete(scope)}else processedData.set(groupStr,{keys:group,values:[values],datum:[datum],validScopes})}const resultData=new Array(processedData.size),resultGroups=new Array(processedData.size);let dataIndex=0;for(const{keys,values,datum,validScopes}of processedData.values())(validScopes==null?void 0:validScopes.size)!==0&&(resultGroups[dataIndex]=keys,resultData[dataIndex++]={keys,values,datum,validScopes});return{...data,type:"grouped",data:resultData,domain:{...data.domain,groups:resultGroups}}}aggregateData(processedData){var _a274,_b,_c;const isUngrouped=processedData.type==="ungrouped";processedData.domain.aggValues=[];for(const[index,def]of this.aggregates.entries()){const indices=this.valueGroupIdxLookup(def),domain=[1/0,-1/0];for(const datum of processedData.data){if(datum.aggValues??(datum.aggValues=new Array(this.aggregates.length)),datum.validScopes)continue;const values=isUngrouped?[datum.values]:datum.values;let groupAggValues=((_a274=def.groupAggregateFunction)==null?void 0:_a274.call(def))??[1/0,-1/0];for(const distinctValues of values){const valuesToAgg=indices.map(valueIdx=>distinctValues[valueIdx]),valuesAgg=def.aggregateFunction(valuesToAgg,datum.keys);valuesAgg&&(groupAggValues=((_b=def.groupAggregateFunction)==null?void 0:_b.call(def,valuesAgg,groupAggValues))??ContinuousDomain.extendDomain(valuesAgg,groupAggValues))}const finalValues=(((_c=def.finalFunction)==null?void 0:_c.call(def,groupAggValues))??groupAggValues).map(v=>round2(v));datum.aggValues[index]=finalValues,ContinuousDomain.extendDomain(finalValues,domain)}processedData.domain.aggValues.push(domain)}}postProcessGroups(processedData){var _a274;const{groupProcessors}=this,affectedIndices=new Set,updatedDomains=new Map,groupProcessorIndices=new Map,groupProcessorInitFns=new Map;for(const processor of groupProcessors){const indices=this.valueGroupIdxLookup(processor);groupProcessorIndices.set(processor,indices),groupProcessorInitFns.set(processor,processor.adjust());for(const idx of indices){const isDiscrete=this.values[idx].valueType==="category";affectedIndices.add(idx),updatedDomains.set(idx,isDiscrete?new DiscreteDomain:new ContinuousDomain)}}const updateDomains=__name(values=>{var _a275;for(const valueIndex of affectedIndices)(_a275=updatedDomains.get(valueIndex))==null||_a275.extend(values[valueIndex])},"updateDomains");for(const group of processedData.data){for(const processor of groupProcessors){if(group.validScopes)continue;const valueIndexes=groupProcessorIndices.get(processor)??[],adjustFn=(_a274=groupProcessorInitFns.get(processor))==null?void 0:_a274();if(adjustFn)if(processedData.type==="grouped")for(const values of group.values)values&&adjustFn(values,valueIndexes);else group.values&&adjustFn(group.values,valueIndexes)}if(processedData.type==="grouped")for(const values of group.values)updateDomains(values);else updateDomains(group.values)}for(const[idx,dataDomain]of updatedDomains)processedData.domain.values[idx]=dataDomain.getDomain()}postProcessProperties(processedData){for(const{adjust,property,scopes}of this.propertyProcessors)adjust()(processedData,this.valueIdxLookup(scopes,property))}reduceData(processedData){var _a274;processedData.reduced??(processedData.reduced={});for(const def of this.reducers){const reducer=def.reducer();let accValue=def.initialValue;for(const datum of processedData.data)(!datum.validScopes||(_a274=def.scopes)!=null&&_a274.some(s=>{var _a275;return(_a275=datum.validScopes)==null?void 0:_a275.has(s)}))&&(accValue=reducer(accValue,datum));processedData.reduced[def.property]=accValue}}postProcessData(processedData){processedData.reduced??(processedData.reduced={});for(const def of this.processors)processedData.reduced[def.property]=def.calculate(processedData)}initDataDomainProcessor(){const{keys:keyDefs,values:valueDefs}=this,scopes=new Set;for(const valueDef of valueDefs)if(valueDef.scopes)for(const scope of valueDef.scopes)scopes.add(scope);const dataDomain=new Map,processorFns=new Map;let allScopesHaveSameDefs=!0;const initDataDomain=__name(()=>{for(const def of iterate(keyDefs,valueDefs))def.valueType==="category"?dataDomain.set(def,new DiscreteDomain):(dataDomain.set(def,new ContinuousDomain),allScopesHaveSameDefs&&(allScopesHaveSameDefs=(def.scopes??[]).length===scopes.size))},"initDataDomain");initDataDomain();const accessors=this.buildAccessors(iterate(keyDefs,valueDefs));return{dataDomain,processValue:__name((def,datum,previousDatum,scope)=>{var _a274,_b,_c;let valueInDatum,value;if(accessors.has(def.property)){try{value=accessors.get(def.property)(datum)}catch{}valueInDatum=value!=null}else valueInDatum=def.property in datum,value=valueInDatum?datum[def.property]:def.missingValue;def.forceValue!=null&&(value=valueInDatum&&isNegative(value)?-1*def.forceValue:def.forceValue,valueInDatum=!0);const missingValueDef="missingValue"in def;if(!valueInDatum&&!missingValueDef){const missCount=def.missing.get(scope)??0;def.missing.set(scope,missCount+1)}if(dataDomain.has(def)||initDataDomain(),valueInDatum&&((_a274=def.validation)==null?void 0:_a274.call(def,value,datum))===!1)if("invalidValue"in def)value=def.invalidValue;else return this.mode!=="integrated"&&Logger.warnOnce(`invalid value of type [${typeof value}] for [${def.scopes} / ${def.id}] ignored:`,`[${value}]`),INVALID_VALUE;return def.processor&&(processorFns.has(def)||processorFns.set(def,def.processor()),value=(_b=processorFns.get(def))==null?void 0:_b(value,previousDatum===INVALID_VALUE?void 0:previousDatum)),(_c=dataDomain.get(def))==null||_c.extend(value),value},"processValue"),initDataDomain,scopes,allScopesHaveSameDefs}}buildAccessors(defs){const result=new Map;if(this.mode==="integrated")return result;for(const def of defs){if(!(def.property.includes(".")||def.property.includes("[")))continue;const components=getPathComponents(def.property);if(components==null){Logger.warnOnce("Invalid property path [%s]",def.property);continue}const accessor=createPathAccessor(components);result.set(def.property,accessor)}return result}},__name(_a117,"DataModel"),_a117);function logProcessedData(processedData){const logValues=__name((name,data)=>{data.length>0&&(Logger.log(`DataModel.processData() - ${name}`),Logger.table(data))},"logValues");if(Logger.log("DataModel.processData() - processedData",processedData),logValues("Key Domains",processedData.domain.keys),logValues("Group Domains",processedData.domain.groups??[]),logValues("Value Domains",processedData.domain.values),logValues("Aggregate Domains",processedData.domain.aggValues??[]),processedData.type==="grouped"){const flattenedValues=processedData.data.reduce((acc,next)=>{const keys=next.keys??[],aggValues=next.aggValues??[],skipKeys=next.keys.map(()=>{}),skipAggValues=aggValues==null?void 0:aggValues.map(()=>{});return acc.push(...next.values.map((v,i)=>[...i===0?keys:skipKeys,...v??[],...i==0?aggValues:skipAggValues])),acc},[]);logValues("Values",flattenedValues)}else{const flattenedValues=processedData.data.reduce((acc,next)=>{const aggValues=next.aggValues??[];return acc.push([...next.keys,...next.values,...aggValues]),acc},[]);logValues("Values",flattenedValues)}}__name(logProcessedData,"logProcessedData");var _a118,_DataController=(_a118=class{constructor(mode){this.mode=mode,this.debug=Debug.create(!0,"data-model"),this.requested=[],this.status="setup"}async request(id,data,opts){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");return new Promise((resolve,reject)=>{this.requested.push({id,opts,data,resolve,reject})})}execute(){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");this.status="executed",this.debug("DataController.execute() - requested",this.requested);const valid=this.validateRequests(this.requested);this.debug("DataController.execute() - validated",valid);const merged=this.mergeRequested(valid);this.debug("DataController.execute() - merged",merged),this.debug.check()&&(getWindow().processedData=[]);const scopes=this.requested.map(({id})=>id),needsValueExtraction=this.hasMultipleDataSources(valid);for(const{opts,data,resolves,rejects,ids}of merged)try{const dataModel=new DataModel(opts,this.mode),processedData=dataModel.processData(data,valid);this.debug.check()&&getWindow("processedData").push(processedData),(processedData==null?void 0:processedData.partialValidDataCount)===0?resolves.forEach((resolve,requestIdx)=>resolve({dataModel,processedData:this.processScopedData(ids[requestIdx],processedData,scopes,needsValueExtraction)})):processedData?this.splitResult(dataModel,processedData,ids,resolves):rejects.forEach(cb=>cb(new Error("AG Charts - no processed data generated")))}catch(error){rejects.forEach(cb=>cb(error))}}hasMultipleDataSources(validRequests){if(validRequests.length){const[{data},...restRequests]=validRequests;return restRequests.some(v=>data!==v.data)}return!1}processScopedData(id,processedData,ids,needsValueExtraction){const extractDatum=__name(datum=>{if(Array.isArray(datum))return datum.map(extractDatum);const extracted=needsValueExtraction?{...datum,...datum[id]}:datum;for(const otherId of ids)delete extracted[otherId];return extracted},"extractDatum"),extractValues=__name(values=>Array.isArray(values)?values.map(extractValues):(values==null?void 0:values[id])??values,"extractValues");return{...processedData,data:processedData.data.map(datum=>{var _a274;return{...datum,datum:extractDatum(datum.datum),values:needsValueExtraction?(_a274=datum.values)==null?void 0:_a274.map(extractValues):datum.values}})}}validateRequests(requested){const valid=[];for(const[index,request]of requested.entries())index>0&&request.data.length!==requested[0].data.length&&request.opts.groupByData===!1?request.reject(new Error("all series[].data arrays must be of the same length and have matching keys.")):valid.push(request);return valid}mergeRequested(requested){const grouped=[];for(const request of requested){const match=grouped.find(_a118.groupMatch(request));match?match.push(request):grouped.push([request])}return grouped.map(_a118.mergeRequests)}splitResult(dataModel,processedData,scopes,resolves){for(let i=0;i<scopes.length;i++){const scope=scopes[i],resolve=resolves[i];resolve({dataModel,processedData:{...processedData,data:processedData.data.filter(({validScopes})=>(validScopes==null?void 0:validScopes.has(scope))??!0)}})}}static groupMatch({data,opts}){function keys(props){return props.filter(p=>p.type==="key").map(p=>p.property).join(";")}return __name(keys,"keys"),([group])=>(opts.groupByData===!1||group.data===data)&&group.opts.groupByKeys===opts.groupByKeys&&group.opts.groupByFn===opts.groupByFn&&keys(group.opts.props)===keys(opts.props)}static mergeRequests(requests){return requests.reduce((result,{id,data,resolve,reject,opts:{props,...opts}})=>{var _a274;result.ids.push(id),result.rejects.push(reject),result.resolves.push(resolve),result.data??(result.data=data),result.opts??(result.opts={...opts,props:[]});for(const prop of props){const clone={...prop,scopes:[id]};_a118.createIdsMap(id,clone);const match=result.opts.props.find(existing=>existing.type===clone.type&&_a118.deepEqual(existing,clone));if(!match){result.opts.props.push(clone);continue}match.scopes??(match.scopes=[]),match.scopes.push(...clone.scopes??[]),(match.type==="key"||match.type==="value")&&((_a274=clone.idsMap)!=null&&_a274.size)&&_a118.mergeIdsMap(clone.idsMap,match.idsMap)}return result},{ids:[],rejects:[],resolves:[],data:null,opts:null})}static mergeIdsMap(fromMap,toMap){for(const[scope,ids]of fromMap){const toMapValue=toMap.get(scope);if(toMapValue!=null)for(const id of ids)toMapValue.add(id);else toMap.set(scope,new Set(ids))}}static createIdsMap(scope,prop){prop.id!=null&&(prop.idsMap??(prop.idsMap=new Map),prop.idsMap.has(scope)?prop.idsMap.get(scope).add(prop.id):prop.idsMap.set(scope,new Set([prop.id])))}static deepEqual(a,b){if(a===b)return!0;if(a&&b&&typeof a=="object"&&typeof b=="object"){if(a.constructor!==b.constructor)return!1;let i,length2;if(Array.isArray(a)){if(length2=a.length,length2!==b.length)return!1;for(i=length2-1;i>=0;i--)if(!_a118.deepEqual(a[i],b[i]))return!1;return!0}const keys=Object.keys(a);if(length2=keys.length,length2!==Object.keys(b).length)return!1;for(i=length2-1;i>=0;i--){const key=keys[i];if(!_a118.skipKeys.has(key)&&(!Object.hasOwn(b,key)||!_a118.deepEqual(a[key],b[key])))return!1}return!0}return!1}},__name(_a118,"_DataController"),_a118);_DataController.skipKeys=new Set(["id","idsMap","type","scopes"]);var DataController=_DataController,_a119,AxisRegistry=(_a119=class{constructor(){this.axesMap=new Map,this.hidden=new Set,this.themeTemplates=new Map}register(axisType,module){this.axesMap.set(axisType,module.moduleFactory),module.themeTemplate&&this.setThemeTemplate(axisType,module.themeTemplate),module.hidden&&this.hidden.add(axisType)}create(axisType,moduleContext){const axisFactory=this.axesMap.get(axisType);if(axisFactory)return axisFactory(moduleContext);throw new Error(`AG Charts - unknown axis type: ${axisType}`)}has(axisType){return this.axesMap.has(axisType)}keys(){return this.axesMap.keys()}publicKeys(){return[...this.keys()].filter(k=>!this.hidden.has(k))}setThemeTemplate(axisType,themeTemplate){return this.themeTemplates.set(axisType,themeTemplate),this}getThemeTemplate(axisType){return this.themeTemplates.get(axisType)}},__name(_a119,"AxisRegistry"),_a119),axisRegistry=new AxisRegistry,EXPECTED_ENTERPRISE_MODULES=[{type:"root",optionsKey:"animation",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"]},{type:"root",optionsKey:"annotations",chartTypes:["cartesian"]},{type:"root",optionsKey:"background",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"],optionsInnerKey:"image"},{type:"root",optionsKey:"foreground",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"],optionsInnerKey:"image"},{type:"root",optionsKey:"chartToolbar",chartTypes:["cartesian"]},{type:"root",optionsKey:"contextMenu",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"]},{type:"root",optionsKey:"statusBar",chartTypes:["cartesian"],identifier:"status-bar"},{type:"root",optionsKey:"dataSource",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"]},{type:"root",optionsKey:"sync",chartTypes:["cartesian"]},{type:"root",optionsKey:"zoom",chartTypes:["cartesian","topology"]},{type:"legend",optionsKey:"gradientLegend",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"],identifier:"gradient"},{type:"root",optionsKey:"navigator",chartTypes:["cartesian"],optionsInnerKey:"miniChart"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["cartesian"],identifier:"ordinal-time"},{type:"axis-option",optionsKey:"crosshair",chartTypes:["cartesian"]},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"box-plot"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"candlestick"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"ohlc"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"bullet"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"heatmap"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-area"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-bar"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"waterfall"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"nightingale"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-area"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-line"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-bar"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-column"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"sunburst"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"treemap"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-marker"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape-background"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line-background"},{type:"series",optionsKey:"series[]",chartTypes:["flow-proportion"],identifier:"chord"},{type:"series",optionsKey:"series[]",chartTypes:["flow-proportion"],identifier:"sankey"},{type:"series",optionsKey:"series[]",chartTypes:["gauge"],identifier:"linear-gauge"},{type:"series",optionsKey:"series[]",chartTypes:["gauge"],identifier:"radial-gauge"},{type:"series-option",optionsKey:"errorBar",chartTypes:["cartesian"],identifier:"error-bars"}];function isEnterpriseSeriesType(type){return EXPECTED_ENTERPRISE_MODULES.some(s=>s.type==="series"&&s.identifier===type)}__name(isEnterpriseSeriesType,"isEnterpriseSeriesType");function getEnterpriseSeriesChartTypes(type){var _a274;return(_a274=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type==="series"&&s.identifier===type))==null?void 0:_a274.chartTypes}__name(getEnterpriseSeriesChartTypes,"getEnterpriseSeriesChartTypes");function isEnterpriseCartesian(seriesType2){var _a274;return((_a274=getEnterpriseSeriesChartTypes(seriesType2))==null?void 0:_a274.find(v=>v==="cartesian"))==="cartesian"}__name(isEnterpriseCartesian,"isEnterpriseCartesian");function isEnterprisePolar(seriesType2){var _a274;return((_a274=getEnterpriseSeriesChartTypes(seriesType2))==null?void 0:_a274.find(v=>v==="polar"))==="polar"}__name(isEnterprisePolar,"isEnterprisePolar");function isEnterpriseHierarchy(seriesType2){var _a274;return((_a274=getEnterpriseSeriesChartTypes(seriesType2))==null?void 0:_a274.find(v=>v==="hierarchy"))==="hierarchy"}__name(isEnterpriseHierarchy,"isEnterpriseHierarchy");function isEnterpriseTopology(seriesType2){var _a274;return((_a274=getEnterpriseSeriesChartTypes(seriesType2))==null?void 0:_a274.find(v=>v==="topology"))==="topology"}__name(isEnterpriseTopology,"isEnterpriseTopology");function isEnterpriseFlowProportion(seriesType2){var _a274;return((_a274=getEnterpriseSeriesChartTypes(seriesType2))==null?void 0:_a274.find(v=>v==="flow-proportion"))==="flow-proportion"}__name(isEnterpriseFlowProportion,"isEnterpriseFlowProportion");function isEnterpriseGauge(seriesType2){var _a274;return((_a274=getEnterpriseSeriesChartTypes(seriesType2))==null?void 0:_a274.find(v=>v==="gauge"))==="gauge"}__name(isEnterpriseGauge,"isEnterpriseGauge");function isEnterpriseModule(module){return module.packageType==="enterprise"}__name(isEnterpriseModule,"isEnterpriseModule");function verifyIfModuleExpected(module){if(!isEnterpriseModule(module))throw new Error("AG Charts - internal configuration error, only enterprise modules need verification.");const stub=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type===module.type&&s.optionsKey===module.optionsKey&&s.identifier===module.identifier&&module.chartTypes.every(t=>s.chartTypes.includes(t)));return stub&&(stub.useCount??(stub.useCount=0),stub.useCount++),stub!=null}__name(verifyIfModuleExpected,"verifyIfModuleExpected");function getUnusedExpectedModules(){return EXPECTED_ENTERPRISE_MODULES.filter(({useCount})=>useCount==null||useCount===0)}__name(getUnusedExpectedModules,"getUnusedExpectedModules");var _a120,LegendRegistry=(_a120=class{constructor(){this.legendMap=new Map,this.themeTemplates=new Map}register(legendType,{optionsKey,moduleFactory,themeTemplate}){this.legendMap.set(legendType,{optionsKey,moduleFactory}),this.themeTemplates.set(optionsKey,themeTemplate)}create(legendType,moduleContext){var _a274;const legendFactory=(_a274=this.legendMap.get(legendType))==null?void 0:_a274.moduleFactory;if(legendFactory)return legendFactory(moduleContext);throw new Error(`AG Charts - unknown legend type: ${legendType}`)}getThemeTemplates(){return Object.fromEntries(this.themeTemplates)}getKeys(){return Array.from(this.legendMap.entries()).reduce((result,[legendType,record])=>(result[legendType]=record.optionsKey,result),{})}},__name(_a120,"LegendRegistry"),_a120),legendRegistry=new LegendRegistry,_a121,ChartTypes=(_a121=class extends Map{get(seriesType2){return super.get(seriesType2)??"unknown"}isCartesian(seriesType2){return this.get(seriesType2)==="cartesian"}isPolar(seriesType2){return this.get(seriesType2)==="polar"}isHierarchy(seriesType2){return this.get(seriesType2)==="hierarchy"}isTopology(seriesType2){return this.get(seriesType2)==="topology"}isFlowProportion(seriesType2){return this.get(seriesType2)==="flow-proportion"}isGauge(seriesType2){return this.get(seriesType2)==="gauge"}get seriesTypes(){return Array.from(this.keys())}get cartesianTypes(){return this.seriesTypes.filter(t=>this.isCartesian(t))}get polarTypes(){return this.seriesTypes.filter(t=>this.isPolar(t))}get hierarchyTypes(){return this.seriesTypes.filter(t=>this.isHierarchy(t))}get topologyTypes(){return this.seriesTypes.filter(t=>this.isTopology(t))}get flowProportionTypes(){return this.seriesTypes.filter(t=>this.isFlowProportion(t))}get gaugeTypes(){return this.seriesTypes.filter(t=>this.isGauge(t))}},__name(_a121,"ChartTypes"),_a121),_a122,ChartDefaults=(_a122=class extends Map{set(chartType2,defaults){return super.set(chartType2,mergeDefaults(defaults,this.get(chartType2)))}},__name(_a122,"ChartDefaults"),_a122),chartTypes=new ChartTypes,publicChartTypes=new ChartTypes,chartDefaults=new ChartDefaults,_a123,SeriesRegistry=(_a123=class{constructor(){this.seriesMap=new Map,this.themeTemplates=new Map}register(seriesType2,{chartTypes:[chartType2],moduleFactory,tooltipDefaults,defaultAxes,themeTemplate,paletteFactory,solo,stackable,groupable,stackedByDefault,swapDefaultAxesCondition,hidden}){this.setThemeTemplate(seriesType2,themeTemplate),this.seriesMap.set(seriesType2,{moduleFactory,tooltipDefaults,defaultAxes,paletteFactory,solo,stackable,groupable,stackedByDefault,swapDefaultAxesCondition}),chartTypes.set(seriesType2,chartType2),hidden||publicChartTypes.set(seriesType2,chartType2)}create(seriesType2,moduleContext){var _a274;const seriesFactory=(_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.moduleFactory;if(seriesFactory)return seriesFactory(moduleContext);throw new Error(`AG Charts - unknown series type: ${seriesType2}`)}cloneDefaultAxes(seriesType2){var _a274;const defaultAxes=(_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.defaultAxes;return defaultAxes?{axes:deepClone(defaultAxes)}:null}setThemeTemplate(seriesType2,themeTemplate){const currentTemplate=this.themeTemplates.get(seriesType2);this.themeTemplates.set(seriesType2,mergeDefaults(themeTemplate,currentTemplate))}getThemeTemplate(seriesType2){return this.themeTemplates.get(seriesType2)}getPaletteFactory(seriesType2){var _a274;return(_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.paletteFactory}getTooltipDefauls(seriesType2){var _a274;return(_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.tooltipDefaults}isSolo(seriesType2){var _a274;return((_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.solo)??!1}isGroupable(seriesType2){var _a274;return((_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.groupable)??!1}isStackable(seriesType2){var _a274;return((_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.stackable)??!1}isStackedByDefault(seriesType2){var _a274;return((_a274=this.seriesMap.get(seriesType2))==null?void 0:_a274.stackedByDefault)??!1}isDefaultAxisSwapNeeded(options){var _a274,_b;let result;for(const series of options.series??[]){const{type="line"}=series,isDefaultAxisSwapped=(_b=(_a274=this.seriesMap.get(type))==null?void 0:_a274.swapDefaultAxesCondition)==null?void 0:_b.call(_a274,series);if(isDefaultAxisSwapped!=null){if(result!=null&&result!=isDefaultAxisSwapped)throw new Error("AG Charts - The provided series have incompatible directions");result=isDefaultAxisSwapped}}return result}},__name(_a123,"SeriesRegistry"),_a123),seriesRegistry=new SeriesRegistry,_a124,_SyncManager=(_a124=class extends BaseManager{constructor(chart){super(),this.chart=chart}subscribe(groupId=_a124.DEFAULT_GROUP){let syncGroup=this.get(groupId);return syncGroup||(syncGroup=new Set,_a124.chartsGroups.set(groupId,syncGroup)),syncGroup.add(this.chart),this}unsubscribe(groupId=_a124.DEFAULT_GROUP){var _a274;return(_a274=this.get(groupId))==null||_a274.delete(this.chart),this}getChart(){return this.chart}getGroup(groupId=_a124.DEFAULT_GROUP){const syncGroup=this.get(groupId);return syncGroup?Array.from(syncGroup):[]}getGroupSiblings(groupId=_a124.DEFAULT_GROUP){return this.getGroup(groupId).filter(chart=>chart!==this.chart)}get(groupId){return _a124.chartsGroups.get(groupId)}},__name(_a124,"_SyncManager"),_a124);_SyncManager.chartsGroups=new Map;_SyncManager.DEFAULT_GROUP=Symbol("sync-group-default");var SyncManager=_SyncManager,_a125,Keyboard=(_a125=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!1}},__name(_a125,"Keyboard"),_a125);__decorateClass([Validate(BOOLEAN)],Keyboard.prototype,"enabled",2);__decorateClass([Validate(NUMBER)],Keyboard.prototype,"tabIndex",2);var CartesianAxisPositions=["top","right","bottom","left"];function isAxisPosition(position){return typeof position=="string"&&CartesianAxisPositions.includes(position)}__name(isAxisPosition,"isAxisPosition");function guessInvalidPositions(axes){const invalidAxes=[],usedPositions=[],guesses=[...CartesianAxisPositions];for(const axis of axes)axis instanceof CartesianAxis&&(isAxisPosition(axis.position)?usedPositions.push(axis.position):invalidAxes.push(axis));for(const axis of invalidAxes){let nextGuess;do nextGuess=guesses.pop();while(nextGuess&&usedPositions.includes(nextGuess));if(nextGuess==null)break;axis.position=nextGuess}}__name(guessInvalidPositions,"guessInvalidPositions");var MATCHING_KEYS=["direction","xKey","yKey","sizeKey","angleKey","radiusKey","normalizedTo"];function matchSeriesOptions(series,optSeries,oldOptsSeries){var _a274,_b;const generateKey=__name((type,i,opts)=>{const result=[type];for(const key of MATCHING_KEYS)key in i&&i[key]!=null&&result.push(`${key}=${i[key]}`);return opts!=null&&opts.seriesGrouping&&result.push(`seriesGrouping.groupId=${opts==null?void 0:opts.seriesGrouping.groupId}`),result.join(";")},"generateKey"),seriesMap=new Map;let idx=0;for(const s of series){const key=generateKey(s.type,s.properties,oldOptsSeries==null?void 0:oldOptsSeries[idx]);seriesMap.has(key)||seriesMap.set(key,[]),(_a274=seriesMap.get(key))==null||_a274.push([s,idx++])}const optsMap=new Map;for(const o of optSeries){const key=generateKey(o.type,o,o);optsMap.has(key)||optsMap.set(key,[]),(_b=optsMap.get(key))==null||_b.push(o)}if(![...seriesMap.keys()].some(k=>optsMap.has(k)))return{status:"no-overlap",oldKeys:seriesMap.keys(),newKeys:optsMap.keys()};const changes=[];let targetIdx=-1;for(const[key,optArray]of optsMap.entries())for(const opts of optArray){targetIdx++;const seriesArray=seriesMap.get(key);if(seriesArray==null||seriesArray.length<1){changes.push({opts,idx:targetIdx,status:"add"}),seriesMap.delete(key);continue}const[outputSeries,outputIdx]=seriesArray.shift(),previousOpts=(oldOptsSeries==null?void 0:oldOptsSeries[outputIdx])??{},diff2=jsonDiff(previousOpts,opts??{}),{groupIndex,stackIndex}=(diff2==null?void 0:diff2.seriesGrouping)??{};groupIndex!=null||stackIndex!=null?changes.push({opts,series:outputSeries,diff:diff2,idx:outputIdx,status:"series-grouping"}):diff2?changes.push({opts,series:outputSeries,diff:diff2,idx:outputIdx,status:"update"}):changes.push({opts,series:outputSeries,idx:outputIdx,status:"no-op"}),seriesArray.length===0&&seriesMap.delete(key)}for(const seriesArray of seriesMap.values())for(const[outputSeries,outputIdx]of seriesArray)changes.push({series:outputSeries,idx:outputIdx,status:"remove"});return{status:"overlap",changes}}__name(matchSeriesOptions,"matchSeriesOptions");function optionsType(input){var _a274,_b;return((_b=(_a274=input.series)==null?void 0:_a274[0])==null?void 0:_b.type)??"line"}__name(optionsType,"optionsType");function isAgCartesianChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!0:specifiedType==="cartesian"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):chartTypes.isCartesian(specifiedType)||isEnterpriseCartesian(specifiedType)}__name(isAgCartesianChartOptions,"isAgCartesianChartOptions");function isAgPolarChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="polar"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):chartTypes.isPolar(specifiedType)||isEnterprisePolar(specifiedType)}__name(isAgPolarChartOptions,"isAgPolarChartOptions");function isAgHierarchyChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="hierarchy"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):chartTypes.isHierarchy(specifiedType)||isEnterpriseHierarchy(specifiedType)}__name(isAgHierarchyChartOptions,"isAgHierarchyChartOptions");function isAgTopologyChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="topology"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):chartTypes.isTopology(specifiedType)||isEnterpriseTopology(specifiedType)}__name(isAgTopologyChartOptions,"isAgTopologyChartOptions");function isAgFlowProportionChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="flow-proportion"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):chartTypes.isFlowProportion(specifiedType)||isEnterpriseFlowProportion(specifiedType)}__name(isAgFlowProportionChartOptions,"isAgFlowProportionChartOptions");function isAgGaugeChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="gauge"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):chartTypes.isGauge(specifiedType)||isEnterpriseGauge(specifiedType)}__name(isAgGaugeChartOptions,"isAgGaugeChartOptions");function isAgPolarChartOptionsWithSeriesBasedLegend(input){const specifiedType=optionsType(input);return isAgPolarChartOptions(input)&&specifiedType!=="pie"&&specifiedType!=="donut"}__name(isAgPolarChartOptionsWithSeriesBasedLegend,"isAgPolarChartOptionsWithSeriesBasedLegend");function isSeriesOptionType(input){return input==null?!1:chartTypes.has(input)}__name(isSeriesOptionType,"isSeriesOptionType");function isAxisOptionType(input){return input==null?!1:axisRegistry.has(input)}__name(isAxisOptionType,"isAxisOptionType");var _a126,ModulesManager=(_a126=class extends ModuleMap{applyOptions(options){for(const m of this.moduleMap.values())m.module.optionsKey in options&&isProperties(m.moduleInstance)&&m.moduleInstance.set(options[m.module.optionsKey])}*legends(){for(const{module,moduleInstance}of this.moduleMap.values())module.type==="legend"&&(yield{legendType:module.identifier,legend:moduleInstance})}},__name(_a126,"ModulesManager"),_a126),DEFAULT_OVERLAY_CLASS="ag-chart-overlay",DEFAULT_OVERLAY_DARK_CLASS="ag-chart-dark-overlay",_a127,Overlay=(_a127=class extends BaseProperties{constructor(className,defaultMessageId){super(),this.className=className,this.defaultMessageId=defaultMessageId}getText(localeManager){return localeManager.t(this.text??this.defaultMessageId)}getElement(animationManager,localeManager,rect){var _a274;if((_a274=this.content)==null||_a274.remove(),this.focusBox=rect,this.renderer){const htmlContent=this.renderer();if(htmlContent instanceof HTMLElement)this.content=htmlContent;else{const tempDiv=createElement("div");tempDiv.innerHTML=htmlContent,this.content=tempDiv.firstElementChild}}else{const content=createElement("div",{display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",height:"100%",margin:"8px",font:"12px Verdana, sans-serif"});content.innerText=this.getText(localeManager),this.content=content,animationManager==null||animationManager.animate({from:0,to:1,id:"overlay",phase:"add",groupId:"opacity",onUpdate(value){content.style.opacity=String(value)},onStop(){content.style.opacity="1"}})}return this.content}removeElement(cleanup=()=>{var _a274;return(_a274=this.content)==null?void 0:_a274.remove()},animationManager){if(this.content){if(animationManager){const{content}=this;animationManager.animate({from:1,to:0,phase:"remove",id:"overlay",groupId:"opacity",onUpdate(value){content.style.opacity=String(value)},onStop(){cleanup==null||cleanup()}})}else cleanup==null||cleanup();this.content=void 0,this.focusBox=void 0}}},__name(_a127,"Overlay"),_a127);__decorateClass([Validate(STRING,{optional:!0})],Overlay.prototype,"text",2);__decorateClass([Validate(FUNCTION,{optional:!0})],Overlay.prototype,"renderer",2);var _a128,ChartOverlays=(_a128=class extends BaseProperties{constructor(){super(...arguments),this.darkTheme=!1,this.loading=new Overlay("ag-chart-loading-overlay","overlayLoadingData"),this.noData=new Overlay("ag-chart-no-data-overlay","overlayNoData"),this.noVisibleSeries=new Overlay("ag-chart-no-visible-series","overlayNoVisibleSeries")}getFocusInfo(localeManager){for(const overlay of[this.loading,this.noData,this.noVisibleSeries])if(overlay.focusBox!==void 0)return{text:overlay.getText(localeManager),rect:overlay.focusBox}}destroy(){this.loading.removeElement(),this.noData.removeElement(),this.noVisibleSeries.removeElement()}},__name(_a128,"ChartOverlays"),_a128);__decorateClass([Validate(BOOLEAN)],ChartOverlays.prototype,"darkTheme",2);__decorateClass([Validate(OBJECT)],ChartOverlays.prototype,"loading",2);__decorateClass([Validate(OBJECT)],ChartOverlays.prototype,"noData",2);__decorateClass([Validate(OBJECT)],ChartOverlays.prototype,"noVisibleSeries",2);function getLoadingSpinner(text,defaultDuration){const{animationDuration}=PHASE_METADATA.add,duration=animationDuration*defaultDuration,container=createElement("div",`${DEFAULT_OVERLAY_CLASS}--loading`,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",boxSizing:"border-box",font:"13px Verdana, sans-serif",userSelect:"none",animation:`ag-charts-loading ${duration}ms linear 50ms both`}),matrix=createElement("span",{width:"45px",height:"40px",backgroundImage:["linear-gradient(#0000 calc(1 * 100% / 6), #ccc 0 calc(3 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(2 * 100% / 6), #ccc 0 calc(4 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(3 * 100% / 6), #ccc 0 calc(5 * 100% / 6), #0000 0)"].join(""),backgroundSize:"10px 400%",backgroundRepeat:"no-repeat",animation:"ag-charts-loading-matrix 1s infinite linear"}),label=createElement("p",{marginTop:"1em"});label.innerText=text;const background=createElement("div",`${DEFAULT_OVERLAY_CLASS}__loading-background`,{position:"absolute",inset:"0",opacity:"0.5",zIndex:"-1"}),animationStyles=createElement("style");return animationStyles.innerText=["@keyframes ag-charts-loading { from { opacity: 0 } to { opacity: 1 } }","@keyframes ag-charts-loading-matrix {","0% { background-position: 0% 0%, 50% 0%, 100% 0%; }","100% { background-position: 0% 100%, 50% 100%, 100% 100%; }","}"].join(" "),container.replaceChildren(animationStyles,matrix,label,background),container}__name(getLoadingSpinner,"getLoadingSpinner");var SeriesNodePickMode=(SeriesNodePickMode2=>(SeriesNodePickMode2[SeriesNodePickMode2.EXACT_SHAPE_MATCH=0]="EXACT_SHAPE_MATCH",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_BY_MAIN_AXIS_FIRST=1]="NEAREST_BY_MAIN_AXIS_FIRST",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_BY_MAIN_CATEGORY_AXIS_FIRST=2]="NEAREST_BY_MAIN_CATEGORY_AXIS_FIRST",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_NODE=3]="NEAREST_NODE",SeriesNodePickMode2))(SeriesNodePickMode||{}),CROSS_FILTER_MARKER_FILL_OPACITY_FACTOR=.25,CROSS_FILTER_MARKER_STROKE_OPACITY_FACTOR=.125,_a129,SeriesNodeEvent=(_a129=class{constructor(type,event,{datum},series){this.type=type,this.event=event,this.datum=datum,this.seriesId=series.id}},__name(_a129,"SeriesNodeEvent"),_a129),_a130,SeriesGroupingChangedEvent=(_a130=class{constructor(series,seriesGrouping,oldGrouping){this.series=series,this.seriesGrouping=seriesGrouping,this.oldGrouping=oldGrouping,this.type="groupingChanged"}},__name(_a130,"SeriesGroupingChangedEvent"),_a130),_a131,Series=(_a131=class extends Observable{constructor(seriesOpts){super(),this.destroyFns=[],this.seriesGrouping=void 0,this.NodeEvent=SeriesNodeEvent,this.internalId=createId(this),this.rootGroup=new Group({name:"seriesRoot",isVirtual:!0}),this.axes={x:void 0,y:void 0},this.directions=["x","y"],this.nodeDataRefresh=!0,this.moduleMap=new ModuleMap,this._declarationOrder=-1,this.seriesListeners=new Listeners,this._pickNodeCache=new LRUCache;const{moduleCtx,pickModes=[1],directionKeys={},directionNames={},contentGroupVirtual=!0,canHaveAxes=!1}=seriesOpts;this.ctx=moduleCtx,this.directionKeys=directionKeys,this.directionNames=directionNames,this.canHaveAxes=canHaveAxes,this.contentGroup=this.rootGroup.appendChild(new TranslatableGroup({name:`${this.internalId}-content`,isVirtual:contentGroupVirtual,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("data")})),this.highlightGroup=new TranslatableGroup({name:`${this.internalId}-highlight`,isVirtual:contentGroupVirtual,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("highlight")}),this.highlightNode=this.highlightGroup.appendChild(new Group({name:"highlightNode",zIndex:0})),this.highlightLabel=this.highlightGroup.appendChild(new Group({name:"highlightLabel",zIndex:10})),this.pickModes=pickModes,this.labelGroup=this.rootGroup.appendChild(new TranslatableGroup({name:`${this.internalId}-series-labels`,zIndex:9})),this.annotationGroup=new Group({name:`${this.id}-annotation`,isVirtual:contentGroupVirtual,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("annotation")})}get id(){var _a274;return((_a274=this.properties)==null?void 0:_a274.id)??this.internalId}get type(){return this.constructor.type??""}get data(){return this._data??this._chartData}set visible(value){this.properties.visible=value,this.visibleMaybeChanged()}get visible(){return this.properties.visible}get hasData(){return this.data!=null&&this.data.length>0}get tooltipEnabled(){var _a274;return((_a274=this.properties.tooltip)==null?void 0:_a274.enabled)??!1}onDataChange(){this.nodeDataRefresh=!0,this._pickNodeCache.clear()}setOptionsData(input){this._data=input,this.onDataChange()}setChartData(input){this._chartData=input,this.data===input&&this.onDataChange()}onSeriesGroupingChange(prev,next){const{internalId,type,visible}=this;prev&&this.ctx.seriesStateManager.deregisterSeries({id:internalId,type}),next&&this.ctx.seriesStateManager.registerSeries({id:internalId,type,visible,seriesGrouping:next}),this.fireEvent(new SeriesGroupingChangedEvent(this,next,prev))}getBandScalePadding(){return{inner:1,outer:0}}getGroupZIndexSubOrder(type,subIndex=0){let mainAdjust=0;switch(type){case"data":case"paths":break;case"labels":mainAdjust+=2e4;break;case"marker":mainAdjust+=1e4;break;case"highlight":subIndex+=15e3;break;case"annotation":mainAdjust+=15e3;break}return[__name(()=>this._declarationOrder+mainAdjust,"main"),subIndex]}addListener(type,listener){return this.seriesListeners.addListener(type,listener)}dispatch(type,event){this.seriesListeners.dispatch(type,event)}addChartEventListeners(){}destroy(){this.destroyFns.forEach(f=>f()),this.destroyFns=[],this.ctx.seriesStateManager.deregisterSeries(this)}getDirectionValues(direction,properties){const resolvedDirection=this.resolveKeyDirection(direction),keys=properties==null?void 0:properties[resolvedDirection],values=[];if(!keys)return values;const addValues=__name((...items)=>{for(const value of items)Array.isArray(value)?addValues(...value):typeof value=="object"?addValues(...Object.values(value)):values.push(value)},"addValues");return addValues(...keys.map(key=>this.properties[key])),values}getKeys(direction){return this.getDirectionValues(direction,this.directionKeys)}getKeyProperties(direction){return this.directionKeys[this.resolveKeyDirection(direction)]??[]}getNames(direction){return this.getDirectionValues(direction,this.directionNames)}resolveKeyDirection(direction){return direction}getDomain(direction){const seriesDomain=this.getSeriesDomain(direction),moduleDomains=this.moduleMap.mapModules(module=>module.getDomain(direction));return seriesDomain.concat(moduleDomains.flat())}markNodeDataDirty(){this.nodeDataRefresh=!0,this._pickNodeCache.clear(),this.visibleMaybeChanged()}visibleMaybeChanged(){this.ctx.seriesStateManager.registerSeries(this)}getOpacity(){const{dimOpacity=1,enabled=!0}=this.properties.highlightStyle.series;if(!enabled||dimOpacity===1)return 1;switch(this.isItemIdHighlighted()){case 0:case 1:return 1;case 2:default:return dimOpacity}}getStrokeWidth(defaultStrokeWidth){const{strokeWidth,enabled=!0}=this.properties.highlightStyle.series;if(!enabled||strokeWidth===void 0)return defaultStrokeWidth;switch(this.isItemIdHighlighted()){case 1:return strokeWidth;case 0:case 2:return defaultStrokeWidth}}isItemIdHighlighted(){var _a274,_b;const series=(_b=(_a274=this.ctx.highlightManager)==null?void 0:_a274.getActiveHighlight())==null?void 0:_b.series;return series==null?0:series!==this?2:1}getModuleTooltipParams(){return this.moduleMap.mapModules(module=>module.getTooltipParams()).reduce((total,current)=>Object.assign(total,current),{})}pickNode(point,intent,exactMatchOnly=!1){const{pickModes,visible,rootGroup}=this;if(!visible||!rootGroup.visible||intent==="highlight"&&!this.properties.highlight.enabled||intent==="highlight-tooltip"&&!this.properties.highlight.enabled||intent==="highlight"&&!this.properties.highlight.enabled)return;let maxDistance=1/0;if(intent==="tooltip"||intent==="highlight-tooltip"){const{tooltip}=this.properties;maxDistance=typeof tooltip.range=="number"?tooltip.range:1/0,exactMatchOnly||(exactMatchOnly=tooltip.range==="exact")}else if(intent==="event"){const{nodeClickRange}=this.properties;maxDistance=typeof nodeClickRange=="number"?nodeClickRange:1/0,exactMatchOnly||(exactMatchOnly=nodeClickRange==="exact")}const selectedPickModes=pickModes.filter(m=>!exactMatchOnly||m===0),{x,y}=point,key=JSON.stringify({x,y,maxDistance,selectedPickModes});if(this._pickNodeCache.has(key))return this._pickNodeCache.get(key);for(const pickMode of selectedPickModes){let match;switch(pickMode){case 0:match=this.pickNodeExactShape(point);break;case 1:case 2:match=this.pickNodeMainAxisFirst(point,pickMode===2);break;case 3:match=this.pickNodeClosestDatum(point);break}if(match&&match.distance<=maxDistance)return this._pickNodeCache.set(key,{pickMode,match:match.datum,distance:match.distance})}return this._pickNodeCache.set(key,void 0)}pickNodeExactShape(point){const match=this.contentGroup.pickNode(point.x,point.y);if(match&&match.datum.missing!==!0)return{datum:match.datum,distance:0}}pickNodeClosestDatum(_point){throw new Error("AG Charts - Series.pickNodeClosestDatum() not implemented")}pickNodeNearestDistantObject(point,items){const match=nearestSquared(point.x,point.y,items);if(match.nearest!==void 0&&match.nearest.datum.missing!==!0)return{datum:match.nearest.datum,distance:Math.sqrt(match.distanceSquared)}}pickNodeMainAxisFirst(_point,_requireCategoryAxis){throw new Error("AG Charts - Series.pickNodeMainAxisFirst() not implemented")}fireNodeClickEvent(event,datum){this.fireEvent(new this.NodeEvent("nodeClick",event,datum,this))}fireNodeDoubleClickEvent(event,datum){this.fireEvent(new this.NodeEvent("nodeDoubleClick",event,datum,this))}createNodeContextMenuActionEvent(event,datum){return new this.NodeEvent("nodeContextMenuAction",event,datum,this)}toggleSeriesItem(itemId,enabled){this.visible=enabled,this.nodeDataRefresh=!0,this._pickNodeCache.clear(),this.dispatch("visibility-changed",{itemId,enabled})}isEnabled(){return this.visible}getModuleMap(){return this.moduleMap}createModuleContext(){return{...this.ctx,series:this}}getLabelText(label,params,defaultFormatter=String){return label.formatter?this.ctx.callbackCache.call(label.formatter,{seriesId:this.id,...params})??defaultFormatter(params.value):defaultFormatter(params.value)}getMarkerStyle(marker,params,defaultStyle=marker.getStyle()){var _a274;const defaultSize={size:((_a274=params.datum.point)==null?void 0:_a274.size)??0},markerStyle=mergeDefaults(defaultSize,defaultStyle);if(marker.itemStyler){const style=this.ctx.callbackCache.call(marker.itemStyler,{seriesId:this.id,...markerStyle,...params,datum:params.datum.datum});return mergeDefaults(style,markerStyle)}return markerStyle}updateMarkerStyle(markerNode,marker,params,defaultStyle=marker.getStyle(),{applyTranslation=!0,selected=!0}={}){const{point}=params.datum,activeStyle=this.getMarkerStyle(marker,params,defaultStyle),visible=this.visible&&activeStyle.size>0&&point&&!isNaN(point.x)&&!isNaN(point.y);if(applyTranslation?markerNode.setProperties({visible,...activeStyle,translationX:point==null?void 0:point.x,translationY:point==null?void 0:point.y}):markerNode.setProperties({visible,...activeStyle}),selected||(markerNode.fillOpacity*=CROSS_FILTER_MARKER_FILL_OPACITY_FACTOR,markerNode.strokeOpacity*=CROSS_FILTER_MARKER_STROKE_OPACITY_FACTOR),typeof marker.shape=="function"&&!markerNode.dirtyPath){markerNode.path.clear(!0),markerNode.updatePath(),markerNode.checkPathDirty();const bb=markerNode.getBBox();if(point!==void 0&&bb.isFinite()){const center=bb.computeCenter(),[dx,dy]=["x","y"].map(key=>(activeStyle.strokeWidth??0)+Math.abs(center[key]-point[key])),customSize=Math.max(bb.width+dx,bb.height+dy);point.focusSize=customSize}}}getMinRects(_width,_height){}get nodeDataDependencies(){return this._nodeDataDependencies??{seriesRectWidth:NaN,seriesRectHeight:NaN}}checkResize(newSeriesRect){const{width:seriesRectWidth,height:seriesRectHeight}=newSeriesRect??{width:NaN,height:NaN},newNodeDataDependencies=newSeriesRect?{seriesRectWidth,seriesRectHeight}:void 0,resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;return resize&&(this._nodeDataDependencies=newNodeDataDependencies,this.markNodeDataDirty()),resize}pickFocus(_opts){}},__name(_a131,"Series"),_a131);Series.highlightedZIndex=1e12;__decorateClass([ActionOnSet({changeValue:__name(function(newVal,oldVal){this.onSeriesGroupingChange(oldVal,newVal)},"changeValue")})],Series.prototype,"seriesGrouping",2);function convertValuesToScaleByDefs({defs,values,xAxis,yAxis}){if(!(xAxis&&yAxis))throw new Error("Axes must be defined");const result={};for(const[searchId,{def}]of defs)if(Object.hasOwn(values,searchId)){const{scale:scale2}=def.type==="key"?xAxis:yAxis;result[searchId]=Math.round(scale2.convert(values[searchId]))}return result}__name(convertValuesToScaleByDefs,"convertValuesToScaleByDefs");function pickNode(inputSeries,point,intent,exactMatchOnly){const reverseSeries=[...inputSeries].reverse();let result;for(const series of reverseSeries){if(!series.visible||!series.rootGroup.visible)continue;const{match,distance:distance3}=series.pickNode(point,intent,exactMatchOnly)??{};if(!(!match||distance3==null)&&((!result||result.distance>distance3)&&(result={series,distance:distance3,datum:match}),distance3===0))break}return result}__name(pickNode,"pickNode");var _a132,SeriesAreaClickManager=(_a132=class extends BaseManager{constructor(id,chart,ctx){super(),this.id=id,this.chart=chart,this.ctx=ctx,this.series=[];const seriesRegion=this.ctx.regionManager.getRegion("series"),horizontalAxesRegion=this.ctx.regionManager.getRegion("horizontal-axes"),verticalAxesRegion=this.ctx.regionManager.getRegion("vertical-axes");this.destroyFns.push(this.ctx.regionManager.listenAll("click",event=>this.onClick(event)),this.ctx.regionManager.listenAll("dblclick",event=>this.onClick(event)),this.ctx.layoutManager.addListener("layout:complete",event=>this.layoutComplete(event)),seriesRegion.addListener("hover",event=>this.onHover(event)),seriesRegion.addListener("leave",()=>this.onLeave()),horizontalAxesRegion.addListener("leave",()=>this.onLeave()),verticalAxesRegion.addListener("leave",()=>this.onLeave()))}seriesChanged(series){this.series=series}dataChanged(){}preSceneRender(){}update(type,opts){this.ctx.updateService.update(type,opts)}layoutComplete(event){this.seriesRect=event.series.paddedRect}onLeave(){this.ctx.cursorManager.updateCursor(this.id)}onHover({regionOffsetX,regionOffsetY}){const found=pickNode(this.series,{x:regionOffsetX,y:regionOffsetY},"event");found!=null&&found.series.hasEventListener("nodeClick")||found!=null&&found.series.hasEventListener("nodeDoubleClick")?this.ctx.cursorManager.updateCursor(this.id,"pointer"):this.ctx.cursorManager.updateCursor(this.id)}onClick(event){var _a274;if((_a274=this.seriesRect)!=null&&_a274.containsPoint(event.offsetX,event.offsetY)&&this.checkSeriesNodeClick(event)){this.update(4),event.preventDefault();return}const newEvent={type:event.type==="click"?"click":"doubleClick",event:event.sourceEvent};this.chart.fireEvent(newEvent)}checkSeriesNodeClick(event){let point={x:event.regionOffsetX,y:event.regionOffsetY};event.region!=="series"&&(point=Transformable.fromCanvasPoint(this.chart.seriesRoot,event.offsetX,event.offsetY));const result=pickNode(this.series,point,"event");return result==null?!1:event.type==="click"?(result.series.fireNodeClickEvent(event.sourceEvent,result.datum),!0):event.type==="dblclick"?(event.preventZoomDblClick=result.distance===0,result.series.fireNodeDoubleClickEvent(event.sourceEvent,result.datum),!0):!1}},__name(_a132,"SeriesAreaClickManager"),_a132);function computeCenter(bboxOrPath){if(bboxOrPath!=null)return bboxOrPath instanceof BBox?bboxOrPath.computeCenter():Transformable.toCanvas(bboxOrPath).computeCenter()}__name(computeCenter,"computeCenter");function drawPickedFocus(focusIndicator,pick){const{bounds,showFocusBox}=pick;showFocusBox&&(focusIndicator==null||focusIndicator.updateBounds(bounds))}__name(drawPickedFocus,"drawPickedFocus");function makeKeyboardPointerEvent(focusIndicator,pick){drawPickedFocus(focusIndicator,pick);const{x:offsetX,y:offsetY}=computeCenter(pick.bounds)??{};if(offsetX!==void 0&&offsetY!==void 0)return{type:"keyboard",offsetX,offsetY}}__name(makeKeyboardPointerEvent,"makeKeyboardPointerEvent");var _a133,SeriesAreaFocusManager=(_a133=class extends BaseManager{constructor(id,chart,ctx,chartType2,overlays){super(),this.id=id,this.chart=chart,this.ctx=ctx,this.chartType=chartType2,this.overlays=overlays,this.series=[],this.focus={hasFocus:!1,series:void 0,seriesIndex:0,datumIndex:0,datum:void 0},this.destroyFns.push(this.ctx.layoutManager.addListener("layout:complete",event=>this.layoutComplete(event)),this.ctx.animationManager.addListener("animation-start",()=>this.onAnimationStart()),this.ctx.keyNavManager.addListener("blur",()=>this.onBlur()),this.ctx.keyNavManager.addListener("focus",event=>this.onFocus(event)),this.ctx.keyNavManager.addListener("nav-vert",event=>this.onNavVert(event)),this.ctx.keyNavManager.addListener("nav-hori",event=>this.onNavHori(event)),this.ctx.keyNavManager.addListener("submit",event=>this.onSubmit(event)),this.ctx.zoomManager.addListener("zoom-change",()=>{this.ctx.focusIndicator.updateBounds(void 0)}))}seriesChanged(declaredSeries){const sortedSeries=declaredSeries.map((series,index)=>({series,index})).sort((a,b)=>{let fpA=a.series.properties.focusPriority??1/0,fpB=b.series.properties.focusPriority??1/0;return fpA===fpB&&([fpA,fpB]=[a.index,b.index]),fpA<fpB?-1:fpA>fpB?1:0});this.series=sortedSeries.map(entry=>entry.series),this.onBlur()}dataChanged(){this.ctx.focusIndicator.updateBounds(void 0)}preSceneRender(){this.refreshFocus()}layoutComplete(event){this.seriesRect=event.series.rect}refreshFocus(){this.focus.hasFocus&&this.handleSeriesFocus(0,0)}onFocus(event){this.handleFocus(0,0),event.preventDefault(),this.focus.hasFocus=!0}onNavVert(event){this.focus.seriesIndex+=event.delta,this.handleFocus(event.delta,0),event.preventDefault()}onNavHori(event){this.focus.datumIndex+=event.delta,this.handleFocus(0,event.delta),event.preventDefault()}onAnimationStart(){this.focus.hasFocus&&this.onBlur()}onBlur(){this.ctx.focusIndicator.updateBounds(void 0),this.focus.hasFocus=!1}handleFocus(seriesIndexDelta,datumIndexDelta){this.focus.hasFocus=!0;const overlayFocus=this.overlays.getFocusInfo(this.ctx.localeManager);overlayFocus==null?this.handleSeriesFocus(seriesIndexDelta,datumIndexDelta):(this.ctx.focusIndicator.updateBounds(overlayFocus.rect),this.ctx.ariaAnnouncementService.clear())}handleSeriesFocus(otherIndexDelta,datumIndexDelta){if(this.chartType==="hierarchy"){this.handleHierarchySeriesFocus(otherIndexDelta,datumIndexDelta);return}const{focus,seriesRect,series}=this,visibleSeries=series.filter(s=>s.visible);if(visibleSeries.length===0)return;focus.seriesIndex=clamp(0,focus.seriesIndex,visibleSeries.length-1),focus.series=visibleSeries[focus.seriesIndex];const{datumIndex,seriesIndex:otherIndex}=focus,pick=focus.series.pickFocus({datumIndex,datumIndexDelta,otherIndex,otherIndexDelta,seriesRect});this.updatePickedFocus(pick)}handleHierarchySeriesFocus(otherIndexDelta,datumIndexDelta){this.focus.series=this.series[0];const{focus:{series,seriesIndex:otherIndex,datumIndex},seriesRect}=this;if(series===void 0)return;const pick=series.pickFocus({datumIndex,datumIndexDelta,otherIndex,otherIndexDelta,seriesRect});this.updatePickedFocus(pick)}updatePickedFocus(pick){const{focus}=this;if(pick===void 0||focus.series===void 0)return;const{datum,datumIndex}=pick;focus.datumIndex=datumIndex,focus.datum=datum;const keyboardEvent=makeKeyboardPointerEvent(this.ctx.focusIndicator,pick);if(keyboardEvent!==void 0){const html=focus.series.getTooltipHtml(datum),meta=TooltipManager.makeTooltipMeta(keyboardEvent,datum),aria=this.getDatumAriaText(datum,html);this.ctx.highlightManager.updateHighlight(this.id,datum),this.ctx.tooltipManager.updateTooltip(this.id,meta,html),this.ctx.ariaAnnouncementService.announceValue("ariaAnnounceHoverDatum",{datum:aria})}}onSubmit(event){const{series,datum}=this.focus,sourceEvent=event.sourceEvent.sourceEvent;series!==void 0&&datum!==void 0?series.fireNodeClickEvent(sourceEvent,datum):this.chart.fireEvent({type:"click",event:sourceEvent}),event.preventDefault()}getDatumAriaText(datum,html){var _a274,_b;const description=html.ariaLabel;return((_b=(_a274=datum.series).getDatumAriaText)==null?void 0:_b.call(_a274,datum,description))??description}},__name(_a133,"SeriesAreaFocusManager"),_a133),_a134,SeriesAreaHighlightManager=(_a134=class extends BaseManager{constructor(id,chart,ctx,highlight){super(),this.id=id,this.chart=chart,this.ctx=ctx,this.highlight=highlight,this.series=[],this.hoverScheduler=debouncedAnimationFrame(()=>{if(this.pendingHoverEvent){if(this.chart.performUpdateType<=4){this.hoverScheduler.schedule();return}this.handleHover(!1)}});const seriesRegion=this.ctx.regionManager.getRegion("series"),horizontalAxesRegion=this.ctx.regionManager.getRegion("horizontal-axes"),verticalAxesRegion=this.ctx.regionManager.getRegion("vertical-axes"),mouseMoveStates=20;this.destroyFns.push(this.ctx.layoutManager.addListener("layout:complete",event=>this.layoutComplete(event)),this.ctx.highlightManager.addListener("highlight-change",event=>this.changeHighlightDatum(event)),seriesRegion.addListener("hover",event=>this.onHover(event),mouseMoveStates),seriesRegion.addListener("drag",event=>this.onHover(event),mouseMoveStates),horizontalAxesRegion.addListener("hover",event=>this.onHover(event)),verticalAxesRegion.addListener("hover",event=>this.onHover(event)),this.ctx.domManager.addListener("resize",()=>this.clearHighlight()),seriesRegion.addListener("leave",()=>this.clearHighlight(),mouseMoveStates),this.ctx.keyNavManager.addListener("blur",()=>this.clearHighlight()),this.ctx.animationManager.addListener("animation-start",()=>this.clearHighlight()),this.ctx.zoomManager.addListener("zoom-pan-start",()=>this.clearHighlight()),this.ctx.zoomManager.addListener("zoom-change",()=>this.clearHighlight()))}seriesChanged(series){this.series=series}dataChanged(){this.stashedHoverEvent??(this.stashedHoverEvent=this.appliedHoverEvent),this.clearHighlight()}preSceneRender(){this.stashedHoverEvent!=null&&(this.pendingHoverEvent=this.stashedHoverEvent,this.stashedHoverEvent=void 0,this.handleHover(!0))}update(type,opts){this.ctx.updateService.update(type,opts)}layoutComplete(event){this.hoverRect=event.series.paddedRect}clearHighlight(){this.pendingHoverEvent=void 0,this.appliedHoverEvent=void 0,this.ctx.highlightManager.updateHighlight(this.id)}onHover(event){this.pendingHoverEvent=event,this.hoverScheduler.schedule()}handleHover(redisplay){var _a274;this.appliedHoverEvent=this.pendingHoverEvent,this.pendingHoverEvent=void 0;const event=this.appliedHoverEvent;if(!event)return;const state=this.ctx.interactionManager.getState();if(state!==16&&state!==4)return;const{offsetX,offsetY}=event;if(redisplay?this.ctx.animationManager.isActive():!((_a274=this.hoverRect)!=null&&_a274.containsPoint(offsetX,offsetY))){this.clearHighlight();return}let pickCoords={x:event.regionOffsetX,y:event.regionOffsetY};event.region!=="series"&&(pickCoords=Transformable.fromCanvasPoint(this.chart.seriesRoot,offsetX,offsetY));const{range:range3}=this.highlight,intent=range3==="tooltip"?"highlight-tooltip":"highlight",found=pickNode(this.series,pickCoords,intent);if(found){this.ctx.highlightManager.updateHighlight(this.id,found.datum);return}this.ctx.highlightManager.updateHighlight(this.id)}changeHighlightDatum(event){const seriesToUpdate=new Set,{series:newSeries=void 0,datum:newDatum}=event.currentHighlight??{},{series:lastSeries=void 0,datum:lastDatum}=event.previousHighlight??{};lastSeries&&seriesToUpdate.add(lastSeries),newSeries&&seriesToUpdate.add(newSeries),lastSeries!=null&&lastSeries.properties.cursor&&lastDatum&&this.ctx.cursorManager.updateCursor(lastSeries.id),newSeries!=null&&newSeries.properties.cursor&&(newSeries==null?void 0:newSeries.properties.cursor)!=="default"&&newDatum&&this.ctx.cursorManager.updateCursor(newSeries.id,newSeries.properties.cursor),newSeries==null||lastSeries==null?this.update(4):this.update(4,{seriesToUpdate})}},__name(_a134,"SeriesAreaHighlightManager"),_a134),_a135,SeriesAreaTooltipManager=(_a135=class extends BaseManager{constructor(id,chart,ctx,tooltip){super(),this.id=id,this.chart=chart,this.ctx=ctx,this.tooltip=tooltip,this.series=[],this.hoverRect=BBox.zero,this.hoverScheduler=debouncedAnimationFrame(()=>{if(this.lastHover){if(this.chart.performUpdateType<=4){this.hoverScheduler.schedule();return}this.handleHover(this.lastHover,!1)}});const seriesRegion=this.ctx.regionManager.getRegion("series"),horizontalAxesRegion=this.ctx.regionManager.getRegion("horizontal-axes"),verticalAxesRegion=this.ctx.regionManager.getRegion("vertical-axes");this.destroyFns.push(this.ctx.layoutManager.addListener("layout:complete",event=>this.layoutComplete(event)),seriesRegion.addListener("hover",event=>this.onHover(event),20),horizontalAxesRegion.addListener("hover",event=>this.onHover(event)),verticalAxesRegion.addListener("hover",event=>this.onHover(event)),seriesRegion.addListener("leave",()=>this.clearTooltip()),seriesRegion.addListener("contextmenu",()=>this.clearTooltip(),31),horizontalAxesRegion.addListener("leave",()=>this.clearTooltip()),verticalAxesRegion.addListener("leave",()=>this.clearTooltip()),this.ctx.keyNavManager.addListener("blur",()=>this.clearTooltip()),this.ctx.animationManager.addListener("animation-start",()=>this.clearTooltip()),this.ctx.domManager.addListener("resize",()=>this.clearTooltip()),this.ctx.zoomManager.addListener("zoom-pan-start",()=>this.clearTooltip()),this.ctx.zoomManager.addListener("zoom-change",()=>this.clearTooltip()))}seriesChanged(series){this.series=series}dataChanged(){this.ctx.tooltipManager.removeTooltip(this.id)}preSceneRender(){this.lastHover!=null&&this.handleHover(this.lastHover,!0)}layoutComplete(event){this.hoverRect=event.series.paddedRect}onHover(event){this.lastHover=event,this.hoverScheduler.schedule()}clearTooltip(){this.ctx.tooltipManager.removeTooltip(this.id),this.lastHover=void 0}handleHover(event,redisplay){var _a274;const state=this.ctx.interactionManager.getState();if(state!==16&&state!==4)return;const{offsetX,offsetY,targetElement,regionOffsetX,regionOffsetY}=event;if(redisplay?this.ctx.animationManager.isActive():!((_a274=this.hoverRect)!=null&&_a274.containsPoint(offsetX,offsetY))){this.clearTooltip();return}if(targetElement&&this.tooltip.interactive&&this.ctx.domManager.isManagedChildDOMElement(targetElement,"canvas-overlay",DEFAULT_TOOLTIP_CLASS))return;let pickCoords={x:regionOffsetX,y:regionOffsetY};event.region!=="series"&&(pickCoords=Transformable.fromCanvasPoint(this.chart.seriesRoot,offsetX,offsetY));const pick=pickNode(this.series,pickCoords,"tooltip");if(!pick){this.clearTooltip();return}const html=pick.series.getTooltipHtml(pick.datum);if(this.tooltip.enabled&&pick.series.tooltipEnabled&&html!=null){const meta=TooltipManager.makeTooltipMeta(event,pick.datum);this.ctx.tooltipManager.updateTooltip(this.id,meta,html)}}},__name(_a135,"SeriesAreaTooltipManager"),_a135),_a136,SeriesAreaManager=(_a136=class extends BaseManager{constructor(chart,ctx,chartType2,tooltip,highlight,overlays){super(),this.ctx=ctx,this.id=createId(this),this.series=[],this.subManagers=[new SeriesAreaFocusManager(this.id,chart,ctx,chartType2,overlays),new SeriesAreaHighlightManager(this.id,chart,ctx,highlight),new SeriesAreaTooltipManager(this.id,chart,ctx,tooltip),new SeriesAreaClickManager(this.id,chart,ctx)];const seriesRegion=this.ctx.regionManager.getRegion("series");this.destroyFns.push(()=>this.subManagers.forEach(s=>s.destroy()),seriesRegion.addListener("contextmenu",event=>this.onContextMenu(event),31),this.ctx.updateService.addListener("pre-scene-render",()=>this.preSceneRender()),this.ctx.layoutManager.addListener("layout:complete",event=>this.layoutComplete(event)))}dataChanged(){var _a274;for(const manager of this.subManagers)(_a274=manager.dataChanged)==null||_a274.call(manager)}preSceneRender(){var _a274;for(const manager of this.subManagers)(_a274=manager.preSceneRender)==null||_a274.call(manager)}seriesChanged(series){this.series=series;for(const manager of this.subManagers)manager.seriesChanged([...series])}layoutComplete(event){this.seriesRect=event.series.rect}onContextMenu(event){const{Default:Default2,ContextMenu}=InteractionState;let pickedNode,position;if(this.ctx.focusIndicator.guessDevice(event.sourceEvent).type==="keyboard")pickedNode=this.ctx.highlightManager.getActiveHighlight(),pickedNode&&this.seriesRect&&pickedNode.midPoint&&(position={x:this.seriesRect.x+pickedNode.midPoint.x,y:this.seriesRect.y+pickedNode.midPoint.y});else if(this.ctx.interactionManager.getState()&(Default2|ContextMenu)){const match=pickNode(this.series,{x:event.regionOffsetX,y:event.regionOffsetY},"context-menu");match&&(this.ctx.highlightManager.updateHighlight(this.id),pickedNode=match.datum)}this.ctx.contextMenuRegistry.dispatchContext("series",event,{pickedNode},position)}},__name(_a136,"SeriesAreaManager"),_a136),SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION=30,_a137,SeriesLayerManager=(_a137=class{constructor(seriesRoot,highlightRoot,annotationRoot){this.seriesRoot=seriesRoot,this.highlightRoot=highlightRoot,this.annotationRoot=annotationRoot,this.groups={},this.series={},this.expectedSeriesCount=1,this.mode="normal"}setSeriesCount(count){this.expectedSeriesCount=count}requestGroup(seriesConfig){var _a274,_b;const{internalId,type,rootGroup:seriesRootGroup,highlightGroup:seriesHighlightGroup,annotationGroup:seriesAnnotationGroup,seriesGrouping}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{};if(this.series[internalId]!=null)throw new Error(`AG Charts - series already has an allocated layer: ${this.series[internalId]}`);Object.keys(this.series).length===0&&(this.mode=this.expectedSeriesCount>=SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION?"aggressive-grouping":"normal"),(_a274=this.groups)[type]??(_a274[type]={});const lookupIndex=this.lookupIdx(groupIndex);let groupInfo=this.groups[type][lookupIndex];return groupInfo||(groupInfo=(_b=this.groups[type])[lookupIndex]??(_b[lookupIndex]={type,id:lookupIndex,seriesIds:[],group:this.seriesRoot.appendChild(new Group({name:`${type}-content`,layer:!0,zIndex:4,zIndexSubOrder:seriesConfig.getGroupZIndexSubOrder("data")})),highlight:this.highlightRoot.appendChild(new Group({name:`${type}-highlight`,zIndex:4,zIndexSubOrder:seriesConfig.getGroupZIndexSubOrder("highlight")})),annotation:this.annotationRoot.appendChild(new Group({name:`${type}-annotation`,zIndex:4,zIndexSubOrder:seriesConfig.getGroupZIndexSubOrder("annotation")}))})),this.series[internalId]={layerState:groupInfo,seriesConfig},groupInfo.seriesIds.push(internalId),groupInfo.group.appendChild(seriesRootGroup),groupInfo.highlight.appendChild(seriesHighlightGroup),groupInfo.annotation.appendChild(seriesAnnotationGroup),groupInfo.group}changeGroup(seriesConfig){var _a274,_b;const{internalId,seriesGrouping,type,rootGroup,highlightGroup,annotationGroup,oldGrouping}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{};(_b=(_a274=this.groups[type])==null?void 0:_a274[groupIndex])!=null&&_b.seriesIds.includes(internalId)||(this.series[internalId]!=null&&this.releaseGroup({internalId,seriesGrouping:oldGrouping,type,rootGroup,highlightGroup,annotationGroup}),this.requestGroup(seriesConfig))}releaseGroup(seriesConfig){var _a274,_b,_c;const{internalId,rootGroup,highlightGroup,annotationGroup,type}=seriesConfig;if(this.series[internalId]==null)throw new Error(`AG Charts - series doesn't have an allocated layer: ${internalId}`);const groupInfo=(_a274=this.series[internalId])==null?void 0:_a274.layerState;if(groupInfo&&(groupInfo.seriesIds=groupInfo.seriesIds.filter(v=>v!==internalId),groupInfo.group.removeChild(rootGroup),groupInfo.highlight.removeChild(highlightGroup),groupInfo.annotation.removeChild(annotationGroup)),(groupInfo==null?void 0:groupInfo.seriesIds.length)===0)this.seriesRoot.removeChild(groupInfo.group),this.highlightRoot.removeChild(groupInfo.highlight),this.annotationRoot.removeChild(groupInfo.annotation),delete this.groups[groupInfo.type][groupInfo.id],delete this.groups[type][internalId];else if((groupInfo==null?void 0:groupInfo.seriesIds.length)>0){const leadSeriesConfig=(_c=this.series[(_b=groupInfo==null?void 0:groupInfo.seriesIds)==null?void 0:_b[0]])==null?void 0:_c.seriesConfig;groupInfo.group.zIndexSubOrder=leadSeriesConfig==null?void 0:leadSeriesConfig.getGroupZIndexSubOrder("data"),groupInfo.highlight.zIndexSubOrder=leadSeriesConfig==null?void 0:leadSeriesConfig.getGroupZIndexSubOrder("highlight"),groupInfo.annotation.zIndexSubOrder=leadSeriesConfig==null?void 0:leadSeriesConfig.getGroupZIndexSubOrder("annotation")}delete this.series[internalId]}lookupIdx(groupIndex){return this.mode==="normal"?groupIndex:typeof groupIndex=="string"&&(groupIndex=Number(groupIndex.split("-").at(-1)),!groupIndex)?0:Math.floor(clamp(0,groupIndex/this.expectedSeriesCount,1)*SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION)}destroy(){for(const groups of Object.values(this.groups))for(const groupInfo of Object.values(groups))this.seriesRoot.removeChild(groupInfo.group),this.highlightRoot.removeChild(groupInfo.highlight),this.annotationRoot.removeChild(groupInfo.annotation);this.groups={},this.series={}}},__name(_a137,"SeriesLayerManager"),_a137),_a138,DataWindowProcessor=(_a138=class{constructor(chart,dataService,updateService,zoomManager){this.chart=chart,this.dataService=dataService,this.updateService=updateService,this.zoomManager=zoomManager,this.dirtyZoom=!1,this.dirtyDataSource=!1,this.lastAxisZooms=new Map,this.destroyFns=[],this.destroyFns.push(this.dataService.addListener("data-source-change",()=>this.onDataSourceChange()),this.dataService.addListener("data-load",()=>this.onDataLoad()),this.dataService.addListener("data-error",()=>this.onDataError()),this.updateService.addListener("update-complete",()=>this.onUpdateComplete()),this.zoomManager.addListener("zoom-change",()=>this.onZoomChange()))}destroy(){this.destroyFns.forEach(cb=>cb())}onDataLoad(){this.updateService.update(1)}onDataError(){this.updateService.update(3)}onDataSourceChange(){this.dirtyDataSource=!0}onUpdateComplete(){!this.dirtyZoom&&!this.dirtyDataSource||this.updateWindow().catch(e=>Logger.errorOnce(e))}onZoomChange(){this.dirtyZoom=!0}async updateWindow(){if(!this.dataService.isLazy())return;const axis=this.getValidAxis();let window2,shouldRefresh=!0;if(axis){const zoom2=this.zoomManager.getAxisZoom(axis.id);window2=this.getAxisWindow(axis,zoom2),shouldRefresh=this.shouldRefresh(axis,zoom2)}this.dirtyZoom=!1,this.dirtyDataSource=!1,shouldRefresh&&this.dataService.load({windowStart:window2==null?void 0:window2.min,windowEnd:window2==null?void 0:window2.max})}getValidAxis(){return this.chart.axes.find(axis=>axis.type==="time")}shouldRefresh(axis,zoom2){if(this.dirtyDataSource)return!0;if(!this.dirtyZoom)return!1;const lastZoom=this.lastAxisZooms.get(axis.id);return lastZoom&&zoom2.min===lastZoom.min&&zoom2.max===lastZoom.max?!1:(this.lastAxisZooms.set(axis.id,zoom2),!0)}getAxisWindow(axis,zoom2){var _a274,_b;const domain=(_b=(_a274=axis.scale).getDomain)==null?void 0:_b.call(_a274);if(!zoom2||!domain||domain.length===0||isNaN(Number(domain[0])))return;const diff2=Number(domain[1])-Number(domain[0]),min=new Date(Number(domain[0])+diff2*zoom2.min),max=new Date(Number(domain[0])+diff2*zoom2.max);return{min,max}}},__name(_a138,"DataWindowProcessor"),_a138),_a139,OverlaysProcessor=(_a139=class{constructor(chartLike,overlays,dataService,layoutManager,localeManager,animationManager,domManager){this.chartLike=chartLike,this.overlays=overlays,this.dataService=dataService,this.layoutManager=layoutManager,this.localeManager=localeManager,this.animationManager=animationManager,this.domManager=domManager,this.destroyFns=[],this.overlayElem=this.domManager.addChild("canvas-overlay","overlay"),this.overlayElem.role="status",this.overlayElem.ariaAtomic="false",this.overlayElem.ariaLive="polite",this.overlayElem.classList.toggle(DEFAULT_OVERLAY_CLASS),this.destroyFns.push(this.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)))}destroy(){this.destroyFns.forEach(cb=>cb()),this.domManager.removeStyles("overlays"),this.domManager.removeChild("canvas-overlay","overlay")}onLayoutComplete({series:{rect}}){const isLoading=this.dataService.isLoading(),hasData=this.chartLike.series.some(s=>s.hasData),anySeriesVisible=this.chartLike.series.some(s=>s.visible);this.overlays.darkTheme?this.overlayElem.classList.add(DEFAULT_OVERLAY_DARK_CLASS):this.overlayElem.classList.remove(DEFAULT_OVERLAY_DARK_CLASS),this.overlayElem.style.left=`${rect.x}px`,this.overlayElem.style.top=`${rect.y}px`,this.overlayElem.style.width=`${rect.width}px`,this.overlayElem.style.height=`${rect.height}px`;const loadingShown=isLoading,noDataShown=!isLoading&&!hasData,noVisibleSeriesShown=hasData&&!anySeriesVisible;this.toggleOverlay(this.overlays.loading,rect,loadingShown),this.toggleOverlay(this.overlays.noData,rect,noDataShown),this.toggleOverlay(this.overlays.noVisibleSeries,rect,noVisibleSeriesShown);const shown=loadingShown||noDataShown||noVisibleSeriesShown;setAttribute(this.overlayElem,"aria-hidden",!shown)}toggleOverlay(overlay,seriesRect,visible){if(visible){const element2=overlay.getElement(this.animationManager,this.localeManager,seriesRect);this.overlayElem.appendChild(element2)}else overlay.removeElement(()=>{this.overlayElem.innerText=" "},this.animationManager)}},__name(_a139,"OverlaysProcessor"),_a139),debug=Debug.create(!0,"opts"),_a140,SeriesArea=(_a140=class extends BaseProperties{constructor(){super(...arguments),this.padding=new Padding(0)}},__name(_a140,"SeriesArea"),_a140);__decorateClass([Validate(BOOLEAN,{optional:!0})],SeriesArea.prototype,"clip",2);__decorateClass([Validate(OBJECT)],SeriesArea.prototype,"padding",2);var _a141,_Chart=(_a141=class extends Observable{constructor(options,resources){var _a274;super(),this.id=createId(this),this.seriesRoot=new TranslatableGroup({name:`${this.id}-series-root`}),this.highlightRoot=new TranslatableGroup({name:`${this.id}-highlight-root`,layer:!0,zIndex:5,nonEmptyChildDerivedZIndex:!0}),this.annotationRoot=new TranslatableGroup({name:`${this.id}-annotation-root`,layer:!0,zIndex:11}),this.debug=Debug.create(),this.extraDebugStats={},this.data=[],this._firstAutoSize=!0,this.padding=new Padding(20),this.seriesArea=new SeriesArea,this.keyboard=new Keyboard,this.mode="standalone",this.chartCaptions=new ChartCaptions,this.destroyed=!1,this._skipSync=!1,this._destroyFns=[],this.chartAnimationPhase="initial",this.modulesManager=new ModulesManager,this.processors=[],this.queuedUserOptions=[],this._pendingFactoryUpdatesCount=0,this._performUpdateNoRenderCount=0,this._performUpdateSkipAnimations=!1,this.performUpdateType=7,this.updateShortcutCount=0,this.seriesToUpdate=new Set,this.updateMutex=new Mutex,this.updateRequestors={},this.performUpdateTrigger=debouncedCallback(async({count})=>{this.destroyed||this.updateMutex.acquire(async()=>{try{await this.performUpdate(count)}catch(error){Logger.error("update error",error)}}).catch(e=>Logger.errorOnce(e))}),this._performUpdateSplits={},this.axes=[],this.series=[],this.onSeriesNodeClick=event=>{this.fireEvent({...event,type:"seriesNodeClick"})},this.onSeriesNodeDoubleClick=event=>{this.fireEvent({...event,type:"seriesNodeDoubleClick"})},this.seriesGroupingChanged=event=>{if(!(event instanceof SeriesGroupingChangedEvent))return;const{series,seriesGrouping,oldGrouping}=event;series.rootGroup.parent!=null&&this.seriesLayerManager.changeGroup({internalId:series.internalId,type:series.type,rootGroup:series.rootGroup,highlightGroup:series.highlightGroup,annotationGroup:series.annotationGroup,getGroupZIndexSubOrder:__name(type=>series.getGroupZIndexSubOrder(type),"getGroupZIndexSubOrder"),seriesGrouping,oldGrouping})},this.dataProcessListeners=new Set,this.chartOptions=options;const scene=resources==null?void 0:resources.scene,container=(resources==null?void 0:resources.container)??options.processedOptions.container??void 0,root=new Group({name:"root"}),titleGroup=new Group({name:"titles",layer:!0,zIndex:9});root.visible=!1,root.append(titleGroup),root.append(this.seriesRoot),root.append(this.highlightRoot),root.append(this.annotationRoot),titleGroup.append(this.title.node),titleGroup.append(this.subtitle.node),titleGroup.append(this.footnote.node),this.tooltip=new Tooltip,this.seriesLayerManager=new SeriesLayerManager(this.seriesRoot,this.highlightRoot,this.annotationRoot);const ctx=this.ctx=new ChartContext(this,{scene,root,container,syncManager:new SyncManager(this),pixelRatio:options.specialOverrides.overrideDevicePixelRatio,updateCallback:__name((type=0,opts)=>this.update(type,opts),"updateCallback"),updateMutex:this.updateMutex});this._destroyFns.push(ctx.domManager.addListener("resize",()=>this.parentResize(ctx.domManager.containerSize))),this.overlays=new ChartOverlays,(_a274=this.overlays.loading).renderer??(_a274.renderer=()=>getLoadingSpinner(this.overlays.loading.getText(ctx.localeManager),ctx.animationManager.defaultDuration)),this.processors=[new DataWindowProcessor(this,ctx.dataService,ctx.updateService,ctx.zoomManager),new OverlaysProcessor(this,this.overlays,ctx.dataService,ctx.layoutManager,ctx.localeManager,ctx.animationManager,ctx.domManager)],this.highlight=new ChartHighlight,this.container=container;const moduleContext=this.getModuleContext();ctx.regionManager.addRegion("series",this.seriesRoot,new SimpleRegionBBoxProvider(this.seriesRoot,()=>this.seriesRect??BBox.zero),this.ctx.axisManager.axisGridGroup),ctx.regionManager.addRegion("horizontal-axes"),ctx.regionManager.addRegion("vertical-axes");const thisChart=this;this.seriesAreaManager=new SeriesAreaManager({fireEvent:this.fireEvent.bind(thisChart),get performUpdateType(){return thisChart.performUpdateType},seriesRoot:this.seriesRoot},ctx,this.getChartType(),this.tooltip,this.highlight,this.overlays),ctx.regionManager.addRegion("root",root),this._destroyFns.push(ctx.layoutManager.registerElement(0,e=>{e.layoutBox.shrink(this.padding.toJson()),this.chartCaptions.positionCaptions(e)}),ctx.layoutManager.addListener("layout:complete",e=>this.chartCaptions.positionAbsoluteCaptions(e)),ctx.dataService.addListener("data-load",event=>{this.data=event.data}),this.title.registerInteraction(moduleContext),this.subtitle.registerInteraction(moduleContext),this.footnote.registerInteraction(moduleContext),ctx.interactionManager.addListener("page-left",()=>this.destroy()),ctx.animationManager.addListener("animation-frame",()=>{this.update(6)}),ctx.zoomManager.addListener("zoom-change",()=>{this.series.map(s=>{var _a275;return(_a275=s.animationState)==null?void 0:_a275.transition("updateData")});const skipAnimations=this.chartAnimationPhase!=="initial";this.update(3,{forceNodeDataRefresh:!0,skipAnimations})})),this.parentResize(ctx.domManager.containerSize)}static getInstance(element2){return _a141.chartsInstances.get(element2)}get canvasElement(){return this.ctx.scene.canvas.element}download(fileName,fileFormat){this.ctx.scene.download(fileName,fileFormat)}getCanvasDataURL(fileFormat){return this.ctx.scene.getDataURL(fileFormat)}getOptions(){return this.queuedUserOptions.at(-1)??this.chartOptions.userOptions}getModuleContext(){return this.ctx}getCaptionText(){return[this.title,this.subtitle,this.footnote].filter(caption=>caption.enabled&&caption.text).map(caption=>caption.text).join(". ")}getAriaLabel(){return this.ctx.localeManager.t("ariaAnnounceChart",{seriesCount:this.series.length})}resetAnimations(){this.chartAnimationPhase="initial";for(const series of this.series)series.resetAnimation(this.chartAnimationPhase);for(const axis of this.axes)axis.resetAnimation(this.chartAnimationPhase);this.animationRect=void 0,this.ctx.animationManager.reset()}skipAnimations(){this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0}destroy(opts){if(this.destroyed)return;const keepTransferableResources=opts==null?void 0:opts.keepTransferableResources;let result;return this.performUpdateType=7,this._destroyFns.forEach(fn=>fn()),this.processors.forEach(p=>p.destroy()),this.tooltip.destroy(this.ctx.domManager),this.overlays.destroy(),this.modulesManager.destroy(),keepTransferableResources?(this.ctx.scene.strip(),result={container:this.container,scene:this.ctx.scene}):(this.ctx.scene.destroy(),this.container=void 0),this.destroySeries(this.series),this.seriesLayerManager.destroy(),this.axes.forEach(a=>a.destroy()),this.axes=[],this.animationRect=void 0,this.ctx.destroy(),this.destroyed=!0,Object.freeze(this),result}requestFactoryUpdate(cb){this.destroyed||(this._pendingFactoryUpdatesCount++,this.updateMutex.acquire(async()=>{this.destroyed||(await cb(this),!this.destroyed&&this._pendingFactoryUpdatesCount--)}).catch(e=>Logger.errorOnce(e)))}update(type=0,opts){const{forceNodeDataRefresh=!1,skipAnimations,seriesToUpdate=this.series,newAnimationBatch}=opts??{};forceNodeDataRefresh&&this.series.forEach(series=>series.markNodeDataDirty());for(const series of seriesToUpdate)this.seriesToUpdate.add(series);if(skipAnimations&&(this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0),newAnimationBatch&&this.ctx.animationManager.isActive()&&(this._performUpdateSkipAnimations=!0),this._skipSync=(opts==null?void 0:opts.skipSync)??!1,this.debug.check()){let stack=new Error().stack??"<unknown>";stack=stack.replace(/\([^)]*/g,""),this.updateRequestors[stack]=type}type<this.performUpdateType&&(this.performUpdateType=type,this.performUpdateTrigger.schedule(opts==null?void 0:opts.backOffMs))}async performUpdate(count){const{performUpdateType,extraDebugStats,_performUpdateSplits:splits,ctx}=this,seriesToUpdate=[...this.seriesToUpdate];this.performUpdateType=7,this.seriesToUpdate.clear(),this.updateShortcutCount===0&&performUpdateType<6&&(ctx.animationManager.startBatch(this._performUpdateSkipAnimations),ctx.animationManager.onBatchStop(()=>this.chartAnimationPhase="ready")),this.debug("Chart.performUpdate() - start",ChartUpdateType[performUpdateType]);let previousSplit=performance.now();splits.start??(splits.start=previousSplit);const updateSplits=__name(splitName=>{splits[splitName]??(splits[splitName]=0),splits[splitName]+=performance.now()-previousSplit,previousSplit=performance.now()},"updateSplits");let updateDeferred=!1;switch(performUpdateType){case 0:this.ctx.updateService.dispatchPreDomUpdate(),this.updateDOM();case 1:await this.updateData(),updateSplits("⬇️");case 2:await this.processData(),this.seriesAreaManager.dataChanged(),updateSplits("🏭");case 3:if(this.checkUpdateShortcut(3))break;if(!this.checkFirstAutoSize(seriesToUpdate)){updateDeferred=!0;break}await this.processLayout(),updateSplits("⌖");case 4:if(this.checkUpdateShortcut(4))break;const{seriesRect}=this;await Promise.all(seriesToUpdate.map(series=>series.update({seriesRect}))),updateSplits("🤔"),this.updateAriaLabels();case 5:if(this.checkUpdateShortcut(5))break;ctx.updateService.dispatchPreSceneRender(this.getMinRects()),updateSplits("↖");case 6:if(this.checkUpdateShortcut(6))break;ctx.animationManager.endBatch(),extraDebugStats.updateShortcutCount=this.updateShortcutCount,await ctx.scene.render({debugSplitTimes:splits,extraDebugStats,seriesRect:this.seriesRect}),this.extraDebugStats={};for(const key in splits)delete splits[key];this.ctx.domManager.incrementDataCounter("sceneRenders");case 7:this.updateShortcutCount=0,this.updateRequestors={},this._performUpdateSkipAnimations=!1,ctx.animationManager.endBatch()}updateDeferred||ctx.updateService.dispatchUpdateComplete(this.getMinRects());const end=performance.now();this.debug("Chart.performUpdate() - end",{chart:this,durationMs:Math.round((end-splits.start)*100)/100,count,performUpdateType:ChartUpdateType[performUpdateType]})}updateThemeClassName(){const{theme}=this.chartOptions.processedOptions,themeClassNamePrefix="ag-charts-theme-",validThemeClassNames=[`${themeClassNamePrefix}default`,`${themeClassNamePrefix}default-dark`];let themeClassName=validThemeClassNames[0],isDark=!1;typeof theme=="string"?(themeClassName=theme.replace("ag-",themeClassNamePrefix),isDark=theme.includes("-dark")):typeof(theme==null?void 0:theme.baseTheme)=="string"&&(themeClassName=theme.baseTheme.replace("ag-",themeClassNamePrefix),isDark=theme.baseTheme.includes("-dark")),validThemeClassNames.includes(themeClassName)||(themeClassName=isDark?validThemeClassNames[1]:validThemeClassNames[0]),this.ctx.domManager.setThemeClass(themeClassName)}updateDOM(){this.updateThemeClassName();const{enabled,tabIndex}=this.keyboard;this.ctx.domManager.setTabIndex(enabled?tabIndex??0:-1)}updateAriaLabels(){setAttribute(this.ctx.scene.canvas.element,"role","img"),setAttribute(this.ctx.scene.canvas.element,"aria-label",this.getAriaLabel())}checkUpdateShortcut(checkUpdateType){return this.updateShortcutCount>3?(Logger.warn("exceeded the maximum number of simultaneous updates (4), discarding changes and rendering",this.updateRequestors),!1):this.performUpdateType<=checkUpdateType?(this.updateShortcutCount++,!0):!1}checkFirstAutoSize(seriesToUpdate){if(!(this.width!=null&&this.height!=null)){if(!this._lastAutoSize){const count=this._performUpdateNoRenderCount++,backOffMs=(count+1)**2*40;if(count<8)return this.update(3,{seriesToUpdate,backOffMs}),this.debug("Chart.checkFirstAutoSize() - backing off until first size update",backOffMs),!1;this.debug("Chart.checkFirstAutoSize() - timeout for first size update.")}}return this._performUpdateNoRenderCount=0,!0}onAxisChange(newValue,oldValue){oldValue==null&&newValue.length===0||this.ctx.axisManager.updateAxes(oldValue??[],newValue)}onSeriesChange(newValue,oldValue){var _a274,_b;const seriesToDestroy=(oldValue==null?void 0:oldValue.filter(series=>!newValue.includes(series)))??[];this.destroySeries(seriesToDestroy),(_a274=this.seriesLayerManager)==null||_a274.setSeriesCount(newValue.length);for(const series of newValue){if(oldValue!=null&&oldValue.includes(series))continue;series.rootGroup.parent==null&&this.seriesLayerManager.requestGroup(series);const chart=this;series.chart={get mode(){return chart.mode},get isMiniChart(){return!1},get seriesRect(){return chart.seriesRect},placeLabels(padding){return chart.placeLabels(padding)}},series.resetAnimation(this.chartAnimationPhase),this.addSeriesListeners(series),series.addChartEventListeners()}(_b=this.seriesAreaManager)==null||_b.seriesChanged(newValue)}destroySeries(allSeries){allSeries==null||allSeries.forEach(series=>{series.removeEventListener("nodeClick",this.onSeriesNodeClick),series.removeEventListener("nodeDoubleClick",this.onSeriesNodeDoubleClick),series.removeEventListener("groupingChanged",this.seriesGroupingChanged),series.destroy(),this.seriesLayerManager.releaseGroup(series),series.chart=void 0})}addSeriesListeners(series){this.hasEventListener("seriesNodeClick")&&series.addEventListener("nodeClick",this.onSeriesNodeClick),this.hasEventListener("seriesNodeDoubleClick")&&series.addEventListener("nodeDoubleClick",this.onSeriesNodeDoubleClick),series.addEventListener("groupingChanged",this.seriesGroupingChanged)}assignSeriesToAxes(){for(const axis of this.axes)axis.boundSeries=this.series.filter(s=>s.axes[axis.direction]===axis)}assignAxesToSeries(){const directionToAxesMap=groupBy(this.axes,axis=>axis.direction);this.series.forEach(series=>{series.directions.forEach(direction=>{const directionAxes=directionToAxesMap[direction];if(!directionAxes){Logger.warnOnce(`no available axis for direction [${direction}]; check series and axes configuration.`);return}const seriesKeys=series.getKeys(direction),newAxis=directionAxes.find(axis=>!axis.keys.length||seriesKeys.some(key=>axis.keys.includes(key)));if(!newAxis){Logger.warnOnce(`no matching axis for direction [${direction}] and keys [${seriesKeys}]; check series and axes configuration.`);return}series.axes[direction]=newAxis})})}parentResize(size){if(size==null||this.width!=null&&this.height!=null)return;let{width,height}=size;if(width=Math.floor(width),height=Math.floor(height),width===0&&height===0)return;const[autoWidth=0,authHeight=0]=this._lastAutoSize??[];autoWidth===width&&authHeight===height||(this._lastAutoSize=[width,height],this.resize("SizeMonitor",{}))}resize(source,opts){var _a274,_b;const{scene,animationManager}=this.ctx,{inWidth,inHeight,inMinWidth,inMinHeight}=opts;this.ctx.domManager.setSizeOptions(inMinWidth??this.minWidth,inMinHeight??this.minHeight,inWidth??this.width,inHeight??this.height);const width=inWidth??this.width??((_a274=this._lastAutoSize)==null?void 0:_a274[0]),height=inHeight??this.height??((_b=this._lastAutoSize)==null?void 0:_b[1]);if(this.debug(`Chart.resize() from ${source}`,{width,height,stack:new Error().stack}),!(width==null||height==null||!isFiniteNumber(width)||!isFiniteNumber(height))&&scene.resize(width,height)){animationManager.reset();let skipAnimations=!0;(this.width==null||this.height==null)&&this._firstAutoSize&&(skipAnimations=!1,this._firstAutoSize=!1),this.update(3,{forceNodeDataRefresh:!0,skipAnimations})}}async updateData(){this.series.forEach(s=>s.setChartData(this.data));const modulePromises=this.modulesManager.mapModules(m=>{var _a274;return(_a274=m.updateData)==null?void 0:_a274.call(m,this.data)});await Promise.all(modulePromises)}async processData(){if(this.series.some(s=>s.canHaveAxes)){this.assignAxesToSeries();const syncModule=this.modulesManager.getModule("sync");syncModule!=null&&syncModule.enabled?syncModule.syncAxes(this._skipSync):this.assignSeriesToAxes()}const dataController=new DataController(this.mode),seriesPromises=this.series.map(s=>s.processData(dataController)),modulePromises=this.modulesManager.mapModules(m=>{var _a274;return(_a274=m.processData)==null?void 0:_a274.call(m,dataController)});dataController.execute(),await Promise.all([...seriesPromises,...modulePromises]);for(const{legendType,legend}of this.modulesManager.legends())legend.data=this.getLegendData(legendType,this.mode!=="integrated");this.dataProcessListeners.forEach(resolve=>resolve()),this.dataProcessListeners.clear()}placeLabels(padding){const visibleSeries=[],data=[];for(const series of this.series){if(!series.visible)continue;const labelData=series.getLabelData();isPointLabelDatum(labelData==null?void 0:labelData[0])&&(data.push(labelData),visibleSeries.push(series))}const{seriesRect}=this,{top,right,bottom,left}=this.seriesArea.padding,labels=seriesRect&&data.length>0?placeLabels(data,{x:-left,y:-top,width:seriesRect.width+left+right,height:seriesRect.height+top+bottom},padding):[];return new Map(labels.map((l,i)=>[visibleSeries[i],l]))}getLegendData(legendType,warnConflicts){var _a274;const legendData=this.series.filter(s=>s.properties.showInLegend).flatMap(s=>s.getLegendData(legendType));if(warnConflicts&&__name(data=>data.every(d=>d.legendType==="category"),"isCategoryLegendData")(legendData)){const seriesMarkerFills={},seriesTypeMap=new Map(this.series.map(s=>[s.id,s.type]));for(const{seriesId,symbols:[{marker}],label}of legendData){if(marker.fill==null)continue;const seriesType2=seriesTypeMap.get(seriesId),markerFill=seriesMarkerFills[seriesType2]??(seriesMarkerFills[seriesType2]={});markerFill[_a274=label.text]??(markerFill[_a274]=marker.fill),markerFill[label.text]!==marker.fill&&Logger.warnOnce(`legend item '${label.text}' has multiple fill colors, this may cause unexpected behaviour.`)}}return legendData}async processLayout(){var _a274;const oldRect=this.animationRect,{width,height}=this.ctx.scene,ctx=this.ctx.layoutManager.createContext(width,height);await this.performLayout(ctx),oldRect&&!((_a274=this.animationRect)!=null&&_a274.equals(oldRect))&&this.ctx.animationManager.skipCurrentBatch(),this.debug("Chart.performUpdate() - seriesRect",this.seriesRect)}async waitForUpdate(timeoutMs=1e4,failOnTimeout=!1){const start=performance.now();for(this._pendingFactoryUpdatesCount>0&&await this.updateMutex.waitForClearAcquireQueue();this.performUpdateType!==7;){if(performance.now()-start>timeoutMs){const message=`Chart.waitForUpdate() timeout of ${timeoutMs} reached - first chart update taking too long.`;if(failOnTimeout)throw new Error(message);Logger.warnOnce(message)}await sleep(50)}await this.updateMutex.waitForClearAcquireQueue()}waitForDataProcess(timeout){return new Promise(resolve=>{this.dataProcessListeners.add(resolve),isNumber(timeout)&&setTimeout(()=>{this.dataProcessListeners.has(resolve)&&(this.dataProcessListeners.delete(resolve),resolve())},timeout)})}getMinRects(){const{width,height}=this.ctx.scene,minRects=this.series.map(series=>series.getMinRects(width,height)).filter(isDefined);if(minRects.length===0)return;let maxWidth=0,maxHeight=0,maxVisibleWidth=0,maxVisibleHeight=0;for(const{minRect:minRect2,minVisibleRect:minVisibleRect2}of minRects)maxWidth=Math.max(maxWidth,minRect2.width),maxHeight=Math.max(maxHeight,minRect2.height),maxVisibleWidth=Math.max(maxVisibleWidth,minVisibleRect2.width),maxVisibleHeight=Math.max(maxVisibleHeight,minVisibleRect2.height);const minRect=new BBox(0,0,maxWidth,maxHeight);let minVisibleRect=minRect.clone();return maxVisibleWidth>0&&maxVisibleHeight>0&&(minVisibleRect=new BBox(0,0,maxVisibleWidth,maxVisibleHeight)),{minRect,minVisibleRect}}filterMiniChartSeries(series){return series==null?void 0:series.filter(s=>s.showInMiniChart!==!1)}applyOptions(newChartOptions){var _a274,_b,_c,_d,_e;const oldOpts=newChartOptions!==this.chartOptions?this.chartOptions.processedOptions:{},newOpts=newChartOptions.processedOptions,deltaOptions=newChartOptions.diffOptions(oldOpts);if(deltaOptions==null)return;debug("Chart.applyOptions() - applying delta",deltaOptions);const modulesChanged=this.applyModules(newOpts),skip=["type","data","series","listeners","preset","theme","legend.listeners","navigator.miniChart.series","navigator.miniChart.label","locale.localeText","axes","topology","nodes","initialState"];deltaOptions.listeners&&this.registerListeners(this,deltaOptions.listeners),jsonApply(this,deltaOptions,{skip});let forceNodeDataRefresh=!1,seriesStatus="no-op";deltaOptions.series!=null&&(seriesStatus=this.applySeries(this,deltaOptions.series,oldOpts==null?void 0:oldOpts.series),forceNodeDataRefresh=!0),seriesStatus==="replaced"&&this.resetAnimations(),this.applyAxes(this,newOpts,oldOpts,seriesStatus,[],!0)&&(forceNodeDataRefresh=!0),deltaOptions.data&&(this.data=deltaOptions.data),(_a274=deltaOptions.legend)!=null&&_a274.listeners&&this.modulesManager.isEnabled("legend")&&Object.assign(this.legend.listeners,deltaOptions.legend.listeners),(_b=deltaOptions.locale)!=null&&_b.localeText&&(this.modulesManager.getModule("locale").localeText=(_c=deltaOptions.locale)==null?void 0:_c.localeText),this.chartOptions=newChartOptions;const navigatorModule=this.modulesManager.getModule("navigator"),zoomModule=this.modulesManager.getModule("zoom");!(navigatorModule!=null&&navigatorModule.enabled)&&!(zoomModule!=null&&zoomModule.enabled)&&this.ctx.zoomManager.updateZoom("chart");const miniChart=navigatorModule==null?void 0:navigatorModule.miniChart,miniChartSeries=((_e=(_d=newOpts.navigator)==null?void 0:_d.miniChart)==null?void 0:_e.series)??newOpts.series;(miniChart==null?void 0:miniChart.enabled)===!0&&miniChartSeries!=null?this.applyMiniChartOptions(miniChart,miniChartSeries,newOpts,oldOpts):(miniChart==null?void 0:miniChart.enabled)===!1&&(miniChart.series=[],miniChart.axes=[]),this.ctx.annotationManager.setAnnotationStyles(newChartOptions.annotationThemes),forceNodeDataRefresh||(forceNodeDataRefresh=this.shouldForceNodeDataRefresh(deltaOptions,seriesStatus));const updateType=forceNodeDataRefresh||modulesChanged?0:3;this.maybeResetAnimations(seriesStatus),debug("Chart.applyOptions() - update type",ChartUpdateType[updateType],{seriesStatus,forceNodeDataRefresh}),this.update(updateType,{forceNodeDataRefresh,newAnimationBatch:!0}),(deltaOptions.initialState||deltaOptions.theme)&&this.applyInitialState(newChartOptions.userOptions.initialState)}applyInitialState(initialState){const{ctx:{annotationManager,historyManager,stateManager}}=this;if((initialState==null?void 0:initialState.annotations)!=null){const annotations2=initialState.annotations.map(annotation=>{const annotationTheme=annotationManager.getAnnotationTypeStyles(annotation.type);return mergeDefaults(annotation,annotationTheme)});stateManager.setState(annotationManager,annotations2)}initialState!=null&&historyManager.clear()}maybeResetAnimations(seriesStatus){if(this.mode==="standalone")switch(seriesStatus){case"series-grouping-change":case"replaced":this.resetAnimations();break}}shouldForceNodeDataRefresh(deltaOptions,seriesStatus){const seriesDataUpdate=!!deltaOptions.data||seriesStatus==="data-change"||seriesStatus==="replaced",legendKeys=legendRegistry.getKeys(),optionsHaveLegend=Object.values(legendKeys).some(legendKey=>deltaOptions[legendKey]!=null),otherRefreshUpdate=deltaOptions.title!=null&&deltaOptions.subtitle!=null;return seriesDataUpdate||optionsHaveLegend||otherRefreshUpdate}applyMiniChartOptions(miniChart,miniChartSeries,completeOptions,oldOpts){var _a274,_b,_c,_d;const oldSeries=((_b=(_a274=oldOpts==null?void 0:oldOpts.navigator)==null?void 0:_a274.miniChart)==null?void 0:_b.series)??(oldOpts==null?void 0:oldOpts.series),miniChartSeriesStatus=this.applySeries(miniChart,this.filterMiniChartSeries(miniChartSeries),this.filterMiniChartSeries(oldSeries));this.applyAxes(miniChart,completeOptions,oldOpts,miniChartSeriesStatus,["axes[].tick","axes[].thickness","axes[].title","axes[].crosshair","axes[].gridLine","axes[].label"]);const series=miniChart.series;for(const s of series)s.properties.id=void 0;const axes=miniChart.axes,horizontalAxis=axes.find(axis=>axis.direction==="x");for(const axis of axes)axis.gridLine.enabled=!1,axis.label.enabled=axis===horizontalAxis,axis.tick.enabled=!1,axis.interactionEnabled=!1;if(horizontalAxis!=null){const miniChartOpts=(_c=completeOptions.navigator)==null?void 0:_c.miniChart,labelOptions=miniChartOpts==null?void 0:miniChartOpts.label,intervalOptions=(_d=miniChartOpts==null?void 0:miniChartOpts.label)==null?void 0:_d.interval;horizontalAxis.line.enabled=!1,horizontalAxis.label.set(without(labelOptions,["interval","rotation","minSpacing","autoRotate","autoRotateAngle"])),horizontalAxis.tick.set(without(intervalOptions,["enabled","width","size","color","interval","step"]));const step=intervalOptions==null?void 0:intervalOptions.step;step!=null&&(horizontalAxis.interval.step=step)}}applyModules(options){var _a274;const{type:chartType2}=this.constructor;let modulesChanged=!1;for(const module of moduleRegistry.byType("root","legend")){const shouldBeEnabled=options[module.optionsKey]!=null&&module.chartTypes.includes(chartType2);shouldBeEnabled!==this.modulesManager.isEnabled(module)&&(shouldBeEnabled?(this.modulesManager.addModule(module,m=>m.moduleFactory(this.getModuleContext())),module.type==="legend"&&((_a274=this.modulesManager.getModule(module))==null||_a274.attachLegend(this.ctx.scene)),this[module.optionsKey]=this.modulesManager.getModule(module)):(this.modulesManager.removeModule(module),delete this[module.optionsKey]),modulesChanged=!0)}return modulesChanged}applySeries(chart,optSeries,oldOptSeries){var _a274;if(!optSeries)return"no-change";const matchResult=matchSeriesOptions(chart.series,optSeries,oldOptSeries);if(matchResult.status==="no-overlap")return debug(`Chart.applySeries() - creating new series instances, status: ${matchResult.status}`,matchResult),chart.series=optSeries.map(opts=>this.createSeries(opts)),"replaced";debug("Chart.applySeries() - matchResult",matchResult);const seriesInstances=[];let dataChanged=!1,groupingChanged=!1,isUpdated=!1;for(const change of matchResult.changes)switch(groupingChanged||(groupingChanged=change.status==="series-grouping"),dataChanged||(dataChanged=((_a274=change.diff)==null?void 0:_a274.data)!=null),isUpdated||(isUpdated=change.status!=="no-op"),change.status){case"add":{const newSeries=this.createSeries(change.opts);seriesInstances.push(newSeries),debug("Chart.applySeries() - created new series",newSeries);break}case"remove":debug(`Chart.applySeries() - removing series at previous idx ${change.idx}`,change.series);break;case"no-op":seriesInstances.push(change.series),debug(`Chart.applySeries() - no change to series at previous idx ${change.idx}`,change.series);break;case"series-grouping":case"update":default:{const{series,diff:diff2,idx}=change;debug(`Chart.applySeries() - applying series diff previous idx ${idx}`,diff2,series),this.applySeriesValues(series,diff2),series.markNodeDataDirty(),seriesInstances.push(series)}}for(let idx=0;idx<seriesInstances.length;idx++)seriesInstances[idx]._declarationOrder=idx;return debug("Chart.applySeries() - final series instances",seriesInstances),chart.series=seriesInstances,groupingChanged?"series-grouping-change":dataChanged?"data-change":isUpdated?"updated":"no-op"}applyAxes(chart,options,oldOpts,seriesStatus,skip=[],registerRegions=!1){if(!("axes"in options)||!options.axes)return!1;skip=["axes[].type",...skip];const{axes}=options;if(!(seriesStatus==="replaced")&&chart.axes.length===axes.length&&chart.axes.every((a,i)=>a.type===axes[i].type)&&isAgCartesianChartOptions(oldOpts))return chart.axes.forEach((axis,index)=>{var _a274;const previousOpts=((_a274=oldOpts.axes)==null?void 0:_a274[index])??{},axisDiff=jsonDiff(previousOpts,axes[index]);debug(`Chart.applyAxes() - applying axis diff idx ${index}`,axisDiff);const path=`axes[${index}]`;jsonApply(axis,axisDiff,{path,skip})}),!0;debug(`Chart.applyAxes() - creating new axes instances; seriesStatus: ${seriesStatus}`),chart.axes=this.createAxis(axes,skip);const axisGroups={x:[],y:[]};return chart.axes.forEach(axis=>axisGroups[axis.direction].push({id:axis.id,node:axis.getRegionNode()})),registerRegions&&(this.ctx.regionManager.updateRegion("horizontal-axes",...axisGroups.x),this.ctx.regionManager.updateRegion("vertical-axes",...axisGroups.y)),!0}createSeries(seriesOptions){const seriesInstance=seriesRegistry.create(seriesOptions.type,this.getModuleContext());return this.applySeriesOptionModules(seriesInstance,seriesOptions),this.applySeriesValues(seriesInstance,seriesOptions),seriesInstance}applySeriesOptionModules(series,options){const moduleContext=series.createModuleContext(),moduleMap=series.getModuleMap();for(const module of moduleRegistry.byType("series-option"))module.optionsKey in options&&module.seriesTypes.includes(series.type)&&moduleMap.addModule(module,m=>m.moduleFactory(moduleContext))}applySeriesValues(target,options){const moduleMap=target.getModuleMap(),{type:_,data,listeners,seriesGrouping,showInMiniChart:__,...seriesOptions}=options;for(const moduleDef of EXPECTED_ENTERPRISE_MODULES)if(moduleDef.type==="series-option"&&moduleDef.optionsKey in seriesOptions){const module=moduleMap.getModule(moduleDef.optionsKey);if(module){const moduleOptions=seriesOptions[moduleDef.optionsKey];delete seriesOptions[moduleDef.optionsKey],module.properties.set(moduleOptions)}}target.properties.set(seriesOptions),"data"in options&&target.setOptionsData(data),listeners&&this.registerListeners(target,listeners),"seriesGrouping"in options&&(seriesGrouping==null?target.seriesGrouping=void 0:target.seriesGrouping={...target.seriesGrouping,...seriesGrouping})}createAxis(options,skip){const newAxes=[],moduleContext=this.getModuleContext();for(let index=0;index<options.length;index++){const axisOptions=options[index],axis=axisRegistry.create(axisOptions.type,moduleContext);this.applyAxisModules(axis,axisOptions),jsonApply(axis,axisOptions,{path:`axes[${index}]`,skip}),newAxes.push(axis)}return guessInvalidPositions(newAxes),newAxes}applyAxisModules(axis,options){const moduleContext=axis.createModuleContext(),moduleMap=axis.getModuleMap();for(const module of moduleRegistry.byType("axis-option")){const shouldBeEnabled=options[module.optionsKey]!=null;shouldBeEnabled!==moduleMap.isEnabled(module)&&(shouldBeEnabled?(moduleMap.addModule(module,m=>m.moduleFactory(moduleContext)),axis[module.optionsKey]=moduleMap.getModule(module)):(moduleMap.removeModule(module),delete axis[module.optionsKey]))}}registerListeners(source,listeners){source.clearEventListeners();for(const[property,listener]of Object.entries(listeners))isFunction(listener)&&source.addEventListener(property,listener)}},__name(_a141,"_Chart"),_a141);_Chart.chartsInstances=new WeakMap;__decorateClass([ActionOnSet({newValue(value){this.destroyed||(this.ctx.domManager.setContainer(value),_Chart.chartsInstances.set(value,this))},oldValue(value){_Chart.chartsInstances.delete(value)}})],_Chart.prototype,"container",2);__decorateClass([ActionOnSet({newValue(value){this.resize("width option",{inWidth:value})}})],_Chart.prototype,"width",2);__decorateClass([ActionOnSet({newValue(value){this.resize("height option",{inHeight:value})}})],_Chart.prototype,"height",2);__decorateClass([ActionOnSet({newValue(value){this.resize("minWidth option",{inMinWidth:value})}})],_Chart.prototype,"minWidth",2);__decorateClass([ActionOnSet({newValue(value){this.resize("minHeight option",{inMinHeight:value})}})],_Chart.prototype,"minHeight",2);__decorateClass([Validate(OBJECT)],_Chart.prototype,"padding",2);__decorateClass([Validate(OBJECT)],_Chart.prototype,"seriesArea",2);__decorateClass([Validate(OBJECT)],_Chart.prototype,"keyboard",2);__decorateClass([Validate(UNION(["standalone","integrated"],"a chart mode"))],_Chart.prototype,"mode",2);__decorateClass([ProxyProperty("chartCaptions.title")],_Chart.prototype,"title",2);__decorateClass([ProxyProperty("chartCaptions.subtitle")],_Chart.prototype,"subtitle",2);__decorateClass([ProxyProperty("chartCaptions.footnote")],_Chart.prototype,"footnote",2);__decorateClass([ActionOnSet({changeValue(newValue,oldValue){this.onAxisChange(newValue,oldValue)}})],_Chart.prototype,"axes",2);__decorateClass([ActionOnSet({changeValue(newValue,oldValue){this.onSeriesChange(newValue,oldValue)}})],_Chart.prototype,"series",2);var Chart=_Chart,_a142,QuadtreeNearest=(_a142=class{constructor(capacity,maxdepth,boundary){this.root=new QuadtreeNodeNearest(capacity,maxdepth,boundary)}clear(boundary){this.root.clear(boundary)}addValue(hitTester,value){const elem={hitTester,value,distanceSquared:__name((x,y)=>hitTester.distanceSquared(x,y),"distanceSquared")};this.root.addElem(elem)}find(x,y){const arg={best:{nearest:void 0,distanceSquared:1/0}};return this.root.find(x,y,arg),arg.best}},__name(_a142,"QuadtreeNearest"),_a142),_a143,QuadtreeSubdivisions=(_a143=class{constructor(nw,ne,sw,se){this.nw=nw,this.ne=ne,this.sw=sw,this.se=se}addElem(elem){this.nw.addElem(elem),this.ne.addElem(elem),this.sw.addElem(elem),this.se.addElem(elem)}find(x,y,arg){this.nw.find(x,y,arg),this.ne.find(x,y,arg),this.sw.find(x,y,arg),this.se.find(x,y,arg)}},__name(_a143,"QuadtreeSubdivisions"),_a143),_a144,QuadtreeNode=(_a144=class{constructor(capacity,maxdepth,boundary){this.capacity=capacity,this.maxdepth=maxdepth,this.boundary=boundary??BBox.NaN,this.elems=[],this.subdivisions=void 0}clear(boundary){this.elems.length=0,this.boundary=boundary,this.subdivisions=void 0}addElem(e){this.addCondition(e)&&(this.subdivisions===void 0?this.maxdepth===0||this.elems.length<this.capacity?this.elems.push(e):this.subdivide(e):this.subdivisions.addElem(e))}find(x,y,arg){this.findCondition(x,y,arg)&&(this.subdivisions===void 0?this.findAction(x,y,arg):this.subdivisions.find(x,y,arg))}subdivide(newElem){this.subdivisions=this.makeSubdivisions();for(const e of this.elems)this.subdivisions.addElem(e);this.subdivisions.addElem(newElem),this.elems.length=0}makeSubdivisions(){const{x,y,width,height}=this.boundary,{capacity}=this,depth=this.maxdepth-1,halfWidth=width/2,halfHeight=height/2,nwBoundary=new BBox(x,y,halfWidth,halfHeight),neBoundary=new BBox(x+halfWidth,y,halfWidth,halfHeight),swBoundary=new BBox(x,y+halfHeight,halfWidth,halfHeight),seBoundary=new BBox(x+halfWidth,y+halfHeight,halfWidth,halfHeight);return new QuadtreeSubdivisions(this.child(capacity,depth,nwBoundary),this.child(capacity,depth,neBoundary),this.child(capacity,depth,swBoundary),this.child(capacity,depth,seBoundary))}},__name(_a144,"QuadtreeNode"),_a144),_a145,QuadtreeNodeNearest=(_a145=class extends QuadtreeNode{addCondition(e){const{x,y}=e.hitTester.midPoint;return this.boundary.containsPoint(x,y)}findCondition(x,y,arg){const{best}=arg;return best.distanceSquared!==0&&this.boundary.distanceSquared(x,y)<best.distanceSquared}findAction(x,y,arg){const other=nearestSquared(x,y,this.elems,arg.best.distanceSquared);other.nearest!==void 0&&other.distanceSquared<arg.best.distanceSquared&&(arg.best=other)}child(capacity,depth,boundary){return new _a145(capacity,depth,boundary)}},__name(_a145,"_QuadtreeNodeNearest"),_a145),BUILTIN_MARKERS=["ArrowDown","ArrowUp","Circle","Cross","Diamond","Heart","MapPin","Plus","Square","Star","Triangle"],DEFAULT_CENTER_POINT=Object.freeze({x:.5,y:.5}),_a146,InternalMarker=(_a146=class extends Path{constructor(){super(...arguments),this.x=0,this.y=0,this.size=12}isBuiltIn(){return BUILTIN_MARKERS.includes(this.constructor.className??"")}computeBBox(){if(!this.isBuiltIn())return this.path.computeBBox();const{x,y,size}=this,{center}=this.constructor;return new BBox(x-size*center.x,y-size*center.y,size,size)}applyPath(s,moves){const{path}=this;let{x,y}=this;path.clear();for(const{x:mx,y:my,t}of moves)x+=mx*s,y+=my*s,t==="move"?path.moveTo(x,y):path.lineTo(x,y);path.closePath()}executeFill(ctx,path){if(path)return super.executeFill(ctx,path)}executeStroke(ctx,path){if(path)return super.executeStroke(ctx,path)}},__name(_a146,"InternalMarker"),_a146);__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"y",2);__decorateClass([ScenePathChangeDetection({convertor:Math.abs})],InternalMarker.prototype,"size",2);var _a147,Marker=(_a147=class extends Rotatable(Scalable(Translatable(InternalMarker))){},__name(_a147,"Marker"),_a147);Marker.center=DEFAULT_CENTER_POINT;var _a148,Circle=(_a148=class extends Marker{updatePath(){const{x,y,path,size}=this,r=size/2;path.clear(),path.arc(x,y,r,0,Math.PI*2),path.closePath()}},__name(_a148,"Circle"),_a148);Circle.className="Circle";var _a149,_Cross=(_a149=class extends Marker{updatePath(){const s=this.size/4.2;super.applyPath(s,_a149.moves)}},__name(_a149,"_Cross"),_a149);_Cross.className="Cross";_Cross.moves=[{x:-1,y:0,t:"move"},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:-1,y:1},{x:-1,y:-1}];var Cross=_Cross,_a150,_Diamond=(_a150=class extends Marker{updatePath(){const s=this.size/2;super.applyPath(s,_a150.moves)}},__name(_a150,"_Diamond"),_a150);_Diamond.className="Diamond";_Diamond.moves=[{x:0,y:-1,t:"move"},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}];var Diamond=_Diamond,_a151,Heart=(_a151=class extends Marker{rad(degree2){return degree2/180*Math.PI}updatePath(){const{x,path,size,rad}=this,r=size/4,y=this.y+r/2;path.clear(),path.arc(x-r,y-r,r,rad(130),rad(330)),path.arc(x+r,y-r,r,rad(220),rad(50)),path.lineTo(x,y+r),path.closePath()}},__name(_a151,"Heart"),_a151);Heart.className="Heart";var _a152,Pin=(_a152=class extends Marker{updatePath(){const{path,x,y}=this,s=this.size,cx=.5,cy=1;path.clear(),path.moveTo(x+(.15625-cx)*s,y+(.34375-cy)*s),path.cubicCurveTo(x+(.15625-cx)*s,y+(.151491-cy)*s,x+(.307741-cx)*s,y+(0-cy)*s,x+(.5-cx)*s,y+(0-cy)*s),path.cubicCurveTo(x+(.692259-cx)*s,y+(0-cy)*s,x+(.84375-cx)*s,y+(.151491-cy)*s,x+(.84375-cx)*s,y+(.34375-cy)*s),path.cubicCurveTo(x+(.84375-cx)*s,y+(.493824-cy)*s,x+(.784625-cx)*s,y+(.600181-cy)*s,x+(.716461-cx)*s,y+(.695393-cy)*s),path.cubicCurveTo(x+(.699009-cx)*s,y+(.719769-cy)*s,x+(.681271-cx)*s,y+(.743104-cy)*s,x+(.663785-cx)*s,y+(.766105-cy)*s),path.cubicCurveTo(x+(.611893-cx)*s,y+(.834367-cy)*s,x+(.562228-cx)*s,y+(.899699-cy)*s,x+(.528896-cx)*s,y+(.980648-cy)*s),path.cubicCurveTo(x+(.524075-cx)*s,y+(.992358-cy)*s,x+(.512663-cx)*s,y+(1-cy)*s,x+(.5-cx)*s,y+(1-cy)*s),path.cubicCurveTo(x+(.487337-cx)*s,y+(1-cy)*s,x+(.475925-cx)*s,y+(.992358-cy)*s,x+(.471104-cx)*s,y+(.980648-cy)*s),path.cubicCurveTo(x+(.487337-cx)*s,y+(1-cy)*s,x+(.475925-cx)*s,y+(.992358-cy)*s,x+(.471104-cx)*s,y+(.980648-cy)*s),path.cubicCurveTo(x+(.437772-cx)*s,y+(.899699-cy)*s,x+(.388107-cx)*s,y+(.834367-cy)*s,x+(.336215-cx)*s,y+(.766105-cy)*s),path.cubicCurveTo(x+(.318729-cx)*s,y+(.743104-cy)*s,x+(.300991-cx)*s,y+(.719769-cy)*s,x+(.283539-cx)*s,y+(.695393-cy)*s),path.cubicCurveTo(x+(.215375-cx)*s,y+(.600181-cy)*s,x+(.15625-cx)*s,y+(.493824-cy)*s,x+(.15625-cx)*s,y+(.34375-cy)*s),path.closePath()}},__name(_a152,"Pin"),_a152);Pin.className="MapPin";Pin.center={x:.5,y:1};var _a153,_Plus=(_a153=class extends Marker{updatePath(){const s=this.size/3;super.applyPath(s,_a153.moves)}},__name(_a153,"_Plus"),_a153);_Plus.className="Plus";_Plus.moves=[{x:-.5,y:-.5,t:"move"},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1},{x:-1,y:0},{x:0,y:-1}];var Plus=_Plus,_a154,Square=(_a154=class extends Marker{updatePath(){const{path,x,y}=this,hs=this.size/2;path.clear(),path.moveTo(this.align(x-hs),this.align(y-hs)),path.lineTo(this.align(x+hs),this.align(y-hs)),path.lineTo(this.align(x+hs),this.align(y+hs)),path.lineTo(this.align(x-hs),this.align(y+hs)),path.closePath()}},__name(_a154,"Square"),_a154);Square.className="Square";var _a155,Star=(_a155=class extends Marker{updatePath(){const{x,y,path,size}=this,spikes=5,innerRadius=size/2,rotation=Math.PI/2;path.clear();for(let i=0;i<spikes*2;i++){const radius=i%2===0?size:innerRadius,angle2=i*Math.PI/spikes-rotation,xCoordinate=x+Math.cos(angle2)*radius,yCoordinate=y+Math.sin(angle2)*radius;path.lineTo(xCoordinate,yCoordinate)}path.closePath()}},__name(_a155,"Star"),_a155);Star.className="Star";var _a156,_Triangle=(_a156=class extends Marker{updatePath(){const s=this.size*1.1;super.applyPath(s,_a156.moves)}},__name(_a156,"_Triangle"),_a156);_Triangle.className="Triangle";_Triangle.moves=[{x:0,y:-.48,t:"move"},{x:.5,y:.87},{x:-1,y:0}];var Triangle=_Triangle,MARKER_SHAPES={circle:Circle,cross:Cross,diamond:Diamond,heart:Heart,pin:Pin,plus:Plus,square:Square,star:Star,triangle:Triangle},MARKER_SUPPORTED_SHAPES=Object.keys(MARKER_SHAPES);function isMarkerShape(shape){return typeof shape=="string"&&MARKER_SUPPORTED_SHAPES.includes(shape)}__name(isMarkerShape,"isMarkerShape");function getMarker(shape=Square){return isMarkerShape(shape)?MARKER_SHAPES[shape]:typeof shape=="function"?shape:Square}__name(getMarker,"getMarker");var _a157,DataModelSeries=(_a157=class extends Series{constructor(){super(...arguments),this.showFocusBox=!0}getScaleInformation({xScale,yScale}){const isContinuousX=ContinuousScale.is(xScale),isContinuousY=ContinuousScale.is(yScale);return{isContinuousX,isContinuousY,xScaleType:xScale==null?void 0:xScale.type,yScaleType:yScale==null?void 0:yScale.type}}getModulePropertyDefinitions(){var _a274,_b;const xScale=(_a274=this.axes.x)==null?void 0:_a274.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale;return this.moduleMap.mapModules(mod2=>mod2.getPropertyDefinitions(this.getScaleInformation({xScale,yScale}))).flat()}async requestDataModel(dataController,data,opts){opts.props.push(...this.getModulePropertyDefinitions());const{dataModel,processedData}=await dataController.request(this.id,data??[],opts);return this.dataModel=dataModel,this.processedData=processedData,this.dispatch("data-processed",{dataModel,processedData}),{dataModel,processedData}}isProcessedDataAnimatable(){var _a274,_b;const validationResults=(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.animationValidation;if(!validationResults)return!0;const{orderedKeys,uniqueKeys}=validationResults;return orderedKeys&&uniqueKeys}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}pickFocus(opts){const nodeData=this.getNodeData();if(nodeData===void 0||nodeData.length===0)return;const datumIndex=this.computeFocusDatumIndex(opts,nodeData);if(datumIndex===void 0)return;const{showFocusBox}=this,datum=nodeData[datumIndex],derivedOpts={...opts,datumIndex},bounds=this.computeFocusBounds(derivedOpts);if(bounds!==void 0)return{bounds,showFocusBox,datum,datumIndex}}computeFocusDatumIndex(opts,nodeData){const isDatumEnabled=__name(datumIndex2=>{const{missing=!1,enabled=!0,focusable=!0}=nodeData[datumIndex2];return!missing&&enabled&&focusable},"isDatumEnabled"),searchBackward=__name(datumIndex2=>{for(;datumIndex2>=0&&!isDatumEnabled(datumIndex2);)datumIndex2--;return datumIndex2===-1?void 0:datumIndex2},"searchBackward"),searchForward=__name(datumIndex2=>{for(;datumIndex2<nodeData.length&&!isDatumEnabled(datumIndex2);)datumIndex2++;return datumIndex2===nodeData.length?void 0:datumIndex2},"searchForward");let datumIndex;const clampedIndex=clamp(0,opts.datumIndex,nodeData.length-1);return opts.datumIndexDelta<0?datumIndex=searchBackward(clampedIndex):opts.datumIndexDelta>0?datumIndex=searchForward(clampedIndex):datumIndex=searchForward(clampedIndex)??searchBackward(clampedIndex),datumIndex===void 0?opts.datumIndexDelta===0?void 0:opts.datumIndex-opts.datumIndexDelta:datumIndex}},__name(_a157,"DataModelSeries"),_a157),_a158,SeriesItemHighlightStyle=(_a158=class extends BaseProperties{constructor(){super(...arguments),this.fill="rgba(255,255,255, 0.33)",this.stroke="rgba(0, 0, 0, 0.4)",this.strokeWidth=2}},__name(_a158,"SeriesItemHighlightStyle"),_a158);__decorateClass([Validate(COLOR_STRING,{optional:!0})],SeriesItemHighlightStyle.prototype,"fill",2);__decorateClass([Validate(RATIO,{optional:!0})],SeriesItemHighlightStyle.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],SeriesItemHighlightStyle.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],SeriesItemHighlightStyle.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO,{optional:!0})],SeriesItemHighlightStyle.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH,{optional:!0})],SeriesItemHighlightStyle.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],SeriesItemHighlightStyle.prototype,"lineDashOffset",2);var _a159,SeriesHighlightStyle=(_a159=class extends BaseProperties{},__name(_a159,"SeriesHighlightStyle"),_a159);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],SeriesHighlightStyle.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO,{optional:!0})],SeriesHighlightStyle.prototype,"dimOpacity",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],SeriesHighlightStyle.prototype,"enabled",2);var _a160,TextHighlightStyle=(_a160=class extends BaseProperties{constructor(){super(...arguments),this.color="black"}},__name(_a160,"TextHighlightStyle"),_a160);__decorateClass([Validate(COLOR_STRING,{optional:!0})],TextHighlightStyle.prototype,"color",2);var _a161,HighlightProperties=(_a161=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0}},__name(_a161,"HighlightProperties"),_a161);__decorateClass([Validate(BOOLEAN,{optional:!0})],HighlightProperties.prototype,"enabled",2);var _a162,HighlightStyle=(_a162=class extends BaseProperties{constructor(){super(...arguments),this.item=new SeriesItemHighlightStyle,this.series=new SeriesHighlightStyle,this.text=new TextHighlightStyle}},__name(_a162,"HighlightStyle"),_a162);__decorateClass([Validate(OBJECT)],HighlightStyle.prototype,"item",2);__decorateClass([Validate(OBJECT)],HighlightStyle.prototype,"series",2);__decorateClass([Validate(OBJECT)],HighlightStyle.prototype,"text",2);var _a163,SeriesProperties=(_a163=class extends BaseProperties{constructor(){super(...arguments),this.visible=!0,this.focusPriority=1/0,this.showInLegend=!0,this.cursor="default",this.nodeClickRange="exact",this.highlight=new HighlightProperties,this.highlightStyle=new HighlightStyle}},__name(_a163,"SeriesProperties"),_a163);__decorateClass([Validate(STRING,{optional:!0})],SeriesProperties.prototype,"id",2);__decorateClass([Validate(BOOLEAN)],SeriesProperties.prototype,"visible",2);__decorateClass([Validate(REAL_NUMBER,{optional:!0})],SeriesProperties.prototype,"focusPriority",2);__decorateClass([Validate(BOOLEAN)],SeriesProperties.prototype,"showInLegend",2);__decorateClass([Validate(STRING)],SeriesProperties.prototype,"cursor",2);__decorateClass([Validate(INTERACTION_RANGE)],SeriesProperties.prototype,"nodeClickRange",2);__decorateClass([Validate(OBJECT)],SeriesProperties.prototype,"highlight",2);__decorateClass([Validate(OBJECT)],SeriesProperties.prototype,"highlightStyle",2);var DEFAULT_CARTESIAN_DIRECTION_KEYS={x:["xKey"],y:["yKey"]},DEFAULT_CARTESIAN_DIRECTION_NAMES={x:["xName"],y:["yName"]},_a164,CartesianSeriesNodeEvent=(_a164=class extends SeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.xKey=series.properties.xKey,this.yKey=series.properties.yKey}},__name(_a164,"CartesianSeriesNodeEvent"),_a164),_a165,CartesianSeriesProperties=(_a165=class extends SeriesProperties{constructor(){super(...arguments),this.pickOutsideVisibleMinorAxis=!1}},__name(_a165,"CartesianSeriesProperties"),_a165);__decorateClass([Validate(STRING,{optional:!0})],CartesianSeriesProperties.prototype,"legendItemName",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianSeriesProperties.prototype,"pickOutsideVisibleMinorAxis",2);var _a166,CartesianSeries=(_a166=class extends DataModelSeries{constructor({pathsPerSeries=["path"],hasMarkers=!1,hasHighlightedLabels=!1,pathsZIndexSubOrderOffset=[],datumSelectionGarbageCollection=!0,markerSelectionGarbageCollection=!0,animationAlwaysUpdateSelections=!1,animationResetFns,directionKeys,directionNames,...otherOpts}){if(super({directionKeys,directionNames,canHaveAxes:!0,...otherOpts}),this.NodeEvent=CartesianSeriesNodeEvent,this.dataNodeGroup=this.contentGroup.appendChild(new Group({name:`${this.id}-series-dataNodes`,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("data")})),this.markerGroup=this.contentGroup.appendChild(new Group({name:`${this.id}-series-markers`,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("marker")})),this.labelGroup=this.contentGroup.appendChild(new TranslatableGroup({name:`${this.id}-series-labels`,zIndex:9,zIndexSubOrder:this.getGroupZIndexSubOrder("labels")})),this.labelSelection=Selection.select(this.labelGroup,Text),this.highlightSelection=Selection.select(this.highlightNode,()=>this.opts.hasMarkers?this.markerFactory():this.nodeFactory()),this.highlightLabelSelection=Selection.select(this.highlightLabel,Text),this.annotationSelections=new Set,this.minRectsCache={dirtyNodeData:!0},this.debug=Debug.create(),!directionKeys||!directionNames)throw new Error(`Unable to initialise series type ${this.type}`);this.opts={pathsPerSeries,hasMarkers,hasHighlightedLabels,pathsZIndexSubOrderOffset,directionKeys,directionNames,animationResetFns,animationAlwaysUpdateSelections,datumSelectionGarbageCollection,markerSelectionGarbageCollection},this.paths=[];for(let index=0;index<pathsPerSeries.length;index++)this.paths[index]=new Path({name:`${this.id}-${pathsPerSeries[index]}`}),this.paths[index].zIndex=4,this.paths[index].zIndexSubOrder=this.getGroupZIndexSubOrder("paths",index),this.contentGroup.appendChild(this.paths[index]);this.datumSelection=Selection.select(this.dataNodeGroup,()=>this.nodeFactory(),datumSelectionGarbageCollection),this.markerSelection=Selection.select(this.markerGroup,()=>this.markerFactory(),markerSelectionGarbageCollection),this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(data=>this.animateEmptyUpdateReady(data),"action")},reset:"empty",skip:"ready",disable:"disabled"},ready:{updateData:"waiting",clear:"clearing",highlight:__name(data=>this.animateReadyHighlight(data),"highlight"),highlightMarkers:__name(data=>this.animateReadyHighlightMarkers(data),"highlightMarkers"),resize:__name(data=>this.animateReadyResize(data),"resize"),reset:"empty",skip:"ready",disable:"disabled"},waiting:{update:{target:"ready",action:__name(data=>{this.ctx.animationManager.isSkipped()?this.resetAllAnimation(data):this.animateWaitingUpdateReady(data)},"action")},reset:"empty",skip:"ready",disable:"disabled"},disabled:{update:__name(data=>this.resetAllAnimation(data),"update"),reset:"empty"},clearing:{update:{target:"empty",action:__name(data=>this.animateClearingUpdateEmpty(data),"action")},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}get contextNodeData(){return this._contextNodeData}getNodeData(){var _a274;return(_a274=this.contextNodeData)==null?void 0:_a274.nodeData}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"?this.animationState.transition("skip"):phase==="disabled"&&this.animationState.transition("disable")}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",event=>this.onLegendItemClick(event)),this.ctx.chartEventManager.addListener("legend-item-double-click",event=>this.onLegendItemDoubleClick(event)))}destroy(){super.destroy(),this._contextNodeData=void 0}async update({seriesRect}){var _a274,_b;const{visible,_contextNodeData:previousContextData}=this,seriesHighlighted=((_b=(_a274=this.ctx.highlightManager)==null?void 0:_a274.getActiveHighlight())==null?void 0:_b.series)===this,resize=this.checkResize(seriesRect),highlightItems=await this.updateHighlightSelection(seriesHighlighted);await this.updateSelections(visible),await this.updateNodes(highlightItems,seriesHighlighted,visible);const animationData=this.getAnimationData(seriesRect,previousContextData);animationData&&(resize&&this.animationState.transition("resize",animationData),this.animationState.transition("update",animationData))}async updateSelections(anySeriesItemEnabled){var _a274;const animationSkipUpdate=!this.opts.animationAlwaysUpdateSelections&&this.ctx.animationManager.isSkipped();if(!(!anySeriesItemEnabled&&animationSkipUpdate)&&!(!this.nodeDataRefresh&&!this.isPathOrSelectionDirty())){if(this.nodeDataRefresh){this.nodeDataRefresh=!1,this.debug("CartesianSeries.updateSelections() - calling createNodeData() for",this.id),this.markQuadtreeDirty(),this._contextNodeData=await this.createNodeData();const animationValid=this.isProcessedDataAnimatable();this._contextNodeData&&((_a274=this._contextNodeData).animationValid??(_a274.animationValid=animationValid)),this.minRectsCache.dirtyNodeData=!0;const{dataModel,processedData}=this;dataModel!==void 0&&processedData!==void 0&&this.dispatch("data-update",{dataModel,processedData})}await this.updateSeriesSelections()}}async updateSeriesSelections(seriesHighlighted){const{datumSelection,labelSelection,markerSelection,paths}=this,contextData=this._contextNodeData;if(!contextData)return;const{nodeData,labelData,itemId}=contextData;await this.updatePaths({seriesHighlighted,itemId,contextData,paths}),this.datumSelection=await this.updateDatumSelection({nodeData,datumSelection}),this.labelSelection=await this.updateLabelSelection({labelData,labelSelection}),this.opts.hasMarkers&&(this.markerSelection=await this.updateMarkerSelection({nodeData,markerSelection}))}markerFactory(){const MarkerShape=getMarker();return new MarkerShape}getGroupZIndexSubOrder(type,subIndex=0){const result=super.getGroupZIndexSubOrder(type,subIndex);if(type==="paths"){const[superFn]=result,pathOffset=this.opts.pathsZIndexSubOrderOffset[subIndex]??0;result[0]=isFunction(superFn)?()=>Number(superFn())+pathOffset:Number(superFn)+pathOffset}return result}async updateNodes(highlightedItems,seriesHighlighted,anySeriesItemEnabled){const{highlightSelection,highlightLabelSelection,opts:{hasMarkers,hasHighlightedLabels}}=this,animationEnabled=!this.ctx.animationManager.isSkipped(),visible=this.visible&&this._contextNodeData!=null&&anySeriesItemEnabled;this.rootGroup.visible=animationEnabled||visible,this.contentGroup.visible=animationEnabled||visible,this.highlightGroup.visible=(animationEnabled||visible)&&seriesHighlighted;const opacity=this.getOpacity();hasMarkers?(await this.updateMarkerNodes({markerSelection:highlightSelection,isHighlight:!0}),this.animationState.transition("highlightMarkers",highlightSelection)):(await this.updateDatumNodes({datumSelection:highlightSelection,isHighlight:!0}),this.animationState.transition("highlight",highlightSelection)),hasHighlightedLabels&&await this.updateLabelNodes({labelSelection:highlightLabelSelection});const{dataNodeGroup,markerGroup,datumSelection,labelSelection,markerSelection,paths,labelGroup}=this,{itemId}=this.contextNodeData??{};dataNodeGroup.opacity=opacity,dataNodeGroup.visible=animationEnabled||visible,labelGroup.visible=visible,hasMarkers&&(markerGroup.opacity=opacity,markerGroup.zIndex=dataNodeGroup.zIndex>=4?dataNodeGroup.zIndex:dataNodeGroup.zIndex+1,markerGroup.visible=visible),labelGroup&&(labelGroup.opacity=opacity),await this.updatePathNodes({seriesHighlighted,itemId,paths,opacity,visible,animationEnabled}),dataNodeGroup.visible&&(await this.updateDatumNodes({datumSelection,highlightedItems,isHighlight:!1}),await this.updateLabelNodes({labelSelection}),hasMarkers&&await this.updateMarkerNodes({markerSelection,isHighlight:!1}))}getHighlightLabelData(labelData,highlightedItem){const labelItems=labelData.filter(ld=>ld.datum===highlightedItem.datum&&ld.itemId===highlightedItem.itemId);return labelItems.length===0?void 0:labelItems}getHighlightData(_nodeData,highlightedItem){return highlightedItem?[highlightedItem]:void 0}async updateHighlightSelection(seriesHighlighted){var _a274;const{highlightSelection,highlightLabelSelection,_contextNodeData:contextNodeData}=this;if(!contextNodeData)return;const highlightedDatum=(_a274=this.ctx.highlightManager)==null?void 0:_a274.getActiveHighlight(),item=seriesHighlighted&&(highlightedDatum!=null&&highlightedDatum.datum)?highlightedDatum:void 0;let labelItems,highlightItems;if(item!=null){const labelsEnabled=this.isLabelEnabled(),{labelData,nodeData}=contextNodeData;highlightItems=this.getHighlightData(nodeData,item),labelItems=labelsEnabled?this.getHighlightLabelData(labelData,item):void 0}return this.highlightSelection=await this.updateHighlightSelectionItem({items:highlightItems,highlightSelection}),this.highlightLabelSelection=await this.updateHighlightSelectionLabel({items:labelItems,highlightLabelSelection}),highlightItems}markQuadtreeDirty(){this.quadtree=void 0}*datumNodesIter(){for(const{node}of this.datumSelection)node.datum.missing!==!0&&(yield node)}getQuadTree(){if(this.quadtree===void 0){const{width,height}=this.ctx.scene.canvas,canvasRect=new BBox(0,0,width,height);this.quadtree=new QuadtreeNearest(100,10,canvasRect),this.initQuadTree(this.quadtree)}return this.quadtree}initQuadTree(_quadtree){}pickNodeExactShape(point){const result=super.pickNodeExactShape(point);if(result)return result;const{x,y}=point,{opts:{hasMarkers}}=this;let match;const{dataNodeGroup,markerGroup}=this;if(match=dataNodeGroup.pickNode(x,y),!match&&hasMarkers&&(match=markerGroup==null?void 0:markerGroup.pickNode(x,y)),match&&match.datum.missing!==!0)return{datum:match.datum,distance:0};for(const mod2 of this.moduleMap.modules()){const{datum}=mod2.pickNodeExact(point)??{};if(datum!=null&&(datum==null?void 0:datum.missing)!==!0)return{datum,distance:0}}}pickNodeClosestDatum(point){var _a274;const{x,y}=point,{axes,_contextNodeData:contextNodeData}=this;if(!contextNodeData)return;const xAxis=axes.x,yAxis=axes.y,hitPoint={x,y};let minDistance=1/0,closestDatum;for(const datum of contextNodeData.nodeData){const{point:{x:datumX=NaN,y:datumY=NaN}={}}=datum;if(isNaN(datumX)||isNaN(datumY)||!((xAxis==null?void 0:xAxis.inRange(datumX))&&(yAxis==null?void 0:yAxis.inRange(datumY))))continue;const distance3=Math.max((hitPoint.x-datumX)**2+(hitPoint.y-datumY)**2,0);distance3<minDistance&&(minDistance=distance3,closestDatum=datum)}for(const mod2 of this.moduleMap.modules()){const modPick=mod2.pickNodeNearest(point);if(modPick!==void 0&&modPick.distanceSquared<minDistance){minDistance=modPick.distanceSquared,closestDatum=modPick.datum;break}}if(closestDatum){const distance3=Math.max(Math.sqrt(minDistance)-(((_a274=closestDatum.point)==null?void 0:_a274.size)??0),0);return{datum:closestDatum,distance:distance3}}}pickNodeMainAxisFirst(point,requireCategoryAxis){var _a274;const{x,y}=point,{axes,_contextNodeData:contextNodeData}=this,{pickOutsideVisibleMinorAxis}=this.properties;if(!contextNodeData)return;const xAxis=axes.x,yAxis=axes.y,directions2=[xAxis,yAxis].filter(CategoryAxis.is).map(a=>a.direction);if(requireCategoryAxis&&directions2.length===0)return;const[majorDirection="x"]=directions2,hitPointCoords=[x,y];majorDirection!=="x"&&hitPointCoords.reverse();const minDistance=[1/0,1/0];let closestDatum;for(const datum of contextNodeData.nodeData){const{x:datumX=NaN,y:datumY=NaN}=datum.point??datum.midPoint??{};if(isNaN(datumX)||isNaN(datumY)||datum.missing===!0)continue;const visible=[xAxis==null?void 0:xAxis.inRange(datumX),yAxis==null?void 0:yAxis.inRange(datumY)];if(majorDirection!=="x"&&visible.reverse(),!visible[0]||!pickOutsideVisibleMinorAxis&&!visible[1])continue;const datumPoint=[datumX,datumY];majorDirection!=="x"&&datumPoint.reverse();let newMinDistance=!0;for(let i=0;i<datumPoint.length;i++){const dist=Math.abs(datumPoint[i]-hitPointCoords[i]);if(dist>minDistance[i]){newMinDistance=!1;break}else dist<minDistance[i]&&(minDistance[i]=dist,minDistance.fill(1/0,i+1,minDistance.length))}newMinDistance&&(closestDatum=datum)}if(closestDatum){let closestDistanceSquared=Math.max(minDistance[0]**2+minDistance[1]**2-(((_a274=closestDatum.point)==null?void 0:_a274.size)??0),0);for(const mod2 of this.moduleMap.modules()){const modPick=mod2.pickNodeMainAxisFirst(point);if(modPick!==void 0&&modPick.distanceSquared<closestDistanceSquared){closestDatum=modPick.datum,closestDistanceSquared=modPick.distanceSquared;break}}return{datum:closestDatum,distance:Math.sqrt(closestDistanceSquared)}}}onLegendItemClick(event){const{legendItemName}=this.properties,{enabled,itemId,series}=event,matchedLegendItemName=legendItemName!=null&&legendItemName===event.legendItemName;(series.id===this.id||matchedLegendItemName)&&this.toggleSeriesItem(itemId,enabled)}onLegendItemDoubleClick(event){const{enabled,itemId,series,numVisibleItems}=event,{legendItemName}=this.properties,matchedLegendItemName=legendItemName!=null&&legendItemName===event.legendItemName;series.id===this.id||matchedLegendItemName?this.toggleSeriesItem(itemId,!0):enabled&&numVisibleItems===1?this.toggleSeriesItem(itemId,!0):this.toggleSeriesItem(itemId,!1)}isPathOrSelectionDirty(){return!1}getLabelData(){return[]}shouldFlipXY(){return!1}getMinRects(width,height){const{dirtyNodeData,sizeCache,minRect,minVisibleRect}=this.minRectsCache,newSizeCache=JSON.stringify({width,height});if(!(newSizeCache!==sizeCache)&&!dirtyNodeData&&minRect&&minVisibleRect)return{minRect,minVisibleRect};const rects=this.computeMinRects(width,height);return this.minRectsCache={dirtyNodeData:!1,sizeCache:newSizeCache,minRect:rects==null?void 0:rects.minRect,minVisibleRect:rects==null?void 0:rects.minVisibleRect},rects}computeMinRects(width,height){const context=this._contextNodeData;if(!(context!=null&&context.nodeData.length))return;const{nodeData}=context,minRectXs=Array(nodeData.length),minRectYs=Array(nodeData.length);for(const[i,{midPoint}]of nodeData.entries())minRectXs[i]=(midPoint==null?void 0:midPoint.x)??0,minRectYs[i]=(midPoint==null?void 0:midPoint.y)??0;minRectXs.sort((a,b)=>a-b),minRectYs.sort((a,b)=>a-b);let zeroX,widthX,zeroY,heightY,maxWidth=0,maxHeight=0;for(let i=1;i<nodeData.length;i++)minRectXs[i]>=0&&(zeroX??(zeroX=i)),minRectXs[i]>width&&(widthX??(widthX=i)),minRectYs[i]>=0&&(zeroY??(zeroY=i)),minRectYs[i]>height&&(heightY??(heightY=i)),maxWidth=Math.max(maxWidth,minRectXs[i]-minRectXs[i-1]),maxHeight=Math.max(maxHeight,minRectYs[i]-minRectYs[i-1]);widthX??(widthX=nodeData.length),heightY??(heightY=nodeData.length);const minVisibleRectXs=zeroX!=null&&widthX!=null?minRectXs.slice(zeroX,widthX):[],minVisibleRectYs=zeroY!=null&&heightY!=null?minRectYs.slice(zeroY,heightY):[];let maxVisibleWidth=0,maxVisibleHeight=0;for(let i=1;i<Math.max(minVisibleRectXs.length,minVisibleRectYs.length);i++){const x1=minVisibleRectXs[i],x2=minVisibleRectXs[i-1],y1=minVisibleRectYs[i],y2=minVisibleRectYs[i-1];x1!=null&&x2!=null&&(maxVisibleWidth=Math.max(maxVisibleWidth,x1-x2)),y1!=null&&y2!=null&&(maxVisibleHeight=Math.max(maxVisibleHeight,y1-y2))}const minRect=new BBox(0,0,maxWidth,maxHeight),minVisibleRect=new BBox(0,0,maxVisibleWidth,maxVisibleHeight);return{minRect,minVisibleRect}}updateHighlightSelectionItem(opts){const{opts:{hasMarkers}}=this,{items,highlightSelection}=opts,nodeData=items??[];if(hasMarkers){const markerSelection=highlightSelection;return this.updateMarkerSelection({nodeData,markerSelection})}else return this.updateDatumSelection({nodeData,datumSelection:highlightSelection})}updateHighlightSelectionLabel(opts){return this.updateLabelSelection({labelData:opts.items??[],labelSelection:opts.highlightLabelSelection})}async updateDatumSelection(opts){return opts.datumSelection}async updateDatumNodes(_opts){}async updateMarkerSelection(opts){return opts.markerSelection}async updateMarkerNodes(_opts){}async updatePaths(opts){opts.paths.forEach(p=>p.visible=!1)}async updatePathNodes(opts){const{paths,opacity,visible}=opts;for(const path of paths)path.opacity=opacity,path.visible=visible}resetPathAnimation(data){var _a274;const{path}=((_a274=this.opts)==null?void 0:_a274.animationResetFns)??{};path&&data.paths.forEach(paths=>{resetMotion([paths],path)})}resetDatumAnimation(data){var _a274;const{datum}=((_a274=this.opts)==null?void 0:_a274.animationResetFns)??{};datum&&resetMotion([data.datumSelection],datum)}resetLabelAnimation(data){var _a274;const{label}=((_a274=this.opts)==null?void 0:_a274.animationResetFns)??{};label&&resetMotion([data.labelSelection],label)}resetMarkerAnimation(data){var _a274;const{marker}=((_a274=this.opts)==null?void 0:_a274.animationResetFns)??{};marker&&this.opts.hasMarkers&&resetMotion([data.markerSelection],marker)}resetAllAnimation(data){var _a274;this.ctx.animationManager.stopByAnimationGroupId(this.id),this.resetPathAnimation(data),this.resetDatumAnimation(data),this.resetLabelAnimation(data),this.resetMarkerAnimation(data),((_a274=data.contextData)==null?void 0:_a274.animationValid)===!1&&this.ctx.animationManager.skipCurrentBatch()}animateEmptyUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateWaitingUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateReadyHighlight(data){var _a274;const{datum}=((_a274=this.opts)==null?void 0:_a274.animationResetFns)??{};datum&&resetMotion([data],datum)}animateReadyHighlightMarkers(data){var _a274;const{marker}=((_a274=this.opts)==null?void 0:_a274.animationResetFns)??{};marker&&resetMotion([data],marker)}animateReadyResize(data){this.resetAllAnimation(data)}animateClearingUpdateEmpty(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animationTransitionClear(){const animationData=this.getAnimationData();animationData&&this.animationState.transition("clear",animationData)}getAnimationData(seriesRect,previousContextData){const{_contextNodeData:contextData}=this;return contextData?{datumSelection:this.datumSelection,markerSelection:this.markerSelection,labelSelection:this.labelSelection,annotationSelections:[...this.annotationSelections],contextData,previousContextData,paths:this.paths,seriesRect}:void 0}calculateScaling(){const result={};for(const direction of Object.values(ChartAxisDirection)){const axis=this.axes[direction];if(axis){if(axis.scale instanceof LogScale){const{range:range3,domain}=axis.scale;result[direction]={type:"log",convert:__name(d=>axis.scale.convert(d),"convert"),domain:[domain[0],domain[1]],range:[range3[0],range3[1]]}}else if(axis.scale instanceof ContinuousScale){const{range:range3}=axis.scale,domain=axis.scale.getDomain();result[direction]={type:"continuous",domain:[domain[0],domain[1]],range:[range3[0],range3[1]]}}else if(axis.scale){const{domain}=axis.scale;result[direction]={type:"category",domain,range:domain.map(d=>axis.scale.convert(d))}}}}return result}},__name(_a166,"CartesianSeries"),_a166),directions=["top","right","bottom","left"],_a167,CartesianChart=(_a167=class extends Chart{constructor(options,resources){super(options,resources),this.paired=!0,this.firstSeriesTranslation=!0,this.lastUpdateClipRect=void 0,this._lastCrossLineIds=void 0,this._lastAxisAreaWidths=new Map,this._lastClipSeries=!1,this._lastVisibility={crossLines:!0,series:!0}}onAxisChange(newValue,oldValue){var _a274;super.onAxisChange(newValue,oldValue),(_a274=this.ctx)==null||_a274.zoomManager.updateAxes(newValue)}destroySeries(series){super.destroySeries(series),this.firstSeriesTranslation=!0}getChartType(){return"cartesian"}setRootClipRects(clipRect){const{seriesRoot,annotationRoot,highlightRoot}=this;seriesRoot.setClipRectInGroupCoordinateSpace(clipRect),highlightRoot.setClipRectInGroupCoordinateSpace(clipRect),annotationRoot.setClipRectInGroupCoordinateSpace(clipRect)}performLayout(ctx){const{firstSeriesTranslation,seriesRoot,annotationRoot,highlightRoot}=this,{animationRect,seriesRect,visibility,clipSeries}=this.updateAxes(ctx.layoutBox);this.seriesRoot.visible=visibility.series,this.seriesRect=seriesRect,this.animationRect=animationRect;const{x,y}=seriesRect;if(firstSeriesTranslation){for(const group of[seriesRoot,annotationRoot,highlightRoot])group.translationX=Math.floor(x),group.translationY=Math.floor(y);this.firstSeriesTranslation=!1}else{const{translationX,translationY}=seriesRoot;staticFromToMotion(this.id,"seriesRect",this.ctx.animationManager,[seriesRoot,highlightRoot,annotationRoot],{translationX,translationY},{translationX:Math.floor(x),translationY:Math.floor(y)},{phase:"update"})}const seriesPaddedRect=seriesRect.clone().grow(this.seriesArea.padding),clipRect=this.seriesArea.clip||clipSeries?seriesPaddedRect:void 0,{lastUpdateClipRect}=this;this.lastUpdateClipRect=clipRect,this.ctx.animationManager.isActive()&&lastUpdateClipRect!=null?this.ctx.animationManager.animate({id:this.id,groupId:"clip-rect",phase:"update",from:lastUpdateClipRect,to:seriesPaddedRect,onUpdate:__name(interpolatedClipRect=>this.setRootClipRects(interpolatedClipRect),"onUpdate"),onComplete:__name(()=>this.setRootClipRects(clipRect),"onComplete")}):this.setRootClipRects(clipRect),this.ctx.layoutManager.emitLayoutComplete(ctx,{axes:this.axes.map(axis=>axis.getLayoutState()),series:{rect:seriesRect,paddedRect:seriesPaddedRect,visible:visibility.series,shouldFlipXY:this.shouldFlipXY()},clipSeries})}updateAxes(layoutBox){var _a274;const crossLineIds=this.axes.flatMap(axis=>axis.crossLines??[]).map(crossLine=>crossLine.id),axesValid=this._lastCrossLineIds!=null&&this._lastCrossLineIds.length===crossLineIds.length&&this._lastCrossLineIds.every((id,index)=>crossLineIds[index]===id);let axisAreaWidths,clipSeries,visibility;axesValid?(axisAreaWidths=new Map(this._lastAxisAreaWidths.entries()),clipSeries=this._lastClipSeries,visibility={...this._lastVisibility}):(axisAreaWidths=new Map,clipSeries=!1,visibility={crossLines:!0,series:!0},this._lastCrossLineIds=crossLineIds);const liveAxisWidths=new Set(this.axes.map(a=>a.position));for(const position of axisAreaWidths.keys())liveAxisWidths.has(position)||axisAreaWidths.delete(position);const stableOutputs=__name((otherAxisWidths,otherClipSeries,otherVisibility)=>{if([...otherAxisWidths.keys()].some(k=>!axisAreaWidths.has(k))||visibility.crossLines!==otherVisibility.crossLines||visibility.series!==otherVisibility.series||clipSeries!==otherClipSeries)return!1;for(const[p,w]of axisAreaWidths.entries()){const otherW=otherAxisWidths.get(p);if((w!=null||otherW!=null)&&w!==otherW)return!1}return!0},"stableOutputs"),ceilValues=__name(map=>{for(const[key,value]of map.entries()){if(value&&Math.abs(value)===1/0){map.set(key,0);continue}map.set(key,value!=null?Math.ceil(value):value)}return map},"ceilValues");let lastPassAxisAreaWidths=new Map,lastPassVisibility={},lastPassClipSeries=!1,seriesRect=(_a274=this.seriesRect)==null?void 0:_a274.clone(),count=0;do{axisAreaWidths=new Map(lastPassAxisAreaWidths.entries()),clipSeries=lastPassClipSeries,Object.assign(visibility,lastPassVisibility);const result=this.updateAxesPass(axisAreaWidths,layoutBox.clone(),seriesRect);if(lastPassAxisAreaWidths=ceilValues(result.axisAreaWidths),lastPassVisibility=result.visibility,lastPassClipSeries=result.clipSeries,{seriesRect}=result,count++>10){Logger.warn("unable to find stable axis layout.");break}}while(!stableOutputs(lastPassAxisAreaWidths,lastPassClipSeries,lastPassVisibility));this.axes.forEach(axis=>{axis.update()});const clipRectPadding=5;return this.axes.forEach(axis=>{if(axis.setCrossLinesVisible(visibility.crossLines),!!seriesRect)switch(axis.clipGrid(seriesRect.x,seriesRect.y,seriesRect.width+clipRectPadding,seriesRect.height+clipRectPadding),axis.position){case"left":case"right":axis.clipTickLines(layoutBox.x,seriesRect.y,layoutBox.width+clipRectPadding,seriesRect.height+clipRectPadding);break;case"top":case"bottom":axis.clipTickLines(seriesRect.x,layoutBox.y,seriesRect.width+clipRectPadding,layoutBox.height+clipRectPadding);break}}),this._lastAxisAreaWidths=axisAreaWidths,this._lastVisibility=visibility,this._lastClipSeries=clipSeries,{seriesRect,animationRect:layoutBox,visibility,clipSeries}}updateAxesPass(axisAreaWidths,bounds,lastPassSeriesRect){var _a274;const axisWidths=new Map,axisGroups=new Map,visibility={series:!0,crossLines:!0};let clipSeries=!1;const primaryTickCounts={},paddedBounds=this.applySeriesPadding(bounds),crossLinePadding=lastPassSeriesRect?this.buildCrossLinePadding(axisAreaWidths):{},axisAreaBound=this.buildAxisBound(paddedBounds,axisAreaWidths,crossLinePadding,visibility),seriesRect=this.buildSeriesRect(axisAreaBound,axisAreaWidths);for(const axis of this.axes){const{position="left"}=axis,{clipSeries:newClipSeries,axisThickness}=this.calculateAxisDimensions({axis,seriesRect,primaryTickCounts,clipSeries});axisWidths.set(axis.id,axisThickness),axisGroups.has(position)||axisGroups.set(position,[]),(_a274=axisGroups.get(position))==null||_a274.push(axis),clipSeries=clipSeries||newClipSeries}const newAxisAreaWidths=new Map,axisOffsets=new Map;for(const[position,axes]of axisGroups.entries())newAxisAreaWidths.set(position,this.calculateAxisArea(axes,axisWidths,axisOffsets));for(const[position,axes]of axisGroups.entries())this.positionAxes({axes,position,axisWidths,axisOffsets,axisAreaWidths:newAxisAreaWidths,axisBound:axisAreaBound,seriesRect});return{clipSeries,seriesRect,axisAreaWidths:newAxisAreaWidths,visibility}}buildCrossLinePadding(axisAreaSize){const crossLinePadding={};this.axes.forEach(axis=>{var _a274;(_a274=axis.crossLines)==null||_a274.forEach(crossLine=>{var _a275;(_a275=crossLine.calculatePadding)==null||_a275.call(crossLine,crossLinePadding)})});for(const[side,padding=0]of Object.entries(crossLinePadding))crossLinePadding[side]=Math.max(padding-(axisAreaSize.get(side)??0),0);return crossLinePadding}applySeriesPadding(bounds){const paddedRect=bounds.clone();return directions.forEach(dir=>{const padding=this.seriesArea.padding[dir],axis=this.axes.findLast(a=>a.position===dir);axis?axis.seriesAreaPadding=padding:paddedRect.shrink(padding,dir)}),paddedRect}buildAxisBound(bounds,axisAreaWidths,crossLinePadding,visibility){const result=bounds.clone(),{top=0,right=0,bottom=0,left=0}=crossLinePadding,horizontalPadding=left+right,verticalPadding=top+bottom,totalWidth=(axisAreaWidths.get("left")??0)+(axisAreaWidths.get("right")??0)+horizontalPadding,totalHeight=(axisAreaWidths.get("top")??0)+(axisAreaWidths.get("bottom")??0)+verticalPadding;return result.width<=totalWidth||result.height<=totalHeight?(visibility.crossLines=!1,visibility.series=!1,result):(result.x+=left,result.y+=top,result.width-=horizontalPadding,result.height-=verticalPadding,result)}buildSeriesRect(axisBound,axisAreaWidths){const result=axisBound.clone();return result.x+=axisAreaWidths.get("left")??0,result.y+=axisAreaWidths.get("top")??0,result.width-=(axisAreaWidths.get("left")??0)+(axisAreaWidths.get("right")??0),result.height-=(axisAreaWidths.get("top")??0)+(axisAreaWidths.get("bottom")??0),result.width=Math.max(0,result.width),result.height=Math.max(0,result.height),result}clampToOutsideSeriesRect(seriesRect,value,dimension,direction){const{x,y,width,height}=seriesRect,compareTo=[x,y,x+width,y+height][(dimension==="x"?0:1)+(direction===1?0:2)];return(direction===1?Math.min:Math.max)(value,compareTo)}calculateAxisDimensions(opts){const{axis,seriesRect,primaryTickCounts}=opts;let{clipSeries}=opts;const{position="left",direction}=axis;this.sizeAxis(axis,seriesRect,position);const isVertical=direction==="y",layout=axis.calculateLayout(axis.nice?primaryTickCounts[direction]:void 0);primaryTickCounts[direction]??(primaryTickCounts[direction]=layout.primaryTickCount),clipSeries||(clipSeries=axis.dataDomain.clipped||axis.visibleRange[0]>0||axis.visibleRange[1]<1);let axisThickness;return axis.thickness!=null&&axis.thickness>0?axisThickness=axis.thickness:axisThickness=isVertical?layout.bbox.width:layout.bbox.height,axisThickness=Math.ceil(axisThickness),{clipSeries,axisThickness}}sizeAxis(axis,seriesRect,position){const isCategory=axis instanceof CategoryAxis||axis instanceof GroupedCategoryAxis,isLeftRight=position==="left"||position==="right";let{min,max}=this.ctx.zoomManager.getAxisZoom(axis.id);const{width,height}=seriesRect,minStart=0,maxEnd=isLeftRight?height:width;let start=minStart,end=maxEnd;const{width:axisWidth,unit,align}=axis.layoutConstraints;unit==="px"?end=start+axisWidth:end=end*axisWidth/100,align==="end"&&(start=maxEnd-(end-start),end=maxEnd),isCategory&&isLeftRight?[min,max]=[1-max,1-min]:isLeftRight&&([start,end]=[end,start]),axis.range=[start,end],axis.visibleRange=[min,max],axis.gridLength=isLeftRight?width:height}calculateAxisArea(axes,axisWidths,axisOffsets){let totalAxisWidth=0,currentOffset=0;for(const axis of axes){axisOffsets.set(axis.id,currentOffset);const axisThickness=axisWidths.get(axis.id)??0;totalAxisWidth=Math.max(totalAxisWidth,currentOffset+axisThickness),axis.layoutConstraints.stacked&&(currentOffset+=axisThickness+15)}return totalAxisWidth}positionAxes(opts){const{axes,axisBound,axisWidths,axisOffsets,axisAreaWidths,seriesRect,position}=opts,axisAreaWidth=axisAreaWidths.get(position)??0;let mainDimension="x",minorDimension="y",direction=1,axisBoundMainOffset=0;(position==="top"||position==="bottom")&&(mainDimension="y",minorDimension="x",axisBoundMainOffset+=1),axisBoundMainOffset+=axisBound[mainDimension],(position==="right"||position==="bottom")&&(direction=-1,axisBoundMainOffset+=mainDimension==="x"?axisBound.width:axisBound.height);for(const axis of axes){const minorOffset=axisAreaWidths.get(minorDimension==="x"?"left":"top")??0;axis.translation[minorDimension]=axisBound[minorDimension]+minorOffset;const axisThickness=axisWidths.get(axis.id)??0,axisOffset=axisOffsets.get(axis.id)??0;axis.translation[mainDimension]=this.clampToOutsideSeriesRect(seriesRect,axisBoundMainOffset+direction*(axisOffset+axisThickness),mainDimension,direction),axis.gridPadding=axisAreaWidth-axisOffset-axisThickness,axis.updatePosition()}}shouldFlipXY(){return this.series.every(series=>series instanceof CartesianSeries&&series.shouldFlipXY())}},__name(_a167,"CartesianChart"),_a167);CartesianChart.className="CartesianChart";CartesianChart.type="cartesian";var _a168,_AgChartInstanceProxy=(_a168=class{constructor(chart,factoryApi,licenseManager){this.factoryApi=factoryApi,this.licenseManager=licenseManager,this.chart=chart}static isInstance(x){var _a274;return x instanceof _a168||((_a274=x.constructor)==null?void 0:_a274.name)==="AgChartInstanceProxy"&&x.chart!=null?!0:x.chart!=null&&this.validateImplementation(x)}static validateImplementation(x){const chartProps=["getOptions","destroy"],signatureProps=Object.keys(Object.getPrototypeOf(x)??{});return chartProps.every(prop=>signatureProps.includes(prop))}async update(options){this.factoryApi.createOrUpdate(options,this),await this.chart.waitForUpdate()}async updateDelta(deltaOptions){this.factoryApi.updateUserDelta(this,deltaOptions),await this.chart.waitForUpdate()}getOptions(){const options=deepClone(this.chart.getOptions());for(const key in options)key.startsWith("_")&&delete options[key];return options}waitForUpdate(){return this.chart.waitForUpdate()}async download(opts){const clone=await this.prepareResizedChart(this,opts);try{clone.chart.download(opts==null?void 0:opts.fileName,opts==null?void 0:opts.fileFormat)}finally{clone.destroy()}}async getImageDataURL(opts){const clone=await this.prepareResizedChart(this,opts);try{return clone.chart.getCanvasDataURL(opts==null?void 0:opts.fileFormat)}finally{clone.destroy()}}getState(){const{factoryApi:{caretaker},chart:{ctx:{annotationManager}}}=this;return caretaker.save(annotationManager)}async setState(state){const{factoryApi:{caretaker},chart:{ctx:{annotationManager}}}=this;caretaker.restore(state,annotationManager),await this.chart.waitForUpdate()}resetAnimations(){this.chart.resetAnimations()}skipAnimations(){this.chart.skipAnimations()}destroy(){this.chart.publicApi=void 0,this.chart.destroy()}async prepareResizedChart(proxy,opts={}){var _a274;const{chart}=proxy,width=opts.width??chart.width??chart.ctx.scene.canvas.width,height=opts.height??chart.height??chart.ctx.scene.canvas.height,state=proxy.getState(),isEnterprise=moduleRegistry.hasEnterpriseModules(),overrideOptions={},processedOptions=chart.chartOptions.getOptions();isEnterprise&&(overrideOptions.animation={enabled:!1},isAgCartesianChartOptions(processedOptions)&&(overrideOptions.toolbar={enabled:!1}),(_a274=this.licenseManager)!=null&&_a274.isDisplayWatermark()&&(overrideOptions.foreground={text:this.licenseManager.getWatermarkMessage(),image:{url:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=",width:170,height:25,right:25,bottom:50,opacity:.7}}));const defaultOpts={container:document.createElement("div"),width,height};opts.width!=null&&opts.height!=null&&(defaultOpts.overrideDevicePixelRatio=1);const options=mergeDefaults(defaultOpts,overrideOptions,processedOptions),cloneProxy=await this.factoryApi.createOrUpdate(options);return await cloneProxy.setState(state),cloneProxy.chart.ctx.zoomManager.updateZoom("chartProxy",chart.ctx.zoomManager.getZoom()),chart.series.forEach((series,index)=>{series.visible||(cloneProxy.chart.series[index].visible=!1)}),cloneProxy.chart.update(0,{forceNodeDataRefresh:!0}),await cloneProxy.waitForUpdate(),cloneProxy}},__name(_a168,"_AgChartInstanceProxy"),_a168);_AgChartInstanceProxy.chartInstances=new WeakMap;__decorateClass([ActionOnSet({oldValue(chart){chart.destroyed||(chart.publicApi=void 0),_AgChartInstanceProxy.chartInstances.delete(chart)},newValue(chart){chart.publicApi=this,_AgChartInstanceProxy.chartInstances.set(chart,this)}})],_AgChartInstanceProxy.prototype,"chart",2);var AgChartInstanceProxy=_AgChartInstanceProxy,_a169,Locale=(_a169=class extends BaseModuleInstance{constructor(ctx){super(),this.ctx=ctx,this.localeText=void 0}},__name(_a169,"Locale"),_a169);__decorateClass([ObserveChanges(target=>{target.ctx.localeManager.setLocaleText(target.localeText)}),Validate(PLAIN_OBJECT,{optional:!0})],Locale.prototype,"localeText",2);__decorateClass([ObserveChanges(target=>{target.ctx.localeManager.setLocaleTextFormatter(target.getLocaleText)}),Validate(FUNCTION,{optional:!0})],Locale.prototype,"getLocaleText",2);var LocaleModule={type:"root",optionsKey:"locale",packageType:"community",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"],moduleFactory:__name(ctx=>new Locale(ctx),"moduleFactory")},_a170,LinearScale=(_a170=class extends ContinuousScale{constructor(){super([0,1],[0,1]),this.type="number"}toDomain(d){return d}ticks(){const count=this.tickCount??ContinuousScale.defaultTickCount;if(!this.domain||this.domain.length<2||count<1||!this.domain.every(isFinite))return[];this.refresh();const[d0,d1]=this.getDomain();if(this.interval){const step=Math.abs(this.interval);if(!isDenseInterval((d1-d0)/step,this.getPixelRange()))return range(d0,d1,step)}return createTicks(d0,d1,count,this.minTickCount,this.maxTickCount)}update(){!this.domain||this.domain.length<2||this.nice&&this.updateNiceDomain()}getTickStep(start,stop){return this.interval??tickStep(start,stop,this.tickCount,this.minTickCount,this.maxTickCount)}updateNiceDomain(){const count=this.tickCount;if(count<1){this.niceDomain=[...this.domain];return}let[start,stop]=this.domain;if(count===1)[start,stop]=niceTicksDomain(start,stop);else{const roundStart=start>stop?Math.ceil:Math.floor,roundStop=stop<start?Math.floor:Math.ceil,maxAttempts=4;for(let i=0;i<maxAttempts;i++){const prev0=start,prev1=stop,step=this.getTickStep(start,stop),[d0,d1]=this.domain;if(step>=1)start=roundStart(d0/step)*step,stop=roundStop(d1/step)*step;else{const s=1/step;start=roundStart(d0*s)/s,stop=roundStop(d1*s)/s}if(start===prev0&&stop===prev1)break}}this.niceDomain=[start,stop]}tickFormat({ticks:specifiedTicks,specifier}){return tickFormat(specifiedTicks??this.ticks(),specifier)}},__name(_a170,"LinearScale"),_a170);function calculateNiceSecondaryAxis(domain,primaryTickCount,reverse){let[start,stop]=findMinMax(domain);start=calculateNiceStart(Math.floor(start),stop,primaryTickCount);const step=getTickStep(start,stop,primaryTickCount),segments=primaryTickCount-1;stop=start+segments*step;const d=reverse?[stop,start]:[start,stop],ticks=getTicks(start,step,primaryTickCount);return{domain:d,ticks}}__name(calculateNiceSecondaryAxis,"calculateNiceSecondaryAxis");function calculateNiceStart(a,b,count){const rawStep=Math.abs(b-a)/(count-1),order=Math.floor(Math.log10(rawStep)),magnitude=Math.pow(10,order);return Math.floor(a/magnitude)*magnitude}__name(calculateNiceStart,"calculateNiceStart");function getTicks(start,step,count){const stepPower=Math.floor(Math.log10(step)),fractionDigits=step>0&&step<1?Math.abs(stepPower):0,f=Math.pow(10,fractionDigits),ticks=[];for(let i=0;i<count;i++){const tick=start+step*i;ticks[i]=Math.round(tick*f)/f}return ticks}__name(getTicks,"getTicks");function getTickStep(start,stop,count){const segments=count-1,rawStep=(stop-start)/segments;return calculateNextNiceStep(rawStep)}__name(getTickStep,"getTickStep");function calculateNextNiceStep(rawStep){const order=Math.floor(Math.log10(rawStep)),magnitude=Math.pow(10,order),step=rawStep/magnitude*10;return step>0&&step<=1?magnitude/10:step>1&&step<=2?2*magnitude/10:step>1&&step<=5?5*magnitude/10:step>5&&step<=10?10*magnitude/10:step>10&&step<=20?20*magnitude/10:step>20&&step<=40?40*magnitude/10:step>40&&step<=50?50*magnitude/10:step>50&&step<=100?100*magnitude/10:step}__name(calculateNextNiceStep,"calculateNextNiceStep");var _a171,NumberAxis=(_a171=class extends CartesianAxis{constructor(moduleCtx,scale2=new LinearScale){super(moduleCtx,scale2),this.min=NaN,this.max=NaN}normaliseDataDomain(d){const{min,max}=this,{extent:extent2,clipped}=normalisedExtentWithMetadata(d,min,max);return{domain:extent2,clipped}}updateSecondaryAxisTicks(primaryTickCount){if(this.dataDomain==null)throw new Error("AG Charts - dataDomain not calculated, cannot perform tick calculation.");if(this.dataDomain.domain.length===0)return[];const{domain,ticks}=calculateNiceSecondaryAxis(this.dataDomain.domain,primaryTickCount??0,this.reverse);return this.scale.nice=!1,this.scale.domain=domain,this.scale.update(),ticks}},__name(_a171,"NumberAxis"),_a171);NumberAxis.className="NumberAxis";NumberAxis.type="number";__decorateClass([Validate(AND(NUMBER_OR_NAN,LESS_THAN("max"))),Default(NaN)],NumberAxis.prototype,"min",2);__decorateClass([Validate(AND(NUMBER_OR_NAN,GREATER_THAN("min"))),Default(NaN)],NumberAxis.prototype,"max",2);var NON_ZERO_NUMBER=predicateWithMessage(value=>isNumber(value)&&value!==0,"a non-zero number"),_a172,LogAxis=(_a172=class extends NumberAxis{constructor(moduleCtx){super(moduleCtx,new LogScale),this.min=NaN,this.max=NaN}normaliseDataDomain(d){const{min,max}=this,{extent:extent2,clipped}=normalisedExtentWithMetadata(d,min,max),isInverted=extent2[0]>extent2[1],crossesZero=extent2[0]<0&&extent2[1]>0,hasZeroExtent=extent2[0]===0&&extent2[1]===0;return(isInverted||crossesZero||hasZeroExtent)&&(crossesZero?Logger.warn("the data domain crosses zero, the chart data cannot be rendered. See log axis documentation for more information."):hasZeroExtent&&Logger.warn("the data domain has 0 extent, no data is rendered.")),extent2[0]===0&&(extent2[0]=1),extent2[1]===0&&(extent2[1]=-1),{domain:extent2,clipped}}set base(value){this.scale.base=value}get base(){return this.scale.base}},__name(_a172,"LogAxis"),_a172);LogAxis.className="LogAxis";LogAxis.type="log";__decorateClass([Validate(AND(NUMBER_OR_NAN,NON_ZERO_NUMBER,LESS_THAN("max"))),Default(NaN)],LogAxis.prototype,"min",2);__decorateClass([Validate(AND(NUMBER_OR_NAN,NON_ZERO_NUMBER,GREATER_THAN("min"))),Default(NaN)],LogAxis.prototype,"max",2);var _a173,TimeAxis=(_a173=class extends CartesianAxis{constructor(moduleCtx){super(moduleCtx,new TimeScale),this.min=void 0,this.max=void 0}normaliseDataDomain(d){var _a274;let{min,max}=this,clipped=!1;return typeof min=="number"&&(min=new Date(min)),typeof max=="number"&&(max=new Date(max)),d.length>2&&(d=((_a274=extent(d))==null?void 0:_a274.map(x=>new Date(x)))??[]),min instanceof Date&&(clipped||(clipped=min>d[0]),d=[min,d[1]]),max instanceof Date&&(clipped||(clipped=max<d[1]),d=[d[0],max]),d[0]>d[1]&&(d=[]),{domain:d,clipped}}onFormatChange(ticks,fractionDigits,domain,format){format?super.onFormatChange(ticks,fractionDigits,domain,format):(this.labelFormatter=this.scale.tickFormat({ticks,domain}),this.datumFormatter=this.scale.tickFormat({ticks,domain,formatOffset:1}))}},__name(_a173,"TimeAxis"),_a173);TimeAxis.className="TimeAxis";TimeAxis.type="time";__decorateClass([Validate(AND(DATE_OR_DATETIME_MS,LESS_THAN("max")),{optional:!0})],TimeAxis.prototype,"min",2);__decorateClass([Validate(AND(DATE_OR_DATETIME_MS,GREATER_THAN("min")),{optional:!0})],TimeAxis.prototype,"max",2);var drawCorner=__name((path,{x0,y0,x1,y1,cx,cy},cornerRadius,move)=>{if(move&&path.moveTo(x0,y0),x0!==x1||y0!==y1){const r0=Math.atan2(y0-cy,x0-cx),r1=Math.atan2(y1-cy,x1-cx);path.arc(cx,cy,cornerRadius,r0,r1)}else path.lineTo(x0,y0)},"drawCorner"),epsilon=1e-6,cornerEdges=__name((leadingEdge,trailingEdge,leadingInset,trailingInset,cornerRadius)=>{let leadingClipped=!1,trailingClipped=!1,leading0=trailingInset-Math.sqrt(Math.max(cornerRadius**2-leadingInset**2,0)),leading1=0,trailing0=0,trailing1=leadingInset-Math.sqrt(Math.max(cornerRadius**2-trailingInset**2,0));return leading0>leadingEdge?(leadingClipped=!0,leading0=leadingEdge,leading1=leadingInset-Math.sqrt(Math.max(cornerRadius**2-(trailingInset-leadingEdge)**2))):leading0<epsilon&&(leading0=0),trailing1>trailingEdge?(trailingClipped=!0,trailing0=trailingInset-Math.sqrt(Math.max(cornerRadius**2-(leadingInset-trailingEdge)**2)),trailing1=trailingEdge):trailing1<epsilon&&(trailing1=0),{leading0,leading1,trailing0,trailing1,leadingClipped,trailingClipped}},"cornerEdges"),insetCornerRadiusRect=__name((path,x,y,width,height,cornerRadii,clipBBox)=>{let{topLeft:topLeftCornerRadius,topRight:topRightCornerRadius,bottomRight:bottomRightCornerRadius,bottomLeft:bottomLeftCornerRadius}=cornerRadii;const maxVerticalCornerRadius=Math.max(topLeftCornerRadius+bottomLeftCornerRadius,topRightCornerRadius+bottomRightCornerRadius),maxHorizontalCornerRadius=Math.max(topLeftCornerRadius+topRightCornerRadius,bottomLeftCornerRadius+bottomRightCornerRadius);if(maxVerticalCornerRadius<=0&&maxHorizontalCornerRadius<=0){clipBBox==null?path.rect(x,y,width,height):path.rect(clipBBox.x,clipBBox.y,clipBBox.width,clipBBox.height);return}else if(clipBBox==null&&topLeftCornerRadius===topRightCornerRadius&&topLeftCornerRadius===bottomRightCornerRadius&&topLeftCornerRadius===bottomLeftCornerRadius){path.roundRect(x,y,width,height,topLeftCornerRadius);return}if(width<0&&(x+=width,width=Math.abs(width)),height<0&&(y+=height,height=Math.abs(height)),width<=0||height<=0)return;if(clipBBox==null)clipBBox=new BBox(x,y,width,height);else{const x0=Math.max(x,clipBBox.x),x1=Math.min(x+width,clipBBox.x+clipBBox.width),y0=Math.max(y,clipBBox.y),y1=Math.min(y+height,clipBBox.y+clipBBox.height);clipBBox=new BBox(x0,y0,x1-x0,y1-y0)}const borderScale=Math.max(maxVerticalCornerRadius/height,maxHorizontalCornerRadius/width,1);borderScale>1&&(topLeftCornerRadius/=borderScale,topRightCornerRadius/=borderScale,bottomRightCornerRadius/=borderScale,bottomLeftCornerRadius/=borderScale);let drawTopLeftCorner=!0,drawTopRightCorner=!0,drawBottomRightCorner=!0,drawBottomLeftCorner=!0,topLeftCorner,topRightCorner,bottomRightCorner,bottomLeftCorner;if(drawTopLeftCorner){const nodes=cornerEdges(clipBBox.height,clipBBox.width,Math.max(x+topLeftCornerRadius-clipBBox.x,0),Math.max(y+topLeftCornerRadius-clipBBox.y,0),topLeftCornerRadius);nodes.leadingClipped&&(drawBottomLeftCorner=!1),nodes.trailingClipped&&(drawTopRightCorner=!1);const x0=Math.max(clipBBox.x+nodes.leading1,clipBBox.x),y0=Math.max(clipBBox.y+nodes.leading0,clipBBox.y),x1=Math.max(clipBBox.x+nodes.trailing1,clipBBox.x),y1=Math.max(clipBBox.y+nodes.trailing0,clipBBox.y),cx=x+topLeftCornerRadius,cy=y+topLeftCornerRadius;topLeftCorner={x0,y0,x1,y1,cx,cy}}if(drawTopRightCorner){const nodes=cornerEdges(clipBBox.width,clipBBox.height,Math.max(y+topRightCornerRadius-clipBBox.y,0),Math.max(clipBBox.x+clipBBox.width-(x+width-topRightCornerRadius),0),topRightCornerRadius);nodes.leadingClipped&&(drawTopLeftCorner=!1),nodes.trailingClipped&&(drawBottomRightCorner=!1);const x0=Math.min(clipBBox.x+clipBBox.width-nodes.leading0,clipBBox.x+clipBBox.width),y0=Math.max(clipBBox.y+nodes.leading1,clipBBox.y),x1=Math.min(clipBBox.x+clipBBox.width-nodes.trailing0,clipBBox.x+clipBBox.width),y1=Math.max(clipBBox.y+nodes.trailing1,clipBBox.y),cx=x+width-topRightCornerRadius,cy=y+topRightCornerRadius;topRightCorner={x0,y0,x1,y1,cx,cy}}if(drawBottomRightCorner){const nodes=cornerEdges(clipBBox.height,clipBBox.width,Math.max(clipBBox.x+clipBBox.width-(x+width-bottomRightCornerRadius),0),Math.max(clipBBox.y+clipBBox.height-(y+height-bottomRightCornerRadius),0),bottomRightCornerRadius);nodes.leadingClipped&&(drawTopRightCorner=!1),nodes.trailingClipped&&(drawBottomLeftCorner=!1);const x0=Math.min(clipBBox.x+clipBBox.width-nodes.leading1,clipBBox.x+clipBBox.width),y0=Math.min(clipBBox.y+clipBBox.height-nodes.leading0,clipBBox.y+clipBBox.height),x1=Math.min(clipBBox.x+clipBBox.width-nodes.trailing1,clipBBox.x+clipBBox.width),y1=Math.min(clipBBox.y+clipBBox.height-nodes.trailing0,clipBBox.y+clipBBox.height),cx=x+width-bottomRightCornerRadius,cy=y+height-bottomRightCornerRadius;bottomRightCorner={x0,y0,x1,y1,cx,cy}}if(drawBottomLeftCorner){const nodes=cornerEdges(clipBBox.width,clipBBox.height,Math.max(clipBBox.y+clipBBox.height-(y+height-bottomLeftCornerRadius),0),Math.max(x+bottomLeftCornerRadius-clipBBox.x,0),bottomLeftCornerRadius);nodes.leadingClipped&&(drawBottomRightCorner=!1),nodes.trailingClipped&&(drawTopLeftCorner=!1);const x0=Math.max(clipBBox.x+nodes.leading0,clipBBox.x),y0=Math.min(clipBBox.y+clipBBox.height-nodes.leading1,clipBBox.y+clipBBox.height),x1=Math.max(clipBBox.x+nodes.trailing0,clipBBox.x),y1=Math.min(clipBBox.y+clipBBox.height-nodes.trailing1,clipBBox.y+clipBBox.height),cx=x+bottomLeftCornerRadius,cy=y+height-bottomLeftCornerRadius;bottomLeftCorner={x0,y0,x1,y1,cx,cy}}let didMove=!1;drawTopLeftCorner&&topLeftCorner!=null&&(drawCorner(path,topLeftCorner,topLeftCornerRadius,!didMove),didMove||(didMove=!0)),drawTopRightCorner&&topRightCorner!=null&&(drawCorner(path,topRightCorner,topRightCornerRadius,!didMove),didMove||(didMove=!0)),drawBottomRightCorner&&bottomRightCorner!=null&&(drawCorner(path,bottomRightCorner,bottomRightCornerRadius,!didMove),didMove||(didMove=!0)),drawBottomLeftCorner&&bottomLeftCorner!=null&&(drawCorner(path,bottomLeftCorner,bottomLeftCornerRadius,!didMove),didMove||(didMove=!0)),path.closePath()},"insetCornerRadiusRect"),_a174,Rect=(_a174=class extends Path{constructor(){super(...arguments),this.borderPath=new ExtendedPath2D,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=Shape.defaultStyles.strokeWidth,this.effectiveStrokeWidth=Shape.defaultStyles.strokeWidth,this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint,this.microPixelEffectOpacity=1}set cornerRadius(cornerRadius){this.topLeftCornerRadius=cornerRadius,this.topRightCornerRadius=cornerRadius,this.bottomRightCornerRadius=cornerRadius,this.bottomLeftCornerRadius=cornerRadius}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth||!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){var _a274;const{path,borderPath,crisp,topLeftCornerRadius:topLeft,topRightCornerRadius:topRight,bottomRightCornerRadius:bottomRight,bottomLeftCornerRadius:bottomLeft}=this;let{x,y,width:w,height:h,strokeWidth,clipBBox}=this;const pixelSize=1/(((_a274=this.layerManager)==null?void 0:_a274.canvas.pixelRatio)??1);let microPixelEffectOpacity=1;if(path.clear(!0),borderPath.clear(!0),crisp&&(w<=pixelSize&&(microPixelEffectOpacity*=w/pixelSize),h<=pixelSize&&(microPixelEffectOpacity*=h/pixelSize),w=this.align(x,w),h=this.align(y,h),x=this.align(x),y=this.align(y),clipBBox=clipBBox!=null?new BBox(this.align(clipBBox.x),this.align(clipBBox.y),this.align(clipBBox.x,clipBBox.width),this.align(clipBBox.y,clipBBox.height)):void 0),strokeWidth)if(w<pixelSize){const lx=x+pixelSize/2;borderPath.moveTo(lx,y),borderPath.lineTo(lx,y+h),strokeWidth=pixelSize,this.borderClipPath=void 0}else if(h<pixelSize){const ly=y+pixelSize/2;borderPath.moveTo(x,ly),borderPath.lineTo(x+w,ly),strokeWidth=pixelSize,this.borderClipPath=void 0}else if(strokeWidth<w&&strokeWidth<h){const halfStrokeWidth=strokeWidth/2;x+=halfStrokeWidth,y+=halfStrokeWidth,w-=strokeWidth,h-=strokeWidth;const adjustedClipBBox=clipBBox==null?void 0:clipBBox.clone().shrink(halfStrokeWidth),cornerRadii={topLeft:topLeft>0?topLeft-strokeWidth:0,topRight:topRight>0?topRight-strokeWidth:0,bottomRight:bottomRight>0?bottomRight-strokeWidth:0,bottomLeft:bottomLeft>0?bottomLeft-strokeWidth:0};this.borderClipPath=void 0,w>0&&h>0&&(adjustedClipBBox==null||(adjustedClipBBox==null?void 0:adjustedClipBBox.width)>0&&(adjustedClipBBox==null?void 0:adjustedClipBBox.height)>0)&&(insetCornerRadiusRect(path,x,y,w,h,cornerRadii,adjustedClipBBox),insetCornerRadiusRect(borderPath,x,y,w,h,cornerRadii,adjustedClipBBox))}else this.borderClipPath=this.borderClipPath??new ExtendedPath2D,this.borderClipPath.clear(!0),this.borderClipPath.rect(x,y,w,h),borderPath.rect(x,y,w,h);else{const cornerRadii={topLeft,topRight,bottomRight,bottomLeft};this.borderClipPath=void 0,insetCornerRadiusRect(path,x,y,w,h,cornerRadii,clipBBox)}if([topLeft,topRight,bottomRight,bottomLeft].every(r=>r===0)){const bbox=this.getBBox();this.hittester=bbox.containsPoint.bind(bbox),this.distanceSquared=(hitX,hitY)=>this.getBBox().distanceSquared(hitX,hitY)}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=strokeWidth,this.lastUpdatePathStrokeWidth=strokeWidth,this.microPixelEffectOpacity=microPixelEffectOpacity}computeBBox(){const{x,y,width,height,clipBBox}=this;return(clipBBox==null?void 0:clipBBox.clone())??new BBox(x,y,width,height)}isPointInPath(x,y){return this.hittester(x,y)}get midPoint(){return{x:this.x+this.width/2,y:this.y+this.height/2}}distanceSquared(x,y){return this.distanceCalculator(x,y)}applyFillAlpha(ctx){const{fillOpacity,microPixelEffectOpacity,opacity}=this;ctx.globalAlpha*=opacity*fillOpacity*microPixelEffectOpacity}renderStroke(ctx){const{stroke,effectiveStrokeWidth}=this;if(stroke&&effectiveStrokeWidth){const{globalAlpha}=ctx,{strokeOpacity,lineDash,lineDashOffset,lineCap,lineJoin,borderPath,borderClipPath,opacity,microPixelEffectOpacity}=this;borderClipPath&&ctx.clip(borderClipPath.getPath2D()),ctx.strokeStyle=stroke,ctx.globalAlpha*=opacity*strokeOpacity*microPixelEffectOpacity,ctx.lineWidth=effectiveStrokeWidth,lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),ctx.stroke(borderPath.getPath2D()),ctx.globalAlpha=globalAlpha}}},__name(_a174,"Rect"),_a174);Rect.className="Rect";__decorateClass([ScenePathChangeDetection()],Rect.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"y",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"width",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"height",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topLeftCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topRightCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomRightCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomLeftCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"clipBBox",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"crisp",2);var _a175,Background=(_a175=class extends BaseModuleInstance{constructor(ctx,zIndex=0,layer=!1){super(),this.zIndex=zIndex,this.layer=layer,this.rectNode=new Rect,this.textNode=new Text,this.fill="white",this.node=new Group({name:"background",zIndex:this.zIndex,layer:this.layer}),this.node.append([this.rectNode,this.textNode]),this.visible=!0,this.destroyFns.push(ctx.scene.attachNode(this.node),ctx.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)))}onLayoutComplete(e){const{width,height}=e.chart;this.rectNode.width=width,this.rectNode.height=height}},__name(_a175,"Background"),_a175);__decorateClass([Validate(BOOLEAN),ProxyPropertyOnWrite("node","visible")],Background.prototype,"visible",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),ProxyPropertyOnWrite("rectNode","fill")],Background.prototype,"fill",2);__decorateClass([Validate(OBJECT,{optional:!0})],Background.prototype,"image",2);__decorateClass([Validate(STRING,{optional:!0}),ProxyPropertyOnWrite("textNode")],Background.prototype,"text",2);var BackgroundModule={type:"root",optionsKey:"background",packageType:"community",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"],moduleFactory:__name(ctx=>new Background(ctx),"moduleFactory")},_a176,SpriteRenderer=(_a176=class{constructor(){this.offscreenCanvas=new OffscreenCanvas(1,1);const ctx=this.offscreenCanvas.getContext("2d");if(ctx==null)throw new TypeError("AG Charts - invalid 2d context");this.renderCtx={ctx,devicePixelRatio:1,forceRender:!0,resized:!1,debugNodes:{}}}resize({spritePixelRatio,spriteWidth,spriteHeight}){this.offscreenCanvas.width=Math.max(spriteWidth,0)*spritePixelRatio,this.offscreenCanvas.height=Math.max(spriteHeight,0)*spritePixelRatio}renderSprite(nodes,opts){nodes=toIterable(nodes);const{renderCtx,renderCtx:{ctx},offscreenCanvas}=this,{scale:scale2=1,translateX=0,translateY=0}=opts??{};ctx.resetTransform(),ctx.clearRect(0,0,offscreenCanvas.width,offscreenCanvas.height),ctx.save(),ctx.beginPath(),ctx.setTransform(scale2,0,0,scale2,translateX,translateY);for(const node of nodes)node.render(renderCtx);return ctx.closePath(),ctx.restore(),offscreenCanvas.transferToImageBitmap()}},__name(_a176,"SpriteRenderer"),_a176);function addRemovableEventListener(destroyFns,elem,type,listener){elem.addEventListener(type,listener);const remover=__name(()=>elem.removeEventListener(type,listener),"remover");return destroyFns.push(remover),remover}__name(addRemovableEventListener,"addRemovableEventListener");function addEscapeEventListener(destroyFns,elem,onEscape){addRemovableEventListener(destroyFns,elem,"keydown",event=>{event.key==="Escape"&&onEscape(event)})}__name(addEscapeEventListener,"addEscapeEventListener");function addMouseCloseListener(destroyFns,menu,hideCallback){const self=addRemovableEventListener(destroyFns,window,"mousedown",event=>{[0,2].includes(event.button)&&!containsPoint(menu,event)&&(hideCallback(),self())});return self}__name(addMouseCloseListener,"addMouseCloseListener");function containsPoint(container,event){if(event.target instanceof Element){const{x,y,width,height}=container.getBoundingClientRect(),{clientX:ex,clientY:ey}=event;return ex>=x&&ey>=y&&ex<=x+width&&ey<=y+height}return!1}__name(containsPoint,"containsPoint");function matchesKey(event,key,...morekeys){return!(event.shiftKey||event.altKey||event.ctrlKey||event.metaKey)&&(event.key===key||morekeys.some(altkey=>event.key===altkey))}__name(matchesKey,"matchesKey");function linkTwoButtons(destroyFns,src,dst,key){dst&&addRemovableEventListener(destroyFns,src,"keydown",event=>{matchesKey(event,key)&&dst.focus()})}__name(linkTwoButtons,"linkTwoButtons");function linkThreeButtons(destroyFns,curr,next,nextKey,prev,prevKey){linkTwoButtons(destroyFns,curr,prev,prevKey),linkTwoButtons(destroyFns,curr,next,nextKey),addRemovableEventListener(destroyFns,curr,"keydown",event=>{matchesKey(event,nextKey,prevKey)&&event.preventDefault()})}__name(linkThreeButtons,"linkThreeButtons");var PREV_NEXT_KEYS={horizontal:{nextKey:"ArrowRight",prevKey:"ArrowLeft"},vertical:{nextKey:"ArrowDown",prevKey:"ArrowUp"}};function initToolbarKeyNav(opts){return opts.toolbar.role="toolbar",opts.toolbar.ariaOrientation=opts.orientation,opts.toolbar.ariaHidden=(opts.buttons.length===0).toString(),initRovingTabIndex(opts)}__name(initToolbarKeyNav,"initToolbarKeyNav");function initRovingTabIndex(opts){const{orientation,buttons,wrapAround=!1,onEscape,onFocus,onBlur}=opts,{nextKey,prevKey}=PREV_NEXT_KEYS[orientation],setTabIndices=__name(event=>{event.target&&"tabIndex"in event.target&&(buttons.forEach(b=>b.tabIndex=-1),event.target.tabIndex=0)},"setTabIndices"),[c,m]=wrapAround?[buttons.length,buttons.length]:[0,1/0],destroyFns=[];for(let i=0;i<buttons.length;i++){const prev=buttons[(c+i-1)%m],curr=buttons[i],next=buttons[(c+i+1)%m];addRemovableEventListener(destroyFns,curr,"focus",setTabIndices),onFocus&&addRemovableEventListener(destroyFns,curr,"focus",onFocus),onBlur&&addRemovableEventListener(destroyFns,curr,"blur",onBlur),onEscape&&addEscapeEventListener(destroyFns,curr,onEscape),linkThreeButtons(destroyFns,curr,prev,prevKey,next,nextKey),curr.tabIndex=i===0?0:-1}return destroyFns}__name(initRovingTabIndex,"initRovingTabIndex");var _a177,MenuCloserImp=(_a177=class{constructor(menu,lastFocus,closeCallback){this.lastFocus=lastFocus,this.closeCallback=closeCallback,this.destroyFns=[],this.destroyFns.push(addMouseCloseListener(this.destroyFns,menu,()=>this.close()))}close(){this.destroyFns.forEach(d=>d()),this.destroyFns.length=0,this.closeCallback(),this.finishClosing()}finishClosing(){var _a274;this.destroyFns.forEach(d=>d()),this.destroyFns.length=0,setAttribute(this.lastFocus,"aria-expanded",!1),(_a274=this.lastFocus)==null||_a274.focus(),this.lastFocus=void 0}},__name(_a177,"MenuCloserImp"),_a177);function initMenuKeyNav(opts){var _a274;const{device,orientation,menu,buttons,closeCallback,autoCloseOnBlur=!1,skipMouseFocusRestore=!1}=opts,{nextKey,prevKey}=PREV_NEXT_KEYS[orientation];setAttribute(device.lastFocus,"aria-expanded",!0);const lastFocus=device.type==="keyboard"||!skipMouseFocusRestore?device.lastFocus:void 0,menuCloser=new MenuCloserImp(menu,lastFocus,closeCallback),onEscape=__name(()=>menuCloser.close(),"onEscape"),{destroyFns}=menuCloser;if(menu.role="menu",menu.ariaOrientation=orientation,initRovingTabIndex({orientation,buttons,onEscape,wrapAround:!0}),menu.tabIndex=-1,addEscapeEventListener(destroyFns,menu,onEscape),addRemovableEventListener(destroyFns,menu,"keydown",ev=>{var _a275;ev.target===menu&&(ev.key===nextKey||ev.key===prevKey)&&(ev.preventDefault(),(_a275=buttons[0])==null||_a275.focus())}),autoCloseOnBlur){const handler=__name(ev=>{!buttons.includes(ev.relatedTarget)&&onEscape()},"handler");for(const button of buttons)addRemovableEventListener(destroyFns,button,"blur",handler)}return device.type==="keyboard"?(_a274=buttons[0])==null||_a274.focus():menu.focus(),menuCloser}__name(initMenuKeyNav,"initMenuKeyNav");function makeAccessibleClickListener(element2,onclick){return event=>{if(element2.ariaDisabled==="true")return event.preventDefault();onclick(event)}}__name(makeAccessibleClickListener,"makeAccessibleClickListener");function isButtonClickEvent(event){return"button"in event?event.button===0:!event.altKey&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&["Enter","Space"].includes(event.code)}__name(isButtonClickEvent,"isButtonClickEvent");function gridLayout({orientation,bboxes,maxHeight,maxWidth,itemPaddingY=0,itemPaddingX=0,forceResult=!1}){const horizontal=orientation==="horizontal",primary={max:horizontal?maxWidth:maxHeight,fn:horizontal?b=>b.width:b=>b.height,padding:horizontal?itemPaddingX:itemPaddingY},secondary={max:horizontal?maxHeight:maxWidth,fn:horizontal?b=>b.height:b=>b.width,padding:horizontal?itemPaddingY:itemPaddingX};let processedBBoxCount=0;const rawPages=[];for(;processedBBoxCount<bboxes.length;){const unprocessedBBoxes=bboxes.slice(processedBBoxCount),result=processBBoxes(unprocessedBBoxes,processedBBoxCount,primary,secondary,forceResult);if(!result)return;processedBBoxCount+=result.processedBBoxCount,rawPages.push(result.pageIndices)}return buildPages(rawPages,orientation,bboxes,itemPaddingY,itemPaddingX)}__name(gridLayout,"gridLayout");function processBBoxes(bboxes,indexOffset,primary,secondary,forceResult){let startingGuess=estimateStartingGuess(bboxes,primary);if(startingGuess<1){if(!forceResult)return;startingGuess=1}let guess=startingGuess;for(;guess>=1;){const pageIndices=calculatePage(bboxes,indexOffset,guess,primary,secondary,forceResult);if(pageIndices==null&&guess<=1)return;if(pageIndices==null){guess--;continue}if(typeof pageIndices=="number"){if(pageIndices<=1)return;guess=pageIndices<guess&&pageIndices>1?pageIndices:guess,guess--;continue}return{processedBBoxCount:pageIndices.length*pageIndices[0].length,pageIndices}}}__name(processBBoxes,"processBBoxes");function calculatePage(bboxes,indexOffset,primaryCount,primary,secondary,forceResult){const result=[];let sumSecondary=0,currentMaxSecondary=0,currentPrimaryIndices=[];const maxPrimaryValues=[];for(let bboxIndex=0;bboxIndex<bboxes.length;bboxIndex++){const primaryValueIdx=(bboxIndex+primaryCount)%primaryCount;primaryValueIdx===0&&(sumSecondary+=currentMaxSecondary,currentMaxSecondary=0,currentPrimaryIndices.length>0&&result.push(currentPrimaryIndices),currentPrimaryIndices=[]);const primaryValue=primary.fn(bboxes[bboxIndex])+primary.padding;maxPrimaryValues[primaryValueIdx]=Math.max(maxPrimaryValues[primaryValueIdx]??0,primaryValue),currentMaxSecondary=Math.max(currentMaxSecondary,secondary.fn(bboxes[bboxIndex])+secondary.padding);const currentSecondaryDimension=sumSecondary+currentMaxSecondary,returnResult=!forceResult||result.length>0;if(currentSecondaryDimension>secondary.max&&returnResult){currentPrimaryIndices=[];break}if(maxPrimaryValues.reduce((sum2,next)=>sum2+next,0)>primary.max&&!forceResult)return maxPrimaryValues.length<primaryCount?maxPrimaryValues.length:void 0;currentPrimaryIndices.push(bboxIndex+indexOffset)}return currentPrimaryIndices.length>0&&result.push(currentPrimaryIndices),result.length>0?result:void 0}__name(calculatePage,"calculatePage");function buildPages(rawPages,orientation,bboxes,itemPaddingY,itemPaddingX){let maxPageWidth=0,maxPageHeight=0;return{pages:rawPages.map(indices=>{orientation==="horizontal"&&(indices=transpose(indices));let endIndex=0;const columns=indices.map(colIndices=>{const colBBoxes=colIndices.map(bboxIndex=>(endIndex=Math.max(bboxIndex,endIndex),bboxes[bboxIndex]));let columnHeight=0,columnWidth=0;return colBBoxes.forEach(bbox=>{columnHeight+=bbox.height+itemPaddingY,columnWidth=Math.max(columnWidth,bbox.width+itemPaddingX)}),{indices:colIndices,bboxes:colBBoxes,columnHeight:Math.ceil(columnHeight),columnWidth:Math.ceil(columnWidth)}});let pageWidth=0,pageHeight=0;return columns.forEach(column=>{pageWidth+=column.columnWidth,pageHeight=Math.max(pageHeight,column.columnHeight)}),maxPageWidth=Math.max(pageWidth,maxPageWidth),maxPageHeight=Math.max(pageHeight,maxPageHeight),{columns,startIndex:indices[0][0],endIndex,pageWidth,pageHeight}}),maxPageWidth,maxPageHeight}}__name(buildPages,"buildPages");function transpose(data){const result=[];for(const _ of data[0])result.push([]);return data.forEach((innerData,dataIdx)=>{innerData.forEach((item,itemIdx)=>{result[itemIdx][dataIdx]=item})}),result}__name(transpose,"transpose");function estimateStartingGuess(bboxes,primary){const n=bboxes.length;let primarySum=0;for(let bboxIndex=0;bboxIndex<n;bboxIndex++)if(primarySum+=primary.fn(bboxes[bboxIndex])+primary.padding,primarySum>primary.max)return n/bboxIndex<2?Math.ceil(n/2):bboxIndex;return n}__name(estimateStartingGuess,"estimateStartingGuess");var _a178,Image=(_a178=class extends Node{constructor(sourceImage){super(),this.sourceImage=sourceImage,this.x=0,this.y=0,this.width=0,this.height=0,this.opacity=1}updateBitmap(newBitmap,bitmapPixelRatio,x,y){this.sourceImage=newBitmap,this.width=newBitmap.width/bitmapPixelRatio,this.height=newBitmap.height/bitmapPixelRatio,this.x=x/bitmapPixelRatio,this.y=y/bitmapPixelRatio,this.markDirty(this,3)}render(renderCtx){const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&stats.nodesSkipped++;return}const image=this.sourceImage;image&&(ctx.globalAlpha=this.opacity,ctx.drawImage(image,0,0,image.width,image.height,this.x,this.y,this.width,this.height),super.render(renderCtx))}},__name(_a178,"Image"),_a178);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"x",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"y",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"width",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"height",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"opacity",2);var _a179,LegendMarkerLabel=(_a179=class extends Translatable(Group){constructor(){super({name:"markerLabelGroup"}),this.label=new Text,this.symbolsGroup=new Group({name:"legend-markerLabel-symbols"}),this.bitmap=new Image,this.bitmapDirty=!0,this.enabled=!0,this.pageIndex=NaN,this._markers=[],this._lines=[];const{markers,label,lines}=this;label.textBaseline="middle",label.fontSize=12,label.fontFamily="Verdana, sans-serif",label.fill="black",label.y=1,this.updateSymbols(markers,lines),this.append([this.symbolsGroup,label])}destroy(){var _a274,_b;super.destroy(),(_a274=this.proxyButton)==null||_a274.button.remove(),(_b=this.proxyButton)==null||_b.listitem.remove()}get markers(){return this._markers}get lines(){return this._lines}updateSymbols(markers,lines){arraysEqual(this._markers,markers)&&arraysEqual(this._lines,lines)||(this.bitmapDirty=!0,this._markers=markers,this._lines=lines,this.symbolsGroup.clear(),this.symbolsGroup.append([this.bitmap,...markers,...lines]))}setEnabled(enabled){this.enabled=enabled,this.refreshVisibilities()}refreshVisibilities(){const opacity=this.enabled?1:.5;this.label.opacity=opacity,this.opacity=opacity,this.bitmap.opacity=opacity,this.setBitmapVisibility(!this.enabled)}setBitmapVisibility(visible){const{lines,markers}=this;[lines,markers].forEach(shapes=>shapes.forEach(shape=>shape.visible=!visible)),this.bitmap.visible=visible}update(spriteRenderer,{spriteAAPadding,spritePixelRatio:scale2},dimensionProps){const{markers,lines}=this;let spriteX=0,spriteY=0,shift=0;for(let i=0;i<Math.max(markers.length,lines.length);i++){const{length:length2,spacing,isCustomMarker}=dimensionProps[i]??0,marker=markers[i],line=lines[i],size=(marker==null?void 0:marker.size)??0;let lineTop=1/0,lineX1=1/0,lineX2=1/0,markerTop=1/0,markerLeft=1/0;if(marker){const center=marker.constructor.center,radius=(size+marker.strokeWidth)/2;isCustomMarker?(marker.x=0,marker.y=0,marker.translationX=(center.x-.5)*size+length2/2+shift,marker.translationY=(center.y-.5)*size,markerTop=marker.translationY-radius,markerLeft=marker.translationX-radius):(marker.x=(center.x-.5)*size+length2/2+shift,marker.y=(center.y-.5)*size,markerTop=marker.y-radius,markerLeft=marker.x-radius)}line&&(line.x1=shift,line.x2=shift+length2,line.y1=0,line.y2=0,line.markDirty(this,3),lineTop=-line.strokeWidth/2,lineX1=line.x1,lineX2=line.x2),shift+=spacing+Math.max(length2,size),spriteX=Math.min(spriteX,lineX1,lineX2,markerLeft),spriteY=Math.min(spriteY,lineTop,markerTop)}const lastSymbolProps=dimensionProps.at(-1),lastLine=this.lines.at(-1),lastMarker=this.markers.at(-1),lineEnd=lastLine?lastLine.x2:-1/0,markerEnd=((lastMarker==null?void 0:lastMarker.x)??0)+((lastMarker==null?void 0:lastMarker.size)??0)/2;if(this.label.x=Math.max(lineEnd,markerEnd)+((lastSymbolProps==null?void 0:lastSymbolProps.spacing)??0),this.bitmapDirty){this.setBitmapVisibility(!1);const translateX=(spriteAAPadding+spriteX)*scale2,translateY=(spriteAAPadding-spriteY)*scale2,sprite=spriteRenderer.renderSprite(this.symbolsGroup,{scale:scale2,translateX:Math.floor(translateX),translateY:Math.floor(translateY)});this.bitmap.updateBitmap(sprite,scale2,Math.ceil(-translateX),Math.ceil(-translateY)),this.bitmapDirty=!1,this.refreshVisibilities()}if(dimensionProps.length<2)return;const bbox=this.symbolsGroup.getBBox(),clippedWidth=Math.max((lastMarker==null?void 0:lastMarker.size)??0,(lastSymbolProps==null?void 0:lastSymbolProps.length)??0),clipRect=new BBox(bbox.x+clippedWidth/2,bbox.y,clippedWidth,bbox.height);this.symbolsGroup.setClipRectInGroupCoordinateSpace(clipRect)}computeBBox(){const{label,lines,markers}=this;return this.toParent(Group.computeChildrenBBox(iterate([label],lines,markers),{skipInvisible:!1}))}},__name(_a179,"LegendMarkerLabel"),_a179);LegendMarkerLabel.className="MarkerLabel";__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"text",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontStyle",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontWeight",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontSize",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontFamily",2);__decorateClass([ProxyPropertyOnWrite("label","fill")],LegendMarkerLabel.prototype,"color",2);var _a180,PaginationLabel=(_a180=class extends BaseProperties{constructor(){super(...arguments),this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}},__name(_a180,"PaginationLabel"),_a180);__decorateClass([Validate(COLOR_STRING)],PaginationLabel.prototype,"color",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],PaginationLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0})],PaginationLabel.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],PaginationLabel.prototype,"fontFamily",2);var _a181,PaginationMarkerStyle=(_a181=class extends BaseProperties{constructor(){super(...arguments),this.size=15,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=1,this.strokeOpacity=1}},__name(_a181,"PaginationMarkerStyle"),_a181);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarkerStyle.prototype,"size",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],PaginationMarkerStyle.prototype,"fill",2);__decorateClass([Validate(RATIO,{optional:!0})],PaginationMarkerStyle.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],PaginationMarkerStyle.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarkerStyle.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],PaginationMarkerStyle.prototype,"strokeOpacity",2);var _a182,PaginationMarker=(_a182=class extends BaseProperties{constructor(parent){super(),this.parent=parent,this.shape=Triangle,this.size=15,this.padding=8}},__name(_a182,"PaginationMarker"),_a182);__decorateClass([ActionOnSet({changeValue(){this.parent.marker===this&&this.parent.onMarkerShapeChange()}})],PaginationMarker.prototype,"shape",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarker.prototype,"size",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarker.prototype,"padding",2);var _a183,Pagination=(_a183=class extends BaseProperties{constructor(chartUpdateCallback,pageUpdateCallback,regionManager,cursorManager){super(),this.chartUpdateCallback=chartUpdateCallback,this.pageUpdateCallback=pageUpdateCallback,this.regionManager=regionManager,this.cursorManager=cursorManager,this.id=createId(this),this.marker=new PaginationMarker(this),this.activeStyle=new PaginationMarkerStyle,this.inactiveStyle=new PaginationMarkerStyle,this.highlightStyle=new PaginationMarkerStyle,this.label=new PaginationLabel,this.group=new TranslatableGroup({name:"pagination"}),this.labelNode=new Text,this.destroyFns=[],this.totalPages=0,this.currentPage=0,this.translationX=0,this.translationY=0,this.nextButtonDisabled=!1,this.previousButtonDisabled=!1,this._visible=!0,this._enabled=!0,this._orientation="vertical",this._nextButton=new Triangle,this._previousButton=new Triangle,this.labelNode.setProperties({textBaseline:"middle",fontSize:12,fontFamily:"Verdana, sans-serif",fill:"black",y:1}),this.group.append([this.nextButton,this.previousButton,this.labelNode]);const region=this.regionManager.addRegion("pagination",this.group);this.destroyFns.push(region.addListener("click",event=>this.onPaginationClick(event)),region.addListener("hover",event=>this.onPaginationMouseMove(event))),this.update(),this.updateMarkers()}destroy(){this.destroyFns.forEach(f=>f())}set visible(value){this._visible=value,this.updateGroupVisibility()}get visible(){return this._visible}set enabled(value){this._enabled=value,this.updateGroupVisibility()}get enabled(){return this._enabled}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible}set orientation(value){switch(this._orientation=value,value){case"horizontal":{this.previousButton.rotation=-Math.PI/2,this.nextButton.rotation=Math.PI/2;break}case"vertical":default:this.previousButton.rotation=0,this.nextButton.rotation=Math.PI}}get orientation(){return this._orientation}set nextButton(value){this._nextButton!==value&&(this.group.removeChild(this._nextButton),this._nextButton=value,this.group.appendChild(value))}get nextButton(){return this._nextButton}set previousButton(value){this._previousButton!==value&&(this.group.removeChild(this._previousButton),this._previousButton=value,this.group.appendChild(value))}get previousButton(){return this._previousButton}update(){this.updateLabel(),this.updatePositions(),this.enableOrDisableButtons()}updatePositions(){this.group.translationX=this.translationX,this.group.translationY=this.translationY,this.updateLabelPosition(),this.updateNextButtonPosition()}updateLabelPosition(){const{size:markerSize,padding:markerPadding}=this.marker;this.nextButton.size=markerSize,this.previousButton.size=markerSize,this.labelNode.x=markerSize/2+markerPadding}updateNextButtonPosition(){const labelBBox=this.labelNode.getBBox();this.nextButton.translationX=labelBBox.width+(this.marker.size/2+this.marker.padding)*2}updateLabel(){const{currentPage,totalPages:pages,labelNode,label:{color,fontStyle,fontWeight,fontSize,fontFamily}}=this;labelNode.text=`${currentPage+1} / ${pages}`,labelNode.fill=color,labelNode.fontStyle=fontStyle,labelNode.fontWeight=fontWeight,labelNode.fontSize=fontSize,labelNode.fontFamily=fontFamily}updateMarkers(){const{nextButton,previousButton,nextButtonDisabled,previousButtonDisabled,activeStyle,inactiveStyle,highlightStyle,highlightActive}=this,buttonStyle=__name((button,disabled)=>disabled?inactiveStyle:button===highlightActive?highlightStyle:activeStyle,"buttonStyle");this.updateMarker(nextButton,buttonStyle("next",nextButtonDisabled)),this.updateMarker(previousButton,buttonStyle("previous",previousButtonDisabled))}updateMarker(marker,style){const{size}=this.marker;marker.size=size,marker.fill=style.fill,marker.fillOpacity=style.fillOpacity??1,marker.stroke=style.stroke,marker.strokeWidth=style.strokeWidth,marker.strokeOpacity=style.strokeOpacity}enableOrDisableButtons(){const{currentPage,totalPages}=this,zeroPagesToDisplay=totalPages===0,onLastPage=currentPage===totalPages-1,onFirstPage=currentPage===0;this.nextButtonDisabled=onLastPage||zeroPagesToDisplay,this.previousButtonDisabled=onFirstPage||zeroPagesToDisplay}clickNext(){this.incrementPage(),this.onPaginationChanged()}clickPrevious(){this.decrementPage(),this.onPaginationChanged()}setPage(pageNumber){pageNumber=clamp(0,pageNumber,this.totalPages-1),this.currentPage!==pageNumber&&(this.currentPage=pageNumber,this.onPaginationChanged())}onPaginationClick(event){const{regionOffsetX,regionOffsetY}=event;event.preventDefault();const node=this.group.pickNode(regionOffsetX,regionOffsetY,!0);node===this.nextButton&&!this.nextButtonDisabled?this.clickNext():node===this.previousButton&&!this.previousButtonDisabled&&this.clickPrevious()}onPaginationMouseMove(event){const{regionOffsetX,regionOffsetY}=event,node=this.group.pickNode(regionOffsetX,regionOffsetY,!0);node===this.nextButton&&!this.nextButtonDisabled?(this.cursorManager.updateCursor(this.id,"pointer"),this.highlightActive="next"):node===this.previousButton&&!this.previousButtonDisabled?(this.cursorManager.updateCursor(this.id,"pointer"),this.highlightActive="previous"):(this.cursorManager.updateCursor(this.id),this.highlightActive=void 0),this.updateMarkers(),this.chartUpdateCallback(6)}onPaginationChanged(){this.pageUpdateCallback(this.currentPage)}incrementPage(){this.currentPage=Math.min(this.currentPage+1,this.totalPages-1)}decrementPage(){this.currentPage=Math.max(this.currentPage-1,0)}onMarkerShapeChange(){const Marker2=Rotatable(getMarker(this.marker.shape||Triangle));this.previousButton=new Marker2,this.nextButton=new Marker2,this.updatePositions(),this.updateMarkers(),this.chartUpdateCallback(6)}attachPagination(node){node.append(this.group)}getBBox(){return this.group.getBBox()}computeCSSBounds(){const prev=Transformable.toCanvas(this.previousButton),next=Transformable.toCanvas(this.nextButton);return{prev,next}}},__name(_a183,"Pagination"),_a183);Pagination.className="Pagination";__decorateClass([Validate(OBJECT)],Pagination.prototype,"marker",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"activeStyle",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"inactiveStyle",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"highlightStyle",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"label",2);var _a184,LegendLabel=(_a184=class extends BaseProperties{constructor(){super(...arguments),this.maxLength=void 0,this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}},__name(_a184,"LegendLabel"),_a184);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendLabel.prototype,"maxLength",2);__decorateClass([Validate(COLOR_STRING)],LegendLabel.prototype,"color",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],LegendLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT,{optional:!0})],LegendLabel.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],LegendLabel.prototype,"fontFamily",2);__decorateClass([Validate(FUNCTION,{optional:!0})],LegendLabel.prototype,"formatter",2);var _a185,LegendMarker=(_a185=class extends BaseProperties{constructor(){super(...arguments),this.size=15,this.padding=8}},__name(_a185,"LegendMarker"),_a185);__decorateClass([ObserveChanges(target=>{var _a274;return(_a274=target.parent)==null?void 0:_a274.onMarkerShapeChange()})],LegendMarker.prototype,"shape",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendMarker.prototype,"size",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendMarker.prototype,"padding",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendMarker.prototype,"strokeWidth",2);__decorateClass([Validate(BOOLEAN)],LegendMarker.prototype,"enabled",2);var _a186,LegendLine=(_a186=class extends BaseProperties{},__name(_a186,"LegendLine"),_a186);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendLine.prototype,"strokeWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendLine.prototype,"length",2);var _a187,LegendItem=(_a187=class extends BaseProperties{constructor(){super(...arguments),this.paddingX=16,this.paddingY=8,this.showSeriesStroke=!1,this.marker=new LegendMarker,this.label=new LegendLabel,this.line=new LegendLine}},__name(_a187,"LegendItem"),_a187);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendItem.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendItem.prototype,"paddingX",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendItem.prototype,"paddingY",2);__decorateClass([Validate(BOOLEAN)],LegendItem.prototype,"showSeriesStroke",2);__decorateClass([Validate(OBJECT)],LegendItem.prototype,"marker",2);__decorateClass([Validate(OBJECT)],LegendItem.prototype,"label",2);__decorateClass([Validate(OBJECT)],LegendItem.prototype,"line",2);var _a188,LegendListeners=(_a188=class extends BaseProperties{},__name(_a188,"LegendListeners"),_a188);__decorateClass([Validate(FUNCTION,{optional:!0})],LegendListeners.prototype,"legendItemClick",2);__decorateClass([Validate(FUNCTION,{optional:!0})],LegendListeners.prototype,"legendItemDoubleClick",2);var ID_LEGEND_VISIBILITY="legend-visibility",ID_LEGEND_OTHER_SERIES="legend-other-series",_a189,Legend=(_a189=class extends BaseProperties{constructor(ctx){super(),this.ctx=ctx,this.id=createId(this),this.group=new TranslatableGroup({name:"legend",layer:!0,zIndex:14}),this.itemSelection=Selection.select(this.group,LegendMarkerLabel),this.spriteRenderer=new SpriteRenderer,this.oldSize=[0,0],this.pages=[],this.maxPageSize=[0,0],this.paginationTrackingIndex=0,this.truncatedItems=new Set,this._data=[],this._symbolsDirty=!0,this.toggleSeries=!0,this.item=new LegendItem,this.listeners=new LegendListeners,this.enabled=!0,this.position="bottom",this.spacing=20,this.destroyFns=[],this.size=[0,0],this._visible=!0,this.item.marker.parent=this,this.pagination=new Pagination(type=>ctx.updateService.update(type),page=>this.updatePageNumber(page),ctx.regionManager,ctx.cursorManager),this.pagination.attachPagination(this.group),this.destroyFns.push(ctx.contextMenuRegistry.registerDefaultAction({id:ID_LEGEND_VISIBILITY,type:"legend",label:"contextMenuToggleSeriesVisibility",action:__name(params=>this.contextToggleVisibility(params),"action")}),ctx.contextMenuRegistry.registerDefaultAction({id:ID_LEGEND_OTHER_SERIES,type:"legend",label:"contextMenuToggleOtherSeries",action:__name(params=>this.contextToggleOtherSeries(params),"action")}));const{Default:Default2,Animation:Animation2,ContextMenu}=InteractionState,animationState=Default2|Animation2,contextMenuState=Default2|Animation2|ContextMenu,region=ctx.regionManager.addRegion("legend",this.group);this.destroyFns.push(region.addListener("contextmenu",e=>this.checkContextClick(e),contextMenuState),region.addListener("click",e=>this.checkLegendClick(e),animationState),region.addListener("dblclick",e=>this.checkLegendDoubleClick(e),animationState),region.addListener("hover",e=>this.handleLegendMouseMove(e),animationState),region.addListener("leave",()=>this.handleLegendMouseExit(),animationState),region.addListener("enter",e=>this.handleLegendMouseEnter(e),animationState),ctx.layoutManager.registerElement(1,e=>this.positionLegend(e)),ctx.localeManager.addListener("locale-changed",()=>this.onLocaleChanged()),()=>{var _a274;return(_a274=this.group.parent)==null?void 0:_a274.removeChild(this.group)}),this.proxyLegendToolbar=this.ctx.proxyInteractionService.createProxyContainer({type:"list",id:`${this.id}-toolbar`,classList:["ag-charts-proxy-legend-toolbar"],ariaLabel:{id:"ariaLabelLegend"},ariaHidden:!0}),this.proxyLegendPagination=this.ctx.proxyInteractionService.createProxyContainer({type:"group",id:`${this.id}-pagination`,classList:["ag-charts-proxy-legend-pagination"],ariaLabel:{id:"ariaLabelLegendPagination"},ariaOrientation:"horizontal",ariaHidden:!0}),this.proxyLegendItemDescription=createElement("p"),this.proxyLegendItemDescription.style.display="none",this.proxyLegendItemDescription.id=`${this.id}-ariaDescription`,this.proxyLegendItemDescription.textContent=this.getItemAriaDescription(),this.proxyLegendToolbar.append(this.proxyLegendItemDescription)}set data(value){this._data=value,this._symbolsDirty=!0,this.updateGroupVisibility()}get data(){return this._data}destroy(){this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-toolbar`),this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-pagination`),this.destroyFns.forEach(f=>f()),this.pagination.destroy(),this.itemSelection.clear()}initLegendItemToolbar(){this.itemSelection.each((markerLabel,_,i)=>{markerLabel.proxyButton??(markerLabel.proxyButton=this.ctx.proxyInteractionService.createProxyElement({type:"listswitch",id:`ag-charts-legend-item-${i}`,textContent:this.getItemAriaText(i),ariaChecked:!!markerLabel.datum.enabled,ariaDescribedBy:this.proxyLegendItemDescription.id,parent:this.proxyLegendToolbar,focusable:new NodeRegionBBoxProvider(markerLabel),onclick:__name(()=>{var _a274;this.doClick(markerLabel.datum,(_a274=markerLabel.proxyButton)==null?void 0:_a274.button)},"onclick"),onblur:__name(()=>this.handleLegendMouseExit(),"onblur"),onfocus:__name(()=>{const bounds=Transformable.toCanvas(markerLabel),event=makeKeyboardPointerEvent(this.ctx.focusIndicator,{bounds,showFocusBox:!0});this.doHover(event,markerLabel.datum),this.pagination.setPage(markerLabel.pageIndex)},"onfocus")}))});const buttons=this.itemSelection.nodes().map(markerLabel=>{var _a274;return(_a274=markerLabel.proxyButton)==null?void 0:_a274.button}).filter(button=>!!button);initRovingTabIndex({orientation:this.getOrientation(),buttons}),this.proxyLegendToolbar.ariaHidden=(buttons.length===0).toString()}onMarkerShapeChange(){this.itemSelection.clear(),this.group.markDirty(this.group,2)}getOrientation(){if(this.orientation!==void 0)return this.orientation;switch(this.position){case"right":case"left":return"vertical";case"bottom":case"top":return"horizontal"}}set visible(value){this._visible=value,this.updateGroupVisibility()}get visible(){return this._visible}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible&&this.data.length>0}attachLegend(scene){scene.appendChild(this.group)}getItemLabel(datum){const{ctx:{callbackCache}}=this,{formatter}=this.item.label;return formatter?callbackCache.call(formatter,{itemId:datum.itemId,value:datum.label.text,seriesId:datum.seriesId}):datum.label.text}calcLayout(width,height){const{paddingX,paddingY,label,maxWidth,label:{maxLength=1/0,fontStyle,fontWeight,fontSize,fontFamily}}=this.item,data=[...this.data];this.reverseOrder&&data.reverse();const proxyToolbarNeedsUpdate=this.itemSelection.nodes().length===0;this.itemSelection.update(data),proxyToolbarNeedsUpdate&&this.initLegendItemToolbar();const bboxes=[],font=TextUtils.toFontString(label),maxItemWidth=maxWidth??width*.8,spriteDims=this.calculateSpriteDimensions();if(this.spriteRenderer.resize(spriteDims),this.itemSelection.each((markerLabel,datum)=>{markerLabel.fontStyle=fontStyle,markerLabel.fontWeight=fontWeight,markerLabel.fontSize=fontSize,markerLabel.fontFamily=fontFamily;const paddedSymbolWidth=this.updateMarkerLabel(markerLabel,datum,spriteDims),id=datum.itemId??datum.id,text=(this.getItemLabel(datum)??"<unknown>").replace(/\r?\n/g," ");markerLabel.text=this.truncate(text,maxLength,maxItemWidth,paddedSymbolWidth,font,id),bboxes.push(markerLabel.getBBox())}),this._symbolsDirty=!1,width=Math.max(1,width),height=Math.max(1,height),!isFinite(width))return{};const size=this.size,oldSize=this.oldSize;size[0]=width,size[1]=height,(size[0]!==oldSize[0]||size[1]!==oldSize[1])&&(oldSize[0]=size[0],oldSize[1]=size[1]);const{pages,maxPageHeight,maxPageWidth}=this.updatePagination(bboxes,width,height),oldPages=this.pages;this.pages=pages,this.maxPageSize=[maxPageWidth-paddingX,maxPageHeight-paddingY];const pageNumber=this.pagination.currentPage,page=this.pages[pageNumber];return this.pages.length<1||!page?(this.visible=!1,{oldPages}):(this.visible=!0,this.updatePositions(pageNumber),this.update(),{oldPages})}isCustomMarker(markerEnabled,shape){return markerEnabled&&shape!==void 0&&typeof shape!="string"}calcSymbolsEnabled(symbol){const{showSeriesStroke,marker}=this.item,markerEnabled=!!marker.enabled||!showSeriesStroke||(symbol.marker.enabled??!0),lineEnabled=!!(symbol.line&&showSeriesStroke),isCustomMarker=this.isCustomMarker(markerEnabled,symbol.marker.shape);return{markerEnabled,lineEnabled,isCustomMarker}}calcSymbolsLengths(symbol){const{marker,line}=this.item,{markerEnabled,lineEnabled}=this.calcSymbolsEnabled(symbol),{strokeWidth:markerStrokeWidth}=this.getMarkerStyles(symbol),{strokeWidth:lineStrokeWidth}=lineEnabled?this.getLineStyles(symbol):{strokeWidth:0};let customMarkerSize;const{shape}=symbol.marker;if(this.isCustomMarker(markerEnabled,shape)){const tmpShape=new shape;tmpShape.updatePath();const bbox=tmpShape.getBBox();customMarkerSize=Math.max(bbox.width,bbox.height)}const markerLength=markerEnabled?marker.size:0,lineLength=lineEnabled?line.length??25:0;return{markerLength,markerStrokeWidth,lineLength,lineStrokeWidth,customMarkerSize}}calculateSpriteDimensions(){let spriteAAPadding=0,spriteWidth=0,spriteHeight=0,markerWidth=0;return this.itemSelection.each((_,datum)=>{datum.symbols.forEach(symbol=>{const{markerLength,markerStrokeWidth,lineLength,lineStrokeWidth,customMarkerSize=-1/0}=this.calcSymbolsLengths(symbol),markerTotalLength=markerLength+markerStrokeWidth;markerWidth=Math.max(markerWidth,lineLength,customMarkerSize,markerLength),spriteWidth=Math.max(spriteWidth,lineLength,customMarkerSize,markerTotalLength),spriteHeight=Math.max(spriteHeight,lineStrokeWidth,markerTotalLength),spriteAAPadding=Math.max(spriteAAPadding,markerStrokeWidth+.5)})}),spriteWidth+=spriteAAPadding*2,spriteHeight+=spriteAAPadding*2,{spritePixelRatio:getWindow().devicePixelRatio,spriteAAPadding,spriteWidth,spriteHeight,markerWidth}}updateMarkerLabel(markerLabel,datum,spriteDims){const{marker:itemMarker,paddingX}=this.item,{markerWidth}=spriteDims,dimensionProps=[];let paddedSymbolWidth=paddingX;if(this._symbolsDirty){const markers=[],lines=[];datum.symbols.forEach(symbol=>{const{shape:markerShape=symbol.marker.shape}=itemMarker,MarkerCtr=getMarker(markerShape);lines.push(new Line),markers.push(new MarkerCtr)}),markerLabel.updateSymbols(markers,lines)}return datum.symbols.forEach((symbol,i)=>{const spacing=symbol.marker.padding??itemMarker.padding,{markerEnabled,lineEnabled,isCustomMarker}=this.calcSymbolsEnabled(symbol);markerLabel.markers[i].size=markerEnabled||!lineEnabled?itemMarker.size:0,dimensionProps.push({length:markerWidth,spacing,isCustomMarker}),(markerEnabled||lineEnabled)&&(paddedSymbolWidth+=spacing+markerWidth);const marker=markerLabel.markers[i],line=markerLabel.lines[i];if(marker){const{strokeWidth,fill,stroke,fillOpacity,strokeOpacity}=this.getMarkerStyles(symbol);marker.fill=fill,marker.stroke=stroke,marker.strokeWidth=strokeWidth,marker.fillOpacity=fillOpacity,marker.strokeOpacity=strokeOpacity}if(line){const lineStyles=this.getLineStyles(symbol);line.stroke=lineStyles.stroke,line.strokeOpacity=lineStyles.strokeOpacity,line.strokeWidth=lineStyles.strokeWidth,line.lineDash=lineStyles.lineDash}}),markerLabel.update(this.spriteRenderer,spriteDims,dimensionProps),paddedSymbolWidth}truncate(text,maxCharLength,maxItemWidth,paddedMarkerWidth,font,id){let addEllipsis=!1;text.length>maxCharLength&&(text=text.substring(0,maxCharLength),addEllipsis=!0);const measurer=CachedTextMeasurerPool.getMeasurer({font}),result=TextWrapper.truncateLine(text,measurer,maxItemWidth-paddedMarkerWidth,addEllipsis);return result.endsWith(TextUtils.EllipsisChar)?this.truncatedItems.add(id):this.truncatedItems.delete(id),result}updatePagination(bboxes,width,height){const orientation=this.getOrientation(),trackingIndex=Math.min(this.paginationTrackingIndex,bboxes.length);this.pagination.orientation=orientation,this.pagination.translationX=0,this.pagination.translationY=0;const{pages,maxPageHeight,maxPageWidth,paginationBBox,paginationVertical}=this.calculatePagination(bboxes,width,height),newCurrentPage=pages.findIndex(p=>p.endIndex>=trackingIndex);this.pagination.currentPage=clamp(0,newCurrentPage,pages.length-1);const{paddingX:itemPaddingX,paddingY:itemPaddingY}=this.item,paginationComponentPadding=8,legendItemsWidth=maxPageWidth-itemPaddingX,legendItemsHeight=maxPageHeight-itemPaddingY;let paginationX=0,paginationY=-paginationBBox.y-this.item.marker.size/2;paginationVertical?paginationY+=legendItemsHeight+paginationComponentPadding:(paginationX+=-paginationBBox.x+legendItemsWidth+paginationComponentPadding,paginationY+=(legendItemsHeight-paginationBBox.height)/2),this.pagination.translationX=paginationX,this.pagination.translationY=paginationY,this.pagination.update(),this.pagination.updateMarkers();let pageIndex=0;return this.itemSelection.each((markerLabel,_,nodeIndex)=>{var _a274;nodeIndex>(((_a274=pages[pageIndex])==null?void 0:_a274.endIndex)??1/0)&&pageIndex++,markerLabel.pageIndex=pageIndex}),{maxPageHeight,maxPageWidth,pages}}updateItemProxyButtons(){this.itemSelection.each(l=>{var _a274;return setElementBBox((_a274=l.proxyButton)==null?void 0:_a274.listitem,Transformable.toCanvas(l))})}updatePaginationProxyButtons(oldPages){var _a274,_b;this.proxyLegendPagination.style.display=this.pagination.visible?"absolute":"none";const oldNeedsButtons=((oldPages==null?void 0:oldPages.length)??this.pages.length)>1,newNeedsButtons=this.pages.length>1;oldNeedsButtons!==newNeedsButtons&&(newNeedsButtons?(this.proxyPrevButton=this.ctx.proxyInteractionService.createProxyElement({type:"button",id:`${this.id}-prev-page`,textContent:{id:"ariaLabelLegendPagePrevious"},tabIndex:0,parent:this.proxyLegendPagination,focusable:new NodeRegionBBoxProvider(this.pagination.previousButton),onclick:__name(()=>this.pagination.clickPrevious(),"onclick")}),this.proxyNextButton??(this.proxyNextButton=this.ctx.proxyInteractionService.createProxyElement({type:"button",id:`${this.id}-next-page`,textContent:{id:"ariaLabelLegendPageNext"},tabIndex:0,parent:this.proxyLegendPagination,focusable:new NodeRegionBBoxProvider(this.pagination.nextButton),onclick:__name(()=>this.pagination.clickNext(),"onclick")})),this.proxyLegendPagination.ariaHidden="false"):((_a274=this.proxyNextButton)==null||_a274.remove(),(_b=this.proxyPrevButton)==null||_b.remove(),[this.proxyNextButton,this.proxyPrevButton]=[void 0,void 0],this.proxyLegendPagination.ariaHidden="true"));const{prev,next}=this.pagination.computeCSSBounds();setElementBBox(this.proxyPrevButton,prev),setElementBBox(this.proxyNextButton,next)}calculatePagination(bboxes,width,height){const{paddingX:itemPaddingX,paddingY:itemPaddingY}=this.item,orientation=this.getOrientation(),paginationVertical=["left","right"].includes(this.position);let paginationBBox=this.pagination.getBBox(),lastPassPaginationBBox=new BBox(0,0,0,0),pages=[],maxPageWidth=0,maxPageHeight=0,count=0;const stableOutput=__name(bbox=>bbox.width===paginationBBox.width&&bbox.height===paginationBBox.height,"stableOutput"),forceResult=this.maxWidth!==void 0&&this.maxHeight!==void 0;do{if(count++>10){Logger.warn("unable to find stable legend layout.");break}paginationBBox=lastPassPaginationBBox;const maxWidth=width-(paginationVertical?0:paginationBBox.width),maxHeight=height-(paginationVertical?paginationBBox.height:0),layout=gridLayout({orientation,bboxes,maxHeight,maxWidth,itemPaddingY,itemPaddingX,forceResult});pages=(layout==null?void 0:layout.pages)??[],maxPageWidth=(layout==null?void 0:layout.maxPageWidth)??0,maxPageHeight=(layout==null?void 0:layout.maxPageHeight)??0;const totalPages=pages.length;if(this.pagination.visible=totalPages>1,this.pagination.totalPages=totalPages,this.pagination.update(),this.pagination.updateMarkers(),lastPassPaginationBBox=this.pagination.getBBox(),!this.pagination.visible)break}while(!stableOutput(lastPassPaginationBBox));return{maxPageWidth,maxPageHeight,pages,paginationBBox:lastPassPaginationBBox,paginationVertical}}updatePositions(pageNumber=0){const{item:{paddingY},itemSelection,pages}=this;if(pages.length<1||!pages[pageNumber])return;const{columns,startIndex:visibleStart,endIndex:visibleEnd}=pages[pageNumber];let x=0,y=0;const columnCount=columns.length,rowCount=columns[0].indices.length,horizontal=this.getOrientation()==="horizontal",itemHeight=columns[0].bboxes[0].height+paddingY,rowSumColumnWidths=[];itemSelection.each((markerLabel,_,i)=>{if(i<visibleStart||i>visibleEnd){markerLabel.visible=!1;return}const pageIndex=i-visibleStart;let columnIndex,rowIndex;horizontal?(columnIndex=pageIndex%columnCount,rowIndex=Math.floor(pageIndex/columnCount)):(columnIndex=Math.floor(pageIndex/rowCount),rowIndex=pageIndex%rowCount),markerLabel.visible=!0;const column=columns[columnIndex];column&&(y=Math.floor(itemHeight*rowIndex),x=Math.floor(rowSumColumnWidths[rowIndex]??0),rowSumColumnWidths[rowIndex]=(rowSumColumnWidths[rowIndex]??0)+column.columnWidth,markerLabel.translationX=x,markerLabel.translationY=y)}),this.updateItemProxyButtons()}updatePageNumber(pageNumber){const{pages}=this,{startIndex,endIndex}=pages[pageNumber];startIndex===0?this.paginationTrackingIndex=0:pageNumber===pages.length-1?this.paginationTrackingIndex=endIndex:this.paginationTrackingIndex=Math.floor((startIndex+endIndex)/2),this.pagination.update(),this.pagination.updateMarkers(),this.updatePositions(pageNumber),this.ctx.updateService.update(6)}update(){const{label:{color}}=this.item;this.itemSelection.each((markerLabel,datum)=>{markerLabel.setEnabled(datum.enabled),markerLabel.color=color}),this.updateContextMenu()}updateContextMenu(){const{toggleSeries}=this;this.ctx.contextMenuRegistry.setActionVisiblity(ID_LEGEND_VISIBILITY,toggleSeries),this.ctx.contextMenuRegistry.setActionVisiblity(ID_LEGEND_OTHER_SERIES,toggleSeries)}getLineStyles(datum){const{stroke,strokeOpacity=1,strokeWidth,lineDash}=datum.line??{},defaultLineStrokeWidth=Math.min(2,strokeWidth??1);return{stroke,strokeOpacity,strokeWidth:this.item.line.strokeWidth??defaultLineStrokeWidth,lineDash}}getMarkerStyles(datum){const{fill,stroke,strokeOpacity=1,fillOpacity=1,strokeWidth}=datum.marker,defaultLineStrokeWidth=Math.min(2,strokeWidth??1);return{fill,stroke,strokeOpacity,fillOpacity,strokeWidth:this.item.marker.strokeWidth??defaultLineStrokeWidth}}getDatumForPoint(x,y){const visibleChildBBoxes=[],closestLeftTop={dist:1/0,datum:void 0};for(const child of this.group.children){if(!child.visible||!(child instanceof LegendMarkerLabel))continue;const childBBox=child.getBBox().clone();if(childBBox.grow(this.item.paddingX/2,"horizontal"),childBBox.grow(this.item.paddingY/2,"vertical"),childBBox.containsPoint(x,y))return child.datum;const distX=x-childBBox.x-this.item.paddingX/2,distY=y-childBBox.y-this.item.paddingY/2,dist=distX**2+distY**2;distX>=0&&distY>=0&&dist<closestLeftTop.dist&&(closestLeftTop.dist=dist,closestLeftTop.datum=child.datum),visibleChildBBoxes.push(childBBox)}if(BBox.merge(visibleChildBBoxes).containsPoint(x,y))return closestLeftTop.datum}computePagedBBox(){let actualBBox=Group.computeChildrenBBox(this.group.children);if(this.pages.length<=1)return actualBBox;const[maxPageWidth,maxPageHeight]=this.maxPageSize;return actualBBox=actualBBox.clone(),actualBBox.height=Math.max(maxPageHeight,actualBBox.height),actualBBox.width=Math.max(maxPageWidth,actualBBox.width),actualBBox}contextToggleVisibility(params){const datum=this.data.find(v=>v.itemId===params.itemId);this.doClick(datum)}contextToggleOtherSeries(params){const datum=this.data.find(v=>v.itemId===params.itemId);this.doDoubleClick(datum)}checkContextClick(event){var _a274;const legendItem=this.getDatumForPoint(event.regionOffsetX,event.regionOffsetY);this.preventHidingAll&&((_a274=this.contextMenuDatum)!=null&&_a274.enabled)&&this.getVisibleItemCount()<=1?this.ctx.contextMenuRegistry.disableAction(ID_LEGEND_VISIBILITY):this.ctx.contextMenuRegistry.enableAction(ID_LEGEND_VISIBILITY),this.ctx.contextMenuRegistry.dispatchContext("legend",event,{legendItem})}checkLegendClick(event){const datum=this.getDatumForPoint(event.regionOffsetX,event.regionOffsetY);this.doClick(datum)&&event.preventDefault()}getVisibleItemCount(){return this.ctx.chartService.series.flatMap(s=>s.getLegendData("category")).filter(d=>d.enabled).length}doClick(datum,proxyButton){var _a274,_b;const{listeners:{legendItemClick},ctx:{chartService,highlightManager},preventHidingAll,toggleSeries}=this;if(!datum)return!1;const{id,itemId,enabled}=datum,series=chartService.series.find(s=>s.id===id);if(!series)return!1;let newEnabled=enabled;return toggleSeries&&(newEnabled=!enabled,preventHidingAll&&!newEnabled&&this.getVisibleItemCount()<2&&(newEnabled=!0),proxyButton??(proxyButton=(_b=(_a274=this.itemSelection.select(ml=>ml.datum===datum)[0])==null?void 0:_a274.proxyButton)==null?void 0:_b.button),proxyButton&&(proxyButton.ariaChecked=newEnabled.toString()),this.ctx.chartEventManager.legendItemClick(series,itemId,newEnabled,datum.legendItemName)),newEnabled?highlightManager.updateHighlight(this.id,{series,itemId,datum:void 0}):highlightManager.updateHighlight(this.id),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),legendItemClick==null||legendItemClick({type:"click",enabled:newEnabled,itemId,seriesId:series.id}),!0}checkLegendDoubleClick(event){const datum=this.getDatumForPoint(event.regionOffsetX,event.regionOffsetY);this.doDoubleClick(datum)&&event.preventDefault()}doDoubleClick(datum){const{listeners:{legendItemDoubleClick},ctx:{chartService},toggleSeries}=this;if(chartService.mode==="integrated"||!datum)return!1;const{id,itemId,seriesId}=datum,series=chartService.series.find(s=>s.id===id);if(!series)return!1;if(toggleSeries){const legendData=chartService.series.flatMap(s=>s.getLegendData("category")),numVisibleItems=legendData.filter(d=>d.enabled).length,clickedItem=legendData.find(d=>d.itemId===itemId&&d.seriesId===seriesId);this.ctx.chartEventManager.legendItemDoubleClick(series,itemId,(clickedItem==null?void 0:clickedItem.enabled)??!1,numVisibleItems,clickedItem==null?void 0:clickedItem.legendItemName)}return this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),legendItemDoubleClick==null||legendItemDoubleClick({type:"dblclick",enabled:!0,itemId,seriesId:series.id}),!0}handleLegendMouseMove(event){if(!this.enabled)return;event.preventDefault();const{regionOffsetX,regionOffsetY}=event,datum=this.getDatumForPoint(regionOffsetX,regionOffsetY);this.doHover(event,datum)}doHover(event,datum){const{toggleSeries,listeners}=this;if(event===void 0||datum===void 0){this.ctx.cursorManager.updateCursor(this.id),this.updateHighlight();return}const series=datum?this.ctx.chartService.series.find(s=>s.id===(datum==null?void 0:datum.id)):void 0;if(datum&&this.truncatedItems.has(datum.itemId??datum.id)){const{offsetX,offsetY}=event;this.ctx.tooltipManager.updateTooltip(this.id,{offsetX,offsetY,lastPointerEvent:event,showArrow:!1},toTooltipHtml({content:this.getItemLabel(datum)}))}else this.ctx.tooltipManager.removeTooltip(this.id);(toggleSeries||listeners.legendItemClick!=null||listeners.legendItemDoubleClick!=null)&&this.ctx.cursorManager.updateCursor(this.id,"pointer"),datum!=null&&datum.enabled&&series?this.updateHighlight({series,itemId:datum==null?void 0:datum.itemId,datum:void 0}):this.updateHighlight()}handleLegendMouseExit(){this.ctx.cursorManager.updateCursor(this.id),this.ctx.tooltipManager.removeTooltip(this.id),this.updateHighlight()}updateHighlight(datum){const state=this.ctx.interactionManager.getState();state===16?this.ctx.highlightManager.updateHighlight(this.id,datum):state===1&&(this.pendingHighlightDatum=datum,this.ctx.animationManager.onBatchStop(()=>{this.ctx.highlightManager.updateHighlight(this.id,this.pendingHighlightDatum)}))}handleLegendMouseEnter(event){const{enabled,toggleSeries,listeners:{legendItemClick:clickListener,legendItemDoubleClick:dblclickListener}}=this,datum=this.getDatumForPoint(event.regionOffsetX,event.regionOffsetY);enabled&&datum!==void 0&&(toggleSeries||clickListener!=null||dblclickListener!=null)&&this.ctx.cursorManager.updateCursor(this.id,"pointer")}onLocaleChanged(){this.itemSelection.each(({proxyButton},_,i)=>{(proxyButton==null?void 0:proxyButton.button)!=null&&(proxyButton.button.textContent=this.getItemAriaText(i))}),this.proxyLegendItemDescription.textContent=this.getItemAriaDescription()}getItemAriaText(nodeIndex){const datum=this.data[nodeIndex],label=datum&&this.getItemLabel(datum),lm=this.ctx.localeManager;if(nodeIndex>=0&&label){const index=nodeIndex+1,count=this.data.length;return lm.t("ariaLabelLegendItem",{label,index,count})}return lm.t("ariaLabelLegendItemUnknown")}getItemAriaDescription(){return this.ctx.localeManager.t("ariaDescriptionLegendItem")}positionLegend(ctx){if(!this.enabled||!this.data.length)return;const{layoutBox}=ctx,{x,y,width,height}=layoutBox,[legendWidth,legendHeight]=this.calculateLegendDimensions(layoutBox),{oldPages}=this.calcLayout(legendWidth,legendHeight),legendBBox=this.computePagedBBox(),calculateTranslationPerpendicularDimension=__name(()=>{switch(this.position){case"top":case"left":return 0;case"bottom":return height-legendBBox.height;case"right":default:return width-legendBBox.width}},"calculateTranslationPerpendicularDimension");if(this.visible){const legendPadding=this.spacing;let translationX,translationY;switch(this.position){case"top":case"bottom":translationX=(width-legendBBox.width)/2,translationY=calculateTranslationPerpendicularDimension(),layoutBox.shrink(legendBBox.height+legendPadding,this.position);break;case"left":case"right":default:translationX=calculateTranslationPerpendicularDimension(),translationY=(height-legendBBox.height)/2,layoutBox.shrink(legendBBox.width+legendPadding,this.position)}this.group.translationX=Math.floor(x+translationX-legendBBox.x),this.group.translationY=Math.floor(y+translationY-legendBBox.y),this.proxyLegendToolbar.style.removeProperty("display"),this.proxyLegendToolbar.ariaOrientation=this.getOrientation()}else this.proxyLegendToolbar.style.display="none";this.updateItemProxyButtons(),this.updatePaginationProxyButtons(oldPages)}calculateLegendDimensions(shrinkRect){const{width,height}=shrinkRect,aspectRatio=width/height,maxCoefficient=.5,minHeightCoefficient=.2,minWidthCoefficient=.25;let legendWidth,legendHeight;switch(this.position){case"top":case"bottom":const heightCoefficient=aspectRatio<1?Math.min(maxCoefficient,minHeightCoefficient*(1/aspectRatio)):minHeightCoefficient;legendWidth=this.maxWidth?Math.min(this.maxWidth,width):width,legendHeight=this.maxHeight?Math.min(this.maxHeight,height):Math.round(height*heightCoefficient);break;case"left":case"right":default:const widthCoefficient=aspectRatio>1?Math.min(maxCoefficient,minWidthCoefficient*aspectRatio):minWidthCoefficient;legendWidth=this.maxWidth?Math.min(this.maxWidth,width):Math.round(width*widthCoefficient),legendHeight=this.maxHeight?Math.min(this.maxHeight,height):height}return[legendWidth,legendHeight]}},__name(_a189,"Legend"),_a189);Legend.className="Legend";__decorateClass([Validate(BOOLEAN)],Legend.prototype,"toggleSeries",2);__decorateClass([Validate(OBJECT)],Legend.prototype,"pagination",2);__decorateClass([Validate(OBJECT)],Legend.prototype,"item",2);__decorateClass([Validate(OBJECT)],Legend.prototype,"listeners",2);__decorateClass([ObserveChanges(target=>target.updateGroupVisibility()),Validate(BOOLEAN)],Legend.prototype,"enabled",2);__decorateClass([Validate(POSITION)],Legend.prototype,"position",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Legend.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Legend.prototype,"maxHeight",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],Legend.prototype,"reverseOrder",2);__decorateClass([Validate(UNION(["horizontal","vertical"],"an orientation"),{optional:!0})],Legend.prototype,"orientation",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],Legend.prototype,"preventHidingAll",2);__decorateClass([Validate(POSITIVE_NUMBER)],Legend.prototype,"spacing",2);var CommunityLegendModule={type:"legend",optionsKey:"legend",identifier:"category",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","gauge"],moduleFactory:__name(ctx=>new Legend(ctx),"moduleFactory"),packageType:"community"},_a190,RangeHandle=(_a190=class extends Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.gripLineGap=2,this.gripLineLength=8}setCenter(x,y){this.dirtyPath=!0,this.centerX=x,this.centerY=y}static align(minHandle,maxHandle,x,y,width,height,min,max){const handlePixelAlign=minHandle.strokeWidth/2,minHandleX=minHandle.align(x+width*min)+handlePixelAlign,maxHandleX=minHandleX+minHandle.align(x+width*min,width*(max-min))-2*handlePixelAlign,handleY=minHandle.align(y+height/2)+handlePixelAlign;minHandle.setCenter(minHandleX,handleY),maxHandle.setCenter(maxHandleX,handleY)}computeBBox(){const{centerX,centerY,width,height}=this,x=centerX-width/2,y=centerY-height/2;return new BBox(x,y,width,height)}isPointInPath(x,y){return this.getBBox().containsPoint(x,y)}updatePath(){var _a274,_b;const{centerX,centerY,path,strokeWidth,gripLineGap,gripLineLength}=this,pixelRatio=((_b=(_a274=this.layerManager)==null?void 0:_a274.canvas)==null?void 0:_b.pixelRatio)??1;path.clear();const halfWidth=Math.floor(this.width/2*pixelRatio)/pixelRatio,halfHeight=Math.floor(this.height/2*pixelRatio)/pixelRatio;path.moveTo(centerX-halfWidth,centerY-halfHeight),path.lineTo(centerX+halfWidth,centerY-halfHeight),path.lineTo(centerX+halfWidth,centerY+halfHeight),path.lineTo(centerX-halfWidth,centerY+halfHeight),path.closePath();const dx=Math.floor((gripLineGap+strokeWidth)/2*pixelRatio)/pixelRatio,dy=Math.floor(gripLineLength/2*pixelRatio)/pixelRatio;path.moveTo(centerX-dx,centerY-dy),path.lineTo(centerX-dx,centerY+dy),path.moveTo(centerX+dx,centerY-dy),path.lineTo(centerX+dx,centerY+dy)}},__name(_a190,"RangeHandle"),_a190);RangeHandle.className="RangeHandle";__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3,type:"path"})],RangeHandle.prototype,"width",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3,type:"path"})],RangeHandle.prototype,"height",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3,type:"path"})],RangeHandle.prototype,"gripLineGap",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3,type:"path"})],RangeHandle.prototype,"gripLineLength",2);var _a191,RangeMask=(_a191=class extends Path{constructor(){super(...arguments),this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1}layout(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height,this.dirtyPath=!0}update(min,max){this.min=isNaN(min)?this.min:min,this.max=isNaN(max)?this.max:max,this.dirtyPath=!0}computeBBox(){const{x,y,width,height}=this;return new BBox(x,y,width,height)}computeVisibleRangeBBox(){const{x,y,width,height,min,max}=this,minX=x+width*min,maxX=x+width*max;return new BBox(minX,y,maxX-minX,height)}updatePath(){const{path,x,y,width,height,min,max,strokeWidth}=this,pixelAlign=strokeWidth/2;path.clear();const ax=this.align(x)+pixelAlign,ay=this.align(y)+pixelAlign,axw=ax+this.align(x,width)-2*pixelAlign,ayh=ay+this.align(y,height)-2*pixelAlign;path.moveTo(ax,ay),path.lineTo(axw,ay),path.lineTo(axw,ayh),path.lineTo(ax,ayh),path.closePath();const minX=this.align(x+width*min)+pixelAlign,maxX=minX+this.align(x+width*min,width*(max-min))-2*pixelAlign;path.moveTo(minX,ay),path.lineTo(minX,ayh),path.lineTo(maxX,ayh),path.lineTo(maxX,ay),path.closePath()}},__name(_a191,"RangeMask"),_a191);RangeMask.className="RangeMask";var _a192,RangeSelector=(_a192=class extends Group{constructor(children){super({name:"rangeSelectorGroup",layer:!0,zIndex:15}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.isContainerNode=!0,this.background=new TranslatableGroup({name:"navigator-background"}),this.background.zIndex=1,this.appendChild(this.background),this.append(children)}layout(x,y,width,height,lOffset,rOffset){this.x=x,this.y=y,this.width=width,this.height=height,this.lOffset=lOffset,this.rOffset=rOffset,this.background.translationX=x,this.background.translationY=y}updateBackground(oldGroup,newGroup){oldGroup!=null&&this.background.removeChild(oldGroup),newGroup!=null&&this.background.appendChild(newGroup)}computeBBox(){const{x,y,width,height,lOffset,rOffset}=this;return new BBox(x-lOffset,y,width+(lOffset+rOffset),height)}},__name(_a192,"RangeSelector"),_a192),_a193,Navigator=(_a193=class extends BaseModuleInstance{constructor(ctx){super(),this.ctx=ctx,this.miniChart=void 0,this.enabled=!1,this.mask=new RangeMask,this.minHandle=new RangeHandle,this.maxHandle=new RangeHandle,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:__name(()=>this.mask.computeVisibleRangeBBox(),"getBBox"),toCanvasBBox:__name(()=>this.mask.computeVisibleRangeBBox(),"toCanvasBBox"),fromCanvasPoint:__name((x,y)=>({x,y}),"fromCanvasPoint")},this.height=30,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new RangeSelector([this.mask,this.minHandle,this.maxHandle]),this._min=0,this._max=1,this.minRange=.001;const region=ctx.regionManager.addRegion("navigator",this.rangeSelector),dragStates=25;this.destroyFns.push(ctx.scene.attachNode(this.rangeSelector),region.addListener("hover",event=>this.onHover(event),dragStates),region.addListener("drag-start",event=>this.onDragStart(event),dragStates),region.addListener("drag",event=>this.onDrag(event),dragStates),region.addListener("drag-end",()=>this.onDragEnd(),dragStates),region.addListener("leave",event=>this.onLeave(event),dragStates),this.ctx.localeManager.addListener("locale-changed",()=>this.updateZoom()),this.ctx.layoutManager.registerElement(3,e=>this.onLayoutStart(e)),this.ctx.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)),ctx.zoomManager.addListener("zoom-change",event=>this.onZoomChange(event))),this.proxyNavigatorToolbar=this.ctx.proxyInteractionService.createProxyContainer({type:"toolbar",id:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],ariaOrientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.updateGroupVisibility(),this.proxyNavigatorElements=[this.ctx.proxyInteractionService.createProxyElement({type:"slider",id:"ag-charts-navigator-min",ariaLabel:{id:"ariaLabelNavigatorMinimum"},ariaOrientation:"horizontal",parent:this.proxyNavigatorToolbar,focusable:new NodeRegionBBoxProvider(this.minHandle),onchange:__name(ev=>this.onMinSliderChange(ev),"onchange")}),this.ctx.proxyInteractionService.createProxyElement({type:"slider",id:"ag-charts-navigator-pan",ariaLabel:{id:"ariaLabelNavigatorRange"},ariaOrientation:"horizontal",parent:this.proxyNavigatorToolbar,focusable:this.maskVisibleRange,onchange:__name(ev=>this.onPanSliderChange(ev),"onchange")}),this.ctx.proxyInteractionService.createProxyElement({type:"slider",id:"ag-charts-navigator-max",ariaLabel:{id:"ariaLabelNavigatorMaximum"},ariaOrientation:"horizontal",parent:this.proxyNavigatorToolbar,focusable:new NodeRegionBBoxProvider(this.maxHandle),onchange:__name(ev=>this.onMaxSliderChange(ev),"onchange")})],initToolbarKeyNav({orientation:"vertical",toolbar:this.proxyNavigatorToolbar,buttons:this.proxyNavigatorElements}),this.destroyFns.push(()=>{this.proxyNavigatorElements.forEach(e=>e.remove()),this.proxyNavigatorToolbar.remove()})}updateBackground(oldGroup,newGroup){var _a274;(_a274=this.rangeSelector)==null||_a274.updateBackground(oldGroup,newGroup)}updateGroupVisibility(){const{enabled}=this;this.rangeSelector==null||enabled===this.rangeSelector.visible||(this.rangeSelector.visible=enabled,this.proxyNavigatorToolbar.ariaHidden=(!enabled).toString(),enabled?this.updateZoom():this.ctx.zoomManager.updateZoom("navigator"))}onLayoutStart(ctx){if(this.enabled){const{layoutBox}=ctx,navigatorTotalHeight=this.height+this.spacing;layoutBox.shrink(navigatorTotalHeight,"bottom"),this.y=layoutBox.y+layoutBox.height+this.spacing}else this.y=0}onLayoutComplete(opts){const{x,width}=opts.series.rect;if(this.enabled){const{y,height}=this;this.layoutNodes(x,y,width,height),setElementBBox(this.proxyNavigatorToolbar,{x,y,width,height}),this.proxyNavigatorToolbar.style.removeProperty("display")}else this.proxyNavigatorToolbar.style.display="none";this.x=x,this.width=width}onHover(event){if(!this.enabled)return;const{mask,minHandle,maxHandle}=this,{regionOffsetX,regionOffsetY}=event;minHandle.containsPoint(regionOffsetX,regionOffsetY)||maxHandle.containsPoint(regionOffsetX,regionOffsetY)?this.ctx.cursorManager.updateCursor("navigator","ew-resize"):mask.computeVisibleRangeBBox().containsPoint(regionOffsetX,regionOffsetY)?this.ctx.cursorManager.updateCursor("navigator","grab"):this.ctx.cursorManager.updateCursor("navigator")}onDragStart(event){if(!this.enabled)return;const{mask,minHandle,maxHandle,x,width,_min:min}=this,{regionOffsetX,regionOffsetY}=event;minHandle.zIndex<maxHandle.zIndex?maxHandle.containsPoint(regionOffsetX,regionOffsetY)?this.dragging="max":minHandle.containsPoint(regionOffsetX,regionOffsetY)&&(this.dragging="min"):minHandle.containsPoint(regionOffsetX,regionOffsetY)?this.dragging="min":maxHandle.containsPoint(regionOffsetX,regionOffsetY)&&(this.dragging="max"),this.dragging==null&&mask.computeVisibleRangeBBox().containsPoint(regionOffsetX,regionOffsetY)&&(this.dragging="pan",this.panStart=(regionOffsetX-x)/width-min),this.dragging!=null&&this.ctx.zoomManager.fireZoomPanStartEvent("navigator")}onDrag(event){if(!this.enabled||this.dragging==null)return;const{dragging,minRange,panStart,x,width}=this;let{_min:min,_max:max}=this;const{regionOffsetX}=event,ratio2=(regionOffsetX-x)/width;if(dragging==="min")min=clamp(0,ratio2,max-minRange);else if(dragging==="max")max=clamp(min+minRange,ratio2,1);else if(dragging==="pan"&&panStart!=null){const span=max-min;min=clamp(0,ratio2-panStart,1-span),max=min+span}this._min=min,this._max=max,this.updateZoom()}onDragEnd(){this.dragging=void 0}onLeave(_event){this.ctx.cursorManager.updateCursor("navigator")}onZoomChange(event){const{x}=event;x&&(this._min=x.min,this._max=x.max,this.updateNodes(x.min,x.max),this.setPanSliderValue(x.min,x.max),this.setSliderRatio(this.proxyNavigatorElements[0],x.min),this.setSliderRatio(this.proxyNavigatorElements[2],x.max))}onPanSliderChange(_event){const ratio2=this.getSliderRatio(this.proxyNavigatorElements[1]),span=this._max-this._min;this._min=clamp(0,ratio2,1-span),this._max=this._min+span,this.updateZoom()}onMinSliderChange(_event){const slider=this.proxyNavigatorElements[0];this._min=this.setSliderRatioClamped(slider,0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(_event){const slider=this.proxyNavigatorElements[2];this._max=this.setSliderRatioClamped(slider,this._min+this.minRange,1),this.updateZoom()}setPanSliderValue(min,max){this.proxyNavigatorElements[1].value=`${Math.round(min*100)}`,this.proxyNavigatorElements[1].ariaValueText=this.ctx.localeManager.t("ariaValuePanRange",{min,max})}setSliderRatioClamped(slider,clampMin,clampMax){const ratio2=this.getSliderRatio(slider),clampedRatio=clamp(clampMin,ratio2,clampMax);return clampedRatio!==ratio2&&this.setSliderRatio(slider,clampedRatio),clampedRatio}setSliderRatio(slider,ratio2){const value=Math.round(ratio2*100);slider.value=`${value}`,slider.ariaValueText=formatPercentage(value)}getSliderRatio(slider){return parseFloat(slider.value)/100}layoutNodes(x,y,width,height){const{rangeSelector,mask,minHandle,maxHandle,_min:min,_max:max}=this;rangeSelector.layout(x,y,width,height,minHandle.width/2,maxHandle.width/2),mask.layout(x,y,width,height),RangeHandle.align(minHandle,maxHandle,x,y,width,height,min,max),min+(max-min)/2<.5?(minHandle.zIndex=3,maxHandle.zIndex=4):(minHandle.zIndex=4,maxHandle.zIndex=3),[minHandle,this.maskVisibleRange,maxHandle].forEach((node,index)=>{const bbox=node.getBBox(),tbox={x:bbox.x-x,y:bbox.y-y,height:bbox.height,width:bbox.width};setElementBBox(this.proxyNavigatorElements[index],tbox)})}updateNodes(min,max){this.mask.update(min,max)}updateZoom(){if(!this.enabled)return;const{_min:min,_max:max}=this;if(min==null||max==null)return;const warnOnConflict=__name(stateId=>{this.min==null&&this.max==null||Logger.warnOnce(`Could not apply [navigator.min] or [navigator.max] as [${stateId}] has modified the initial zoom state.`)},"warnOnConflict");return this.ctx.zoomManager.updateZoom("navigator",{x:{min,max}},!1,warnOnConflict)}},__name(_a193,"Navigator"),_a193);__decorateClass([Validate(OBJECT,{optional:!0})],Navigator.prototype,"miniChart",2);__decorateClass([Validate(BOOLEAN),ObserveChanges(target=>target.updateGroupVisibility())],Navigator.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],Navigator.prototype,"height",2);__decorateClass([Validate(POSITIVE_NUMBER)],Navigator.prototype,"spacing",2);__decorateClass([ActionOnSet({newValue(min){this._min=min,this.updateZoom()}}),Validate(AND(RATIO,LESS_THAN("max")),{optional:!0})],Navigator.prototype,"min",2);__decorateClass([ActionOnSet({newValue(max){this._max=max,this.updateZoom()}}),Validate(AND(RATIO,GREATER_THAN("min")),{optional:!0})],Navigator.prototype,"max",2);var NavigatorModule={type:"root",optionsKey:"navigator",packageType:"community",chartTypes:["cartesian"],moduleFactory:__name(ctx=>new Navigator(ctx),"moduleFactory"),themeTemplate:{navigator:{enabled:!1,height:30,mask:{fill:"#999999",stroke:"#999999",strokeWidth:1,fillOpacity:.2},minHandle:{fill:"#f2f2f2",stroke:"#999999",strokeWidth:1,width:9,height:16,gripLineGap:1,gripLineLength:8},maxHandle:{fill:"#f2f2f2",stroke:"#999999",strokeWidth:1,width:9,height:16,gripLineGap:1,gripLineLength:8}}}};function singleSeriesPaletteFactory({takeColors}){const{fills:[fill],strokes:[stroke]}=takeColors(1);return{fill,stroke}}__name(singleSeriesPaletteFactory,"singleSeriesPaletteFactory");function markerPaletteFactory(params){return{marker:singleSeriesPaletteFactory(params)}}__name(markerPaletteFactory,"markerPaletteFactory");var FONT_SIZE=(FONT_SIZE2=>(FONT_SIZE2[FONT_SIZE2.SMALL=12]="SMALL",FONT_SIZE2[FONT_SIZE2.MEDIUM=13]="MEDIUM",FONT_SIZE2[FONT_SIZE2.LARGE=17]="LARGE",FONT_SIZE2))(FONT_SIZE||{}),FONT_WEIGHT2=(FONT_WEIGHT3=>(FONT_WEIGHT3.NORMAL="normal",FONT_WEIGHT3.BOLD="bold",FONT_WEIGHT3.BOLDER="bolder",FONT_WEIGHT3.LIGHTER="lighter",FONT_WEIGHT3))(FONT_WEIGHT2||{}),POSITION2=(POSITION3=>(POSITION3.TOP="top",POSITION3.RIGHT="right",POSITION3.BOTTOM="bottom",POSITION3.LEFT="left",POSITION3))(POSITION2||{}),CARTESIAN_AXIS_TYPE=(CARTESIAN_AXIS_TYPE2=>(CARTESIAN_AXIS_TYPE2.CATEGORY="category",CARTESIAN_AXIS_TYPE2.ORDINAL_TIME="ordinal-time",CARTESIAN_AXIS_TYPE2.NUMBER="number",CARTESIAN_AXIS_TYPE2.TIME="time",CARTESIAN_AXIS_TYPE2.LOG="log",CARTESIAN_AXIS_TYPE2))(CARTESIAN_AXIS_TYPE||{}),POLAR_AXIS_TYPE=(POLAR_AXIS_TYPE2=>(POLAR_AXIS_TYPE2.ANGLE_CATEGORY="angle-category",POLAR_AXIS_TYPE2.ANGLE_NUMBER="angle-number",POLAR_AXIS_TYPE2.RADIUS_CATEGORY="radius-category",POLAR_AXIS_TYPE2.RADIUS_NUMBER="radius-number",POLAR_AXIS_TYPE2))(POLAR_AXIS_TYPE||{}),POLAR_AXIS_SHAPE=(POLAR_AXIS_SHAPE2=>(POLAR_AXIS_SHAPE2.CIRCLE="circle",POLAR_AXIS_SHAPE2.POLYGON="polygon",POLAR_AXIS_SHAPE2))(POLAR_AXIS_SHAPE||{}),IS_DARK_THEME=Symbol("is-dark-theme"),DEFAULT_FONT_FAMILY=Symbol("default-font"),DEFAULT_LABEL_COLOUR=Symbol("default-label-colour"),DEFAULT_INVERTED_LABEL_COLOUR=Symbol("default-inverted-label-colour"),DEFAULT_INSIDE_SERIES_LABEL_COLOUR=Symbol("default-inside-series-label-colour"),DEFAULT_MUTED_LABEL_COLOUR=Symbol("default-muted-label-colour"),DEFAULT_AXIS_GRID_COLOUR=Symbol("default-axis-grid-colour"),DEFAULT_AXIS_LINE_COLOUR=Symbol("default-axis-line-colour"),DEFAULT_CROSS_LINES_COLOUR=Symbol("default-cross-lines-colour"),DEFAULT_BACKGROUND_COLOUR=Symbol("default-background-colour"),DEFAULT_SHADOW_COLOUR=Symbol("default-shadow-colour"),DEFAULT_COLOURS=Symbol("default-colours"),DEFAULT_PADDING=Symbol("default-padding"),DEFAULT_CAPTION_LAYOUT_STYLE=Symbol("default-caption-layout-style"),DEFAULT_CAPTION_ALIGNMENT=Symbol("default-caption-alignment"),PALETTE_UP_STROKE=Symbol("palette-up-stroke"),PALETTE_DOWN_STROKE=Symbol("palette-down-stroke"),PALETTE_UP_FILL=Symbol("palette-up-fill"),PALETTE_DOWN_FILL=Symbol("palette-down-fill"),PALETTE_NEUTRAL_STROKE=Symbol("palette-neutral-stroke"),PALETTE_NEUTRAL_FILL=Symbol("palette-neutral-fill"),PALETTE_ALT_UP_STROKE=Symbol("palette-alt-up-stroke"),PALETTE_ALT_DOWN_STROKE=Symbol("palette-alt-down-stroke"),PALETTE_ALT_UP_FILL=Symbol("palette-alt-up-fill"),PALETTE_ALT_DOWN_FILL=Symbol("palette-alt-down-fill"),PALETTE_ALT_NEUTRAL_FILL=Symbol("palette-gray-fill"),PALETTE_ALT_NEUTRAL_STROKE=Symbol("palette-gray-stroke"),DEFAULT_POLAR_SERIES_STROKE=Symbol("default-polar-series-stroke"),DEFAULT_DIVERGING_SERIES_COLOUR_RANGE=Symbol("default-diverging-series-colour-range"),DEFAULT_GAUGE_SERIES_COLOUR_RANGE=Symbol("default-gauge-series-colour-range"),DEFAULT_HIERARCHY_FILLS=Symbol("default-hierarchy-fills"),DEFAULT_HIERARCHY_STROKES=Symbol("default-hierarchy-strokes"),DEFAULT_ANNOTATION_COLOR=Symbol("default-annotation-stroke"),DEFAULT_TEXT_ANNOTATION_COLOR=Symbol("default-text-annotation-color"),DEFAULT_ANNOTATION_BACKGROUND_FILL=Symbol("default-annotation-background-fill"),DEFAULT_ANNOTATION_HANDLE_FILL=Symbol("default-annotation-handle-fill"),DEFAULT_TEXTBOX_FILL=Symbol("default-textbox-fill"),DEFAULT_TEXTBOX_STROKE=Symbol("default-textbox-stroke"),DEFAULT_TEXTBOX_COLOR=Symbol("default-textbox-color"),DEFAULT_TOOLBAR_POSITION=Symbol("default-toolbar-position"),DEFAULT_GRIDLINE_ENABLED=Symbol("default-gridline-enabled");function pathMotion(groupId,subId,animationManager,paths,fns){const{addPhaseFn,updatePhaseFn,removePhaseFn}=fns,animate=__name((phase,path,updateFn)=>{animationManager.animate({id:`${groupId}_${subId}_${path.id}_${phase}`,groupId,from:0,to:1,ease:easeOut,collapsable:!1,onUpdate(ratio2,preInit){preInit&&phase!=="removed"||(path.path.clear(!0),updateFn(ratio2,path),path.checkPathDirty())},onStop(){phase==="added"&&(path.path.clear(!0),updateFn(1,path),path.checkPathDirty())},phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]})},"animate");for(const path of paths)animationManager.isSkipped()||(animate("removed",path,removePhaseFn),animate("updated",path,updatePhaseFn)),animate("added",path,addPhaseFn)}__name(pathMotion,"pathMotion");var element=null;function sanitizeHtml(text){if(text!=null)return text===""?"":(element??(element=createElement("div")),element.textContent=String(text),element.innerHTML)}__name(sanitizeHtml,"sanitizeHtml");var memorizedFns=new WeakMap;function memo(params,fnGenerator){var _a274,_b,_c;const serialisedParams=JSON.stringify(params,null,0);return memorizedFns.has(fnGenerator)||memorizedFns.set(fnGenerator,new Map),(_a274=memorizedFns.get(fnGenerator))!=null&&_a274.has(serialisedParams)||(_b=memorizedFns.get(fnGenerator))==null||_b.set(serialisedParams,fnGenerator(params)),(_c=memorizedFns.get(fnGenerator))==null?void 0:_c.get(serialisedParams)}__name(memo,"memo");function sumValues(values,accumulator=[0,0]){for(const value of values)typeof value=="number"&&(value<0&&(accumulator[0]+=value),value>0&&(accumulator[1]+=value));return accumulator}__name(sumValues,"sumValues");function sum(id,matchGroupId){return{id,matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:__name(values=>sumValues(values),"aggregateFunction")}}__name(sum,"sum");function groupSum(id,matchGroupId){return{id,type:"aggregate",matchGroupIds:matchGroupId?[matchGroupId]:void 0,aggregateFunction:__name(values=>sumValues(values),"aggregateFunction"),groupAggregateFunction:__name((next,acc=[0,0])=>(acc[0]+=(next==null?void 0:next[0])??0,acc[1]+=(next==null?void 0:next[1])??0,acc),"groupAggregateFunction")}}__name(groupSum,"groupSum");function range2(id,matchGroupId){return{id,matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:__name(values=>ContinuousDomain.extendDomain(values),"aggregateFunction")}}__name(range2,"range2");function groupCount(id){return{id,type:"aggregate",aggregateFunction:__name(()=>[0,1],"aggregateFunction"),groupAggregateFunction:__name((next,acc=[0,0])=>(acc[0]+=(next==null?void 0:next[0])??0,acc[1]+=(next==null?void 0:next[1])??0,acc),"groupAggregateFunction")}}__name(groupCount,"groupCount");function groupAverage(id,matchGroupId){return{id,matchGroupIds:matchGroupId?[matchGroupId]:void 0,type:"aggregate",aggregateFunction:__name(values=>sumValues(values),"aggregateFunction"),groupAggregateFunction:__name((next,acc=[0,0,-1])=>(acc[0]+=(next==null?void 0:next[0])??0,acc[1]+=(next==null?void 0:next[1])??0,acc[2]++,acc),"groupAggregateFunction"),finalFunction:__name((acc=[0,0,0])=>{const result=acc[0]+acc[1];return result>=0?[0,result/acc[2]]:[result/acc[2],0]},"finalFunction")}}__name(groupAverage,"groupAverage");function area(id,aggFn,matchGroupId){const result={id,matchGroupIds:matchGroupId?[matchGroupId]:void 0,type:"aggregate",aggregateFunction:__name((values,keyRange=[])=>{const keyWidth=keyRange[1]-keyRange[0];return aggFn.aggregateFunction(values).map(v=>v/keyWidth)},"aggregateFunction")};return aggFn.groupAggregateFunction&&(result.groupAggregateFunction=aggFn.groupAggregateFunction),result}__name(area,"area");function accumulatedValue(onlyPositive){return()=>{let value=0;return datum=>isFiniteNumber(datum)?(value+=onlyPositive?Math.max(0,datum):datum,value):datum}}__name(accumulatedValue,"accumulatedValue");function trailingAccumulatedValue(){return()=>{let value=0;return datum=>{if(!isFiniteNumber(datum))return datum;const trailingValue=value;return value+=datum,trailingValue}}}__name(trailingAccumulatedValue,"trailingAccumulatedValue");function basicContinuousCheckDatumValidation(value){return value!=null&&isContinuous(value)}__name(basicContinuousCheckDatumValidation,"basicContinuousCheckDatumValidation");function basicDiscreteCheckDatumValidation(value){return value!=null}__name(basicDiscreteCheckDatumValidation,"basicDiscreteCheckDatumValidation");function getValidationFn(scaleType){switch(scaleType){case"number":case"log":case"ordinal-time":case"time":case"color":return basicContinuousCheckDatumValidation;default:return basicDiscreteCheckDatumValidation}}__name(getValidationFn,"getValidationFn");function getValueType(scaleType){switch(scaleType){case"number":case"log":case"time":case"color":return"range";default:return"category"}}__name(getValueType,"getValueType");function keyProperty(propName,scaleType,opts={}){return{property:propName,type:"key",valueType:getValueType(scaleType),validation:getValidationFn(scaleType),...opts}}__name(keyProperty,"keyProperty");function valueProperty(propName,scaleType,opts={}){return{property:propName,type:"value",valueType:getValueType(scaleType),validation:getValidationFn(scaleType),...opts}}__name(valueProperty,"valueProperty");function rangedValueProperty(propName,opts={}){const{min=-1/0,max=1/0,...defOpts}=opts;return{type:"value",property:propName,valueType:"range",validation:basicContinuousCheckDatumValidation,processor:__name(()=>datum=>isFiniteNumber(datum)?clamp(min,datum,max):datum,"processor"),...defOpts}}__name(rangedValueProperty,"rangedValueProperty");function accumulativeValueProperty(propName,scaleType,opts={}){const{onlyPositive,...defOpts}=opts;return{...valueProperty(propName,scaleType,defOpts),processor:accumulatedValue(onlyPositive)}}__name(accumulativeValueProperty,"accumulativeValueProperty");function trailingAccumulatedValueProperty(propName,scaleType,opts={}){return{...valueProperty(propName,scaleType,opts),processor:trailingAccumulatedValue()}}__name(trailingAccumulatedValueProperty,"trailingAccumulatedValueProperty");function groupAccumulativeValueProperty(propName,mode,sum2="current",opts,scaleType){return[valueProperty(propName,scaleType,opts),accumulateGroup(opts.groupId,mode,sum2,opts.separateNegative),...opts.rangeId!=null?[range2(opts.rangeId,opts.groupId)]:[]]}__name(groupAccumulativeValueProperty,"groupAccumulativeValueProperty");function groupStackValueProperty(propName,scaleType,opts){return[valueProperty(propName,scaleType,opts),accumulateStack(opts.groupId)]}__name(groupStackValueProperty,"groupStackValueProperty");var SMALLEST_KEY_INTERVAL={type:"reducer",property:"smallestKeyInterval",initialValue:1/0,reducer:__name(()=>{let prevX=NaN;return(smallestSoFar=1/0,next)=>{const nextX=next.keys[0],interval=Math.abs(nextX-prevX);return prevX=nextX,!isNaN(interval)&&interval>0&&interval<smallestSoFar?interval:smallestSoFar}},"reducer")},LARGEST_KEY_INTERVAL={type:"reducer",property:"largestKeyInterval",initialValue:-1/0,reducer:__name(()=>{let prevX=NaN;return(largestSoFar=-1/0,next)=>{const nextX=next.keys[0],interval=Math.abs(nextX-prevX);return prevX=nextX,!isNaN(interval)&&interval>0&&interval>largestSoFar?interval:largestSoFar}},"reducer")},SORT_DOMAIN_GROUPS={type:"processor",property:"sortedGroupDomain",calculate:__name(({domain:{groups}})=>groups==null?void 0:groups.slice().sort((a,b)=>{for(let i=0;i<a.length;i++){const result=a[i]-b[i];if(result!==0)return result}return 0}),"calculate")};function normaliseFnBuilder({normaliseTo,mode}){const normalise=__name((val,extent2)=>{const result=val*normaliseTo/extent2;return result>=0?Math.min(normaliseTo,result):Math.max(-normaliseTo,result)},"normalise");return()=>()=>(values,valueIndexes)=>{const valuesExtent=[0,0];for(const valueIdx of valueIndexes){const value=values[valueIdx],valueExtent=typeof value=="number"?value:Math.max(...value),valIdx=valueExtent<0?0:1;mode==="sum"?valuesExtent[valIdx]+=valueExtent:valIdx===0?valuesExtent[valIdx]=Math.min(valuesExtent[valIdx],valueExtent):valuesExtent[valIdx]=Math.max(valuesExtent[valIdx],valueExtent)}const extent2=Math.max(Math.abs(valuesExtent[0]),valuesExtent[1]);for(const valueIdx of valueIndexes){const value=values[valueIdx];values[valueIdx]=typeof value=="number"?normalise(value,extent2):value.map(v=>normalise(v,extent2))}}}__name(normaliseFnBuilder,"normaliseFnBuilder");function normaliseGroupTo(matchGroupIds,normaliseTo,mode="sum"){return{type:"group-value-processor",matchGroupIds,adjust:memo({normaliseTo,mode},normaliseFnBuilder)}}__name(normaliseGroupTo,"normaliseGroupTo");function normalisePropertyFnBuilder({normaliseTo,zeroDomain,rangeMin,rangeMax}){const normaliseSpan=normaliseTo[1]-normaliseTo[0],normalise=__name((val,start,span)=>{const result=normaliseTo[0]+(val-start)/span*normaliseSpan;return span===0?zeroDomain:result>=normaliseTo[1]?normaliseTo[1]:result<normaliseTo[0]?normaliseTo[0]:result},"normalise");return()=>(pData,pIdx)=>{let[start,end]=pData.domain.values[pIdx];rangeMin!=null&&(start=rangeMin),rangeMax!=null&&(end=rangeMax);const span=end-start;pData.domain.values[pIdx]=[normaliseTo[0],normaliseTo[1]];for(const group of pData.data){let groupValues=group.values;pData.type==="ungrouped"&&(groupValues=[groupValues]);for(const values of groupValues)values[pIdx]=normalise(values[pIdx],start,span)}}}__name(normalisePropertyFnBuilder,"normalisePropertyFnBuilder");function normalisePropertyTo(property,normaliseTo,zeroDomain,rangeMin,rangeMax){return{type:"property-value-processor",property,adjust:memo({normaliseTo,rangeMin,rangeMax,zeroDomain},normalisePropertyFnBuilder)}}__name(normalisePropertyTo,"normalisePropertyTo");function animationValidation(valueKeyIds){return{type:"processor",property:"animationValidation",calculate(result){const{keys,values}=result.defs,{input,data}=result;let uniqueKeys=!0,orderedKeys=!0;const valueKeys=[];for(let k=0;k<values.length;k++)valueKeyIds!=null&&valueKeyIds.includes(values[k].id)&&valueKeys.push([k,values[k]]);const processKey=__name((idx,def,type)=>{var _a274;if(def.valueType==="category"){const keyValues=result.domain[type][idx];uniqueKeys&&(uniqueKeys=keyValues.length===input.count);return}let lastValue=(_a274=data[0])==null?void 0:_a274[type][idx];for(let d=1;(uniqueKeys||orderedKeys)&&d<data.length;d++){const keyValue=data[d][type][idx];orderedKeys&&(orderedKeys=lastValue<=keyValue),uniqueKeys&&(uniqueKeys=lastValue!==keyValue),lastValue=keyValue}},"processKey");for(let k=0;(uniqueKeys||orderedKeys)&&k<keys.length;k++)processKey(k,keys[k],"keys");for(let k=0;(uniqueKeys||orderedKeys)&&k<valueKeys.length;k++){const[idx,key]=valueKeys[k];processKey(idx,key,"values")}return{uniqueKeys,orderedKeys}}}}__name(animationValidation,"animationValidation");function buildGroupAccFn({mode,separateNegative}){return()=>()=>(values,valueIndexes)=>{const acc=[0,0];for(const valueIdx of valueIndexes){const currentVal=values[valueIdx],accIndex=isNegative(currentVal)&&separateNegative?0:1;isFiniteNumber(currentVal)&&(mode==="normal"&&(acc[accIndex]+=currentVal),values[valueIdx]=acc[accIndex],mode==="trailing"&&(acc[accIndex]+=currentVal))}}}__name(buildGroupAccFn,"buildGroupAccFn");function buildGroupWindowAccFn({mode,sum:sum2}){return()=>{const lastValues=[];let firstRow=!0;return()=>(values,valueIndexes)=>{let acc=0;for(const valueIdx of valueIndexes){const currentVal=values[valueIdx],lastValue=firstRow&&sum2==="current"?0:lastValues[valueIdx];lastValues[valueIdx]=currentVal;const sumValue=sum2==="current"?currentVal:lastValue;if(!isFiniteNumber(currentVal)||!isFiniteNumber(lastValue)){values[valueIdx]=acc;continue}mode==="normal"&&(acc+=sumValue),values[valueIdx]=acc,mode==="trailing"&&(acc+=sumValue)}firstRow=!1}}}__name(buildGroupWindowAccFn,"buildGroupWindowAccFn");function accumulateGroup(matchGroupId,mode,sum2,separateNegative=!1){let adjust;if(mode.startsWith("window")){const modeParam=mode.endsWith("-trailing")?"trailing":"normal";adjust=memo({mode:modeParam,sum:sum2},buildGroupWindowAccFn)}else adjust=memo({mode,separateNegative},buildGroupAccFn);return{type:"group-value-processor",matchGroupIds:[matchGroupId],adjust}}__name(accumulateGroup,"accumulateGroup");function groupStackAccFn(){return()=>(values,valueIndexes)=>{const acc=new Float64Array(32);let stackCount=0;for(const valueIdx of valueIndexes){const currentValue=values[valueIdx];acc[stackCount]=Number.isFinite(currentValue)?currentValue:NaN,stackCount+=1,values[valueIdx]=acc.subarray(0,stackCount)}}}__name(groupStackAccFn,"groupStackAccFn");function accumulateStack(matchGroupId){return{type:"group-value-processor",matchGroupIds:[matchGroupId],adjust:groupStackAccFn}}__name(accumulateStack,"accumulateStack");function diff(previousData,updateMovedData=!0){return{type:"processor",property:"diff",calculate:__name(processedData=>{const moved=new Map,added=new Map,updated=new Map,removed=new Map,length2=Math.max(previousData.data.length,processedData.data.length);for(let i=0;i<length2;i++){const prev=previousData.data[i],datum=processedData.data[i],prevId=prev?createDatumId(prev.keys):"",datumId=datum?createDatumId(datum.keys):"";if(datum&&prev&&prevId===datumId){arraysEqual(prev.values,datum.values)||updated.set(datumId,datum);continue}removed.has(datumId)?((updateMovedData||!arraysEqual(removed.get(datumId).values,datum.values))&&(updated.set(datumId,datum),moved.set(datumId,datum)),removed.delete(datumId)):datum&&added.set(datumId,datum),added.has(prevId)?((updateMovedData||!arraysEqual(added.get(prevId).values,prev.values))&&(updated.set(prevId,prev),moved.set(prevId,prev)),added.delete(prevId)):prev&&(updated.delete(prevId),removed.set(prevId,prev))}return{changed:added.size>0||updated.size>0||removed.size>0,added,updated,removed,moved}},"calculate")}}__name(diff,"diff");function createDatumId(keys,...extraKeys){let result;return isArray(keys)?result=keys.map(key=>transformIntegratedCategoryValue(key)).join("___"):result=transformIntegratedCategoryValue(keys),(typeof result=="string"||typeof result=="number"||typeof result=="boolean"||result instanceof Date)&&extraKeys.length>0&&(result+=`___${extraKeys.join("___")}`),result}__name(createDatumId,"createDatumId");function seriesLabelFadeInAnimation({id},subId,animationManager,...labelSelections){staticFromToMotion(id,subId,animationManager,labelSelections,{opacity:0},{opacity:1},{phase:"trailing"})}__name(seriesLabelFadeInAnimation,"seriesLabelFadeInAnimation");function seriesLabelFadeOutAnimation({id},subId,animationManager,...labelSelections){staticFromToMotion(id,subId,animationManager,labelSelections,{opacity:1},{opacity:0},{phase:"remove"})}__name(seriesLabelFadeOutAnimation,"seriesLabelFadeOutAnimation");function resetLabelFn(_node){return{opacity:1}}__name(resetLabelFn,"resetLabelFn");var _a194,ChangeDetectableProperties=(_a194=class extends BaseProperties{constructor(){super(...arguments),this._dirty=3}markDirty(_source,type=1){this._dirty<type&&(this._dirty=type)}markClean(_opts){this._dirty=0}isDirty(){return this._dirty>0}},__name(_a194,"ChangeDetectableProperties"),_a194),_a195,DropShadow=(_a195=class extends ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.color="rgba(0, 0, 0, 0.5)",this.xOffset=0,this.yOffset=0,this.blur=5}},__name(_a195,"DropShadow"),_a195);__decorateClass([Validate(BOOLEAN),SceneChangeDetection({redraw:3})],DropShadow.prototype,"enabled",2);__decorateClass([Validate(COLOR_STRING),SceneChangeDetection({redraw:3})],DropShadow.prototype,"color",2);__decorateClass([Validate(NUMBER),SceneChangeDetection({redraw:3})],DropShadow.prototype,"xOffset",2);__decorateClass([Validate(NUMBER),SceneChangeDetection({redraw:3})],DropShadow.prototype,"yOffset",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],DropShadow.prototype,"blur",2);var MARKER_SHAPE=predicateWithMessage(value=>isMarkerShape(value)||typeof value=="function"&&Object.create(value.prototype)instanceof Marker,"a marker shape keyword such as 'circle', 'diamond' or 'square' or an object extending the Marker class"),_a196,SeriesMarker=(_a196=class extends ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.shape=Circle,this.size=6,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1}getStyle(){const{size,shape,fill,fillOpacity,stroke,strokeWidth,strokeOpacity}=this;return{size,shape,fill,fillOpacity,stroke,strokeWidth,strokeOpacity}}getDiameter(){return this.size+this.strokeWidth}},__name(_a196,"SeriesMarker"),_a196);__decorateClass([Validate(BOOLEAN),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"enabled",2);__decorateClass([Validate(MARKER_SHAPE),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"shape",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"size",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"fill",2);__decorateClass([Validate(RATIO),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"strokeOpacity",2);__decorateClass([Validate(FUNCTION,{optional:!0}),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"itemStyler",2);var _a197,SeriesTooltipInteraction=(_a197=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!1}},__name(_a197,"SeriesTooltipInteraction"),_a197);__decorateClass([Validate(BOOLEAN)],SeriesTooltipInteraction.prototype,"enabled",2);var _a198,SeriesTooltip=(_a198=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.interaction=new SeriesTooltipInteraction,this.position=new TooltipPosition,this.range=void 0}toTooltipHtml(defaults,params){return this.renderer?toTooltipHtml(this.renderer(params),defaults):toTooltipHtml(defaults)}},__name(_a198,"SeriesTooltip"),_a198);__decorateClass([Validate(BOOLEAN)],SeriesTooltip.prototype,"enabled",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],SeriesTooltip.prototype,"showArrow",2);__decorateClass([Validate(FUNCTION,{optional:!0})],SeriesTooltip.prototype,"renderer",2);__decorateClass([Validate(OBJECT)],SeriesTooltip.prototype,"interaction",2);__decorateClass([Validate(OBJECT)],SeriesTooltip.prototype,"position",2);__decorateClass([Validate(INTERACTION_RANGE,{optional:!0})],SeriesTooltip.prototype,"range",2);var INTERPOLATION_TYPE=UNION(["linear","smooth","step"],"a line style"),INTERPOLATION_STEP_POSITION=UNION(["start","middle","end"]),_a199,InterpolationProperties=(_a199=class extends BaseProperties{constructor(){super(...arguments),this.type="linear",this.tension=1,this.position="end"}},__name(_a199,"InterpolationProperties"),_a199);__decorateClass([Validate(INTERPOLATION_TYPE)],InterpolationProperties.prototype,"type",2);__decorateClass([Validate(RATIO)],InterpolationProperties.prototype,"tension",2);__decorateClass([Validate(INTERPOLATION_STEP_POSITION)],InterpolationProperties.prototype,"position",2);var _a200,AreaSeriesProperties=(_a200=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.xName=void 0,this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new InterpolationProperties,this.shadow=new DropShadow,this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip,this.connectMissingData=!1}},__name(_a200,"AreaSeriesProperties"),_a200);__decorateClass([Validate(STRING)],AreaSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING,{optional:!0})],AreaSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING)],AreaSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],AreaSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],AreaSeriesProperties.prototype,"yFilterKey",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],AreaSeriesProperties.prototype,"normalizedTo",2);__decorateClass([Validate(COLOR_STRING)],AreaSeriesProperties.prototype,"fill",2);__decorateClass([Validate(RATIO)],AreaSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING)],AreaSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],AreaSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],AreaSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],AreaSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],AreaSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"interpolation",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"marker",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"tooltip",2);__decorateClass([Validate(BOOLEAN)],AreaSeriesProperties.prototype,"connectMissingData",2);function spanRange(span){switch(span.type){case"linear":case"step":return[{x:span.x0,y:span.y0},{x:span.x1,y:span.y1}];case"cubic":return[{x:span.cp0x,y:span.cp0y},{x:span.cp3x,y:span.cp3y}]}}__name(spanRange,"spanRange");function spanRangeNormalized(span){const range3=spanRange(span);return range3[0].x>range3[1].x&&range3.reverse(),range3}__name(spanRangeNormalized,"spanRangeNormalized");function rescaleSpan(span,nextStart,nextEnd){const[prevStart,prevEnd]=spanRange(span),widthScale=prevEnd.x!==prevStart.x?(nextEnd.x-nextStart.x)/(prevEnd.x-prevStart.x):0,heightScale=prevEnd.y!==prevStart.y?(nextEnd.y-nextStart.y)/(prevEnd.y-prevStart.y):0;switch(span.type){case"linear":return{type:"linear",moveTo:span.moveTo,x0:nextStart.x,y0:nextStart.y,x1:nextEnd.x,y1:nextEnd.y};case"cubic":return{type:"cubic",moveTo:span.moveTo,cp0x:nextStart.x,cp0y:nextStart.y,cp1x:nextEnd.x-(span.cp2x-prevStart.x)*widthScale,cp1y:nextEnd.y-(span.cp2y-prevStart.y)*heightScale,cp2x:nextEnd.x-(span.cp1x-prevStart.x)*widthScale,cp2y:nextEnd.y-(span.cp1y-prevStart.y)*heightScale,cp3x:nextEnd.x,cp3y:nextEnd.y};case"step":return{type:"step",moveTo:span.moveTo,x0:nextStart.x,y0:nextStart.y,x1:nextEnd.x,y1:nextEnd.y,stepX:nextEnd.x-(span.stepX-prevStart.x)*widthScale}}}__name(rescaleSpan,"rescaleSpan");function clipSpanX(span,x0,x1){const{moveTo}=span,[start,end]=spanRangeNormalized(span),{x:spanX0,y:spanY0}=start,{x:spanX1,y:spanY1}=end;if(x1<spanX0)return rescaleSpan(span,start,start);if(x0>spanX1)return rescaleSpan(span,end,end);switch(span.type){case"linear":{const m=spanY0===spanY1?void 0:(spanY1-spanY0)/(spanX1-spanX0),y0=m==null?spanY0:m*(x0-spanX0)+spanY0,y1=m==null?spanY0:m*(x1-spanX0)+spanY0;return{type:"linear",moveTo,x0,y0,x1,y1}}case"step":if(x1<=span.stepX){const y=span.y0;return{type:"step",moveTo,x0,y0:y,x1,y1:y,stepX:x1}}else if(x0>=span.stepX){const y=span.y1;return{type:"step",moveTo,x0,y0:y,x1,y1:y,stepX:x0}}else{const{y0,y1,stepX}=span;return{type:"step",moveTo,x0,y0,x1,y1,stepX}}case"cubic":{const t0=solveBezier(span.cp0x,span.cp1x,span.cp2x,span.cp3x,x0);let[_unused,bezier]=splitBezier(span.cp0x,span.cp0y,span.cp1x,span.cp1y,span.cp2x,span.cp2y,span.cp3x,span.cp3y,t0);const t1=solveBezier(bezier[0].x,bezier[1].x,bezier[2].x,bezier[3].x,x1);return[bezier,_unused]=splitBezier(bezier[0].x,bezier[0].y,bezier[1].x,bezier[1].y,bezier[2].x,bezier[2].y,bezier[3].x,bezier[3].y,t1),{type:"cubic",moveTo,cp0x:bezier[0].x,cp0y:bezier[0].y,cp1x:bezier[1].x,cp1y:bezier[1].y,cp2x:bezier[2].x,cp2y:bezier[2].y,cp3x:bezier[3].x,cp3y:bezier[3].y}}}}__name(clipSpanX,"clipSpanX");function linearPoints(points){const spans=[];let i=0,x0=NaN,y0=NaN;for(const{x:x1,y:y1}of points){if(i>0){const moveTo=i===1;spans.push({type:"linear",moveTo,x0,y0,x1,y1})}i+=1,x0=x1,y0=y1}return spans}__name(linearPoints,"linearPoints");var lineSteps={start:0,middle:.5,end:1};function stepPoints(points,position){const spans=[];let i=0,x0=NaN,y0=NaN;const p0=typeof position=="number"?position:lineSteps[position];for(const{x:x1,y:y1}of points){if(i>0){const moveTo=i===1,stepX=x0+(x1-x0)*p0;spans.push({type:"step",moveTo,x0,y0,x1,y1,stepX})}i+=1,x0=x1,y0=y1}return spans}__name(stepPoints,"stepPoints");var flatnessRatio=.05;function smoothPoints(iPoints,tension){const points=Array.isArray(iPoints)?iPoints:Array.from(iPoints);if(points.length<=1)return[];const gradients=points.map((c,i)=>{const p=i===0?c:points[i-1],n=i===points.length-1?c:points[i+1],isTerminalPoint=i===0||i===points.length-1;if(Math.sign(p.y-c.y)===Math.sign(n.y-c.y))return 0;if(!isTerminalPoint){const range3=Math.abs(p.y-n.y),prevRatio=Math.abs(c.y-p.y)/range3,nextRatio=Math.abs(c.y-n.y)/range3;if(prevRatio<=flatnessRatio||1-prevRatio<=flatnessRatio||nextRatio<=flatnessRatio||1-nextRatio<=flatnessRatio)return 0}return(n.y-p.y)/(n.x-p.x)});gradients[1]===0&&(gradients[0]*=2),gradients[gradients.length-2]===0&&(gradients[gradients.length-1]*=2);const spans=[];for(let i=1;i<points.length;i+=1){const prev=points[i-1],prevM=gradients[i-1],cur=points[i],curM=gradients[i],dx=cur.x-prev.x,dy=cur.y-prev.y;let dcp1x=dx*tension/3,dcp1y=dx*prevM*tension/3,dcp2x=dx*tension/3,dcp2y=dx*curM*tension/3;curM===0&&Math.abs(dcp1y)>Math.abs(dy)&&(dcp1x*=Math.abs(dy/dcp1y),dcp1y=Math.sign(dcp1y)*Math.abs(dy)),prevM===0&&Math.abs(dcp2y)>Math.abs(dy)&&(dcp2x*=Math.abs(dy/dcp2y),dcp2y=Math.sign(dcp2y)*Math.abs(dy)),spans.push({type:"cubic",moveTo:i===1,cp0x:prev.x,cp0y:prev.y,cp1x:prev.x+dcp1x,cp1y:prev.y+dcp1y,cp2x:cur.x-dcp2x,cp2y:cur.y-dcp2y,cp3x:cur.x,cp3y:cur.y})}return spans}__name(smoothPoints,"smoothPoints");function lerp2(a,b,ratio2){return(b-a)*ratio2+a}__name(lerp2,"lerp2");function linearSupertype(span,stepX){const{x0,y0,x1,y1}=span,stepY=(y1-y0)/(x1-x0)*(stepX-x0)+y0;return{leftCp1x:x0,leftCp1y:y0,leftCp2x:stepX,leftCp2y:stepY,stepX,stepY0:stepY,stepY1:stepY,rightCp1x:stepX,rightCp1y:stepY,rightCp2x:x1,rightCp2y:y1}}__name(linearSupertype,"linearSupertype");function bezierSupertype(span,stepX){const{cp0x,cp0y,cp1x,cp1y,cp2x,cp2y,cp3x,cp3y}=span,t=solveBezier(cp0x,cp1x,cp2x,cp3x,stepX),[left,right]=splitBezier(cp0x,cp0y,cp1x,cp1y,cp2x,cp2y,cp3x,cp3y,t),stepY=left[3].y;return{leftCp1x:left[1].x,leftCp1y:left[1].y,leftCp2x:left[2].x,leftCp2y:left[2].y,stepX,stepY0:stepY,stepY1:stepY,rightCp1x:right[1].x,rightCp1y:right[1].y,rightCp2x:right[2].x,rightCp2y:right[2].y}}__name(bezierSupertype,"bezierSupertype");function stepSupertype(span){const{x0,y0,x1,y1,stepX}=span;return{leftCp1x:(x0+stepX)/2,leftCp1y:y0,leftCp2x:(x0+stepX)/2,leftCp2y:y0,stepX,stepY0:y0,stepY1:y1,rightCp1x:(stepX+x1)/2,rightCp1y:y1,rightCp2x:(stepX+x1)/2,rightCp2y:y1}}__name(stepSupertype,"stepSupertype");function spanSupertype(span,stepX){return span.type==="linear"?linearSupertype(span,stepX):span.type==="cubic"?bezierSupertype(span,stepX):stepSupertype(span)}__name(spanSupertype,"spanSupertype");function plotStart(path,moveTo,x0,y0,x1,y1,reversed){switch(moveTo){case 1:reversed?path.moveTo(x1,y1):path.moveTo(x0,y0);break;case 2:reversed?path.lineTo(x1,y1):path.lineTo(x0,y0);break}}__name(plotStart,"plotStart");function plotLinear(path,x0,y0,x1,y1,reversed){reversed?path.lineTo(x0,y0):path.lineTo(x1,y1)}__name(plotLinear,"plotLinear");function plotCubic(path,cp0x,cp0y,cp1x,cp1y,cp2x,cp2y,cp3x,cp3y,reversed){reversed?path.cubicCurveTo(cp2x,cp2y,cp1x,cp1y,cp0x,cp0y):path.cubicCurveTo(cp1x,cp1y,cp2x,cp2y,cp3x,cp3y)}__name(plotCubic,"plotCubic");function plotStep(path,x0,y0,x1,y1,stepX,reversed){reversed?(path.lineTo(stepX,y1),path.lineTo(stepX,y0),path.lineTo(x0,y0)):(path.lineTo(stepX,y0),path.lineTo(stepX,y1),path.lineTo(x1,y1))}__name(plotStep,"plotStep");function plotSpan(path,span,moveTo,reversed){const[start,end]=spanRange(span);switch(plotStart(path,moveTo,start.x,start.y,end.x,end.y,reversed),span.type){case"linear":plotLinear(path,span.x0,span.y0,span.x1,span.y1,reversed);break;case"cubic":plotCubic(path,span.cp0x,span.cp0y,span.cp1x,span.cp1y,span.cp2x,span.cp2y,span.cp3x,span.cp3y,reversed);break;case"step":plotStep(path,span.x0,span.y0,span.x1,span.y1,span.stepX,reversed);break}}__name(plotSpan,"plotSpan");function plotInterpolatedSpans(path,a,b,ratio2,moveTo,reversed){const[aStart,aEnd]=spanRange(a),[bStart,bEnd]=spanRange(b),x0=lerp2(aStart.x,bStart.x,ratio2),y0=lerp2(aStart.y,bStart.y,ratio2),x1=lerp2(aEnd.x,bEnd.x,ratio2),y1=lerp2(aEnd.y,bEnd.y,ratio2);if(plotStart(path,moveTo,x0,y0,x1,y1,reversed),a.type==="cubic"&&b.type==="cubic"){const cp1x=lerp2(a.cp1x,b.cp1x,ratio2),cp1y=lerp2(a.cp1y,b.cp1y,ratio2),cp2x=lerp2(a.cp2x,b.cp2x,ratio2),cp2y=lerp2(a.cp2y,b.cp2y,ratio2);plotCubic(path,x0,y0,cp1x,cp1y,cp2x,cp2y,x1,y1,reversed)}else if(a.type==="step"&&b.type==="step"){const stepX=lerp2(a.stepX,b.stepX,ratio2);plotStep(path,x0,y0,x1,y1,stepX,reversed)}else if(a.type==="linear"&&b.type==="linear")plotLinear(path,x0,y0,x1,y1,reversed);else{let defaultStepX;a.type==="step"?defaultStepX=a.stepX:b.type==="step"?defaultStepX=b.stepX:defaultStepX=(x0+x1)/2;const as=spanSupertype(a,defaultStepX),bs=spanSupertype(b,defaultStepX),leftCp1x=lerp2(as.leftCp1x,bs.leftCp1x,ratio2),leftCp1y=lerp2(as.leftCp1y,bs.leftCp1y,ratio2),leftCp2x=lerp2(as.leftCp2x,bs.leftCp2x,ratio2),leftCp2y=lerp2(as.leftCp2y,bs.leftCp2y,ratio2),stepX=lerp2(as.stepX,bs.stepX,ratio2),stepY0=lerp2(as.stepY0,bs.stepY0,ratio2),stepY1=lerp2(as.stepY1,bs.stepY1,ratio2),rightCp1x=lerp2(as.rightCp1x,bs.rightCp1x,ratio2),rightCp1y=lerp2(as.rightCp1y,bs.rightCp1y,ratio2),rightCp2x=lerp2(as.rightCp2x,bs.rightCp2x,ratio2),rightCp2y=lerp2(as.rightCp2y,bs.rightCp2y,ratio2);reversed?(path.cubicCurveTo(rightCp2x,rightCp2y,rightCp1x,rightCp1y,stepX,stepY1),path.lineTo(stepX,stepY0),path.cubicCurveTo(leftCp2x,leftCp2y,leftCp1x,leftCp1y,x0,y0)):(path.cubicCurveTo(leftCp1x,leftCp1y,leftCp2x,leftCp2y,stepX,stepY0),path.lineTo(stepX,stepY1),path.cubicCurveTo(rightCp1x,rightCp1y,rightCp2x,rightCp2y,x1,y1))}}__name(plotInterpolatedSpans,"plotInterpolatedSpans");function markerFadeInAnimation({id},animationManager,status,...markerSelections){const params={phase:status?NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]:"trailing"};staticFromToMotion(id,"markers",animationManager,markerSelections,{opacity:0},{opacity:1},params),markerSelections.forEach(s=>s.cleanup())}__name(markerFadeInAnimation,"markerFadeInAnimation");function markerScaleInAnimation({id},animationManager,...markerSelections){staticFromToMotion(id,"markers",animationManager,markerSelections,{scalingX:0,scalingY:0},{scalingX:1,scalingY:1},{phase:"initial"}),markerSelections.forEach(s=>s.cleanup())}__name(markerScaleInAnimation,"markerScaleInAnimation");function markerSwipeScaleInAnimation({id,nodeDataDependencies},animationManager,...markerSelections){const seriesWidth=nodeDataDependencies.seriesRectWidth;fromToMotion(id,"markers",animationManager,markerSelections,{fromFn:__name((_,datum)=>{var _a274;const x=((_a274=datum.midPoint)==null?void 0:_a274.x)??seriesWidth;let delay=clamp(0,inverseEaseOut(x/seriesWidth),1);return isNaN(delay)&&(delay=0),{scalingX:0,scalingY:0,delay,duration:QUICK_TRANSITION,phase:"initial"}},"fromFn"),toFn:__name(()=>({scalingX:1,scalingY:1}),"toFn")})}__name(markerSwipeScaleInAnimation,"markerSwipeScaleInAnimation");function resetMarkerFn(_node){return{opacity:1,scalingX:1,scalingY:1}}__name(resetMarkerFn,"resetMarkerFn");function resetMarkerPositionFn(_node,datum){var _a274,_b;return{translationX:((_a274=datum.point)==null?void 0:_a274.x)??NaN,translationY:((_b=datum.point)==null?void 0:_b.y)??NaN}}__name(resetMarkerPositionFn,"resetMarkerPositionFn");function prepareMarkerAnimation(pairMap,parentStatus){const readFirstPair=__name((xValue,type)=>{const val=pairMap[type][xValue];return Array.isArray(val)?val[0]:val},"readFirstPair"),markerStatus=__name(datum=>{const{xValue}=datum;return pairMap.moved[xValue]?{point:readFirstPair(xValue,"moved"),status:"updated"}:pairMap.removed[xValue]?{point:readFirstPair(xValue,"removed"),status:"removed"}:pairMap.added[xValue]?{point:readFirstPair(xValue,"added"),status:"added"}:{status:"unknown"}},"markerStatus");return{fromFn:__name((marker,datum)=>{var _a274,_b,_c,_d;const{status,point}=markerStatus(datum);if(status==="unknown")return{opacity:0};const defaults={translationX:((_a274=point==null?void 0:point.from)==null?void 0:_a274.x)??marker.translationX,translationY:((_b=point==null?void 0:point.from)==null?void 0:_b.y)??marker.translationY,opacity:marker.opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]};return parentStatus==="added"?{...defaults,opacity:0,translationX:(_c=point==null?void 0:point.to)==null?void 0:_c.x,translationY:(_d=point==null?void 0:point.to)==null?void 0:_d.y,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.added}:(status==="added"&&(defaults.opacity=0),defaults)},"fromFn"),toFn:__name((_marker,datum)=>{var _a274,_b;const{status,point}=markerStatus(datum);if(status==="unknown")return{opacity:0};const defaults={translationX:datum.point.x,translationY:datum.point.y,opacity:1,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]};return status==="removed"||parentStatus==="removed"?{...defaults,translationX:(_a274=point==null?void 0:point.to)==null?void 0:_a274.x,translationY:(_b=point==null?void 0:point.to)==null?void 0:_b.y,opacity:0,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.removed}:defaults},"toFn")}}__name(prepareMarkerAnimation,"prepareMarkerAnimation");function computeMarkerFocusBounds(series,{datumIndex}){const nodeData=series.getNodeData();if(nodeData===void 0)return;const datum=nodeData[datumIndex],{point}=datum;if(datum==null||point==null)return;const size=point.focusSize??series.getFormattedMarkerStyle(datum).size,radius=size/2,x=datum.point.x-radius,y=datum.point.y-radius;return Transformable.toCanvas(series.contentGroup,new BBox(x,y,size,size))}__name(computeMarkerFocusBounds,"computeMarkerFocusBounds");function plotLinearPoints(path,points,continuePath){let didMove=continuePath;for(const{x,y}of points)didMove?path.lineTo(x,y):(path.moveTo(x,y),didMove=!0)}__name(plotLinearPoints,"plotLinearPoints");var flatnessRatio2=.05;function plotSmoothPoints(path,iPoints,tension,continuePath){const points=Array.isArray(iPoints)?iPoints:Array.from(iPoints);if(points.length===0||(continuePath?path.lineTo(points[0].x,points[0].y):path.moveTo(points[0].x,points[0].y),points.length<=1))return;const gradients=points.map((c,i)=>{const p=i===0?c:points[i-1],n=i===points.length-1?c:points[i+1],isTerminalPoint=i===0||i===points.length-1;if(Math.sign(p.y-c.y)===Math.sign(n.y-c.y))return 0;if(!isTerminalPoint){const range3=Math.abs(p.y-n.y),prevRatio=Math.abs(c.y-p.y)/range3,nextRatio=Math.abs(c.y-n.y)/range3;if(prevRatio<=flatnessRatio2||1-prevRatio<=flatnessRatio2||nextRatio<=flatnessRatio2||1-nextRatio<=flatnessRatio2)return 0}return(n.y-p.y)/(n.x-p.x)});gradients[1]===0&&(gradients[0]*=2),gradients[gradients.length-2]===0&&(gradients[gradients.length-1]*=2);for(let i=1;i<points.length;i+=1){const prev=points[i-1],prevM=gradients[i-1],cur=points[i],curM=gradients[i],dx=cur.x-prev.x,dy=cur.y-prev.y;let dcp1x=dx*tension/3,dcp1y=dx*prevM*tension/3,dcp2x=dx*tension/3,dcp2y=dx*curM*tension/3;curM===0&&Math.abs(dcp1y)>Math.abs(dy)&&(dcp1x*=Math.abs(dy/dcp1y),dcp1y=Math.sign(dcp1y)*Math.abs(dy)),prevM===0&&Math.abs(dcp2y)>Math.abs(dy)&&(dcp2x*=Math.abs(dy/dcp2y),dcp2y=Math.sign(dcp2y)*Math.abs(dy)),path.cubicCurveTo(prev.x+dcp1x,prev.y+dcp1y,cur.x-dcp2x,cur.y-dcp2y,cur.x,cur.y)}}__name(plotSmoothPoints,"plotSmoothPoints");function plotStepPoints(path,points,align,continuePath){let lastPoint;for(const point of points){if(lastPoint!=null){const directionalAlign=lastPoint.x<point.x?align:1-align,x=(point.x-lastPoint.x)*directionalAlign+lastPoint.x;path.lineTo(x,(lastPoint==null?void 0:lastPoint.y)??point.y),path.lineTo(x,point.y),path.lineTo(point.x,point.y)}else continuePath?path.lineTo(point.x,point.y):path.moveTo(point.x,point.y);lastPoint=point}}__name(plotStepPoints,"plotStepPoints");function minMax(nodeData){return nodeData.reduce(({min,max},node)=>((min==null||min.point.x>node.point.x)&&(min=node),(max==null||max.point.x<node.point.x)&&(max=node),{min,max}),{})}__name(minMax,"minMax");function intersectionOnLine(a,b,targetX){const m=(b.y-a.y)/(b.x-a.x),y=(targetX-a.x)*m+a.y;return{x:targetX,y}}__name(intersectionOnLine,"intersectionOnLine");function backfillPathPoint(results,process,skip,processFn){let prevMarkerIdx=-1,nextMarkerIdx=0;const toProcess=[];for(;nextMarkerIdx<results.length;){if(results[nextMarkerIdx].change===process){toProcess.push(results[nextMarkerIdx]),nextMarkerIdx++;continue}if(results[nextMarkerIdx].change===skip){nextMarkerIdx++;continue}toProcess.length>0&&(processFn(toProcess,prevMarkerIdx,nextMarkerIdx),toProcess.length=0),prevMarkerIdx=nextMarkerIdx,nextMarkerIdx++}toProcess.length>0&&processFn(toProcess,prevMarkerIdx,nextMarkerIdx)}__name(backfillPathPoint,"backfillPathPoint");function backfillPathPointData(result,splitMode){backfillPathPoint(result,"out","in",(toProcess,sIdx,eIdx)=>{var _a274,_b;sIdx===-1&&result[eIdx]?toProcess.forEach(d=>d.to=result[eIdx].from):eIdx===result.length&&result[sIdx]?toProcess.forEach(d=>d.to=result[sIdx].from):splitMode==="intersect"&&((_a274=result[sIdx])!=null&&_a274.from)&&((_b=result[eIdx])!=null&&_b.from)?toProcess.forEach(d=>d.to=intersectionOnLine(result[sIdx].from,result[eIdx].from,d.from.x)):toProcess.forEach(d=>d.to=d.from)}),backfillPathPoint(result,"in","out",(toProcess,sIdx,eIdx)=>{var _a274,_b;sIdx===-1&&result[eIdx]?toProcess.forEach(d=>d.from=result[eIdx].to):eIdx===result.length&&result[sIdx]?toProcess.forEach(d=>d.from=result[sIdx].to):splitMode==="intersect"&&((_a274=result[sIdx])!=null&&_a274.to)&&((_b=result[eIdx])!=null&&_b.to)?toProcess.forEach(d=>d.from=intersectionOnLine(result[sIdx].to,result[eIdx].to,d.to.x)):toProcess.forEach(d=>d.from=d.to)})}__name(backfillPathPointData,"backfillPathPointData");function calculatePoint(from2,to,ratio2){const x1=isNaN(from2.x)?to.x:from2.x,y1=isNaN(from2.y)?to.y:from2.y,xd=to.x-from2.x,yd=to.y-from2.y,xr=isNaN(xd)?0:xd*ratio2,yr=isNaN(yd)?0:yd*ratio2;return{x:x1+xr,y:y1+yr}}__name(calculatePoint,"calculatePoint");var lineSteps2={start:0,middle:.5,end:1};function plotPath(points,path,interpolation,continuePath=!1){const{path:linePath}=path;(interpolation==null?void 0:interpolation.type)==="smooth"?plotSmoothPoints(linePath,points,interpolation.tension??1,continuePath):(interpolation==null?void 0:interpolation.type)==="step"?plotStepPoints(linePath,points,lineSteps2[interpolation.position??"end"],continuePath):plotLinearPoints(linePath,points,continuePath)}__name(plotPath,"plotPath");function splitPairData(pairData,ratios){let previousTo,points;const out=[],flushCurrent=__name(()=>{points!=null&&(out.push(points),points=void 0)},"flushCurrent");for(const data of pairData){const{from:from2,to}=data,ratio2=ratios[data.change];if(ratio2==null||from2==null||to==null)continue;const point=calculatePoint(from2,to,ratio2);if(data.moveTo===!1)points??(points=[]),points.push(point);else if(data.moveTo===!0||!previousTo)flushCurrent(),points=[point];else if(previousTo){const moveToRatio=data.moveTo==="in"?ratio2:1-ratio2,{x:midPointX,y:midPointY}=calculatePoint(previousTo,point,moveToRatio);points??(points=[]),points.push({x:midPointX,y:midPointY}),flushCurrent(),points=[point]}previousTo=point}return flushCurrent(),out}__name(splitPairData,"splitPairData");function renderPartialPath(pairData,ratios,path,interpolation){splitPairData(pairData,ratios).forEach(points=>{plotPath(points,path,interpolation)})}__name(renderPartialPath,"renderPartialPath");function pathSwipeInAnimation({id,visible,nodeDataDependencies},animationManager,...paths){const{seriesRectWidth:width,seriesRectHeight:height}=nodeDataDependencies;staticFromToMotion(id,"path_properties",animationManager,paths,{clipX:0},{clipX:width},{phase:"initial",start:{clipMode:"normal",clipY:height,visible},finish:{clipMode:void 0,visible}})}__name(pathSwipeInAnimation,"pathSwipeInAnimation");function pathFadeInAnimation({id},subId,animationManager,phase="add",...selection){staticFromToMotion(id,subId,animationManager,selection,{opacity:0},{opacity:1},{phase})}__name(pathFadeInAnimation,"pathFadeInAnimation");function pathFadeOutAnimation({id},subId,animationManager,...selection){staticFromToMotion(id,subId,animationManager,selection,{opacity:1},{opacity:0},{phase:"remove"})}__name(pathFadeOutAnimation,"pathFadeOutAnimation");function buildResetPathFn(opts){return _node=>({visible:opts.getVisible(),opacity:opts.getOpacity(),clipScalingX:1,clipMode:void 0})}__name(buildResetPathFn,"buildResetPathFn");function updateClipPath({nodeDataDependencies},path){const toFinite=__name(value=>isFinite(value)?value:0,"toFinite");path.clipX=toFinite(nodeDataDependencies.seriesRectWidth),path.clipY=toFinite(nodeDataDependencies.seriesRectHeight)}__name(updateClipPath,"updateClipPath");function isContinuousScaling(scaling){return scaling.type==="continuous"||scaling.type==="log"}__name(isContinuousScaling,"isContinuousScaling");function isCategoryScaling(scaling){return scaling.type==="category"}__name(isCategoryScaling,"isCategoryScaling");function areEqual(a,b){return a.domain.length===b.domain.length&&a.range.length===b.range.length&&a.domain.every((val,index)=>val===b.domain[index])&&a.range.every((val,index)=>val===b.range[index])}__name(areEqual,"areEqual");function areScalingEqual(a,b){return a===void 0||b===void 0?a!==void 0||b!==void 0:isContinuousScaling(a)&&isContinuousScaling(b)?a.type===b.type&&areEqual(a,b):isCategoryScaling(a)&&isCategoryScaling(b)?areEqual(a,b):!1}__name(areScalingEqual,"areScalingEqual");function isScaleValid(scale2){return scale2==null||!scale2.range.every(v=>Number.isFinite(v))?!1:scale2.type==="category"?scale2.domain.every(v=>v!=null):scale2.domain.every(v=>Number.isFinite(v)||v instanceof Date)}__name(isScaleValid,"isScaleValid");function*pathRanges(points){let start=-1,end=0;for(const{point}of points){if(point.moveTo){const range3=start>=0?{start,end}:void 0;start=end,end=start,range3!==void 0&&(yield range3)}end+=1}start!==-1&&(yield{start,end})}__name(pathRanges,"pathRanges");function*pathRangePoints(points,{start,end}){for(let i=start;i<end;i+=1)yield points[i].point}__name(pathRangePoints,"pathRangePoints");function*pathRangePointsReverse(points,{start,end}){for(let i=end-1;i>=start;i-=1)yield points[i].point}__name(pathRangePointsReverse,"pathRangePointsReverse");function integratedCategoryMatch(a,b){return a==null||b==null||typeof a!="object"||typeof b!="object"?!1:"id"in a&&"id"in b?a.id===b.id:a.toString()===b.toString()}__name(integratedCategoryMatch,"integratedCategoryMatch");function scale(val,scaling){if(!scaling)return NaN;if(val instanceof Date&&(val=val.getTime()),scaling.type==="continuous"&&typeof val=="number")return(val-scaling.domain[0])/(scaling.domain[1]-scaling.domain[0])*(scaling.range[1]-scaling.range[0])+scaling.range[0];if(scaling.type==="log"&&typeof val=="number")return scaling.convert(val);const matchingIndex=scaling.domain.findIndex(d=>d===val);if(matchingIndex>=0)return scaling.range[matchingIndex];const matchingIntegratedIndex=scaling.domain.findIndex(d=>integratedCategoryMatch(val,d));return matchingIntegratedIndex>=0?scaling.range[matchingIntegratedIndex]:NaN}__name(scale,"scale");function scalesChanged(newData,oldData){return!areScalingEqual(newData.scales.x,oldData.scales.x)||!areScalingEqual(newData.scales.y,oldData.scales.y)}__name(scalesChanged,"scalesChanged");function closeMatch(a,b){const an=Number(a),bn=Number(b);return!isNaN(an)&&!isNaN(bn)?Math.abs(bn-an)<.25:a===b}__name(closeMatch,"closeMatch");function calculateMoveTo(from2=!1,to=!1){return from2===to?!!from2:from2?"in":"out"}__name(calculateMoveTo,"calculateMoveTo");function pairContinuousData(newData,oldData,opts={}){const{backfillSplitMode="intersect"}=opts,result=[],resultMap={added:{},moved:{},removed:{}},pairUp=__name((from2,to,xValue,change="move")=>{from2&&(isNaN(from2.point.x)||isNaN(from2.point.y))&&(from2=to);const resultPoint={from:from2==null?void 0:from2.point,to:to==null?void 0:to.point,moveTo:calculateMoveTo(from2==null?void 0:from2.point.moveTo,to==null?void 0:to.point.moveTo),change};change==="move"?(resultMap.moved[xValue]=resultPoint,oldIdx++,newIdx++):change==="in"?(resultMap.added[xValue]=resultPoint,newIdx++):change==="out"&&(resultMap.removed[xValue]=resultPoint,oldIdx++),result.push(resultPoint)},"pairUp"),{min:minFromNode,max:maxFromNode}=minMax(oldData.nodeData),{min:minToNode,max:maxToNode}=minMax(newData.nodeData);let oldIdx=0,newIdx=0;for(;oldIdx<oldData.nodeData.length||newIdx<newData.nodeData.length;){const from2=oldData.nodeData[oldIdx],to=newData.nodeData[newIdx],fromShifted=from2?scale(from2.xValue??NaN,newData.scales.x):void 0,toUnshifted=to?scale(to.xValue??NaN,oldData.scales.x):void 0,NA=void 0;if(fromShifted!=null&&closeMatch(fromShifted,to==null?void 0:to.point.x))pairUp(from2,to,to.xValue,"move");else if(fromShifted!=null&&fromShifted<((minToNode==null?void 0:minToNode.point.x)??-1/0))pairUp(from2,NA,from2.xValue,"out");else if(fromShifted!=null&&fromShifted>((maxToNode==null?void 0:maxToNode.point.x)??1/0))pairUp(from2,NA,from2.xValue,"out");else if(toUnshifted!=null&&toUnshifted<((minFromNode==null?void 0:minFromNode.point.x)??-1/0))pairUp(NA,to,to.xValue,"in");else if(toUnshifted!=null&&toUnshifted>((maxFromNode==null?void 0:maxFromNode.point.x)??1/0))pairUp(NA,to,to.xValue,"in");else if(fromShifted!=null&&fromShifted<(to==null?void 0:to.point.x))pairUp(from2,NA,from2.xValue,"out");else if(toUnshifted!=null&&toUnshifted<(from2==null?void 0:from2.point.x))pairUp(NA,to,to.xValue,"in");else if(from2)pairUp(from2,NA,from2.xValue,"out");else if(to)pairUp(NA,to,to.xValue,"in");else throw new Error("Unable to process points")}return backfillPathPointData(result,backfillSplitMode),{result,resultMap}}__name(pairContinuousData,"pairContinuousData");function pairCategoryData(newData,oldData,diff2,opts={}){const{backfillSplitMode="intersect",multiDatum=!1}=opts,result=[],resultMapSingle={added:{},moved:{},removed:{}},resultMapMulti={added:{},moved:{},removed:{}},pointResultMapping={in:"added",move:"moved",out:"removed"};let previousResultPoint,previousXValue;const addToResultMap=__name((xValue,newPoint)=>{var _a274;const type=pointResultMapping[newPoint.change];multiDatum?((_a274=resultMapMulti[type])[xValue]??(_a274[xValue]=[]),resultMapMulti[type][xValue].push(newPoint)):resultMapSingle[type][xValue]=newPoint,previousResultPoint=newPoint,previousXValue=transformIntegratedCategoryValue(xValue)},"addToResultMap");let oldIndex=0,newIndex=0,isXUnordered=!1;for(;oldIndex<oldData.nodeData.length||newIndex<newData.nodeData.length;){const before=oldData.nodeData[oldIndex],after=newData.nodeData[newIndex],bXValue=transformIntegratedCategoryValue(before==null?void 0:before.xValue),aXValue=transformIntegratedCategoryValue(after==null?void 0:after.xValue);let resultPoint;if(bXValue===aXValue)resultPoint={change:"move",moveTo:calculateMoveTo(before.point.moveTo??!1,after.point.moveTo),from:before.point,to:after.point},addToResultMap(before==null?void 0:before.xValue,resultPoint),oldIndex++,newIndex++;else if(diff2!=null&&diff2.removed.has(String(bXValue)))resultPoint={change:"out",moveTo:before.point.moveTo??!1,from:before.point},addToResultMap(before==null?void 0:before.xValue,resultPoint),oldIndex++;else if(diff2!=null&&diff2.added.has(String(aXValue)))resultPoint={change:"in",moveTo:after.point.moveTo??!1,to:after.point},addToResultMap(after==null?void 0:after.xValue,resultPoint),newIndex++;else if(multiDatum&&previousResultPoint&&previousXValue===bXValue)resultPoint={...previousResultPoint},addToResultMap(before==null?void 0:before.xValue,resultPoint),oldIndex++;else if(multiDatum&&previousResultPoint&&previousXValue===aXValue)resultPoint={...previousResultPoint},addToResultMap(after==null?void 0:after.xValue,resultPoint),newIndex++;else{isXUnordered=!0;break}result.push(resultPoint)}let previousX=-1/0;return isXUnordered||(isXUnordered=result.some(pathPoint=>{const{change:marker,to:{x=-1/0}={}}=pathPoint;if(marker==="out")return;const unordered=x<previousX;return previousX=x,unordered})),isXUnordered?{result:void 0,resultMap:void 0}:(backfillPathPointData(result,backfillSplitMode),{result,resultMap:multiDatum?resultMapMulti:resultMapSingle})}__name(pairCategoryData,"pairCategoryData");function determinePathStatus(newData,oldData,pairData){var _a274,_b,_c,_d;let status="updated";const visible=__name(data=>data.visible,"visible");if(!visible(oldData)&&visible(newData))status="added";else if(visible(oldData)&&!visible(newData))status="removed";else for(let i=0;i<pairData.length&&!(pairData[i].change!=="move"||((_a274=pairData[i].from)==null?void 0:_a274.x)!==((_b=pairData[i].to)==null?void 0:_b.x)||((_c=pairData[i].from)==null?void 0:_c.y)!==((_d=pairData[i].to)==null?void 0:_d.y));i++)if(i===pairData.length-1)return"no-op";return status}__name(determinePathStatus,"determinePathStatus");function prepareLinePathPropertyAnimation(status,visibleToggleMode){const phase=visibleToggleMode==="none"?"updated":status,result={fromFn:__name(_path=>{let mixin;return status==="removed"?mixin={finish:{visible:!1}}:status==="added"?mixin={start:{visible:!0}}:mixin={},{phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase],...mixin}},"fromFn"),toFn:__name(_path=>({phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]}),"toFn")};return visibleToggleMode==="fade"?{fromFn:__name(path=>({opacity:status==="added"?0:path.opacity,...result.fromFn(path)}),"fromFn"),toFn:__name(path=>({opacity:status==="removed"?0:1,...result.toFn(path)}),"toFn")}:result}__name(prepareLinePathPropertyAnimation,"prepareLinePathPropertyAnimation");function prepareLinePathAnimationFns(newData,oldData,pairData,visibleToggleMode,interpolation,render){const status=determinePathStatus(newData,oldData,pairData),removePhaseFn=__name((ratio2,path)=>{render(pairData,{move:0,out:ratio2},path,interpolation)},"removePhaseFn"),updatePhaseFn=__name((ratio2,path)=>{render(pairData,{move:ratio2},path,interpolation)},"updatePhaseFn"),addPhaseFn=__name((ratio2,path)=>{render(pairData,{move:1,in:ratio2},path,interpolation)},"addPhaseFn"),pathProperties=prepareLinePathPropertyAnimation(status,visibleToggleMode);return{status,path:{addPhaseFn,updatePhaseFn,removePhaseFn},pathProperties}}__name(prepareLinePathAnimationFns,"prepareLinePathAnimationFns");function prepareLinePathAnimation(newData,oldData,diff2,interpolation){var _a274,_b;const isCategoryBased=((_a274=newData.scales.x)==null?void 0:_a274.type)==="category",wasCategoryBased=((_b=oldData.scales.x)==null?void 0:_b.type)==="category";if(isCategoryBased!==wasCategoryBased||!isScaleValid(newData.scales.x)||!isScaleValid(oldData.scales.x))return;const{result:pairData,resultMap:pairMap}=isCategoryBased?pairCategoryData(newData,oldData,diff2):pairContinuousData(newData,oldData);let status="updated";if(oldData.visible&&!newData.visible?status="removed":!oldData.visible&&newData.visible&&(status="added"),pairData===void 0||pairMap===void 0)return;const hasMotion=((diff2==null?void 0:diff2.changed)??!0)||scalesChanged(newData,oldData)||status!=="updated",pathFns=prepareLinePathAnimationFns(newData,oldData,pairData,"fade",interpolation,renderPartialPath),marker=prepareMarkerAnimation(pairMap,status);return{...pathFns,marker,hasMotion}}__name(prepareLinePathAnimation,"prepareLinePathAnimation");function toAxisValue(value){return transformIntegratedCategoryValue(value).valueOf()}__name(toAxisValue,"toAxisValue");function getAxisIndices({data},axisValues){return data.map((datum,datumIndex)=>({xValue0Index:axisValues.indexOf(toAxisValue(datum.xValue0)),xValue1Index:axisValues.indexOf(toAxisValue(datum.xValue1)),datumIndex}))}__name(getAxisIndices,"getAxisIndices");function validateAxisValuesOrder(axisValues,data){let x0=-1/0;for(const axisValue of axisValues){const x=scale(axisValue,data.scales.x);if(Number.isFinite(x)){if(x<x0)return!1;x0=x}else continue}return!0}__name(validateAxisValuesOrder,"validateAxisValuesOrder");function getAxisValues(newData,oldData){const allAxisValues=new Set;for(const{xValue0,xValue1}of newData.data){const xValue0Value=toAxisValue(xValue0),xValue1Value=toAxisValue(xValue1);allAxisValues.add(xValue0Value).add(xValue1Value)}const newAxisValues=Array.from(allAxisValues).sort((a,b)=>scale(a,newData.scales.x)-scale(b,newData.scales.x)),exclusivelyOldAxisValues=[];for(const{xValue0,xValue1}of oldData.data){const xValue0Value=toAxisValue(xValue0),xValue1Value=toAxisValue(xValue1);allAxisValues.has(xValue0Value)||(allAxisValues.add(xValue0Value),exclusivelyOldAxisValues.push(xValue0Value)),allAxisValues.has(xValue1Value)||(allAxisValues.add(xValue1Value),exclusivelyOldAxisValues.push(xValue1Value))}exclusivelyOldAxisValues.sort((a,b)=>scale(a,oldData.scales.x)-scale(b,oldData.scales.x));const axisValues=newAxisValues;let insertionIndex=0;for(const oldValue of exclusivelyOldAxisValues){inner:for(let i=axisValues.length;i>insertionIndex;i-=1){const oldValueX=scale(oldValue,oldData.scales.x),newValueX=scale(axisValues[i],oldData.scales.x);if(oldValueX>newValueX){insertionIndex=i+1;break inner}}axisValues.splice(insertionIndex,0,oldValue),insertionIndex+=1}if(!validateAxisValuesOrder(axisValues,oldData))return;const oldDataAxisIndices=getAxisIndices(oldData,axisValues),newDataAxisIndices=getAxisIndices(newData,axisValues);return{axisValues,oldDataAxisIndices,newDataAxisIndices}}__name(getAxisValues,"getAxisValues");function clipSpan(span,xValue0Index,xIndices){if(xIndices.xValue1Index===xIndices.xValue0Index+1)return span;const range3=spanRange(span),step=(range3[1].x-range3[0].x)/(xIndices.xValue1Index-xIndices.xValue0Index),start=range3[0].x+(xValue0Index-xIndices.xValue0Index)*step,end=start+step;return clipSpanX(span,start,end)}__name(clipSpan,"clipSpan");function axisZeroSpan(span,data){const[r0,r1]=spanRange(span),y0=scale(0,data.scales.y);return rescaleSpan(span,{x:r0.x,y:y0},{x:r1.x,y:y0})}__name(axisZeroSpan,"axisZeroSpan");function collapseSpan(span,data,axisIndices,indices,range3){var _a274,_b;let xValue,yValue;if(indices.xValue0Index>=range3.xValue1Index){const datumIndex=(_a274=axisIndices.findLast(i=>i.xValue1Index<=range3.xValue1Index))==null?void 0:_a274.datumIndex,datum=datumIndex!=null?data.data[datumIndex]:void 0;xValue=datum==null?void 0:datum.xValue1,yValue=datum==null?void 0:datum.yValue1}else if(indices.xValue0Index<=range3.xValue0Index){const datumIndex=(_b=axisIndices.find(i=>i.xValue0Index>=range3.xValue0Index))==null?void 0:_b.datumIndex,datum=datumIndex!=null?data.data[datumIndex]:void 0;xValue=datum==null?void 0:datum.xValue0,yValue=datum==null?void 0:datum.yValue0}if(xValue==null||yValue==null)return axisZeroSpan(span,data);const x=scale(xValue,data.scales.x),y=scale(yValue,data.scales.y),point={x,y};return rescaleSpan(span,point,point)}__name(collapseSpan,"collapseSpan");function zeroDataSpan(spanDatum,zeroData){var _a274;const newSpanXValue0=toAxisValue(spanDatum.xValue0),newSpanXValue1=toAxisValue(spanDatum.xValue1);return(_a274=zeroData==null?void 0:zeroData.find(span=>toAxisValue(span.xValue0)===newSpanXValue0&&toAxisValue(span.xValue1)===newSpanXValue1))==null?void 0:_a274.span}__name(zeroDataSpan,"zeroDataSpan");function addSpan(newData,newAxisIndices,newIndices,oldZeroData,range3,out){const newSpanDatum=newData.data[newIndices.datumIndex],newSpan=newSpanDatum.span,zeroSpan=zeroDataSpan(newSpanDatum,oldZeroData);if(zeroSpan!=null)out.removed.push({from:zeroSpan,to:zeroSpan}),out.moved.push({from:zeroSpan,to:newSpan}),out.added.push({from:newSpan,to:newSpan});else{const oldSpan=collapseSpan(newSpan,newData,newAxisIndices,newIndices,range3);out.added.push({from:oldSpan,to:newSpan})}}__name(addSpan,"addSpan");function removeSpan(oldData,oldAxisIndices,oldIndices,newZeroData,range3,out){const oldSpanDatum=oldData.data[oldIndices.datumIndex],oldSpan=oldSpanDatum.span,zeroSpan=zeroDataSpan(oldSpanDatum,newZeroData);if(zeroSpan!=null)out.removed.push({from:oldSpan,to:oldSpan}),out.moved.push({from:oldSpan,to:zeroSpan}),out.added.push({from:zeroSpan,to:zeroSpan});else{const newSpan=collapseSpan(oldSpan,oldData,oldAxisIndices,oldIndices,range3);out.removed.push({from:oldSpan,to:newSpan})}}__name(removeSpan,"removeSpan");function alignSpanToContainingSpan(span,axisValues,preData,postData,postSpanIndices){const startXValue0=axisValues[postSpanIndices.xValue0Index],startDatum=preData.data.find(spanDatum=>toAxisValue(spanDatum.xValue0)===startXValue0),endXValue1=axisValues[postSpanIndices.xValue1Index],endDatum=preData.data.find(spanDatum=>toAxisValue(spanDatum.xValue1)===endXValue1);if(startDatum==null||endDatum==null)return;const[{x:x0},{x:x1}]=spanRange(span),startX=scale(startDatum.xValue0,preData.scales.x),startY=scale(startDatum.yValue0,preData.scales.y),endX=scale(endDatum.xValue1,preData.scales.x),endY=scale(endDatum.yValue1,preData.scales.y);let altSpan=postData.data[postSpanIndices.datumIndex].span;return altSpan=rescaleSpan(altSpan,{x:startX,y:startY},{x:endX,y:endY}),altSpan=clipSpanX(altSpan,x0,x1),altSpan}__name(alignSpanToContainingSpan,"alignSpanToContainingSpan");function appendSpanPhases(newData,oldData,axisValues,xValue0Index,newAxisIndices,oldAxisIndices,range3,out){const xValue1Index=xValue0Index+1,oldIndices=oldAxisIndices.find(i=>i.xValue0Index<=xValue0Index&&i.xValue1Index>=xValue1Index),newIndices=newAxisIndices.find(i=>i.xValue0Index<=xValue0Index&&i.xValue1Index>=xValue1Index),oldZeroData=oldData.zeroData,newZeroData=newData.zeroData;if(oldIndices==null&&newIndices!=null){addSpan(newData,newAxisIndices,newIndices,oldZeroData,range3,out);return}else if(oldIndices!=null&&newIndices==null){removeSpan(oldData,oldAxisIndices,oldIndices,newZeroData,range3,out);return}else if(oldIndices==null||newIndices==null)return;let ordering;oldIndices.xValue0Index===newIndices.xValue0Index&&oldIndices.xValue1Index===newIndices.xValue1Index?ordering=0:oldIndices.xValue0Index<=newIndices.xValue0Index&&oldIndices.xValue1Index>=newIndices.xValue1Index?ordering=-1:oldIndices.xValue0Index>=newIndices.xValue0Index&&oldIndices.xValue1Index<=newIndices.xValue1Index?ordering=1:ordering=0;const oldSpanDatum=oldData.data[oldIndices.datumIndex],clippedOldSpanOldScale=clipSpan(oldSpanDatum.span,xValue0Index,oldIndices),newSpanDatum=newData.data[newIndices.datumIndex],clippedNewSpanNewScale=clipSpan(newSpanDatum.span,xValue0Index,newIndices);if(ordering===1){const clippedPostRemoveOldSpanOldScale=alignSpanToContainingSpan(clippedOldSpanOldScale,axisValues,oldData,newData,newIndices);clippedPostRemoveOldSpanOldScale!=null?(out.removed.push({from:clippedOldSpanOldScale,to:clippedPostRemoveOldSpanOldScale}),out.moved.push({from:clippedPostRemoveOldSpanOldScale,to:clippedNewSpanNewScale}),out.added.push({from:clippedNewSpanNewScale,to:clippedNewSpanNewScale})):removeSpan(oldData,oldAxisIndices,oldIndices,newZeroData,range3,out)}else if(ordering===-1){const clippedPreAddedNewSpanNewScale=alignSpanToContainingSpan(clippedNewSpanNewScale,axisValues,newData,oldData,oldIndices);clippedPreAddedNewSpanNewScale!=null?(out.removed.push({from:clippedOldSpanOldScale,to:clippedOldSpanOldScale}),out.moved.push({from:clippedOldSpanOldScale,to:clippedPreAddedNewSpanNewScale}),out.added.push({from:clippedPreAddedNewSpanNewScale,to:clippedNewSpanNewScale})):addSpan(newData,newAxisIndices,newIndices,oldZeroData,range3,out)}else out.removed.push({from:clippedOldSpanOldScale,to:clippedOldSpanOldScale}),out.moved.push({from:clippedOldSpanOldScale,to:clippedNewSpanNewScale}),out.added.push({from:clippedNewSpanNewScale,to:clippedNewSpanNewScale})}__name(appendSpanPhases,"appendSpanPhases");function phaseAnimation(axisContext,newData,oldData,out){var _a274,_b,_c,_d;const{axisValues,oldDataAxisIndices,newDataAxisIndices}=axisContext,range3={xValue0Index:Math.max(((_a274=oldDataAxisIndices.at(0))==null?void 0:_a274.xValue0Index)??-1/0,((_b=newDataAxisIndices.at(0))==null?void 0:_b.xValue0Index)??-1/0),xValue1Index:Math.min(((_c=oldDataAxisIndices.at(-1))==null?void 0:_c.xValue1Index)??1/0,((_d=newDataAxisIndices.at(-1))==null?void 0:_d.xValue1Index)??1/0)};for(let xValue0Index=0;xValue0Index<axisValues.length-1;xValue0Index+=1)appendSpanPhases(newData,oldData,axisValues,xValue0Index,newDataAxisIndices,oldDataAxisIndices,range3,out)}__name(phaseAnimation,"phaseAnimation");function resetAnimation(newData,oldData,out){for(const oldSpanDatum of oldData.data){const oldSpan=oldSpanDatum.span,zeroSpan=zeroDataSpan(oldSpanDatum,oldData.zeroData)??axisZeroSpan(oldSpan,oldData);out.removed.push({from:oldSpan,to:zeroSpan})}for(const newSpanDatum of newData.data){const newSpan=newSpanDatum.span,zeroSpan=zeroDataSpan(newSpanDatum,newData.zeroData)??axisZeroSpan(newSpan,newData);out.added.push({from:zeroSpan,to:newSpan})}}__name(resetAnimation,"resetAnimation");function pairUpSpans(newData,oldData){const out={removed:[],moved:[],added:[]},axisContext=getAxisValues(newData,oldData);return axisContext==null?resetAnimation(newData,oldData,out):phaseAnimation(axisContext,newData,oldData,out),out}__name(pairUpSpans,"pairUpSpans");function plotFillSpans(ratio2,path,spans,fillPhantomSpans){for(let i=0;i<spans.length;i+=1){const span=spans[i],reversedPhantomSpan=fillPhantomSpans[i];plotInterpolatedSpans(path.path,span.from,span.to,ratio2,1,!1),plotInterpolatedSpans(path.path,reversedPhantomSpan.from,reversedPhantomSpan.to,ratio2,2,!0),path.path.closePath()}}__name(plotFillSpans,"plotFillSpans");function prepareAreaFillAnimationFns(status,spans,fillPhantomSpans,visibleToggleMode){const removePhaseFn=__name((ratio2,path)=>plotFillSpans(ratio2,path,spans.removed,fillPhantomSpans.removed),"removePhaseFn"),updatePhaseFn=__name((ratio2,path)=>plotFillSpans(ratio2,path,spans.moved,fillPhantomSpans.moved),"updatePhaseFn"),addPhaseFn=__name((ratio2,path)=>plotFillSpans(ratio2,path,spans.added,fillPhantomSpans.added),"addPhaseFn"),pathProperties=prepareLinePathPropertyAnimation(status,visibleToggleMode);return{status,path:{addPhaseFn,updatePhaseFn,removePhaseFn},pathProperties}}__name(prepareAreaFillAnimationFns,"prepareAreaFillAnimationFns");function plotStrokeSpans(ratio2,path,spans){for(const span of spans)plotInterpolatedSpans(path.path,span.from,span.to,ratio2,1,!1)}__name(plotStrokeSpans,"plotStrokeSpans");function prepareAreaStrokeAnimationFns(status,spans,visibleToggleMode){const removePhaseFn=__name((ratio2,path)=>plotStrokeSpans(ratio2,path,spans.removed),"removePhaseFn"),updatePhaseFn=__name((ratio2,path)=>plotStrokeSpans(ratio2,path,spans.moved),"updatePhaseFn"),addPhaseFn=__name((ratio2,path)=>plotStrokeSpans(ratio2,path,spans.added),"addPhaseFn"),pathProperties=prepareLinePathPropertyAnimation(status,visibleToggleMode);return{status,path:{addPhaseFn,updatePhaseFn,removePhaseFn},pathProperties}}__name(prepareAreaStrokeAnimationFns,"prepareAreaStrokeAnimationFns");function prepareAreaPathAnimation(newData,oldData){var _a274,_b;const isCategoryBased=((_a274=newData.scales.x)==null?void 0:_a274.type)==="category",wasCategoryBased=((_b=oldData.scales.x)==null?void 0:_b.type)==="category";if(isCategoryBased!==wasCategoryBased||!isScaleValid(newData.scales.x)||!isScaleValid(oldData.scales.x))return;let status="updated";oldData.visible&&!newData.visible?status="removed":!oldData.visible&&newData.visible&&(status="added");const fillSpans=pairUpSpans({scales:newData.scales,data:newData.fillData.spans,visible:newData.visible},{scales:oldData.scales,data:oldData.fillData.spans,visible:oldData.visible}),fillPhantomSpans=pairUpSpans({scales:newData.scales,data:newData.fillData.phantomSpans,visible:newData.visible},{scales:oldData.scales,data:oldData.fillData.phantomSpans,visible:oldData.visible}),strokeSpans=pairUpSpans({scales:newData.scales,data:newData.strokeData.spans,visible:newData.visible,zeroData:newData.fillData.phantomSpans},{scales:oldData.scales,data:oldData.strokeData.spans,visible:oldData.visible,zeroData:oldData.fillData.phantomSpans}),fadeMode="none",fill=prepareAreaFillAnimationFns(status,fillSpans,fillPhantomSpans,fadeMode),stroke=prepareAreaStrokeAnimationFns(status,strokeSpans,fadeMode);return{status,fill,stroke}}__name(prepareAreaPathAnimation,"prepareAreaPathAnimation");var CROSS_FILTER_AREA_FILL_OPACITY_FACTOR=.125,CROSS_FILTER_AREA_STROKE_OPACITY_FACTOR=.25,_a201,AreaSeries=(_a201=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,pathsPerSeries:["fill","stroke"],pathsZIndexSubOrderOffset:[0,1e3],hasMarkers:!0,markerSelectionGarbageCollection:!1,pickModes:[1,0],animationResetFns:{path:buildResetPathFn({getVisible:__name(()=>this.visible,"getVisible"),getOpacity:__name(()=>this.getOpacity(),"getOpacity")}),label:resetLabelFn,marker:__name((node,datum)=>({...resetMarkerFn(),...resetMarkerPositionFn(node,datum)}),"marker")}}),this.properties=new AreaSeriesProperties}async processData(dataController){var _a274,_b;if(this.data==null||!this.properties.isValid())return;const{data,visible,seriesGrouping:{groupIndex=this.id,stackCount=1}={}}=this,{xKey,yKey,yFilterKey,connectMissingData,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),xScale=(_a274=this.axes.x)==null?void 0:_a274.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),currentIds={value:`area-stack-${groupIndex}-yValue`,values:`area-stack-${groupIndex}-yValues`,stack:`area-stack-${groupIndex}-yValue-stack`,marker:`area-stack-${groupIndex}-yValues-marker`},extraProps=[];isDefined(normalizedTo)&&extraProps.push(normaliseGroupTo(Object.values(currentIds),normalizedTo,"range")),animationEnabled&&extraProps.push(animationValidation());const common={invalidValue:null};connectMissingData&&stackCount>1&&(common.invalidValue=0),visible||(common.forceValue=0),await this.requestDataModel(dataController,data,{props:[keyProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValueRaw",...common}),...yFilterKey!=null?[valueProperty(yFilterKey,yScaleType,{id:"yFilterRaw"})]:[],...groupStackValueProperty(yKey,yScaleType,{id:"yValueStack",...common,groupId:currentIds.stack}),valueProperty(yKey,yScaleType,{id:"yValue",...common,groupId:currentIds.value}),...groupAccumulativeValueProperty(yKey,"window","current",{id:"yValueEnd",...common,groupId:currentIds.values},yScaleType),...groupAccumulativeValueProperty(yKey,"normal","current",{id:"yValueCumulative",...common,groupId:currentIds.marker},yScaleType),...extraProps],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}getSeriesDomain(direction){const{processedData,dataModel,axes}=this;if(!processedData||!dataModel||processedData.data.length===0)return[];const yAxis=axes.y,keyDef=dataModel.resolveProcessedDataDefById(this,"xValue"),keys=dataModel.getDomain(this,"xValue","key",processedData),yExtent=dataModel.getDomain(this,"yValueEnd","value",processedData);if(direction==="x")return(keyDef==null?void 0:keyDef.def.type)==="key"&&keyDef.def.valueType==="category"?keys:fixNumericExtent(extent(keys));if(yAxis instanceof LogAxis||yAxis instanceof TimeAxis)return fixNumericExtent(yExtent);{const fixedYExtent=[yExtent[0]>0?0:yExtent[0],yExtent[1]<0?0:yExtent[1]];return fixNumericExtent(fixedYExtent)}}async createNodeData(){var _a274;const{axes,data,processedData:{data:groupedData}={},dataModel}=this,xAxis=axes.x,yAxis=axes.y;if(!xAxis||!yAxis||!data||!dataModel||!this.properties.isValid())return;const{yKey,xKey,yFilterKey,marker,label,fill:seriesFill,stroke:seriesStroke,connectMissingData}=this.properties,{scale:xScale}=xAxis,{scale:yScale}=yAxis,{isContinuousY}=this.getScaleInformation({xScale,yScale}),xOffset=(xScale.bandwidth??0)/2,defs=dataModel.resolveProcessedDataDefsByIds(this,["yValueEnd","yValueRaw","yValueCumulative"]),yFilterIndex=yFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"yFilterRaw"):void 0,yValueStackIndex=dataModel.resolveProcessedDataIndexById(this,"yValueStack"),createMarkerCoordinate=__name((xDatum,yEnd,rawYDatum)=>{let currY;return(isDefined(this.properties.normalizedTo)?isContinuousY&&isContinuous(rawYDatum):!isNaN(rawYDatum))&&(currY=yEnd),{x:xScale.convert(xDatum)+xOffset,y:yScale.convert(currY),size:marker.size}},"createMarkerCoordinate"),itemId=yKey,labelData=[],markerData=[],{visibleSameStackCount}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);let datumIdx=-1,crossFiltering=!1;groupedData==null||groupedData.forEach(datumGroup=>{const{keys,keys:[xDatum],datum:datumArray,values:valuesArray}=datumGroup;valuesArray.forEach((values,valueIdx)=>{datumIdx++;const seriesDatum=datumArray[valueIdx],dataValues2=dataModel.resolveProcessedDataDefsValues(defs,{keys,values}),{yValueRaw:yDatum,yValueCumulative,yValueEnd}=dataValues2,validPoint=Number.isFinite(yDatum),point=createMarkerCoordinate(xDatum,+yValueCumulative,yDatum),selected=yFilterIndex!=null?values[yFilterIndex]===yDatum:void 0;if(selected===!1&&(crossFiltering=!0),validPoint&&marker&&markerData.push({index:datumIdx,series:this,itemId,datum:seriesDatum,midPoint:{x:point.x,y:point.y},cumulativeValue:yValueEnd,yValue:yDatum,xValue:xDatum,yKey,xKey,point,fill:marker.fill??seriesFill,stroke:marker.stroke??seriesStroke,strokeWidth:marker.strokeWidth??this.getStrokeWidth(this.properties.strokeWidth),selected}),validPoint&&label){const labelText=this.getLabelText(label,{value:yDatum,datum:seriesDatum,xKey,yKey,xName:this.properties.xName,yName:this.properties.yName},value=>isFiniteNumber(value)?value.toFixed(2):String(value));labelData.push({index:datumIdx,series:this,itemId:yKey,datum:seriesDatum,x:point.x,y:point.y,label:labelText?{text:labelText,fontStyle:label.fontStyle,fontWeight:label.fontWeight,fontSize:label.fontSize,fontFamily:label.fontFamily,textAlign:"center",textBaseline:"bottom",fill:label.color}:void 0})}})});const{interpolation}=this.properties,interpolatePoints=__name(points=>{let spans;const pointsIter=points.map(point=>point.point);switch(interpolation.type){case"linear":spans=linearPoints(pointsIter);break;case"smooth":spans=smoothPoints(pointsIter,interpolation.tension);break;case"step":spans=stepPoints(pointsIter,interpolation.position);break}return spans.map((span,i)=>({span,xValue0:points[i].xDatum,yValue0:points[i].yDatum,xValue1:points[i+1].xDatum,yValue1:points[i+1].yDatum}))},"interpolatePoints"),spansForPoints=__name(points=>points.flatMap(p=>Array.isArray(p)?interpolatePoints(p):new Array(p.skip).fill(null)),"spansForPoints"),dataValues=groupedData==null?void 0:groupedData.flatMap(datumGroup=>{const{keys:[xDatum],values:valuesArray}=datumGroup;return valuesArray.map(values=>({xDatum,values}))}),createPoint=__name((xDatum,yDatum)=>({point:{x:xScale.convert(xDatum)+xOffset,y:yScale.convert(yDatum)},xDatum,yDatum}),"createPoint"),getSeriesSpans=__name(index=>{var _a275,_b;const points=[];if(dataValues==null)return[];for(let i=0;i<dataValues.length;i+=1){const{xDatum,values}=dataValues[i],yValueStack=values[yValueStackIndex],yDatum=yValueStack[index],yDatumIsFinite=Number.isFinite(yDatum);if(connectMissingData&&!yDatumIsFinite)continue;const lastYValueStack=(_a275=dataValues[i-1])==null?void 0:_a275.values[yValueStackIndex],nextYValueStack=(_b=dataValues[i+1])==null?void 0:_b.values[yValueStackIndex];let yValueEndBackwards=0,yValueEndForwards=0;for(let j=0;j<=index;j+=1){const value=yValueStack[j];if(Number.isFinite(value)){const lastWasFinite=lastYValueStack==null||Number.isFinite(lastYValueStack[j]),nextWasFinite=nextYValueStack==null||Number.isFinite(nextYValueStack[j]);lastWasFinite&&(yValueEndBackwards+=value),nextWasFinite&&(yValueEndForwards+=value)}}const currentPoints=points[points.length-1];if(!connectMissingData&&(yValueEndBackwards!==yValueEndForwards||!yDatumIsFinite))if(!yDatumIsFinite&&Array.isArray(currentPoints)&&currentPoints.length===1)points[points.length-1]={skip:1};else{const pointBackwards=createPoint(xDatum,yValueEndBackwards),pointForwards=createPoint(xDatum,yValueEndForwards);Array.isArray(currentPoints)?currentPoints.push(pointBackwards):currentPoints!=null&&(currentPoints.skip+=1),points.push(yDatumIsFinite?[pointForwards]:{skip:0})}else{const yValueEnd=Math.max(yValueEndBackwards,yValueEndForwards),point=createPoint(xDatum,yValueEnd);Array.isArray(currentPoints)?currentPoints.push(point):currentPoints!=null?(currentPoints.skip+=1,points.push([point])):points.push([point])}}return spansForPoints(points)},"getSeriesSpans"),stackIndex=((_a274=this.seriesGrouping)==null?void 0:_a274.stackIndex)??0,getAxisSpans=__name(()=>{if(dataValues==null)return[];const yValueZeroPoints=dataValues.map(({xDatum,values})=>{const yDatum=values[yValueStackIndex][stackIndex];if(!(connectMissingData&&!Number.isFinite(yDatum)))return createPoint(xDatum,0)}).filter(x=>x!=null);return interpolatePoints(yValueZeroPoints)},"getAxisSpans"),currentSeriesSpans=getSeriesSpans(stackIndex),phantomSpans=currentSeriesSpans.map(()=>null);for(let j=stackIndex-1;j>=-1;j-=1){let spans;for(let i=0;i<phantomSpans.length;i+=1)phantomSpans[i]==null&&(spans??(spans=j!==-1?getSeriesSpans(j):getAxisSpans()),phantomSpans[i]=spans[i])}const fillSpans=currentSeriesSpans.map((span,index)=>span??phantomSpans[index]),strokeSpans=currentSeriesSpans.filter(span=>span!=null);return{itemId,fillData:{itemId,spans:fillSpans,phantomSpans},strokeData:{itemId,spans:strokeSpans},labelData,nodeData:markerData,scales:this.calculateScaling(),visible:this.visible,stackVisible:visibleSameStackCount>0,crossFiltering}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}async updatePathNodes(opts){var _a274;const{opacity,visible,animationEnabled}=opts,[fill,stroke]=opts.paths,crossFiltering=((_a274=this.contextNodeData)==null?void 0:_a274.crossFiltering)===!0,strokeWidth=this.getStrokeWidth(this.properties.strokeWidth);stroke.setProperties({fill:void 0,lineJoin:stroke.lineCap="round",pointerEvents:1,stroke:this.properties.stroke,strokeWidth,strokeOpacity:this.properties.strokeOpacity*(crossFiltering?CROSS_FILTER_AREA_STROKE_OPACITY_FACTOR:1),lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity,visible:visible||animationEnabled}),fill.setProperties({stroke:void 0,lineJoin:"round",pointerEvents:1,fill:this.properties.fill,fillOpacity:this.properties.fillOpacity*(crossFiltering?CROSS_FILTER_AREA_FILL_OPACITY_FACTOR:1),fillShadow:this.properties.shadow,opacity,visible:visible||animationEnabled}),updateClipPath(this,stroke),updateClipPath(this,fill)}async updatePaths(opts){this.updateAreaPaths(opts.paths,opts.contextData)}updateAreaPaths(paths,contextData){for(const path of paths)path.visible=contextData.visible;if(contextData.visible)this.updateFillPath(paths,contextData),this.updateStrokePath(paths,contextData);else for(const path of paths)path.path.clear(),path.checkPathDirty()}updateFillPath(paths,contextData){const{spans,phantomSpans}=contextData.fillData,[fill]=paths,{path}=fill;path.clear(!0);for(let i=0;i<spans.length;i+=1){const{span}=spans[i],phantomSpan=phantomSpans[i].span;plotSpan(path,span,1,!1),plotSpan(path,phantomSpan,2,!0),path.closePath()}fill.checkPathDirty()}updateStrokePath(paths,contextData){const{spans}=contextData.strokeData,[,stroke]=paths,{path}=stroke;path.clear(!0);for(const{span}of spans)plotSpan(path,span,1,!1);stroke.checkPathDirty()}async updateMarkerSelection(opts){var _a274;const{nodeData,markerSelection}=opts,markersEnabled=this.properties.marker.enabled||((_a274=this.contextNodeData)==null?void 0:_a274.crossFiltering)===!0;return this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(markersEnabled?nodeData:[])}async updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,marker,fill,stroke,strokeWidth,fillOpacity,strokeOpacity,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle(),{fill,stroke,strokeWidth,fillOpacity,strokeOpacity});markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey},baseStyle,{selected:datum.selected})}),highlighted||this.properties.marker.markClean()}async updateLabelSelection(opts){const{labelData,labelSelection}=opts;return labelSelection.update(labelData)}async updateLabelNodes(opts){const{labelSelection}=opts,{enabled:labelEnabled,fontStyle,fontWeight,fontSize,fontFamily,color}=this.properties.label;labelSelection.each((text,datum)=>{const{x,y,label}=datum;label&&labelEnabled&&this.visible?(text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.textAlign=label.textAlign,text.textBaseline=label.textBaseline,text.text=label.text,text.x=x,text.y=y-10,text.fill=color,text.visible=!0):text.visible=!1})}getTooltipHtml(nodeDatum){const{id:seriesId,axes,dataModel}=this,{xKey,xName,yName,tooltip,marker}=this.properties,{yKey,xValue,yValue,datum,itemId}=nodeDatum,xAxis=axes.x,yAxis=axes.y;if(!this.properties.isValid()||!(xAxis&&yAxis&&isFiniteNumber(yValue))||!dataModel)return EMPTY_TOOLTIP_CONTENT;const xString=xAxis.formatDatum(xValue),yString=yAxis.formatDatum(yValue),title=sanitizeHtml(yName),content=sanitizeHtml(xString+": "+yString),baseStyle=mergeDefaults({fill:this.properties.fill},marker.getStyle(),{stroke:this.properties.stroke,strokeWidth:this.properties.strokeWidth}),{fill:color}=this.getMarkerStyle(marker,{datum:nodeDatum,xKey,yKey,highlighted:!1},baseStyle);return tooltip.toTooltipHtml({title,content,backgroundColor:color},{datum,itemId,xKey,xName,yKey,yName,color,title,seriesId})}getLegendData(legendType){var _a274;if(!((_a274=this.data)!=null&&_a274.length)||!this.properties.isValid()||!this.properties.showInLegend||legendType!=="category")return[];const{yKey,yName,fill,stroke,fillOpacity,strokeOpacity,strokeWidth,lineDash,marker,visible,legendItemName}=this.properties,useAreaFill=!marker.enabled||marker.fill===void 0;return[{legendType,id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:legendItemName??yName??yKey},symbols:[{marker:{shape:marker.shape,fill:useAreaFill?fill:marker.fill,fillOpacity:useAreaFill?fillOpacity:marker.fillOpacity,stroke:marker.stroke??stroke,strokeOpacity:marker.strokeOpacity??strokeOpacity,strokeWidth:marker.strokeWidth??0,enabled:marker.enabled||strokeWidth<=0},line:{stroke,strokeOpacity,strokeWidth,lineDash}}],legendItemName}]}animateEmptyUpdateReady(animationData){const{markerSelection,labelSelection,contextData,paths}=animationData,{animationManager}=this.ctx;this.updateAreaPaths(paths,contextData),pathSwipeInAnimation(this,animationManager,...paths),resetMotion([markerSelection],resetMarkerPositionFn),markerSwipeScaleInAnimation(this,animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection)}animateReadyResize(animationData){const{contextData,paths}=animationData;this.updateAreaPaths(paths,contextData),super.animateReadyResize(animationData)}animateWaitingUpdateReady(animationData){const{animationManager}=this.ctx,{markerSelection,labelSelection,contextData,paths,previousContextData}=animationData,[fill,stroke]=paths;if(fill==null&&stroke==null)return;this.resetMarkerAnimation(animationData),this.resetLabelAnimation(animationData);const update=__name(()=>{this.resetPathAnimation(animationData),this.updateAreaPaths(paths,contextData)},"update"),skip=__name(()=>{animationManager.skipCurrentBatch(),update()},"skip");if(contextData==null||previousContextData==null){update(),markerFadeInAnimation(this,animationManager,"added",markerSelection),pathFadeInAnimation(this,"fill_path_properties",animationManager,"add",fill),pathFadeInAnimation(this,"stroke_path_properties",animationManager,"add",stroke),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection);return}if(contextData.crossFiltering!==previousContextData.crossFiltering){skip();return}const fns=prepareAreaPathAnimation(contextData,previousContextData);if(fns===void 0){skip();return}else if(fns.status==="no-op")return;markerFadeInAnimation(this,animationManager,void 0,markerSelection),fromToMotion(this.id,"fill_path_properties",animationManager,[fill],fns.fill.pathProperties),pathMotion(this.id,"fill_path_update",animationManager,[fill],fns.fill.path),fromToMotion(this.id,"stroke_path_properties",animationManager,[stroke],fns.stroke.pathProperties),pathMotion(this.id,"stroke_path_update",animationManager,[stroke],fns.stroke.path),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:__name(()=>this.updateAreaPaths(paths,contextData),"onComplete")})}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey}=datum;return this.getMarkerStyle(this.properties.marker,{datum,xKey,yKey,highlighted:!0})}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a201,"AreaSeries"),_a201);AreaSeries.className="AreaSeries";AreaSeries.type="area";var AreaSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"area",moduleFactory:__name(ctx=>new AreaSeries(ctx),"moduleFactory"),stackable:!0,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{nodeClickRange:"nearest",tooltip:{position:{type:"node"}},fillOpacity:.8,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},interpolation:{type:"linear",tension:1,position:"end"},marker:{enabled:!1,shape:"circle",size:7,strokeWidth:0},label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR}}},paletteFactory:__name(params=>{const{marker}=markerPaletteFactory(params);return{fill:marker.fill,stroke:marker.stroke,marker}},"paletteFactory")};function*childrenIter(parent){for(const node of parent.children)yield node}__name(childrenIter,"childrenIter");function addHitTestersToQuadtree(quadtree,hitTesters){for(const node of hitTesters){const datum=node.datum;datum===void 0?Logger.error("undefined datum"):quadtree.addValue(node,datum)}}__name(addHitTestersToQuadtree,"addHitTestersToQuadtree");function findQuadtreeMatch(series,point){const{x,y}=point,{nearest,distanceSquared:distanceSquared3}=series.getQuadTree().find(x,y);if(nearest!==void 0)return{datum:nearest.value,distance:Math.sqrt(distanceSquared3)}}__name(findQuadtreeMatch,"findQuadtreeMatch");var _a202,AbstractBarSeriesProperties=(_a202=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.direction="vertical"}},__name(_a202,"AbstractBarSeriesProperties"),_a202);__decorateClass([Validate(DIRECTION)],AbstractBarSeriesProperties.prototype,"direction",2);var _a203,AbstractBarSeries=(_a203=class extends CartesianSeries{constructor(){super(...arguments),this.groupScale=new BandScale,this.smallestDataInterval=void 0,this.largestDataInterval=void 0}padBandExtent(keys,alignStart){const ratio2=typeof alignStart=="boolean"?1:.5,scalePadding=isFiniteNumber(this.smallestDataInterval)?this.smallestDataInterval*ratio2:0,keysExtent=extent(keys)??[NaN,NaN];return typeof alignStart=="boolean"?keysExtent[alignStart?0:1]-=(alignStart?1:-1)*scalePadding:(keysExtent[0]-=scalePadding,keysExtent[1]+=scalePadding),fixNumericExtent(keysExtent)}getBandScalePadding(){return{inner:.3,outer:.15}}shouldFlipXY(){return!this.isVertical()}isVertical(){return this.properties.direction==="vertical"}getBarDirection(){return this.shouldFlipXY()?"x":"y"}getCategoryDirection(){return this.shouldFlipXY()?"y":"x"}getValueAxis(){const direction=this.getBarDirection();return this.axes[direction]}getCategoryAxis(){const direction=this.getCategoryDirection();return this.axes[direction]}getBandwidth(xAxis){return ContinuousScale.is(xAxis.scale)?xAxis.scale.calcBandwidth(this.smallestDataInterval):xAxis.scale.bandwidth}updateGroupScale(xAxis){const domain=[],{groupScale}=this,xBandWidth=this.getBandwidth(xAxis),{index:groupIndex,visibleGroupCount}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);for(let groupIdx=0;groupIdx<visibleGroupCount;groupIdx++)domain.push(String(groupIdx));return groupScale.domain=domain,groupScale.range=[0,xBandWidth??0],xAxis instanceof CategoryAxis?groupScale.paddingInner=xAxis.groupPaddingInner:xAxis instanceof GroupedCategoryAxis?groupScale.padding=.1:groupScale.padding=0,groupScale.round=groupScale.padding!==0,{barWidth:groupScale.bandwidth>=1?groupScale.bandwidth:groupScale.rawBandwidth,groupIndex}}resolveKeyDirection(direction){return this.getBarDirection()==="x"?direction==="x"?"y":"x":direction}initQuadTree(quadtree){addHitTestersToQuadtree(quadtree,this.datumNodesIter())}pickNodeClosestDatum(point){return findQuadtreeMatch(this,point)}},__name(_a203,"AbstractBarSeries"),_a203),_a204,BarSeriesLabel=(_a204=class extends Label{constructor(){super(...arguments),this.placement="inside"}},__name(_a204,"BarSeriesLabel"),_a204);__decorateClass([Validate(PLACEMENT)],BarSeriesLabel.prototype,"placement",2);var _a205,BarSeriesProperties=(_a205=class extends AbstractBarSeriesProperties{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.crisp=void 0,this.shadow=new DropShadow,this.label=new BarSeriesLabel,this.tooltip=new SeriesTooltip}},__name(_a205,"BarSeriesProperties"),_a205);__decorateClass([Validate(STRING)],BarSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING)],BarSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"yFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"stackGroup",2);__decorateClass([Validate(NUMBER,{optional:!0})],BarSeriesProperties.prototype,"normalizedTo",2);__decorateClass([Validate(COLOR_STRING)],BarSeriesProperties.prototype,"fill",2);__decorateClass([Validate(RATIO)],BarSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING)],BarSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],BarSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],BarSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],BarSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],BarSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(POSITIVE_NUMBER)],BarSeriesProperties.prototype,"cornerRadius",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],BarSeriesProperties.prototype,"crisp",2);__decorateClass([Validate(FUNCTION,{optional:!0})],BarSeriesProperties.prototype,"itemStyler",2);__decorateClass([Validate(OBJECT,{optional:!0})],BarSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],BarSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],BarSeriesProperties.prototype,"tooltip",2);function updateRect(rect,config){rect.crisp=config.crisp??!0,rect.fill=config.fill,rect.stroke=config.stroke,rect.strokeWidth=config.strokeWidth,rect.fillOpacity=config.fillOpacity,rect.strokeOpacity=config.strokeOpacity,rect.lineDash=config.lineDash,rect.lineDashOffset=config.lineDashOffset,rect.fillShadow=config.fillShadow,rect.topLeftCornerRadius=config.topLeftCornerRadius!==!1?config.cornerRadius??0:0,rect.topRightCornerRadius=config.topRightCornerRadius!==!1?config.cornerRadius??0:0,rect.bottomRightCornerRadius=config.bottomRightCornerRadius!==!1?config.cornerRadius??0:0,rect.bottomLeftCornerRadius=config.bottomLeftCornerRadius!==!1?config.cornerRadius??0:0,rect.visible=config.visible??!0}__name(updateRect,"updateRect");function getRectConfig({datum,isHighlighted,style,highlightStyle,itemStyler,seriesId,ctx:{callbackCache},...opts}){const{fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius=0}=mergeDefaults(isHighlighted&&highlightStyle,style);let format;return itemStyler&&(format=callbackCache.call(itemStyler,{datum:datum.datum,xKey:datum.xKey,fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius,highlighted:isHighlighted,seriesId,...opts})),{fill:(format==null?void 0:format.fill)??fill,fillOpacity:(format==null?void 0:format.fillOpacity)??fillOpacity,stroke:(format==null?void 0:format.stroke)??stroke,strokeWidth:(format==null?void 0:format.strokeWidth)??strokeWidth,strokeOpacity:(format==null?void 0:format.strokeOpacity)??strokeOpacity,lineDash:(format==null?void 0:format.lineDash)??lineDash,lineDashOffset:(format==null?void 0:format.lineDashOffset)??lineDashOffset,cornerRadius:(format==null?void 0:format.cornerRadius)??cornerRadius,topLeftCornerRadius:style.topLeftCornerRadius,topRightCornerRadius:style.topRightCornerRadius,bottomRightCornerRadius:style.bottomRightCornerRadius,bottomLeftCornerRadius:style.bottomLeftCornerRadius,fillShadow:style.fillShadow}}__name(getRectConfig,"getRectConfig");function checkCrisp(scale2,visibleRange,smallestDataInterval,largestDataInterval){if(visibleRange!=null){const[visibleMin,visibleMax]=visibleRange;if(visibleMin!==0||visibleMax!==1)return!1}if(ContinuousScale.is(scale2)){const spacing=scale2.calcBandwidth(largestDataInterval)-scale2.calcBandwidth(smallestDataInterval);if(spacing>0&&spacing<1)return!1}return!0}__name(checkCrisp,"checkCrisp");var isDatumNegative=__name(datum=>isNegative(datum.yValue??0),"isDatumNegative");function collapsedStartingBarPosition(isVertical,axes,mode){const{startingX,startingY}=getStartingValues(isVertical,axes);return{isVertical,calculate:__name((datum,prevDatum)=>{let x=isVertical?datum.x:startingX,y=isVertical?startingY:datum.y,width=isVertical?datum.width:0,height=isVertical?0:datum.height;const{opacity}=datum;prevDatum&&(isNaN(x)||isNaN(y))&&({x,y}=prevDatum,width=isVertical?prevDatum.width:0,height=isVertical?0:prevDatum.height,isVertical&&!isDatumNegative(prevDatum)?y+=prevDatum.height:!isVertical&&isDatumNegative(prevDatum)&&(x+=prevDatum.width));let clipBBox;return datum.clipBBox==null?clipBBox=void 0:isDatumNegative(datum)?clipBBox=isVertical?new BBox(x,y-height,width,height):new BBox(x-width,y,width,height):clipBBox=new BBox(x,y,width,height),{x,y,width,height,clipBBox,opacity}},"calculate"),mode}}__name(collapsedStartingBarPosition,"collapsedStartingBarPosition");function midpointStartingBarPosition(isVertical,mode){return{isVertical,calculate:__name(datum=>({x:isVertical?datum.x:datum.x+datum.width/2,y:isVertical?datum.y+datum.height/2:datum.y,width:isVertical?datum.width:0,height:isVertical?0:datum.height,clipBBox:datum.clipBBox,opacity:datum.opacity}),"calculate"),mode}}__name(midpointStartingBarPosition,"midpointStartingBarPosition");function prepareBarAnimationFunctions(initPos){const isRemoved=__name(datum=>datum==null||isNaN(datum.x)||isNaN(datum.y),"isRemoved");return{toFn:__name((rect,datum,status)=>{let source;return status==="removed"&&rect.datum==null&&initPos.mode==="fade"?source={...resetBarSelectionsFn(rect,datum),opacity:0}:status==="removed"||isRemoved(datum)?source=initPos.calculate(datum,rect.previousDatum):source={x:datum.x,y:datum.y,width:datum.width,height:datum.height,clipBBox:datum.clipBBox,opacity:datum.opacity},source},"toFn"),fromFn:__name((rect,datum,status)=>{status==="updated"&&isRemoved(datum)?status="removed":status==="updated"&&isRemoved(rect.previousDatum)&&(status="added");let source;status==="added"&&rect.previousDatum==null&&initPos.mode==="fade"?source={...resetBarSelectionsFn(rect,datum),opacity:0}:status==="unknown"||status==="added"?source=initPos.calculate(datum,rect.previousDatum):source={x:rect.x,y:rect.y,width:rect.width,height:rect.height,clipBBox:rect.clipBBox,opacity:rect.opacity};const phase=NODE_UPDATE_STATE_TO_PHASE_MAPPING[status];return{...source,phase}},"fromFn")}}__name(prepareBarAnimationFunctions,"prepareBarAnimationFunctions");function getStartingValues(isVertical,axes){const axis=axes[isVertical?"y":"x"];let startingX=1/0,startingY=0;return axis?(isVertical?startingY=axis.scale.convert(ContinuousScale.is(axis.scale)?0:Math.max(...axis.range)):startingX=axis.scale.convert(ContinuousScale.is(axis.scale)?0:Math.min(...axis.range)),{startingX,startingY}):{startingX,startingY}}__name(getStartingValues,"getStartingValues");function resetBarSelectionsFn(_node,{x,y,width,height,clipBBox,opacity}){return{x,y,width,height,clipBBox,opacity}}__name(resetBarSelectionsFn,"resetBarSelectionsFn");function computeBarFocusBounds(datum,barGroup,seriesRect){if(datum===void 0)return;const{x,y,width,height}=datum;return Transformable.toCanvas(barGroup,new BBox(x,y,width,height)).clip(seriesRect)}__name(computeBarFocusBounds,"computeBarFocusBounds");function updateLabelNode(textNode,label,labelDatum){if(label.enabled&&labelDatum){const{x,y,text,textAlign,textBaseline}=labelDatum,{color:fill,fontStyle,fontWeight,fontSize,fontFamily}=label;textNode.setProperties({visible:!0,x,y,text,fill,fontStyle,fontWeight,fontSize,fontFamily,textAlign,textBaseline})}else textNode.visible=!1}__name(updateLabelNode,"updateLabelNode");function adjustLabelPlacement({isPositive,isVertical,placement,padding=0,rect}){let x=rect.x+rect.width/2,y=rect.y+rect.height/2,textAlign="center",textBaseline="middle";switch(placement){case"start":{isVertical?(y=isPositive?rect.y+rect.height+padding:rect.y-padding,textBaseline=isPositive?"top":"bottom"):(x=isPositive?rect.x-padding:rect.x+rect.width+padding,textAlign=isPositive?"start":"end");break}case"outside":case"end":{isVertical?(y=isPositive?rect.y-padding:rect.y+rect.height+padding,textBaseline=isPositive?"bottom":"top"):(x=isPositive?rect.x+rect.width+padding:rect.x-padding,textAlign=isPositive?"start":"end");break}}return{x,y,textAlign,textBaseline}}__name(adjustLabelPlacement,"adjustLabelPlacement");var _a206,BarSeries=(_a206=class extends AbstractBarSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,pickModes:[3,0],pathsPerSeries:[],hasHighlightedLabels:!0,datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:resetBarSelectionsFn,label:resetLabelFn}}),this.properties=new BarSeriesProperties}crossFilteringEnabled(){return this.properties.yFilterKey!=null&&(this.seriesGrouping==null||this.seriesGrouping.stackIndex===0)}async processData(dataController){var _a274,_b,_c,_d;if(!this.properties.isValid()||!this.data)return;const{seriesGrouping:{groupIndex=this.id}={},data=[]}=this,{xKey,yKey,yFilterKey,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),xScale=(_a274=this.getCategoryAxis())==null?void 0:_a274.scale,yScale=(_b=this.getValueAxis())==null?void 0:_b.scale,{isContinuousX,xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),stackGroupName=`bar-stack-${groupIndex}-yValues`,stackGroupTrailingName=`${stackGroupName}-trailing`,extraProps=[];isFiniteNumber(normalizedTo)&&extraProps.push(normaliseGroupTo([stackGroupName,stackGroupTrailingName],Math.abs(normalizedTo),"range")),animationEnabled&&this.processedData&&extraProps.push(diff(this.processedData)),animationEnabled&&extraProps.push(animationValidation());const visibleProps=this.visible?{}:{forceValue:0},{processedData}=await this.requestDataModel(dataController,data,{props:[keyProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValue-raw",invalidValue:null,...visibleProps}),...this.crossFilteringEnabled()?[valueProperty(yFilterKey,yScaleType,{id:"yFilterValue",invalidValue:null,...visibleProps})]:[],...groupAccumulativeValueProperty(yKey,"normal","current",{id:"yValue-end",rangeId:"yValue-range",invalidValue:null,missingValue:0,groupId:stackGroupName,separateNegative:!0,...visibleProps},yScaleType),...groupAccumulativeValueProperty(yKey,"trailing","current",{id:"yValue-start",invalidValue:null,missingValue:0,groupId:stackGroupTrailingName,separateNegative:!0,...visibleProps},yScaleType),...isContinuousX?[SMALLEST_KEY_INTERVAL,LARGEST_KEY_INTERVAL]:[],...extraProps],groupByKeys:!0,groupByData:!1});this.smallestDataInterval=(_c=processedData.reduced)==null?void 0:_c.smallestKeyInterval,this.largestDataInterval=(_d=processedData.reduced)==null?void 0:_d.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(direction){const{processedData,dataModel}=this;if(!dataModel||!(processedData!=null&&processedData.data.length))return[];const keyDef=dataModel.resolveProcessedDataDefById(this,"xValue"),keys=dataModel.getDomain(this,"xValue","key",processedData);let yExtent=dataModel.getDomain(this,"yValue-end","value",processedData);const yFilterExtent=this.crossFilteringEnabled()?dataModel.getDomain(this,"yFilterValue","value",processedData):void 0;if(yFilterExtent!=null&&(yExtent=[Math.min(yExtent[0],yFilterExtent[0]),Math.max(yExtent[1],yFilterExtent[1])]),direction===this.getCategoryDirection())return(keyDef==null?void 0:keyDef.def.type)==="key"&&keyDef.def.valueType==="category"?keys:this.padBandExtent(keys);if(this.getValueAxis()instanceof LogAxis)return fixNumericExtent(yExtent);{const fixedYExtent=[Math.min(0,yExtent[0]),Math.max(0,yExtent[1])];return fixNumericExtent(fixedYExtent)}}async createNodeData(){const{dataModel}=this,xAxis=this.getCategoryAxis(),yAxis=this.getValueAxis();if(!dataModel||!xAxis||!yAxis||!this.properties.isValid())return;const xScale=xAxis.scale,yScale=yAxis.scale,{xKey,yKey,xName,yName,fill,stroke,strokeWidth,cornerRadius,legendItemName,label}=this.properties,yReversed=yAxis.isReversed(),{barWidth,groupIndex}=this.updateGroupScale(xAxis),barOffset=ContinuousScale.is(xScale)?barWidth*-.5:0,xIndex=dataModel.resolveProcessedDataIndexById(this,"xValue"),yRawIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-raw"),yFilterIndex=this.crossFilteringEnabled()?dataModel.resolveProcessedDataIndexById(this,"yFilterValue"):void 0,yStartIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-start"),yEndIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-end"),yRangeIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-range"),animationEnabled=!this.ctx.animationManager.isSkipped(),nodeDatum=__name(({datum,valueIndex,xValue,yValue,cumulativeValue,phantom,currY,prevY,isPositive,yRange,labelText,crossScale=1})=>{const x=xScale.convert(xValue),isUpward=isPositive!==yReversed,barX=x+groupScale.convert(String(groupIndex))+barOffset,y=yScale.convert(currY),bottomY=yScale.convert(prevY),barAlongX=this.getBarDirection()==="x",bboxHeight=yScale.convert(yRange),bboxBottom=yScale.convert(0),xOffset=barWidth*.5*(1-crossScale),rect={x:barAlongX?Math.min(y,bottomY):barX+xOffset,y:barAlongX?barX+xOffset:Math.min(y,bottomY),width:barAlongX?Math.abs(bottomY-y):barWidth*crossScale,height:barAlongX?barWidth*crossScale:Math.abs(bottomY-y)},clipBBox=new BBox(rect.x,rect.y,rect.width,rect.height),barRect={x:barAlongX?Math.min(bboxBottom,bboxHeight):barX+xOffset,y:barAlongX?barX+xOffset:Math.min(bboxBottom,bboxHeight),width:barAlongX?Math.abs(bboxBottom-bboxHeight):barWidth*crossScale,height:barAlongX?barWidth*crossScale:Math.abs(bboxBottom-bboxHeight)},{fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,color:labelColor,placement}=label,lengthRatioMultiplier=this.shouldFlipXY()?rect.height:rect.width;return{series:this,itemId:phantom?createDatumId(yKey,phantom):yKey,datum,valueIndex,cumulativeValue,phantom,xValue,yValue,yKey,xKey,capDefaults:{lengthRatioMultiplier,lengthMax:lengthRatioMultiplier},x:barRect.x,y:barRect.y,width:barRect.width,height:barRect.height,midPoint:{x:rect.x+rect.width/2,y:rect.y+rect.height/2},fill,stroke,opacity:1,strokeWidth,cornerRadius,topLeftCornerRadius:barAlongX!==isUpward,topRightCornerRadius:isUpward,bottomRightCornerRadius:barAlongX===isUpward,bottomLeftCornerRadius:!isUpward,clipBBox,label:labelText!=null?{text:labelText,fill:labelColor,fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,...adjustLabelPlacement({isPositive,isVertical:!barAlongX,placement,rect})}:void 0,missing:yValue==null,focusable:!phantom}},"nodeDatum"),{groupScale,processedData}=this,phantomNodes=[],nodes=[],labels=[];return processedData==null||processedData.data.forEach(({keys,datum:seriesDatum,values,aggValues})=>{values.forEach((value,valueIndex)=>{const xValue=keys[xIndex],yRawValue=value[yRawIndex],yStart=Number(value[yStartIndex]),yFilterValue=yFilterIndex!=null?Number(value[yFilterIndex]):void 0,yEnd=Number(value[yEndIndex]),isPositive=yRawValue>=0&&!Object.is(yRawValue,-0),yRange=(aggValues==null?void 0:aggValues[yRangeIndex][isPositive?1:0])??0;if(!Number.isFinite(yEnd)||yFilterValue!=null&&!Number.isFinite(yFilterValue))return;const labelText=yRawValue!=null?this.getLabelText(this.properties.label,{datum:seriesDatum[valueIndex],value:yFilterValue??yRawValue,xKey,yKey,xName,yName,legendItemName},v=>isFiniteNumber(v)?v.toFixed(2):String(v)):void 0,inset=yFilterValue!=null&&yFilterValue>yRawValue,nodeData=nodeDatum({datum:seriesDatum[valueIndex],valueIndex,xValue,yValue:yFilterValue??yRawValue,cumulativeValue:yFilterValue??yEnd,phantom:!1,currY:yFilterValue!=null?yStart+yFilterValue:yEnd,prevY:yStart,isPositive,yRange:Math.max(yStart+(yFilterValue??-1/0),yRange),labelText,crossScale:inset?.6:void 0});if(nodes.push(nodeData),labels.push(nodeData),yFilterValue!=null){const phantomNodeData=nodeDatum({datum:seriesDatum[valueIndex],valueIndex,xValue,yValue:yFilterValue,cumulativeValue:yFilterValue,phantom:!0,currY:yEnd,prevY:yStart,isPositive,yRange,labelText:void 0,crossScale:void 0});phantomNodes.push(phantomNodeData)}})}),{itemId:yKey,nodeData:phantomNodes.length>0?[...phantomNodes,...nodes]:nodes,labelData:labels,scales:this.calculateScaling(),visible:this.visible||animationEnabled}}nodeFactory(){return new Rect}getHighlightData(nodeData,highlightedItem){const highlightItem=nodeData.find(nodeDatum=>nodeDatum.datum===highlightedItem.datum&&!nodeDatum.phantom);return highlightItem!=null?[highlightItem]:void 0}async updateDatumSelection(opts){return opts.datumSelection.update(opts.nodeData,void 0,datum=>createDatumId(datum.xValue,datum.valueIndex,datum.phantom))}async updateDatumNodes(opts){if(!this.properties.isValid())return;const{yKey,stackGroup,fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,itemStyler,shadow,highlightStyle:{item:itemHighlightStyle}}=this.properties,xAxis=this.axes.x,crisp=this.properties.crisp??checkCrisp(xAxis==null?void 0:xAxis.scale,xAxis==null?void 0:xAxis.visibleRange,this.smallestDataInterval,this.largestDataInterval),categoryAlongX=this.getCategoryDirection()==="x",style={fill,stroke,lineDash,lineDashOffset,fillShadow:shadow,strokeWidth:this.getStrokeWidth(strokeWidth),fillOpacity:0,strokeOpacity:0},rectParams={datum:void 0,ctx:this.ctx,seriesId:this.id,isHighlighted:opts.isHighlight,highlightStyle:itemHighlightStyle,yKey,style,itemStyler,stackGroup};opts.datumSelection.each((rect,datum)=>{var _a274,_b;style.fillOpacity=fillOpacity*(datum.phantom?.2:1),style.strokeOpacity=strokeOpacity*(datum.phantom?.2:1),style.cornerRadius=datum.cornerRadius,style.topLeftCornerRadius=datum.topLeftCornerRadius,style.topRightCornerRadius=datum.topRightCornerRadius,style.bottomRightCornerRadius=datum.bottomRightCornerRadius,style.bottomLeftCornerRadius=datum.bottomLeftCornerRadius;const visible=categoryAlongX?(((_a274=datum.clipBBox)==null?void 0:_a274.width)??datum.width)>0:(((_b=datum.clipBBox)==null?void 0:_b.height)??datum.height)>0;rectParams.datum=datum;const config=getRectConfig(rectParams);config.crisp=crisp,config.visible=visible,updateRect(rect,config)})}async updateLabelSelection(opts){const data=this.isLabelEnabled()?opts.labelData:[];return opts.labelSelection.update(data,text=>{text.pointerEvents=1})}async updateLabelNodes(opts){opts.labelSelection.each((textNode,datum)=>{updateLabelNode(textNode,this.properties.label,datum.label)})}getTooltipHtml(nodeDatum){const{id:seriesId,processedData,ctx:{callbackCache}}=this,xAxis=this.getCategoryAxis(),yAxis=this.getValueAxis();if(!processedData||!this.properties.isValid()||!xAxis||!yAxis)return EMPTY_TOOLTIP_CONTENT;const{xKey,yKey,xName,yName,fill,stroke,strokeWidth,tooltip,itemStyler,stackGroup,legendItemName}=this.properties,{xValue,yValue,datum,itemId}=nodeDatum,xString=xAxis.formatDatum(xValue),yString=yAxis.formatDatum(yValue),title=sanitizeHtml(yName),content=sanitizeHtml(xString+": "+yString);let format;itemStyler&&(format=callbackCache.call(itemStyler,{seriesId,datum,xKey,yKey,stackGroup,fill,stroke,strokeWidth:this.getStrokeWidth(strokeWidth),highlighted:!1,cornerRadius:this.properties.cornerRadius,fillOpacity:this.properties.fillOpacity,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash??[],lineDashOffset:this.properties.lineDashOffset}));const color=(format==null?void 0:format.fill)??fill;return tooltip.toTooltipHtml({title,content,backgroundColor:color},{seriesId,itemId,datum,xKey,yKey,xName,yName,stackGroup,title,color,legendItemName,...this.getModuleTooltipParams()})}getLegendData(legendType){var _a274;const{showInLegend}=this.properties;if(legendType!=="category"||!((_a274=this.data)!=null&&_a274.length)||!this.properties.isValid()||!showInLegend)return[];const{yKey,yName,fill,stroke,strokeWidth,fillOpacity,strokeOpacity,legendItemName,visible}=this.properties;return[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:legendItemName??yName??yKey},symbols:[{marker:{fill,fillOpacity,stroke,strokeWidth,strokeOpacity}}],legendItemName}]}animateEmptyUpdateReady({datumSelection,labelSelection,annotationSelections}){const fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(this.isVertical(),this.axes,"normal"));fromToMotion(this.id,"nodes",this.ctx.animationManager,[datumSelection],fns),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,...annotationSelections)}animateWaitingUpdateReady(data){var _a274,_b;const{datumSelection,labelSelection,annotationSelections,previousContextData}=data;this.ctx.animationManager.stopByAnimationGroupId(this.id);const dataDiff=(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.diff,mode=previousContextData==null?"fade":"normal",fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(this.isVertical(),this.axes,mode));fromToMotion(this.id,"nodes",this.ctx.animationManager,[datumSelection],fns,(_,datum)=>createDatumId(datum.xValue,datum.valueIndex,datum.phantom),dataDiff),((dataDiff==null?void 0:dataDiff.changed)??!0)&&(seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,...annotationSelections))}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex,seriesRect}){var _a274;const datumBox=(_a274=this.contextNodeData)==null?void 0:_a274.nodeData[datumIndex].clipBBox;return computeBarFocusBounds(datumBox,this.contentGroup,seriesRect)}},__name(_a206,"BarSeries"),_a206);BarSeries.className="BarSeries";BarSeries.type="bar";var BarSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bar",moduleFactory:__name(ctx=>new BarSeries(ctx),"moduleFactory"),stackable:!0,groupable:!0,tooltipDefaults:{range:"exact"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],swapDefaultAxesCondition:__name(series=>(series==null?void 0:series.direction)==="horizontal","swapDefaultAxesCondition"),themeTemplate:{series:{direction:"vertical",fillOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontWeight:"normal",fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR,placement:"inside"},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},errorBar:{cap:{lengthRatio:.3}}}},paletteFactory:singleSeriesPaletteFactory},_a207,BubbleSeriesMarker=(_a207=class extends SeriesMarker{constructor(){super(...arguments),this.maxSize=30}},__name(_a207,"BubbleSeriesMarker"),_a207);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],BubbleSeriesMarker.prototype,"maxSize",2);__decorateClass([Validate(NUMBER_ARRAY,{optional:!0}),SceneChangeDetection({redraw:3})],BubbleSeriesMarker.prototype,"domain",2);var _a208,BubbleSeriesLabel=(_a208=class extends Label{constructor(){super(...arguments),this.placement="top"}},__name(_a208,"BubbleSeriesLabel"),_a208);__decorateClass([Validate(LABEL_PLACEMENT)],BubbleSeriesLabel.prototype,"placement",2);var _a209,BubbleSeriesProperties=(_a209=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.colorRange=["#ffff00","#00ff00","#0000ff"],this.label=new BubbleSeriesLabel,this.tooltip=new SeriesTooltip,this.marker=new BubbleSeriesMarker}},__name(_a209,"BubbleSeriesProperties"),_a209);__decorateClass([Validate(STRING)],BubbleSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING)],BubbleSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING)],BubbleSeriesProperties.prototype,"sizeKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"labelKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"colorKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"xFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"yFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"sizeFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"sizeName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"labelName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"colorName",2);__decorateClass([Validate(NUMBER_ARRAY,{optional:!0})],BubbleSeriesProperties.prototype,"colorDomain",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],BubbleSeriesProperties.prototype,"colorRange",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"title",2);__decorateClass([ProxyProperty("marker.shape")],BubbleSeriesProperties.prototype,"shape",2);__decorateClass([ProxyProperty("marker.size")],BubbleSeriesProperties.prototype,"size",2);__decorateClass([ProxyProperty("marker.maxSize")],BubbleSeriesProperties.prototype,"maxSize",2);__decorateClass([ProxyProperty("marker.domain",{optional:!0})],BubbleSeriesProperties.prototype,"domain",2);__decorateClass([ProxyProperty("marker.fill",{optional:!0})],BubbleSeriesProperties.prototype,"fill",2);__decorateClass([ProxyProperty("marker.fillOpacity")],BubbleSeriesProperties.prototype,"fillOpacity",2);__decorateClass([ProxyProperty("marker.stroke",{optional:!0})],BubbleSeriesProperties.prototype,"stroke",2);__decorateClass([ProxyProperty("marker.strokeWidth")],BubbleSeriesProperties.prototype,"strokeWidth",2);__decorateClass([ProxyProperty("marker.strokeOpacity")],BubbleSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([ProxyProperty("marker.itemStyler",{optional:!0})],BubbleSeriesProperties.prototype,"itemStyler",2);__decorateClass([Validate(OBJECT)],BubbleSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],BubbleSeriesProperties.prototype,"tooltip",2);var _a210,BubbleSeriesNodeEvent=(_a210=class extends CartesianSeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.sizeKey=series.properties.sizeKey}},__name(_a210,"BubbleSeriesNodeEvent"),_a210),_a211,BubbleSeries=(_a211=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,pickModes:[2,3,0],pathsPerSeries:[],hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{label:resetLabelFn,marker:resetMarkerFn}}),this.NodeEvent=BubbleSeriesNodeEvent,this.properties=new BubbleSeriesProperties,this.sizeScale=new LinearScale,this.colorScale=new ColorScale}async processData(dataController){var _a274,_b;if(!this.properties.isValid()||this.data==null||!this.visible)return;const xScale=(_a274=this.axes.x)==null?void 0:_a274.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),colorScaleType=this.colorScale.type,sizeScaleType=this.sizeScale.type,{xKey,yKey,sizeKey,xFilterKey,yFilterKey,sizeFilterKey,labelKey,colorDomain,colorRange,colorKey,marker}=this.properties,{dataModel,processedData}=await this.requestDataModel(dataController,this.data,{props:[keyProperty(xKey,xScaleType,{id:"xKey-raw"}),keyProperty(yKey,yScaleType,{id:"yKey-raw"}),...labelKey?[keyProperty(labelKey,"band",{id:"labelKey-raw"})]:[],valueProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValue"}),...xFilterKey!=null?[valueProperty(xFilterKey,xScaleType,{id:"xFilterValue"})]:[],...yFilterKey!=null?[valueProperty(yFilterKey,yScaleType,{id:"yFilterValue"})]:[],...sizeFilterKey!=null?[valueProperty(sizeFilterKey,sizeScaleType,{id:"sizeFilterValue"})]:[],valueProperty(sizeKey,sizeScaleType,{id:"sizeValue"}),...colorKey?[valueProperty(colorKey,colorScaleType,{id:"colorValue"})]:[],...labelKey?[valueProperty(labelKey,"band",{id:"labelValue"})]:[]]}),sizeKeyIdx=dataModel.resolveProcessedDataIndexById(this,"sizeValue"),processedSize=processedData.domain.values[sizeKeyIdx]??[];if(this.sizeScale.domain=marker.domain?marker.domain:processedSize,colorKey){const colorKeyIdx=dataModel.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=colorDomain??processedData.domain.values[colorKeyIdx]??[],this.colorScale.range=colorRange,this.colorScale.update()}this.animationState.transition("updateData")}getSeriesDomain(direction){const{dataModel,processedData}=this;if(!processedData||!dataModel)return[];const id=direction==="x"?"xValue":"yValue",dataDef=dataModel.resolveProcessedDataDefById(this,id),domain=dataModel.getDomain(this,id,"value",processedData);return(dataDef==null?void 0:dataDef.def.type)==="value"&&(dataDef==null?void 0:dataDef.def.valueType)==="category"?domain:fixNumericExtent(extent(domain))}async createNodeData(){const{axes,dataModel,processedData,colorScale,sizeScale}=this,{xKey,yKey,sizeKey,xFilterKey,yFilterKey,sizeFilterKey,labelKey,xName,yName,sizeName,labelName,label,colorKey,marker,visible}=this.properties,markerShape=getMarker(marker.shape),{placement}=label,xAxis=axes.x,yAxis=axes.y;if(!(dataModel&&processedData&&visible&&xAxis&&yAxis))return;const xDataIdx=dataModel.resolveProcessedDataIndexById(this,"xValue"),yDataIdx=dataModel.resolveProcessedDataIndexById(this,"yValue"),sizeDataIdx=sizeKey!=null?dataModel.resolveProcessedDataIndexById(this,"sizeValue"):void 0,colorDataIdx=colorKey!=null?dataModel.resolveProcessedDataIndexById(this,"colorValue"):-1,labelDataIdx=labelKey!=null?dataModel.resolveProcessedDataIndexById(this,"labelValue"):-1,xFilterDataIdx=xFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"xFilterValue"):void 0,yFilterDataIdx=yFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"yFilterValue"):void 0,sizeFilterDataIdx=sizeFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"sizeFilterValue"):void 0,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=(xScale.bandwidth??0)/2,yOffset=(yScale.bandwidth??0)/2,nodeData=[];sizeScale.range=[marker.size,marker.maxSize];const font=label.getFont(),textMeasurer=CachedTextMeasurerPool.getMeasurer({font});for(const{values,datum}of processedData.data??[]){const xDatum=values[xDataIdx],yDatum=values[yDataIdx],sizeValue=sizeDataIdx!=null?values[sizeDataIdx]:void 0,x=xScale.convert(xDatum)+xOffset,y=yScale.convert(yDatum)+yOffset;let selected;xFilterDataIdx!=null&&yFilterDataIdx!=null&&(selected=values[xFilterDataIdx]===xDatum&&values[yFilterDataIdx]===yDatum,sizeFilterDataIdx!=null&&selected&&(selected=values[sizeFilterDataIdx]===sizeValue));const labelText=this.getLabelText(label,{value:labelKey?values[labelDataIdx]:yDatum,datum,xKey,yKey,sizeKey,labelKey,xName,yName,sizeName,labelName}),size=textMeasurer.measureText(String(labelText)),markerSize=sizeValue?sizeScale.convert(sizeValue):marker.size,fill=colorKey?colorScale.convert(values[colorDataIdx]):void 0;nodeData.push({series:this,itemId:yKey,yKey,xKey,datum,xValue:xDatum,yValue:yDatum,sizeValue,point:{x,y,size:markerSize},midPoint:{x,y},fill,label:{text:labelText,...size},marker:markerShape,placement,selected})}return{itemId:yKey,nodeData,labelData:nodeData,scales:this.calculateScaling(),visible:this.visible}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var _a274;return((_a274=this.contextNodeData)==null?void 0:_a274.labelData)??[]}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}async updateMarkerSelection(opts){const{nodeData,markerSelection}=opts;this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup());const data=this.properties.marker.enabled?nodeData:[];return markerSelection.update(data,void 0,datum=>createDatumId([datum.xValue,datum.yValue,datum.label.text]))}async updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,sizeKey,labelKey,marker}=this.properties,{size,shape,fill,fillOpacity,stroke,strokeWidth,strokeOpacity}=mergeDefaults(highlighted&&this.properties.highlightStyle.item,marker.getStyle()),baseStyle={size,shape,fill,fillOpacity,stroke,strokeWidth,strokeOpacity};this.sizeScale.range=[marker.size,marker.maxSize],markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey,sizeKey,labelKey},baseStyle,{selected:datum.selected})}),highlighted||this.properties.marker.markClean()}async updateLabelSelection(opts){var _a274;const placedLabels=this.properties.label.enabled?((_a274=this.chart)==null?void 0:_a274.placeLabels().get(this))??[]:[];return opts.labelSelection.update(placedLabels.map(v=>({...v.datum,point:{x:v.x,y:v.y,size:v.datum.point.size}})))}async updateLabelNodes(opts){const{label}=this.properties;opts.labelSelection.each((text,datum)=>{var _a274,_b;text.text=datum.label.text,text.fill=label.color,text.x=((_a274=datum.point)==null?void 0:_a274.x)??0,text.y=((_b=datum.point)==null?void 0:_b.y)??0,text.fontStyle=label.fontStyle,text.fontWeight=label.fontWeight,text.fontSize=label.fontSize,text.fontFamily=label.fontFamily,text.textAlign="left",text.textBaseline="top"})}getTooltipHtml(nodeDatum){const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return EMPTY_TOOLTIP_CONTENT;const{xKey,yKey,sizeKey,labelKey,xName,yName,sizeName,labelName,marker,tooltip}=this.properties,title=this.properties.title??yName,baseStyle=mergeDefaults({fill:nodeDatum.fill,strokeWidth:this.getStrokeWidth(marker.strokeWidth)},marker.getStyle()),{fill:color="gray"}=this.getMarkerStyle(marker,{datum:nodeDatum,highlighted:!1,xKey,yKey,sizeKey,labelKey},baseStyle),{datum,xValue,yValue,sizeValue,label:{text:labelText},itemId}=nodeDatum,xString=sanitizeHtml(xAxis.formatDatum(xValue)),yString=sanitizeHtml(yAxis.formatDatum(yValue));let content=`<b>${sanitizeHtml(xName??xKey)}</b>: ${xString}<br><b>${sanitizeHtml(yName??yKey)}</b>: ${yString}`;return sizeKey&&(content+=`<br><b>${sanitizeHtml(sizeName??sizeKey)}</b>: ${sanitizeHtml(String(sizeValue))}`),labelKey&&(content=`<b>${sanitizeHtml(labelName??labelKey)}</b>: ${sanitizeHtml(labelText)}<br>`+content),tooltip.toTooltipHtml({title,content,backgroundColor:color},{datum,itemId,xKey,xName,yKey,yName,sizeKey,sizeName,labelKey,labelName,title,color,seriesId:this.id})}getLegendData(){var _a274;if(!((_a274=this.data)!=null&&_a274.length)||!this.properties.isValid())return[];const{yKey,yName,title,marker,visible}=this.properties,{shape,fill,stroke,fillOpacity,strokeOpacity,strokeWidth}=marker;return[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:title??yName??yKey},symbols:[{marker:{shape,fill:fill??"rgba(0, 0, 0, 0)",stroke:stroke??"rgba(0, 0, 0, 0)",fillOpacity:fillOpacity??1,strokeOpacity:strokeOpacity??1,strokeWidth:strokeWidth??0}}]}]}animateEmptyUpdateReady({markerSelection,labelSelection}){markerScaleInAnimation(this,this.ctx.animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey,sizeKey,labelKey}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum,xKey,yKey,sizeKey,labelKey,highlighted:!1})}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a211,"BubbleSeries"),_a211);BubbleSeries.className="BubbleSeries";BubbleSeries.type="bubble";var BubbleSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bubble",moduleFactory:__name(ctx=>new BubbleSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,maxSize:30,fillOpacity:.8,tooltip:{position:{type:"node"}},label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR}}},paletteFactory:singleSeriesPaletteFactory},_a212,HistogramSeriesProperties=(_a212=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.areaPlot=!1,this.aggregation="sum",this.shadow=new DropShadow,this.label=new Label,this.tooltip=new SeriesTooltip}},__name(_a212,"HistogramSeriesProperties"),_a212);__decorateClass([Validate(STRING)],HistogramSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING,{optional:!0})],HistogramSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],HistogramSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],HistogramSeriesProperties.prototype,"yName",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],HistogramSeriesProperties.prototype,"fill",2);__decorateClass([Validate(RATIO)],HistogramSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],HistogramSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],HistogramSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],HistogramSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],HistogramSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],HistogramSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(POSITIVE_NUMBER)],HistogramSeriesProperties.prototype,"cornerRadius",2);__decorateClass([Validate(BOOLEAN)],HistogramSeriesProperties.prototype,"areaPlot",2);__decorateClass([Validate(ARRAY,{optional:!0})],HistogramSeriesProperties.prototype,"bins",2);__decorateClass([Validate(UNION(["count","sum","mean"],"a histogram aggregation"))],HistogramSeriesProperties.prototype,"aggregation",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],HistogramSeriesProperties.prototype,"binCount",2);__decorateClass([Validate(OBJECT)],HistogramSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],HistogramSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],HistogramSeriesProperties.prototype,"tooltip",2);var defaultBinCount=10,_a213,HistogramSeries=(_a213=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,pickModes:[3,0],datumSelectionGarbageCollection:!1,animationResetFns:{datum:resetBarSelectionsFn,label:resetLabelFn}}),this.properties=new HistogramSeriesProperties,this.calculatedBins=[]}deriveBins(xDomain){const binStarts=createTicks(xDomain[0],xDomain[1],defaultBinCount),binSize=tickStep(xDomain[0],xDomain[1],defaultBinCount),[firstBinEnd]=binStarts,expandStartToBin=__name(n=>[n,n+binSize],"expandStartToBin");return[[firstBinEnd-binSize,firstBinEnd],...binStarts.map(expandStartToBin)]}calculateNiceBins(domain,binCount){const startGuess=Math.floor(domain[0]),stop=domain[1],segments=binCount||1,{start,binSize}=this.calculateNiceStart(startGuess,stop,segments);return this.getBins(start,stop,binSize,segments)}getBins(start,stop,step,count){const bins=[],precision=this.calculatePrecision(step);for(let i=0;i<count;i++){const a=Math.round((start+i*step)*precision)/precision;let b=Math.round((start+(i+1)*step)*precision)/precision;i===count-1&&(b=Math.max(b,stop)),bins[i]=[a,b]}return bins}calculatePrecision(step){let precision=10;if(isFinite(step)&&step>0)for(;step<1;)precision*=10,step*=10;return precision}calculateNiceStart(a,b,segments){const binSize=Math.abs(b-a)/segments,order=Math.floor(Math.log10(binSize)),magnitude=Math.pow(10,order);return{start:Math.floor(a/magnitude)*magnitude,binSize}}async processData(dataController){var _a274,_b;this.visible||(this.processedData=void 0,this.animationState.transition("updateData"));const{xKey,yKey,areaPlot,aggregation}=this.properties,xScale=(_a274=this.axes.x)==null?void 0:_a274.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({yScale,xScale}),props=[keyProperty(xKey,xScaleType),SORT_DOMAIN_GROUPS];if(yKey){let aggProp=groupCount("groupAgg");aggregation==="count"||(aggregation==="sum"?aggProp=groupSum("groupAgg"):aggregation==="mean"&&(aggProp=groupAverage("groupAgg"))),areaPlot&&(aggProp=area("groupAgg",aggProp)),props.push(valueProperty(yKey,yScaleType,{invalidValue:void 0}),aggProp)}else{let aggProp=groupCount("groupAgg");areaPlot&&(aggProp=area("groupAgg",aggProp)),props.push(aggProp)}const groupByFn=__name(dataSet=>{const xExtent=fixNumericExtent(dataSet.domain.keys[0]);if(xExtent.length===0)return dataSet.domain.groups=[],()=>[];const bins=isNumber(this.properties.binCount)?this.calculateNiceBins(xExtent,this.properties.binCount):this.properties.bins??this.deriveBins(xExtent),binCount=bins.length;return this.calculatedBins=[...bins],item=>{const xValue=item.keys[0];for(let i=0;i<binCount;i++){const nextBin=bins[i];if(xValue>=nextBin[0]&&xValue<nextBin[1]||i===binCount-1&&xValue<=nextBin[1])return nextBin}return[]}},"groupByFn");!this.ctx.animationManager.isSkipped()&&this.processedData&&props.push(diff(this.processedData,!1)),await this.requestDataModel(dataController,this.data,{props,groupByFn}),this.animationState.transition("updateData")}getSeriesDomain(direction){var _a274,_b,_c;const{processedData,dataModel}=this;if(!processedData||!dataModel||!this.calculatedBins.length)return[];const yDomain=dataModel.getDomain(this,"groupAgg","aggregate",processedData),xDomainMin=(_a274=this.calculatedBins)==null?void 0:_a274[0][0],xDomainMax=(_c=this.calculatedBins)==null?void 0:_c[(((_b=this.calculatedBins)==null?void 0:_b.length)??0)-1][1];return fixNumericExtent(direction==="x"?[xDomainMin,xDomainMax]:yDomain)}async createNodeData(){const{id:seriesId,axes,processedData,ctx:{callbackCache}}=this,xAxis=axes.x,yAxis=axes.y;if(!xAxis||!yAxis)return;const{scale:xScale}=xAxis,{scale:yScale}=yAxis,{xKey,yKey,xName,yName,fill,stroke,strokeWidth,cornerRadius}=this.properties,{formatter:labelFormatter=__name(params=>String(params.value),"labelFormatter"),fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,color:labelColor}=this.properties.label,nodeData=[],context={itemId:this.properties.yKey??this.id,nodeData,labelData:nodeData,scales:this.calculateScaling(),animationValid:!0,visible:this.visible};return!this.visible||!processedData||processedData.type!=="grouped"||(processedData.data.forEach(group=>{const{aggValues:[[negativeAgg,positiveAgg]]=[[0,0]],datum,datum:{length:frequency},keys:domain,keys:[xDomainMin,xDomainMax]}=group,xMinPx=xScale.convert(xDomainMin),xMaxPx=xScale.convert(xDomainMax),total=negativeAgg+positiveAgg,yZeroPx=yScale.convert(0),yMaxPx=yScale.convert(total),w=Math.abs(xMaxPx-xMinPx),h=Math.abs(yMaxPx-yZeroPx),x=Math.min(xMinPx,xMaxPx),y=Math.min(yZeroPx,yMaxPx);let selectionDatumLabel;total!==0&&(selectionDatumLabel={text:callbackCache.call(labelFormatter,{value:total,datum,seriesId,xKey,yKey,xName,yName})??String(total),fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,fill:labelColor,x:x+w/2,y:y+h/2});const nodeMidPoint={x:x+w/2,y:y+h/2},yAxisReversed=yAxis.isReversed();nodeData.push({series:this,datum,aggregatedValue:total,frequency,domain,yKey,xKey,x,y,xValue:xMinPx,yValue:yMaxPx,width:w,height:h,midPoint:nodeMidPoint,fill,stroke,cornerRadius,topLeftCornerRadius:!yAxisReversed,topRightCornerRadius:!yAxisReversed,bottomRightCornerRadius:yAxisReversed,bottomLeftCornerRadius:yAxisReversed,opacity:1,strokeWidth,label:selectionDatumLabel})}),nodeData.sort((a,b)=>a.x-b.x)),context}nodeFactory(){return new Rect}async updateDatumSelection(opts){const{nodeData,datumSelection}=opts;return datumSelection.update(nodeData,rect=>{rect.crisp=!0},datum=>datum.domain.join("_"))}async updateDatumNodes(opts){const{isHighlight:isDatumHighlighted}=opts,{fillOpacity:seriesFillOpacity,strokeOpacity,lineDash,lineDashOffset,shadow,highlightStyle:{item:{fill:highlightedFill,fillOpacity:highlightFillOpacity=seriesFillOpacity,stroke:highlightedStroke,strokeWidth:highlightedDatumStrokeWidth}}}=this.properties;opts.datumSelection.each((rect,datum,index)=>{const{cornerRadius,topLeftCornerRadius,topRightCornerRadius,bottomRightCornerRadius,bottomLeftCornerRadius}=datum,strokeWidth=isDatumHighlighted&&highlightedDatumStrokeWidth!==void 0?highlightedDatumStrokeWidth:datum.strokeWidth,fillOpacity=isDatumHighlighted?highlightFillOpacity:seriesFillOpacity;rect.fill=(isDatumHighlighted?highlightedFill:void 0)??datum.fill,rect.stroke=(isDatumHighlighted?highlightedStroke:void 0)??datum.stroke,rect.fillOpacity=fillOpacity,rect.strokeOpacity=strokeOpacity,rect.strokeWidth=strokeWidth,rect.lineDash=lineDash,rect.lineDashOffset=lineDashOffset,rect.topLeftCornerRadius=topLeftCornerRadius?cornerRadius:0,rect.topRightCornerRadius=topRightCornerRadius?cornerRadius:0,rect.bottomRightCornerRadius=bottomRightCornerRadius?cornerRadius:0,rect.bottomLeftCornerRadius=bottomLeftCornerRadius?cornerRadius:0,rect.fillShadow=shadow,rect.zIndex=isDatumHighlighted?Series.highlightedZIndex:index,rect.visible=datum.height>0})}async updateLabelSelection(opts){const{labelData,labelSelection}=opts;return labelSelection.update(labelData,text=>{text.pointerEvents=1,text.textAlign="center",text.textBaseline="middle"})}async updateLabelNodes(opts){const labelEnabled=this.isLabelEnabled();opts.labelSelection.each((text,datum)=>{const label=datum.label;label&&labelEnabled?(text.text=label.text,text.x=label.x,text.y=label.y,text.fontStyle=label.fontStyle,text.fontWeight=label.fontWeight,text.fontSize=label.fontSize,text.fontFamily=label.fontFamily,text.fill=label.fill,text.visible=!0):text.visible=!1})}initQuadTree(quadtree){addHitTestersToQuadtree(quadtree,childrenIter(this.contentGroup.children[0]))}pickNodeClosestDatum(point){return findQuadtreeMatch(this,point)}getTooltipHtml(nodeDatum){const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return EMPTY_TOOLTIP_CONTENT;const{xKey,yKey,xName,yName,fill:color,aggregation,tooltip}=this.properties,{aggregatedValue,frequency,domain:[rangeMin,rangeMax],itemId}=nodeDatum,title=`${sanitizeHtml(xName??xKey)}: ${xAxis.formatDatum(rangeMin)} - ${xAxis.formatDatum(rangeMax)}`;let content=yKey?`<b>${sanitizeHtml(yName??yKey)} (${aggregation})</b>: ${yAxis.formatDatum(aggregatedValue)}<br>`:"";content+=`<b>Frequency</b>: ${frequency}`;const defaults={title,backgroundColor:color,content};return tooltip.toTooltipHtml(defaults,{datum:{data:nodeDatum.datum,aggregatedValue:nodeDatum.aggregatedValue,domain:nodeDatum.domain,frequency:nodeDatum.frequency},itemId,xKey,xName,yKey,yName,color,title,seriesId:this.id})}getLegendData(legendType){var _a274;if(!((_a274=this.data)!=null&&_a274.length)||legendType!=="category")return[];const{xKey,yName,fill,fillOpacity,stroke,strokeWidth,strokeOpacity,visible}=this.properties;return[{legendType:"category",id:this.id,itemId:xKey,seriesId:this.id,enabled:visible,label:{text:yName??xKey??"Frequency"},symbols:[{marker:{fill:fill??"rgba(0, 0, 0, 0)",stroke:stroke??"rgba(0, 0, 0, 0)",fillOpacity,strokeOpacity,strokeWidth}}]}]}animateEmptyUpdateReady({datumSelection,labelSelection}){const fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(!0,this.axes,"normal"));fromToMotion(this.id,"datums",this.ctx.animationManager,[datumSelection],fns),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection)}animateWaitingUpdateReady(data){var _a274,_b;const dataDiff=(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.diff,fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(!0,this.axes,"normal"));fromToMotion(this.id,"datums",this.ctx.animationManager,[data.datumSelection],fns,(_,datum)=>createDatumId(datum.domain),dataDiff),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,data.labelSelection)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex,seriesRect}){var _a274;return computeBarFocusBounds((_a274=this.contextNodeData)==null?void 0:_a274.nodeData[datumIndex],this.contentGroup,seriesRect)}},__name(_a213,"HistogramSeries"),_a213);HistogramSeries.className="HistogramSeries";HistogramSeries.type="histogram";var HistogramSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"histogram",moduleFactory:__name(ctx=>new HistogramSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"exact"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{strokeWidth:1,fillOpacity:1,strokeOpacity:1,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5}}},paletteFactory:__name(({takeColors})=>{const{fills:[fill],strokes:[stroke]}=takeColors(1);return{fill,stroke}},"paletteFactory")},_a214,LineSeriesProperties=(_a214=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new InterpolationProperties,this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip,this.connectMissingData=!1}},__name(_a214,"LineSeriesProperties"),_a214);__decorateClass([Validate(STRING)],LineSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING)],LineSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"yFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"stackGroup",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LineSeriesProperties.prototype,"normalizedTo",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"title",2);__decorateClass([Validate(COLOR_STRING)],LineSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],LineSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],LineSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],LineSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],LineSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"interpolation",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"marker",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"tooltip",2);__decorateClass([Validate(BOOLEAN)],LineSeriesProperties.prototype,"connectMissingData",2);var CROSS_FILTER_LINE_STROKE_OPACITY_FACTOR=.25,_a215,LineSeries=(_a215=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,hasMarkers:!0,pickModes:[2,3,0],markerSelectionGarbageCollection:!1,animationResetFns:{path:buildResetPathFn({getVisible:__name(()=>this.visible,"getVisible"),getOpacity:__name(()=>this.getOpacity(),"getOpacity")}),label:resetLabelFn,marker:__name((node,datum)=>({...resetMarkerFn(),...resetMarkerPositionFn(node,datum)}),"marker")}}),this.properties=new LineSeriesProperties}async processData(dataController){var _a274,_b;if(this.data==null||!this.properties.isValid())return;const{data,visible,seriesGrouping:{groupIndex=this.id,stackCount=1}={}}=this,{xKey,yKey,yFilterKey,connectMissingData,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),xScale=(_a274=this.axes.x)==null?void 0:_a274.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{isContinuousX,xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),common={invalidValue:null};connectMissingData&&stackCount>1&&(common.invalidValue=0),visible||(common.forceValue=0);const props=[];if(isContinuousX||props.push(keyProperty(xKey,xScaleType,{id:"xKey"})),props.push(valueProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValueRaw",...common,invalidValue:void 0})),yFilterKey!=null&&props.push(valueProperty(yFilterKey,yScaleType,{id:"yFilterRaw"})),stackCount>1){const ids=[`line-stack-${groupIndex}-yValues`,`line-stack-${groupIndex}-yValues-trailing`,`line-stack-${groupIndex}-yValues-marker`];props.push(...groupAccumulativeValueProperty(yKey,"window","current",{id:"yValueEnd",...common,groupId:ids[0]},yScaleType),...groupAccumulativeValueProperty(yKey,"window-trailing","current",{id:"yValueStart",...common,groupId:ids[1]},yScaleType),...groupAccumulativeValueProperty(yKey,"normal","current",{id:"yValueCumulative",...common,groupId:ids[2]},yScaleType)),isDefined(normalizedTo)&&props.push(normaliseGroupTo([ids[0],ids[1],ids[2]],normalizedTo,"range"))}animationEnabled&&(props.push(animationValidation(isContinuousX?["xValue"]:void 0)),this.processedData&&props.push(diff(this.processedData))),await this.requestDataModel(dataController,data,{props}),this.animationState.transition("updateData")}getSeriesDomain(direction){var _a274;const{dataModel,processedData}=this;if(!dataModel||!(processedData!=null&&processedData.data.length))return[];const xDef=dataModel.resolveProcessedDataDefById(this,"xValue");if(direction==="x"){const domain=dataModel.getDomain(this,"xValue","value",processedData);return(xDef==null?void 0:xDef.def.type)==="value"&&xDef.def.valueType==="category"?domain:fixNumericExtent(extent(domain))}else{const domain=(((_a274=this.seriesGrouping)==null?void 0:_a274.stackCount)??1)>1?dataModel.getDomain(this,"yValueEnd","value",processedData):dataModel.getDomain(this,"yValueRaw","value",processedData);return fixNumericExtent(domain)}}async createNodeData(){var _a274,_b;const{processedData,dataModel,axes}=this,xAxis=axes.x,yAxis=axes.y;if(!processedData||!dataModel||!xAxis||!yAxis)return;const{xKey,yKey,yFilterKey,xName,yName,marker,label,connectMissingData,legendItemName}=this.properties,stacked=(((_a274=this.seriesGrouping)==null?void 0:_a274.stackCount)??1)>1,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=(xScale.bandwidth??0)/2,yOffset=(yScale.bandwidth??0)/2,nodeData=[],size=marker.enabled?marker.size:0,xIdx=dataModel.resolveProcessedDataIndexById(this,"xValue"),yIdx=dataModel.resolveProcessedDataIndexById(this,"yValueRaw"),ySelectionIdx=yFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"yFilterRaw"):void 0,yCumulativeIdx=stacked?dataModel.resolveProcessedDataIndexById(this,"yValueCumulative"):yIdx,yEndIdx=stacked?dataModel.resolveProcessedDataIndexById(this,"yValueEnd"):void 0;let moveTo=!0,crossFiltering=!1;return(_b=processedData.data)==null||_b.forEach(({datum,values})=>{const xDatum=values[xIdx],yDatum=values[yIdx],yCumulativeDatum=values[yCumulativeIdx],yEndDatum=yEndIdx!=null?values[yEndIdx]:void 0;if(yDatum==null){moveTo||(moveTo=!connectMissingData);return}const x=xScale.convert(xDatum)+xOffset;if(isNaN(x)){moveTo||(moveTo=!connectMissingData);return}const y=yScale.convert(yCumulativeDatum)+yOffset,selected=ySelectionIdx!=null?values[ySelectionIdx]===yDatum:void 0;selected===!1&&(crossFiltering=!0);const labelText=this.getLabelText(label,{value:yDatum,datum,xKey,yKey,xName,yName,legendItemName},value=>isFiniteNumber(value)?value.toFixed(2):String(value));nodeData.push({series:this,datum,yKey,xKey,point:{x,y,moveTo,size},midPoint:{x,y},cumulativeValue:yEndDatum,yValue:yDatum,xValue:xDatum,capDefaults:{lengthRatioMultiplier:this.properties.marker.getDiameter(),lengthMax:1/0},label:labelText?{text:labelText,fontStyle:label.fontStyle,fontWeight:label.fontWeight,fontSize:label.fontSize,fontFamily:label.fontFamily,textAlign:"center",textBaseline:"bottom",fill:label.color}:void 0,selected}),moveTo=!1}),{itemId:yKey,nodeData,labelData:nodeData,scales:this.calculateScaling(),visible:this.visible,crossFiltering}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}async updatePathNodes(opts){var _a274;const{paths:[lineNode],opacity,visible,animationEnabled}=opts,crossFiltering=((_a274=this.contextNodeData)==null?void 0:_a274.crossFiltering)===!0;lineNode.setProperties({fill:void 0,lineJoin:"round",pointerEvents:1,opacity,stroke:this.properties.stroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.properties.strokeOpacity*(crossFiltering?CROSS_FILTER_LINE_STROKE_OPACITY_FACTOR:1),lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset}),animationEnabled||(lineNode.visible=visible),updateClipPath(this,lineNode)}async updateMarkerSelection(opts){var _a274;let{nodeData}=opts;const{markerSelection}=opts;return nodeData=this.properties.marker.enabled||((_a274=this.contextNodeData)==null?void 0:_a274.crossFiltering)===!0?nodeData:[],this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(nodeData,void 0,datum=>createDatumId(datum.xValue))}async updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,stroke,strokeWidth,strokeOpacity,marker,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle(),{stroke,strokeWidth,strokeOpacity}),applyTranslation=this.ctx.animationManager.isSkipped();markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey},baseStyle,{applyTranslation,selected:datum.selected})}),highlighted||marker.markClean()}async updateLabelSelection(opts){return opts.labelSelection.update(this.isLabelEnabled()?opts.labelData:[])}async updateLabelNodes(opts){const{enabled,fontStyle,fontWeight,fontSize,fontFamily,color}=this.properties.label;opts.labelSelection.each((text,datum)=>{const{point,label}=datum;datum&&label&&enabled?(text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.textAlign=label.textAlign,text.textBaseline=label.textBaseline,text.text=label.text,text.x=point.x,text.y=point.y-10,text.fill=color,text.visible=!0):text.visible=!1})}getTooltipHtml(nodeDatum){const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return EMPTY_TOOLTIP_CONTENT;const{xKey,yKey,xName,yName,strokeWidth,marker,tooltip}=this.properties,{datum,xValue,yValue,itemId}=nodeDatum,xString=xAxis.formatDatum(xValue),yString=yAxis.formatDatum(yValue),title=sanitizeHtml(this.properties.title??yName),content=sanitizeHtml(xString+": "+yString),baseStyle=mergeDefaults({fill:marker.stroke},marker.getStyle(),{strokeWidth}),{fill:color}=this.getMarkerStyle(marker,{datum:nodeDatum,xKey,yKey,highlighted:!1},baseStyle);return tooltip.toTooltipHtml({title,content,backgroundColor:color},{datum,itemId,xKey,xName,yKey,yName,title,color,seriesId:this.id,...this.getModuleTooltipParams()})}getLegendData(legendType){var _a274;if(!((_a274=this.data)!=null&&_a274.length&&this.properties.isValid()&&legendType==="category"))return[];const{yKey,yName,stroke,strokeOpacity,strokeWidth,lineDash,title,marker,visible,legendItemName}=this.properties,color0="rgba(0, 0, 0, 0)";return[{legendType:"category",id:this.id,itemId:yKey,legendItemName,seriesId:this.id,enabled:visible,label:{text:legendItemName??title??yName??yKey},symbols:[{marker:{shape:marker.shape,fill:marker.fill??color0,stroke:marker.stroke??stroke??color0,fillOpacity:marker.fillOpacity??1,strokeOpacity:marker.strokeOpacity??strokeOpacity??1,strokeWidth:marker.strokeWidth??0,enabled:marker.enabled},line:{stroke:stroke??color0,strokeOpacity,strokeWidth,lineDash}}]}]}async updatePaths(opts){this.updateLinePaths(opts.paths,opts.contextData)}updateLinePaths(paths,contextData){const{interpolation}=this.properties,{nodeData}=contextData,[lineNode]=paths;lineNode.path.clear(!0);for(const range3 of pathRanges(nodeData))plotPath(pathRangePoints(nodeData,range3),lineNode,interpolation);lineNode.checkPathDirty()}animateEmptyUpdateReady(animationData){const{markerSelection,labelSelection,annotationSelections,contextData,paths}=animationData,{animationManager}=this.ctx;this.updateLinePaths(paths,contextData),pathSwipeInAnimation(this,animationManager,...paths),resetMotion([markerSelection],resetMarkerPositionFn),markerSwipeScaleInAnimation(this,animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",animationManager,...annotationSelections)}animateReadyResize(animationData){const{contextData,paths}=animationData;this.updateLinePaths(paths,contextData),super.animateReadyResize(animationData)}animateWaitingUpdateReady(animationData){var _a274,_b;const{animationManager}=this.ctx,{markerSelection:markerSelections,labelSelection:labelSelections,annotationSelections,contextData,paths,previousContextData}=animationData,[path]=paths;this.resetMarkerAnimation(animationData),this.resetLabelAnimation(animationData);const update=__name(()=>{this.resetPathAnimation(animationData),this.updateLinePaths(paths,contextData)},"update"),skip=__name(()=>{animationManager.skipCurrentBatch(),update()},"skip");if(contextData==null||previousContextData==null){update(),markerFadeInAnimation(this,animationManager,"added",markerSelections),pathFadeInAnimation(this,"path_properties",animationManager,"add",path),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,...annotationSelections);return}if(contextData.crossFiltering!==previousContextData.crossFiltering){skip();return}let fns;try{fns=prepareLinePathAnimation(contextData,previousContextData,(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.diff,this.properties.interpolation)}catch{fns=void 0}if(fns===void 0){skip();return}else if(fns.status==="no-op")return;markerFadeInAnimation(this,animationManager,void 0,markerSelections),fromToMotion(this.id,"path_properties",animationManager,[path],fns.pathProperties),fns.status==="added"?this.updateLinePaths(paths,contextData):fns.status==="removed"?this.updateLinePaths(paths,previousContextData):pathMotion(this.id,"path_update",animationManager,[path],fns.path),fns.hasMotion&&(seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,...annotationSelections))}isLabelEnabled(){return this.properties.label.enabled}getBandScalePadding(){return{inner:1,outer:.1}}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum,xKey,yKey,highlighted:!0})}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a215,"LineSeries"),_a215);LineSeries.className="LineSeries";LineSeries.type="line";var LineSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"line",moduleFactory:__name(ctx=>new LineSeries(ctx),"moduleFactory"),stackable:!0,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{tooltip:{position:{type:"node"}},strokeWidth:2,strokeOpacity:1,lineDash:[0],lineDashOffset:0,interpolation:{type:"linear",tension:1,position:"end"},marker:{shape:"circle",size:7,strokeWidth:0},label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR},errorBar:{cap:{lengthRatio:1}}}},paletteFactory:__name(params=>{const{marker}=markerPaletteFactory(params);return{stroke:marker.fill,marker}},"paletteFactory")},_a216,ScatterSeriesLabel=(_a216=class extends Label{constructor(){super(...arguments),this.placement="top"}},__name(_a216,"ScatterSeriesLabel"),_a216);__decorateClass([Validate(LABEL_PLACEMENT)],ScatterSeriesLabel.prototype,"placement",2);var _a217,ScatterSeriesProperties=(_a217=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.colorRange=["#ffff00","#00ff00","#0000ff"],this.label=new ScatterSeriesLabel,this.tooltip=new SeriesTooltip,this.marker=new SeriesMarker}},__name(_a217,"ScatterSeriesProperties"),_a217);__decorateClass([Validate(STRING)],ScatterSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING)],ScatterSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"labelKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"colorKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"xFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"yFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"labelName",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"colorName",2);__decorateClass([Validate(NUMBER_ARRAY,{optional:!0})],ScatterSeriesProperties.prototype,"colorDomain",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],ScatterSeriesProperties.prototype,"colorRange",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"title",2);__decorateClass([ProxyProperty("marker.shape")],ScatterSeriesProperties.prototype,"shape",2);__decorateClass([ProxyProperty("marker.size")],ScatterSeriesProperties.prototype,"size",2);__decorateClass([ProxyProperty("marker.fill")],ScatterSeriesProperties.prototype,"fill",2);__decorateClass([ProxyProperty("marker.fillOpacity")],ScatterSeriesProperties.prototype,"fillOpacity",2);__decorateClass([ProxyProperty("marker.stroke")],ScatterSeriesProperties.prototype,"stroke",2);__decorateClass([ProxyProperty("marker.strokeWidth")],ScatterSeriesProperties.prototype,"strokeWidth",2);__decorateClass([ProxyProperty("marker.strokeOpacity")],ScatterSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([ProxyProperty("marker.itemStyler",{optional:!0})],ScatterSeriesProperties.prototype,"itemStyler",2);__decorateClass([Validate(OBJECT)],ScatterSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],ScatterSeriesProperties.prototype,"tooltip",2);var _a218,ScatterSeries=(_a218=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,pickModes:[2,3,0],pathsPerSeries:[],hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{marker:resetMarkerFn,label:resetLabelFn}}),this.properties=new ScatterSeriesProperties,this.colorScale=new ColorScale}async processData(dataController){var _a274,_b;if(!this.properties.isValid()||this.data==null||!this.visible)return;const xScale=(_a274=this.axes.x)==null?void 0:_a274.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),colorScaleType=this.colorScale.type,{xKey,yKey,xFilterKey,yFilterKey,labelKey,colorKey,colorDomain,colorRange}=this.properties,{dataModel,processedData}=await this.requestDataModel(dataController,this.data,{props:[keyProperty(xKey,xScaleType,{id:"xKey-raw"}),keyProperty(yKey,yScaleType,{id:"yKey-raw"}),...labelKey?[keyProperty(labelKey,"band",{id:"labelKey-raw"})]:[],valueProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValue"}),...xFilterKey!=null?[valueProperty(xFilterKey,xScaleType,{id:"xFilterValue"})]:[],...yFilterKey!=null?[valueProperty(yFilterKey,yScaleType,{id:"yFilterValue"})]:[],...colorKey?[valueProperty(colorKey,colorScaleType,{id:"colorValue"})]:[],...labelKey?[valueProperty(labelKey,"band",{id:"labelValue"})]:[]]});if(colorKey){const colorKeyIdx=dataModel.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=colorDomain??processedData.domain.values[colorKeyIdx]??[],this.colorScale.range=colorRange,this.colorScale.update()}this.animationState.transition("updateData")}getSeriesDomain(direction){const{dataModel,processedData}=this;if(!processedData||!dataModel)return[];const id=direction==="x"?"xValue":"yValue",dataDef=dataModel.resolveProcessedDataDefById(this,id),domain=dataModel.getDomain(this,id,"value",processedData);return(dataDef==null?void 0:dataDef.def.type)==="value"&&(dataDef==null?void 0:dataDef.def.valueType)==="category"?domain:fixNumericExtent(extent(domain))}async createNodeData(){const{axes,dataModel,processedData,colorScale}=this,{xKey,yKey,xFilterKey,yFilterKey,labelKey,colorKey,xName,yName,labelName,marker,label,visible}=this.properties,{placement}=label,markerShape=getMarker(marker.shape),xAxis=axes.x,yAxis=axes.y;if(!(dataModel&&processedData&&visible&&xAxis&&yAxis))return;const xDataIdx=dataModel.resolveProcessedDataIndexById(this,"xValue"),yDataIdx=dataModel.resolveProcessedDataIndexById(this,"yValue"),colorDataIdx=colorKey!=null?dataModel.resolveProcessedDataIndexById(this,"colorValue"):-1,labelDataIdx=labelKey!=null?dataModel.resolveProcessedDataIndexById(this,"labelValue"):-1,xFilterDataIdx=xFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"xFilterValue"):void 0,yFilterDataIdx=yFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"yFilterValue"):void 0,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=(xScale.bandwidth??0)/2,yOffset=(yScale.bandwidth??0)/2,nodeData=[],font=label.getFont(),textMeasurer=CachedTextMeasurerPool.getMeasurer({font});for(const{values,datum}of processedData.data??[]){const xDatum=values[xDataIdx],yDatum=values[yDataIdx],x=xScale.convert(xDatum)+xOffset,y=yScale.convert(yDatum)+yOffset,selected=xFilterDataIdx!=null&&yFilterDataIdx!=null?values[xFilterDataIdx]===xDatum&&values[yFilterDataIdx]===yDatum:void 0,labelText=this.getLabelText(label,{value:labelKey?values[labelDataIdx]:yDatum,datum,xKey,yKey,labelKey,xName,yName,labelName}),size=textMeasurer.measureText(labelText),fill=colorKey?colorScale.convert(values[colorDataIdx]):void 0;nodeData.push({series:this,itemId:yKey,yKey,xKey,datum,xValue:xDatum,yValue:yDatum,capDefaults:{lengthRatioMultiplier:marker.getDiameter(),lengthMax:1/0},point:{x,y,size:marker.size},midPoint:{x,y},fill,label:{text:labelText,...size},marker:markerShape,placement,selected})}return{itemId:yKey,nodeData,labelData:nodeData,scales:this.calculateScaling(),visible:this.visible}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var _a274;return((_a274=this.contextNodeData)==null?void 0:_a274.labelData)??[]}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}async updateMarkerSelection(opts){const{nodeData,markerSelection}=opts;return this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(this.properties.marker.enabled?nodeData:[])}async updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,labelKey,marker,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle());markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey,labelKey},baseStyle,{selected:datum.selected})}),highlighted||marker.markClean()}async updateLabelSelection(opts){var _a274;const placedLabels=this.isLabelEnabled()?((_a274=this.chart)==null?void 0:_a274.placeLabels().get(this))??[]:[];return opts.labelSelection.update(placedLabels.map(({datum,x,y})=>({...datum,point:{x,y,size:datum.point.size},placement:"top"})),text=>{text.pointerEvents=1})}async updateLabelNodes(opts){const{label}=this.properties;opts.labelSelection.each((text,datum)=>{var _a274,_b;text.text=datum.label.text,text.fill=label.color,text.x=((_a274=datum.point)==null?void 0:_a274.x)??0,text.y=((_b=datum.point)==null?void 0:_b.y)??0,text.fontStyle=label.fontStyle,text.fontWeight=label.fontWeight,text.fontSize=label.fontSize,text.fontFamily=label.fontFamily,text.textAlign="left",text.textBaseline="top"})}getTooltipHtml(nodeDatum){const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return EMPTY_TOOLTIP_CONTENT;const{xKey,yKey,labelKey,xName,yName,labelName,title=yName,marker,tooltip}=this.properties,{datum,xValue,yValue,label,itemId}=nodeDatum,baseStyle=mergeDefaults({fill:nodeDatum.fill,strokeWidth:this.getStrokeWidth(marker.strokeWidth)},marker.getStyle()),{fill:color="gray"}=this.getMarkerStyle(marker,{datum:nodeDatum,highlighted:!1,xKey,yKey,labelKey},baseStyle),xString=sanitizeHtml(xAxis.formatDatum(xValue)),yString=sanitizeHtml(yAxis.formatDatum(yValue));let content=`<b>${sanitizeHtml(xName??xKey)}</b>: ${xString}<br><b>${sanitizeHtml(yName??yKey)}</b>: ${yString}`;return labelKey&&(content=`<b>${sanitizeHtml(labelName??labelKey)}</b>: ${sanitizeHtml(label.text)}<br>`+content),tooltip.toTooltipHtml({title,content,backgroundColor:color},{datum,itemId,xKey,xName,yKey,yName,labelKey,labelName,title,color,seriesId:this.id,...this.getModuleTooltipParams()})}getLegendData(legendType){var _a274;const{yKey,yName,title,marker,visible}=this.properties,{fill,stroke,fillOpacity,strokeOpacity,strokeWidth}=marker;return!((_a274=this.data)!=null&&_a274.length)||!this.properties.isValid()||legendType!=="category"?[]:[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:title??yName??yKey},symbols:[{marker:{shape:marker.shape,fill:marker.fill??fill??"rgba(0, 0, 0, 0)",stroke:marker.stroke??stroke??"rgba(0, 0, 0, 0)",fillOpacity:fillOpacity??1,strokeOpacity:strokeOpacity??1,strokeWidth:strokeWidth??0}}]}]}animateEmptyUpdateReady(data){const{markerSelection,labelSelection,annotationSelections}=data;markerScaleInAnimation(this,this.ctx.animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,...annotationSelections)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey,labelKey}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum,xKey,yKey,labelKey,highlighted:!0})}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a218,"ScatterSeries"),_a218);ScatterSeries.className="ScatterSeries";ScatterSeries.type="scatter";var ScatterSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"scatter",moduleFactory:__name(ctx=>new ScatterSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,fillOpacity:.8,tooltip:{position:{type:"node"}},label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR},errorBar:{cap:{lengthRatio:1}}}},paletteFactory:singleSeriesPaletteFactory},_a219,SectorBox=(_a219=class{constructor(startAngle,endAngle,innerRadius,outerRadius){this.startAngle=startAngle,this.endAngle=endAngle,this.innerRadius=innerRadius,this.outerRadius=outerRadius}clone(){const{startAngle,endAngle,innerRadius,outerRadius}=this;return new _a219(startAngle,endAngle,innerRadius,outerRadius)}equals(other){return this.startAngle===other.startAngle&&this.endAngle===other.endAngle&&this.innerRadius===other.innerRadius&&this.outerRadius===other.outerRadius}[interpolate](other,d){return new _a219(this.startAngle*(1-d)+other.startAngle*d,this.endAngle*(1-d)+other.endAngle*d,this.innerRadius*(1-d)+other.innerRadius*d,this.outerRadius*(1-d)+other.outerRadius*d)}},__name(_a219,"_SectorBox"),_a219);function sectorBox({startAngle,endAngle,innerRadius,outerRadius}){let x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;const addPoint=__name((x,y)=>{x0=Math.min(x,x0),y0=Math.min(y,y0),x1=Math.max(x,x1),y1=Math.max(y,y1)},"addPoint");return addPoint(innerRadius*Math.cos(startAngle),innerRadius*Math.sin(startAngle)),addPoint(innerRadius*Math.cos(endAngle),innerRadius*Math.sin(endAngle)),addPoint(outerRadius*Math.cos(startAngle),outerRadius*Math.sin(startAngle)),addPoint(outerRadius*Math.cos(endAngle),outerRadius*Math.sin(endAngle)),isBetweenAngles(0,startAngle,endAngle)&&addPoint(outerRadius,0),isBetweenAngles(Math.PI*.5,startAngle,endAngle)&&addPoint(0,outerRadius),isBetweenAngles(Math.PI,startAngle,endAngle)&&addPoint(-outerRadius,0),isBetweenAngles(Math.PI*1.5,startAngle,endAngle)&&addPoint(0,-outerRadius),new BBox(x0,y0,x1-x0,y1-y0)}__name(sectorBox,"sectorBox");function isPointInSector(x,y,sector){const radius=Math.sqrt(Math.pow(x,2)+Math.pow(y,2)),{innerRadius,outerRadius}=sector;if(sector.startAngle===sector.endAngle||radius<Math.min(innerRadius,outerRadius)||radius>Math.max(innerRadius,outerRadius))return!1;const startAngle=normalizeAngle180(sector.startAngle),endAngle=normalizeAngle180(sector.endAngle),angle2=Math.atan2(y,x);return startAngle<endAngle?angle2<=endAngle&&angle2>=startAngle:angle2<=endAngle&&angle2>=-Math.PI||angle2>=startAngle&&angle2<=Math.PI}__name(isPointInSector,"isPointInSector");function lineCollidesSector(line,sector){const{startAngle,endAngle,innerRadius,outerRadius}=sector,outerStart={x:outerRadius*Math.cos(startAngle),y:outerRadius*Math.sin(startAngle)},outerEnd={x:outerRadius*Math.cos(endAngle),y:outerRadius*Math.sin(endAngle)},innerStart=innerRadius===0?{x:0,y:0}:{x:innerRadius*Math.cos(startAngle),y:innerRadius*Math.sin(startAngle)},innerEnd=innerRadius===0?{x:0,y:0}:{x:innerRadius*Math.cos(endAngle),y:innerRadius*Math.sin(endAngle)};return segmentIntersection(line.start.x,line.start.y,line.end.x,line.end.y,outerStart.x,outerStart.y,innerStart.x,innerStart.y)||segmentIntersection(line.start.x,line.start.y,line.end.x,line.end.y,outerEnd.x,outerEnd.y,innerEnd.x,innerEnd.y)||arcIntersections(0,0,outerRadius,startAngle,endAngle,!0,line.start.x,line.start.y,line.end.x,line.end.y)}__name(lineCollidesSector,"lineCollidesSector");function boxCollidesSector(box,sector){const topLeft={x:box.x,y:box.y},topRight={x:box.x+box.width,y:box.y},bottomLeft={x:box.x,y:box.y+box.height},bottomRight={x:box.x+box.width,y:box.y+box.height};return lineCollidesSector({start:topLeft,end:topRight},sector)||lineCollidesSector({start:bottomLeft,end:bottomRight},sector)}__name(boxCollidesSector,"boxCollidesSector");function radiiScalingFactor(r,sweep,a,b){if(a===0&&b===0)return 0;if(Math.asin(Math.abs(1*a)/(r+1*a))+Math.asin(Math.abs(1*b)/(r+1*b))-sweep<0)return 1;let start=0,end=1;for(let i=0;i<8;i+=1){const s=(start+end)/2;Math.asin(Math.abs(s*a)/(r+s*a))+Math.asin(Math.abs(s*b)/(r+s*b))-sweep<0?start=s:end=s}return start}__name(radiiScalingFactor,"radiiScalingFactor");var delta3=1e-6;function clockwiseAngle2(angle2,relativeToStartAngle){return angleBetween(angle2,relativeToStartAngle)<delta3?relativeToStartAngle:normalizeAngle360(angle2-relativeToStartAngle)+relativeToStartAngle}__name(clockwiseAngle2,"clockwiseAngle2");function clockwiseAngles2(startAngle,endAngle,relativeToStartAngle=0){const sweepAngle=Math.abs(endAngle-startAngle)>=2*Math.PI?2*Math.PI:normalizeAngle360(endAngle-startAngle);return startAngle=clockwiseAngle2(startAngle,relativeToStartAngle),endAngle=startAngle+sweepAngle,{startAngle,endAngle}}__name(clockwiseAngles2,"clockwiseAngles2");function arcRadialLineIntersectionAngle(cx,cy,r,startAngle,endAngle,clipAngle){const sinA=Math.sin(clipAngle),cosA=Math.cos(clipAngle),c=cx**2+cy**2-r**2;let p0x=NaN,p0y=NaN,p1x=NaN,p1y=NaN;if(cosA>.5){const tanA=sinA/cosA,a=1+tanA**2,b=-2*(cx+cy*tanA),d=b**2-4*a*c;if(d<0)return;const x0=(-b+Math.sqrt(d))/(2*a),x1=(-b-Math.sqrt(d))/(2*a);p0x=x0,p0y=x0*tanA,p1x=x1,p1y=x1*tanA}else{const cotA=cosA/sinA,a=1+cotA**2,b=-2*(cy+cx*cotA),d=b**2-4*a*c;if(d<0)return;const y0=(-b+Math.sqrt(d))/(2*a),y1=(-b-Math.sqrt(d))/(2*a);p0x=y0*cotA,p0y=y0,p1x=y1*cotA,p1y=y1}const normalisedX=cosA,normalisedY=sinA,p0DotNormalized=p0x*normalisedX+p0y*normalisedY,p1DotNormalized=p1x*normalisedX+p1y*normalisedY,a0=p0DotNormalized>0?clockwiseAngle2(Math.atan2(p0y-cy,p0x-cx),startAngle):NaN,a1=p1DotNormalized>0?clockwiseAngle2(Math.atan2(p1y-cy,p1x-cx),startAngle):NaN;if(a0>=startAngle&&a0<=endAngle)return a0;if(a1>=startAngle&&a1<=endAngle)return a1}__name(arcRadialLineIntersectionAngle,"arcRadialLineIntersectionAngle");function arcCircleIntersectionAngle(cx,cy,r,startAngle,endAngle,circleR){const d=Math.hypot(cx,cy),d1=(d**2-r**2+circleR**2)/(2*d),d2=d-d1,theta=Math.atan2(cy,cx),deltaTheta=Math.acos(-d2/r),a0=clockwiseAngle2(theta+deltaTheta,startAngle),a1=clockwiseAngle2(theta-deltaTheta,startAngle);if(a0>=startAngle&&a0<=endAngle)return a0;if(a1>=startAngle&&a1<=endAngle)return a1}__name(arcCircleIntersectionAngle,"arcCircleIntersectionAngle");var _a220,Arc=(_a220=class{constructor(cx,cy,r,a0,a1){this.cx=cx,this.cy=cy,this.r=r,this.a0=a0,this.a1=a1,this.a0>=this.a1&&(this.a0=NaN,this.a1=NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(a){return{x:this.cx+this.r*Math.cos(a),y:this.cy+this.r*Math.sin(a)}}clipStart(a){a==null||!this.isValid()||a<this.a0||(this.a0=a,(Number.isNaN(a)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}clipEnd(a){a==null||!this.isValid()||a>this.a1||(this.a1=a,(Number.isNaN(a)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}},__name(_a220,"Arc"),_a220),_a221,Sector=(_a221=class extends Path{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(value){this.concentricEdgeInset=value,this.radialEdgeInset=value}set cornerRadius(value){this.startOuterCornerRadius=value,this.endOuterCornerRadius=value,this.startInnerCornerRadius=value,this.endInnerCornerRadius=value}computeBBox(){return sectorBox(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset}=this;let{innerRadius,outerRadius}=this;return innerRadius=innerRadius>0?innerRadius+concentricEdgeInset:0,outerRadius=Math.max(outerRadius-concentricEdgeInset,0),{innerRadius,outerRadius}}normalizedClipSector(){const{clipSector}=this;if(clipSector==null)return;const{startAngle,endAngle}=clockwiseAngles2(this.startAngle,this.endAngle),{innerRadius,outerRadius}=this.normalizedRadii(),clipAngles=clockwiseAngles2(clipSector.startAngle,clipSector.endAngle,startAngle);return new SectorBox(Math.max(startAngle,clipAngles.startAngle),Math.min(endAngle,clipAngles.endAngle),Math.max(innerRadius,clipSector.innerRadius),Math.min(outerRadius,clipSector.outerRadius))}getAngleOffset(radius){return radius>0?this.radialEdgeInset/radius:0}arc(r,angleSweep,a0,a1,outerArc,innerArc,start,inner){if(r<=0)return;const{startAngle,endAngle}=clockwiseAngles2(this.startAngle,this.endAngle),{innerRadius,outerRadius}=this.normalizedRadii(),clipSector=this.normalizedClipSector();if(inner&&innerRadius<=0)return;const angleOffset=inner?this.getAngleOffset(innerRadius+r):this.getAngleOffset(outerRadius-r),angle2=start?startAngle+angleOffset+angleSweep:endAngle-angleOffset-angleSweep,radius=inner?innerRadius+r:outerRadius-r,cx=radius*Math.cos(angle2),cy=radius*Math.sin(angle2);if(clipSector!=null&&(!start&&!(angle2>=startAngle-1e-6&&angle2<=clipSector.endAngle-1e-6)||start&&!(angle2>=clipSector.startAngle+1e-6&&angle2<=endAngle-1e-6)||inner&&!(radius>=clipSector.innerRadius-1e-6)||!inner&&!(radius<=clipSector.outerRadius+1e-6)))return;const arc=new Arc(cx,cy,r,a0,a1);if(clipSector!=null){inner?(arc.clipStart(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.endAngle)),arc.clipEnd(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.startAngle))):(arc.clipStart(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.startAngle)),arc.clipEnd(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.endAngle)));let circleClipStart,circleClipEnd;if(start?(circleClipStart=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.innerRadius),circleClipEnd=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.outerRadius)):(circleClipStart=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.outerRadius),circleClipEnd=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.innerRadius)),arc.clipStart(circleClipStart),arc.clipEnd(circleClipEnd),circleClipStart!=null){const{x:x2,y:y2}=arc.pointAt(circleClipStart),theta2=clockwiseAngle2(Math.atan2(y2,x2),startAngle);start?innerArc==null||innerArc.clipStart(theta2):outerArc.clipEnd(theta2)}if(circleClipEnd!=null){const{x:x2,y:y2}=arc.pointAt(circleClipEnd),theta2=clockwiseAngle2(Math.atan2(y2,x2),startAngle);start?outerArc.clipStart(theta2):innerArc==null||innerArc.clipEnd(theta2)}}if(clipSector!=null){const{x:x2,y:y2}=arc.pointAt((arc.a0+arc.a1)/2);if(!isPointInSector(x2,y2,clipSector))return}const{x,y}=arc.pointAt(start===inner?arc.a0:arc.a1),theta=clockwiseAngle2(Math.atan2(y,x),startAngle),radialArc=inner?innerArc:outerArc;return start?radialArc==null||radialArc.clipStart(theta):radialArc==null||radialArc.clipEnd(theta),arc}updatePath(){const{path,centerX,centerY,concentricEdgeInset,radialEdgeInset}=this;let{startOuterCornerRadius,endOuterCornerRadius,startInnerCornerRadius,endInnerCornerRadius}=this;const{startAngle,endAngle}=clockwiseAngles2(this.startAngle,this.endAngle),{innerRadius,outerRadius}=this.normalizedRadii(),clipSector=this.normalizedClipSector(),sweepAngle=endAngle-startAngle,fullPie=sweepAngle>=2*Math.PI-1e-6;if(path.clear(),innerRadius===0&&outerRadius===0||innerRadius>outerRadius)return;if(((clipSector==null?void 0:clipSector.startAngle)??startAngle)===((clipSector==null?void 0:clipSector.endAngle)??endAngle))return;if(fullPie&&this.clipSector==null&&startOuterCornerRadius===0&&endOuterCornerRadius===0&&startInnerCornerRadius===0&&endInnerCornerRadius===0){path.moveTo(centerX+outerRadius*Math.cos(startAngle),centerY+outerRadius*Math.sin(startAngle)),path.arc(centerX,centerY,outerRadius,startAngle,endAngle),innerRadius>concentricEdgeInset&&(path.moveTo(centerX+innerRadius*Math.cos(endAngle),centerY+innerRadius*Math.sin(endAngle)),path.arc(centerX,centerY,innerRadius,endAngle,startAngle,!0)),path.closePath();return}else if(this.clipSector==null&&Math.abs(innerRadius-outerRadius)<1e-6){path.arc(centerX,centerY,outerRadius,startAngle,endAngle,!1),path.arc(centerX,centerY,outerRadius,endAngle,startAngle,!0),path.closePath();return}const innerAngleOffset=this.getAngleOffset(innerRadius),outerAngleOffset=this.getAngleOffset(outerRadius);if(sweepAngle<2*outerAngleOffset)return;const hasInnerSweep=((clipSector==null?void 0:clipSector.innerRadius)??innerRadius)>concentricEdgeInset,innerAngleExceeded=innerRadius<concentricEdgeInset||sweepAngle<2*innerAngleOffset,radialLength=outerRadius-innerRadius,maxRadialLength=Math.max(startOuterCornerRadius,startInnerCornerRadius,endOuterCornerRadius,endInnerCornerRadius),initialScalingFactor=maxRadialLength>0?Math.min(radialLength/maxRadialLength,1):1;startOuterCornerRadius*=initialScalingFactor,endOuterCornerRadius*=initialScalingFactor,startInnerCornerRadius*=initialScalingFactor,endInnerCornerRadius*=initialScalingFactor;const outerScalingFactor=radiiScalingFactor(outerRadius,sweepAngle-2*outerAngleOffset,-startOuterCornerRadius,-endOuterCornerRadius);if(startOuterCornerRadius*=outerScalingFactor,endOuterCornerRadius*=outerScalingFactor,!innerAngleExceeded&&hasInnerSweep){const innerScalingFactor=radiiScalingFactor(innerRadius,sweepAngle-2*innerAngleOffset,startInnerCornerRadius,endInnerCornerRadius);startInnerCornerRadius*=innerScalingFactor,endInnerCornerRadius*=innerScalingFactor}else startInnerCornerRadius=0,endInnerCornerRadius=0;const maxCombinedRadialLength=Math.max(startOuterCornerRadius+startInnerCornerRadius,endOuterCornerRadius+endInnerCornerRadius),edgesScalingFactor=maxCombinedRadialLength>0?Math.min(radialLength/maxCombinedRadialLength,1):1;startOuterCornerRadius*=edgesScalingFactor,endOuterCornerRadius*=edgesScalingFactor,startInnerCornerRadius*=edgesScalingFactor,endInnerCornerRadius*=edgesScalingFactor;let startOuterCornerRadiusAngleSweep=0,endOuterCornerRadiusAngleSweep=0;const startOuterCornerRadiusSweep=startOuterCornerRadius/(outerRadius-startOuterCornerRadius),endOuterCornerRadiusSweep=endOuterCornerRadius/(outerRadius-endOuterCornerRadius);if(startOuterCornerRadiusSweep>=0&&startOuterCornerRadiusSweep<1-1e-6)startOuterCornerRadiusAngleSweep=Math.asin(startOuterCornerRadiusSweep);else{startOuterCornerRadiusAngleSweep=sweepAngle/2;const maxStartOuterCornerRadius=outerRadius/(1/Math.sin(startOuterCornerRadiusAngleSweep)+1);startOuterCornerRadius=Math.min(maxStartOuterCornerRadius,startOuterCornerRadius)}if(endOuterCornerRadiusSweep>=0&&endOuterCornerRadiusSweep<1-1e-6)endOuterCornerRadiusAngleSweep=Math.asin(endOuterCornerRadiusSweep);else{endOuterCornerRadiusAngleSweep=sweepAngle/2;const maxEndOuterCornerRadius=outerRadius/(1/Math.sin(endOuterCornerRadiusAngleSweep)+1);endOuterCornerRadius=Math.min(maxEndOuterCornerRadius,endOuterCornerRadius)}const startInnerCornerRadiusAngleSweep=Math.asin(startInnerCornerRadius/(innerRadius+startInnerCornerRadius)),endInnerCornerRadiusAngleSweep=Math.asin(endInnerCornerRadius/(innerRadius+endInnerCornerRadius)),outerArcRadius=(clipSector==null?void 0:clipSector.outerRadius)??outerRadius,outerArcRadiusOffset=this.getAngleOffset(outerArcRadius),outerArc=new Arc(0,0,outerArcRadius,startAngle+outerArcRadiusOffset,endAngle-outerArcRadiusOffset),innerArcRadius=(clipSector==null?void 0:clipSector.innerRadius)??innerRadius,innerArcRadiusOffset=this.getAngleOffset(innerArcRadius),innerArc=hasInnerSweep?new Arc(0,0,innerArcRadius,startAngle+innerArcRadiusOffset,endAngle-innerArcRadiusOffset):void 0;clipSector!=null&&(outerArc.clipStart(clipSector.startAngle),outerArc.clipEnd(clipSector.endAngle),innerArc==null||innerArc.clipStart(clipSector.startAngle),innerArc==null||innerArc.clipEnd(clipSector.endAngle));const startOuterArc=this.arc(startOuterCornerRadius,startOuterCornerRadiusAngleSweep,startAngle-Math.PI*.5,startAngle+startOuterCornerRadiusAngleSweep,outerArc,innerArc,!0,!1),endOuterArc=this.arc(endOuterCornerRadius,endOuterCornerRadiusAngleSweep,endAngle-endOuterCornerRadiusAngleSweep,endAngle+Math.PI*.5,outerArc,innerArc,!1,!1),endInnerArc=this.arc(endInnerCornerRadius,endInnerCornerRadiusAngleSweep,endAngle+Math.PI*.5,endAngle+Math.PI-endInnerCornerRadiusAngleSweep,outerArc,innerArc,!1,!0),startInnerArc=this.arc(startInnerCornerRadius,startInnerCornerRadiusAngleSweep,startAngle+Math.PI+startInnerCornerRadiusAngleSweep,startAngle+Math.PI*1.5,outerArc,innerArc,!0,!0);if(innerAngleExceeded){const x=sweepAngle<Math.PI*.5?radialEdgeInset*(1+Math.cos(sweepAngle))/Math.sin(sweepAngle):NaN;let r;x>0&&x<outerRadius?r=Math.max(Math.hypot(radialEdgeInset,x),innerRadius):r=radialEdgeInset,r=Math.max(r,innerRadius);const midAngle=startAngle+sweepAngle*.5;path.moveTo(centerX+r*Math.cos(midAngle),centerY+r*Math.sin(midAngle))}else if(!((startInnerArc==null?void 0:startInnerArc.isValid())===!0||(innerArc==null?void 0:innerArc.isValid())===!0)){const midAngle=startAngle+sweepAngle/2,cx=innerRadius*Math.cos(midAngle),cy=innerRadius*Math.sin(midAngle);path.moveTo(centerX+cx,centerY+cy)}if((startOuterArc==null?void 0:startOuterArc.isValid())===!0){const{cx,cy,r,a0,a1}=startOuterArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}if(outerArc.isValid()){const{r,a0,a1}=outerArc;path.arc(centerX,centerY,r,a0,a1)}if((endOuterArc==null?void 0:endOuterArc.isValid())===!0){const{cx,cy,r,a0,a1}=endOuterArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}if(!innerAngleExceeded){if((endInnerArc==null?void 0:endInnerArc.isValid())===!0){const{cx,cy,r,a0,a1}=endInnerArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}if((innerArc==null?void 0:innerArc.isValid())===!0){const{r,a0,a1}=innerArc;path.arc(centerX,centerY,r,a1,a0,!0)}if((startInnerArc==null?void 0:startInnerArc.isValid())===!0){const{cx,cy,r,a0,a1}=startInnerArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}}path.closePath()}isPointInPath(x,y){const{startAngle,endAngle,innerRadius,outerRadius}=this.clipSector??this;return isPointInSector(x-this.centerX,y-this.centerY,{startAngle,endAngle,innerRadius:Math.min(innerRadius,outerRadius),outerRadius:Math.max(innerRadius,outerRadius)})}},__name(_a221,"Sector"),_a221);Sector.className="Sector";__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerX",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerY",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"innerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"outerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"clipSector",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"concentricEdgeInset",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"radialEdgeInset",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startOuterCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endOuterCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startInnerCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endInnerCornerRadius",2);var DEFAULT_FILLS={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},DEFAULT_STROKES={BLUE:"#2b5c95",ORANGE:"#cc6f10",GREEN:"#1e652e",CYAN:"#18859e",YELLOW:"#a69400",VIOLET:"#603c88",GRAY:"#575757",MAGENTA:"#7d2f6d",BROWN:"#4f3508",RED:"#a82529"},_a222,DonutTitle=(_a222=class extends Caption{constructor(){super(...arguments),this.showInLegend=!1}},__name(_a222,"DonutTitle"),_a222);__decorateClass([Validate(BOOLEAN)],DonutTitle.prototype,"showInLegend",2);var _a223,DonutInnerLabel=(_a223=class extends Label{constructor(){super(...arguments),this.spacing=2}set(properties,_reset){return super.set(properties)}},__name(_a223,"DonutInnerLabel"),_a223);__decorateClass([Validate(STRING)],DonutInnerLabel.prototype,"text",2);__decorateClass([Validate(NUMBER)],DonutInnerLabel.prototype,"spacing",2);var _a224,DonutInnerCircle=(_a224=class extends BaseProperties{constructor(){super(...arguments),this.fill="transparent",this.fillOpacity=1}},__name(_a224,"DonutInnerCircle"),_a224);__decorateClass([Validate(COLOR_STRING)],DonutInnerCircle.prototype,"fill",2);__decorateClass([Validate(RATIO)],DonutInnerCircle.prototype,"fillOpacity",2);var _a225,DonutSeriesCalloutLabel=(_a225=class extends Label{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}},__name(_a225,"DonutSeriesCalloutLabel"),_a225);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLabel.prototype,"offset",2);__decorateClass([Validate(DEGREE)],DonutSeriesCalloutLabel.prototype,"minAngle",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLabel.prototype,"minSpacing",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLabel.prototype,"maxCollisionOffset",2);__decorateClass([Validate(BOOLEAN)],DonutSeriesCalloutLabel.prototype,"avoidCollisions",2);var _a226,DonutSeriesSectorLabel=(_a226=class extends Label{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}},__name(_a226,"DonutSeriesSectorLabel"),_a226);__decorateClass([Validate(NUMBER)],DonutSeriesSectorLabel.prototype,"positionOffset",2);__decorateClass([Validate(RATIO)],DonutSeriesSectorLabel.prototype,"positionRatio",2);var _a227,DonutSeriesCalloutLine=(_a227=class extends BaseProperties{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}},__name(_a227,"DonutSeriesCalloutLine"),_a227);__decorateClass([Validate(COLOR_STRING_ARRAY,{optional:!0})],DonutSeriesCalloutLine.prototype,"colors",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLine.prototype,"length",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLine.prototype,"strokeWidth",2);var _a228,DonutSeriesProperties=(_a228=class extends SeriesProperties{constructor(){super(...arguments),this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.innerLabels=new PropertiesArray(DonutInnerLabel),this.title=new DonutTitle,this.innerCircle=new DonutInnerCircle,this.shadow=new DropShadow,this.calloutLabel=new DonutSeriesCalloutLabel,this.sectorLabel=new DonutSeriesSectorLabel,this.calloutLine=new DonutSeriesCalloutLine,this.tooltip=new SeriesTooltip}isValid(){const superIsValid=super.isValid();return this.innerRadiusRatio==null&&this.innerRadiusOffset==null?(Logger.warnOnce("Either an [innerRadiusRatio] or an [innerRadiusOffset] must be set to render a donut series."),!1):superIsValid}},__name(_a228,"DonutSeriesProperties"),_a228);__decorateClass([Validate(STRING)],DonutSeriesProperties.prototype,"angleKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"angleName",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"angleFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"radiusKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"radiusName",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"radiusMin",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"radiusMax",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"calloutLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"calloutLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"sectorLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"sectorLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"legendItemKey",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],DonutSeriesProperties.prototype,"fills",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],DonutSeriesProperties.prototype,"strokes",2);__decorateClass([Validate(RATIO)],DonutSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(RATIO)],DonutSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],DonutSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesProperties.prototype,"cornerRadius",2);__decorateClass([Validate(FUNCTION,{optional:!0})],DonutSeriesProperties.prototype,"itemStyler",2);__decorateClass([Validate(DEGREE)],DonutSeriesProperties.prototype,"rotation",2);__decorateClass([Validate(NUMBER)],DonutSeriesProperties.prototype,"outerRadiusOffset",2);__decorateClass([Validate(RATIO)],DonutSeriesProperties.prototype,"outerRadiusRatio",2);__decorateClass([Validate(NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"innerRadiusOffset",2);__decorateClass([Validate(RATIO,{optional:!0})],DonutSeriesProperties.prototype,"innerRadiusRatio",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(NUMBER)],DonutSeriesProperties.prototype,"sectorSpacing",2);__decorateClass([Validate(OBJECT_ARRAY)],DonutSeriesProperties.prototype,"innerLabels",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"title",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"innerCircle",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"calloutLabel",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"sectorLabel",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"calloutLine",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"tooltip",2);function preparePieSeriesAnimationFunctions(initialLoad,rotationDegrees,scaleFn,oldScaleFn){const scale2=[scaleFn.convert(0),scaleFn.convert(1)],oldScale=[oldScaleFn.convert(0),oldScaleFn.convert(1)],rotation=Math.PI/-2+toRadians(rotationDegrees),phase=initialLoad?"initial":"update",scaleToNewRadius=__name(({radius})=>({innerRadius:scale2[0],outerRadius:scale2[0]+(scale2[1]-scale2[0])*radius}),"scaleToNewRadius"),scaleToOldRadius=__name(({radius})=>({innerRadius:oldScale[0],outerRadius:oldScale[0]+(oldScale[1]-oldScale[0])*radius}),"scaleToOldRadius");return{nodes:{toFn:__name((_sect,datum,status,{prevLive})=>{var _a274,_b;let{startAngle,endAngle,innerRadius,outerRadius}=datum;const{stroke,fill}=datum.sectorFormat;if(status==="removed"&&prevLive?(startAngle=(_a274=prevLive.datum)==null?void 0:_a274.endAngle,endAngle=(_b=prevLive.datum)==null?void 0:_b.endAngle):status==="removed"&&!prevLive&&(startAngle=rotation,endAngle=rotation),status==="removed"){const radii=scaleToNewRadius(datum);innerRadius=radii.innerRadius,outerRadius=radii.outerRadius}return{startAngle,endAngle,outerRadius,innerRadius,stroke,fill}},"toFn"),fromFn:__name((sect,datum,status,{prevFromProps})=>{let{startAngle,endAngle,innerRadius,outerRadius}=sect,{fill,stroke}=datum.sectorFormat;if(status==="unknown"||status==="added"&&!prevFromProps?(startAngle=rotation,endAngle=rotation,innerRadius=datum.innerRadius,outerRadius=datum.outerRadius):status==="added"&&prevFromProps&&(startAngle=prevFromProps.endAngle??rotation,endAngle=prevFromProps.endAngle??rotation,innerRadius=prevFromProps.innerRadius??datum.innerRadius,outerRadius=prevFromProps.outerRadius??datum.outerRadius),status==="added"&&!initialLoad){const radii=scaleToOldRadius(datum);innerRadius=radii.innerRadius,outerRadius=radii.outerRadius}return status==="updated"&&(fill=sect.fill??fill,stroke=sect.stroke??stroke),{startAngle,endAngle,innerRadius,outerRadius,fill,stroke,phase}},"fromFn")},innerCircle:{fromFn:__name((node,_)=>{var _a274;return{size:((_a274=node.previousDatum)==null?void 0:_a274.radius)??node.size??0,phase}},"innerCircleFromFn"),toFn:__name((_,datum)=>({size:datum.radius??0}),"innerCircleToFn")}}}__name(preparePieSeriesAnimationFunctions,"preparePieSeriesAnimationFunctions");function resetPieSelectionsFn(_node,datum){return{startAngle:datum.startAngle,endAngle:datum.endAngle,innerRadius:datum.innerRadius,outerRadius:datum.outerRadius,fill:datum.sectorFormat.fill,stroke:datum.sectorFormat.stroke}}__name(resetPieSelectionsFn,"resetPieSelectionsFn");function pickByMatchingAngle(series,point){const dy=point.y-series.centerY,dx=point.x-series.centerX,angle2=Math.atan2(dy,dx),sectors=series.getItemNodes();for(const sector of sectors)if(sector.datum.missing!==!0&&isBetweenAngles(angle2,sector.startAngle,sector.endAngle)){const radius=Math.sqrt(dx*dx+dy*dy);let distance3=0;return radius<sector.innerRadius?distance3=sector.innerRadius-radius:radius>sector.outerRadius&&(distance3=radius-sector.outerRadius),{datum:sector.datum,distance:distance3}}}__name(pickByMatchingAngle,"pickByMatchingAngle");var _a229,PolarSeries=(_a229=class extends DataModelSeries{constructor({useLabelLayer=!1,pickModes=[3,0],canHaveAxes=!1,animationResetFns,...opts}){super({...opts,useLabelLayer,pickModes,contentGroupVirtual:!1,directionKeys:{x:["angleKey"],y:["radiusKey"]},directionNames:{x:["angleName"],y:["radiusName"]},canHaveAxes}),this.itemGroup=this.contentGroup.appendChild(new Group),this.nodeData=[],this.itemSelection=Selection.select(this.itemGroup,()=>this.nodeFactory(),!1),this.labelSelection=Selection.select(this.labelGroup,()=>this.labelFactory(),!1),this.highlightSelection=Selection.select(this.highlightGroup,()=>this.nodeFactory()),this.highlightLabelSelection=Selection.select(this.highlightLabel,()=>this.labelFactory()),this.centerX=0,this.centerY=0,this.radius=0,this.itemGroup.zIndexSubOrder=[()=>this._declarationOrder,1],this.animationResetFns=animationResetFns,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(data=>this.animateEmptyUpdateReady(data),"action")},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:__name(data=>this.animateReadyHighlight(data),"highlight"),highlightMarkers:__name(data=>this.animateReadyHighlightMarkers(data),"highlightMarkers"),resize:__name(data=>this.animateReadyResize(data),"resize"),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:__name(data=>this.animateWaitingUpdateReady(data),"action")},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:__name(data=>this.animateClearingUpdateEmpty(data),"action")},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getItemNodes(){return this.itemGroup.children}getNodeData(){return this.nodeData}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}labelFactory(){const text=new Text;return text.pointerEvents=1,text}getInnerRadius(){return 0}getLabelData(){return[]}computeLabelsBBox(_options,_seriesRect){return null}resetAllAnimation(){const{item,label}=this.animationResetFns??{};this.ctx.animationManager.stopByAnimationGroupId(this.id),item&&resetMotion([this.itemSelection,this.highlightSelection],item),label&&resetMotion([this.labelSelection,this.highlightLabelSelection],label),this.itemSelection.cleanup(),this.labelSelection.cleanup(),this.highlightSelection.cleanup(),this.highlightLabelSelection.cleanup()}animateEmptyUpdateReady(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateWaitingUpdateReady(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateReadyHighlight(_data){const{item,label}=this.animationResetFns??{};item&&resetMotion([this.highlightSelection],item),label&&resetMotion([this.highlightLabelSelection],label)}animateReadyHighlightMarkers(_data){}animateReadyResize(_data){this.resetAllAnimation()}animateClearingUpdateEmpty(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animationTransitionClear(){this.animationState.transition("clear",this.getAnimationData())}getAnimationData(seriesRect){return{seriesRect}}computeFocusBounds(opts){var _a274;const datum=(_a274=this.getNodeData())==null?void 0:_a274[opts.datumIndex];if(datum!==void 0)return this.itemSelection.select(node=>node instanceof Path&&node.datum===datum)[0]}},__name(_a229,"PolarSeries"),_a229),_a230,DonutSeriesNodeEvent=(_a230=class extends SeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.angleKey=series.properties.angleKey,this.radiusKey=series.properties.radiusKey,this.calloutLabelKey=series.properties.calloutLabelKey,this.sectorLabelKey=series.properties.sectorLabelKey}},__name(_a230,"DonutSeriesNodeEvent"),_a230),_a231,DonutSeries=(_a231=class extends PolarSeries{constructor(moduleCtx){super({moduleCtx,pickModes:[3,0],useLabelLayer:!0,animationResetFns:{item:resetPieSelectionsFn,label:resetLabelFn}}),this.properties=new DonutSeriesProperties,this.phantomNodeData=void 0,this.previousRadiusScale=new LinearScale,this.radiusScale=new LinearScale,this.phantomGroup=this.contentGroup.appendChild(new Group),this.phantomSelection=Selection.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Group({name:"pieCalloutLabels"})),this.calloutLabelSelection=new Selection(this.calloutLabelGroup,Group),this.backgroundGroup=this.rootGroup.appendChild(new TranslatableGroup({name:`${this.id}-background`,layer:!0,zIndex:0})),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Circle),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new Circle),this.innerLabelsGroup=this.contentGroup.appendChild(new Group({name:"innerLabels"})),this.innerCircleGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-innerCircle`})),this.innerLabelsSelection=Selection.select(this.innerLabelsGroup,Text),this.innerCircleSelection=Selection.select(this.innerCircleGroup,Circle),this.seriesItemEnabled=[],this.surroundingRadius=void 0,this.NodeEvent=DonutSeriesNodeEvent,this.angleScale=new LinearScale,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(angle2=>angle2+Math.PI/2),this.phantomGroup.opacity=.2,this.phantomGroup.zIndexSubOrder=[()=>this._declarationOrder,0]}get calloutNodeData(){return this.phantomNodeData??this.nodeData}addChartEventListeners(){var _a274;this.destroyFns.push((_a274=this.ctx.chartEventManager)==null?void 0:_a274.addListener("legend-item-click",event=>this.onLegendItemClick(event)))}get visible(){return super.visible&&(this.seriesItemEnabled.length===0||this.seriesItemEnabled.some(visible=>visible))}nodeFactory(){return new Sector}getSeriesDomain(direction){return direction==="x"?this.angleScale.domain:this.radiusScale.domain}async processData(dataController){var _a274,_b;if(this.data==null||!this.properties.isValid())return;let{data}=this;const{visible,seriesItemEnabled}=this,{angleKey,angleFilterKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),extraKeyProps=[],extraProps=[];legendItemKey?extraKeyProps.push(keyProperty(legendItemKey,"band",{id:"legendItemKey"})):calloutLabelKey?extraKeyProps.push(keyProperty(calloutLabelKey,"band",{id:"calloutLabelKey"})):sectorLabelKey&&extraKeyProps.push(keyProperty(sectorLabelKey,"band",{id:"sectorLabelKey"}));const radiusScaleType=this.radiusScale.type,angleScaleType=this.radiusScale.type;radiusKey&&extraProps.push(rangedValueProperty(radiusKey,{id:"radiusValue",min:this.properties.radiusMin??0,max:this.properties.radiusMax}),valueProperty(radiusKey,radiusScaleType,{id:"radiusRaw"}),normalisePropertyTo("radiusValue",[0,1],1,this.properties.radiusMin??0,this.properties.radiusMax)),calloutLabelKey&&extraProps.push(valueProperty(calloutLabelKey,"band",{id:"calloutLabelValue"})),sectorLabelKey&&extraProps.push(valueProperty(sectorLabelKey,"band",{id:"sectorLabelValue"})),legendItemKey&&extraProps.push(valueProperty(legendItemKey,"band",{id:"legendItemValue"})),angleFilterKey&&extraProps.push(accumulativeValueProperty(angleFilterKey,angleScaleType,{id:"angleFilterValue",onlyPositive:!0}),valueProperty(angleFilterKey,angleScaleType,{id:"angleFilterRaw"}),normalisePropertyTo("angleFilterValue",[0,1],0,0)),animationEnabled&&this.processedData&&extraKeyProps.length>0&&extraProps.push(diff(this.processedData)),extraProps.push(animationValidation()),data=data.map((d,idx)=>visible&&seriesItemEnabled[idx]?d:{...d,[angleKey]:0}),await this.requestDataModel(dataController,data,{props:[...extraKeyProps,accumulativeValueProperty(angleKey,angleScaleType,{id:"angleValue",onlyPositive:!0}),valueProperty(angleKey,angleScaleType,{id:"angleRaw"}),normalisePropertyTo("angleValue",[0,1],0,0),...extraProps]});for(const valueDef of((_b=(_a274=this.processedData)==null?void 0:_a274.defs)==null?void 0:_b.values)??[]){const{id,missing,property}=valueDef,missCount=getMissCount(this,missing);id!=="angleRaw"&&missCount>0&&Logger.warnOnce(`no value was found for the key '${String(property)}' on ${missCount} data element${missCount>1?"s":""}`)}this.animationState.transition("updateData")}async maybeRefreshNodeData(){if(!this.nodeDataRefresh)return;const{nodeData=[],phantomNodeData}=await this.createNodeData()??{};this.nodeData=nodeData,this.phantomNodeData=phantomNodeData,this.nodeDataRefresh=!1}getProcessedDataIndexes(dataModel){const angleIdx=dataModel.resolveProcessedDataIndexById(this,"angleValue"),angleRawIdx=dataModel.resolveProcessedDataIndexById(this,"angleRaw"),angleFilterIdx=this.properties.angleFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"angleFilterValue"):void 0,angleFilterRawIdx=this.properties.angleFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"angleFilterRaw"):void 0,radiusIdx=this.properties.radiusKey?dataModel.resolveProcessedDataIndexById(this,"radiusValue"):void 0,radiusRawIdx=this.properties.radiusKey?dataModel.resolveProcessedDataIndexById(this,"radiusRaw"):void 0,calloutLabelIdx=this.properties.calloutLabelKey?dataModel.resolveProcessedDataIndexById(this,"calloutLabelValue"):void 0,sectorLabelIdx=this.properties.sectorLabelKey?dataModel.resolveProcessedDataIndexById(this,"sectorLabelValue"):void 0,legendItemIdx=this.properties.legendItemKey?dataModel.resolveProcessedDataIndexById(this,"legendItemValue"):void 0;return{angleIdx,angleRawIdx,angleFilterIdx,angleFilterRawIdx,radiusIdx,radiusRawIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}}async createNodeData(){const{id:seriesId,processedData,dataModel,angleScale}=this,{rotation,innerRadiusRatio}=this.properties;if(!this.properties.isValid())return this.zerosumOuterRing.visible=!0,this.zerosumInnerRing.visible=!0,{itemId:seriesId,nodeData:[],labelData:[]};if(!processedData||!dataModel||processedData.type!=="ungrouped")return;const{angleIdx,angleRawIdx,angleFilterIdx,angleFilterRawIdx,radiusIdx,radiusRawIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel),useFilterAngles=angleFilterRawIdx!=null&&processedData.data.some(({values})=>values[angleFilterRawIdx]>values[angleRawIdx]);let currentStart=0,sum2=0;const nodes=[],phantomNodes=angleFilterRawIdx!=null?[]:void 0;return processedData.data.forEach((group,index)=>{const{datum,values}=group,currentValue=useFilterAngles?values[angleFilterIdx]:values[angleIdx],crossFilterScale=angleFilterRawIdx!=null&&!useFilterAngles?Math.sqrt(values[angleFilterRawIdx]/values[angleRawIdx]):1,startAngle=angleScale.convert(currentStart)+toRadians(rotation);currentStart=currentValue,sum2+=currentValue;const endAngle=angleScale.convert(currentStart)+toRadians(rotation),span=Math.abs(endAngle-startAngle),midAngle=startAngle+span/2,angleValue=values[angleRawIdx],radius=(radiusIdx!=null?values[radiusIdx]??1:1)*crossFilterScale,radiusValue=radiusRawIdx!=null?values[radiusRawIdx]:void 0,legendItemValue=legendItemIdx!=null?values[legendItemIdx]:void 0,nodeLabels=this.getLabels(datum,midAngle,span,!0,calloutLabelIdx!=null?values[calloutLabelIdx]:void 0,sectorLabelIdx!=null?values[sectorLabelIdx]:void 0,legendItemValue),sectorFormat=this.getSectorFormat(datum,index,!1),node={itemId:index,series:this,datum,index,angleValue,midAngle,midCos:Math.cos(midAngle),midSin:Math.sin(midAngle),startAngle,endAngle,radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0),sectorFormat,radiusValue,legendItemValue,enabled:this.seriesItemEnabled[index],focusable:!0,...nodeLabels};nodes.push(node),phantomNodes!=null&&phantomNodes.push({...node,radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0),focusable:!1})}),this.zerosumOuterRing.visible=sum2===0,this.zerosumInnerRing.visible=sum2===0&&innerRadiusRatio!=null&&innerRadiusRatio!==1&&innerRadiusRatio>0,{itemId:seriesId,nodeData:nodes,labelData:nodes,phantomNodeData:phantomNodes}}getLabels(datum,midAngle,span,skipDisabled,calloutLabelValue,sectorLabelValue,legendItemValue){const{calloutLabel,sectorLabel,legendItemKey}=this.properties,calloutLabelKey=!skipDisabled||calloutLabel.enabled?this.properties.calloutLabelKey:void 0,sectorLabelKey=!skipDisabled||sectorLabel.enabled?this.properties.sectorLabelKey:void 0;if(!calloutLabelKey&&!sectorLabelKey&&!legendItemKey)return{};const labelFormatterParams={datum,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},result={};return calloutLabelKey&&span>toRadians(calloutLabel.minAngle)&&(result.calloutLabel={...this.getTextAlignment(midAngle),text:this.getLabelText(calloutLabel,{...labelFormatterParams,value:calloutLabelValue}),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0}),sectorLabelKey&&(result.sectorLabel={text:this.getLabelText(sectorLabel,{...labelFormatterParams,value:sectorLabelValue})}),legendItemKey!=null&&legendItemValue!=null&&(result.legendItem={key:legendItemKey,text:legendItemValue}),result}getTextAlignment(midAngle){const quadrantTextOpts=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],midAngle180=normalizeAngle180(midAngle),quadrantStart=-.75*Math.PI,quadrantOffset=midAngle180-quadrantStart,quadrant=Math.floor(quadrantOffset/(Math.PI/2)),quadrantIndex=mod(quadrant,quadrantTextOpts.length);return quadrantTextOpts[quadrantIndex]}getSectorFormat(datum,formatIndex,highlighted){const{callbackCache}=this.ctx,{angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fills,strokes,itemStyler}=this.properties,defaultStroke=strokes[formatIndex%strokes.length],{fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius}=mergeDefaults(highlighted&&this.properties.highlightStyle.item,{fill:fills.length>0?fills[formatIndex%fills.length]:void 0,stroke:defaultStroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()},this.properties);let format;return itemStyler&&(format=callbackCache.call(itemStyler,{datum,angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius,highlighted,seriesId:this.id})),{fill:(format==null?void 0:format.fill)??fill,fillOpacity:(format==null?void 0:format.fillOpacity)??fillOpacity,stroke:(format==null?void 0:format.stroke)??stroke,strokeWidth:(format==null?void 0:format.strokeWidth)??strokeWidth,strokeOpacity:(format==null?void 0:format.strokeOpacity)??strokeOpacity,lineDash:(format==null?void 0:format.lineDash)??lineDash,lineDashOffset:(format==null?void 0:format.lineDashOffset)??lineDashOffset,cornerRadius:(format==null?void 0:format.cornerRadius)??cornerRadius}}getInnerRadius(){const{radius}=this,{innerRadiusRatio=1,innerRadiusOffset=0}=this.properties,innerRadius=radius*innerRadiusRatio+innerRadiusOffset;return innerRadius===radius||innerRadius<0?0:innerRadius}getOuterRadius(){const{outerRadiusRatio,outerRadiusOffset}=this.properties;return Math.max(this.radius*outerRadiusRatio+outerRadiusOffset,0)}updateRadiusScale(resize){var _a274;const newRange=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=newRange,resize&&(this.previousRadiusScale.range=newRange);const setRadii=__name(d=>({...d,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(d.radius),0)}),"setRadii");this.nodeData=this.nodeData.map(setRadii),this.phantomNodeData=(_a274=this.phantomNodeData)==null?void 0:_a274.map(setRadii)}getTitleTranslationY(){var _a274;const outerRadius=Math.max(0,this.radiusScale.range[1]);if(outerRadius===0)return NaN;const titleOffset=2+(((_a274=this.properties.title)==null?void 0:_a274.spacing)??0),dy=Math.max(0,-outerRadius);return-outerRadius-titleOffset-dy}async update({seriesRect}){const{title}=this.properties,newNodeDataDependencies={seriesRectWidth:seriesRect==null?void 0:seriesRect.width,seriesRectHeight:seriesRect==null?void 0:seriesRect.height},resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;if(resize&&(this._nodeDataDependencies=newNodeDataDependencies),await this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(resize),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),title){const dy=this.getTitleTranslationY(),titleBox=title.node.getBBox();title.node.visible=title.enabled&&isFinite(dy)&&!this.bboxIntersectsSurroundingSeries(titleBox,0,dy),title.node.y=isFinite(dy)?dy:0}for(const circle of[this.zerosumInnerRing,this.zerosumOuterRing])circle.fillOpacity=0,circle.stroke=this.properties.calloutLabel.color,circle.strokeWidth=1,circle.strokeOpacity=1;this.updateNodeMidPoint(),await this.updateSelections(),await this.updateNodes(seriesRect)}updateTitleNodes(){var _a274,_b;const{oldTitle}=this,{title}=this.properties;oldTitle!==title&&(oldTitle&&((_a274=this.labelGroup)==null||_a274.removeChild(oldTitle.node)),title&&(title.node.textBaseline="bottom",(_b=this.labelGroup)==null||_b.appendChild(title.node)),this.oldTitle=title)}updateNodeMidPoint(){var _a274;const setMidPoint=__name(d=>{const radius=d.innerRadius+(d.outerRadius-d.innerRadius)/2;d.midPoint={x:d.midCos*Math.max(0,radius),y:d.midSin*Math.max(0,radius)}},"setMidPoint");this.nodeData.forEach(setMidPoint),(_a274=this.phantomNodeData)==null||_a274.forEach(setMidPoint)}async updateSelections(){await this.updateGroupSelection(),this.updateInnerCircleSelection()}async updateGroupSelection(){const{itemSelection,highlightSelection,phantomSelection,highlightLabelSelection,calloutLabelSelection,labelSelection,innerLabelsSelection}=this,highlightedNodeData=this.nodeData.map(datum=>({...datum,sectorFormat:{...datum.sectorFormat}})),update=__name((selection,nodeData)=>{selection.update(nodeData,void 0,datum=>this.getDatumId(datum)),this.ctx.animationManager.isSkipped()&&selection.cleanup()},"update");update(itemSelection,this.nodeData),update(highlightSelection,highlightedNodeData),update(phantomSelection,this.phantomNodeData??[]),calloutLabelSelection.update(this.calloutNodeData,group=>{const line=new Line;line.tag=0,line.pointerEvents=1,group.appendChild(line);const text=new Text;text.tag=1,text.pointerEvents=1,group.appendChild(text)}),labelSelection.update(this.nodeData),highlightLabelSelection.update(highlightedNodeData),innerLabelsSelection.update(this.properties.innerLabels,node=>{node.pointerEvents=1})}updateInnerCircleSelection(){const{innerCircle}=this.properties;let radius=0;const innerRadius=this.getInnerRadius();if(innerRadius>0){const circleRadius=Math.min(innerRadius,this.getOuterRadius());radius=Math.ceil(circleRadius*2+1)}const datums=innerCircle?[{radius}]:[];this.innerCircleSelection.update(datums)}async updateNodes(seriesRect){const highlightedDatum=this.ctx.highlightManager.getActiveHighlight(),isVisible=this.visible&&this.seriesItemEnabled.indexOf(!0)>=0;this.rootGroup.visible=isVisible,this.backgroundGroup.visible=isVisible,this.contentGroup.visible=isVisible,this.highlightGroup.visible=isVisible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.highlightLabel.visible=isVisible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.labelGroup&&(this.labelGroup.visible=isVisible),this.contentGroup.opacity=this.getOpacity(),this.innerCircleSelection.each((node,{radius})=>{var _a274,_b;node.setProperties({fill:(_a274=this.properties.innerCircle)==null?void 0:_a274.fill,opacity:(_b=this.properties.innerCircle)==null?void 0:_b.fillOpacity,size:radius})});const animationDisabled=this.ctx.animationManager.isSkipped(),updateSectorFn=__name((sector,datum,_index,isDatumHighlighted)=>{const format=this.getSectorFormat(datum.datum,datum.itemId,isDatumHighlighted);datum.sectorFormat.fill=format.fill,datum.sectorFormat.stroke=format.stroke,animationDisabled&&(sector.startAngle=datum.startAngle,sector.endAngle=datum.endAngle,sector.innerRadius=datum.innerRadius,sector.outerRadius=datum.outerRadius),(isDatumHighlighted||animationDisabled)&&(sector.fill=format.fill,sector.stroke=format.stroke),sector.strokeWidth=format.strokeWidth,sector.fillOpacity=format.fillOpacity,sector.strokeOpacity=format.strokeOpacity,sector.lineDash=format.lineDash,sector.lineDashOffset=format.lineDashOffset,sector.cornerRadius=format.cornerRadius,sector.fillShadow=this.properties.shadow;const inset=Math.max((this.properties.sectorSpacing+(format.stroke!=null?format.strokeWidth:0))/2,0);sector.inset=inset,sector.lineJoin=this.properties.sectorSpacing>=0||inset>0?"miter":"round"},"updateSectorFn");this.itemSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.highlightSelection.each((node,datum,index)=>{datum.itemId===(highlightedDatum==null?void 0:highlightedDatum.itemId)?(node.visible=!0,updateSectorFn(node,datum,index,!0)):node.visible=!1}),this.phantomSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(seriesRect),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{calloutLine}=this.properties,calloutLength=calloutLine.length,calloutStrokeWidth=calloutLine.strokeWidth,calloutColors=calloutLine.colors??this.properties.strokes,{offset:offset4}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(0).forEach((line,index)=>{const datum=line.datum,{calloutLabel:label,outerRadius}=datum;if(label!=null&&label.text&&!label.hidden&&outerRadius!==0){line.visible=!0,line.strokeWidth=calloutStrokeWidth,line.stroke=calloutColors[index%calloutColors.length],line.fill=void 0;const x1=datum.midCos*outerRadius,y1=datum.midSin*outerRadius;let x2=datum.midCos*(outerRadius+calloutLength),y2=datum.midSin*(outerRadius+calloutLength);if((label.collisionTextAlign??label.collisionOffsetY!==0)&&label.box!=null){const box=label.box;let cx=x2,cy=y2;x2<box.x?cx=box.x:x2>box.x+box.width&&(cx=box.x+box.width),y2<box.y?cy=box.y:y2>box.y+box.height&&(cy=box.y+box.height);const dx=cx-x2,dy=cy-y2,length2=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),paddedLength=length2-offset4;paddedLength>0&&(x2=x2+dx*paddedLength/length2,y2=y2+dy*paddedLength/length2)}line.x1=x1,line.y1=y1,line.x2=x2,line.y2=y2}else line.visible=!1})}getLabelOverflow(text,box,seriesRect){const seriesLeft=seriesRect.x-this.centerX,seriesRight=seriesRect.x+seriesRect.width-this.centerX,seriesTop=seriesRect.y-this.centerY,seriesBottom=seriesRect.y+seriesRect.height-this.centerY,errPx=1;let visibleTextPart=1;box.x+errPx<seriesLeft?visibleTextPart=(box.x+box.width-seriesLeft)/box.width:box.x+box.width-errPx>seriesRight&&(visibleTextPart=(seriesRight-box.x)/box.width);const hasVerticalOverflow=box.y+errPx<seriesTop||box.y+box.height-errPx>seriesBottom,textLength=visibleTextPart===1?text.length:Math.floor(text.length*visibleTextPart)-1,hasSurroundingSeriesOverflow=this.bboxIntersectsSurroundingSeries(box);return{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}}bboxIntersectsSurroundingSeries(box,dx=0,dy=0){const{surroundingRadius}=this;if(surroundingRadius==null)return!1;const corners=[{x:box.x+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+box.height+dy},{x:box.x+dx,y:box.y+box.height+dy}],sur2=surroundingRadius**2;return corners.some(corner=>corner.x**2+corner.y**2>sur2)}computeCalloutLabelCollisionOffsets(){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,{offset:offset4,minSpacing}=calloutLabel,innerRadius=radiusScale.convert(0),shouldSkip=__name(datum=>!datum.calloutLabel||datum.outerRadius===0,"shouldSkip"),fullData=this.calloutNodeData,data=fullData.filter(t=>!shouldSkip(t));if(data.forEach(datum=>{const label=datum.calloutLabel;label!=null&&(label.hidden=!1,label.collisionTextAlign=void 0,label.collisionOffsetY=0)}),data.length<=1)return;const leftLabels=data.filter(d=>d.midCos<0).sort((a,b)=>a.midSin-b.midSin),rightLabels=data.filter(d=>d.midCos>=0).sort((a,b)=>a.midSin-b.midSin),topLabels=data.filter(d=>{var _a274;return d.midSin<0&&((_a274=d.calloutLabel)==null?void 0:_a274.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),bottomLabels=data.filter(d=>{var _a274;return d.midSin>=0&&((_a274=d.calloutLabel)==null?void 0:_a274.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),getTextBBox=__name(datum=>{const label=datum.calloutLabel;if(label==null)return BBox.zero.clone();const labelRadius=datum.outerRadius+calloutLine.length+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,textAlign=label.collisionTextAlign??label.textAlign,textBaseline=label.textBaseline;return Text.computeBBox(label.text,x,y,{font:this.properties.calloutLabel,textAlign,textBaseline})},"getTextBBox"),avoidNeighbourYCollision=__name((label,next,direction)=>{const box=getTextBBox(label).grow(minSpacing/2),other=getTextBBox(next).grow(minSpacing/2);if(box.x<other.x+other.width&&box.x+box.width>other.x&&(direction==="to-top"?box.y<other.y+other.height:box.y+box.height>other.y)){const dy=direction==="to-top"?box.y-other.y-other.height:box.y+box.height-other.y;next.calloutLabel.collisionOffsetY=dy}},"avoidNeighbourYCollision"),avoidYCollisions=__name(labels=>{const midLabel=labels.slice().sort((a,b)=>Math.abs(a.midSin)-Math.abs(b.midSin))[0],midIndex=labels.indexOf(midLabel);for(let i=midIndex-1;i>=0;i--){const prev=labels[i+1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-top")}for(let i=midIndex+1;i<labels.length;i++){const prev=labels[i-1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-bottom")}},"avoidYCollisions"),avoidXCollisions=__name(labels=>{const labelsCollideLabelsByY=data.some(datum=>datum.calloutLabel.collisionOffsetY!==0),boxes=labels.map(label=>getTextBBox(label)),paddedBoxes=boxes.map(box=>box.clone().grow(minSpacing/2));let labelsCollideLabelsByX=!1;for(let i=0;i<paddedBoxes.length&&!labelsCollideLabelsByX;i++){const box=paddedBoxes[i];for(let j=i+1;j<labels.length;j++){const other=paddedBoxes[j];if(box.collidesBBox(other)){labelsCollideLabelsByX=!0;break}}}const sectors=fullData.map(datum=>{const{startAngle,endAngle,outerRadius}=datum;return{startAngle,endAngle,innerRadius,outerRadius}}),labelsCollideSectors=boxes.some(box=>sectors.some(sector=>boxCollidesSector(box,sector)));!labelsCollideLabelsByX&&!labelsCollideLabelsByY&&!labelsCollideSectors||labels.filter(d=>d.calloutLabel.textAlign==="center").forEach(d=>{const label=d.calloutLabel;d.midCos<0?label.collisionTextAlign="right":d.midCos>0?label.collisionTextAlign="left":label.collisionTextAlign="center"})},"avoidXCollisions");avoidYCollisions(leftLabels),avoidYCollisions(rightLabels),avoidXCollisions(topLabels),avoidXCollisions(bottomLabels)}updateCalloutLabelNodes(seriesRect){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,color}=calloutLabel,tempTextNode=new Text;this.calloutLabelSelection.selectByTag(1).forEach(text=>{const{datum}=text,label=datum.calloutLabel,radius=radiusScale.convert(datum.radius),outerRadius=Math.max(0,radius);if(!(label!=null&&label.text)||outerRadius===0||label.hidden){text.visible=!1;return}const labelRadius=outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,align={textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline};tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign(align);const box=tempTextNode.getBBox();let displayText=label.text,visible=!0;if(calloutLabel.avoidCollisions){const{textLength,hasVerticalOverflow}=this.getLabelOverflow(label.text,box,seriesRect);displayText=label.text.length===textLength?label.text:`${label.text.substring(0,textLength)}…`,visible=!hasVerticalOverflow}text.text=displayText,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign(align),text.fill=color,text.visible=visible})}async computeLabelsBBox(options,seriesRect){const{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,maxCollisionOffset,minSpacing}=calloutLabel;if(!calloutLabel.avoidCollisions)return null;await this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const textBoxes=[],text=new Text;let titleBox;const{title}=this.properties;if(title!=null&&title.text&&title.enabled){const dy=this.getTitleTranslationY();isFinite(dy)&&(text.text=title.text,text.x=0,text.y=dy,text.setFont(title),text.setAlign({textBaseline:"bottom",textAlign:"center"}),titleBox=text.getBBox(),textBoxes.push(titleBox))}return this.calloutNodeData.forEach(datum=>{const label=datum.calloutLabel;if(!label||datum.outerRadius===0)return null;const labelRadius=datum.outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;text.text=label.text,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign({textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline});const box=text.getBBox();if(label.box=box,Math.abs(label.collisionOffsetY)>maxCollisionOffset){label.hidden=!0;return}if(titleBox){const seriesTop=seriesRect.y-this.centerY,titleCleanArea=new BBox(titleBox.x-minSpacing,seriesTop,titleBox.width+2*minSpacing,titleBox.y+titleBox.height+minSpacing-seriesTop);if(box.collidesBBox(titleCleanArea)){label.hidden=!0;return}}if(options.hideWhenNecessary){const{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}=this.getLabelOverflow(label.text,box,seriesRect),isTooShort=label.text.length>2&&textLength<2;if(hasVerticalOverflow||isTooShort||hasSurroundingSeriesOverflow){label.hidden=!0;return}}label.hidden=!1,textBoxes.push(box)}),textBoxes.length===0?null:BBox.merge(textBoxes)}updateSectorLabelNodes(){const{radiusScale}=this,innerRadius=radiusScale.convert(0),{fontSize,fontStyle,fontWeight,fontFamily,positionOffset,positionRatio,color}=this.properties.sectorLabel,updateSectorLabel=__name((text,datum)=>{const{sectorLabel,outerRadius}=datum;let isTextVisible=!1;if(sectorLabel&&outerRadius!==0){const labelRadius=innerRadius*(1-positionRatio)+outerRadius*positionRatio+positionOffset;text.fill=color,text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=sectorLabel.text,text.x=datum.midCos*labelRadius,text.y=datum.midSin*labelRadius,text.textAlign="center",text.textBaseline="middle";const bbox=text.getBBox(),corners=[[bbox.x,bbox.y],[bbox.x+bbox.width,bbox.y],[bbox.x+bbox.width,bbox.y+bbox.height],[bbox.x,bbox.y+bbox.height]],{startAngle,endAngle}=datum,sectorBounds={startAngle,endAngle,innerRadius,outerRadius};corners.every(([x,y])=>isPointInSector(x,y,sectorBounds))&&(isTextVisible=!0)}text.visible=isTextVisible},"updateSectorLabel");this.labelSelection.each(updateSectorLabel),this.highlightLabelSelection.each(updateSectorLabel)}updateInnerLabelNodes(){const textBBoxes=[],margins=[];this.innerLabelsSelection.each((text,datum)=>{const{fontStyle,fontWeight,fontSize,fontFamily,color}=datum;text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=datum.text,text.x=0,text.y=0,text.fill=color,text.textAlign="center",text.textBaseline="alphabetic",textBBoxes.push(text.getBBox()),margins.push(datum.spacing)});const getMarginTop=__name(index=>index===0?0:margins[index],"getMarginTop"),getMarginBottom=__name(index=>index===margins.length-1?0:margins[index],"getMarginBottom"),totalHeight=textBBoxes.reduce((sum2,bbox,i)=>sum2+bbox.height+getMarginTop(i)+getMarginBottom(i),0),totalWidth=Math.max(...textBBoxes.map(bbox=>bbox.width)),innerRadius=this.getInnerRadius(),labelsVisible=Math.sqrt(Math.pow(totalWidth/2,2)+Math.pow(totalHeight/2,2))<=(innerRadius>0?innerRadius:this.getOuterRadius()),textBottoms=[];for(let i=0,prev=-totalHeight/2;i<textBBoxes.length;i++){const bottom=textBBoxes[i].height+prev+getMarginTop(i);textBottoms.push(bottom),prev=bottom+getMarginBottom(i)}this.innerLabelsSelection.each((text,_datum,index)=>{text.y=textBottoms[index],text.visible=labelsVisible})}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2,this.zerosumInnerRing.size=this.getInnerRadius()*2}getDatumLegendName(nodeDatum){const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,{sectorLabel,calloutLabel,legendItem}=nodeDatum;if(legendItemKey&&legendItem!==void 0)return legendItem.text;if(calloutLabelKey&&calloutLabelKey!==angleKey&&(calloutLabel==null?void 0:calloutLabel.text)!==void 0)return calloutLabel.text;if(sectorLabelKey&&sectorLabelKey!==angleKey&&(sectorLabel==null?void 0:sectorLabel.text)!==void 0)return sectorLabel.text}pickNodeClosestDatum(point){return pickByMatchingAngle(this,point)}getTooltipHtml(nodeDatum){var _a274;if(!this.properties.isValid())return EMPTY_TOOLTIP_CONTENT;const{datum,angleValue,sectorFormat:{fill:color},itemId}=nodeDatum,title=sanitizeHtml((_a274=this.properties.title)==null?void 0:_a274.text),content=isFiniteNumber(angleValue)?toFixed(angleValue):String(angleValue),labelText=this.getDatumLegendName(nodeDatum);return this.properties.tooltip.toTooltipHtml({title:title??labelText,content:title&&labelText?`${labelText}: ${content}`:content,backgroundColor:color},{datum,itemId,title,color,seriesId:this.id,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey})}getLegendData(legendType){var _a274,_b,_c,_d,_e;const{visible,processedData,dataModel}=this;if(!dataModel||!(processedData!=null&&processedData.data.length)||!this.properties.isValid()||legendType!=="category")return[];const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if(!legendItemKey&&(!calloutLabelKey||calloutLabelKey===angleKey)&&(!sectorLabelKey||sectorLabelKey===angleKey))return[];const{calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel),titleText=((_a274=this.properties.title)==null?void 0:_a274.showInLegend)&&this.properties.title.text,legendData=[];for(let index=0;index<processedData.data.length;index++){const{datum,values}=processedData.data[index],labelParts=[];titleText&&labelParts.push(titleText);const labels=this.getLabels(datum,2*Math.PI,2*Math.PI,!1,calloutLabelIdx!=null?values[calloutLabelIdx]:void 0,sectorLabelIdx!=null?values[sectorLabelIdx]:void 0,legendItemIdx!=null?values[legendItemIdx]:void 0);if(legendItemKey&&labels.legendItem!==void 0?labelParts.push(labels.legendItem.text):calloutLabelKey&&calloutLabelKey!==angleKey&&((_b=labels.calloutLabel)==null?void 0:_b.text)!==void 0?labelParts.push((_c=labels.calloutLabel)==null?void 0:_c.text):sectorLabelKey&&sectorLabelKey!==angleKey&&((_d=labels.sectorLabel)==null?void 0:_d.text)!==void 0&&labelParts.push((_e=labels.sectorLabel)==null?void 0:_e.text),labelParts.length===0)continue;const sectorFormat=this.getSectorFormat(datum,index,!1);legendData.push({legendType:"category",id:this.id,itemId:index,seriesId:this.id,enabled:visible&&this.seriesItemEnabled[index],label:{text:labelParts.join(" - ")},symbols:[{marker:{fill:sectorFormat.fill,stroke:sectorFormat.stroke,fillOpacity:this.properties.fillOpacity,strokeOpacity:this.properties.strokeOpacity,strokeWidth:this.properties.strokeWidth}}],legendItemName:legendItemKey!=null?datum[legendItemKey]:void 0})}return legendData}onLegendItemClick(event){const{enabled,itemId,series,legendItemName}=event;series.id===this.id?this.toggleSeriesItem(itemId,enabled):legendItemName!=null&&this.toggleOtherSeriesItems(legendItemName,enabled)}toggleSeriesItem(itemId,enabled){this.seriesItemEnabled[itemId]=enabled,this.nodeData[itemId]&&(this.nodeData[itemId].enabled=enabled),this.nodeDataRefresh=!0}toggleOtherSeriesItems(legendItemName,enabled){var _a274;if(!this.properties.legendItemKey||!this.dataModel)return;const legendItemIdx=this.dataModel.resolveProcessedDataIndexById(this,"legendItemValue");(_a274=this.processedData)==null||_a274.data.forEach(({values},datumItemId)=>{values[legendItemIdx]===legendItemName&&this.toggleSeriesItem(datumItemId,enabled)})}animateEmptyUpdateReady(_data){const{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[this.itemSelection,this.highlightSelection,this.phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum)),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",animationManager,this.highlightLabelSelection),seriesLabelFadeInAnimation(this,"inner",animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var _a274,_b,_c;const{itemSelection,highlightSelection,phantomSelection,processedData,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,dataDiff=(_a274=processedData==null?void 0:processedData.reduced)==null?void 0:_a274.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const supportedDiff=((dataDiff==null?void 0:dataDiff.moved.size)??0)===0,hasKeys=((processedData==null?void 0:processedData.defs.keys.length)??0)>0,hasUniqueKeys=((_c=(_b=processedData==null?void 0:processedData.reduced)==null?void 0:_b.animationValidation)==null?void 0:_c.uniqueKeys)??!0;(!supportedDiff||!hasKeys||!hasUniqueKeys)&&this.ctx.animationManager.skipCurrentBatch();const fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum),dataDiff),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),seriesLabelFadeInAnimation(this,"inner",this.ctx.animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection,highlightSelection,phantomSelection,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum)),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeOutAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeOutAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeOutAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),seriesLabelFadeOutAnimation(this,"inner",this.ctx.animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumIdFromData(datum){var _a274,_b,_c;const{calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if((_c=(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys){if(legendItemKey)return datum[legendItemKey];if(calloutLabelKey)return datum[calloutLabelKey];if(sectorLabelKey)return datum[sectorLabelKey]}}getDatumId(datum){const{index}=datum,datumId=this.getDatumIdFromData(datum.datum);return datumId!=null?String(datumId):`${index}`}onDataChange(){const{data,seriesItemEnabled}=this;this.seriesItemEnabled=(data==null?void 0:data.map((_,index)=>seriesItemEnabled[index]??!0))??[]}},__name(_a231,"DonutSeries"),_a231);DonutSeries.className="DonutSeries";DonutSeries.type="donut";var donutTheme={series:{title:{enabled:!0,fontWeight:"normal",fontSize:14,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_MUTED_LABEL_COLOUR,spacing:5},calloutLabel:{enabled:!0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,offset:3,minAngle:0},sectorLabel:{enabled:!0,fontWeight:"normal",fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR,positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2},fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},innerLabels:{fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,spacing:2}}},pieTheme={series:{title:{enabled:!0,fontWeight:"normal",fontSize:14,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_MUTED_LABEL_COLOUR,spacing:5},calloutLabel:{enabled:!0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,offset:3,minAngle:0},sectorLabel:{enabled:!0,fontWeight:"normal",fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR,positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2},fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5}}},piePaletteFactory=__name(({takeColors,colorsCount})=>{const{fills,strokes}=takeColors(colorsCount);return{fills,strokes,calloutLine:{colors:strokes}}},"piePaletteFactory"),DonutSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"donut",moduleFactory:__name(ctx=>new DonutSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"exact"},themeTemplate:donutTheme,paletteFactory:piePaletteFactory},_a232,PieTitle=(_a232=class extends Caption{constructor(){super(...arguments),this.showInLegend=!1}},__name(_a232,"PieTitle"),_a232);__decorateClass([Validate(BOOLEAN)],PieTitle.prototype,"showInLegend",2);var _a233,PieSeriesCalloutLabel=(_a233=class extends Label{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}},__name(_a233,"PieSeriesCalloutLabel"),_a233);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLabel.prototype,"offset",2);__decorateClass([Validate(DEGREE)],PieSeriesCalloutLabel.prototype,"minAngle",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLabel.prototype,"minSpacing",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLabel.prototype,"maxCollisionOffset",2);__decorateClass([Validate(BOOLEAN)],PieSeriesCalloutLabel.prototype,"avoidCollisions",2);var _a234,PieSeriesSectorLabel=(_a234=class extends Label{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}},__name(_a234,"PieSeriesSectorLabel"),_a234);__decorateClass([Validate(NUMBER)],PieSeriesSectorLabel.prototype,"positionOffset",2);__decorateClass([Validate(RATIO)],PieSeriesSectorLabel.prototype,"positionRatio",2);var _a235,PieSeriesCalloutLine=(_a235=class extends BaseProperties{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}},__name(_a235,"PieSeriesCalloutLine"),_a235);__decorateClass([Validate(COLOR_STRING_ARRAY,{optional:!0})],PieSeriesCalloutLine.prototype,"colors",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLine.prototype,"length",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLine.prototype,"strokeWidth",2);var _a236,PieSeriesProperties=(_a236=class extends SeriesProperties{constructor(){super(...arguments),this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.title=new PieTitle,this.shadow=new DropShadow,this.calloutLabel=new PieSeriesCalloutLabel,this.sectorLabel=new PieSeriesSectorLabel,this.calloutLine=new PieSeriesCalloutLine,this.tooltip=new SeriesTooltip}},__name(_a236,"PieSeriesProperties"),_a236);__decorateClass([Validate(STRING)],PieSeriesProperties.prototype,"angleKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"angleName",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"angleFilterKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"radiusKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"radiusName",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],PieSeriesProperties.prototype,"radiusMin",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],PieSeriesProperties.prototype,"radiusMax",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"calloutLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"calloutLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"sectorLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"sectorLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"legendItemKey",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],PieSeriesProperties.prototype,"fills",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],PieSeriesProperties.prototype,"strokes",2);__decorateClass([Validate(RATIO)],PieSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(RATIO)],PieSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],PieSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesProperties.prototype,"cornerRadius",2);__decorateClass([Validate(FUNCTION,{optional:!0})],PieSeriesProperties.prototype,"itemStyler",2);__decorateClass([Validate(DEGREE)],PieSeriesProperties.prototype,"rotation",2);__decorateClass([Validate(NUMBER)],PieSeriesProperties.prototype,"outerRadiusOffset",2);__decorateClass([Validate(RATIO)],PieSeriesProperties.prototype,"outerRadiusRatio",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(NUMBER)],PieSeriesProperties.prototype,"sectorSpacing",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"title",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"calloutLabel",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"sectorLabel",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"calloutLine",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"tooltip",2);var _a237,PieSeriesNodeEvent=(_a237=class extends SeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.angleKey=series.properties.angleKey,this.radiusKey=series.properties.radiusKey,this.calloutLabelKey=series.properties.calloutLabelKey,this.sectorLabelKey=series.properties.sectorLabelKey}},__name(_a237,"PieSeriesNodeEvent"),_a237),_a238,PieSeries=(_a238=class extends PolarSeries{constructor(moduleCtx){super({moduleCtx,pickModes:[3,0],useLabelLayer:!0,animationResetFns:{item:resetPieSelectionsFn,label:resetLabelFn}}),this.properties=new PieSeriesProperties,this.phantomNodeData=void 0,this.previousRadiusScale=new LinearScale,this.radiusScale=new LinearScale,this.phantomGroup=this.contentGroup.appendChild(new Group),this.phantomSelection=Selection.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Group({name:"pieCalloutLabels"})),this.calloutLabelSelection=new Selection(this.calloutLabelGroup,Group),this.backgroundGroup=this.rootGroup.appendChild(new TranslatableGroup({name:`${this.id}-background`,layer:!0,zIndex:0})),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Circle),this.seriesItemEnabled=[],this.surroundingRadius=void 0,this.NodeEvent=PieSeriesNodeEvent,this.angleScale=new LinearScale,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(angle2=>angle2+Math.PI/2),this.phantomGroup.opacity=.2,this.phantomGroup.zIndexSubOrder=[()=>this._declarationOrder,0]}get calloutNodeData(){return this.phantomNodeData??this.nodeData}addChartEventListeners(){var _a274;this.destroyFns.push((_a274=this.ctx.chartEventManager)==null?void 0:_a274.addListener("legend-item-click",event=>this.onLegendItemClick(event)))}get visible(){return super.visible&&(this.seriesItemEnabled.length===0||this.seriesItemEnabled.some(visible=>visible))}nodeFactory(){const sector=new Sector;return sector.miterLimit=1e9,sector}getSeriesDomain(direction){return direction==="x"?this.angleScale.domain:this.radiusScale.domain}async processData(dataController){var _a274,_b,_c,_d,_e;if(this.data==null||!this.properties.isValid())return;let{data}=this;const{visible,seriesItemEnabled}=this,{angleKey,angleFilterKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),extraKeyProps=[],extraProps=[];legendItemKey?extraKeyProps.push(keyProperty(legendItemKey,"band",{id:"legendItemKey"})):calloutLabelKey?extraKeyProps.push(keyProperty(calloutLabelKey,"band",{id:"calloutLabelKey"})):sectorLabelKey&&extraKeyProps.push(keyProperty(sectorLabelKey,"band",{id:"sectorLabelKey"}));const radiusScaleType=this.radiusScale.type,angleScaleType=this.radiusScale.type;radiusKey&&extraProps.push(rangedValueProperty(radiusKey,{id:"radiusValue",min:this.properties.radiusMin??0,max:this.properties.radiusMax}),valueProperty(radiusKey,radiusScaleType,{id:"radiusRaw"}),normalisePropertyTo("radiusValue",[0,1],1,this.properties.radiusMin??0,this.properties.radiusMax)),calloutLabelKey&&extraProps.push(valueProperty(calloutLabelKey,"band",{id:"calloutLabelValue"})),sectorLabelKey&&extraProps.push(valueProperty(sectorLabelKey,"band",{id:"sectorLabelValue"})),legendItemKey&&extraProps.push(valueProperty(legendItemKey,"band",{id:"legendItemValue"})),angleFilterKey&&extraProps.push(accumulativeValueProperty(angleFilterKey,angleScaleType,{id:"angleFilterValue",onlyPositive:!0}),valueProperty(angleFilterKey,angleScaleType,{id:"angleFilterRaw"}),normalisePropertyTo("angleFilterValue",[0,1],0,0)),animationEnabled&&((_c=(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys)&&extraKeyProps.length>0&&extraProps.push(diff(this.processedData)),extraProps.push(animationValidation()),data=data.map((d,idx)=>visible&&seriesItemEnabled[idx]?d:{...d,[angleKey]:0}),await this.requestDataModel(dataController,data,{props:[...extraKeyProps,accumulativeValueProperty(angleKey,angleScaleType,{id:"angleValue",onlyPositive:!0}),valueProperty(angleKey,angleScaleType,{id:"angleRaw"}),normalisePropertyTo("angleValue",[0,1],0,0),...extraProps]});for(const valueDef of((_e=(_d=this.processedData)==null?void 0:_d.defs)==null?void 0:_e.values)??[]){const{id,missing,property}=valueDef,missCount=getMissCount(this,missing);id!=="angleRaw"&&missCount>0&&Logger.warnOnce(`no value was found for the key '${String(property)}' on ${missCount} data element${missCount>1?"s":""}`)}this.animationState.transition("updateData")}async maybeRefreshNodeData(){if(!this.nodeDataRefresh)return;const{nodeData=[],phantomNodeData}=await this.createNodeData()??{};this.nodeData=nodeData,this.phantomNodeData=phantomNodeData,this.nodeDataRefresh=!1}getProcessedDataIndexes(dataModel){const angleIdx=dataModel.resolveProcessedDataIndexById(this,"angleValue"),angleRawIdx=dataModel.resolveProcessedDataIndexById(this,"angleRaw"),angleFilterIdx=this.properties.angleFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"angleFilterValue"):void 0,angleFilterRawIdx=this.properties.angleFilterKey!=null?dataModel.resolveProcessedDataIndexById(this,"angleFilterRaw"):void 0,radiusIdx=this.properties.radiusKey?dataModel.resolveProcessedDataIndexById(this,"radiusValue"):void 0,radiusRawIdx=this.properties.radiusKey?dataModel.resolveProcessedDataIndexById(this,"radiusRaw"):void 0,calloutLabelIdx=this.properties.calloutLabelKey?dataModel.resolveProcessedDataIndexById(this,"calloutLabelValue"):void 0,sectorLabelIdx=this.properties.sectorLabelKey?dataModel.resolveProcessedDataIndexById(this,"sectorLabelValue"):void 0,legendItemIdx=this.properties.legendItemKey?dataModel.resolveProcessedDataIndexById(this,"legendItemValue"):void 0;return{angleIdx,angleRawIdx,angleFilterIdx,angleFilterRawIdx,radiusIdx,radiusRawIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}}async createNodeData(){const{id:seriesId,processedData,dataModel,angleScale}=this,{rotation}=this.properties;if(!processedData||!dataModel||processedData.type!=="ungrouped")return;const{angleIdx,angleRawIdx,angleFilterIdx,angleFilterRawIdx,radiusIdx,radiusRawIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel),useFilterAngles=angleFilterRawIdx!=null&&processedData.data.some(({values})=>values[angleFilterRawIdx]>values[angleRawIdx]);let currentStart=0,sum2=0;const nodes=[],phantomNodes=angleFilterRawIdx!=null?[]:void 0;return processedData.data.forEach((group,index)=>{const{datum,values}=group,currentValue=useFilterAngles?values[angleFilterIdx]:values[angleIdx],crossFilterScale=angleFilterRawIdx!=null&&!useFilterAngles?Math.sqrt(values[angleFilterRawIdx]/values[angleRawIdx]):1,startAngle=angleScale.convert(currentStart)+toRadians(rotation);currentStart=currentValue,sum2+=currentValue;const endAngle=angleScale.convert(currentStart)+toRadians(rotation),span=Math.abs(endAngle-startAngle),midAngle=startAngle+span/2,angleValue=values[angleRawIdx],radius=(radiusIdx!=null?values[radiusIdx]??1:1)*crossFilterScale,radiusValue=radiusRawIdx!=null?values[radiusRawIdx]:void 0,legendItemValue=legendItemIdx!=null?values[legendItemIdx]:void 0,nodeLabels=this.getLabels(datum,midAngle,span,!0,calloutLabelIdx!=null?values[calloutLabelIdx]:void 0,sectorLabelIdx!=null?values[sectorLabelIdx]:void 0,legendItemValue),sectorFormat=this.getSectorFormat(datum,index,!1),node={itemId:index,series:this,datum,index,angleValue,midAngle,midCos:Math.cos(midAngle),midSin:Math.sin(midAngle),startAngle,endAngle,radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0),sectorFormat,radiusValue,legendItemValue,enabled:this.seriesItemEnabled[index],...nodeLabels};nodes.push(node),phantomNodes!=null&&phantomNodes.push({...node,radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0)})}),this.zerosumOuterRing.visible=sum2===0,{itemId:seriesId,nodeData:nodes,labelData:nodes,phantomNodeData:phantomNodes}}getLabels(datum,midAngle,span,skipDisabled,calloutLabelValue,sectorLabelValue,legendItemValue){const{calloutLabel,sectorLabel,legendItemKey}=this.properties,calloutLabelKey=!skipDisabled||calloutLabel.enabled?this.properties.calloutLabelKey:void 0,sectorLabelKey=!skipDisabled||sectorLabel.enabled?this.properties.sectorLabelKey:void 0;if(!calloutLabelKey&&!sectorLabelKey&&!legendItemKey)return{};const labelFormatterParams={datum,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},result={};return calloutLabelKey&&span>toRadians(calloutLabel.minAngle)&&(result.calloutLabel={...this.getTextAlignment(midAngle),text:this.getLabelText(calloutLabel,{...labelFormatterParams,value:calloutLabelValue}),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0}),sectorLabelKey&&(result.sectorLabel={text:this.getLabelText(sectorLabel,{...labelFormatterParams,value:sectorLabelValue})}),legendItemKey!=null&&legendItemValue!=null&&(result.legendItem={key:legendItemKey,text:legendItemValue}),result}getTextAlignment(midAngle){const quadrantTextOpts=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],midAngle180=normalizeAngle180(midAngle),quadrantStart=-.75*Math.PI,quadrantOffset=midAngle180-quadrantStart,quadrant=Math.floor(quadrantOffset/(Math.PI/2)),quadrantIndex=mod(quadrant,quadrantTextOpts.length);return quadrantTextOpts[quadrantIndex]}getSectorFormat(datum,formatIndex,highlighted){const{callbackCache}=this.ctx,{angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fills,strokes,itemStyler}=this.properties,defaultStroke=strokes[formatIndex%strokes.length],{fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius}=mergeDefaults(highlighted&&this.properties.highlightStyle.item,{fill:fills.length>0?fills[formatIndex%fills.length]:void 0,stroke:defaultStroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()},this.properties);let format;return itemStyler&&(format=callbackCache.call(itemStyler,{datum,angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fill,strokeOpacity,stroke,strokeWidth,fillOpacity,lineDash,lineDashOffset,cornerRadius,highlighted,seriesId:this.id})),{fill:(format==null?void 0:format.fill)??fill,fillOpacity:(format==null?void 0:format.fillOpacity)??fillOpacity,stroke:(format==null?void 0:format.stroke)??stroke,strokeWidth:(format==null?void 0:format.strokeWidth)??strokeWidth,strokeOpacity:(format==null?void 0:format.strokeOpacity)??strokeOpacity,lineDash:(format==null?void 0:format.lineDash)??lineDash,lineDashOffset:(format==null?void 0:format.lineDashOffset)??lineDashOffset,cornerRadius:(format==null?void 0:format.cornerRadius)??cornerRadius}}getOuterRadius(){return Math.max(this.radius*this.properties.outerRadiusRatio+this.properties.outerRadiusOffset,0)}updateRadiusScale(resize){var _a274;const newRange=[0,this.getOuterRadius()];this.radiusScale.range=newRange,resize&&(this.previousRadiusScale.range=newRange);const setRadii=__name(d=>({...d,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(d.radius),0)}),"setRadii");this.nodeData=this.nodeData.map(setRadii),this.phantomNodeData=(_a274=this.phantomNodeData)==null?void 0:_a274.map(setRadii)}getTitleTranslationY(){var _a274;const outerRadius=Math.max(0,this.radiusScale.range[1]);if(outerRadius===0)return NaN;const titleOffset=2+(((_a274=this.properties.title)==null?void 0:_a274.spacing)??0),dy=Math.max(0,-outerRadius);return-outerRadius-titleOffset-dy}async update({seriesRect}){const{title}=this.properties,newNodeDataDependencies={seriesRectWidth:seriesRect==null?void 0:seriesRect.width,seriesRectHeight:seriesRect==null?void 0:seriesRect.height},resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;if(resize&&(this._nodeDataDependencies=newNodeDataDependencies),await this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(resize),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),title){const dy=this.getTitleTranslationY(),titleBox=title.node.getBBox();title.node.visible=title.enabled&&isFinite(dy)&&!this.bboxIntersectsSurroundingSeries(titleBox,0,dy),title.node.y=isFinite(dy)?dy:0}this.zerosumOuterRing.fillOpacity=0,this.zerosumOuterRing.stroke=this.properties.calloutLabel.color,this.zerosumOuterRing.strokeWidth=1,this.zerosumOuterRing.strokeOpacity=1,this.updateNodeMidPoint(),await this.updateSelections(),await this.updateNodes(seriesRect)}updateTitleNodes(){var _a274,_b;const{oldTitle}=this,{title}=this.properties;oldTitle!==title&&(oldTitle&&((_a274=this.labelGroup)==null||_a274.removeChild(oldTitle.node)),title&&(title.node.textBaseline="bottom",(_b=this.labelGroup)==null||_b.appendChild(title.node)),this.oldTitle=title)}updateNodeMidPoint(){var _a274;const setMidPoint=__name(d=>{const radius=d.innerRadius+(d.outerRadius-d.innerRadius)/2;d.midPoint={x:d.midCos*Math.max(0,radius),y:d.midSin*Math.max(0,radius)}},"setMidPoint");this.nodeData.forEach(setMidPoint),(_a274=this.phantomNodeData)==null||_a274.forEach(setMidPoint)}async updateSelections(){await this.updateGroupSelection()}async updateGroupSelection(){const{itemSelection,highlightSelection,phantomSelection,highlightLabelSelection,calloutLabelSelection,labelSelection}=this,highlightedNodeData=this.nodeData.map(datum=>({...datum,sectorFormat:{...datum.sectorFormat}})),update=__name((selection,nodeData)=>{selection.update(nodeData,void 0,datum=>this.getDatumId(datum)),this.ctx.animationManager.isSkipped()&&selection.cleanup()},"update");update(itemSelection,this.nodeData),update(highlightSelection,highlightedNodeData),update(phantomSelection,this.phantomNodeData??[]),calloutLabelSelection.update(this.calloutNodeData,group=>{const line=new Line;line.tag=0,line.pointerEvents=1,group.appendChild(line);const text=new Text;text.tag=1,text.pointerEvents=1,group.appendChild(text)}),labelSelection.update(this.nodeData),highlightLabelSelection.update(highlightedNodeData)}async updateNodes(seriesRect){const highlightedDatum=this.ctx.highlightManager.getActiveHighlight(),isVisible=this.visible&&this.seriesItemEnabled.indexOf(!0)>=0;this.rootGroup.visible=isVisible,this.backgroundGroup.visible=isVisible,this.contentGroup.visible=isVisible,this.highlightGroup.visible=isVisible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.highlightLabel.visible=isVisible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.labelGroup&&(this.labelGroup.visible=isVisible),this.contentGroup.opacity=this.getOpacity();const animationDisabled=this.ctx.animationManager.isSkipped(),updateSectorFn=__name((sector,datum,_index,isDatumHighlighted)=>{const format=this.getSectorFormat(datum.datum,datum.itemId,isDatumHighlighted);datum.sectorFormat.fill=format.fill,datum.sectorFormat.stroke=format.stroke,animationDisabled&&(sector.startAngle=datum.startAngle,sector.endAngle=datum.endAngle,sector.innerRadius=datum.innerRadius,sector.outerRadius=datum.outerRadius),(isDatumHighlighted||animationDisabled)&&(sector.fill=format.fill,sector.stroke=format.stroke),sector.strokeWidth=format.strokeWidth,sector.fillOpacity=format.fillOpacity,sector.strokeOpacity=format.strokeOpacity,sector.lineDash=format.lineDash,sector.lineDashOffset=format.lineDashOffset,sector.cornerRadius=format.cornerRadius,sector.fillShadow=this.properties.shadow;const inset=Math.max((this.properties.sectorSpacing+(format.stroke!=null?format.strokeWidth:0))/2,0);sector.inset=inset,sector.lineJoin=this.properties.sectorSpacing>=0||inset>0?"miter":"round"},"updateSectorFn");this.itemSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.highlightSelection.each((node,datum,index)=>{updateSectorFn(node,datum,index,!0),datum.itemId===(highlightedDatum==null?void 0:highlightedDatum.itemId)?(node.visible=!0,updateSectorFn(node,datum,index,!0)):node.visible=!1}),this.phantomSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(seriesRect),this.updateSectorLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{calloutLine}=this.properties,calloutLength=calloutLine.length,calloutStrokeWidth=calloutLine.strokeWidth,calloutColors=calloutLine.colors??this.properties.strokes,{offset:offset4}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(0).forEach((line,index)=>{const datum=line.datum,{calloutLabel:label,outerRadius}=datum;if(label!=null&&label.text&&!label.hidden&&outerRadius!==0){line.visible=!0,line.strokeWidth=calloutStrokeWidth,line.stroke=calloutColors[index%calloutColors.length],line.fill=void 0;const x1=datum.midCos*outerRadius,y1=datum.midSin*outerRadius;let x2=datum.midCos*(outerRadius+calloutLength),y2=datum.midSin*(outerRadius+calloutLength);if((label.collisionTextAlign??label.collisionOffsetY!==0)&&label.box!=null){const box=label.box;let cx=x2,cy=y2;x2<box.x?cx=box.x:x2>box.x+box.width&&(cx=box.x+box.width),y2<box.y?cy=box.y:y2>box.y+box.height&&(cy=box.y+box.height);const dx=cx-x2,dy=cy-y2,length2=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),paddedLength=length2-offset4;paddedLength>0&&(x2=x2+dx*paddedLength/length2,y2=y2+dy*paddedLength/length2)}line.x1=x1,line.y1=y1,line.x2=x2,line.y2=y2}else line.visible=!1})}getLabelOverflow(text,box,seriesRect){const seriesLeft=seriesRect.x-this.centerX,seriesRight=seriesRect.x+seriesRect.width-this.centerX,seriesTop=seriesRect.y-this.centerY,seriesBottom=seriesRect.y+seriesRect.height-this.centerY,errPx=1;let visibleTextPart=1;box.x+errPx<seriesLeft?visibleTextPart=(box.x+box.width-seriesLeft)/box.width:box.x+box.width-errPx>seriesRight&&(visibleTextPart=(seriesRight-box.x)/box.width);const hasVerticalOverflow=box.y+errPx<seriesTop||box.y+box.height-errPx>seriesBottom,textLength=visibleTextPart===1?text.length:Math.floor(text.length*visibleTextPart)-1,hasSurroundingSeriesOverflow=this.bboxIntersectsSurroundingSeries(box);return{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}}bboxIntersectsSurroundingSeries(box,dx=0,dy=0){const{surroundingRadius}=this;if(surroundingRadius==null)return!1;const corners=[{x:box.x+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+box.height+dy},{x:box.x+dx,y:box.y+box.height+dy}],sur2=surroundingRadius**2;return corners.some(corner=>corner.x**2+corner.y**2>sur2)}computeCalloutLabelCollisionOffsets(){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,{offset:offset4,minSpacing}=calloutLabel,innerRadius=radiusScale.convert(0),shouldSkip=__name(datum=>!datum.calloutLabel||datum.outerRadius===0,"shouldSkip"),fullData=this.calloutNodeData,data=fullData.filter(t=>!shouldSkip(t));if(data.forEach(datum=>{const label=datum.calloutLabel;label!=null&&(label.hidden=!1,label.collisionTextAlign=void 0,label.collisionOffsetY=0)}),data.length<=1)return;const leftLabels=data.filter(d=>d.midCos<0).sort((a,b)=>a.midSin-b.midSin),rightLabels=data.filter(d=>d.midCos>=0).sort((a,b)=>a.midSin-b.midSin),topLabels=data.filter(d=>{var _a274;return d.midSin<0&&((_a274=d.calloutLabel)==null?void 0:_a274.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),bottomLabels=data.filter(d=>{var _a274;return d.midSin>=0&&((_a274=d.calloutLabel)==null?void 0:_a274.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),getTextBBox=__name(datum=>{const label=datum.calloutLabel;if(label==null)return BBox.zero.clone();const labelRadius=datum.outerRadius+calloutLine.length+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,textAlign=label.collisionTextAlign??label.textAlign,textBaseline=label.textBaseline;return Text.computeBBox(label.text,x,y,{font:this.properties.calloutLabel,textAlign,textBaseline})},"getTextBBox"),avoidNeighbourYCollision=__name((label,next,direction)=>{const box=getTextBBox(label).grow(minSpacing/2),other=getTextBBox(next).grow(minSpacing/2);if(box.x<other.x+other.width&&box.x+box.width>other.x&&(direction==="to-top"?box.y<other.y+other.height:box.y+box.height>other.y)){const dy=direction==="to-top"?box.y-other.y-other.height:box.y+box.height-other.y;next.calloutLabel.collisionOffsetY=dy}},"avoidNeighbourYCollision"),avoidYCollisions=__name(labels=>{const midLabel=labels.slice().sort((a,b)=>Math.abs(a.midSin)-Math.abs(b.midSin))[0],midIndex=labels.indexOf(midLabel);for(let i=midIndex-1;i>=0;i--){const prev=labels[i+1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-top")}for(let i=midIndex+1;i<labels.length;i++){const prev=labels[i-1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-bottom")}},"avoidYCollisions"),avoidXCollisions=__name(labels=>{const labelsCollideLabelsByY=data.some(datum=>datum.calloutLabel.collisionOffsetY!==0),boxes=labels.map(label=>getTextBBox(label)),paddedBoxes=boxes.map(box=>box.clone().grow(minSpacing/2));let labelsCollideLabelsByX=!1;for(let i=0;i<paddedBoxes.length&&!labelsCollideLabelsByX;i++){const box=paddedBoxes[i];for(let j=i+1;j<labels.length;j++){const other=paddedBoxes[j];if(box.collidesBBox(other)){labelsCollideLabelsByX=!0;break}}}const sectors=fullData.map(datum=>{const{startAngle,endAngle,outerRadius}=datum;return{startAngle,endAngle,innerRadius,outerRadius}}),labelsCollideSectors=boxes.some(box=>sectors.some(sector=>boxCollidesSector(box,sector)));!labelsCollideLabelsByX&&!labelsCollideLabelsByY&&!labelsCollideSectors||labels.filter(d=>d.calloutLabel.textAlign==="center").forEach(d=>{const label=d.calloutLabel;d.midCos<0?label.collisionTextAlign="right":d.midCos>0?label.collisionTextAlign="left":label.collisionTextAlign="center"})},"avoidXCollisions");avoidYCollisions(leftLabels),avoidYCollisions(rightLabels),avoidXCollisions(topLabels),avoidXCollisions(bottomLabels)}updateCalloutLabelNodes(seriesRect){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,color}=calloutLabel,tempTextNode=new Text;this.calloutLabelSelection.selectByTag(1).forEach(text=>{const{datum}=text,label=datum.calloutLabel,radius=radiusScale.convert(datum.radius),outerRadius=Math.max(0,radius);if(!(label!=null&&label.text)||outerRadius===0||label.hidden){text.visible=!1;return}const labelRadius=outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,align={textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline};tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign(align);const box=tempTextNode.getBBox();let displayText=label.text,visible=!0;if(calloutLabel.avoidCollisions){const{textLength,hasVerticalOverflow}=this.getLabelOverflow(label.text,box,seriesRect);displayText=label.text.length===textLength?label.text:`${label.text.substring(0,textLength)}…`,visible=!hasVerticalOverflow}text.text=displayText,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign(align),text.fill=color,text.visible=visible})}async computeLabelsBBox(options,seriesRect){const{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,maxCollisionOffset,minSpacing}=calloutLabel;if(!calloutLabel.avoidCollisions)return null;await this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const textBoxes=[],text=new Text;let titleBox;const{title}=this.properties;if(title!=null&&title.text&&title.enabled){const dy=this.getTitleTranslationY();isFinite(dy)&&(text.text=title.text,text.x=0,text.y=dy,text.setFont(title),text.setAlign({textBaseline:"bottom",textAlign:"center"}),titleBox=text.getBBox(),textBoxes.push(titleBox))}return this.calloutNodeData.forEach(datum=>{const label=datum.calloutLabel;if(!label||datum.outerRadius===0)return null;const labelRadius=datum.outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;text.text=label.text,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign({textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline});const box=text.getBBox();if(label.box=box,Math.abs(label.collisionOffsetY)>maxCollisionOffset){label.hidden=!0;return}if(titleBox){const seriesTop=seriesRect.y-this.centerY,titleCleanArea=new BBox(titleBox.x-minSpacing,seriesTop,titleBox.width+2*minSpacing,titleBox.y+titleBox.height+minSpacing-seriesTop);if(box.collidesBBox(titleCleanArea)){label.hidden=!0;return}}if(options.hideWhenNecessary){const{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}=this.getLabelOverflow(label.text,box,seriesRect),isTooShort=label.text.length>2&&textLength<2;if(hasVerticalOverflow||isTooShort||hasSurroundingSeriesOverflow){label.hidden=!0;return}}label.hidden=!1,textBoxes.push(box)}),textBoxes.length===0?null:BBox.merge(textBoxes)}updateSectorLabelNodes(){const{radiusScale}=this,innerRadius=radiusScale.convert(0),{fontSize,fontStyle,fontWeight,fontFamily,positionOffset,positionRatio,color}=this.properties.sectorLabel,isDonut=innerRadius>0,singleVisibleSector=this.seriesItemEnabled.filter(Boolean).length===1,updateSectorLabel=__name((text,datum)=>{const{sectorLabel,outerRadius,startAngle,endAngle}=datum;let isTextVisible=!1;if(sectorLabel&&outerRadius!==0){const labelRadius=innerRadius*(1-positionRatio)+outerRadius*positionRatio+positionOffset;text.fill=color,text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=sectorLabel.text,!isDonut&&singleVisibleSector?(text.x=0,text.y=0):(text.x=datum.midCos*labelRadius,text.y=datum.midSin*labelRadius),text.textAlign="center",text.textBaseline="middle";const bbox=text.getBBox(),corners=[[bbox.x,bbox.y],[bbox.x+bbox.width,bbox.y],[bbox.x+bbox.width,bbox.y+bbox.height],[bbox.x,bbox.y+bbox.height]],sectorBounds={startAngle,endAngle,innerRadius,outerRadius};corners.every(([x,y])=>isPointInSector(x,y,sectorBounds))&&(isTextVisible=!0)}text.visible=isTextVisible},"updateSectorLabel");this.labelSelection.each(updateSectorLabel),this.highlightLabelSelection.each(updateSectorLabel)}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2}getDatumLegendName(nodeDatum){const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,{sectorLabel,calloutLabel,legendItem}=nodeDatum;if(legendItemKey&&legendItem!==void 0)return legendItem.text;if(calloutLabelKey&&calloutLabelKey!==angleKey&&(calloutLabel==null?void 0:calloutLabel.text)!==void 0)return calloutLabel.text;if(sectorLabelKey&&sectorLabelKey!==angleKey&&(sectorLabel==null?void 0:sectorLabel.text)!==void 0)return sectorLabel.text}pickNodeClosestDatum(point){return pickByMatchingAngle(this,point)}getTooltipHtml(nodeDatum){var _a274;if(!this.properties.isValid())return EMPTY_TOOLTIP_CONTENT;const{datum,angleValue,sectorFormat:{fill:color},itemId}=nodeDatum,title=sanitizeHtml((_a274=this.properties.title)==null?void 0:_a274.text),content=isFiniteNumber(angleValue)?toFixed(angleValue):String(angleValue),labelText=this.getDatumLegendName(nodeDatum);return this.properties.tooltip.toTooltipHtml({title:title??labelText,content:title&&labelText?`${labelText}: ${content}`:content,backgroundColor:color},{datum,itemId,title,color,seriesId:this.id,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey})}getLegendData(legendType){var _a274,_b,_c,_d,_e;const{visible,processedData,dataModel}=this;if(!dataModel||!(processedData!=null&&processedData.data.length)||legendType!=="category")return[];const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if(!legendItemKey&&(!calloutLabelKey||calloutLabelKey===angleKey)&&(!sectorLabelKey||sectorLabelKey===angleKey))return[];const{calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel),titleText=((_a274=this.properties.title)==null?void 0:_a274.showInLegend)&&this.properties.title.text,legendData=[];for(let index=0;index<processedData.data.length;index++){const{datum,values}=processedData.data[index],labelParts=[];titleText&&labelParts.push(titleText);const labels=this.getLabels(datum,2*Math.PI,2*Math.PI,!1,calloutLabelIdx!=null?values[calloutLabelIdx]:void 0,sectorLabelIdx!=null?values[sectorLabelIdx]:void 0,legendItemIdx!=null?values[legendItemIdx]:void 0);if(legendItemKey&&labels.legendItem!==void 0?labelParts.push(labels.legendItem.text):calloutLabelKey&&calloutLabelKey!==angleKey&&((_b=labels.calloutLabel)==null?void 0:_b.text)!==void 0?labelParts.push((_c=labels.calloutLabel)==null?void 0:_c.text):sectorLabelKey&&sectorLabelKey!==angleKey&&((_d=labels.sectorLabel)==null?void 0:_d.text)!==void 0&&labelParts.push((_e=labels.sectorLabel)==null?void 0:_e.text),labelParts.length===0)continue;const sectorFormat=this.getSectorFormat(datum,index,!1);legendData.push({legendType:"category",id:this.id,itemId:index,seriesId:this.id,enabled:visible&&this.seriesItemEnabled[index],label:{text:labelParts.join(" - ")},symbols:[{marker:{fill:sectorFormat.fill,stroke:sectorFormat.stroke,fillOpacity:this.properties.fillOpacity,strokeOpacity:this.properties.strokeOpacity,strokeWidth:this.properties.strokeWidth}}],legendItemName:legendItemKey!=null?datum[legendItemKey]:void 0})}return legendData}onLegendItemClick(event){const{enabled,itemId,series,legendItemName}=event;series.id===this.id?this.toggleSeriesItem(itemId,enabled):legendItemName!=null&&this.toggleOtherSeriesItems(legendItemName,enabled)}toggleSeriesItem(itemId,enabled){this.seriesItemEnabled[itemId]=enabled,this.nodeData[itemId]&&(this.nodeData[itemId].enabled=enabled),this.nodeDataRefresh=!0}toggleOtherSeriesItems(legendItemName,enabled){var _a274;if(!this.properties.legendItemKey||!this.dataModel)return;const legendItemIdx=this.dataModel.resolveProcessedDataIndexById(this,"legendItemValue");(_a274=this.processedData)==null||_a274.data.forEach(({values},datumItemId)=>{values[legendItemIdx]===legendItemName&&this.toggleSeriesItem(datumItemId,enabled)})}animateEmptyUpdateReady(_data){const{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[this.itemSelection,this.highlightSelection,this.phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum)),seriesLabelFadeInAnimation(this,"callout",animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var _a274,_b,_c;const{itemSelection,highlightSelection,phantomSelection,processedData,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,dataDiff=(_a274=processedData==null?void 0:processedData.reduced)==null?void 0:_a274.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const supportedDiff=((dataDiff==null?void 0:dataDiff.moved.size)??0)===0,hasKeys=((processedData==null?void 0:processedData.defs.keys.length)??0)>0,hasUniqueKeys=((_c=(_b=processedData==null?void 0:processedData.reduced)==null?void 0:_b.animationValidation)==null?void 0:_c.uniqueKeys)??!0;(!supportedDiff||!hasKeys||!hasUniqueKeys)&&this.ctx.animationManager.skipCurrentBatch();const fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum),dataDiff),seriesLabelFadeInAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection,highlightSelection,phantomSelection,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum)),seriesLabelFadeOutAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeOutAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeOutAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumIdFromData(datum){var _a274,_b,_c;const{calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if((_c=(_b=(_a274=this.processedData)==null?void 0:_a274.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys){if(legendItemKey)return datum[legendItemKey];if(calloutLabelKey)return datum[calloutLabelKey];if(sectorLabelKey)return datum[sectorLabelKey]}}getDatumId(datum){const{index}=datum,datumId=this.getDatumIdFromData(datum.datum);return datumId!=null?String(datumId):`${index}`}onDataChange(){const{data,seriesItemEnabled}=this;this.seriesItemEnabled=(data==null?void 0:data.map((_,index)=>seriesItemEnabled[index]??!0))??[]}},__name(_a238,"PieSeries"),_a238);PieSeries.className="PieSeries";PieSeries.type="pie";var PieSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"pie",moduleFactory:__name(ctx=>new PieSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"exact"},themeTemplate:pieTheme,paletteFactory:piePaletteFactory},Vec2={add,angle,apply,equal,distance:distance2,distanceSquared:distanceSquared2,from,gradient,intercept,intersectAtX,intersectAtY,length,lengthSquared,multiply,normalized,origin,required,rotate,sub};function add(a,b){return typeof b=="number"?{x:a.x+b,y:a.y+b}:{x:a.x+b.x,y:a.y+b.y}}__name(add,"add");function sub(a,b){return typeof b=="number"?{x:a.x-b,y:a.y-b}:{x:a.x-b.x,y:a.y-b.y}}__name(sub,"sub");function multiply(a,b){return typeof b=="number"?{x:a.x*b,y:a.y*b}:{x:a.x*b.x,y:a.y*b.y}}__name(multiply,"multiply");function length(a){return Math.sqrt(a.x*a.x+a.y*a.y)}__name(length,"length");function lengthSquared(a){return a.x*a.x+a.y*a.y}__name(lengthSquared,"lengthSquared");function distance2(a,b){const d=sub(a,b);return Math.sqrt(d.x*d.x+d.y*d.y)}__name(distance2,"distance2");function distanceSquared2(a,b){const d=sub(a,b);return d.x*d.x+d.y*d.y}__name(distanceSquared2,"distanceSquared2");function normalized(a){const l=length(a);return{x:a.x/l,y:a.y/l}}__name(normalized,"normalized");function angle(a,b=origin()){return Math.atan2(a.y,a.x)-Math.atan2(b.y,b.x)}__name(angle,"angle");function rotate(a,theta,b=origin()){const l=length(a);return{x:b.x+l*Math.cos(theta),y:b.y+l*Math.sin(theta)}}__name(rotate,"rotate");function gradient(a,b,reflection){const dx=b.x-a.x;return(reflection==null?b.y-a.y:reflection-b.y-(reflection-a.y))/dx}__name(gradient,"gradient");function intercept(a,gradient2,reflection){return(reflection==null?a.y:reflection-a.y)-gradient2*a.x}__name(intercept,"intercept");function intersectAtY(gradient2,coefficient,y=0,reflection){return{x:gradient2===1/0?1/0:(y-coefficient)/gradient2,y:reflection==null?y:reflection-y}}__name(intersectAtY,"intersectAtY");function intersectAtX(gradient2,coefficient,x=0,reflection){const y=gradient2===1/0?1/0:gradient2*x+coefficient;return{x,y:reflection==null?y:reflection-y}}__name(intersectAtX,"intersectAtX");function equal(a,b){return a.x===b.x&&a.y===b.y}__name(equal,"equal");function from(a,b){if(typeof a=="number")return{x:a,y:b};if("regionOffsetX"in a)return{x:a.regionOffsetX,y:a.regionOffsetY};if("offsetWidth"in a)return{x:a.offsetWidth,y:a.offsetHeight};if("width"in a)return{x:a.width,y:a.height};if("x1"in a)return[{x:a.x1,y:a.y1},{x:a.x2,y:a.y2}];throw new Error(`Values can not be converted into a vector: [${a}] [${b}]`)}__name(from,"from");function apply(a,b){return a.x=b.x,a.y=b.y,a}__name(apply,"apply");function required(a){return{x:(a==null?void 0:a.x)??0,y:(a==null?void 0:a.y)??0}}__name(required,"required");function origin(){return{x:0,y:0}}__name(origin,"origin");var _a239,ToolbarGroupProperties=(_a239=class extends BaseProperties{constructor(onChange,onButtonsChange){super(),this.onChange=onChange,this.onButtonsChange=onButtonsChange,this.align="start",this.position="top",this.size="normal",this.buttonOverrides=new Map}buttonConfigurations(){const buttons=[...this.buttons??[]];return this.draggable&&buttons.unshift({icon:"drag-handle",tooltip:"toolbarAnnotationsDragHandle",value:"drag",id:"drag"}),(buttons==null?void 0:buttons.map(button=>{const id=button.id??button.value,overrides=this.buttonOverrides.get(id);return overrides!=null?{...button,...overrides}:button}))??[]}buttonsChanged(configurationOnly){this.onButtonsChange(this.buttonConfigurations(),configurationOnly)}overrideButtonConfiguration(id,options){let overrides=this.buttonOverrides.get(id);overrides==null&&(overrides=Object.create(null),this.buttonOverrides.set(id,overrides));for(const key in options){const value=options[key];value==null?delete overrides[key]:overrides[key]=value}this.buttonsChanged(!0)}},__name(_a239,"ToolbarGroupProperties"),_a239);__decorateClass([ObserveChanges(target=>{target.onChange(target.enabled)}),Validate(BOOLEAN)],ToolbarGroupProperties.prototype,"enabled",2);__decorateClass([ObserveChanges(target=>{target.onChange(target.enabled)}),Validate(UNION([...TOOLBAR_ALIGNMENTS]),{optional:!0})],ToolbarGroupProperties.prototype,"align",2);__decorateClass([ObserveChanges(target=>{target.onChange(target.enabled)}),Validate(UNION(TOOLBAR_POSITIONS),{optional:!0})],ToolbarGroupProperties.prototype,"position",2);__decorateClass([Validate(BOOLEAN)],ToolbarGroupProperties.prototype,"draggable",2);__decorateClass([ObserveChanges(target=>{target.onChange(target.enabled)}),Validate(UNION(["small","normal"]),{optional:!0})],ToolbarGroupProperties.prototype,"size",2);__decorateClass([ObserveChanges(target=>{for(const button of target.buttons??[])button.icon!=null&&ICONS_LEGACY.includes(button.icon)&&Logger.warnOnce(`Icon '${button.icon}' is deprecated, use another icon instead.`),button.ariaLabel==="toolbarAnnotationsColor"&&Logger.warnOnce(`Aria label '${button.ariaLabel}' is deprecated, use 'toolbarAnnotationsLineColor' instead.`);target.buttonsChanged(!1)}),Validate(ARRAY,{optional:!0})],ToolbarGroupProperties.prototype,"buttons",2);var block2="ag-charts-toolbar",elements2={align:"ag-charts-toolbar__align",section:"ag-charts-toolbar__section",button:"ag-charts-toolbar__button",icon:"ag-charts-toolbar__icon",label:"ag-charts-toolbar__label"},modifiers2={top:"ag-charts-toolbar--top",right:"ag-charts-toolbar--right",bottom:"ag-charts-toolbar--bottom",left:"ag-charts-toolbar--left",floating:"ag-charts-toolbar--floating","floating-top":"ag-charts-toolbar--floating-top","floating-bottom":"ag-charts-toolbar--floating-bottom",small:"ag-charts-toolbar--small",normal:"ag-charts-toolbar--normal",hidden:"ag-charts-toolbar--hidden",preventFlash:"ag-charts-toolbar--prevent-flash",floatingHidden:"ag-charts-toolbar--floating-hidden",align:{start:"ag-charts-toolbar__align--start",center:"ag-charts-toolbar__align--center",end:"ag-charts-toolbar__align--end"},button:{first:"ag-charts-toolbar__button--first",last:"ag-charts-toolbar__button--last",active:"ag-charts-toolbar__button--active",hiddenValue:"ag-charts-toolbar__button--hidden-value",hiddenToggled:"ag-charts-toolbar__button--hidden-toggled",fillVisible:"ag-charts-toolbar__button--fill-visible",strokeWidthVisible:"ag-charts-toolbar__button--stroke-width-visible",withTransition:"ag-charts-toolbar__button--with-transition",dragHandle:"ag-charts-toolbar__button--drag-handle",dragging:"ag-charts-toolbar__button--dragging"}},_a240,Toolbar=(_a240=class extends BaseModuleInstance{constructor(ctx){super(),this.ctx=ctx,this.enabled=!0,this.seriesType=new ToolbarGroupProperties(this.onGroupChanged.bind(this,"seriesType"),this.onGroupButtonsChanged.bind(this,"seriesType")),this.annotations=new ToolbarGroupProperties(this.onGroupChanged.bind(this,"annotations"),this.onGroupButtonsChanged.bind(this,"annotations")),this.annotationOptions=new ToolbarGroupProperties(this.onGroupChanged.bind(this,"annotationOptions"),this.onGroupButtonsChanged.bind(this,"annotationOptions")),this.ranges=new ToolbarGroupProperties(this.onGroupChanged.bind(this,"ranges"),this.onGroupButtonsChanged.bind(this,"ranges")),this.zoom=new ToolbarGroupProperties(this.onGroupChanged.bind(this,"zoom"),this.onGroupButtonsChanged.bind(this,"zoom")),this.dragState={client:{x:0,y:0},position:{x:0,y:0},detached:!1},this.horizontalSpacing=10,this.verticalSpacing=10,this.floatingDetectionRange=38,this.positions={top:new Set,left:new Set,right:new Set,bottom:new Set,floating:new Set,"floating-top":new Set,"floating-bottom":new Set},this.positionAlignments={top:{},left:{},right:{},bottom:{},floating:{},"floating-top":{},"floating-bottom":{}},this.groupCallers={seriesType:new Set,annotations:new Set,annotationOptions:new Set,ranges:new Set,zoom:new Set},this.groupButtons={seriesType:[],annotations:[],annotationOptions:[],ranges:[],zoom:[]},this.ariaToolbars=[{groups:["seriesType","annotations"],destroyFns:[],resetListeners:__name(()=>{},"resetListeners")},{groups:["annotationOptions"],destroyFns:[],resetListeners:__name(()=>{},"resetListeners")},{groups:["ranges"],destroyFns:[],resetListeners:__name(()=>{},"resetListeners")},{groups:["zoom"],destroyFns:[],resetListeners:__name(()=>{},"resetListeners")}],this.pendingButtonToggledEvents=[],this.groupProxied=new Map,this.hasNewLocale=!0,this.elements={};for(const position of TOOLBAR_POSITIONS)this.elements[position]=ctx.domManager.addChild("canvas-overlay",`toolbar-${position}`),this.elements[position].role="presentation",this.renderToolbar(position);this.toggleVisibilities(),this.destroyFns.push(ctx.interactionManager.addListener("hover",this.onHover.bind(this),31),ctx.interactionManager.addListener("leave",this.onLeave.bind(this),31),ctx.toolbarManager.addListener("button-toggled",this.onButtonToggled.bind(this)),ctx.toolbarManager.addListener("button-updated",this.onButtonUpdated.bind(this)),ctx.toolbarManager.addListener("group-toggled",this.onGroupToggled.bind(this)),ctx.toolbarManager.addListener("group-updated",this.onGroupUpdated.bind(this)),ctx.toolbarManager.addListener("floating-anchor-changed",this.onFloatingAnchorChanged.bind(this)),ctx.toolbarManager.addListener("proxy-group-options",this.onProxyGroupOptions.bind(this)),ctx.layoutManager.registerElement(2,this.onLayoutStart.bind(this)),ctx.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),ctx.updateService.addListener("pre-dom-update",this.onPreDomUpdate.bind(this)),ctx.updateService.addListener("update-complete",this.onUpdateComplete.bind(this)),ctx.localeManager.addListener("locale-changed",()=>{this.hasNewLocale=!0}),()=>this.destroyElements())}destroyElements(){this.ctx.domManager.removeStyles(block2);for(const element2 of Object.keys(this.elements))this.ctx.domManager.removeChild("canvas-overlay",`toolbar-${element2}`)}onHover(event){const{enabled,elements:elements3,floatingDetectionRange,ctx:{scene}}=this,{offsetY,sourceEvent:{target}}=event,{FloatingBottom,FloatingTop}=ToolbarPosition;if(!enabled)return;const bottom=elements3[FloatingBottom],top=elements3[FloatingTop],bottomDetectionY=bottom.offsetTop-floatingDetectionRange,bottomVisible=offsetY>bottomDetectionY&&offsetY<scene.canvas.element.offsetHeight||target===bottom,topDetectionY=top.offsetTop+top.offsetHeight+floatingDetectionRange,topVisible=offsetY>0&&offsetY<topDetectionY||target===top;this.translateFloatingElements(FloatingBottom,bottomVisible),this.translateFloatingElements(FloatingTop,topVisible)}onLeave(event){const{enabled,ctx:{scene}}=this,{relatedElement,targetElement}=event,{FloatingBottom,FloatingTop}=ToolbarPosition;!enabled||targetElement!==scene.canvas.element||TOOLBAR_GROUPS.some(group=>this.groupButtons[group].some(button=>button===relatedElement))||(this.translateFloatingElements(FloatingBottom,!1),this.translateFloatingElements(FloatingTop,!1))}onGroupChanged(group){this[group]==null||this.groupProxied.has(group)||(this.createGroup(group),this.toggleVisibilities())}onGroupButtonsChanged(group,buttons,configurationOnly){if(!(!this.enabled||this.groupProxied.has(group))){if(configurationOnly)for(const buttonOptions of this[group].buttonConfigurations())this.refreshButtonContent(group,buttonOptions);else this.createGroupButtons(group,buttons);this.toggleVisibilities()}}onLayoutComplete(opts){for(const position of TOOLBAR_POSITIONS)this.elements[position].classList.remove(modifiers2.preventFlash);this.enabled&&this.refreshInnerLayout(opts.series.rect)}toggleButtonsClass(className,enabled){for(const button of Object.values(this.groupButtons).flat())button.classList.toggle(className,enabled)}onPreDomUpdate(){this.toggleButtonsClass(modifiers2.button.withTransition,!1)}onUpdateComplete(){this.toggleButtonsClass(modifiers2.button.withTransition,!0)}onButtonUpdated(event){const{type:_type,group,id,...params}=event;this[group].overrideButtonConfiguration(id,{...params})}setButtonActive(button,active){button.classList.toggle(modifiers2.button.active,active)}setButtonChecked(button,checked){button.role==="switch"&&(button.ariaChecked=checked.toString())}setButtonGroupFirstLast(group){const childNodes=Array.from(group.childNodes??[]),setFirstClass=__name((first,button,modifier)=>{const buttonVisible=!button.classList.contains(modifiers2.button.hiddenToggled);return button.classList.toggle(modifier,buttonVisible&&first),buttonVisible?!1:first},"setFirstClass");childNodes.reduce((first,button)=>setFirstClass(first,button,modifiers2.button.first),!0),childNodes.reduceRight((last,button)=>setFirstClass(last,button,modifiers2.button.last),!0)}onButtonToggled(event){const{group,id,active,enabled,visible,checked}=event;if(this.groupButtons[group].length===0){this.pendingButtonToggledEvents.push(event);return}const button=this.groupButtons[group].find(b=>b.dataset.toolbarId===`${id}`);button!=null&&(button.ariaDisabled=`${!enabled}`,button.classList.toggle(modifiers2.button.hiddenToggled,!visible),this.setButtonActive(button,active),this.setButtonChecked(button,checked),this.setButtonGroupFirstLast(button.parentNode))}onGroupToggled(event){const{caller,group,active,visible}=event;this.toggleGroup(caller,group,active,visible),this.toggleVisibilities()}onGroupUpdated(event){const{group}=event;for(const ariaToolbar of this.ariaToolbars)if(ariaToolbar.groups.includes(group)){ariaToolbar.resetListeners();return}}onFloatingAnchorChanged(event){const{elements:elements3,positions,horizontalSpacing,verticalSpacing}=this,{group,anchor}=event,element2=elements3.floating;if(this.dragState.detached||element2.classList.contains(modifiers2.hidden)||(this.dragState.detached=!1,!positions.floating.has(group)))return;const position=anchor.position??"above",{offsetWidth:width,offsetHeight:height}=element2;let top=anchor.y-height-verticalSpacing,left=anchor.x-width/2;position==="below"?top=anchor.y+verticalSpacing:position==="right"?(top=anchor.y-height/2,left=anchor.x+horizontalSpacing):position==="above-left"&&(left=anchor.x);const groupBBox=new BBox(left,top,width,height);this.positionGroup(element2,group,groupBBox)}positionGroup(element2,group,bbox){const{ctx:{domManager}}=this,canvasRect=domManager.getBoundingClientRect();bbox.x=clamp(0,bbox.x,canvasRect.width-bbox.width),bbox.y=clamp(0,bbox.y,canvasRect.height-bbox.height);const left=`${Math.floor(bbox.x)}px`,top=`${Math.floor(bbox.y)}px`;(element2.style.getPropertyValue("left")!==left||element2.style.getPropertyValue("top")!==top)&&(element2.style.setProperty("left",left),element2.style.setProperty("top",top),this.onGroupMoved(group,bbox))}onGroupMoved(group,bbox){const{groupButtons,ctx:{toolbarManager}}=this;for(const button of groupButtons[group]){if(button.classList.contains(modifiers2.button.hiddenToggled))continue;const parent=button.offsetParent;toolbarManager.buttonMoved(group,button.dataset.toolbarId,new BBox(button.offsetLeft+((parent==null?void 0:parent.offsetLeft)??0),button.offsetTop+((parent==null?void 0:parent.offsetTop)??0),button.offsetWidth,button.offsetHeight),bbox)}}buttonRect(button,canvasRect=this.ctx.domManager.getBoundingClientRect()){const buttonRect=button.getBoundingClientRect();return new BBox(buttonRect.left-canvasRect.left,buttonRect.top-canvasRect.top,buttonRect.width,buttonRect.height)}onProxyGroupOptions(event){if(!this.enabled)return;const{caller,group,options}=event;this.groupProxied.set(group,options),this[group].set(options),this.toggleGroup(caller,group,void 0,options.enabled),this.createGroup(group,options.enabled,options.position),options.enabled&&this.createGroupButtons(group,options.buttons)}createGroup(group,enabled,position){enabled??(enabled=this[group].enabled),position??(position=this[group].position);for(const pos of TOOLBAR_POSITIONS)enabled&&position===pos?this.positions[pos].add(group):this.positions[pos].delete(group)}createGroupButtons(group,buttons=[]){var _a274;for(const button of this.groupButtons[group])button.remove();if(this.groupButtons[group]=[],buttons.length===0)return;const{align,position}=this[group],alignElement=this.positionAlignments[position][align];if(!alignElement)return;const nextSection=__name(section2=>{const alignElementChildren=Array.from(alignElement.children),dataGroup="data-group",dataSection="data-section";let sectionElement=alignElementChildren.find(prevSection2=>prevSection2.getAttribute(dataGroup)===group&&prevSection2.getAttribute(dataSection)===(section2??""));if(!sectionElement){sectionElement=createElement("div"),sectionElement.role="presentation",sectionElement.setAttribute(dataGroup,group),sectionElement.setAttribute(dataSection,section2??"");const groupIndex=TOOLBAR_GROUP_ORDERING[group],insertBeforeElement=alignElementChildren.find(prevSection2=>{const prevGroup=prevSection2.getAttribute(dataGroup);return TOOLBAR_GROUP_ORDERING[prevGroup]>groupIndex});insertBeforeElement!=null?alignElement.insertBefore(sectionElement,insertBeforeElement):alignElement.appendChild(sectionElement),this.destroyFns.push(()=>sectionElement.remove())}return sectionElement.classList.add(elements2.section,modifiers2[this[group].size]),sectionElement},"nextSection");let prevSection=(_a274=buttons.at(0))==null?void 0:_a274.section,section=nextSection(prevSection);for(const options of buttons){prevSection!==options.section&&(this.setButtonGroupFirstLast(section),section=nextSection(options.section)),prevSection=options.section;const button=this.createButtonElement(group,options);section.appendChild(button),this.groupButtons[group].push(button)}this.setButtonGroupFirstLast(section);const onEscape=__name(()=>{this.ctx.toolbarManager.cancel(group)},"onEscape");let onFocus,onBlur;isAnimatingFloatingPosition(position)&&(onFocus=__name(()=>this.translateFloatingElements(position,!0),"onFocus"),onBlur=__name(()=>this.translateFloatingElements(position,!1),"onBlur")),this.createAriaToolbar(group,alignElement,onFocus,onBlur,onEscape)}createAriaToolbar(group,toolbar,onFocus,onBlur,onEscape){const orientation=this.computeAriaOrientation(this[group].position),ariaToolbar=this.getAriaToolbar(group);ariaToolbar.resetListeners=()=>{const buttons=ariaToolbar.groups.map(g=>this.groupButtons[g]).flat().filter(b=>!b.classList.contains(modifiers2.button.hiddenToggled)&&!b.classList.contains(modifiers2.button.dragHandle));ariaToolbar.destroyFns.forEach(d=>d()),ariaToolbar.destroyFns=initToolbarKeyNav({orientation,toolbar,buttons,onEscape,onFocus,onBlur})},ariaToolbar.resetListeners(),this.updateToolbarAriaLabel(group,toolbar)}computeAriaOrientation(position){return{top:"horizontal",right:"vertical",bottom:"horizontal",left:"vertical",floating:"horizontal","floating-top":"horizontal","floating-bottom":"horizontal"}[position]}toggleGroup(caller,group,active,enabled){if(enabled===!0?this.groupCallers[group].add(caller):enabled===!1&&this.groupCallers[group].delete(caller),active!=null)for(const button of this.groupButtons[group])this.setButtonActive(button,active)}processPendingEvents(){const pendingButtonToggledEvents=(this.pendingButtonToggledEvents??[]).slice();for(const event of pendingButtonToggledEvents)this.onButtonToggled(event);this.pendingButtonToggledEvents=[]}onLayoutStart(ctx){this.enabled&&(this.refreshOuterLayout(ctx.layoutBox),this.refreshLocale())}refreshOuterLayout(shrinkRect){const{elements:elements3,horizontalSpacing,verticalSpacing}=this;elements3.top.classList.contains(modifiers2.hidden)||shrinkRect.shrink(elements3.top.offsetHeight+verticalSpacing,"top"),elements3.right.classList.contains(modifiers2.hidden)||shrinkRect.shrink(elements3.right.offsetWidth+horizontalSpacing,"right"),elements3.bottom.classList.contains(modifiers2.hidden)||(shrinkRect.shrink(elements3.bottom.offsetHeight+verticalSpacing,"bottom"),elements3.bottom.style.top=`${shrinkRect.y+shrinkRect.height+verticalSpacing}px`),elements3.left.classList.contains(modifiers2.hidden)||shrinkRect.shrink(elements3.left.offsetWidth+horizontalSpacing,"left")}refreshLocale(){const{hasNewLocale}=this;if(hasNewLocale){for(const group of TOOLBAR_GROUPS){const buttons=this[group].buttonConfigurations();for(const buttonOptions of buttons)this.refreshButtonContent(group,buttonOptions);this.updateToolbarAriaLabel(group)}this.hasNewLocale=!1}}refreshInnerLayout(rect){const{elements:elements3,verticalSpacing}=this,{FloatingBottom,FloatingTop}=ToolbarPosition;elements3.top.style.top=`${rect.y-elements3.top.offsetHeight-verticalSpacing}px`,elements3.top.style.left=`${rect.x}px`,elements3.top.style.width=`${rect.width}px`,elements3.bottom.style.left=`${rect.x}px`,elements3.bottom.style.width=`${rect.width}px`,elements3.right.style.top=`${rect.y}px`,elements3.right.style.right="0px",elements3.right.style.height=`${rect.height}px`,elements3.left.style.top=`${rect.y}px`,elements3.left.style.left="0px",elements3.left.style.height=`${rect.height}px`,elements3[FloatingTop].style.top=`${rect.y}px`,elements3[FloatingBottom].style.top=`${rect.y+rect.height-elements3[FloatingBottom].offsetHeight}px`}refreshButtonContent(group,buttonOptions){var _a274,_b;const id=this.buttonId(buttonOptions),button=((_b=(_a274=this.groupProxied.get(group))==null?void 0:_a274.buttons)==null?void 0:_b.find(b=>this.buttonId(b)===id))??buttonOptions,element2=this.groupButtons[group].find(b=>b.getAttribute("data-toolbar-id")===id);element2!=null&&this.updateButton(element2,button)}toggleVisibilities(){if(this.elements==null)return;const isGroupVisible=__name(group=>this[group].enabled&&this.groupCallers[group].size>0,"isGroupVisible"),isButtonVisible=__name(element2=>button=>{const id=this.buttonId(button);return id==null||id===element2.dataset.toolbarId},"isButtonVisible");for(const position of TOOLBAR_POSITIONS){const visible=this.enabled&&Array.from(this.positions[position].values()).some(isGroupVisible);position==="floating"&&!visible&&(this.dragState.detached=!1),this.elements[position].classList.toggle(modifiers2.hidden,!visible)}for(const group of TOOLBAR_GROUPS){if(this[group]==null)continue;const groupVisible=isGroupVisible(group);for(const button of this.groupButtons[group]){const buttonVisible=groupVisible&&this[group].buttonConfigurations().some(isButtonVisible(button));button.classList.toggle(modifiers2.button.hiddenValue,!buttonVisible)}}}translateFloatingElements(position,visible){const{elements:elements3,verticalSpacing:verticalMargin,positionAlignments}=this,element2=elements3[position],alignments=Object.values(positionAlignments[position]);element2.classList.toggle(modifiers2.floatingHidden,!visible);const dir=position==="floating-bottom"?1:-1;for(const align of alignments)align.style.transform=visible&&align.style.transform!==""?"translateY(0)":`translateY(${(element2.offsetHeight+verticalMargin)*dir}px)`}renderToolbar(position="top"){const element2=this.elements[position];element2.classList.add(block2,modifiers2[position],modifiers2.preventFlash),isAnimatingFloatingPosition(position)&&element2.classList.add(modifiers2.floatingHidden);for(const align of TOOLBAR_ALIGNMENTS){const alignmentElement=createElement("div");alignmentElement.role="presentation",alignmentElement.classList.add(elements2.align,modifiers2.align[align]),alignmentElement.dataset.pointerCapture="exclusive",element2.appendChild(alignmentElement),this.positionAlignments[position][align]=alignmentElement}}createButtonElement(group,options){const button=createElement("button");return button.classList.add(elements2.button),button.dataset.toolbarGroup=group,setAttribute(button,"tabindex",-1),options.haspopup&&setAttributes(button,{"aria-haspopup":!0,"aria-expanded":!1}),button.dataset.toolbarId=this.buttonId(options),button.addEventListener("click",makeAccessibleClickListener(button,event=>this.onButtonPress(event,button,group,options.id,options.value))),options.value==="drag"&&(button.addEventListener("mousedown",makeAccessibleClickListener(button,event=>this.onDragStart(event,button,group))),button.classList.add(modifiers2.button.dragHandle)),options.role==="switch"&&setAttributes(button,{role:options.role,"aria-checked":!1}),this.updateButton(button,options),this.destroyFns.push(()=>button.remove()),button}getAriaToolbar(group){for(const ariaToolbar of this.ariaToolbars)if(ariaToolbar.groups.includes(group))return ariaToolbar;throw new Error(`AG Charts - cannot find aria-toolbar of '${group}'`)}updateToolbarAriaLabel(group,alignElement){if(!alignElement){const{align,position}=this[group];if(alignElement=this.positionAlignments[position][align],!alignElement)return}const map={seriesType:"ariaLabelFinancialCharts",annotations:"ariaLabelFinancialCharts",annotationOptions:"ariaLabelAnnotationOptionsToolbar",ranges:"ariaLabelRangesToolbar",zoom:"ariaLabelZoomToolbar"};alignElement.ariaLabel=this.ctx.localeManager.t(map[group])}expandButtonConfig(button,options){return options.role!=="switch"||button.ariaChecked!=="true"||options.checkedOverrides===void 0?options:{icon:options.checkedOverrides.icon??options.icon,label:options.checkedOverrides.label??options.label,ariaLabel:options.checkedOverrides.ariaLabel??options.ariaLabel,tooltip:options.checkedOverrides.tooltip??options.tooltip}}updateButton(button,options){const{domManager,localeManager}=this.ctx,{icon,label,ariaLabel,tooltip}=this.expandButtonConfig(button,options);tooltip&&(button.title=localeManager.t(tooltip));let inner="";if(icon!=null&&(inner=`<span class="${domManager.getIconClassNames(icon)} ${elements2.icon}"></span>`),label!=null){const tlabel=localeManager.t(label);inner=`${inner}<span class="${elements2.label}">${tlabel}</span>`}button.innerHTML=inner,button.classList.toggle(modifiers2.button.fillVisible,options.fill!=null),button.style.setProperty("--fill",options.fill??null);const strokeWidthVisible=options.strokeWidth!=null;button.classList.toggle(modifiers2.button.strokeWidthVisible,strokeWidthVisible),button.style.setProperty("--strokeWidth",strokeWidthVisible?`${options.strokeWidth}px`:null);const tAriaLabel=ariaLabel?this.ctx.localeManager.t(ariaLabel):void 0;setAttribute(button,"aria-label",tAriaLabel)}onButtonPress(event,button,group,id,value){this.ctx.toolbarManager.pressButton(group,this.buttonId({id,value}),value,this.buttonRect(button),event)}onDragStart(event,button,group){const element2=this.elements.floating;event.preventDefault(),event.stopPropagation(),this.dragState={client:Vec2.from(event.clientX,event.clientY),position:Vec2.from(Number(element2.style.getPropertyValue("left").replace("px","")),Number(element2.style.getPropertyValue("top").replace("px",""))),detached:!0},button.classList.toggle(modifiers2.button.dragging,!0);const onDrag=__name(e=>this.onDrag(e,group),"onDrag"),onDragEnd=__name(()=>{button.classList.toggle(modifiers2.button.dragging,!1),window2.removeEventListener("mousemove",onDrag)},"onDragEnd"),window2=getWindow();window2.addEventListener("mousemove",onDrag),window2.addEventListener("mouseup",onDragEnd,{once:!0}),this.ctx.toolbarManager.groupMoved(group)}onDrag(event,group){const{elements:elements3,dragState}=this,element2=elements3.floating,{offsetWidth:width,offsetHeight:height}=element2,offset4=Vec2.sub(Vec2.from(event.clientX,event.clientY),dragState.client),position=Vec2.add(dragState.position,offset4),groupBBox=new BBox(position.x,position.y,width,height);this.positionGroup(element2,group,groupBBox)}buttonId(button){const{id,value,label}=button;return id??(value!=null&&typeof value!="object"?String(value):label??"")}},__name(_a240,"Toolbar"),_a240);__decorateClass([ObserveChanges(target=>{target.processPendingEvents(),target.toggleVisibilities()}),Validate(BOOLEAN)],Toolbar.prototype,"enabled",2);var DAY=1e3*60*60*24,MONTH=DAY*30,YEAR=DAY*365,seriesType={enabled:!1,position:"left",align:"start",buttons:[{tooltip:"toolbarSeriesTypeDropdown",value:"type",haspopup:!0}]},annotations={enabled:!0,position:"left",align:"start",buttons:[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu",section:"line-annotations",haspopup:!0},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu",section:"text-annotations",haspopup:!0},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu",section:"shape-annotations",haspopup:!0},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear",section:"tools"}]},annotationOptions={enabled:!0,position:"floating",align:"start",draggable:!0,buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color",haspopup:!0},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color",haspopup:!0},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color",haspopup:!0},{tooltip:"toolbarAnnotationsTextSize",value:"text-size",haspopup:!0},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width",haspopup:!0},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type",haspopup:!0},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings",haspopup:!0},{role:"switch",icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]},ranges={enabled:!1,position:DEFAULT_TOOLBAR_POSITION,align:"start",buttons:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:MONTH},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:3*MONTH},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:6*MONTH},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:__name((_start,end)=>[new Date(`${new Date(end).getFullYear()}-01-01`).getTime(),end],"value"),id:"year-to-date"},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:YEAR},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:__name((start,end)=>[start,end],"value"),id:"all"}]},zoom={enabled:!0,position:"top",align:"end",buttons:[{icon:"zoom-out",tooltip:"toolbarZoomZoomOut",value:"zoom-out"},{icon:"zoom-in",tooltip:"toolbarZoomZoomIn",value:"zoom-in"},{icon:"pan-left",tooltip:"toolbarZoomPanLeft",value:"pan-left"},{icon:"pan-right",tooltip:"toolbarZoomPanRight",value:"pan-right"},{icon:"pan-start",tooltip:"toolbarZoomPanStart",value:"pan-start"},{icon:"pan-end",tooltip:"toolbarZoomPanEnd",value:"pan-end"},{icon:"reset",tooltip:"toolbarZoomReset",value:"reset"}]},ToolbarModule={type:"root",optionsKey:"toolbar",packageType:"community",chartTypes:["cartesian"],moduleFactory:__name(ctx=>new Toolbar(ctx),"moduleFactory"),themeTemplate:{toolbar:{enabled:!0,seriesType,annotations,annotationOptions,ranges,zoom}}};function registerInbuiltModules(){moduleRegistry.register(BackgroundModule,CommunityLegendModule,LocaleModule,NavigatorModule,ToolbarModule,AreaSeriesModule,BarSeriesModule,BubbleSeriesModule,LineSeriesModule,ScatterSeriesModule,DonutSeriesModule,PieSeriesModule,HistogramSeriesModule);for(const AxisConstructor of[NumberAxis,CategoryAxis,TimeAxis,GroupedCategoryAxis,LogAxis])axisRegistry.register(AxisConstructor.type,{moduleFactory:__name(ctx=>new AxisConstructor(ctx),"moduleFactory"),hidden:AxisConstructor===GroupedCategoryAxis})}__name(registerInbuiltModules,"registerInbuiltModules");function setupModules(){for(const m of moduleRegistry.modules){if(m.packageType==="enterprise"&&!verifyIfModuleExpected(m)&&Logger.errorOnce("Unexpected enterprise module registered: "+m.identifier),m.type==="root"&&m.themeTemplate)for(const chartType2 of m.chartTypes)chartDefaults.set(chartType2,m.themeTemplate);if(m.type==="series"){if(m.chartTypes.length>1)throw new Error(`AG Charts - Module definition error: ${m.identifier}`);seriesRegistry.register(m.identifier,m)}if(m.type==="series-option"&&m.themeTemplate)for(const seriesType2 of m.seriesTypes)seriesRegistry.setThemeTemplate(seriesType2,m.themeTemplate);if(m.type==="axis-option"&&m.themeTemplate)for(const axisType of m.axisTypes){const axisTypeTheme=axisRegistry.getThemeTemplate(axisType),theme=mergeDefaults(m.themeTemplate,axisTypeTheme);axisRegistry.setThemeTemplate(axisType,theme)}m.type==="axis"&&axisRegistry.register(m.identifier,m),m.type==="legend"&&legendRegistry.register(m.identifier,m)}if(moduleRegistry.hasEnterpriseModules()){const expectedButUnused=getUnusedExpectedModules();expectedButUnused.length>0&&Logger.errorOnce("Enterprise modules expected but not registered: ",expectedButUnused)}}__name(setupModules,"setupModules");function isFlowProportion(series){return series.type==="sankey"||series.type==="chord"}__name(isFlowProportion,"isFlowProportion");var _a241,FlowProportionChart=(_a241=class extends Chart{getChartType(){return"flow-proportion"}async updateData(){await super.updateData();const{nodes}=this.getOptions();this.series.forEach(series=>{isFlowProportion(series)&&series.setChartNodes(nodes)})}performLayout(ctx){const{seriesRoot,annotationRoot,highlightRoot}=this,{layoutBox}=ctx,seriesRect=layoutBox.clone();layoutBox.shrink(this.seriesArea.padding.toJson()),this.seriesRect=layoutBox,this.animationRect=layoutBox,seriesRoot.visible=this.series.some(s=>s.visible);for(const group of[seriesRoot,annotationRoot,highlightRoot])group.translationX=Math.floor(layoutBox.x),group.translationY=Math.floor(layoutBox.y),group.setClipRectInGroupCoordinateSpace(seriesRect.clone());this.ctx.layoutManager.emitLayoutComplete(ctx,{series:{visible:seriesRoot.visible,rect:seriesRect,paddedRect:layoutBox}})}},__name(_a241,"FlowProportionChart"),_a241);FlowProportionChart.className="FlowProportionChart";FlowProportionChart.type="flow-proportion";var _a242,PolarAxis=(_a242=class extends Axis{constructor(){super(...arguments),this.shape="polygon",this.innerRadiusRatio=0,this.defaultTickMinSpacing=20}computeLabelsBBox(_options,_seriesRect){return null}computeRange(){}getAxisLinePoints(){}},__name(_a242,"PolarAxis"),_a242);__decorateClass([Validate(UNION(["polygon","circle"],"a polar axis shape"))],PolarAxis.prototype,"shape",2);__decorateClass([Validate(RATIO)],PolarAxis.prototype,"innerRadiusRatio",2);function isRadialGaugeSeries(series){return series.type==="radial-gauge"}__name(isRadialGaugeSeries,"isRadialGaugeSeries");function isLinearGaugeSeries(series){return series.type==="linear-gauge"}__name(isLinearGaugeSeries,"isLinearGaugeSeries");var _a243,GaugeChart=(_a243=class extends Chart{getChartType(){return"gauge"}updateRadialGauge(seriesRect,series){const angleAxis=this.axes.find(axis=>axis.direction==="x");if(!(angleAxis instanceof PolarAxis))return;angleAxis.computeRange();const seriesRectX0=seriesRect.x,seriesRectX1=seriesRectX0+seriesRect.width,seriesRectY0=seriesRect.y,seriesRectY1=seriesRectY0+seriesRect.height,[startAngle,endAngle]=angleAxis.range,largerThanHalf=normalizeAngle360Inclusive(endAngle-startAngle)>Math.PI,containsTop=largerThanHalf||isBetweenAngles(1.5*Math.PI,startAngle,endAngle),containsRight=largerThanHalf||isBetweenAngles(0*Math.PI,startAngle,endAngle),containsBottom=largerThanHalf||isBetweenAngles(.5*Math.PI,startAngle,endAngle),containsLeft=largerThanHalf||isBetweenAngles(1*Math.PI,startAngle,endAngle);let textAlign;containsLeft&&!containsRight?textAlign="right":!containsLeft&&containsRight?textAlign="left":textAlign="center";let verticalAlign;containsTop&&!containsBottom?verticalAlign="bottom":!containsTop&&containsBottom?verticalAlign="top":verticalAlign="middle";const unitBox=sectorBox({startAngle,endAngle,innerRadius:0,outerRadius:.5}),centerXOffset=-(unitBox.x+unitBox.width/2)*2,centerYOffset=-(unitBox.y+unitBox.height/2)*2,{minimumRadius=0,maximumRadius}=series,radiusBounds=Math.max(.5*Math.min(seriesRect.width/unitBox.width,seriesRect.height/unitBox.height),0);let radius=Math.min(maximumRadius??1/0,Math.max(radiusBounds,minimumRadius??0));const MAX_ITERATIONS=8;for(let i=0;i<MAX_ITERATIONS;i+=1){const isFinalIteration=radius<=minimumRadius||i===MAX_ITERATIONS-1,centerX=seriesRect.x+seriesRect.width/2+centerXOffset*radius,centerY=seriesRect.y+seriesRect.height/2+centerYOffset*radius;angleAxis.translation.x=centerX,angleAxis.translation.y=centerY,angleAxis.gridLength=radius,angleAxis.calculateLayout();const bbox=angleAxis.computeLabelsBBox({hideWhenNecessary:isFinalIteration},seriesRect);if(isFinalIteration)break;let shrinkDelta=0;if(bbox!=null){const bboxX0=bbox.x+centerX,bboxX1=bboxX0+bbox.width,bboxY0=bbox.y+centerY,bboxY1=bboxY0+bbox.height;shrinkDelta=Math.max(seriesRectY0-bboxY0,seriesRectX0-bboxX0,bboxY1-seriesRectY1,bboxX1-seriesRectX1,0)}if(shrinkDelta>0)radius=Math.max(radius-shrinkDelta,minimumRadius);else break}angleAxis.translation.x=seriesRect.x+seriesRect.width/2+centerXOffset*radius,angleAxis.translation.y=seriesRect.y+seriesRect.height/2+centerYOffset*radius,series.centerX=seriesRect.width/2+centerXOffset*radius,series.centerY=seriesRect.height/2+centerYOffset*radius,series.radius=radius,series.textAlign=textAlign,series.verticalAlign=verticalAlign,(radius===0||radius>radiusBounds)&&Logger.warnOnce("There was insufficient space to display the Radial Gauge.")}updateLinearGauge(seriesRect,series){const xAxis=this.axes.find(axis=>axis.direction==="x"),yAxis=this.axes.find(axis=>axis.direction==="y");if(!(xAxis instanceof CartesianAxis)||!(yAxis instanceof CartesianAxis))return seriesRect;const{horizontal,thickness}=series,width=Math.max(horizontal?seriesRect.width:thickness,0),height=Math.max(horizontal?thickness:seriesRect.height,0),x0=seriesRect.x+(seriesRect.width-width)/2,y0=seriesRect.y+(seriesRect.height-height)/2;xAxis.range=[0,width],xAxis.gridLength=width,xAxis.calculateLayout(),xAxis.translation.x=x0,xAxis.translation.y=y0+(xAxis.position==="bottom"?thickness:0),yAxis.range=[0,height],yAxis.gridLength=height,yAxis.calculateLayout(),yAxis.translation.x=x0+(yAxis.position==="right"?thickness:0),yAxis.translation.y=y0,series.originX=x0-seriesRect.x,series.originY=y0-seriesRect.y,(width===0||height===0)&&Logger.warnOnce("There was insufficient space to display the Linear Gauge.")}performLayout(ctx){const{seriesRoot,annotationRoot,highlightRoot,series,seriesArea}=this,{layoutBox}=ctx,seriesRect=layoutBox.clone();layoutBox.shrink(seriesArea.padding.toJson());const firstSeries=this.series[0];isRadialGaugeSeries(firstSeries)?this.updateRadialGauge(layoutBox,firstSeries):isLinearGaugeSeries(firstSeries)&&this.updateLinearGauge(layoutBox,firstSeries),this.axes.forEach(axis=>axis.update()),this.seriesRect=seriesRect.clone().translate(seriesRect.x-layoutBox.x,seriesRect.y-layoutBox.y),this.animationRect=layoutBox,seriesRoot.visible=series.some(s=>s.visible);for(const group of[seriesRoot,annotationRoot,highlightRoot])group.translationX=Math.floor(layoutBox.x),group.translationY=Math.floor(layoutBox.y);this.ctx.layoutManager.emitLayoutComplete(ctx,{series:{visible:seriesRoot.visible,rect:seriesRect,paddedRect:layoutBox}})}getAriaLabel(){const captions=[],chartCaption=this.getCaptionText();chartCaption.length!==0&&captions.push(chartCaption);for(const series of this.series)captions.push(series.getCaptionText());const caption=captions.join(". ");return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption})}},__name(_a243,"GaugeChart"),_a243);GaugeChart.className="GaugeChart";GaugeChart.type="gauge";var _a244,HierarchyChart=(_a244=class extends Chart{constructor(options,resources){super(options,resources)}getChartType(){return"hierarchy"}performLayout(ctx){const{seriesRoot,annotationRoot,highlightRoot}=this,{layoutBox}=ctx,seriesRect=layoutBox.clone();layoutBox.shrink(this.seriesArea.padding.toJson()),this.seriesRect=layoutBox,this.animationRect=layoutBox;for(const group of[seriesRoot,annotationRoot,highlightRoot])group.translationX=Math.floor(layoutBox.x),group.translationY=Math.floor(layoutBox.y);seriesRoot.visible=this.series[0].visible,seriesRoot.setClipRectInGroupCoordinateSpace(layoutBox.clone()),this.ctx.layoutManager.emitLayoutComplete(ctx,{series:{visible:!0,rect:seriesRect,paddedRect:layoutBox}})}getAriaLabel(){const caption=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption})}},__name(_a244,"HierarchyChart"),_a244);HierarchyChart.className="HierarchyChart";HierarchyChart.type="hierarchy";var _a245,PolarChart=(_a245=class extends Chart{constructor(options,resources){super(options,resources),this.padding=new Padding(40),this.ctx.axisManager.axisGroup.zIndex=6}getChartType(){return"polar"}async performLayout(ctx){const{layoutBox}=ctx,seriesRect=layoutBox.clone();layoutBox.shrink(this.seriesArea.padding.toJson()),this.seriesRect=layoutBox,this.animationRect=layoutBox,await this.computeCircle(layoutBox),this.axes.forEach(axis=>axis.update()),this.ctx.layoutManager.emitLayoutComplete(ctx,{series:{visible:!0,rect:seriesRect,paddedRect:layoutBox}})}updateAxes(cx,cy,radius){var _a274;const angleAxis=this.axes.find(axis=>axis.direction==="x"),radiusAxis=this.axes.find(axis=>axis.direction==="y");if(!(angleAxis instanceof PolarAxis)||!(radiusAxis instanceof PolarAxis))return;const angleScale=angleAxis.scale,innerRadiusRatio=radiusAxis.innerRadiusRatio;angleAxis.innerRadiusRatio=innerRadiusRatio,angleAxis.computeRange(),angleAxis.gridLength=radius,radiusAxis.gridAngles=(_a274=angleScale.ticks)==null?void 0:_a274.call(angleScale).map(value=>angleScale.convert(value)),radiusAxis.gridRange=angleAxis.range,radiusAxis.range=[radius,radius*innerRadiusRatio],[angleAxis,radiusAxis].forEach(axis=>{axis.translation.x=cx,axis.translation.y=cy,axis.calculateLayout()})}async computeCircle(seriesBox){const polarSeries=this.series.filter(isPolarSeries),polarAxes=this.axes.filter(isPolarAxis),setSeriesCircle=__name((cx,cy,r)=>{this.updateAxes(cx,cy,r),polarSeries.forEach(series=>{series.centerX=cx,series.centerY=cy,series.radius=r});const pieSeries=polarSeries.filter(s=>s.type==="donut"||s.type==="pie");if(pieSeries.length>1){const innerRadii=pieSeries.map(series=>{const innerRadius=series.getInnerRadius();return{series,innerRadius}}).sort((a,b)=>a.innerRadius-b.innerRadius);innerRadii.at(-1).series.surroundingRadius=void 0;for(let i=0;i<innerRadii.length-1;i++)innerRadii[i].series.surroundingRadius=innerRadii[i+1].innerRadius}},"setSeriesCircle"),centerX=seriesBox.x+seriesBox.width/2,centerY=seriesBox.y+seriesBox.height/2,initialRadius=Math.max(0,Math.min(seriesBox.width,seriesBox.height)/2);let radius=initialRadius;setSeriesCircle(centerX,centerY,radius);const shake=__name(async({hideWhenNecessary=!1}={})=>{const labelBoxes=[];for(const series of iterate(polarAxes,polarSeries)){const box=await series.computeLabelsBBox({hideWhenNecessary},seriesBox);box&&labelBoxes.push(box)}if(labelBoxes.length===0){setSeriesCircle(centerX,centerY,initialRadius);return}const labelBox=BBox.merge(labelBoxes),refined=this.refineCircle(labelBox,radius,seriesBox);setSeriesCircle(refined.centerX,refined.centerY,refined.radius),radius=refined.radius},"shake");await shake(),await shake(),await shake(),await shake({hideWhenNecessary:!0}),await shake({hideWhenNecessary:!0});for(const series of iterate(polarAxes,polarSeries))await series.computeLabelsBBox({hideWhenNecessary:!0},seriesBox);return{radius,centerX,centerY}}refineCircle(labelsBox,radius,seriesBox){const circleLeft=-radius,circleTop=-radius,circleRight=radius,circleBottom=radius;let padLeft=Math.max(0,circleLeft-labelsBox.x),padTop=Math.max(0,circleTop-labelsBox.y),padRight=Math.max(0,labelsBox.x+labelsBox.width-circleRight),padBottom=Math.max(0,labelsBox.y+labelsBox.height-circleBottom);padLeft=padRight=Math.max(padLeft,padRight),padTop=padBottom=Math.max(padTop,padBottom);const availCircleWidth=seriesBox.width-padLeft-padRight,availCircleHeight=seriesBox.height-padTop-padBottom;let newRadius=Math.min(availCircleWidth,availCircleHeight)/2;const minHorizontalRadius=.5*seriesBox.width/2,minVerticalRadius=.5*seriesBox.height/2,minRadius=Math.min(minHorizontalRadius,minVerticalRadius);if(newRadius<minRadius){newRadius=minRadius;const horizontalPadding=padLeft+padRight,verticalPadding=padTop+padBottom;if(2*newRadius+verticalPadding>seriesBox.height){const padHeight=seriesBox.height-2*newRadius;Math.min(padTop,padBottom)*2>padHeight?(padTop=padHeight/2,padBottom=padHeight/2):padTop>padBottom?padTop=padHeight-padBottom:padBottom=padHeight-padTop}if(2*newRadius+horizontalPadding>seriesBox.width){const padWidth=seriesBox.width-2*newRadius;Math.min(padLeft,padRight)*2>padWidth?(padLeft=padWidth/2,padRight=padWidth/2):padLeft>padRight?padLeft=padWidth-padRight:padRight=padWidth-padLeft}}const newWidth=padLeft+2*newRadius+padRight,newHeight=padTop+2*newRadius+padBottom;return{centerX:seriesBox.x+(seriesBox.width-newWidth)/2+padLeft+newRadius,centerY:seriesBox.y+(seriesBox.height-newHeight)/2+padTop+newRadius,radius:newRadius}}},__name(_a245,"PolarChart"),_a245);PolarChart.className="PolarChart";PolarChart.type="polar";function isPolarSeries(series){return series instanceof PolarSeries}__name(isPolarSeries,"isPolarSeries");function isPolarAxis(axis){return axis instanceof PolarAxis}__name(isPolarAxis,"isPolarAxis");var radsInDeg=Math.PI/180,lonX=__name(lon=>lon*radsInDeg,"lonX"),latY=__name(lat=>-Math.log(Math.tan(Math.PI*.25+lat*radsInDeg*.5)),"latY"),xLon=__name(x=>x/radsInDeg,"xLon"),yLat=__name(y=>(Math.atan(Math.exp(-y))-Math.PI*.25)/(radsInDeg*.5),"yLat"),_a246,MercatorScale=(_a246=class{constructor(domain,range3){this.domain=domain,this.range=range3,this.type="mercator",this.bounds=_a246.bounds(domain)}static bounds(domain){const[[lon0,lat0],[lon1,lat1]]=domain,x0=lonX(lon0),y0=latY(lat0),x1=lonX(lon1),y1=latY(lat1);return new BBox(Math.min(x0,x1),Math.min(y0,y1),Math.abs(x1-x0),Math.abs(y1-y0))}static fixedScale(){return new _a246([[xLon(0),yLat(0)],[xLon(1),yLat(1)]],[[0,0],[1,1]])}convert([lon,lat]){const[[x0,y0],[x1,y1]]=this.range,xScale=(x1-x0)/this.bounds.width,yScale=(y1-y0)/this.bounds.height;return[(lonX(lon)-this.bounds.x)*xScale+x0,(latY(lat)-this.bounds.y)*yScale+y0]}invert([x,y]){const[[x0,y0],[x1,y1]]=this.range,xScale=(x1-x0)/this.bounds.width,yScale=(y1-y0)/this.bounds.height;return[xLon((x-x0)/xScale+this.bounds.x),yLat((y-y0)/yScale+this.bounds.y)]}},__name(_a246,"_MercatorScale"),_a246);function isTopologySeries(series){return series.type==="map-shape"||series.type==="map-line"||series.type==="map-marker"||series.type==="map-shape-background"||series.type==="map-line-background"}__name(isTopologySeries,"isTopologySeries");var _a247,TopologyChart=(_a247=class extends Chart{constructor(options,resources){super(options,resources),this.xAxis=new NumberAxis(this.getModuleContext()),this.xAxis.position="bottom",this.yAxis=new NumberAxis(this.getModuleContext()),this.yAxis.position="left",this.ctx.zoomManager.updateAxes([this.xAxis,this.yAxis])}getChartType(){return"topology"}async updateData(){await super.updateData();const{topology}=this.getOptions();this.series.forEach(series=>{isTopologySeries(series)&&series.setChartTopology(topology)})}performLayout(ctx){const{seriesRoot,annotationRoot,highlightRoot}=this,{layoutBox}=ctx,seriesRect=layoutBox.clone();layoutBox.shrink(this.seriesArea.padding.toJson()),this.seriesRect=layoutBox,this.animationRect=layoutBox;const mapSeries=this.series.filter(isTopologySeries),combinedBbox=mapSeries.reduce((combined,series)=>{if(!series.visible)return combined;const bbox=series.topologyBounds;return bbox==null?combined:combined==null?bbox:(combined.merge(bbox),combined)},void 0);let scale2;if(combinedBbox!=null){const{lon0,lat0,lon1,lat1}=combinedBbox,domain=[[lon0,lat0],[lon1,lat1]],bounds=MercatorScale.bounds(domain),{width,height}=layoutBox,viewBoxScale=Math.min(width/bounds.width,height/bounds.height),viewBoxWidth=bounds.width*viewBoxScale,viewBoxHeight=bounds.height*viewBoxScale,viewBoxOriginX=(width-viewBoxWidth)/2,viewBoxOriginY=(height-viewBoxHeight)/2,x0=viewBoxOriginX,y0=viewBoxOriginY,x1=viewBoxOriginX+viewBoxWidth,y1=viewBoxOriginY+viewBoxHeight,xZoom=this.ctx.zoomManager.getAxisZoom(this.xAxis.id),yZoom=this.ctx.zoomManager.getAxisZoom(this.yAxis.id),xSpan=(x1-x0)/(xZoom.max-xZoom.min),xStart=x0-xSpan*xZoom.min,ySpan=(y1-y0)/(1-yZoom.min-(1-yZoom.max)),yStart=y0-ySpan*(1-yZoom.max);scale2=new MercatorScale(domain,[[xStart,yStart],[xStart+xSpan,yStart+ySpan]])}mapSeries.forEach(series=>{series.scale=scale2});const seriesVisible=this.series.some(s=>s.visible);seriesRoot.visible=seriesVisible;for(const group of[seriesRoot,annotationRoot,highlightRoot])group.translationX=Math.floor(layoutBox.x),group.translationY=Math.floor(layoutBox.y),group.setClipRectInGroupCoordinateSpace(layoutBox.clone());this.ctx.layoutManager.emitLayoutComplete(ctx,{series:{visible:seriesVisible,rect:seriesRect,paddedRect:layoutBox}})}},__name(_a247,"TopologyChart"),_a247);TopologyChart.className="TopologyChart";TopologyChart.type="topology";var enterpriseModule={isEnterprise:!1},IGNORED_PROP=Symbol("IGNORED_PROP");function pickProps(opts,values){const out={};for(const key in values){const value=values[key];value!==IGNORED_PROP&&Object.hasOwn(opts,key)&&(out[key]=value)}return out}__name(pickProps,"pickProps");function isRadialGauge(opts){return opts.type==="radial-gauge"}__name(isRadialGauge,"isRadialGauge");function isLinearGauge(opts){return opts.type==="linear-gauge"}__name(isLinearGauge,"isLinearGauge");function radialGaugeOptions(opts){const{animation,background,container,contextMenu,footnote,height,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,width,type,cursor,nodeClickRange,tooltip,value,scale:scale2={},startAngle,endAngle,highlightStyle,segmentation,bar,needle,targets,outerRadius,innerRadius,outerRadiusRatio,innerRadiusRatio,cornerRadius,cornerMode,label,secondaryLabel,spacing,...rest}=opts,{fills:scaleFills,fillMode:scaleFillMode,fill:scaleFill,fillOpacity:scaleFillOpacity,stroke:scaleStroke,strokeWidth:scaleStrokeWidth,strokeOpacity:scaleStrokeOpacity,lineDash:scaleLineDash,lineDashOffset:scaleLineDashOffset,min:scaleMin=0,max:scaleMax=1,interval:scaleInterval={},label:scaleLabel={},...scaleRest}=scale2,chartOpts=pickProps(opts,{animation,background,container,contextMenu,footnote,height,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,width}),scaleOpts=pickProps(scale2,{fills:scaleFills,fillMode:scaleFillMode,fill:scaleFill,fillOpacity:scaleFillOpacity,stroke:scaleStroke,strokeWidth:scaleStrokeWidth,strokeOpacity:scaleStrokeOpacity,lineDash:scaleLineDash,lineDashOffset:scaleLineDashOffset}),seriesOpts=pickProps(opts,{startAngle:IGNORED_PROP,endAngle:IGNORED_PROP,needle:needle!=null?{enabled:!0,...needle}:IGNORED_PROP,scale:scaleOpts,type,cursor,nodeClickRange,listeners,tooltip,value,highlightStyle,segmentation,bar,targets,outerRadius,innerRadius,outerRadiusRatio,innerRadiusRatio,cornerRadius,cornerMode,label,secondaryLabel,spacing,...rest});return{...chartOpts,series:[seriesOpts],axes:[{type:"angle-number",min:scaleMin??0,max:scaleMax??1,startAngle:startAngle??270,endAngle:endAngle??450,interval:scaleInterval??{},label:scaleLabel??{},nice:!1,line:{enabled:!1}},{type:"radius-number"}]}}__name(radialGaugeOptions,"radialGaugeOptions");function linearGaugeOptions(opts){const{animation,background,container,contextMenu,footnote,height,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,width,type,cursor,nodeClickRange,tooltip,value,scale:scale2={},direction="vertical",thickness,highlightStyle,segmentation,bar,targets,target,cornerRadius,cornerMode,...rest}=opts,{fills:scaleFills,fillMode:scaleFillMode,fill:scaleFill,fillOpacity:scaleFillOpacity,stroke:scaleStroke,strokeWidth:scaleStrokeWidth,strokeOpacity:scaleStrokeOpacity,lineDash:scaleLineDash,lineDashOffset:scaleLineDashOffset,min:scaleMin=0,max:scaleMax=1,interval:scaleInterval={},label:scaleLabel={},...scaleRest}=scale2,chartOpts=pickProps(opts,{animation,background,container,contextMenu,footnote,height,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,width}),scaleOpts=pickProps(scale2,{fills:scaleFills,fillMode:scaleFillMode,fill:scaleFill,fillOpacity:scaleFillOpacity,stroke:scaleStroke,strokeWidth:scaleStrokeWidth,strokeOpacity:scaleStrokeOpacity,lineDash:scaleLineDash,lineDashOffset:scaleLineDashOffset}),seriesOpts=pickProps(opts,{scale:scaleOpts,type,cursor,nodeClickRange,listeners,tooltip,value,direction,thickness,highlightStyle,segmentation,bar,targets,target,cornerRadius,cornerMode,...rest}),{placement:labelPlacement,...axisLabel}=scaleLabel;let mainAxisPosition,crossAxisPosition;const horizontal=direction==="horizontal";horizontal?(mainAxisPosition=labelPlacement==="before"?"top":"bottom",crossAxisPosition="left"):(mainAxisPosition=labelPlacement==="after"?"right":"left",crossAxisPosition="bottom");const mainAxis={type:"number",position:mainAxisPosition,min:scaleMin,max:scaleMax,reverse:!horizontal,interval:scaleInterval,label:axisLabel,nice:!1,line:{enabled:!1},gridLine:{enabled:!1}},crossAxis={type:"number",position:crossAxisPosition,min:0,max:1,line:{enabled:!1},label:{enabled:!1},gridLine:{enabled:!1}};return{...chartOpts,series:[seriesOpts],axes:horizontal?[mainAxis,crossAxis]:[crossAxis,mainAxis]}}__name(linearGaugeOptions,"linearGaugeOptions");function gauge(opts){if(isRadialGauge(opts))return radialGaugeOptions(opts);if(isLinearGauge(opts))return linearGaugeOptions(opts);const{animation,background,container,contextMenu,footnote,height,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,width}=opts;return pickProps(opts,{animation,background,container,contextMenu,footnote,height,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,width})}__name(gauge,"gauge");function fromTheme(theme,cb){if(isObject(theme))return cb(theme)}__name(fromTheme,"fromTheme");var chartTypes2=["ohlc","line","step-line","hlc","high-low","candlestick","hollow-candlestick"];function priceVolume(opts,getTheme){const{xKey,dateKey=xKey??"date",highKey="high",openKey="open",lowKey="low",closeKey="close",volumeKey="volume",chartType:chartType2="candlestick",navigator:navigator2=!1,volume=!0,rangeToolbar,rangeButtons=rangeToolbar??!0,statusBar=!0,annotations:annotations2,toolbar=annotations2??!0,zoom:zoom2=!0,theme,data,...unusedOpts}=opts;xKey!=null&&Logger.warnOnce("Property [xKey] is deprecated, use [dateKey] instead."),rangeToolbar!=null&&Logger.warnOnce("Property [rangeToolbar] is deprecated, use [rangeButtons] instead."),annotations2!=null&&Logger.warnOnce("Property [annotations] is deprecated, use [toolbar] instead.");const priceSeries=createPriceSeries(theme,chartType2,dateKey,highKey,lowKey,openKey,closeKey),volumeSeries=createVolumeSeries(theme,getTheme,openKey,closeKey,volume,volumeKey),navigatorOpts={navigator:{enabled:navigator2,...volume?{miniChart:{enabled:navigator2,series:[{type:"line",xKey:dateKey,yKey:volumeKey,marker:{enabled:!1}}]}}:null}},statusBarOpts=statusBar?{statusBar:{enabled:!0,data,highKey,openKey,lowKey,closeKey,volumeKey:volume?volumeKey:void 0}}:null,zoomOpts={zoom:{enabled:zoom2,enableIndependentAxes:!0}},toolbarOpts={chartToolbar:{enabled:!0},toolbar:{seriesType:{enabled:toolbar},annotationOptions:{enabled:toolbar},annotations:{enabled:toolbar},ranges:{enabled:rangeButtons}}},volumeAxis=volume?[{type:"number",position:"left",keys:[volumeKey],label:{enabled:!1},crosshair:{enabled:!1},gridLine:{enabled:!1},nice:!1,layoutConstraints:{stacked:!1,width:20,unit:"percentage",align:"end"}}]:[];return{theme:{baseTheme:typeof theme=="string"?theme:"ag-financial",...mergeDefaults(typeof theme=="object"?theme:null,{overrides:{common:{title:{padding:4},padding:{top:6,right:8,bottom:5}}}})},animation:{enabled:!1},legend:{enabled:!1},series:[...volumeSeries,...priceSeries],axes:[{type:"number",position:"right",keys:[openKey,closeKey,highKey,lowKey],interval:{maxSpacing:fromTheme(theme,t=>{var _a274,_b,_c,_d,_e;return(_e=(_d=(_c=(_b=(_a274=t.overrides)==null?void 0:_a274.common)==null?void 0:_b.axes)==null?void 0:_c.number)==null?void 0:_d.interval)==null?void 0:_e.maxSpacing})??45},label:{format:fromTheme(theme,t=>{var _a274,_b,_c,_d,_e;return(_e=(_d=(_c=(_b=(_a274=t.overrides)==null?void 0:_a274.common)==null?void 0:_b.axes)==null?void 0:_c.number)==null?void 0:_d.label)==null?void 0:_e.format})??".2f"},crosshair:{enabled:!0,snap:!1},layoutConstraints:{stacked:!1,width:100,unit:"percentage",align:"start"}},...volumeAxis,{type:"ordinal-time",position:"bottom",line:{enabled:!1},label:{enabled:!0},crosshair:{enabled:!0}}],annotations:{enabled:toolbar},tooltip:{enabled:!1},data,...navigatorOpts,...statusBarOpts,...zoomOpts,...toolbarOpts,...unusedOpts}}__name(priceVolume,"priceVolume");function createVolumeSeries(theme,getTheme,openKey,closeKey,volume,volumeKey){if(!volume)return[];const barSeriesFill=fromTheme(theme,t=>{var _a274,_b,_c;return(_c=(_b=(_a274=t.overrides)==null?void 0:_a274.bar)==null?void 0:_b.series)==null?void 0:_c.fill}),itemStyler=barSeriesFill?{fill:barSeriesFill}:{itemStyler({datum}){const{up,down}=getTheme().palette;return{fill:datum[openKey]<datum[closeKey]?up==null?void 0:up.fill:down==null?void 0:down.fill}}};return[{type:"bar",xKey:"date",yKey:volumeKey,focusPriority:1,tooltip:{enabled:!1},highlight:{enabled:!1},fillOpacity:fromTheme(theme,t=>{var _a274,_b,_c;return(_c=(_b=(_a274=t.overrides)==null?void 0:_a274.bar)==null?void 0:_b.series)==null?void 0:_c.fillOpacity})??.5,...itemStyler}]}__name(createVolumeSeries,"createVolumeSeries");var RANGE_AREA_TYPE="range-area";function createPriceSeries(theme,chartType2,xKey,highKey,lowKey,openKey,closeKey){var _a274;chartType2===RANGE_AREA_TYPE&&(Logger.warnOnce(`type '${chartType2}' is deprecated, use 'hlc' chart type instead`),chartType2="hlc");const keys={xKey,openKey,closeKey,highKey,lowKey},singleKeys={xKey,yKey:closeKey},common={pickOutsideVisibleMinorAxis:!0};switch(chartType2??"candlestick"){case"ohlc":return[{type:"ohlc",focusPriority:0,...common,...keys}];case"line":return[{type:"line",focusPriority:0,...common,...singleKeys,stroke:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.stroke})??PALETTE_NEUTRAL_STROKE,marker:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.marker})??{enabled:!1}}];case"step-line":return[{type:"line",focusPriority:0,...common,...singleKeys,stroke:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.stroke})??PALETTE_NEUTRAL_STROKE,interpolation:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.interpolation})??{type:"step"},marker:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.marker})??{enabled:!1}}];case"hlc":const rangeAreaColors=getThemeColors(RANGE_AREA_TYPE,theme);return[{type:RANGE_AREA_TYPE,focusPriority:0,...common,xKey,yHighKey:highKey,yLowKey:closeKey,fill:rangeAreaColors.fill??PALETTE_UP_FILL,stroke:rangeAreaColors.stroke??PALETTE_UP_STROKE,fillOpacity:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275["range-area"])==null?void 0:_b.series)==null?void 0:_c.fillOpacity})??.3,strokeWidth:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275["range-area"])==null?void 0:_b.series)==null?void 0:_c.strokeWidth})??2},{type:RANGE_AREA_TYPE,focusPriority:0,...common,xKey,yHighKey:closeKey,yLowKey:lowKey,fill:rangeAreaColors.fill??PALETTE_DOWN_FILL,stroke:rangeAreaColors.stroke??PALETTE_DOWN_STROKE,fillOpacity:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275["range-area"])==null?void 0:_b.series)==null?void 0:_c.fillOpacity})??.3,strokeWidth:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275["range-area"])==null?void 0:_b.series)==null?void 0:_c.strokeWidth})??2},{type:"line",...common,...singleKeys,stroke:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.stroke})??PALETTE_ALT_NEUTRAL_STROKE,strokeWidth:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.strokeWidth})??2,marker:fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.line)==null?void 0:_b.series)==null?void 0:_c.marker})??{enabled:!1}}];case"high-low":const rangeBarColors=getThemeColors("range-bar",theme);return[{type:"range-bar",focusPriority:0,...common,xKey,yHighKey:highKey,yLowKey:lowKey,fill:rangeBarColors.fill??PALETTE_NEUTRAL_FILL,stroke:rangeBarColors.stroke??PALETTE_NEUTRAL_STROKE,tooltip:{range:"nearest"}}];case"candlestick":return[{type:"candlestick",focusPriority:0,...common,...keys}];case"hollow-candlestick":const item=fromTheme(theme,t=>{var _a275,_b,_c;return(_c=(_b=(_a275=t.overrides)==null?void 0:_a275.candlestick)==null?void 0:_b.series)==null?void 0:_c.item});return[{type:"candlestick",focusPriority:0,...common,...keys,item:{up:{fill:((_a274=item==null?void 0:item.up)==null?void 0:_a274.fill)??"transparent"}}}];default:return Logger.warnOnce(`unknown chart type: ${chartType2}; expected one of: ${chartTypes2.join(", ")}`),[{type:"candlestick",focusPriority:0,...common,...keys}]}}__name(createPriceSeries,"createPriceSeries");function getThemeColors(seriesType2,theme){const fill=fromTheme(theme,t=>{var _a274,_b,_c;return(_c=(_b=(_a274=t.overrides)==null?void 0:_a274[seriesType2])==null?void 0:_b.series)==null?void 0:_c.fill}),stroke=fromTheme(theme,t=>{var _a274,_b,_c;return(_c=(_b=(_a274=t.overrides)==null?void 0:_a274[seriesType2])==null?void 0:_b.series)==null?void 0:_c.stroke});return{fill,stroke}}__name(getThemeColors,"getThemeColors");var PRESETS={"price-volume":priceVolume,gauge};function removeUsedEnterpriseOptions(options,silent){var _a274,_b,_c,_d;let usedOptions=[];const isGaugeChart=isAgGaugeChartOptions(options),optionsChartType=chartTypes.get(optionsType(options));for(const{type,chartTypes:moduleChartTypes,optionsKey,optionsInnerKey,identifier}of EXPECTED_ENTERPRISE_MODULES)if(!(optionsChartType!=="unknown"&&!moduleChartTypes.includes(optionsChartType))){if(type==="root"||type==="legend"){const optionValue=options[optionsKey];if(optionValue==null)continue;optionsInnerKey?optionValue[optionsInnerKey]&&(usedOptions.push(`${optionsKey}.${optionsInnerKey}`),delete optionValue[optionsInnerKey]):(usedOptions.push(optionsKey),delete options[optionsKey])}else if(type==="axis"){if(!("axes"in options)||!((_a274=options.axes)!=null&&_a274.some(axis=>axis.type===identifier)))continue;usedOptions.push(`axis[type=${identifier}]`),options.axes=options.axes.filter(axis=>axis.type!==identifier)}else if(type==="axis-option"){if(!("axes"in options)||!((_b=options.axes)!=null&&_b.some(axis=>axis[optionsKey])))continue;usedOptions.push(`axis.${optionsKey}`),options.axes.forEach(axis=>{axis[optionsKey]&&delete axis[optionsKey]})}else if(type==="series"){if(!((_c=options.series)!=null&&_c.some(series=>series.type===identifier)))continue;usedOptions.push(`series[type=${identifier}]`),options.series=options.series.filter(series=>series.type!==identifier)}else if(type==="series-option"){if(!((_d=options.series)!=null&&_d.some(series=>series[optionsKey])))continue;usedOptions.push(`series.${optionsKey}`),options.series.forEach(series=>{series[optionsKey]&&delete series[optionsKey]})}}if(usedOptions.length&&!silent){isGaugeChart&&(usedOptions=["AgCharts.createGauge"]);let enterprisePackageName="ag-charts-enterprise",enterpriseReferenceUrl="https://ag-grid.com/charts/javascript/installation/";options.mode==="integrated"&&(enterprisePackageName="ag-grid-charts-enterprise' or 'ag-grid-enterprise/charts-enterprise",enterpriseReferenceUrl="https://www.ag-grid.com/javascript-data-grid/integrated-charts-installation/"),Logger.warnOnce([`unable to use these enterprise features as '${enterprisePackageName}' has not been loaded:`,"",...usedOptions,"",`See: ${enterpriseReferenceUrl}`].join(`
`))}}__name(removeUsedEnterpriseOptions,"removeUsedEnterpriseOptions");function stringifyValue(value,maxLength=1/0){switch(typeof value){case"undefined":return"undefined";case"number":if(isNaN(value))return"NaN";if(value===1/0)return"Infinity";if(value===-1/0)return"-Infinity";default:return value=JSON.stringify(value),value.length>maxLength?`${value.slice(0,maxLength)}... (+${value.length-maxLength} characters)`:value}}__name(stringifyValue,"stringifyValue");var descriptionSymbol=Symbol("description"),requiredSymbol=Symbol("required");function isValid(options,optionsDefs,path){const{errors}=validate(options,optionsDefs,path);for(const{message}of errors)Logger.warn(message);return errors.length===0}__name(isValid,"isValid");function validateMessage(path,value,validatorOrDefs){const description=isString(validatorOrDefs)?validatorOrDefs:validatorOrDefs[descriptionSymbol],expecting=description?`; expecting ${description}`:"";return`${path?`Option \`${path}\``:"Value"} cannot be set to \`${stringifyValue(value)}\`${expecting}, ignoring.`}__name(validateMessage,"validateMessage");function validate(options,optionsDefs,path=""){if(!isObject(options))return{valid:null,errors:[{path,value:options,message:validateMessage(path,options,"an object")}]};const optionsKeys=new Set(Object.keys(options)),errors=[],valid={};function extendPath(key){return isArray(optionsDefs)?`${path}[${key}]`:path?`${path}.${key}`:key}__name(extendPath,"extendPath");for(const[key,validatorOrDefs]of Object.entries(optionsDefs)){optionsKeys.delete(key);const value=options[key];if(!(!validatorOrDefs[requiredSymbol]&&typeof value>"u"))if(isFunction(validatorOrDefs))validatorOrDefs(value)?valid[key]=value:errors.push({key,path,value,message:validateMessage(extendPath(key),value,validatorOrDefs)});else{const nestedResult=validate(value,validatorOrDefs,extendPath(key));valid[key]=nestedResult.valid,errors.push(...nestedResult.errors)}}for(const key of optionsKeys)errors.push({key,path,unknown:!0,message:`Unknown option \`${extendPath(key)}\`, ignoring.`});return{valid,errors}}__name(validate,"validate");function attachDescription(validator,description){return Object.assign(value=>validator(value),{[descriptionSymbol]:description})}__name(attachDescription,"attachDescription");var or=__name((...validators)=>attachDescription(value=>validators.some(validator=>validator(value)),validators.map(v=>v[descriptionSymbol]).filter(Boolean).join(" or ")),"or");attachDescription(isArray,"an array");attachDescription(isBoolean,"a boolean");attachDescription(isFunction,"a function");attachDescription(isFiniteNumber,"a number");var object=attachDescription(isObject,"an object"),string=attachDescription(isString,"a string"),numberMin=__name((min,inclusive=!0)=>attachDescription(value=>isFiniteNumber(value)&&(value>min||inclusive&&value===min),`a number greater than ${inclusive?"or equal to ":""}${min}`),"numberMin"),numberRange=__name((min,max)=>attachDescription(value=>isFiniteNumber(value)&&value>=min&&value<=max,`a number between ${min} and ${max} inclusive`),"numberRange");numberMin(0);numberMin(1);numberRange(0,1);numberRange(0,360);var arrayOf=__name((validator,description)=>attachDescription(value=>isArray(value)&&value.every(validator),`${validator[descriptionSymbol]} array`),"arrayOf");function paletteType(partial){return partial!=null&&partial.up||partial!=null&&partial.down||partial!=null&&partial.neutral?"user-full":partial!=null&&partial.fills||partial!=null&&partial.strokes?"user-indexed":"inbuilt"}__name(paletteType,"paletteType");var DEFAULT_BACKGROUND_FILL="white",CHART_TYPE_CONFIG={get cartesian(){return{seriesTypes:chartTypes.cartesianTypes,commonOptions:["zoom","navigator"]}},get polar(){return{seriesTypes:chartTypes.polarTypes,commonOptions:[]}},get hierarchy(){return{seriesTypes:chartTypes.hierarchyTypes,commonOptions:[]}},get topology(){return{seriesTypes:chartTypes.topologyTypes,commonOptions:[]}},get"flow-proportion"(){return{seriesTypes:chartTypes.flowProportionTypes,commonOptions:[]}},get gauge(){return{seriesTypes:chartTypes.gaugeTypes,commonOptions:[]}}},CHART_TYPE_SPECIFIC_COMMON_OPTIONS=Object.values(CHART_TYPE_CONFIG).reduce((r,{commonOptions})=>r.concat(commonOptions),[]),_a248,_ChartTheme=(_a248=class{static getAxisDefaults(overrideDefaults){return mergeDefaults(overrideDefaults,{title:{enabled:!1,text:"Axis Title",spacing:25,fontWeight:"normal",fontSize:13,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR},label:{fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,padding:5,color:DEFAULT_LABEL_COLOUR,avoidCollisions:!0},line:{enabled:!0,width:1,stroke:DEFAULT_AXIS_LINE_COLOUR},tick:{enabled:!1,width:1,stroke:DEFAULT_AXIS_LINE_COLOUR},gridLine:{enabled:!0,style:[{stroke:DEFAULT_AXIS_GRID_COLOUR,lineDash:[]}]},crossLines:{enabled:!1,fill:DEFAULT_CROSS_LINES_COLOUR,stroke:DEFAULT_CROSS_LINES_COLOUR,fillOpacity:.1,strokeWidth:1,label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,padding:5,color:DEFAULT_LABEL_COLOUR}},crosshair:{enabled:!0}})}getChartDefaults(){return{minHeight:300,minWidth:300,background:{visible:!0,fill:DEFAULT_BACKGROUND_COLOUR},padding:{top:DEFAULT_PADDING,right:DEFAULT_PADDING,bottom:DEFAULT_PADDING,left:DEFAULT_PADDING},keyboard:{enabled:!0},title:{enabled:!1,text:"Title",fontWeight:"normal",fontSize:17,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,wrapping:"hyphenate",layoutStyle:DEFAULT_CAPTION_LAYOUT_STYLE,textAlign:DEFAULT_CAPTION_ALIGNMENT},subtitle:{enabled:!1,text:"Subtitle",spacing:20,fontSize:13,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_MUTED_LABEL_COLOUR,wrapping:"hyphenate",layoutStyle:DEFAULT_CAPTION_LAYOUT_STYLE,textAlign:DEFAULT_CAPTION_ALIGNMENT},footnote:{enabled:!1,text:"Footnote",spacing:20,fontSize:13,fontFamily:DEFAULT_FONT_FAMILY,color:"rgb(140, 140, 140)",wrapping:"hyphenate",layoutStyle:DEFAULT_CAPTION_LAYOUT_STYLE,textAlign:DEFAULT_CAPTION_ALIGNMENT},legend:{position:"bottom",spacing:30,listeners:{},toggleSeries:!0,item:{paddingX:16,paddingY:8,marker:{size:15,padding:8},showSeriesStroke:!0,label:{color:DEFAULT_LABEL_COLOUR,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY}},reverseOrder:!1,pagination:{marker:{size:12},activeStyle:{fill:DEFAULT_LABEL_COLOUR},inactiveStyle:{fill:DEFAULT_MUTED_LABEL_COLOUR},highlightStyle:{fill:DEFAULT_LABEL_COLOUR},label:{color:DEFAULT_LABEL_COLOUR}}},tooltip:{enabled:!0,darkTheme:IS_DARK_THEME,delay:0},overlays:{darkTheme:IS_DARK_THEME},listeners:{}}}constructor(options={}){const{overrides,palette}=deepClone(options),defaults=this.createChartConfigPerChartType(this.getDefaults());overrides&&this.mergeOverrides(defaults,overrides);const{fills,strokes,...otherColors}=this.getDefaultColors();this.palette=mergeDefaults(palette,{fills:Object.values(fills),strokes:Object.values(strokes),...otherColors}),this.paletteType=paletteType(palette),this.config=Object.freeze(this.templateTheme(defaults))}mergeOverrides(defaults,overrides){for(const{seriesTypes,commonOptions}of Object.values(CHART_TYPE_CONFIG)){const cleanedCommon={...overrides.common};for(const commonKey of CHART_TYPE_SPECIFIC_COMMON_OPTIONS)commonOptions.includes(commonKey)||delete cleanedCommon[commonKey];if(cleanedCommon)for(const s of seriesTypes){const seriesType2=s;defaults[seriesType2]=mergeDefaults(cleanedCommon,defaults[seriesType2])}}chartTypes.seriesTypes.forEach(s=>{const seriesType2=s;overrides[seriesType2]&&(defaults[seriesType2]=mergeDefaults(overrides[seriesType2],defaults[seriesType2]))})}createChartConfigPerChartType(config){for(const[nextType,{seriesTypes}]of Object.entries(CHART_TYPE_CONFIG)){const typeDefaults=chartDefaults.get(nextType);for(const seriesType2 of seriesTypes)config[seriesType2]||(config[seriesType2]=deepClone(typeDefaults))}return config}getDefaults(){const getOverridesByType=__name((chartType2,seriesTypes)=>{const result={},chartTypeDefaults={axes:{},...legendRegistry.getThemeTemplates(),...this.getChartDefaults(),...chartDefaults.get(chartType2)};for(const seriesType2 of seriesTypes){result[seriesType2]=mergeDefaults(seriesRegistry.getThemeTemplate(seriesType2),result[seriesType2]??deepClone(chartTypeDefaults));const{axes}=result[seriesType2];for(const axisType of axisRegistry.keys())axes[axisType]=mergeDefaults(axes[axisType],axisRegistry.getThemeTemplate(axisType),_a248.cartesianAxisDefault[axisType])}return result},"getOverridesByType");return mergeDefaults(getOverridesByType("cartesian",chartTypes.cartesianTypes),getOverridesByType("polar",chartTypes.polarTypes),getOverridesByType("hierarchy",chartTypes.hierarchyTypes),getOverridesByType("topology",chartTypes.topologyTypes),getOverridesByType("flow-proportion",chartTypes.flowProportionTypes),getOverridesByType("gauge",chartTypes.gaugeTypes))}templateTheme(themeTemplate){const themeInstance=deepClone(themeTemplate),params=this.getTemplateParameters();return jsonWalk(themeInstance,node=>{if(isArray(node))for(let i=0;i<node.length;i++){const symbol=node[i];params.has(symbol)&&(node[i]=params.get(symbol))}else for(const[name,value]of Object.entries(node))params.has(value)&&(node[name]=params.get(value))}),deepClone(themeInstance)}getDefaultColors(){return{fills:DEFAULT_FILLS,strokes:DEFAULT_STROKES,up:{fill:DEFAULT_FILLS.GREEN,stroke:DEFAULT_STROKES.GREEN},down:{fill:DEFAULT_FILLS.RED,stroke:DEFAULT_STROKES.RED},neutral:{fill:DEFAULT_FILLS.GRAY,stroke:DEFAULT_STROKES.GRAY},altUp:{fill:DEFAULT_FILLS.BLUE,stroke:DEFAULT_STROKES.BLUE},altDown:{fill:DEFAULT_FILLS.ORANGE,stroke:DEFAULT_STROKES.ORANGE},altNeutral:{fill:DEFAULT_FILLS.GRAY,stroke:DEFAULT_STROKES.GRAY}}}getTemplateParameters(){var _a274,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l;const params=new Map;params.set(IS_DARK_THEME,!1),params.set(DEFAULT_FONT_FAMILY,"Verdana, sans-serif"),params.set(DEFAULT_LABEL_COLOUR,"rgb(70, 70, 70)"),params.set(DEFAULT_INVERTED_LABEL_COLOUR,"white"),params.set(DEFAULT_MUTED_LABEL_COLOUR,"rgb(140, 140, 140)"),params.set(DEFAULT_AXIS_GRID_COLOUR,"rgb(224,234,241)"),params.set(DEFAULT_AXIS_LINE_COLOUR,"rgb(195, 195, 195)"),params.set(DEFAULT_CROSS_LINES_COLOUR,"rgb(70, 70, 70)"),params.set(DEFAULT_INSIDE_SERIES_LABEL_COLOUR,DEFAULT_BACKGROUND_FILL),params.set(DEFAULT_BACKGROUND_COLOUR,DEFAULT_BACKGROUND_FILL),params.set(DEFAULT_SHADOW_COLOUR,"rgba(0, 0, 0, 0.5)"),params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[DEFAULT_FILLS.ORANGE,DEFAULT_FILLS.YELLOW,DEFAULT_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[DEFAULT_FILLS.GREEN,DEFAULT_FILLS.YELLOW,DEFAULT_FILLS.RED]),params.set(DEFAULT_PADDING,20),params.set(DEFAULT_CAPTION_LAYOUT_STYLE,"block"),params.set(DEFAULT_CAPTION_ALIGNMENT,"center"),params.set(DEFAULT_HIERARCHY_FILLS,["#ffffff","#e0e5ea","#c1ccd5","#a3b4c1","#859cad"]),params.set(DEFAULT_HIERARCHY_STROKES,["#ffffff","#c5cbd1","#a4b1bd","#8498a9","#648096"]),params.set(DEFAULT_POLAR_SERIES_STROKE,DEFAULT_BACKGROUND_FILL),params.set(DEFAULT_ANNOTATION_COLOR,DEFAULT_FILLS.BLUE),params.set(DEFAULT_TEXT_ANNOTATION_COLOR,DEFAULT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,DEFAULT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_HANDLE_FILL,DEFAULT_BACKGROUND_FILL),params.set(DEFAULT_TEXTBOX_FILL,"#fafafa"),params.set(DEFAULT_TEXTBOX_STROKE,"#dddddd"),params.set(DEFAULT_TEXTBOX_COLOR,"#000000"),params.set(DEFAULT_TOOLBAR_POSITION,"top"),params.set(DEFAULT_GRIDLINE_ENABLED,!1);const defaultColors=this.getDefaultColors();return params.set(PALETTE_UP_STROKE,((_a274=this.palette.up)==null?void 0:_a274.stroke)??defaultColors.up.stroke),params.set(PALETTE_UP_FILL,((_b=this.palette.up)==null?void 0:_b.fill)??defaultColors.up.fill),params.set(PALETTE_DOWN_STROKE,((_c=this.palette.down)==null?void 0:_c.stroke)??defaultColors.down.stroke),params.set(PALETTE_DOWN_FILL,((_d=this.palette.down)==null?void 0:_d.fill)??defaultColors.down.fill),params.set(PALETTE_NEUTRAL_STROKE,((_e=this.palette.neutral)==null?void 0:_e.stroke)??defaultColors.neutral.stroke),params.set(PALETTE_NEUTRAL_FILL,((_f=this.palette.neutral)==null?void 0:_f.fill)??defaultColors.neutral.fill),params.set(PALETTE_ALT_UP_STROKE,((_g=this.palette.altUp)==null?void 0:_g.stroke)??defaultColors.up.stroke),params.set(PALETTE_ALT_UP_FILL,((_h=this.palette.altUp)==null?void 0:_h.fill)??defaultColors.up.fill),params.set(PALETTE_ALT_DOWN_STROKE,((_i=this.palette.altDown)==null?void 0:_i.stroke)??defaultColors.down.stroke),params.set(PALETTE_ALT_DOWN_FILL,((_j=this.palette.altDown)==null?void 0:_j.fill)??defaultColors.down.fill),params.set(PALETTE_ALT_NEUTRAL_FILL,((_k=this.palette.altNeutral)==null?void 0:_k.fill)??defaultColors.altNeutral.fill),params.set(PALETTE_ALT_NEUTRAL_STROKE,((_l=this.palette.altNeutral)==null?void 0:_l.stroke)??defaultColors.altNeutral.stroke),params}},__name(_a248,"_ChartTheme"),_a248);_ChartTheme.cartesianAxisDefault={number:_ChartTheme.getAxisDefaults({line:{enabled:!1}}),log:_ChartTheme.getAxisDefaults({base:10,line:{enabled:!1},interval:{minSpacing:NaN}}),category:_ChartTheme.getAxisDefaults({groupPaddingInner:.1,label:{autoRotate:!0},gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED},crosshair:{enabled:!1}}),time:_ChartTheme.getAxisDefaults({gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED}}),"ordinal-time":_ChartTheme.getAxisDefaults({groupPaddingInner:0,label:{autoRotate:!1},gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED}}),"angle-category":_ChartTheme.getAxisDefaults({gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED}}),"angle-number":_ChartTheme.getAxisDefaults({gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED}}),"radius-category":_ChartTheme.getAxisDefaults({line:{enabled:!1}}),"radius-number":_ChartTheme.getAxisDefaults({line:{enabled:!1}}),"grouped-category":_ChartTheme.getAxisDefaults({tick:{enabled:!0}})};var ChartTheme=_ChartTheme,DEFAULT_DARK_BACKGROUND_FILL="#192232",DEFAULT_DARK_FILLS={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},DEFAULT_DARK_STROKES={BLUE:"#74a8e6",ORANGE:"#ffbe70",GREEN:"#6cb176",CYAN:"#75d4ef",YELLOW:"#f6e559",VIOLET:"#aa86d8",GRAY:"#a1a1a1",MAGENTA:"#ce7ab9",BROWN:"#997b52",RED:"#ff7872"},_a249,DarkTheme=(_a249=class extends ChartTheme{getDefaultColors(){return{fills:DEFAULT_DARK_FILLS,strokes:DEFAULT_DARK_STROKES,up:{fill:DEFAULT_DARK_FILLS.GREEN,stroke:DEFAULT_DARK_STROKES.GREEN},down:{fill:DEFAULT_DARK_FILLS.RED,stroke:DEFAULT_DARK_STROKES.RED},neutral:{fill:DEFAULT_DARK_FILLS.GRAY,stroke:DEFAULT_DARK_STROKES.GRAY},altUp:{fill:DEFAULT_DARK_FILLS.BLUE,stroke:DEFAULT_DARK_STROKES.BLUE},altDown:{fill:DEFAULT_DARK_FILLS.ORANGE,stroke:DEFAULT_DARK_STROKES.ORANGE},altNeutral:{fill:DEFAULT_DARK_FILLS.GRAY,stroke:DEFAULT_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(IS_DARK_THEME,!0),params.set(DEFAULT_POLAR_SERIES_STROKE,DEFAULT_DARK_BACKGROUND_FILL),params.set(DEFAULT_LABEL_COLOUR,"white"),params.set(DEFAULT_MUTED_LABEL_COLOUR,"#7D91A0"),params.set(DEFAULT_AXIS_GRID_COLOUR,"#545A6E"),params.set(DEFAULT_CROSS_LINES_COLOUR,"white"),params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[DEFAULT_DARK_FILLS.ORANGE,DEFAULT_DARK_FILLS.YELLOW,DEFAULT_DARK_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[DEFAULT_DARK_FILLS.GREEN,DEFAULT_DARK_FILLS.YELLOW,DEFAULT_DARK_FILLS.RED]),params.set(DEFAULT_HIERARCHY_FILLS,["#192834","#253746","#324859","#3f596c","#4d6a80"]),params.set(DEFAULT_HIERARCHY_STROKES,["#192834","#3b5164","#496275","#577287","#668399"]),params.set(DEFAULT_BACKGROUND_COLOUR,DEFAULT_DARK_BACKGROUND_FILL),params.set(DEFAULT_INSIDE_SERIES_LABEL_COLOUR,DEFAULT_DARK_BACKGROUND_FILL),params.set(DEFAULT_ANNOTATION_COLOR,DEFAULT_DARK_FILLS.BLUE),params.set(DEFAULT_TEXT_ANNOTATION_COLOR,"white"),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,DEFAULT_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_HANDLE_FILL,DEFAULT_DARK_BACKGROUND_FILL),params.set(DEFAULT_TEXTBOX_FILL,"#28313e"),params.set(DEFAULT_TEXTBOX_STROKE,"#4b525d"),params.set(DEFAULT_TEXTBOX_COLOR,"#ffffff"),params}constructor(options){super(options)}},__name(_a249,"DarkTheme"),_a249),FINANCIAL_DARK_FILLS={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},FINANCIAL_DARK_STROKES={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},_a250,FinancialDark=(_a250=class extends DarkTheme{getDefaultColors(){return{fills:{...FINANCIAL_DARK_FILLS},strokes:{...FINANCIAL_DARK_STROKES},up:{fill:FINANCIAL_DARK_FILLS.GREEN,stroke:FINANCIAL_DARK_STROKES.GREEN},down:{fill:FINANCIAL_DARK_FILLS.RED,stroke:FINANCIAL_DARK_STROKES.RED},neutral:{fill:FINANCIAL_DARK_FILLS.BLUE,stroke:FINANCIAL_DARK_STROKES.BLUE},altUp:{fill:FINANCIAL_DARK_FILLS.GREEN,stroke:FINANCIAL_DARK_STROKES.GREEN},altDown:{fill:FINANCIAL_DARK_FILLS.RED,stroke:FINANCIAL_DARK_STROKES.RED},altNeutral:{fill:FINANCIAL_DARK_FILLS.GRAY,stroke:FINANCIAL_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[FINANCIAL_DARK_FILLS.GREEN,FINANCIAL_DARK_FILLS.BLUE,FINANCIAL_DARK_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,FINANCIAL_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,FINANCIAL_DARK_FILLS.BLUE),params.set(DEFAULT_AXIS_GRID_COLOUR,"#343A4E"),params.set(DEFAULT_PADDING,0),params.set(DEFAULT_CAPTION_LAYOUT_STYLE,"overlay"),params.set(DEFAULT_CAPTION_ALIGNMENT,"left"),params.set(DEFAULT_TOOLBAR_POSITION,"bottom"),params.set(DEFAULT_GRIDLINE_ENABLED,!0),params}},__name(_a250,"FinancialDark"),_a250),FINANCIAL_LIGHT_FILLS={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},FINANCIAL_LIGHT_STROKES={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},_a251,FinancialLight=(_a251=class extends ChartTheme{getDefaultColors(){return{fills:{...FINANCIAL_LIGHT_FILLS},strokes:{...FINANCIAL_LIGHT_STROKES},up:{fill:FINANCIAL_LIGHT_FILLS.GREEN,stroke:FINANCIAL_LIGHT_STROKES.GREEN},down:{fill:FINANCIAL_LIGHT_FILLS.RED,stroke:FINANCIAL_LIGHT_STROKES.RED},neutral:{fill:FINANCIAL_LIGHT_FILLS.BLUE,stroke:FINANCIAL_LIGHT_STROKES.BLUE},altUp:{fill:FINANCIAL_LIGHT_FILLS.GREEN,stroke:FINANCIAL_LIGHT_STROKES.GREEN},altDown:{fill:FINANCIAL_LIGHT_FILLS.RED,stroke:FINANCIAL_LIGHT_STROKES.RED},altNeutral:{fill:FINANCIAL_LIGHT_FILLS.GRAY,stroke:FINANCIAL_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[FINANCIAL_LIGHT_FILLS.GREEN,FINANCIAL_LIGHT_FILLS.BLUE,FINANCIAL_LIGHT_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,FINANCIAL_LIGHT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,FINANCIAL_LIGHT_FILLS.BLUE),params.set(DEFAULT_AXIS_GRID_COLOUR,"#F2F3F3"),params.set(DEFAULT_PADDING,0),params.set(DEFAULT_CAPTION_LAYOUT_STYLE,"overlay"),params.set(DEFAULT_CAPTION_ALIGNMENT,"left"),params.set(DEFAULT_TOOLBAR_POSITION,"bottom"),params.set(DEFAULT_GRIDLINE_ENABLED,!0),params}},__name(_a251,"FinancialLight"),_a251),MATERIAL_DARK_FILLS={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},MATERIAL_DARK_STROKES={BLUE:"#90CAF9",ORANGE:"#FFCC80",GREEN:"#A5D6A7",CYAN:"#80DEEA",YELLOW:"#FFF9C4",VIOLET:"#B39DDB",GRAY:"#E0E0E0",MAGENTA:"#F48FB1",BROWN:"#A1887F",RED:"#EF9A9A"},_a252,MaterialDark=(_a252=class extends DarkTheme{getDefaultColors(){return{fills:MATERIAL_DARK_FILLS,strokes:MATERIAL_DARK_STROKES,up:{fill:MATERIAL_DARK_FILLS.GREEN,stroke:MATERIAL_DARK_STROKES.GREEN},down:{fill:MATERIAL_DARK_FILLS.RED,stroke:MATERIAL_DARK_STROKES.RED},neutral:{fill:MATERIAL_DARK_FILLS.GRAY,stroke:MATERIAL_DARK_STROKES.GRAY},altUp:{fill:MATERIAL_DARK_FILLS.BLUE,stroke:MATERIAL_DARK_STROKES.BLUE},altDown:{fill:MATERIAL_DARK_FILLS.RED,stroke:MATERIAL_DARK_STROKES.RED},altNeutral:{fill:MATERIAL_DARK_FILLS.GRAY,stroke:MATERIAL_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[MATERIAL_DARK_FILLS.ORANGE,MATERIAL_DARK_FILLS.YELLOW,MATERIAL_DARK_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[MATERIAL_DARK_FILLS.GREEN,MATERIAL_DARK_FILLS.YELLOW,MATERIAL_DARK_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,MATERIAL_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,MATERIAL_DARK_FILLS.BLUE),params}},__name(_a252,"MaterialDark"),_a252),MATERIAL_LIGHT_FILLS={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},MATERIAL_LIGHT_STROKES={BLUE:"#1565C0",ORANGE:"#E65100",GREEN:"#2E7D32",CYAN:"#00838F",YELLOW:"#F9A825",VIOLET:"#4527A0",GRAY:"#616161",MAGENTA:"#C2185B",BROWN:"#4E342E",RED:"#B71C1C"},_a253,MaterialLight=(_a253=class extends ChartTheme{getDefaultColors(){return{fills:MATERIAL_LIGHT_FILLS,strokes:MATERIAL_LIGHT_STROKES,up:{fill:MATERIAL_LIGHT_FILLS.GREEN,stroke:MATERIAL_LIGHT_STROKES.GREEN},down:{fill:MATERIAL_LIGHT_FILLS.RED,stroke:MATERIAL_LIGHT_STROKES.RED},neutral:{fill:MATERIAL_LIGHT_FILLS.GRAY,stroke:MATERIAL_LIGHT_STROKES.GRAY},altUp:{fill:MATERIAL_LIGHT_FILLS.BLUE,stroke:MATERIAL_LIGHT_STROKES.BLUE},altDown:{fill:MATERIAL_LIGHT_FILLS.RED,stroke:MATERIAL_LIGHT_STROKES.RED},altNeutral:{fill:MATERIAL_LIGHT_FILLS.GRAY,stroke:MATERIAL_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[MATERIAL_LIGHT_FILLS.ORANGE,MATERIAL_LIGHT_FILLS.YELLOW,MATERIAL_LIGHT_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[MATERIAL_LIGHT_FILLS.GREEN,MATERIAL_LIGHT_FILLS.YELLOW,MATERIAL_LIGHT_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,MATERIAL_LIGHT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,MATERIAL_LIGHT_FILLS.BLUE),params}},__name(_a253,"MaterialLight"),_a253),POLYCHROMA_DARK_FILLS={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},POLYCHROMA_DARK_STROKES={BLUE:"#6698ff",PURPLE:"#c0a3ff",MAGENTA:"#fc8dfc",PINK:"#ff82b1",RED:"#ff9b70",ORANGE:"#ffcf4e",YELLOW:"#ffff58",GREEN:"#58dd70",CYAN:"#51e2c9",MODERATE_BLUE:"#4fd7ff",GRAY:"#eeeeee"},_a254,PolychromaDark=(_a254=class extends DarkTheme{getDefaultColors(){return{fills:POLYCHROMA_DARK_FILLS,strokes:POLYCHROMA_DARK_STROKES,up:{fill:POLYCHROMA_DARK_FILLS.GREEN,stroke:POLYCHROMA_DARK_STROKES.GREEN},down:{fill:POLYCHROMA_DARK_FILLS.RED,stroke:POLYCHROMA_DARK_STROKES.RED},neutral:{fill:POLYCHROMA_DARK_FILLS.GRAY,stroke:POLYCHROMA_DARK_STROKES.GRAY},altUp:{fill:POLYCHROMA_DARK_FILLS.BLUE,stroke:POLYCHROMA_DARK_STROKES.BLUE},altDown:{fill:POLYCHROMA_DARK_FILLS.RED,stroke:POLYCHROMA_DARK_STROKES.RED},altNeutral:{fill:POLYCHROMA_DARK_FILLS.GRAY,stroke:POLYCHROMA_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[POLYCHROMA_DARK_FILLS.BLUE,POLYCHROMA_DARK_FILLS.RED]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[POLYCHROMA_DARK_FILLS.BLUE,POLYCHROMA_DARK_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,POLYCHROMA_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,POLYCHROMA_DARK_FILLS.BLUE),params}},__name(_a254,"PolychromaDark"),_a254),POLYCHROMA_LIGHT_FILLS={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},POLYCHROMA_LIGHT_STROKES={BLUE:"#2346c9",PURPLE:"#7653d4",MAGENTA:"#a73da9",PINK:"#c32d66",RED:"#c84b1c",ORANGE:"#c87f00",YELLOW:"#c1b900",GREEN:"#008c1c",CYAN:"#00927c",MODERATE_BLUE:"#0087bb",GRAY:"#888888"},_a255,PolychromaLight=(_a255=class extends ChartTheme{getDefaultColors(){return{fills:POLYCHROMA_LIGHT_FILLS,strokes:POLYCHROMA_LIGHT_STROKES,up:{fill:POLYCHROMA_LIGHT_FILLS.GREEN,stroke:POLYCHROMA_LIGHT_STROKES.GREEN},down:{fill:POLYCHROMA_LIGHT_FILLS.RED,stroke:POLYCHROMA_LIGHT_STROKES.RED},neutral:{fill:POLYCHROMA_LIGHT_FILLS.GRAY,stroke:POLYCHROMA_LIGHT_STROKES.GRAY},altUp:{fill:POLYCHROMA_LIGHT_FILLS.BLUE,stroke:POLYCHROMA_LIGHT_STROKES.BLUE},altDown:{fill:POLYCHROMA_LIGHT_FILLS.RED,stroke:POLYCHROMA_LIGHT_STROKES.RED},altNeutral:{fill:POLYCHROMA_LIGHT_FILLS.GRAY,stroke:POLYCHROMA_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[POLYCHROMA_LIGHT_FILLS.BLUE,POLYCHROMA_LIGHT_FILLS.RED]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[POLYCHROMA_LIGHT_FILLS.BLUE,POLYCHROMA_LIGHT_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,POLYCHROMA_LIGHT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,POLYCHROMA_LIGHT_FILLS.BLUE),params}},__name(_a255,"PolychromaLight"),_a255),SHEETS_DARK_FILLS={BLUE:"#4472C4",ORANGE:"#ED7D31",GRAY:"#A5A5A5",YELLOW:"#FFC000",MODERATE_BLUE:"#5B9BD5",GREEN:"#70AD47",DARK_GRAY:"#7B7B7B",DARK_BLUE:"#264478",VERY_DARK_GRAY:"#636363",DARK_YELLOW:"#997300"},SHEETS_DARK_STROKES={BLUE:"#6899ee",ORANGE:"#ffa55d",GRAY:"#cdcdcd",YELLOW:"#ffea53",MODERATE_BLUE:"#82c3ff",GREEN:"#96d56f",DARK_GRAY:"#a1a1a1",DARK_BLUE:"#47689f",VERY_DARK_GRAY:"#878787",DARK_YELLOW:"#c0993d"},_a256,SheetsDark=(_a256=class extends DarkTheme{getDefaultColors(){return{fills:{...SHEETS_DARK_FILLS,RED:SHEETS_DARK_FILLS.ORANGE},strokes:{...SHEETS_DARK_STROKES,RED:SHEETS_DARK_STROKES.ORANGE},up:{fill:SHEETS_DARK_FILLS.GREEN,stroke:SHEETS_DARK_STROKES.GREEN},down:{fill:SHEETS_DARK_FILLS.ORANGE,stroke:SHEETS_DARK_STROKES.ORANGE},neutral:{fill:SHEETS_DARK_FILLS.GRAY,stroke:SHEETS_DARK_STROKES.GRAY},altUp:{fill:SHEETS_DARK_FILLS.BLUE,stroke:SHEETS_DARK_STROKES.BLUE},altDown:{fill:SHEETS_DARK_FILLS.ORANGE,stroke:SHEETS_DARK_STROKES.ORANGE},altNeutral:{fill:SHEETS_DARK_FILLS.GRAY,stroke:SHEETS_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[SHEETS_DARK_FILLS.ORANGE,SHEETS_DARK_FILLS.YELLOW,SHEETS_DARK_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[SHEETS_DARK_FILLS.GREEN,SHEETS_DARK_FILLS.YELLOW,SHEETS_DARK_FILLS.ORANGE]),params.set(DEFAULT_ANNOTATION_COLOR,SHEETS_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,SHEETS_DARK_FILLS.BLUE),params}},__name(_a256,"SheetsDark"),_a256),SHEETS_LIGHT_FILLS={BLUE:"#5281d5",ORANGE:"#ff8d44",GRAY:"#b5b5b5",YELLOW:"#ffd02f",MODERATE_BLUE:"#6aabe6",GREEN:"#7fbd57",DARK_GRAY:"#8a8a8a",DARK_BLUE:"#335287",VERY_DARK_GRAY:"#717171",DARK_YELLOW:"#a98220"},SHEETS_LIGHT_STROKES={BLUE:"#214d9b",ORANGE:"#c25600",GRAY:"#7f7f7f",YELLOW:"#d59800",MODERATE_BLUE:"#3575ac",GREEN:"#4b861a",DARK_GRAY:"#575757",DARK_BLUE:"#062253",VERY_DARK_GRAY:"#414141",DARK_YELLOW:"#734f00"},_a257,SheetsLight=(_a257=class extends ChartTheme{getDefaultColors(){return{fills:{...SHEETS_LIGHT_FILLS,RED:SHEETS_LIGHT_FILLS.ORANGE},strokes:{...SHEETS_LIGHT_STROKES,RED:SHEETS_LIGHT_STROKES.ORANGE},up:{fill:SHEETS_LIGHT_FILLS.GREEN,stroke:SHEETS_LIGHT_STROKES.GREEN},down:{fill:SHEETS_LIGHT_FILLS.ORANGE,stroke:SHEETS_LIGHT_STROKES.ORANGE},neutral:{fill:SHEETS_LIGHT_STROKES.GRAY,stroke:SHEETS_LIGHT_STROKES.GRAY},altUp:{fill:SHEETS_LIGHT_FILLS.BLUE,stroke:SHEETS_LIGHT_STROKES.BLUE},altDown:{fill:SHEETS_LIGHT_FILLS.ORANGE,stroke:SHEETS_LIGHT_STROKES.ORANGE},altNeutral:{fill:SHEETS_LIGHT_FILLS.GRAY,stroke:SHEETS_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[SHEETS_LIGHT_FILLS.ORANGE,SHEETS_LIGHT_FILLS.YELLOW,SHEETS_LIGHT_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[SHEETS_LIGHT_FILLS.GREEN,SHEETS_LIGHT_FILLS.YELLOW,SHEETS_LIGHT_FILLS.ORANGE]),params.set(DEFAULT_ANNOTATION_COLOR,SHEETS_LIGHT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,SHEETS_LIGHT_FILLS.BLUE),params}},__name(_a257,"SheetsLight"),_a257),VIVID_DARK_FILLS={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},VIVID_DARK_STROKES={BLUE:"#67b7ff",ORANGE:"#ffc24d",GREEN:"#5cc86f",CYAN:"#54ebff",VIOLET:"#fff653",YELLOW:"#c18aff",GRAY:"#aeaeae",MAGENTA:"#f078d4",BROWN:"#ba8438",RED:"#ff726e"},_a258,VividDark=(_a258=class extends DarkTheme{getDefaultColors(){return{fills:VIVID_DARK_FILLS,strokes:VIVID_DARK_STROKES,up:{fill:VIVID_DARK_FILLS.GREEN,stroke:VIVID_DARK_STROKES.GREEN},down:{fill:VIVID_DARK_FILLS.RED,stroke:VIVID_DARK_STROKES.RED},neutral:{fill:VIVID_DARK_FILLS.GRAY,stroke:VIVID_DARK_STROKES.GRAY},altUp:{fill:VIVID_DARK_FILLS.BLUE,stroke:VIVID_DARK_STROKES.BLUE},altDown:{fill:VIVID_DARK_FILLS.ORANGE,stroke:VIVID_DARK_STROKES.ORANGE},altNeutral:{fill:VIVID_DARK_FILLS.GRAY,stroke:VIVID_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[VIVID_DARK_FILLS.ORANGE,VIVID_DARK_FILLS.YELLOW,VIVID_DARK_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[VIVID_DARK_FILLS.GREEN,VIVID_DARK_FILLS.YELLOW,VIVID_DARK_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,VIVID_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,VIVID_DARK_FILLS.BLUE),params}},__name(_a258,"VividDark"),_a258),VIVID_FILLS={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},VIVID_STROKES={BLUE:"#0f68c0",ORANGE:"#d47100",GREEN:"#007922",CYAN:"#009ac2",VIOLET:"#bca400",YELLOW:"#753cac",GRAY:"#646464",MAGENTA:"#9b2685",BROWN:"#6c3b00",RED:"#cb0021"},_a259,VividLight=(_a259=class extends ChartTheme{getDefaultColors(){return{fills:VIVID_FILLS,strokes:VIVID_STROKES,up:{fill:VIVID_FILLS.GREEN,stroke:VIVID_STROKES.GREEN},down:{fill:VIVID_FILLS.RED,stroke:VIVID_STROKES.RED},neutral:{fill:VIVID_FILLS.GRAY,stroke:VIVID_STROKES.GRAY},altUp:{fill:VIVID_FILLS.BLUE,stroke:VIVID_STROKES.BLUE},altDown:{fill:VIVID_FILLS.ORANGE,stroke:VIVID_STROKES.ORANGE},altNeutral:{fill:VIVID_FILLS.GRAY,stroke:VIVID_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[VIVID_FILLS.ORANGE,VIVID_FILLS.YELLOW,VIVID_FILLS.GREEN]),params.set(DEFAULT_GAUGE_SERIES_COLOUR_RANGE,[VIVID_FILLS.GREEN,VIVID_FILLS.YELLOW,VIVID_FILLS.RED]),params.set(DEFAULT_ANNOTATION_COLOR,VIVID_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_BACKGROUND_FILL,VIVID_FILLS.BLUE),params}},__name(_a259,"VividLight"),_a259),lightTheme=__name(()=>new ChartTheme,"lightTheme"),darkTheme=__name(()=>new DarkTheme,"darkTheme"),themes={"ag-default-dark":darkTheme,"ag-sheets-dark":__name(()=>new SheetsDark,"ag-sheets-dark"),"ag-polychroma-dark":__name(()=>new PolychromaDark,"ag-polychroma-dark"),"ag-vivid-dark":__name(()=>new VividDark,"ag-vivid-dark"),"ag-material-dark":__name(()=>new MaterialDark,"ag-material-dark"),"ag-financial-dark":__name(()=>new FinancialDark,"ag-financial-dark"),null:lightTheme,undefined:lightTheme,"ag-default":lightTheme,"ag-sheets":__name(()=>new SheetsLight,"ag-sheets"),"ag-polychroma":__name(()=>new PolychromaLight,"ag-polychroma"),"ag-vivid":__name(()=>new VividLight,"ag-vivid"),"ag-material":__name(()=>new MaterialLight,"ag-material"),"ag-financial":__name(()=>new FinancialLight,"ag-financial")};function getChartTheme(value){if(value instanceof ChartTheme)return value;if(value==null||typeof value=="string"){const stockTheme=themes[value];return stockTheme?stockTheme():(Logger.warnOnce(`the theme [${value}] is invalid, using [ag-default] instead.`),lightTheme())}if(isValid(value,themeOptionsDef,"theme")){const flattenedTheme=reduceThemeOptions(value),baseTheme=flattenedTheme.baseTheme?getChartTheme(flattenedTheme.baseTheme):lightTheme();return new baseTheme.constructor(flattenedTheme)}return lightTheme()}__name(getChartTheme,"getChartTheme");function reduceThemeOptions(options){let maybeNested=options,palette;const overrides=[];for(;typeof maybeNested=="object";)palette??(palette=maybeNested.palette),maybeNested.overrides&&overrides.push(maybeNested.overrides),maybeNested=maybeNested.baseTheme;return{baseTheme:maybeNested,overrides:mergeDefaults(...overrides),palette}}__name(reduceThemeOptions,"reduceThemeOptions");var themeOptionsDef={baseTheme:or(string,object),overrides:object,palette:{fills:arrayOf(string),strokes:arrayOf(string),up:{fill:string,stroke:string},down:{fill:string,stroke:string},neutral:{fill:string,stroke:string}}},unthemedSeries=new Set(["map-shape-background","map-line-background"]),_a260,ChartOptions=(_a260=class{constructor(userOptions,specialOverrides){var _a275,_b;this.debug=Debug.create(!0,"opts");var _a274;this.presetType=specialOverrides==null?void 0:specialOverrides.presetType;const cloneOptions={shallow:["data"]};userOptions=deepClone(userOptions,cloneOptions);let options=deepClone(userOptions,cloneOptions);if(this.presetType!=null){const presetOptions=((_a275=PRESETS[this.presetType])==null?void 0:_a275.call(PRESETS,options,()=>this.activeTheme))??options;this.debug(">>> AgCharts.createOrUpdate() - applying preset",options,presetOptions),options=presetOptions}enterpriseModule.isEnterprise||removeUsedEnterpriseOptions(options),this.activeTheme=getChartTheme(options.theme),this.presetType&&(options=this.activeTheme.templateTheme(options)),this.sanityCheckAndCleanup(options),this.defaultAxes=this.getDefaultAxes(options),this.specialOverrides=this.specialOverridesDefaults({...specialOverrides});const chartType2=this.optionsType(options),{axes:axesThemes={},annotations:{axesButtons=null,...annotationsThemes}={},series:_,...themeDefaults}=this.getSeriesThemeConfig(chartType2);this.userOptions=userOptions,this.processedOptions=deepClone(mergeDefaults(options,axesButtons!=null?{annotations:{axesButtons}}:{},themeDefaults,this.defaultAxes),cloneOptions),this.processAxesOptions(this.processedOptions,axesThemes),this.processSeriesOptions(this.processedOptions),this.processMiniChartSeriesOptions(this.processedOptions),this.annotationThemes=annotationsThemes,(isAgCartesianChartOptions(this.processedOptions)||isAgPolarChartOptionsWithSeriesBasedLegend(this.processedOptions))&&((_b=this.processedOptions.legend)==null?void 0:_b.enabled)==null&&((_a274=this.processedOptions).legend??(_a274.legend={}),this.processedOptions.legend.enabled=this.processedOptions.series.length>1),this.enableConfiguredOptions(this.processedOptions),enterpriseModule.isEnterprise||removeUsedEnterpriseOptions(this.processedOptions,!0)}getOptions(){return this.processedOptions??{}}diffOptions(options){return jsonDiff(options,this.processedOptions)}getSeriesThemeConfig(seriesType2){var _a274;const themeConfig=deepClone(((_a274=this.activeTheme)==null?void 0:_a274.config[seriesType2])??{});return this.removeLeftoverSymbols(themeConfig),themeConfig}getDefaultAxes(options){const optionsType2=this.optionsType(options),axesDefaults=seriesRegistry.cloneDefaultAxes(optionsType2);return seriesRegistry.isDefaultAxisSwapNeeded(options)&&this.swapAxesPosition(axesDefaults),axesDefaults}optionsType(options){var _a274,_b;return((_b=(_a274=options.series)==null?void 0:_a274[0])==null?void 0:_b.type)??"line"}sanityCheckAndCleanup(options){var _a274;this.deprecationWarnings(options),this.axesTypeIntegrity(options),this.seriesTypeIntegrity(options),this.soloSeriesIntegrity(options),this.removeDisabledOptions(options),this.removeLeftoverSymbols(options),(_a274=options.series)!=null&&_a274.some(s=>s.type==="bullet")&&options.sync!=null&&options.sync.enabled!==!1&&(Logger.warnOnce("bullet series cannot be synced, disabling synchronization."),delete options.sync)}swapAxesPosition(options){if(isAgCartesianChartOptions(options)){const[axis0,axis1]=options.axes??[];options.axes=[{...axis0,position:axis1.position},{...axis1,position:axis0.position}]}}processAxesOptions(options,axesThemes){"axes"in options&&(options.axes=options.axes.map(axis=>{var _a274,_b,_c;const{crossLines:crossLinesTheme,...axisTheme}=mergeDefaults((_a274=axesThemes[axis.type])==null?void 0:_a274[axis.position],axesThemes[axis.type]);axis.crossLines&&(axis.crossLines=mergeArrayDefaults(axis.crossLines,crossLinesTheme));const gridLineStyle=(_b=axisTheme.gridLine)==null?void 0:_b.style;(_c=axis.gridLine)!=null&&_c.style&&(gridLineStyle!=null&&gridLineStyle.length)&&(axis.gridLine.style=axis.gridLine.style.map((style,index)=>style.stroke!=null||style.lineDash!=null?mergeDefaults(style,gridLineStyle.at(index%gridLineStyle.length)):style));const{top:_1,right:_2,bottom:_3,left:_4,...axisOptions}=mergeDefaults(axis,axisTheme);return axisOptions}))}processSeriesOptions(options){var _a274,_b;const defaultSeriesType=this.getDefaultSeriesType(options),defaultTooltipPosition=this.getTooltipPositionDefaults(options),userPalette=isObject(options.theme)?paletteType((_a274=options.theme)==null?void 0:_a274.palette):"inbuilt",paletteOptions={colourIndex:0,userPalette},processedSeries=(_b=options.series)==null?void 0:_b.map(series=>{series.type??(series.type=defaultSeriesType);const{innerLabels:innerLabelsTheme,...seriesTheme}=this.getSeriesThemeConfig(series.type).series??{},seriesPaletteOptions=unthemedSeries.has(series.type)?{colourIndex:0,userPalette}:paletteOptions,palette=this.getSeriesPalette(series.type,seriesPaletteOptions),defaultTooltipRange=this.getTooltipRangeDefaults(options,series.type),seriesOptions=mergeDefaults(this.getSeriesGroupingOptions(series),series,defaultTooltipPosition,defaultTooltipRange,seriesTheme,palette,{visible:!0});return seriesOptions.innerLabels&&(seriesOptions.innerLabels=mergeArrayDefaults(seriesOptions.innerLabels,innerLabelsTheme)),this.activeTheme.templateTheme(seriesOptions)});options.series=this.setSeriesGroupingOptions(processedSeries??[])}processMiniChartSeriesOptions(options){var _a274,_b;let miniChartSeries=(_b=(_a274=options.navigator)==null?void 0:_a274.miniChart)==null?void 0:_b.series;if(miniChartSeries==null)return;const paletteOptions={colourIndex:0,userPalette:isObject(options.theme)?paletteType(options.theme.palette):"inbuilt"};miniChartSeries=miniChartSeries.map(series=>{series.type??(series.type="line");const{innerLabels:_,...seriesTheme}=this.getSeriesThemeConfig(series.type).series??{},seriesOptions=mergeDefaults(this.getSeriesGroupingOptions(series),series,seriesTheme,this.getSeriesPalette(series.type,paletteOptions));return this.activeTheme.templateTheme(seriesOptions)}),options.navigator.miniChart.series=this.setSeriesGroupingOptions(miniChartSeries)}getSeriesPalette(seriesType2,options){const paletteFactory=seriesRegistry.getPaletteFactory(seriesType2),{colourIndex:colourOffset,userPalette}=options,{fills=[],strokes=[]}=this.activeTheme.palette;return paletteFactory==null?void 0:paletteFactory({userPalette,colorsCount:Math.max(fills.length,strokes.length),themeTemplateParameters:this.activeTheme.getTemplateParameters(),palette:this.activeTheme.palette,takeColors(count){return options.colourIndex+=count,{fills:circularSliceArray(fills,count,colourOffset),strokes:circularSliceArray(strokes,count,colourOffset)}}})}getSeriesGroupingOptions(series){const groupable=seriesRegistry.isGroupable(series.type),stackable=seriesRegistry.isStackable(series.type),stackedByDefault=seriesRegistry.isStackedByDefault(series.type);series.grouped&&!groupable&&Logger.warnOnce(`unsupported grouping of series type "${series.type}".`),(series.stacked||series.stackGroup)&&!stackable&&Logger.warnOnce(`unsupported stacking of series type "${series.type}".`);let{grouped,stacked}=series;return stacked??(stacked=(stackedByDefault||series.stackGroup!=null)&&!(groupable&&grouped)),grouped??(grouped=!0),{stacked:stackable&&stacked,grouped:groupable&&grouped&&!(stackable&&stacked)}}setSeriesGroupingOptions(allSeries){const seriesGroups=this.getSeriesGrouping(allSeries);this.debug("setSeriesGroupingOptions() - series grouping: ",seriesGroups);const groupIdx={},groupCount2=seriesGroups.reduce((countMap,seriesGroup)=>{var _a274;return seriesGroup.groupType==="default"||(countMap[_a274=seriesGroup.seriesType]??(countMap[_a274]=0),countMap[seriesGroup.seriesType]+=seriesGroup.groupType==="stack"?1:seriesGroup.series.length),countMap},{});return seriesGroups.flatMap(seriesGroup=>{var _a274;switch(groupIdx[_a274=seriesGroup.seriesType]??(groupIdx[_a274]=0),seriesGroup.groupType){case"stack":{const groupIndex=groupIdx[seriesGroup.seriesType]++;return seriesGroup.series.map((series,stackIndex)=>Object.assign(series,{seriesGrouping:{groupId:seriesGroup.groupId,groupIndex,groupCount:groupCount2[seriesGroup.seriesType],stackIndex,stackCount:seriesGroup.series.length}}))}case"group":return seriesGroup.series.map(series=>Object.assign(series,{seriesGrouping:{groupId:seriesGroup.groupId,groupIndex:groupIdx[seriesGroup.seriesType]++,groupCount:groupCount2[seriesGroup.seriesType],stackIndex:0,stackCount:0}}))}return seriesGroup.series}).map(({stacked:_,grouped:__,...seriesOptions})=>seriesOptions)}getSeriesGroupId(series){return[series.type,series.xKey,series.stacked?series.stackGroup??"stacked":"grouped"].filter(Boolean).join("-")}getSeriesGrouping(allSeries){const groupMap=new Map;return allSeries.reduce((result,series)=>{const seriesType2=series.type;if(!series.stacked&&!series.grouped)result.push({groupType:"default",seriesType:seriesType2,series:[series],groupId:"__default__"});else{const groupId=this.getSeriesGroupId(series);if(!groupMap.has(groupId)){const record={groupType:series.stacked?"stack":"group",seriesType:seriesType2,series:[],groupId};groupMap.set(groupId,record),result.push(record)}groupMap.get(groupId).series.push(series)}return result},[])}getDefaultSeriesType(options){if(isAgCartesianChartOptions(options))return"line";if(isAgPolarChartOptions(options))return"pie";if(isAgHierarchyChartOptions(options))return"treemap";if(isAgTopologyChartOptions(options))return"map-shape";if(isAgFlowProportionChartOptions(options))return"sankey";if(isAgGaugeChartOptions(options))return"radial-gauge";throw new Error("Invalid chart options type detected.")}getTooltipPositionDefaults(options){var _a274;const position=(_a274=options.tooltip)==null?void 0:_a274.position;if(!isPlainObject(position))return;const{type,xOffset,yOffset}=position,result={};return isString(type)&&isEnumValue(AgTooltipPositionType,type)&&(result.type=type),isFiniteNumber(xOffset)&&(result.xOffset=xOffset),isFiniteNumber(yOffset)&&(result.yOffset=yOffset),{tooltip:{position:result}}}getTooltipRangeDefaults(options,seriesType2){var _a274,_b;return{tooltip:{range:((_a274=options.tooltip)==null?void 0:_a274.range)??((_b=seriesRegistry.getTooltipDefauls(seriesType2))==null?void 0:_b.range)}}}deprecationWarnings(options){Object.entries({yKeys:"yKey",yNames:"yName"}).forEach(([oldProp,newProp])=>{var _a274;(_a274=options.series)!=null&&_a274.some(s=>s[oldProp]!=null)&&Logger.warnOnce(`Property [series.${oldProp}] is deprecated, please use [series.${newProp}] and multiple series instead.`)})}axesTypeIntegrity(options){if("axes"in options){const axes=options.axes??[];for(const{type}of axes)if(!isAxisOptionType(type)){delete options.axes;const expectedTypes=axisRegistry.publicKeys().join(", ");Logger.warnOnce(`unknown axis type: ${type}; expected one of: ${expectedTypes}`)}}}seriesTypeIntegrity(options){var _a274;options.series=(_a274=options.series)==null?void 0:_a274.filter(({type})=>{if(type==null||isSeriesOptionType(type)||isEnterpriseSeriesType(type))return!0;Logger.warnOnce(`unknown series type: ${type}; expected one of: ${publicChartTypes.seriesTypes.join(", ")}`)})}soloSeriesIntegrity(options){const allSeries=options.series;if(allSeries&&allSeries.length>1&&allSeries.some(series=>seriesRegistry.isSolo(series.type))){const mainSeriesType=this.optionsType(options);if(seriesRegistry.isSolo(mainSeriesType))Logger.warn(`series[0] of type '${mainSeriesType}' is incompatible with other series types. Only processing series[0]`),options.series=allSeries.slice(0,1);else{const{solo,nonSolo}=groupBy(allSeries,s=>seriesRegistry.isSolo(s.type)?"solo":"nonSolo"),rejects=unique(solo.map(s=>s.type)).join(", ");Logger.warn(`Unable to mix these series types with the lead series type: ${rejects}`),options.series=nonSolo}}}enableConfiguredOptions(options){jsonWalk(this.userOptions,(visitingUserOpts,visitingMergedOpts)=>{visitingMergedOpts&&"enabled"in visitingMergedOpts&&!visitingMergedOpts._enabledFromTheme&&visitingUserOpts.enabled==null&&(visitingMergedOpts.enabled=!0)},{skip:["data","theme"]},options),jsonWalk(options,visitingMergedOpts=>{visitingMergedOpts._enabledFromTheme!=null&&delete visitingMergedOpts._enabledFromTheme},{skip:["data","theme"]})}removeDisabledOptions(options){jsonWalk(options,optionsNode=>{"enabled"in optionsNode&&optionsNode.enabled===!1&&Object.keys(optionsNode).forEach(key=>{key!=="enabled"&&delete optionsNode[key]})},{skip:["data","theme"]})}removeLeftoverSymbols(options){jsonWalk(options,optionsNode=>{if(!(!optionsNode||!isObject(optionsNode)))for(const[key,value]of Object.entries(optionsNode))isSymbol(value)&&delete optionsNode[key]},{skip:["data"]})}specialOverridesDefaults(options){if(options.window!=null?setWindow(options.window):typeof window<"u"?options.window=window:typeof global<"u"&&(options.window=global.window),options.document!=null?setDocument(options.document):typeof document<"u"?options.document=document:typeof global<"u"&&(options.document=global.document),options.window==null)throw new Error("AG Charts - unable to resolve global window");if(options.document==null)throw new Error("AG Charts - unable to resolve global document");return options}},__name(_a260,"ChartOptions"),_a260),debug2=Debug.create(!0,"opts");function chartType(options){if(options.type==="radial-gauge"||options.type==="linear-gauge")return"gauge";if(isAgCartesianChartOptions(options))return"cartesian";if(isAgPolarChartOptions(options))return"polar";if(isAgHierarchyChartOptions(options))return"hierarchy";if(isAgTopologyChartOptions(options))return"topology";if(isAgFlowProportionChartOptions(options))return"flow-proportion";if(isAgGaugeChartOptions(options))return"gauge";throw new Error(`AG Chart - unknown type of chart for options with type: ${options.type}`)}__name(chartType,"chartType");var _a261,AgCharts=(_a261=class{static licenseCheck(options){var _a274,_b,_c;this.licenseChecked||(this.licenseManager=(_a274=enterpriseModule.licenseManager)==null?void 0:_a274.call(enterpriseModule,options),(_b=this.licenseManager)==null||_b.setLicenseKey(this.licenseKey,this.gridContext),(_c=this.licenseManager)==null||_c.validateLicense(),this.licenseChecked=!0)}static setLicenseKey(licenseKey){this.licenseKey=licenseKey}static setGridContext(gridContext){this.gridContext=gridContext}static getLicenseDetails(licenseKey){var _a274;return(_a274=enterpriseModule.licenseManager)==null?void 0:_a274.call(enterpriseModule,{}).getLicenseDetails(licenseKey)}static getInstance(element2){return AgChartsInternal.getInstance(element2)}static create(options){var _a274,_b;this.licenseCheck(options);const chart=AgChartsInternal.createOrUpdate(options,void 0,this.licenseManager,enterpriseModule.styles!=null?[["ag-charts-enterprise",enterpriseModule.styles]]:[]);return(_a274=this.licenseManager)!=null&&_a274.isDisplayWatermark()&&this.licenseManager&&((_b=enterpriseModule.injectWatermark)==null||_b.call(enterpriseModule,chart.chart.ctx.domManager,this.licenseManager.getWatermarkMessage())),chart}static createFinancialChart(options){return this.create({presetType:"price-volume",...options})}static createGauge(options){return this.create({presetType:"gauge",...options})}},__name(_a261,"AgCharts"),_a261);AgCharts.licenseChecked=!1;AgCharts.gridContext=!1;var _a262,_AgChartsInternal=(_a262=class{static getInstance(element2){const chart=Chart.getInstance(element2);return chart?AgChartInstanceProxy.chartInstances.get(chart):void 0}static initialiseModules(){_a262.initialised||(registerInbuiltModules(),setupModules(),_a262.initialised=!0)}static createOrUpdate(options,proxy,licenseManager,styles){_a262.initialiseModules(),debug2(">>> AgCharts.createOrUpdate() user options",options);const{presetType=proxy==null?void 0:proxy.chart.chartOptions.presetType,...otherOptions}=options;let mutableOptions=otherOptions;AgCharts.optionsMutationFn&&(mutableOptions=AgCharts.optionsMutationFn(mutableOptions,presetType),debug2(">>> AgCharts.createOrUpdate() MUTATED user options",options));const{overrideDevicePixelRatio,document:document2,window:userWindow,...userOptions}=mutableOptions,chartOptions=new ChartOptions(userOptions,{presetType,document:document2,window:userWindow,overrideDevicePixelRatio});let chart=proxy==null?void 0:proxy.chart;return(chart==null||chartType(userOptions)!==chartType(chart==null?void 0:chart.chartOptions.processedOptions))&&(chart=_a262.createChartInstance(chartOptions,chart),styles==null||styles.forEach(([id,css])=>{chart==null||chart.ctx.domManager.addStyles(id,css)})),proxy==null?proxy=new AgChartInstanceProxy(chart,_a262.callbackApi,licenseManager):proxy.chart=chart,debug2.check()&&typeof window<"u"&&(window.agChartInstances??(window.agChartInstances={}),window.agChartInstances[chart.id]=chart),chart.queuedUserOptions.push(userOptions),chart.requestFactoryUpdate(chartRef=>{chartRef.applyOptions(chartOptions);const queueIdx=chartRef.queuedUserOptions.indexOf(userOptions)+1;chartRef.queuedUserOptions.splice(0,queueIdx)}),proxy}static updateUserDelta(proxy,deltaOptions){deltaOptions=deepClone(deltaOptions,{shallow:["data"]}),jsonWalk(deltaOptions,node=>{if(typeof node=="object")for(const[key,value]of Object.entries(node))typeof value>"u"&&Object.assign(node,{[key]:Symbol("UNSET")})},{skip:["data"]});const{chart}=proxy,lastUpdateOptions=chart.getOptions(),userOptions=mergeDefaults(deltaOptions,lastUpdateOptions);debug2(">>> AgCharts.updateUserDelta() user delta",deltaOptions),debug2("AgCharts.updateUserDelta() - base options",lastUpdateOptions),_a262.createOrUpdate(userOptions,proxy)}static createChartInstance(options,oldChart){const transferableResource=oldChart==null?void 0:oldChart.destroy({keepTransferableResources:!0}),ChartConstructor=_a262.getChartByOptions(options.processedOptions);return new ChartConstructor(options,transferableResource)}static getChartByOptions(options){if(isAgCartesianChartOptions(options))return CartesianChart;if(isAgHierarchyChartOptions(options))return HierarchyChart;if(isAgPolarChartOptions(options))return PolarChart;if(isAgTopologyChartOptions(options))return TopologyChart;if(isAgFlowProportionChartOptions(options))return FlowProportionChart;if(isAgGaugeChartOptions(options))return GaugeChart;throw new Error("AG Charts - couldn't apply configuration, check options are correctly structured and series types are specified")}},__name(_a262,"_AgChartsInternal"),_a262);_AgChartsInternal.caretaker=new MementoCaretaker(VERSION);_AgChartsInternal.initialised=!1;_AgChartsInternal.callbackApi={caretaker:_AgChartsInternal.caretaker,createOrUpdate(opts,chart){return _AgChartsInternal.createOrUpdate(opts,chart)},updateUserDelta(chart,deltaOptions){return _AgChartsInternal.updateUserDelta(chart,deltaOptions)}};var AgChartsInternal=_AgChartsInternal,integrated_charts_scene_exports={};__export(integrated_charts_scene_exports,{Arc:__name(()=>Arc2,"Arc"),ArrowDown:__name(()=>ArrowDown,"ArrowDown"),ArrowUp:__name(()=>ArrowUp,"ArrowUp"),BBox:__name(()=>BBox,"BBox"),BandScale:__name(()=>BandScale,"BandScale"),Caption:__name(()=>Caption,"Caption"),ChangeDetectableProperties:__name(()=>ChangeDetectableProperties,"ChangeDetectableProperties"),Circle:__name(()=>Circle,"Circle"),ConicGradient:__name(()=>ConicGradient,"ConicGradient"),ContinuousScale:__name(()=>ContinuousScale,"ContinuousScale"),Diamond:__name(()=>Diamond,"Diamond"),DropShadow:__name(()=>DropShadow,"DropShadow"),ExtendedPath2D:__name(()=>ExtendedPath2D,"ExtendedPath2D"),Gradient:__name(()=>Gradient,"Gradient"),Group:__name(()=>Group,"Group"),HdpiCanvas:__name(()=>HdpiCanvas,"HdpiCanvas"),Image:__name(()=>Image,"Image"),Label:__name(()=>Label,"Label"),Line:__name(()=>Line,"Line"),LinearGradient:__name(()=>LinearGradient,"LinearGradient"),LinearScale:__name(()=>LinearScale,"LinearScale"),Marker:__name(()=>Marker,"Marker"),Node:__name(()=>Node,"Node"),OrdinalTimeScale:__name(()=>OrdinalTimeScale,"OrdinalTimeScale"),Path:__name(()=>Path,"Path"),PointerEvents:__name(()=>PointerEvents,"PointerEvents"),RadialColumnShape:__name(()=>RadialColumnShape,"RadialColumnShape"),Rect:__name(()=>Rect,"Rect"),RedrawType:__name(()=>RedrawType,"RedrawType"),Rotatable:__name(()=>Rotatable,"Rotatable"),RotatableGroup:__name(()=>RotatableGroup,"RotatableGroup"),RotatableText:__name(()=>RotatableText,"RotatableText"),Scalable:__name(()=>Scalable,"Scalable"),ScalableGroup:__name(()=>ScalableGroup,"ScalableGroup"),Scene:__name(()=>Scene,"Scene"),SceneChangeDetection:__name(()=>SceneChangeDetection,"SceneChangeDetection"),ScenePathChangeDetection:__name(()=>ScenePathChangeDetection,"ScenePathChangeDetection"),Sector:__name(()=>Sector,"Sector"),SectorBox:__name(()=>SectorBox,"SectorBox"),Selection:__name(()=>Selection,"Selection"),Shape:__name(()=>Shape,"Shape"),Square:__name(()=>Square,"Square"),SvgPath:__name(()=>SvgPath,"SvgPath"),Text:__name(()=>Text,"Text"),Tooltip:__name(()=>Tooltip,"Tooltip"),Transformable:__name(()=>Transformable,"Transformable"),TransformableText:__name(()=>TransformableText,"TransformableText"),Translatable:__name(()=>Translatable,"Translatable"),TranslatableGroup:__name(()=>TranslatableGroup,"TranslatableGroup"),Triangle:__name(()=>Triangle,"Triangle"),calculateDerivativeExtrema:__name(()=>calculateDerivativeExtrema,"calculateDerivativeExtrema"),calculateDerivativeExtremaXY:__name(()=>calculateDerivativeExtremaXY,"calculateDerivativeExtremaXY"),drawCorner:__name(()=>drawCorner,"drawCorner"),easing:__name(()=>easing_exports,"easing"),evaluateBezier:__name(()=>evaluateBezier,"evaluateBezier"),getFont:__name(()=>getFont,"getFont"),getMarker:__name(()=>getMarker,"getMarker"),getRadialColumnWidth:__name(()=>getRadialColumnWidth,"getRadialColumnWidth"),motion:__name(()=>motion,"motion"),sectorBox:__name(()=>sectorBox,"sectorBox"),solveBezier:__name(()=>solveBezier,"solveBezier"),splitBezier:__name(()=>splitBezier,"splitBezier"),toRadians:__name(()=>toRadians,"toRadians"),toTooltipHtml:__name(()=>toTooltipHtml,"toTooltipHtml")});var _a263,Arc2=(_a263=class extends Path{constructor(){super(),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0,this.restoreOwnStyles()}get fullPie(){return isEqual(normalizeAngle360(this.startAngle),normalizeAngle360(this.endAngle))}updatePath(){const path=this.path;path.clear(),path.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?path.closePath():this.type===2&&!this.fullPie&&(path.lineTo(this.centerX,this.centerY),path.closePath())}computeBBox(){return new BBox(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(x,y){const bbox=this.getBBox();return this.type!==0&&bbox.containsPoint(x,y)&&this.path.isPointInPath(x,y)}},__name(_a263,"Arc2"),_a263);Arc2.className="Arc";Arc2.defaultStyles=Object.assign({},Shape.defaultStyles,{lineWidth:1,fillStyle:null});__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"centerX",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"centerY",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"radius",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"counterClockwise",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"type",2);var _a264,ConicGradient=(_a264=class extends Gradient{constructor(colorSpace,stops,angle2=0,bbox){super(colorSpace,stops,bbox),this.angle=angle2}createCanvasGradient(ctx,bbox){const{colorSpace,stops,angle:angle2}=this,radians=normalizeAngle360(toRadians(angle2+90));if(!("createConicGradient"in ctx))return new LinearGradient(colorSpace,stops,angle2).createCanvasGradient(ctx,bbox);const cx=bbox.x+bbox.width*.5,cy=bbox.y+bbox.height*.5;return ctx.createConicGradient(radians,cx,cy)}},__name(_a264,"ConicGradient"),_a264);function rotatePoint(x,y,rotation){const radius=Math.sqrt(x**2+y**2),rotated=Math.atan2(y,x)+rotation;return{x:Math.cos(rotated)*radius,y:Math.sin(rotated)*radius}}__name(rotatePoint,"rotatePoint");var _a265,RadialColumnShape=(_a265=class extends Path{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}set cornerRadius(_value){}computeBBox(){const{innerRadius,outerRadius,columnWidth}=this,rotation=this.getRotation(),left=-columnWidth/2,right=columnWidth/2,top=-outerRadius,bottom=-innerRadius;let x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(let i=0;i<4;i+=1){const{x,y}=rotatePoint(i%2===0?left:right,i<2?top:bottom,rotation);x0=Math.min(x,x0),y0=Math.min(y,y0),x1=Math.max(x,x1),y1=Math.max(y,y1)}return new BBox(x0,y0,x1-x0,y1-y0)}getRotation(){const{startAngle,endAngle}=this,midAngle=angleBetween(startAngle,endAngle);return normalizeAngle360(startAngle+midAngle/2+Math.PI/2)}updatePath(){const{isBeveled}=this;isBeveled?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth,innerRadius,outerRadius,path}=this,left=-columnWidth/2,right=columnWidth/2,top=-outerRadius,bottom=-innerRadius,rotation=this.getRotation(),points=[[left,bottom],[left,top],[right,top],[right,bottom]].map(([x,y])=>rotatePoint(x,y,rotation));path.clear(!0),path.moveTo(points[0].x,points[0].y),path.lineTo(points[1].x,points[1].y),path.lineTo(points[2].x,points[2].y),path.lineTo(points[3].x,points[3].y),path.closePath()}updateBeveledPath(){const{columnWidth,path,outerRadius,innerRadius,axisInnerRadius,axisOuterRadius,isRadiusAxisReversed}=this,isStackBottom=isEqual(innerRadius,axisInnerRadius),sideRotation=Math.asin(columnWidth/2/innerRadius),pointRotation=this.getRotation(),rotate2=__name((x,y)=>rotatePoint(x,y,pointRotation),"rotate2"),getTriangleHypotenuse=__name((leg,otherLeg)=>Math.sqrt(leg**2+otherLeg**2),"getTriangleHypotenuse"),getTriangleLeg=__name((hypotenuse,otherLeg)=>otherLeg>hypotenuse?0:Math.sqrt(hypotenuse**2-otherLeg**2),"getTriangleLeg"),compare=__name((value,otherValue,lessThan)=>lessThan?value<otherValue:value>otherValue,"compare"),shouldConnectBottomCircle=isStackBottom&&!isNaN(sideRotation)&&sideRotation<Math.PI/6;let left=-columnWidth/2,right=columnWidth/2;const top=-outerRadius,bottom=-innerRadius*(shouldConnectBottomCircle?Math.cos(sideRotation):1),hasBottomIntersection=compare(axisOuterRadius,getTriangleHypotenuse(innerRadius,columnWidth/2),!isRadiusAxisReversed);if(hasBottomIntersection){const bottomIntersectionX=getTriangleLeg(axisOuterRadius,innerRadius);left=-bottomIntersectionX,right=bottomIntersectionX}path.clear(!0);const bottomLeftPt=rotate2(left,bottom);path.moveTo(bottomLeftPt.x,bottomLeftPt.y);const isEmpty=isEqual(innerRadius,outerRadius),hasSideIntersection=compare(axisOuterRadius,getTriangleHypotenuse(outerRadius,columnWidth/2),!isRadiusAxisReversed);if(isEmpty&&shouldConnectBottomCircle)path.arc(0,0,innerRadius,normalizeAngle360(-sideRotation-Math.PI/2)+pointRotation,normalizeAngle360(sideRotation-Math.PI/2)+pointRotation,!1);else if(hasSideIntersection){const sideIntersectionY=-getTriangleLeg(axisOuterRadius,columnWidth/2),topIntersectionX=getTriangleLeg(axisOuterRadius,outerRadius);if(!hasBottomIntersection){const topLeftPt=rotate2(left,sideIntersectionY);path.lineTo(topLeftPt.x,topLeftPt.y)}if(path.arc(0,0,axisOuterRadius,Math.atan2(sideIntersectionY,left)+pointRotation,Math.atan2(top,-topIntersectionX)+pointRotation,!1),!isEqual(topIntersectionX,0)){const topRightBevelPt=rotate2(topIntersectionX,top);path.lineTo(topRightBevelPt.x,topRightBevelPt.y)}path.arc(0,0,axisOuterRadius,Math.atan2(top,topIntersectionX)+pointRotation,Math.atan2(sideIntersectionY,right)+pointRotation,!1)}else{const topLeftPt=rotate2(left,top),topRightPt=rotate2(right,top);path.lineTo(topLeftPt.x,topLeftPt.y),path.lineTo(topRightPt.x,topRightPt.y)}const bottomRightPt=rotate2(right,bottom);if(path.lineTo(bottomRightPt.x,bottomRightPt.y),shouldConnectBottomCircle)path.arc(0,0,innerRadius,normalizeAngle360(sideRotation-Math.PI/2)+pointRotation,normalizeAngle360(-sideRotation-Math.PI/2)+pointRotation,!0);else{const rotatedBottomLeftPt=rotate2(left,bottom);path.lineTo(rotatedBottomLeftPt.x,rotatedBottomLeftPt.y)}path.closePath()}},__name(_a265,"RadialColumnShape"),_a265);RadialColumnShape.className="RadialColumnShape";__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isBeveled",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"columnWidth",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"outerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"innerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisInnerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisOuterRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isRadiusAxisReversed",2);function getRadialColumnWidth(startAngle,endAngle,axisOuterRadius,columnWidthRatio,maxColumnWidthRatio){const rotation=angleBetween(startAngle,endAngle),pad2=rotation*(1-columnWidthRatio)/2;if(startAngle+=pad2,endAngle-=pad2,rotation<.001)return 2*axisOuterRadius*maxColumnWidthRatio;if(rotation>=2*Math.PI){const midAngle=startAngle+rotation/2;startAngle=midAngle-Math.PI,endAngle=midAngle+Math.PI}const startX=axisOuterRadius*Math.cos(startAngle),startY=axisOuterRadius*Math.sin(startAngle),endX=axisOuterRadius*Math.cos(endAngle),endY=axisOuterRadius*Math.sin(endAngle),colWidth=Math.floor(Math.sqrt((startX-endX)**2+(startY-endY)**2)),maxWidth=2*axisOuterRadius*maxColumnWidthRatio;return Math.max(1,Math.min(maxWidth,colWidth))}__name(getRadialColumnWidth,"getRadialColumnWidth");var _a266,SvgPath=(_a266=class extends Path{constructor(d=""){super(),this.x=0,this.y=0,this.commands=[],this._d="",this.d=d}get d(){return this._d}set d(d){if(d!==this._d){this._d=d,this.commands.length=0;for(const[_,command,paramsString]of d.matchAll(/([A-Z])([0-9. ]*)/g)){const params=paramsString.split(/\s+/g).map(Number);this.commands.push([command,params])}this.checkPathDirty()}}updatePath(){const{path,x,y}=this;path.clear();let lastX=x,lastY=y;for(const[command,params]of this.commands)switch(command){case"M":path.moveTo(x+params[0],y+params[1]),lastX=x+params[0];break;case"C":path.cubicCurveTo(x+params[0],y+params[1],x+params[2],y+params[3],x+params[4],y+params[5]),lastX=x+params[4],lastY=y+params[5];break;case"H":path.lineTo(x+params[0],lastY),lastX=y+params[0];break;case"L":path.lineTo(x+params[0],y+params[1]),lastX=x+params[0],lastY=y+params[1];break;case"V":path.lineTo(lastX,y+params[0]),lastY=y+params[0];break;case"Z":path.closePath();break;default:throw new Error(`Could not translate command '${command}' with '${params.join(" ")}'`)}path.closePath()}},__name(_a266,"SvgPath"),_a266);__decorateClass([ScenePathChangeDetection()],SvgPath.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],SvgPath.prototype,"y",2);var _a267,_ArrowUp=(_a267=class extends Marker{updatePath(){const s=this.size/2;super.applyPath(s,_a267.moves)}},__name(_a267,"_ArrowUp"),_a267);_ArrowUp.className="ArrowUp";_ArrowUp.moves=[{x:0,y:0,t:"move"},{x:1,y:1.2},{x:-.5,y:0},{x:0,y:.8},{x:-1,y:0},{x:0,y:-.8},{x:-.5,y:0}];var ArrowUp=_ArrowUp,_a268,ArrowDown=(_a268=class extends Marker{updatePath(){const s=this.size/2;super.applyPath(s,ArrowUp.moves.map(m=>({x:m.x*-1,y:m.y*-1})))}},__name(_a268,"ArrowDown"),_a268);ArrowDown.className="ArrowDown";var motion={...fromToMotion_exports,...resetMotion_exports},getFont=TextUtils.toFontString,integrated_charts_theme_exports={};__export(integrated_charts_theme_exports,{CARTESIAN_AXIS_TYPE:__name(()=>CARTESIAN_AXIS_TYPE,"CARTESIAN_AXIS_TYPE"),ChartTheme:__name(()=>ChartTheme,"ChartTheme"),DEFAULT_ANNOTATION_BACKGROUND_FILL:__name(()=>DEFAULT_ANNOTATION_BACKGROUND_FILL,"DEFAULT_ANNOTATION_BACKGROUND_FILL"),DEFAULT_ANNOTATION_COLOR:__name(()=>DEFAULT_ANNOTATION_COLOR,"DEFAULT_ANNOTATION_COLOR"),DEFAULT_ANNOTATION_HANDLE_FILL:__name(()=>DEFAULT_ANNOTATION_HANDLE_FILL,"DEFAULT_ANNOTATION_HANDLE_FILL"),DEFAULT_AXIS_GRID_COLOUR:__name(()=>DEFAULT_AXIS_GRID_COLOUR,"DEFAULT_AXIS_GRID_COLOUR"),DEFAULT_AXIS_LINE_COLOUR:__name(()=>DEFAULT_AXIS_LINE_COLOUR,"DEFAULT_AXIS_LINE_COLOUR"),DEFAULT_BACKGROUND_COLOUR:__name(()=>DEFAULT_BACKGROUND_COLOUR,"DEFAULT_BACKGROUND_COLOUR"),DEFAULT_CAPTION_ALIGNMENT:__name(()=>DEFAULT_CAPTION_ALIGNMENT,"DEFAULT_CAPTION_ALIGNMENT"),DEFAULT_CAPTION_LAYOUT_STYLE:__name(()=>DEFAULT_CAPTION_LAYOUT_STYLE,"DEFAULT_CAPTION_LAYOUT_STYLE"),DEFAULT_COLOURS:__name(()=>DEFAULT_COLOURS,"DEFAULT_COLOURS"),DEFAULT_CROSS_LINES_COLOUR:__name(()=>DEFAULT_CROSS_LINES_COLOUR,"DEFAULT_CROSS_LINES_COLOUR"),DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:__name(()=>DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,"DEFAULT_DIVERGING_SERIES_COLOUR_RANGE"),DEFAULT_FONT_FAMILY:__name(()=>DEFAULT_FONT_FAMILY,"DEFAULT_FONT_FAMILY"),DEFAULT_GAUGE_SERIES_COLOUR_RANGE:__name(()=>DEFAULT_GAUGE_SERIES_COLOUR_RANGE,"DEFAULT_GAUGE_SERIES_COLOUR_RANGE"),DEFAULT_GRIDLINE_ENABLED:__name(()=>DEFAULT_GRIDLINE_ENABLED,"DEFAULT_GRIDLINE_ENABLED"),DEFAULT_HIERARCHY_FILLS:__name(()=>DEFAULT_HIERARCHY_FILLS,"DEFAULT_HIERARCHY_FILLS"),DEFAULT_HIERARCHY_STROKES:__name(()=>DEFAULT_HIERARCHY_STROKES,"DEFAULT_HIERARCHY_STROKES"),DEFAULT_INSIDE_SERIES_LABEL_COLOUR:__name(()=>DEFAULT_INSIDE_SERIES_LABEL_COLOUR,"DEFAULT_INSIDE_SERIES_LABEL_COLOUR"),DEFAULT_INVERTED_LABEL_COLOUR:__name(()=>DEFAULT_INVERTED_LABEL_COLOUR,"DEFAULT_INVERTED_LABEL_COLOUR"),DEFAULT_LABEL_COLOUR:__name(()=>DEFAULT_LABEL_COLOUR,"DEFAULT_LABEL_COLOUR"),DEFAULT_MUTED_LABEL_COLOUR:__name(()=>DEFAULT_MUTED_LABEL_COLOUR,"DEFAULT_MUTED_LABEL_COLOUR"),DEFAULT_PADDING:__name(()=>DEFAULT_PADDING,"DEFAULT_PADDING"),DEFAULT_POLAR_SERIES_STROKE:__name(()=>DEFAULT_POLAR_SERIES_STROKE,"DEFAULT_POLAR_SERIES_STROKE"),DEFAULT_SHADOW_COLOUR:__name(()=>DEFAULT_SHADOW_COLOUR,"DEFAULT_SHADOW_COLOUR"),DEFAULT_TEXTBOX_COLOR:__name(()=>DEFAULT_TEXTBOX_COLOR,"DEFAULT_TEXTBOX_COLOR"),DEFAULT_TEXTBOX_FILL:__name(()=>DEFAULT_TEXTBOX_FILL,"DEFAULT_TEXTBOX_FILL"),DEFAULT_TEXTBOX_STROKE:__name(()=>DEFAULT_TEXTBOX_STROKE,"DEFAULT_TEXTBOX_STROKE"),DEFAULT_TEXT_ANNOTATION_COLOR:__name(()=>DEFAULT_TEXT_ANNOTATION_COLOR,"DEFAULT_TEXT_ANNOTATION_COLOR"),DEFAULT_TOOLBAR_POSITION:__name(()=>DEFAULT_TOOLBAR_POSITION,"DEFAULT_TOOLBAR_POSITION"),FONT_SIZE:__name(()=>FONT_SIZE,"FONT_SIZE"),FONT_WEIGHT:__name(()=>FONT_WEIGHT2,"FONT_WEIGHT"),IS_DARK_THEME:__name(()=>IS_DARK_THEME,"IS_DARK_THEME"),PALETTE_ALT_DOWN_FILL:__name(()=>PALETTE_ALT_DOWN_FILL,"PALETTE_ALT_DOWN_FILL"),PALETTE_ALT_DOWN_STROKE:__name(()=>PALETTE_ALT_DOWN_STROKE,"PALETTE_ALT_DOWN_STROKE"),PALETTE_ALT_NEUTRAL_FILL:__name(()=>PALETTE_ALT_NEUTRAL_FILL,"PALETTE_ALT_NEUTRAL_FILL"),PALETTE_ALT_NEUTRAL_STROKE:__name(()=>PALETTE_ALT_NEUTRAL_STROKE,"PALETTE_ALT_NEUTRAL_STROKE"),PALETTE_ALT_UP_FILL:__name(()=>PALETTE_ALT_UP_FILL,"PALETTE_ALT_UP_FILL"),PALETTE_ALT_UP_STROKE:__name(()=>PALETTE_ALT_UP_STROKE,"PALETTE_ALT_UP_STROKE"),PALETTE_DOWN_FILL:__name(()=>PALETTE_DOWN_FILL,"PALETTE_DOWN_FILL"),PALETTE_DOWN_STROKE:__name(()=>PALETTE_DOWN_STROKE,"PALETTE_DOWN_STROKE"),PALETTE_NEUTRAL_FILL:__name(()=>PALETTE_NEUTRAL_FILL,"PALETTE_NEUTRAL_FILL"),PALETTE_NEUTRAL_STROKE:__name(()=>PALETTE_NEUTRAL_STROKE,"PALETTE_NEUTRAL_STROKE"),PALETTE_UP_FILL:__name(()=>PALETTE_UP_FILL,"PALETTE_UP_FILL"),PALETTE_UP_STROKE:__name(()=>PALETTE_UP_STROKE,"PALETTE_UP_STROKE"),POLAR_AXIS_SHAPE:__name(()=>POLAR_AXIS_SHAPE,"POLAR_AXIS_SHAPE"),POLAR_AXIS_TYPE:__name(()=>POLAR_AXIS_TYPE,"POLAR_AXIS_TYPE"),POSITION:__name(()=>POSITION2,"POSITION"),getChartTheme:__name(()=>getChartTheme,"getChartTheme"),markerPaletteFactory:__name(()=>markerPaletteFactory,"markerPaletteFactory"),singleSeriesPaletteFactory:__name(()=>singleSeriesPaletteFactory,"singleSeriesPaletteFactory"),themes:__name(()=>themes2,"themes")});var themes2=mapValues(themes,themeFactory=>themeFactory==null?void 0:themeFactory()),sparklines_scale_exports={};__export(sparklines_scale_exports,{BandScale:__name(()=>BandScale,"BandScale"),ColorScale:__name(()=>ColorScale,"ColorScale"),ContinuousScale:__name(()=>ContinuousScale,"ContinuousScale"),Invalidating:__name(()=>Invalidating,"Invalidating"),LinearScale:__name(()=>LinearScale,"LinearScale"),OrdinalTimeScale:__name(()=>OrdinalTimeScale,"OrdinalTimeScale"),TimeScale:__name(()=>TimeScale,"TimeScale")});var sparklines_util_exports={};__export(sparklines_util_exports,{Color:__name(()=>Color,"Color"),Debug:__name(()=>Debug,"Debug"),Logger:__name(()=>Logger,"Logger"),Padding:__name(()=>Padding,"Padding"),TimeInterval:__name(()=>TimeInterval,"TimeInterval"),Vec2:__name(()=>Vec2,"Vec2"),angleBetween:__name(()=>angleBetween,"angleBetween"),angleDiff:__name(()=>angleDiff,"angleDiff"),areArrayNumbersEqual:__name(()=>areArrayNumbersEqual,"areArrayNumbersEqual"),checkDatum:__name(()=>checkDatum,"checkDatum"),clamp:__name(()=>clamp,"clamp"),clampArray:__name(()=>clampArray,"clampArray"),clockwiseAngle:__name(()=>clockwiseAngle,"clockwiseAngle"),clockwiseAngles:__name(()=>clockwiseAngles,"clockwiseAngles"),countFractionDigits:__name(()=>countFractionDigits,"countFractionDigits"),createId:__name(()=>createId,"createId"),day:__name(()=>day,"day"),deepClone:__name(()=>deepClone,"deepClone"),displacePointFromVector:__name(()=>displacePointFromVector,"displacePointFromVector"),extent:__name(()=>extent,"extent"),findMinMax:__name(()=>findMinMax,"findMinMax"),findRangeExtent:__name(()=>findRangeExtent,"findRangeExtent"),formatNormalizedPercentage:__name(()=>formatNormalizedPercentage,"formatNormalizedPercentage"),formatPercentage:__name(()=>formatPercentage,"formatPercentage"),friday:__name(()=>friday,"friday"),hour:__name(()=>hour,"hour"),interpolateColor:__name(()=>interpolateColor,"interpolateColor"),interpolateNumber:__name(()=>interpolateNumber,"interpolateNumber"),isBetweenAngles:__name(()=>isBetweenAngles,"isBetweenAngles"),isContinuous:__name(()=>isContinuous,"isContinuous"),isDate:__name(()=>isValidDate,"isDate"),isDenseInterval:__name(()=>isDenseInterval,"isDenseInterval"),isEqual:__name(()=>isEqual,"isEqual"),isNegative:__name(()=>isNegative,"isNegative"),isNumber:__name(()=>isFiniteNumber,"isNumber"),isNumberEqual:__name(()=>isEqual,"isNumberEqual"),isNumberObject:__name(()=>isNumberObject,"isNumberObject"),isString:__name(()=>isString,"isString"),isStringObject:__name(()=>isStringObject,"isStringObject"),jsonApply:__name(()=>jsonApply,"jsonApply"),jsonDiff:__name(()=>jsonDiff,"jsonDiff"),jsonWalk:__name(()=>jsonWalk,"jsonWalk"),millisecond:__name(()=>millisecond,"millisecond"),minute:__name(()=>minute,"minute"),mod:__name(()=>mod,"mod"),monday:__name(()=>monday,"monday"),month:__name(()=>month,"month"),normalisedExtentWithMetadata:__name(()=>normalisedExtentWithMetadata,"normalisedExtentWithMetadata"),normalizeAngle180:__name(()=>normalizeAngle180,"normalizeAngle180"),normalizeAngle360:__name(()=>normalizeAngle360,"normalizeAngle360"),normalizeAngle360Inclusive:__name(()=>normalizeAngle360Inclusive,"normalizeAngle360Inclusive"),range:__name(()=>range,"range"),resetIds:__name(()=>resetIds,"resetIds"),round:__name(()=>round,"round"),sanitizeHtml:__name(()=>sanitizeHtml,"sanitizeHtml"),saturday:__name(()=>saturday,"saturday"),second:__name(()=>second,"second"),setAttribute:__name(()=>setAttribute,"setAttribute"),setAttributes:__name(()=>setAttributes,"setAttributes"),shallowClone:__name(()=>shallowClone,"shallowClone"),sunday:__name(()=>sunday,"sunday"),thursday:__name(()=>thursday,"thursday"),tickFormat:__name(()=>tickFormat,"tickFormat"),tickStep:__name(()=>tickStep,"tickStep"),ticks:__name(()=>createTicks,"ticks"),toDegrees:__name(()=>toDegrees,"toDegrees"),toFixed:__name(()=>toFixed,"toFixed"),toRadians:__name(()=>toRadians,"toRadians"),transformIntegratedCategoryValue:__name(()=>transformIntegratedCategoryValue,"transformIntegratedCategoryValue"),tuesday:__name(()=>tuesday,"tuesday"),utcDay:__name(()=>utcDay,"utcDay"),utcHour:__name(()=>utcHour,"utcHour"),utcMinute:__name(()=>utcMinute,"utcMinute"),utcMonth:__name(()=>utcMonth,"utcMonth"),utcYear:__name(()=>utcYear,"utcYear"),uuid:__name(()=>uuid,"uuid"),wednesday:__name(()=>wednesday,"wednesday"),year:__name(()=>year,"year"),zipObject:__name(()=>zipObject,"zipObject")});function zipObject(keys,values){const zipped={};if(Array.isArray(values))for(let i=0;i<keys.length;i++)zipped[`${keys[i]}`]=values[i];else for(let i=0;i<keys.length;i++)zipped[`${keys[i]}`]=values;return zipped}__name(zipObject,"zipObject");var module_support_exports={};__export(module_support_exports,{AND:__name(()=>AND,"AND"),ARRAY:__name(()=>ARRAY,"ARRAY"),ARRAY_OF:__name(()=>ARRAY_OF,"ARRAY_OF"),AbstractBarSeries:__name(()=>AbstractBarSeries,"AbstractBarSeries"),AbstractBarSeriesProperties:__name(()=>AbstractBarSeriesProperties,"AbstractBarSeriesProperties"),ActionOnSet:__name(()=>ActionOnSet,"ActionOnSet"),Animation:__name(()=>Animation,"Animation"),AnimationManager:__name(()=>AnimationManager,"AnimationManager"),Axis:__name(()=>Axis,"Axis"),AxisInterval:__name(()=>AxisInterval,"AxisInterval"),AxisLabel:__name(()=>AxisLabel,"AxisLabel"),AxisTick:__name(()=>AxisTick,"AxisTick"),AxisTicks:__name(()=>AxisTicks,"AxisTicks"),BOOLEAN:__name(()=>BOOLEAN,"BOOLEAN"),BOOLEAN_ARRAY:__name(()=>BOOLEAN_ARRAY,"BOOLEAN_ARRAY"),Background:__name(()=>Background,"Background"),BackgroundModule:__name(()=>BackgroundModule,"BackgroundModule"),BaseModuleInstance:__name(()=>BaseModuleInstance,"BaseModuleInstance"),BaseProperties:__name(()=>BaseProperties,"BaseProperties"),COLOR_STRING:__name(()=>COLOR_STRING,"COLOR_STRING"),COLOR_STRING_ARRAY:__name(()=>COLOR_STRING_ARRAY,"COLOR_STRING_ARRAY"),CachedTextMeasurer:__name(()=>CachedTextMeasurer,"CachedTextMeasurer"),CachedTextMeasurerPool:__name(()=>CachedTextMeasurerPool,"CachedTextMeasurerPool"),CartesianAxis:__name(()=>CartesianAxis,"CartesianAxis"),CartesianSeries:__name(()=>CartesianSeries,"CartesianSeries"),CartesianSeriesNodeEvent:__name(()=>CartesianSeriesNodeEvent,"CartesianSeriesNodeEvent"),CartesianSeriesProperties:__name(()=>CartesianSeriesProperties,"CartesianSeriesProperties"),CategoryAxis:__name(()=>CategoryAxis,"CategoryAxis"),ChartAxisDirection:__name(()=>ChartAxisDirection,"ChartAxisDirection"),ChartEventManager:__name(()=>ChartEventManager,"ChartEventManager"),ChartOptions:__name(()=>ChartOptions,"ChartOptions"),ChartUpdateType:__name(()=>ChartUpdateType,"ChartUpdateType"),ContextMenuRegistry:__name(()=>ContextMenuRegistry,"ContextMenuRegistry"),Cursor:__name(()=>Cursor,"Cursor"),CursorManager:__name(()=>CursorManager,"CursorManager"),DATE:__name(()=>DATE,"DATE"),DATE_ARRAY:__name(()=>DATE_ARRAY,"DATE_ARRAY"),DATE_OR_DATETIME_MS:__name(()=>DATE_OR_DATETIME_MS,"DATE_OR_DATETIME_MS"),DEFAULT_CARTESIAN_DIRECTION_KEYS:__name(()=>DEFAULT_CARTESIAN_DIRECTION_KEYS,"DEFAULT_CARTESIAN_DIRECTION_KEYS"),DEFAULT_CARTESIAN_DIRECTION_NAMES:__name(()=>DEFAULT_CARTESIAN_DIRECTION_NAMES,"DEFAULT_CARTESIAN_DIRECTION_NAMES"),DEFAULT_TOOLTIP_CLASS:__name(()=>DEFAULT_TOOLTIP_CLASS,"DEFAULT_TOOLTIP_CLASS"),DEFAULT_TOOLTIP_DARK_CLASS:__name(()=>DEFAULT_TOOLTIP_DARK_CLASS,"DEFAULT_TOOLTIP_DARK_CLASS"),DEGREE:__name(()=>DEGREE,"DEGREE"),DIRECTION:__name(()=>DIRECTION,"DIRECTION"),DOMManager:__name(()=>DOMManager,"DOMManager"),DataController:__name(()=>DataController,"DataController"),DataModel:__name(()=>DataModel,"DataModel"),DataModelSeries:__name(()=>DataModelSeries,"DataModelSeries"),DataService:__name(()=>DataService,"DataService"),Default:__name(()=>Default,"Default"),Deprecated:__name(()=>Deprecated,"Deprecated"),DeprecatedAndRenamedTo:__name(()=>DeprecatedAndRenamedTo,"DeprecatedAndRenamedTo"),EMPTY_TOOLTIP_CONTENT:__name(()=>EMPTY_TOOLTIP_CONTENT,"EMPTY_TOOLTIP_CONTENT"),FONT_STYLE:__name(()=>FONT_STYLE,"FONT_STYLE"),FONT_WEIGHT:__name(()=>FONT_WEIGHT,"FONT_WEIGHT"),FUNCTION:__name(()=>FUNCTION,"FUNCTION"),GREATER_THAN:__name(()=>GREATER_THAN,"GREATER_THAN"),GestureDetector:__name(()=>GestureDetector,"GestureDetector"),GroupedCategoryAxis:__name(()=>GroupedCategoryAxis,"GroupedCategoryAxis"),HierarchyNode:__name(()=>HierarchyNode,"HierarchyNode"),HierarchySeries:__name(()=>HierarchySeries,"HierarchySeries"),HierarchySeriesProperties:__name(()=>HierarchySeriesProperties,"HierarchySeriesProperties"),HighlightManager:__name(()=>HighlightManager,"HighlightManager"),HighlightProperties:__name(()=>HighlightProperties,"HighlightProperties"),HighlightStyle:__name(()=>HighlightStyle,"HighlightStyle"),INTERACTION_RANGE:__name(()=>INTERACTION_RANGE,"INTERACTION_RANGE"),INTERPOLATION_STEP_POSITION:__name(()=>INTERPOLATION_STEP_POSITION,"INTERPOLATION_STEP_POSITION"),INTERPOLATION_TYPE:__name(()=>INTERPOLATION_TYPE,"INTERPOLATION_TYPE"),InteractionManager:__name(()=>InteractionManager,"InteractionManager"),InteractionState:__name(()=>InteractionState,"InteractionState"),InterpolationProperties:__name(()=>InterpolationProperties,"InterpolationProperties"),KeyNavManager:__name(()=>KeyNavManager,"KeyNavManager"),LABEL_PLACEMENT:__name(()=>LABEL_PLACEMENT,"LABEL_PLACEMENT"),LARGEST_KEY_INTERVAL:__name(()=>LARGEST_KEY_INTERVAL,"LARGEST_KEY_INTERVAL"),LESS_THAN:__name(()=>LESS_THAN,"LESS_THAN"),LINE_CAP:__name(()=>LINE_CAP,"LINE_CAP"),LINE_DASH:__name(()=>LINE_DASH,"LINE_DASH"),LINE_JOIN:__name(()=>LINE_JOIN,"LINE_JOIN"),LINE_STYLE:__name(()=>LINE_STYLE,"LINE_STYLE"),Layers:__name(()=>Layers,"Layers"),LayoutElement:__name(()=>LayoutElement,"LayoutElement"),LayoutManager:__name(()=>LayoutManager,"LayoutManager"),LonLatBBox:__name(()=>LonLatBBox,"LonLatBBox"),MARKER_SHAPE:__name(()=>MARKER_SHAPE,"MARKER_SHAPE"),MATCHING_CROSSLINE_TYPE:__name(()=>MATCHING_CROSSLINE_TYPE,"MATCHING_CROSSLINE_TYPE"),MAX_SPACING:__name(()=>MAX_SPACING,"MAX_SPACING"),MIN_SPACING:__name(()=>MIN_SPACING,"MIN_SPACING"),MercatorScale:__name(()=>MercatorScale,"MercatorScale"),ModuleRegistry:__name(()=>ModuleRegistry,"ModuleRegistry"),Motion:__name(()=>easing_exports,"Motion"),NAN:__name(()=>NAN,"NAN"),NODE_UPDATE_STATE_TO_PHASE_MAPPING:__name(()=>NODE_UPDATE_STATE_TO_PHASE_MAPPING,"NODE_UPDATE_STATE_TO_PHASE_MAPPING"),NUMBER:__name(()=>NUMBER,"NUMBER"),NUMBER_ARRAY:__name(()=>NUMBER_ARRAY,"NUMBER_ARRAY"),NUMBER_OR_NAN:__name(()=>NUMBER_OR_NAN,"NUMBER_OR_NAN"),Navigator:__name(()=>Navigator,"Navigator"),NavigatorModule:__name(()=>NavigatorModule,"NavigatorModule"),NodeRegionBBoxProvider:__name(()=>NodeRegionBBoxProvider,"NodeRegionBBoxProvider"),OBJECT:__name(()=>OBJECT,"OBJECT"),OBJECT_ARRAY:__name(()=>OBJECT_ARRAY,"OBJECT_ARRAY"),OR:__name(()=>OR,"OR"),OVERFLOW_STRATEGY:__name(()=>OVERFLOW_STRATEGY,"OVERFLOW_STRATEGY"),ObserveChanges:__name(()=>ObserveChanges,"ObserveChanges"),PHASE_METADATA:__name(()=>PHASE_METADATA,"PHASE_METADATA"),PHASE_ORDER:__name(()=>PHASE_ORDER,"PHASE_ORDER"),PLACEMENT:__name(()=>PLACEMENT,"PLACEMENT"),PLAIN_OBJECT:__name(()=>PLAIN_OBJECT,"PLAIN_OBJECT"),POINTER_INTERACTION_TYPES:__name(()=>POINTER_INTERACTION_TYPES,"POINTER_INTERACTION_TYPES"),POSITION:__name(()=>POSITION,"POSITION"),POSITION_TOP_COORDINATES:__name(()=>POSITION_TOP_COORDINATES,"POSITION_TOP_COORDINATES"),POSITIVE_NUMBER:__name(()=>POSITIVE_NUMBER,"POSITIVE_NUMBER"),PolarAxis:__name(()=>PolarAxis,"PolarAxis"),PolarSeries:__name(()=>PolarSeries,"PolarSeries"),PropertiesArray:__name(()=>PropertiesArray,"PropertiesArray"),ProxyOnWrite:__name(()=>ProxyOnWrite,"ProxyOnWrite"),ProxyProperty:__name(()=>ProxyProperty,"ProxyProperty"),ProxyPropertyOnWrite:__name(()=>ProxyPropertyOnWrite,"ProxyPropertyOnWrite"),QUICK_TRANSITION:__name(()=>QUICK_TRANSITION,"QUICK_TRANSITION"),RATIO:__name(()=>RATIO,"RATIO"),REAL_NUMBER:__name(()=>REAL_NUMBER,"REAL_NUMBER"),REGIONS:__name(()=>REGIONS,"REGIONS"),RegionManager:__name(()=>RegionManager,"RegionManager"),RepeatType:__name(()=>RepeatType,"RepeatType"),SKIP_JS_BUILTINS:__name(()=>SKIP_JS_BUILTINS,"SKIP_JS_BUILTINS"),SMALLEST_KEY_INTERVAL:__name(()=>SMALLEST_KEY_INTERVAL,"SMALLEST_KEY_INTERVAL"),SORT_DOMAIN_GROUPS:__name(()=>SORT_DOMAIN_GROUPS,"SORT_DOMAIN_GROUPS"),STRING:__name(()=>STRING,"STRING"),STRING_ARRAY:__name(()=>STRING_ARRAY,"STRING_ARRAY"),Series:__name(()=>Series,"Series"),SeriesGroupingChangedEvent:__name(()=>SeriesGroupingChangedEvent,"SeriesGroupingChangedEvent"),SeriesItemHighlightStyle:__name(()=>SeriesItemHighlightStyle,"SeriesItemHighlightStyle"),SeriesMarker:__name(()=>SeriesMarker,"SeriesMarker"),SeriesNodeEvent:__name(()=>SeriesNodeEvent,"SeriesNodeEvent"),SeriesNodePickMode:__name(()=>SeriesNodePickMode,"SeriesNodePickMode"),SeriesProperties:__name(()=>SeriesProperties,"SeriesProperties"),SeriesTooltip:__name(()=>SeriesTooltip,"SeriesTooltip"),SimpleRegionBBoxProvider:__name(()=>SimpleRegionBBoxProvider,"SimpleRegionBBoxProvider"),SimpleTextMeasurer:__name(()=>SimpleTextMeasurer,"SimpleTextMeasurer"),StateMachine:__name(()=>StateMachine,"StateMachine"),TEXT_ALIGN:__name(()=>TEXT_ALIGN,"TEXT_ALIGN"),TEXT_WRAP:__name(()=>TEXT_WRAP,"TEXT_WRAP"),TICK_INTERVAL:__name(()=>TICK_INTERVAL,"TICK_INTERVAL"),TOOLBAR_ALIGNMENTS:__name(()=>TOOLBAR_ALIGNMENTS,"TOOLBAR_ALIGNMENTS"),TOOLBAR_GROUPS:__name(()=>TOOLBAR_GROUPS,"TOOLBAR_GROUPS"),TOOLBAR_GROUP_ORDERING:__name(()=>TOOLBAR_GROUP_ORDERING,"TOOLBAR_GROUP_ORDERING"),TOOLBAR_POSITIONS:__name(()=>TOOLBAR_POSITIONS,"TOOLBAR_POSITIONS"),TextUtils:__name(()=>TextUtils,"TextUtils"),TextWrapper:__name(()=>TextWrapper,"TextWrapper"),ToolbarManager:__name(()=>ToolbarManager,"ToolbarManager"),ToolbarPosition:__name(()=>ToolbarPosition,"ToolbarPosition"),Tooltip:__name(()=>Tooltip,"Tooltip"),TooltipManager:__name(()=>TooltipManager,"TooltipManager"),TooltipPosition:__name(()=>TooltipPosition,"TooltipPosition"),UNION:__name(()=>UNION,"UNION"),UpdateService:__name(()=>UpdateService,"UpdateService"),VERTICAL_ALIGN:__name(()=>VERTICAL_ALIGN,"VERTICAL_ALIGN"),Validate:__name(()=>Validate,"Validate"),ZoomManager:__name(()=>ZoomManager,"ZoomManager"),__FORCE_MODULE_DETECTION:__name(()=>__FORCE_MODULE_DETECTION,"__FORCE_MODULE_DETECTION"),accumulateGroup:__name(()=>accumulateGroup,"accumulateGroup"),accumulateStack:__name(()=>accumulateStack,"accumulateStack"),accumulatedValue:__name(()=>accumulatedValue,"accumulatedValue"),accumulativeValueProperty:__name(()=>accumulativeValueProperty,"accumulativeValueProperty"),addHitTestersToQuadtree:__name(()=>addHitTestersToQuadtree,"addHitTestersToQuadtree"),adjustLabelPlacement:__name(()=>adjustLabelPlacement,"adjustLabelPlacement"),animationValidation:__name(()=>animationValidation,"animationValidation"),area:__name(()=>area,"area"),arraysEqual:__name(()=>arraysEqual,"arraysEqual"),backfillPathPointData:__name(()=>backfillPathPointData,"backfillPathPointData"),buildFormatter:__name(()=>buildFormatter,"buildFormatter"),buildResetPathFn:__name(()=>buildResetPathFn,"buildResetPathFn"),calculateDefaultTimeTickFormat:__name(()=>calculateDefaultTimeTickFormat,"calculateDefaultTimeTickFormat"),calculateLabelChartPadding:__name(()=>calculateLabelChartPadding,"calculateLabelChartPadding"),calculateLabelTranslation:__name(()=>calculateLabelTranslation,"calculateLabelTranslation"),calculatePlacement:__name(()=>calculatePlacement,"calculatePlacement"),checkCrisp:__name(()=>checkCrisp,"checkCrisp"),childrenIter:__name(()=>childrenIter,"childrenIter"),circularSliceArray:__name(()=>circularSliceArray,"circularSliceArray"),clamp:__name(()=>clamp,"clamp"),clampArray:__name(()=>clampArray,"clampArray"),collapsedStartingBarPosition:__name(()=>collapsedStartingBarPosition,"collapsedStartingBarPosition"),computeBarFocusBounds:__name(()=>computeBarFocusBounds,"computeBarFocusBounds"),computeMarkerFocusBounds:__name(()=>computeMarkerFocusBounds,"computeMarkerFocusBounds"),convertValuesToScaleByDefs:__name(()=>convertValuesToScaleByDefs,"convertValuesToScaleByDefs"),countFractionDigits:__name(()=>countFractionDigits,"countFractionDigits"),createButton:__name(()=>createButton,"createButton"),createCheckbox:__name(()=>createCheckbox,"createCheckbox"),createDatumId:__name(()=>createDatumId,"createDatumId"),createDeprecationWarning:__name(()=>createDeprecationWarning,"createDeprecationWarning"),createElement:__name(()=>createElement,"createElement"),createElementId:__name(()=>createElementId,"createElementId"),createElementNS:__name(()=>createElementNS,"createElementNS"),createIcon:__name(()=>createIcon,"createIcon"),createSelect:__name(()=>createSelect,"createSelect"),createTextArea:__name(()=>createTextArea,"createTextArea"),dateToNumber:__name(()=>dateToNumber,"dateToNumber"),deconstructSelectionsOrNodes:__name(()=>deconstructSelectionsOrNodes,"deconstructSelectionsOrNodes"),deepClone:__name(()=>deepClone,"deepClone"),deepMerge:__name(()=>deepMerge,"deepMerge"),defaultTimeTickFormat:__name(()=>defaultTimeTickFormat,"defaultTimeTickFormat"),determinePathStatus:__name(()=>determinePathStatus,"determinePathStatus"),diff:__name(()=>diff,"diff"),downloadUrl:__name(()=>downloadUrl,"downloadUrl"),enterpriseModule:__name(()=>enterpriseModule,"enterpriseModule"),extent:__name(()=>extent,"extent"),extractDecoratedProperties:__name(()=>extractDecoratedProperties,"extractDecoratedProperties"),findMaxValue:__name(()=>findMaxValue,"findMaxValue"),findMinMax:__name(()=>findMinMax,"findMinMax"),findQuadtreeMatch:__name(()=>findQuadtreeMatch,"findQuadtreeMatch"),findRangeExtent:__name(()=>findRangeExtent,"findRangeExtent"),fixNumericExtent:__name(()=>fixNumericExtent,"fixNumericExtent"),focusCursorAtEnd:__name(()=>focusCursorAtEnd,"focusCursorAtEnd"),formatNormalizedPercentage:__name(()=>formatNormalizedPercentage,"formatNormalizedPercentage"),formatPercentage:__name(()=>formatPercentage,"formatPercentage"),fromToMotion:__name(()=>fromToMotion,"fromToMotion"),getDocument:__name(()=>getDocument,"getDocument"),getMissCount:__name(()=>getMissCount,"getMissCount"),getPath:__name(()=>getPath,"getPath"),getPathComponents:__name(()=>getPathComponents,"getPathComponents"),getRectConfig:__name(()=>getRectConfig,"getRectConfig"),getWindow:__name(()=>getWindow,"getWindow"),groupAccumulativeValueProperty:__name(()=>groupAccumulativeValueProperty,"groupAccumulativeValueProperty"),groupAverage:__name(()=>groupAverage,"groupAverage"),groupBy:__name(()=>groupBy,"groupBy"),groupCount:__name(()=>groupCount,"groupCount"),groupStackValueProperty:__name(()=>groupStackValueProperty,"groupStackValueProperty"),groupSum:__name(()=>groupSum,"groupSum"),initMenuKeyNav:__name(()=>initMenuKeyNav,"initMenuKeyNav"),initRovingTabIndex:__name(()=>initRovingTabIndex,"initRovingTabIndex"),initToolbarKeyNav:__name(()=>initToolbarKeyNav,"initToolbarKeyNav"),isAnimatingFloatingPosition:__name(()=>isAnimatingFloatingPosition,"isAnimatingFloatingPosition"),isArray:__name(()=>isArray,"isArray"),isBoolean:__name(()=>isBoolean,"isBoolean"),isButtonClickEvent:__name(()=>isButtonClickEvent,"isButtonClickEvent"),isDate:__name(()=>isDate,"isDate"),isDecoratedObject:__name(()=>isDecoratedObject,"isDecoratedObject"),isDefined:__name(()=>isDefined,"isDefined"),isEnumKey:__name(()=>isEnumKey,"isEnumKey"),isEnumValue:__name(()=>isEnumValue,"isEnumValue"),isEqual:__name(()=>isEqual,"isEqual"),isFiniteNumber:__name(()=>isFiniteNumber,"isFiniteNumber"),isFunction:__name(()=>isFunction,"isFunction"),isHtmlElement:__name(()=>isHtmlElement,"isHtmlElement"),isNegative:__name(()=>isNegative,"isNegative"),isNumber:__name(()=>isNumber,"isNumber"),isObject:__name(()=>isObject,"isObject"),isObjectLike:__name(()=>isObjectLike,"isObjectLike"),isPlainObject:__name(()=>isPlainObject,"isPlainObject"),isProperties:__name(()=>isProperties,"isProperties"),isRegExp:__name(()=>isRegExp,"isRegExp"),isString:__name(()=>isString,"isString"),isSymbol:__name(()=>isSymbol,"isSymbol"),isValidDate:__name(()=>isValidDate,"isValidDate"),jsonApply:__name(()=>jsonApply,"jsonApply"),jsonDiff:__name(()=>jsonDiff,"jsonDiff"),jsonWalk:__name(()=>jsonWalk,"jsonWalk"),keyProperty:__name(()=>keyProperty,"keyProperty"),labelDirectionHandling:__name(()=>labelDirectionHandling,"labelDirectionHandling"),listDecoratedProperties:__name(()=>listDecoratedProperties,"listDecoratedProperties"),makeAccessibleClickListener:__name(()=>makeAccessibleClickListener,"makeAccessibleClickListener"),mapValues:__name(()=>mapValues,"mapValues"),markerFadeInAnimation:__name(()=>markerFadeInAnimation,"markerFadeInAnimation"),markerPaletteFactory:__name(()=>markerPaletteFactory,"markerPaletteFactory"),markerScaleInAnimation:__name(()=>markerScaleInAnimation,"markerScaleInAnimation"),markerSwipeScaleInAnimation:__name(()=>markerSwipeScaleInAnimation,"markerSwipeScaleInAnimation"),mergeArrayDefaults:__name(()=>mergeArrayDefaults,"mergeArrayDefaults"),mergeDefaults:__name(()=>mergeDefaults,"mergeDefaults"),midpointStartingBarPosition:__name(()=>midpointStartingBarPosition,"midpointStartingBarPosition"),minMax:__name(()=>minMax,"minMax"),mod:__name(()=>mod,"mod"),moduleRegistry:__name(()=>moduleRegistry,"moduleRegistry"),nearestSquared:__name(()=>nearestSquared,"nearestSquared"),nearestSquaredInContainer:__name(()=>nearestSquaredInContainer,"nearestSquaredInContainer"),normaliseGroupTo:__name(()=>normaliseGroupTo,"normaliseGroupTo"),normalisePropertyTo:__name(()=>normalisePropertyTo,"normalisePropertyTo"),normalisedExtentWithMetadata:__name(()=>normalisedExtentWithMetadata,"normalisedExtentWithMetadata"),objectEqualWith:__name(()=>objectEqualWith,"objectEqualWith"),pairCategoryData:__name(()=>pairCategoryData,"pairCategoryData"),pairContinuousData:__name(()=>pairContinuousData,"pairContinuousData"),partialAssign:__name(()=>partialAssign,"partialAssign"),pathFadeInAnimation:__name(()=>pathFadeInAnimation,"pathFadeInAnimation"),pathFadeOutAnimation:__name(()=>pathFadeOutAnimation,"pathFadeOutAnimation"),pathRangePoints:__name(()=>pathRangePoints,"pathRangePoints"),pathRangePointsReverse:__name(()=>pathRangePointsReverse,"pathRangePointsReverse"),pathRanges:__name(()=>pathRanges,"pathRanges"),pathSwipeInAnimation:__name(()=>pathSwipeInAnimation,"pathSwipeInAnimation"),pickByMatchingAngle:__name(()=>pickByMatchingAngle,"pickByMatchingAngle"),pickNode:__name(()=>pickNode,"pickNode"),plotPath:__name(()=>plotPath,"plotPath"),predicateWithMessage:__name(()=>predicateWithMessage,"predicateWithMessage"),prepareAreaPathAnimation:__name(()=>prepareAreaPathAnimation,"prepareAreaPathAnimation"),prepareAxisAnimationContext:__name(()=>prepareAxisAnimationContext,"prepareAxisAnimationContext"),prepareAxisAnimationFunctions:__name(()=>prepareAxisAnimationFunctions,"prepareAxisAnimationFunctions"),prepareBarAnimationFunctions:__name(()=>prepareBarAnimationFunctions,"prepareBarAnimationFunctions"),prepareLinePathAnimation:__name(()=>prepareLinePathAnimation,"prepareLinePathAnimation"),prepareLinePathAnimationFns:__name(()=>prepareLinePathAnimationFns,"prepareLinePathAnimationFns"),prepareLinePathPropertyAnimation:__name(()=>prepareLinePathPropertyAnimation,"prepareLinePathPropertyAnimation"),prepareMarkerAnimation:__name(()=>prepareMarkerAnimation,"prepareMarkerAnimation"),preparePieSeriesAnimationFunctions:__name(()=>preparePieSeriesAnimationFunctions,"preparePieSeriesAnimationFunctions"),range:__name(()=>range2,"range"),rangedValueProperty:__name(()=>rangedValueProperty,"rangedValueProperty"),renderPartialPath:__name(()=>renderPartialPath,"renderPartialPath"),resetAxisGroupFn:__name(()=>resetAxisGroupFn,"resetAxisGroupFn"),resetAxisLabelSelectionFn:__name(()=>resetAxisLabelSelectionFn,"resetAxisLabelSelectionFn"),resetAxisLineSelectionFn:__name(()=>resetAxisLineSelectionFn,"resetAxisLineSelectionFn"),resetAxisSelectionFn:__name(()=>resetAxisSelectionFn,"resetAxisSelectionFn"),resetBarSelectionsFn:__name(()=>resetBarSelectionsFn,"resetBarSelectionsFn"),resetIds:__name(()=>resetIds,"resetIds"),resetLabelFn:__name(()=>resetLabelFn,"resetLabelFn"),resetMarkerFn:__name(()=>resetMarkerFn,"resetMarkerFn"),resetMarkerPositionFn:__name(()=>resetMarkerPositionFn,"resetMarkerPositionFn"),resetMotion:__name(()=>resetMotion,"resetMotion"),resetPieSelectionsFn:__name(()=>resetPieSelectionsFn,"resetPieSelectionsFn"),round:__name(()=>round,"round"),scale:__name(()=>scale,"scale"),seriesLabelFadeInAnimation:__name(()=>seriesLabelFadeInAnimation,"seriesLabelFadeInAnimation"),seriesLabelFadeOutAnimation:__name(()=>seriesLabelFadeOutAnimation,"seriesLabelFadeOutAnimation"),setDocument:__name(()=>setDocument,"setDocument"),setElementBBox:__name(()=>setElementBBox,"setElementBBox"),setPath:__name(()=>setPath,"setPath"),setWindow:__name(()=>setWindow,"setWindow"),shallowClone:__name(()=>shallowClone,"shallowClone"),singleSeriesPaletteFactory:__name(()=>singleSeriesPaletteFactory,"singleSeriesPaletteFactory"),splitPairData:__name(()=>splitPairData,"splitPairData"),staticFromToMotion:__name(()=>staticFromToMotion,"staticFromToMotion"),stringify:__name(()=>stringify,"stringify"),sum:__name(()=>sum,"sum"),sumValues:__name(()=>sumValues,"sumValues"),toArray:__name(()=>toArray,"toArray"),toFixed:__name(()=>toFixed,"toFixed"),toTooltipHtml:__name(()=>toTooltipHtml,"toTooltipHtml"),trailingAccumulatedValue:__name(()=>trailingAccumulatedValue,"trailingAccumulatedValue"),trailingAccumulatedValueProperty:__name(()=>trailingAccumulatedValueProperty,"trailingAccumulatedValueProperty"),unique:__name(()=>unique,"unique"),updateClipPath:__name(()=>updateClipPath,"updateClipPath"),updateLabelNode:__name(()=>updateLabelNode,"updateLabelNode"),updateRect:__name(()=>updateRect,"updateRect"),validateCrossLineValues:__name(()=>validateCrossLineValues,"validateCrossLineValues"),valueProperty:__name(()=>valueProperty,"valueProperty"),without:__name(()=>without,"without")});function createDeprecationWarning(){return(key,message)=>{const msg=[`Property [${key}] is deprecated.`,message].filter(Boolean).join(" ");Logger.warnOnce(msg)}}__name(createDeprecationWarning,"createDeprecationWarning");function Deprecated(message,opts){const warnDeprecated=createDeprecationWarning(),def=opts==null?void 0:opts.default;return addTransformToInstanceProperty((_,key,value)=>(value!==def&&warnDeprecated(key.toString(),message),value))}__name(Deprecated,"Deprecated");function DeprecatedAndRenamedTo(newPropName,mapValue){const warnDeprecated=createDeprecationWarning();return addTransformToInstanceProperty((target,key,value)=>(value!==target[newPropName]&&(warnDeprecated(key.toString(),`Use [${newPropName}] instead.`),setPath(target,newPropName,mapValue?mapValue(value):value)),BREAK_TRANSFORM_CHAIN),(target,key)=>(warnDeprecated(key.toString(),`Use [${newPropName}] instead.`),getPath(target,newPropName)))}__name(DeprecatedAndRenamedTo,"DeprecatedAndRenamedTo");function findMaxValue(min,max,iteratee){if(min>max)return;let found;for(;max>=min;){const index=Math.floor((max+min)/2),value=iteratee(index);value==null?max=index-1:(found=value,min=index+1)}return found}__name(findMaxValue,"findMaxValue");var _a269,_HierarchyNode=(_a269=class{constructor(series,index,datum,size,colorValue,fill,stroke,sumSize,depth,parent,children){this.series=series,this.index=index,this.datum=datum,this.size=size,this.colorValue=colorValue,this.fill=fill,this.stroke=stroke,this.sumSize=sumSize,this.depth=depth,this.parent=parent,this.children=children,this.midPoint={x:0,y:0}}contains(other){let current=other;for(;current!=null&&current.index>=this.index;){if(current===this)return!0;current=current.parent}return!1}walk(callback2,order=_a269.Walk.PreOrder){order===_a269.Walk.PreOrder&&callback2(this),this.children.forEach(child=>{child.walk(callback2,order)}),order===_a269.Walk.PostOrder&&callback2(this)}*[Symbol.iterator](){yield this;for(const child of this.children)yield*child}},__name(_a269,"_HierarchyNode"),_a269);_HierarchyNode.Walk={PreOrder:0,PostOrder:1};var HierarchyNode=_HierarchyNode,_a270,HierarchySeries=(_a270=class extends Series{constructor(moduleCtx){super({moduleCtx,pickModes:[3,0],contentGroupVirtual:!1}),this.rootNode=new HierarchyNode(this,0,void 0,0,void 0,void 0,void 0,0,void 0,void 0,[]),this.colorDomain=[0,0],this.maxDepth=0,this.focusPath=[],this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(data=>this.animateEmptyUpdateReady(data),"action")},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:__name(data=>this.animateReadyHighlight(data),"highlight"),resize:__name(data=>this.animateReadyResize(data),"resize"),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:__name(data=>this.animateWaitingUpdateReady(data),"action")},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:__name(data=>this.animateClearingUpdateEmpty(data),"action")},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}async processData(){var _a274;const{childrenKey,sizeKey,colorKey,fills,strokes,colorRange}=this.properties;let index=0;const getIndex=__name(()=>(index+=1,index),"getIndex");let maxDepth=0,minColor=1/0,maxColor=-1/0;const colors=new Array((((_a274=this.data)==null?void 0:_a274.length)??0)+1).fill(void 0),createNode=__name((datum,parent)=>{const nodeIndex=getIndex(),depth=parent.depth!=null?parent.depth+1:0,children=childrenKey!=null?datum[childrenKey]:void 0,isLeaf=children==null||children.length===0;let size=sizeKey!=null?datum[sizeKey]:void 0;Number.isFinite(size)?size=Math.max(size,0):size=isLeaf?1:0;const sumSize=size;maxDepth=Math.max(maxDepth,depth);const color=colorKey!=null?datum[colorKey]:void 0;return typeof color=="number"&&(colors[nodeIndex]=color,minColor=Math.min(minColor,color),maxColor=Math.max(maxColor,color)),appendChildren(new HierarchyNode(this,nodeIndex,datum,size,color,void 0,void 0,sumSize,depth,parent,[]),children)},"createNode"),appendChildren=__name((node,data)=>(data==null||data.forEach(datum=>{const child=createNode(datum,node);node.children.push(child),node.sumSize+=child.sumSize}),node),"appendChildren"),rootNode=appendChildren(new HierarchyNode(this,0,void 0,0,void 0,void 0,void 0,0,void 0,void 0,[]),this.data),colorDomain=[minColor,maxColor];let colorScale;colorRange!=null&&Number.isFinite(minColor)&&Number.isFinite(maxColor)&&(colorScale=new ColorScale,colorScale.domain=colorDomain,colorScale.range=colorRange,colorScale.update()),rootNode.children.forEach((child,childIndex)=>{child.walk(node=>{let fill;const color=colors[node.index];color!=null&&(fill=colorScale==null?void 0:colorScale.convert(color)),fill??(fill=fills==null?void 0:fills[childIndex%fills.length]),node.fill=fill,node.stroke=colorScale==null?strokes==null?void 0:strokes[childIndex%strokes.length]:"rgba(0, 0, 0, 0.2)"})}),this.rootNode=rootNode,this.maxDepth=maxDepth,this.colorDomain=colorDomain,this.focusPath=[{nodeDatum:this.rootNode,childIndex:0}]}async update({seriesRect}){await this.updateSelections(),await this.updateNodes();const animationData=this.getAnimationData();this.checkResize(seriesRect)&&this.animationState.transition("resize",animationData),this.animationState.transition("update",animationData)}resetAllAnimation(data){var _a274;const datum=(_a274=this.animationResetFns)==null?void 0:_a274.datum;this.ctx.animationManager.stopByAnimationGroupId(this.id),datum!=null&&resetMotion(data.datumSelections,datum)}animateEmptyUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateWaitingUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateReadyHighlight(data){var _a274;const datum=(_a274=this.animationResetFns)==null?void 0:_a274.datum;datum!=null&&resetMotion([data],datum)}animateReadyResize(data){this.resetAllAnimation(data)}animateClearingUpdateEmpty(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animationTransitionClear(){this.animationState.transition("clear",this.getAnimationData())}getAnimationData(){return{datumSelections:[this.groupSelection]}}isProcessedDataAnimatable(){return!0}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(legendType){const{colorKey,colorName,colorRange,visible}=this.properties;return legendType==="gradient"&&colorKey!=null&&colorRange!=null?[{legendType:"gradient",enabled:visible,seriesId:this.id,colorName,colorRange,colorDomain:this.colorDomain}]:[]}getDatumIdFromData(node){return`${node.index}`}getDatumId(node){return this.getDatumIdFromData(node)}pickFocus(opts){var _a274;if(this.rootNode.children.length===0)return;this.focusPath.length===0&&Logger.error("this.focusPath should not be empty");const{datumIndexDelta:childDelta,otherIndexDelta:depthDelta}=opts,{focusPath:path}=this,depth=path.length-2;if(depthDelta!==0||path.length===1){const targetDepth=Math.max(0,depth+depthDelta);if(path[targetDepth+1]!==void 0)return path.length=targetDepth+2,this.computeFocusOutputs(path[targetDepth+1]);{let deepest=path[path.length-1];for(;deepest.nodeDatum.children.length>0&&(deepest.nodeDatum.depth??-1)<targetDepth;){const nextDeepest={nodeDatum:deepest.nodeDatum.children[0],childIndex:0};path.push(nextDeepest),deepest=nextDeepest}return this.computeFocusOutputs(deepest)}}else if(childDelta!==0){const targetChild=path[depth+1].childIndex+childDelta,currentParent=path[depth].nodeDatum,childCount=(_a274=currentParent==null?void 0:currentParent.children)==null?void 0:_a274.length;if(childCount!==void 0){const newChild=clamp(0,targetChild,childCount-1),newFocus={nodeDatum:currentParent.children[newChild],childIndex:newChild};return path[depth+1]=newFocus,path.length=depth+2,this.computeFocusOutputs(newFocus)}}else return this.computeFocusOutputs(path[path.length-1])}getDatumAriaText(datum,description){if(!(datum instanceof HierarchyNode)){Logger.error(`datum is not HierarchyNode: ${datum}`);return}return this.ctx.localeManager.t("ariaAnnounceHierarchyDatum",{level:(datum.depth??-1)+1,count:datum.children.length,description})}computeFocusOutputs({nodeDatum,childIndex}){const bounds=this.computeFocusBounds(nodeDatum);if(bounds)return{datum:nodeDatum,datumIndex:childIndex,otherIndex:nodeDatum.depth,bounds,showFocusBox:!0}}},__name(_a270,"HierarchySeries"),_a270),_a271,HierarchySeriesProperties=(_a271=class extends SeriesProperties{constructor(){super(...arguments),this.childrenKey="children",this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES)}},__name(_a271,"HierarchySeriesProperties"),_a271);__decorateClass([Validate(STRING)],HierarchySeriesProperties.prototype,"childrenKey",2);__decorateClass([Validate(STRING,{optional:!0})],HierarchySeriesProperties.prototype,"sizeKey",2);__decorateClass([Validate(STRING,{optional:!0})],HierarchySeriesProperties.prototype,"colorKey",2);__decorateClass([Validate(STRING,{optional:!0})],HierarchySeriesProperties.prototype,"colorName",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],HierarchySeriesProperties.prototype,"fills",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],HierarchySeriesProperties.prototype,"strokes",2);__decorateClass([Validate(COLOR_STRING_ARRAY,{optional:!0})],HierarchySeriesProperties.prototype,"colorRange",2);var _a272,LonLatBBox=(_a272=class{constructor(lon0,lat0,lon1,lat1){this.lon0=lon0,this.lat0=lat0,this.lon1=lon1,this.lat1=lat1}merge(other){this.lon0=Math.min(this.lon0,other.lon0),this.lat0=Math.min(this.lat0,other.lat0),this.lon1=Math.max(this.lon1,other.lon1),this.lat1=Math.max(this.lat1,other.lat1)}},__name(_a272,"LonLatBBox"),_a272);function createIdsGenerator(){const idsCounter=new Map;return name=>{const counter=idsCounter.get(name);return counter?(idsCounter.set(name,counter+1),`${name}${counter}`):(idsCounter.set(name,1),name)}}__name(createIdsGenerator,"createIdsGenerator");var _a273,_AxisTicks=(_a273=class{constructor(){this.id=createId(this),this.axisGroup=new TranslatableGroup({name:`${this.id}-AxisTicks`,zIndex:2}),this.labelSelection=Selection.select(this.axisGroup,Text,!1),this.interval=new AxisInterval,this.label=new AxisLabel,this.scale=new LinearScale,this.position="bottom",this.translationX=0,this.translationY=0,this.padding=0}attachAxis(axisNode){axisNode.appendChild(this.axisGroup)}calculateLayout(){this.scale.interval=this.interval.step;const boxes=[],tickData=this.generateTicks(),{translationX,translationY}=this;return this.labelSelection.update(tickData.ticks.map(d=>this.createLabelDatum(d)),group=>group.appendChild(new Text),datum=>datum.tickId),this.labelSelection.each((node,datum)=>{node.setProperties(datum),datum.visible&&boxes.push(node.getBBox())}),this.axisGroup.setProperties({translationX,translationY}),BBox.merge(boxes)}getLabelParams(datum){const{padding}=this,{translate}=datum;switch(this.position){case"top":case"bottom":return{x:translate,y:padding,textAlign:"center",textBaseline:"top"};case"left":case"right":return{x:padding,y:translate,textAlign:"start",textBaseline:"middle"}}}inRange(x,tolerance=.001){const[min,max]=findMinMax(this.scale.range);return x>=min-tolerance&&x<=max+tolerance}createLabelDatum(datum){const{x,y,textBaseline,textAlign}=this.getLabelParams(datum);return{visible:!!datum.tickLabel,tickId:datum.tickId,fill:this.label.color,fontFamily:this.label.fontFamily,fontSize:this.label.fontSize,fontStyle:this.label.fontStyle,fontWeight:this.label.fontWeight,rotation:0,rotationCenterX:0,text:datum.tickLabel,textAlign,textBaseline,x,y}}generateTicks(){const{minSpacing,maxSpacing}=this.interval,extentWithBleed=round(findRangeExtent(this.scale.range),2),{maxTickCount,minTickCount,tickCount}=estimateTickCount(extentWithBleed,minSpacing,maxSpacing,_a273.DefaultTickCount,_a273.DefaultMinSpacing);tickCount&&(this.scale.tickCount=tickCount,this.scale.minTickCount=minTickCount,this.scale.maxTickCount=maxTickCount);const tickData=this.getTicksData();if(this.position==="bottom"||this.position==="top"){const measurer=CachedTextMeasurerPool.getMeasurer({font:this.label}),domain=this.scale.getDomain(),direction=domain[0]>domain[1]?-1:1;let lastTickPosition=-1/0*direction;tickData.ticks=tickData.ticks.filter(data=>Math.sign(data.translate-lastTickPosition)!==direction?!1:(lastTickPosition=data.translate+measurer.textWidth(data.tickLabel,!0)*direction,!0))}return tickData}getTicksData(){var _a274,_b;const ticks=[],rawTicks=this.scale.ticks(),fractionDigits=rawTicks.reduce((max,tick)=>Math.max(max,typeof tick=="number"?countFractionDigits(tick):0),0),idGenerator=createIdsGenerator(),labelFormatter=this.label.format?this.scale.tickFormat({ticks:rawTicks,specifier:this.label.format}):x=>isNumber(x)?x.toFixed(fractionDigits):String(x);for(let index=0;index<rawTicks.length;index++){const tick=rawTicks[index],translate=this.scale.convert(tick);if(!this.inRange(translate))continue;const tickLabel=((_b=(_a274=this.label).formatter)==null?void 0:_b.call(_a274,{value:tick,index,fractionDigits}))??labelFormatter(tick),tickId=idGenerator(tickLabel);ticks.push({tick,tickId,tickLabel,translate})}return{rawTicks,fractionDigits,ticks}}},__name(_a273,"_AxisTicks"),_a273);_AxisTicks.DefaultTickCount=5;_AxisTicks.DefaultMinSpacing=50;var AxisTicks=_AxisTicks,__FORCE_MODULE_DETECTION=0;function createButton(options,attrs){const button=createElement("button",getClassName("ag-charts-input ag-charts-button",attrs));return options.label!==void 0?button.append(options.label):(button.append(createIcon(options.icon)),button.ariaLabel=options.altText),button.addEventListener("click",options.onPress),setAttributes(button,attrs),button}__name(createButton,"createButton");function createCheckbox(options,attrs){const checkbox=createElement("input",getClassName("ag-charts-input ag-charts-checkbox",attrs));return checkbox.type="checkbox",checkbox.checked=options.checked,checkbox.addEventListener("change",event=>options.onChange(checkbox.checked,event)),checkbox.addEventListener("keydown",event=>{isButtonClickEvent(event)&&(event.preventDefault(),checkbox.click())}),setAttributes(checkbox,attrs),checkbox}__name(createCheckbox,"createCheckbox");function createSelect(options,attrs){const select=createElement("select",getClassName("ag-charts-input ag-charts-select",attrs));return select.append(...options.options.map(option=>{const optionEl=createElement("option");return optionEl.value=option.value,optionEl.textContent=option.label,optionEl})),select.value=options.value,select.addEventListener("change",event=>options.onChange(select.value,event)),setAttributes(select,attrs),select}__name(createSelect,"createSelect");function createTextArea(options,attrs){const textArea=createElement("textarea",getClassName("ag-charts-input ag-charts-textarea",attrs));return textArea.value=options.value,textArea.addEventListener("input",event=>options.onChange(textArea.value,event)),setAttributes(textArea,attrs),textArea}__name(createTextArea,"createTextArea");function createIcon(icon){const el=createElement("span",`ag-charts-icon ag-charts-icon-${icon}`);return setAttribute(el,"aria-hidden",!0),el}__name(createIcon,"createIcon");function getClassName(baseClass,attrs){return attrs==null?baseClass:`${baseClass} ${attrs.class}`}__name(getClassName,"getClassName");export{AgCharts as A,time_exports as t};
//# sourceMappingURL=ag-charts-community-CLwv1jNv.js.map
