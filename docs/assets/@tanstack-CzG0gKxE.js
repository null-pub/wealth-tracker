var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{j as jsxRuntimeExports,r as reactExports}from"./react-BOr9OwWu.js";import{i as invariant}from"./tiny-invariant-DcbpN2Uk.js";import{r as reactDomExports}from"./react-dom-sAGGPUyF.js";import{w as warning}from"./tiny-warning-o95Rl_Zn.js";import"./jsesc-COZeGqng.js";import{a as withSelectorExports}from"./use-sync-external-store-C1Zvhj8o.js";const __storeToDerived=new WeakMap,__derivedToStore=new WeakMap,__depsThatHaveWrittenThisTick={current:[]};let __isFlushing=!1,__batchDepth=0;const __pendingUpdates=new Set,__initialBatchValues=new Map;function __flush_internals(relatedVals){const sorted=Array.from(relatedVals).sort((a,b)=>a instanceof Derived&&a.options.deps.includes(b)?1:b instanceof Derived&&b.options.deps.includes(a)?-1:0);for(const derived of sorted){if(__depsThatHaveWrittenThisTick.current.includes(derived))continue;__depsThatHaveWrittenThisTick.current.push(derived),derived.recompute();const stores=__derivedToStore.get(derived);if(stores)for(const store of stores){const relatedLinkedDerivedVals=__storeToDerived.get(store);relatedLinkedDerivedVals&&__flush_internals(relatedLinkedDerivedVals)}}}__name(__flush_internals,"__flush_internals");function __notifyListeners(store){store.listeners.forEach(listener=>listener({prevVal:store.prevState,currentVal:store.state}))}__name(__notifyListeners,"__notifyListeners");function __notifyDerivedListeners(derived){derived.listeners.forEach(listener=>listener({prevVal:derived.prevState,currentVal:derived.state}))}__name(__notifyDerivedListeners,"__notifyDerivedListeners");function __flush(store){if(__batchDepth>0&&!__initialBatchValues.has(store)&&__initialBatchValues.set(store,store.prevState),__pendingUpdates.add(store),!(__batchDepth>0)&&!__isFlushing)try{for(__isFlushing=!0;__pendingUpdates.size>0;){const stores=Array.from(__pendingUpdates);__pendingUpdates.clear();for(const store2 of stores){const prevState=__initialBatchValues.get(store2)??store2.prevState;store2.prevState=prevState,__notifyListeners(store2)}for(const store2 of stores){const derivedVals=__storeToDerived.get(store2);derivedVals&&(__depsThatHaveWrittenThisTick.current.push(store2),__flush_internals(derivedVals))}for(const store2 of stores){const derivedVals=__storeToDerived.get(store2);if(derivedVals)for(const derived of derivedVals)__notifyDerivedListeners(derived)}}}finally{__isFlushing=!1,__depsThatHaveWrittenThisTick.current=[],__initialBatchValues.clear()}}__name(__flush,"__flush");function batch(fn){__batchDepth++;try{fn()}finally{if(__batchDepth--,__batchDepth===0){const pendingUpdateToFlush=Array.from(__pendingUpdates)[0];pendingUpdateToFlush&&__flush(pendingUpdateToFlush)}}}__name(batch,"batch");const _Store=class _Store{constructor(initialState,options){this.listeners=new Set,this.subscribe=listener=>{var _a,_b;this.listeners.add(listener);const unsub=(_b=(_a=this.options)==null?void 0:_a.onSubscribe)==null?void 0:_b.call(_a,listener,this);return()=>{this.listeners.delete(listener),unsub==null||unsub()}},this.setState=updater=>{var _a,_b,_c;this.prevState=this.state,this.state=(_a=this.options)!=null&&_a.updateFn?this.options.updateFn(this.prevState)(updater):updater(this.prevState),(_c=(_b=this.options)==null?void 0:_b.onUpdate)==null||_c.call(_b),__flush(this)},this.prevState=initialState,this.state=initialState,this.options=options}};__name(_Store,"Store");let Store=_Store;const _Derived=class _Derived{constructor(options){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const prevDepVals=[],currDepVals=[];for(const dep of this.options.deps)prevDepVals.push(dep.prevState),currDepVals.push(dep.state);return this.lastSeenDepValues=currDepVals,{prevDepVals,currDepVals,prevVal:this.prevState??void 0}},this.recompute=()=>{var _a,_b;this.prevState=this.state;const{prevDepVals,currDepVals,prevVal}=this.getDepVals();this.state=this.options.fn({prevDepVals,currDepVals,prevVal}),(_b=(_a=this.options).onUpdate)==null||_b.call(_a)},this.checkIfRecalculationNeededDeeply=()=>{for(const dep of this.options.deps)dep instanceof _Derived&&dep.checkIfRecalculationNeededDeeply();let shouldRecompute=!1;const lastSeenDepValues=this.lastSeenDepValues,{currDepVals}=this.getDepVals();for(let i=0;i<currDepVals.length;i++)if(currDepVals[i]!==lastSeenDepValues[i]){shouldRecompute=!0;break}shouldRecompute&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const cleanup of this._subscriptions)cleanup()}),this.subscribe=listener=>{var _a,_b;this.listeners.add(listener);const unsub=(_b=(_a=this.options).onSubscribe)==null?void 0:_b.call(_a,listener,this);return()=>{this.listeners.delete(listener),unsub==null||unsub()}},this.options=options,this.state=options.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(deps=this.options.deps){for(const dep of deps)if(dep instanceof _Derived)dep.registerOnGraph(),this.registerOnGraph(dep.options.deps);else if(dep instanceof Store){let relatedLinkedDerivedVals=__storeToDerived.get(dep);relatedLinkedDerivedVals||(relatedLinkedDerivedVals=new Set,__storeToDerived.set(dep,relatedLinkedDerivedVals)),relatedLinkedDerivedVals.add(this);let relatedStores=__derivedToStore.get(this);relatedStores||(relatedStores=new Set,__derivedToStore.set(this,relatedStores)),relatedStores.add(dep)}}unregisterFromGraph(deps=this.options.deps){for(const dep of deps)if(dep instanceof _Derived)this.unregisterFromGraph(dep.options.deps);else if(dep instanceof Store){const relatedLinkedDerivedVals=__storeToDerived.get(dep);relatedLinkedDerivedVals&&relatedLinkedDerivedVals.delete(this);const relatedStores=__derivedToStore.get(this);relatedStores&&relatedStores.delete(dep)}}};__name(_Derived,"Derived");let Derived=_Derived;const stateIndexKey="__TSR_index",popStateEvent="popstate",beforeUnloadEvent="beforeunload";function createHistory(opts){let location=opts.getLocation();const subscribers=new Set,notify=__name(action=>{location=opts.getLocation(),subscribers.forEach(subscriber=>subscriber({location,action}))},"notify"),handleIndexChange=__name(action=>{opts.notifyOnIndexChange??!0?notify(action):location=opts.getLocation()},"handleIndexChange"),tryNavigation=__name(async({task,navigateOpts,...actionInfo})=>{var _a,_b;if((navigateOpts==null?void 0:navigateOpts.ignoreBlocker)??!1){task();return}const blockers=((_a=opts.getBlockers)==null?void 0:_a.call(opts))??[],isPushOrReplace=actionInfo.type==="PUSH"||actionInfo.type==="REPLACE";if(typeof document<"u"&&blockers.length&&isPushOrReplace)for(const blocker of blockers){const nextLocation=parseHref(actionInfo.path,actionInfo.state);if(await blocker.blockerFn({currentLocation:location,nextLocation,action:actionInfo.type})){(_b=opts.onBlocked)==null||_b.call(opts);return}}task()},"tryNavigation");return{get location(){return location},get length(){return opts.getLength()},subscribers,subscribe:__name(cb=>(subscribers.add(cb),()=>{subscribers.delete(cb)}),"subscribe"),push:__name((path,state,navigateOpts)=>{const currentIndex=location.state[stateIndexKey];state=assignKeyAndIndex(currentIndex+1,state),tryNavigation({task:__name(()=>{opts.pushState(path,state),notify({type:"PUSH"})},"task"),navigateOpts,type:"PUSH",path,state})},"push"),replace:__name((path,state,navigateOpts)=>{const currentIndex=location.state[stateIndexKey];state=assignKeyAndIndex(currentIndex,state),tryNavigation({task:__name(()=>{opts.replaceState(path,state),notify({type:"REPLACE"})},"task"),navigateOpts,type:"REPLACE",path,state})},"replace"),go:__name((index,navigateOpts)=>{tryNavigation({task:__name(()=>{opts.go(index),handleIndexChange({type:"GO",index})},"task"),navigateOpts,type:"GO"})},"go"),back:__name(navigateOpts=>{tryNavigation({task:__name(()=>{opts.back((navigateOpts==null?void 0:navigateOpts.ignoreBlocker)??!1),handleIndexChange({type:"BACK"})},"task"),navigateOpts,type:"BACK"})},"back"),forward:__name(navigateOpts=>{tryNavigation({task:__name(()=>{opts.forward((navigateOpts==null?void 0:navigateOpts.ignoreBlocker)??!1),handleIndexChange({type:"FORWARD"})},"task"),navigateOpts,type:"FORWARD"})},"forward"),canGoBack:__name(()=>location.state[stateIndexKey]!==0,"canGoBack"),createHref:__name(str=>opts.createHref(str),"createHref"),block:__name(blocker=>{var _a;if(!opts.setBlockers)return()=>{};const blockers=((_a=opts.getBlockers)==null?void 0:_a.call(opts))??[];return opts.setBlockers([...blockers,blocker]),()=>{var _a2,_b;const blockers2=((_a2=opts.getBlockers)==null?void 0:_a2.call(opts))??[];(_b=opts.setBlockers)==null||_b.call(opts,blockers2.filter(b=>b!==blocker))}},"block"),flush:__name(()=>{var _a;return(_a=opts.flush)==null?void 0:_a.call(opts)},"flush"),destroy:__name(()=>{var _a;return(_a=opts.destroy)==null?void 0:_a.call(opts)},"destroy"),notify}}__name(createHistory,"createHistory");function assignKeyAndIndex(index,state){return state||(state={}),{...state,key:createRandomKey(),[stateIndexKey]:index}}__name(assignKeyAndIndex,"assignKeyAndIndex");function createBrowserHistory(opts){var _a;const win=typeof document<"u"?window:void 0,originalPushState=win.history.pushState,originalReplaceState=win.history.replaceState;let blockers=[];const _getBlockers=__name(()=>blockers,"_getBlockers"),_setBlockers=__name(newBlockers=>blockers=newBlockers,"_setBlockers"),createHref=__name(path=>path,"createHref"),parseLocation=__name(()=>parseHref(`${win.location.pathname}${win.location.search}${win.location.hash}`,win.history.state),"parseLocation");(_a=win.history.state)!=null&&_a.key||win.history.replaceState({[stateIndexKey]:0,key:createRandomKey()},"");let currentLocation=parseLocation(),rollbackLocation,nextPopIsGo=!1,ignoreNextPop=!1,skipBlockerNextPop=!1,ignoreNextBeforeUnload=!1;const getLocation=__name(()=>currentLocation,"getLocation");let next,scheduled;const flush=__name(()=>{next&&(history._ignoreSubscribers=!0,(next.isPush?win.history.pushState:win.history.replaceState)(next.state,"",next.href),history._ignoreSubscribers=!1,next=void 0,scheduled=void 0,rollbackLocation=void 0)},"flush"),queueHistoryAction=__name((type,destHref,state)=>{const href=createHref(destHref);scheduled||(rollbackLocation=currentLocation),currentLocation=parseHref(destHref,state),next={href,state,isPush:(next==null?void 0:next.isPush)||type==="push"},scheduled||(scheduled=Promise.resolve().then(()=>flush()))},"queueHistoryAction"),onPushPop=__name(type=>{currentLocation=parseLocation(),history.notify({type})},"onPushPop"),onPushPopEvent=__name(async()=>{if(ignoreNextPop){ignoreNextPop=!1;return}const nextLocation=parseLocation(),delta=nextLocation.state[stateIndexKey]-currentLocation.state[stateIndexKey],isForward=delta===1,isBack=delta===-1,isGo=!isForward&&!isBack||nextPopIsGo;nextPopIsGo=!1;const action=isGo?"GO":isBack?"BACK":"FORWARD",notify=isGo?{type:"GO",index:delta}:{type:isBack?"BACK":"FORWARD"};if(skipBlockerNextPop)skipBlockerNextPop=!1;else{const blockers2=_getBlockers();if(typeof document<"u"&&blockers2.length){for(const blocker of blockers2)if(await blocker.blockerFn({currentLocation,nextLocation,action})){ignoreNextPop=!0,win.history.go(1),history.notify(notify);return}}}currentLocation=parseLocation(),history.notify(notify)},"onPushPopEvent"),onBeforeUnload=__name(e=>{if(ignoreNextBeforeUnload){ignoreNextBeforeUnload=!1;return}let shouldBlock=!1;const blockers2=_getBlockers();if(typeof document<"u"&&blockers2.length)for(const blocker of blockers2){const shouldHaveBeforeUnload=blocker.enableBeforeUnload??!0;if(shouldHaveBeforeUnload===!0){shouldBlock=!0;break}if(typeof shouldHaveBeforeUnload=="function"&&shouldHaveBeforeUnload()===!0){shouldBlock=!0;break}}if(shouldBlock)return e.preventDefault(),e.returnValue=""},"onBeforeUnload"),history=createHistory({getLocation,getLength:__name(()=>win.history.length,"getLength"),pushState:__name((href,state)=>queueHistoryAction("push",href,state),"pushState"),replaceState:__name((href,state)=>queueHistoryAction("replace",href,state),"replaceState"),back:__name(ignoreBlocker=>(ignoreBlocker&&(skipBlockerNextPop=!0),ignoreNextBeforeUnload=!0,win.history.back()),"back"),forward:__name(ignoreBlocker=>{ignoreBlocker&&(skipBlockerNextPop=!0),ignoreNextBeforeUnload=!0,win.history.forward()},"forward"),go:__name(n=>{nextPopIsGo=!0,win.history.go(n)},"go"),createHref:__name(href=>createHref(href),"createHref"),flush,destroy:__name(()=>{win.history.pushState=originalPushState,win.history.replaceState=originalReplaceState,win.removeEventListener(beforeUnloadEvent,onBeforeUnload,{capture:!0}),win.removeEventListener(popStateEvent,onPushPopEvent)},"destroy"),onBlocked:__name(()=>{rollbackLocation&&currentLocation!==rollbackLocation&&(currentLocation=rollbackLocation)},"onBlocked"),getBlockers:_getBlockers,setBlockers:_setBlockers,notifyOnIndexChange:!1});return win.addEventListener(beforeUnloadEvent,onBeforeUnload,{capture:!0}),win.addEventListener(popStateEvent,onPushPopEvent),win.history.pushState=function(...args){const res=originalPushState.apply(win.history,args);return history._ignoreSubscribers||onPushPop("PUSH"),res},win.history.replaceState=function(...args){const res=originalReplaceState.apply(win.history,args);return history._ignoreSubscribers||onPushPop("REPLACE"),res},history}__name(createBrowserHistory,"createBrowserHistory");function createMemoryHistory(opts={initialEntries:["/"]}){const entries=opts.initialEntries;let index=opts.initialIndex?Math.min(Math.max(opts.initialIndex,0),entries.length-1):entries.length-1;const states=entries.map((_entry,index2)=>assignKeyAndIndex(index2,void 0));return createHistory({getLocation:__name(()=>parseHref(entries[index],states[index]),"getLocation"),getLength:__name(()=>entries.length,"getLength"),pushState:__name((path,state)=>{index<entries.length-1&&(entries.splice(index+1),states.splice(index+1)),states.push(state),entries.push(path),index=Math.max(entries.length-1,0)},"pushState"),replaceState:__name((path,state)=>{states[index]=state,entries[index]=path},"replaceState"),back:__name(()=>{index=Math.max(index-1,0)},"back"),forward:__name(()=>{index=Math.min(index+1,entries.length-1)},"forward"),go:__name(n=>{index=Math.min(Math.max(index+n,0),entries.length-1)},"go"),createHref:__name(path=>path,"createHref")})}__name(createMemoryHistory,"createMemoryHistory");function parseHref(href,state){const hashIndex=href.indexOf("#"),searchIndex=href.indexOf("?");return{href,pathname:href.substring(0,hashIndex>0?searchIndex>0?Math.min(hashIndex,searchIndex):hashIndex:searchIndex>0?searchIndex:href.length),hash:hashIndex>-1?href.substring(hashIndex):"",search:searchIndex>-1?href.slice(searchIndex,hashIndex===-1?void 0:hashIndex):"",state:state||{[stateIndexKey]:0,key:createRandomKey()}}}__name(parseHref,"parseHref");function createRandomKey(){return(Math.random()+1).toString(36).substring(7)}__name(createRandomKey,"createRandomKey");function last(arr){return arr[arr.length-1]}__name(last,"last");function isFunction(d){return typeof d=="function"}__name(isFunction,"isFunction");function functionalUpdate$1(updater,previous){return isFunction(updater)?updater(previous):updater}__name(functionalUpdate$1,"functionalUpdate$1");function pick(parent,keys){return keys.reduce((obj,key)=>(obj[key]=parent[key],obj),{})}__name(pick,"pick");function replaceEqualDeep(prev,_next){if(prev===_next)return prev;const next=_next,array=isPlainArray(prev)&&isPlainArray(next);if(array||isPlainObject(prev)&&isPlainObject(next)){const prevItems=array?prev:Object.keys(prev),prevSize=prevItems.length,nextItems=array?next:Object.keys(next),nextSize=nextItems.length,copy=array?[]:{};let equalItems=0;for(let i=0;i<nextSize;i++){const key=array?i:nextItems[i];(!array&&prevItems.includes(key)||array)&&prev[key]===void 0&&next[key]===void 0?(copy[key]=void 0,equalItems++):(copy[key]=replaceEqualDeep(prev[key],next[key]),copy[key]===prev[key]&&prev[key]!==void 0&&equalItems++)}return prevSize===nextSize&&equalItems===prevSize?prev:copy}return next}__name(replaceEqualDeep,"replaceEqualDeep");function isPlainObject(o){if(!hasObjectPrototype(o))return!1;const ctor=o.constructor;if(typeof ctor>"u")return!0;const prot=ctor.prototype;return!(!hasObjectPrototype(prot)||!prot.hasOwnProperty("isPrototypeOf"))}__name(isPlainObject,"isPlainObject");function hasObjectPrototype(o){return Object.prototype.toString.call(o)==="[object Object]"}__name(hasObjectPrototype,"hasObjectPrototype");function isPlainArray(value){return Array.isArray(value)&&value.length===Object.keys(value).length}__name(isPlainArray,"isPlainArray");function getObjectKeys(obj,ignoreUndefined){let keys=Object.keys(obj);return ignoreUndefined&&(keys=keys.filter(key=>obj[key]!==void 0)),keys}__name(getObjectKeys,"getObjectKeys");function deepEqual(a,b,opts){if(a===b)return!0;if(typeof a!=typeof b)return!1;if(isPlainObject(a)&&isPlainObject(b)){const ignoreUndefined=(opts==null?void 0:opts.ignoreUndefined)??!0,aKeys=getObjectKeys(a,ignoreUndefined),bKeys=getObjectKeys(b,ignoreUndefined);return!(opts!=null&&opts.partial)&&aKeys.length!==bKeys.length?!1:bKeys.every(key=>deepEqual(a[key],b[key],opts))}return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length?!1:!a.some((item,index)=>!deepEqual(item,b[index],opts)):!1}__name(deepEqual,"deepEqual");function createControlledPromise(onResolve){let resolveLoadPromise,rejectLoadPromise;const controlledPromise=new Promise((resolve,reject)=>{resolveLoadPromise=resolve,rejectLoadPromise=reject});return controlledPromise.status="pending",controlledPromise.resolve=value=>{controlledPromise.status="resolved",controlledPromise.value=value,resolveLoadPromise(value),onResolve==null||onResolve(value)},controlledPromise.reject=e=>{controlledPromise.status="rejected",rejectLoadPromise(e)},controlledPromise}__name(createControlledPromise,"createControlledPromise");function hasUriEncodedChars(inputString){return/%[0-9A-Fa-f]{2}/.test(inputString)}__name(hasUriEncodedChars,"hasUriEncodedChars");function joinPaths(paths){return cleanPath(paths.filter(val=>val!==void 0).join("/"))}__name(joinPaths,"joinPaths");function cleanPath(path){return path.replace(/\/{2,}/g,"/")}__name(cleanPath,"cleanPath");function trimPathLeft(path){return path==="/"?path:path.replace(/^\/{1,}/,"")}__name(trimPathLeft,"trimPathLeft");function trimPathRight(path){return path==="/"?path:path.replace(/\/{1,}$/,"")}__name(trimPathRight,"trimPathRight");function trimPath(path){return trimPathRight(trimPathLeft(path))}__name(trimPath,"trimPath");function removeTrailingSlash(value,basepath){return value!=null&&value.endsWith("/")&&value!=="/"&&value!==`${basepath}/`?value.slice(0,-1):value}__name(removeTrailingSlash,"removeTrailingSlash");function exactPathTest(pathName1,pathName2,basepath){return removeTrailingSlash(pathName1,basepath)===removeTrailingSlash(pathName2,basepath)}__name(exactPathTest,"exactPathTest");function resolvePath({basepath,base,to,trailingSlash="never",caseSensitive}){var _a,_b;base=removeBasepath(basepath,base,caseSensitive),to=removeBasepath(basepath,to,caseSensitive);let baseSegments=parsePathname(base);const toSegments=parsePathname(to);baseSegments.length>1&&((_a=last(baseSegments))==null?void 0:_a.value)==="/"&&baseSegments.pop(),toSegments.forEach((toSegment,index)=>{toSegment.value==="/"?index?index===toSegments.length-1&&baseSegments.push(toSegment):baseSegments=[toSegment]:toSegment.value===".."?baseSegments.pop():toSegment.value==="."||baseSegments.push(toSegment)}),baseSegments.length>1&&(((_b=last(baseSegments))==null?void 0:_b.value)==="/"?trailingSlash==="never"&&baseSegments.pop():trailingSlash==="always"&&baseSegments.push({type:"pathname",value:"/"}));const joined=joinPaths([basepath,...baseSegments.map(d=>d.value)]);return cleanPath(joined)}__name(resolvePath,"resolvePath");function parsePathname(pathname){if(!pathname)return[];pathname=cleanPath(pathname);const segments=[];if(pathname.slice(0,1)==="/"&&(pathname=pathname.substring(1),segments.push({type:"pathname",value:"/"})),!pathname)return segments;const split=pathname.split("/").filter(Boolean);return segments.push(...split.map(part=>part==="$"||part==="*"?{type:"wildcard",value:part}:part.charAt(0)==="$"?{type:"param",value:part}:{type:"pathname",value:part.includes("%25")?part.split("%25").map(segment=>decodeURI(segment)).join("%25"):decodeURI(part)})),pathname.slice(-1)==="/"&&(pathname=pathname.substring(1),segments.push({type:"pathname",value:"/"})),segments}__name(parsePathname,"parsePathname");function interpolatePath({path,params,leaveWildcards,leaveParams,decodeCharMap}){const interpolatedPathSegments=parsePathname(path);function encodeParam(key){const value=params[key],isValueString=typeof value=="string";return["*","_splat"].includes(key)?isValueString?encodeURI(value):value:isValueString?encodePathParam(value,decodeCharMap):value}__name(encodeParam,"encodeParam");let isMissingParams=!1;const usedParams={},interpolatedPath=joinPaths(interpolatedPathSegments.map(segment=>{if(segment.type==="wildcard"){usedParams._splat=params._splat;const value=encodeParam("_splat");return leaveWildcards?`${segment.value}${value??""}`:value}if(segment.type==="param"){const key=segment.value.substring(1);if(!isMissingParams&&!(key in params)&&(isMissingParams=!0),usedParams[key]=params[key],leaveParams){const value=encodeParam(segment.value);return`${segment.value}${value??""}`}return encodeParam(key)??"undefined"}return segment.value}));return{usedParams,interpolatedPath,isMissingParams}}__name(interpolatePath,"interpolatePath");function encodePathParam(value,decodeCharMap){let encoded=encodeURIComponent(value);if(decodeCharMap)for(const[encodedChar,char]of decodeCharMap)encoded=encoded.replaceAll(encodedChar,char);return encoded}__name(encodePathParam,"encodePathParam");function matchPathname(basepath,currentPathname,matchLocation){const pathParams=matchByPath(basepath,currentPathname,matchLocation);if(!(matchLocation.to&&!pathParams))return pathParams??{}}__name(matchPathname,"matchPathname");function removeBasepath(basepath,pathname,caseSensitive=!1){const normalizedBasepath=caseSensitive?basepath:basepath.toLowerCase(),normalizedPathname=caseSensitive?pathname:pathname.toLowerCase();switch(!0){case normalizedBasepath==="/":return pathname;case normalizedPathname===normalizedBasepath:return"";case pathname.length<basepath.length:return pathname;case normalizedPathname[normalizedBasepath.length]!=="/":return pathname;case normalizedPathname.startsWith(normalizedBasepath):return pathname.slice(basepath.length);default:return pathname}}__name(removeBasepath,"removeBasepath");function matchByPath(basepath,from,matchLocation){if(basepath!=="/"&&!from.startsWith(basepath))return;from=removeBasepath(basepath,from,matchLocation.caseSensitive);const to=removeBasepath(basepath,`${matchLocation.to??"$"}`,matchLocation.caseSensitive),baseSegments=parsePathname(from),routeSegments=parsePathname(to);from.startsWith("/")||baseSegments.unshift({type:"pathname",value:"/"}),to.startsWith("/")||routeSegments.unshift({type:"pathname",value:"/"});const params={};return(()=>{for(let i=0;i<Math.max(baseSegments.length,routeSegments.length);i++){const baseSegment=baseSegments[i],routeSegment=routeSegments[i],isLastBaseSegment=i>=baseSegments.length-1,isLastRouteSegment=i>=routeSegments.length-1;if(routeSegment){if(routeSegment.type==="wildcard"){const _splat=decodeURI(joinPaths(baseSegments.slice(i).map(d=>d.value)));return params["*"]=_splat,params._splat=_splat,!0}if(routeSegment.type==="pathname"){if(routeSegment.value==="/"&&!(baseSegment!=null&&baseSegment.value))return!0;if(baseSegment){if(matchLocation.caseSensitive){if(routeSegment.value!==baseSegment.value)return!1}else if(routeSegment.value.toLowerCase()!==baseSegment.value.toLowerCase())return!1}}if(!baseSegment)return!1;if(routeSegment.type==="param"){if(baseSegment.value==="/")return!1;baseSegment.value.charAt(0)!=="$"&&(params[routeSegment.value.substring(1)]=decodeURIComponent(baseSegment.value))}}if(!isLastBaseSegment&&isLastRouteSegment)return params["**"]=joinPaths(baseSegments.slice(i+1).map(d=>d.value)),!!matchLocation.fuzzy&&(routeSegment==null?void 0:routeSegment.value)!=="/"}return!0})()?params:void 0}__name(matchByPath,"matchByPath");function isNotFound(obj){return!!(obj!=null&&obj.isNotFound)}__name(isNotFound,"isNotFound");const storageKey="tsr-scroll-restoration-v1_3";let sessionsStorage=!1;try{sessionsStorage=typeof window<"u"&&typeof window.sessionStorage=="object"}catch{}const throttle=__name((fn,wait)=>{let timeout;return(...args)=>{timeout||(timeout=setTimeout(()=>{fn(...args),timeout=null},wait))}},"throttle"),scrollRestorationCache=sessionsStorage?{state:JSON.parse(window.sessionStorage.getItem(storageKey)||"null")||{},set:__name(updater=>(scrollRestorationCache.state=functionalUpdate$1(updater,scrollRestorationCache.state)||scrollRestorationCache.state,window.sessionStorage.setItem(storageKey,JSON.stringify(scrollRestorationCache.state))),"set")}:void 0,defaultGetScrollRestorationKey=__name(location=>location.state.key||location.href,"defaultGetScrollRestorationKey");function getCssSelector(el){const path=[];let parent;for(;parent=el.parentNode;)path.unshift(`${el.tagName}:nth-child(${[].indexOf.call(parent.children,el)+1})`),el=parent;return`${path.join(" > ")}`.toLowerCase()}__name(getCssSelector,"getCssSelector");let ignoreScroll=!1;function restoreScroll(storageKey2,key,behavior,shouldScrollRestoration,scrollToTopSelectors){var _a;let byKey;try{byKey=JSON.parse(sessionStorage.getItem(storageKey2)||"{}")}catch(error){console.error(error);return}const resolvedKey=key||((_a=window.history.state)==null?void 0:_a.key),elementEntries=byKey[resolvedKey];ignoreScroll=!0,(()=>{if(shouldScrollRestoration&&elementEntries){for(const elementSelector in elementEntries){const entry=elementEntries[elementSelector];if(elementSelector==="window")window.scrollTo({top:entry.scrollY,left:entry.scrollX,behavior});else if(elementSelector){const element=document.querySelector(elementSelector);element&&(element.scrollLeft=entry.scrollX,element.scrollTop=entry.scrollY)}}return}const hash=window.location.hash.split("#")[1];if(hash){const hashScrollIntoViewOptions=(window.history.state||{}).__hashScrollIntoViewOptions??!0;if(hashScrollIntoViewOptions){const el=document.getElementById(hash);el&&el.scrollIntoView(hashScrollIntoViewOptions)}return}["window",...(scrollToTopSelectors==null?void 0:scrollToTopSelectors.filter(d=>d!=="window"))??[]].forEach(selector=>{const element=selector==="window"?window:document.querySelector(selector);element&&element.scrollTo({top:0,left:0,behavior})})})(),ignoreScroll=!1}__name(restoreScroll,"restoreScroll");function setupScrollRestoration(router,force){if((router.options.scrollRestoration??!1)&&(router.isScrollRestoring=!0),typeof document>"u"||router.isScrollRestorationSetup)return;router.isScrollRestorationSetup=!0,ignoreScroll=!1;const getKey=router.options.getScrollRestorationKey||defaultGetScrollRestorationKey;window.history.scrollRestoration="manual";const onScroll=__name(event=>{if(ignoreScroll||!router.isScrollRestoring)return;let elementSelector="";if(event.target===document||event.target===window)elementSelector="window";else{const attrId=event.target.getAttribute("data-scroll-restoration-id");attrId?elementSelector=`[data-scroll-restoration-id="${attrId}"]`:elementSelector=getCssSelector(event.target)}const restoreKey=getKey(router.state.location);scrollRestorationCache.set(state=>{const keyEntry=state[restoreKey]=state[restoreKey]||{},elementEntry=keyEntry[elementSelector]=keyEntry[elementSelector]||{};if(elementSelector==="window")elementEntry.scrollX=window.scrollX||0,elementEntry.scrollY=window.scrollY||0;else if(elementSelector){const element=document.querySelector(elementSelector);element&&(elementEntry.scrollX=element.scrollLeft||0,elementEntry.scrollY=element.scrollTop||0)}return state})},"onScroll");typeof document<"u"&&document.addEventListener("scroll",throttle(onScroll,100),!0),router.subscribe("onRendered",event=>{const cacheKey=getKey(event.toLocation);if(!router.resetNextScroll){router.resetNextScroll=!0;return}restoreScroll(storageKey,cacheKey,router.options.scrollRestorationBehavior||void 0,router.isScrollRestoring||void 0,router.options.scrollToTopSelectors||void 0),router.isScrollRestoring&&scrollRestorationCache.set(state=>(state[cacheKey]=state[cacheKey]||{},state))})}__name(setupScrollRestoration,"setupScrollRestoration");function handleHashScroll(router){if(typeof document<"u"&&document.querySelector){const hashScrollIntoViewOptions=router.state.location.state.__hashScrollIntoViewOptions??!0;if(hashScrollIntoViewOptions&&router.state.location.hash!==""){const el=document.getElementById(router.state.location.hash);el&&el.scrollIntoView(hashScrollIntoViewOptions)}}}__name(handleHashScroll,"handleHashScroll");function encode(obj,pfx){const normalizedObject=Object.entries(obj).flatMap(([key,value])=>Array.isArray(value)?value.map(v=>[key,String(v)]):[[key,String(value)]]);return""+new URLSearchParams(normalizedObject).toString()}__name(encode,"encode");function toValue(mix){if(!mix)return"";const str=hasUriEncodedChars(mix)?decodeURIComponent(mix):decodeURIComponent(encodeURIComponent(mix));return str==="false"?!1:str==="true"?!0:+str*0===0&&+str+""===str?+str:str}__name(toValue,"toValue");function decode(str,pfx){const searchParamsPart=str;return[...new URLSearchParams(searchParamsPart).entries()].reduce((acc,[key,value])=>{const previousValue=acc[key];return previousValue==null?acc[key]=toValue(value):acc[key]=Array.isArray(previousValue)?[...previousValue,toValue(value)]:[previousValue,toValue(value)],acc},{})}__name(decode,"decode");const defaultParseSearch=parseSearchWith(JSON.parse),defaultStringifySearch=stringifySearchWith(JSON.stringify,JSON.parse);function parseSearchWith(parser){return searchStr=>{searchStr.substring(0,1)==="?"&&(searchStr=searchStr.substring(1));const query=decode(searchStr);for(const key in query){const value=query[key];if(typeof value=="string")try{query[key]=parser(value)}catch{}}return query}}__name(parseSearchWith,"parseSearchWith");function stringifySearchWith(stringify,parser){function stringifyValue(val){if(typeof val=="object"&&val!==null)try{return stringify(val)}catch{}else if(typeof val=="string"&&typeof parser=="function")try{return parser(val),stringify(val)}catch{}return val}return __name(stringifyValue,"stringifyValue"),search=>{search={...search},Object.keys(search).forEach(key=>{const val=search[key];typeof val>"u"||val===void 0?delete search[key]:search[key]=stringifyValue(val)});const searchStr=encode(search).toString();return searchStr?`?${searchStr}`:""}}__name(stringifySearchWith,"stringifySearchWith");const rootRouteId="__root__";function redirect(opts){if(opts.isRedirect=!0,opts.statusCode=opts.statusCode||opts.code||307,opts.headers=opts.headers||{},!opts.reloadDocument){opts.reloadDocument=!1;try{new URL(`${opts.href}`),opts.reloadDocument=!0}catch{}}if(opts.throw)throw opts;return opts}__name(redirect,"redirect");function isRedirect(obj){return!!(obj!=null&&obj.isRedirect)}__name(isRedirect,"isRedirect");function isResolvedRedirect(obj){return!!(obj!=null&&obj.isRedirect)&&obj.href}__name(isResolvedRedirect,"isResolvedRedirect");function getLocationChangeInfo(routerState){const fromLocation=routerState.resolvedLocation,toLocation=routerState.location,pathChanged=(fromLocation==null?void 0:fromLocation.pathname)!==toLocation.pathname,hrefChanged=(fromLocation==null?void 0:fromLocation.href)!==toLocation.href,hashChanged=(fromLocation==null?void 0:fromLocation.hash)!==toLocation.hash;return{fromLocation,toLocation,pathChanged,hrefChanged,hashChanged}}__name(getLocationChangeInfo,"getLocationChangeInfo");const _RouterCore=class _RouterCore{constructor(options){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=fn=>fn(),this.update=newOptions=>{var _a;newOptions.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const previousOptions=this.options;this.options={...this.options,...newOptions},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(char=>[encodeURIComponent(char),char])):void 0,(!this.basepath||newOptions.basepath&&newOptions.basepath!==previousOptions.basepath)&&(newOptions.basepath===void 0||newOptions.basepath===""||newOptions.basepath==="/"?this.basepath="/":this.basepath=`/${trimPath(newOptions.basepath)}`),(!this.history||this.options.history&&this.options.history!==this.history)&&(this.history=this.options.history??(this.isServer?createMemoryHistory({initialEntries:[this.basepath||"/"]}):createBrowserHistory()),this.latestLocation=this.parseLocation()),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),this.__store||(this.__store=new Store(getInitialRouterState(this.latestLocation),{onUpdate:__name(()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(d=>!["redirected"].includes(d.status))}},"onUpdate")}),setupScrollRestoration(this)),typeof window<"u"&&"CSS"in window&&typeof((_a=window.CSS)==null?void 0:_a.supports)=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.buildRouteTree=()=>{this.routesById={},this.routesByPath={};const notFoundRoute=this.options.notFoundRoute;notFoundRoute&&(notFoundRoute.init({originalIndex:99999999999,defaultSsr:this.options.defaultSsr}),this.routesById[notFoundRoute.id]=notFoundRoute);const recurseRoutes=__name(childRoutes=>{childRoutes.forEach((childRoute,i)=>{childRoute.init({originalIndex:i,defaultSsr:this.options.defaultSsr});const existingRoute=this.routesById[childRoute.id];if(invariant(!existingRoute,`Duplicate routes found with id: ${String(childRoute.id)}`),this.routesById[childRoute.id]=childRoute,!childRoute.isRoot&&childRoute.path){const trimmedFullPath=trimPathRight(childRoute.fullPath);(!this.routesByPath[trimmedFullPath]||childRoute.fullPath.endsWith("/"))&&(this.routesByPath[trimmedFullPath]=childRoute)}const children=childRoute.children;children!=null&&children.length&&recurseRoutes(children)})},"recurseRoutes");recurseRoutes([this.routeTree]);const scoredRoutes=[];Object.values(this.routesById).forEach((d,i)=>{var _a;if(d.isRoot||!d.path)return;const trimmed=trimPathLeft(d.fullPath),parsed=parsePathname(trimmed);for(;parsed.length>1&&((_a=parsed[0])==null?void 0:_a.value)==="/";)parsed.shift();const scores=parsed.map(segment=>segment.value==="/"?.75:segment.type==="param"?.5:segment.type==="wildcard"?.25:1);scoredRoutes.push({child:d,trimmed,parsed,index:i,scores})}),this.flatRoutes=scoredRoutes.sort((a,b)=>{const minLength=Math.min(a.scores.length,b.scores.length);for(let i=0;i<minLength;i++)if(a.scores[i]!==b.scores[i])return b.scores[i]-a.scores[i];if(a.scores.length!==b.scores.length)return b.scores.length-a.scores.length;for(let i=0;i<minLength;i++)if(a.parsed[i].value!==b.parsed[i].value)return a.parsed[i].value>b.parsed[i].value?1:-1;return a.index-b.index}).map((d,i)=>(d.child.rank=i,d.child))},this.subscribe=(eventType,fn)=>{const listener={eventType,fn};return this.subscribers.add(listener),()=>{this.subscribers.delete(listener)}},this.emit=routerEvent=>{this.subscribers.forEach(listener=>{listener.eventType===routerEvent.type&&listener.fn(routerEvent)})},this.parseLocation=(previousLocation,locationToParse)=>{const parse=__name(({pathname,search,hash,state})=>{const parsedSearch=this.options.parseSearch(search),searchStr=this.options.stringifySearch(parsedSearch);return{pathname,searchStr,search:replaceEqualDeep(previousLocation==null?void 0:previousLocation.search,parsedSearch),hash:hash.split("#").reverse()[0]??"",href:`${pathname}${searchStr}${hash}`,state:replaceEqualDeep(previousLocation==null?void 0:previousLocation.state,state)}},"parse"),location=parse(locationToParse??this.history.location),{__tempLocation,__tempKey}=location.state;if(__tempLocation&&(!__tempKey||__tempKey===this.tempLocationKey)){const parsedTempLocation=parse(__tempLocation);return parsedTempLocation.state.key=location.state.key,delete parsedTempLocation.state.__tempLocation,{...parsedTempLocation,maskedLocation:location}}return location},this.resolvePathWithBase=(from,path)=>resolvePath({basepath:this.basepath,base:from,to:cleanPath(path),trailingSlash:this.options.trailingSlash,caseSensitive:this.options.caseSensitive}),this.matchRoutes=(pathnameOrNext,locationSearchOrOpts,opts)=>typeof pathnameOrNext=="string"?this.matchRoutesInternal({pathname:pathnameOrNext,search:locationSearchOrOpts},opts):this.matchRoutesInternal(pathnameOrNext,locationSearchOrOpts),this.getMatchedRoutes=(next,dest)=>{let routeParams={};const trimmedPath=trimPathRight(next.pathname),getMatchedParams=__name(route=>matchPathname(this.basepath,trimmedPath,{to:route.fullPath,caseSensitive:route.options.caseSensitive??this.options.caseSensitive,fuzzy:!0}),"getMatchedParams");let foundRoute=(dest==null?void 0:dest.to)!==void 0?this.routesByPath[dest.to]:void 0;foundRoute?routeParams=getMatchedParams(foundRoute):foundRoute=this.flatRoutes.find(route=>{const matchedParams=getMatchedParams(route);return matchedParams?(routeParams=matchedParams,!0):!1});let routeCursor=foundRoute||this.routesById[rootRouteId];const matchedRoutes=[routeCursor];for(;routeCursor.parentRoute;)routeCursor=routeCursor.parentRoute,matchedRoutes.unshift(routeCursor);return{matchedRoutes,routeParams,foundRoute}},this.cancelMatch=id=>{const match=this.getMatch(id);match&&(match.abortController.abort(),clearTimeout(match.pendingTimeout))},this.cancelMatches=()=>{var _a;(_a=this.state.pendingMatches)==null||_a.forEach(match=>{this.cancelMatch(match.id)})},this.buildLocation=opts=>{const build=__name((dest={},matchedRoutesResult)=>{var _a,_b,_c,_d,_e,_f,_g;const fromMatches=dest._fromLocation?this.matchRoutes(dest._fromLocation,{_buildLocation:!0}):this.state.matches,fromMatch=dest.from!=null?fromMatches.find(d=>matchPathname(this.basepath,trimPathRight(d.pathname),{to:dest.from,caseSensitive:!1,fuzzy:!1})):void 0,fromPath=(fromMatch==null?void 0:fromMatch.pathname)||this.latestLocation.pathname;invariant(dest.from==null||fromMatch!=null,"Could not find match for from: "+dest.from);const fromSearch=(_a=this.state.pendingMatches)!=null&&_a.length?(_b=last(this.state.pendingMatches))==null?void 0:_b.search:((_c=last(fromMatches))==null?void 0:_c.search)||this.latestLocation.search,stayingMatches=matchedRoutesResult==null?void 0:matchedRoutesResult.matchedRoutes.filter(d=>fromMatches.find(e=>e.routeId===d.id));let pathname;if(dest.to){const resolvePathTo=(fromMatch==null?void 0:fromMatch.fullPath)||((_d=last(fromMatches))==null?void 0:_d.fullPath)||this.latestLocation.pathname;pathname=this.resolvePathWithBase(resolvePathTo,`${dest.to}`)}else{const fromRouteByFromPathRouteId=this.routesById[(_e=stayingMatches==null?void 0:stayingMatches.find(route=>{const interpolatedPath=interpolatePath({path:route.fullPath,params:(matchedRoutesResult==null?void 0:matchedRoutesResult.routeParams)??{},decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;return joinPaths([this.basepath,interpolatedPath])===fromPath}))==null?void 0:_e.id];pathname=this.resolvePathWithBase(fromPath,(fromRouteByFromPathRouteId==null?void 0:fromRouteByFromPathRouteId.to)??fromPath)}const prevParams={...(_f=last(fromMatches))==null?void 0:_f.params};let nextParams=(dest.params??!0)===!0?prevParams:{...prevParams,...functionalUpdate$1(dest.params,prevParams)};Object.keys(nextParams).length>0&&(matchedRoutesResult==null||matchedRoutesResult.matchedRoutes.map(route=>{var _a2;return((_a2=route.options.params)==null?void 0:_a2.stringify)??route.options.stringifyParams}).filter(Boolean).forEach(fn=>{nextParams={...nextParams,...fn(nextParams)}})),pathname=interpolatePath({path:pathname,params:nextParams??{},leaveWildcards:!1,leaveParams:opts.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;let search=fromSearch;if(opts._includeValidateSearch&&((_g=this.options.search)!=null&&_g.strict)){let validatedSearch={};matchedRoutesResult==null||matchedRoutesResult.matchedRoutes.forEach(route=>{try{route.options.validateSearch&&(validatedSearch={...validatedSearch,...validateSearch(route.options.validateSearch,{...validatedSearch,...search})??{}})}catch{}}),search=validatedSearch}search=__name(search2=>{const allMiddlewares=(matchedRoutesResult==null?void 0:matchedRoutesResult.matchedRoutes.reduce((acc,route)=>{var _a2;const middlewares=[];if("search"in route.options)(_a2=route.options.search)!=null&&_a2.middlewares&&middlewares.push(...route.options.search.middlewares);else if(route.options.preSearchFilters||route.options.postSearchFilters){const legacyMiddleware=__name(({search:search3,next})=>{let nextSearch=search3;"preSearchFilters"in route.options&&route.options.preSearchFilters&&(nextSearch=route.options.preSearchFilters.reduce((prev,next2)=>next2(prev),search3));const result=next(nextSearch);return"postSearchFilters"in route.options&&route.options.postSearchFilters?route.options.postSearchFilters.reduce((prev,next2)=>next2(prev),result):result},"legacyMiddleware");middlewares.push(legacyMiddleware)}if(opts._includeValidateSearch&&route.options.validateSearch){const validate=__name(({search:search3,next})=>{const result=next(search3);try{return{...result,...validateSearch(route.options.validateSearch,result)??{}}}catch{return result}},"validate");middlewares.push(validate)}return acc.concat(middlewares)},[]))??[],final=__name(({search:search3})=>dest.search?dest.search===!0?search3:functionalUpdate$1(dest.search,search3):{},"final");allMiddlewares.push(final);const applyNext=__name((index,currentSearch)=>{if(index>=allMiddlewares.length)return currentSearch;const middleware=allMiddlewares[index];return middleware({search:currentSearch,next:__name(newSearch=>applyNext(index+1,newSearch),"next")})},"applyNext");return applyNext(0,search2)},"applyMiddlewares")(search),search=replaceEqualDeep(fromSearch,search);const searchStr=this.options.stringifySearch(search),hash=dest.hash===!0?this.latestLocation.hash:dest.hash?functionalUpdate$1(dest.hash,this.latestLocation.hash):void 0,hashStr=hash?`#${hash}`:"";let nextState=dest.state===!0?this.latestLocation.state:dest.state?functionalUpdate$1(dest.state,this.latestLocation.state):{};return nextState=replaceEqualDeep(this.latestLocation.state,nextState),{pathname,search,searchStr,state:nextState,hash:hash??"",href:`${pathname}${searchStr}${hashStr}`,unmaskOnReload:dest.unmaskOnReload}},"build"),buildWithMatches=__name((dest={},maskedDest)=>{var _a;const next=build(dest);let maskedNext=maskedDest?build(maskedDest):void 0;if(!maskedNext){let params={};const foundMask=(_a=this.options.routeMasks)==null?void 0:_a.find(d=>{const match=matchPathname(this.basepath,next.pathname,{to:d.from,caseSensitive:!1,fuzzy:!1});return match?(params=match,!0):!1});if(foundMask){const{from:_from,...maskProps}=foundMask;maskedDest={...pick(opts,["from"]),...maskProps,params},maskedNext=build(maskedDest)}}const nextMatches=this.getMatchedRoutes(next,dest),final=build(dest,nextMatches);if(maskedNext){const maskedMatches=this.getMatchedRoutes(maskedNext,maskedDest),maskedFinal=build(maskedDest,maskedMatches);final.maskedLocation=maskedFinal}return final},"buildWithMatches");return opts.mask?buildWithMatches(opts,{...pick(opts,["from"]),...opts.mask}):buildWithMatches(opts)},this.commitLocation=({viewTransition,ignoreBlocker,...next})=>{const isSameState=__name(()=>{const ignoredProps=["key","__TSR_index","__hashScrollIntoViewOptions"];ignoredProps.forEach(prop=>{next.state[prop]=this.latestLocation.state[prop]});const isEqual=deepEqual(next.state,this.latestLocation.state);return ignoredProps.forEach(prop=>{delete next.state[prop]}),isEqual},"isSameState"),isSameUrl=this.latestLocation.href===next.href,previousCommitPromise=this.commitLocationPromise;if(this.commitLocationPromise=createControlledPromise(()=>{previousCommitPromise==null||previousCommitPromise.resolve()}),isSameUrl&&isSameState())this.load();else{let{maskedLocation,hashScrollIntoView,...nextHistory}=next;maskedLocation&&(nextHistory={...maskedLocation,state:{...maskedLocation.state,__tempKey:void 0,__tempLocation:{...nextHistory,search:nextHistory.searchStr,state:{...nextHistory.state,__tempKey:void 0,__tempLocation:void 0,key:void 0}}}},(nextHistory.unmaskOnReload??this.options.unmaskOnReload??!1)&&(nextHistory.state.__tempKey=this.tempLocationKey)),nextHistory.state.__hashScrollIntoViewOptions=hashScrollIntoView??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=viewTransition,this.history[next.replace?"replace":"push"](nextHistory.href,nextHistory.state,{ignoreBlocker})}return this.resetNextScroll=next.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace,resetScroll,hashScrollIntoView,viewTransition,ignoreBlocker,href,...rest}={})=>{if(href){const currentIndex=this.history.location.state.__TSR_index,parsed=parseHref(href,{__TSR_index:replace?currentIndex:currentIndex+1});rest.to=parsed.pathname,rest.search=this.options.parseSearch(parsed.search),rest.hash=parsed.hash.slice(1)}const location=this.buildLocation({...rest,_includeValidateSearch:!0});return this.commitLocation({...location,viewTransition,replace,resetScroll,hashScrollIntoView,ignoreBlocker})},this.navigate=({to,reloadDocument,href,...rest})=>{if(reloadDocument){if(!href){const location=this.buildLocation({to,...rest});href=this.history.createHref(location.href)}rest.replace?window.location.replace(href):window.location.href=href;return}return this.buildAndCommitLocation({...rest,href,to})},this.load=async opts=>{this.latestLocation=this.parseLocation(this.latestLocation);let redirect2,notFound,loadPromise;for(loadPromise=new Promise(resolve=>{this.startTransition(async()=>{var _a;try{const next=this.latestLocation,prevLocation=this.state.resolvedLocation;this.cancelMatches();let pendingMatches;batch(()=>{pendingMatches=this.matchRoutes(next),this.__store.setState(s=>({...s,status:"pending",isLoading:!0,location:next,pendingMatches,cachedMatches:s.cachedMatches.filter(d=>!pendingMatches.find(e=>e.id===d.id))}))}),this.state.redirect||this.emit({type:"onBeforeNavigate",...getLocationChangeInfo({resolvedLocation:prevLocation,location:next})}),this.emit({type:"onBeforeLoad",...getLocationChangeInfo({resolvedLocation:prevLocation,location:next})}),await this.loadMatches({sync:opts==null?void 0:opts.sync,matches:pendingMatches,location:next,onReady:__name(async()=>{this.startViewTransition(async()=>{let exitingMatches,enteringMatches,stayingMatches;batch(()=>{this.__store.setState(s=>{const previousMatches=s.matches,newMatches=s.pendingMatches||s.matches;return exitingMatches=previousMatches.filter(match=>!newMatches.find(d=>d.id===match.id)),enteringMatches=newMatches.filter(match=>!previousMatches.find(d=>d.id===match.id)),stayingMatches=previousMatches.filter(match=>newMatches.find(d=>d.id===match.id)),{...s,isLoading:!1,loadedAt:Date.now(),matches:newMatches,pendingMatches:void 0,cachedMatches:[...s.cachedMatches,...exitingMatches.filter(d=>d.status!=="error")]}}),this.clearExpiredCache()}),[[exitingMatches,"onLeave"],[enteringMatches,"onEnter"],[stayingMatches,"onStay"]].forEach(([matches,hook])=>{matches.forEach(match=>{var _a2,_b;(_b=(_a2=this.looseRoutesById[match.routeId].options)[hook])==null||_b.call(_a2,match)})})})},"onReady")})}catch(err){isResolvedRedirect(err)?(redirect2=err,this.isServer||this.navigate({...redirect2,replace:!0,ignoreBlocker:!0})):isNotFound(err)&&(notFound=err),this.__store.setState(s=>({...s,statusCode:redirect2?redirect2.statusCode:notFound?404:s.matches.some(d=>d.status==="error")?500:200,redirect:redirect2}))}this.latestLoadPromise===loadPromise&&((_a=this.commitLocationPromise)==null||_a.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),resolve()})}),this.latestLoadPromise=loadPromise,await loadPromise;this.latestLoadPromise&&loadPromise!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(s=>({...s,statusCode:404}))},this.startViewTransition=fn=>{const shouldViewTransition=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,shouldViewTransition&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let startViewTransitionParams;if(typeof shouldViewTransition=="object"&&this.isViewTransitionTypesSupported){const next=this.latestLocation,prevLocation=this.state.resolvedLocation,resolvedViewTransitionTypes=typeof shouldViewTransition.types=="function"?shouldViewTransition.types(getLocationChangeInfo({resolvedLocation:prevLocation,location:next})):shouldViewTransition.types;startViewTransitionParams={update:fn,types:resolvedViewTransitionTypes}}else startViewTransitionParams=fn;document.startViewTransition(startViewTransitionParams)}else fn()},this.updateMatch=(id,updater)=>{var _a;let updated;const isPending=(_a=this.state.pendingMatches)==null?void 0:_a.find(d=>d.id===id),isMatched=this.state.matches.find(d=>d.id===id),isCached=this.state.cachedMatches.find(d=>d.id===id),matchesKey=isPending?"pendingMatches":isMatched?"matches":isCached?"cachedMatches":"";return matchesKey&&this.__store.setState(s=>{var _a2;return{...s,[matchesKey]:(_a2=s[matchesKey])==null?void 0:_a2.map(d=>d.id===id?updated=updater(d):d)}}),updated},this.getMatch=matchId=>[...this.state.cachedMatches,...this.state.pendingMatches??[],...this.state.matches].find(d=>d.id===matchId),this.loadMatches=async({location,matches,preload:allPreload,onReady,updateMatch=this.updateMatch,sync})=>{let firstBadMatchIndex,rendered=!1;const triggerOnReady=__name(async()=>{rendered||(rendered=!0,await(onReady==null?void 0:onReady()))},"triggerOnReady"),resolvePreload=__name(matchId=>!!(allPreload&&!this.state.matches.find(d=>d.id===matchId)),"resolvePreload"),handleRedirectAndNotFound=__name((match,err)=>{var _a,_b,_c,_d;if(isResolvedRedirect(err)&&!err.reloadDocument)throw err;if(isRedirect(err)||isNotFound(err)){if(updateMatch(match.id,prev=>({...prev,status:isRedirect(err)?"redirected":isNotFound(err)?"notFound":"error",isFetching:!1,error:err,beforeLoadPromise:void 0,loaderPromise:void 0})),err.routeId||(err.routeId=match.routeId),(_a=match.beforeLoadPromise)==null||_a.resolve(),(_b=match.loaderPromise)==null||_b.resolve(),(_c=match.loadPromise)==null||_c.resolve(),isRedirect(err))throw rendered=!0,err=this.resolveRedirect({...err,_fromLocation:location}),err;if(isNotFound(err))throw this._handleNotFound(matches,err,{updateMatch}),(_d=this.serverSsr)==null||_d.onMatchSettled({router:this,match:this.getMatch(match.id)}),err}},"handleRedirectAndNotFound");try{await new Promise((resolveAll,rejectAll)=>{(async()=>{var _a,_b,_c,_d;try{const handleSerialError=__name((index,err,routerCode)=>{var _a2,_b2;const{id:matchId,routeId}=matches[index],route=this.looseRoutesById[routeId];if(err instanceof Promise)throw err;err.routerCode=routerCode,firstBadMatchIndex=firstBadMatchIndex??index,handleRedirectAndNotFound(this.getMatch(matchId),err);try{(_b2=(_a2=route.options).onError)==null||_b2.call(_a2,err)}catch(errorHandlerErr){err=errorHandlerErr,handleRedirectAndNotFound(this.getMatch(matchId),err)}updateMatch(matchId,prev=>{var _a3,_b3;return(_a3=prev.beforeLoadPromise)==null||_a3.resolve(),(_b3=prev.loadPromise)==null||_b3.resolve(),{...prev,error:err,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController,beforeLoadPromise:void 0}})},"handleSerialError");for(const[index,{id:matchId,routeId}]of matches.entries()){const existingMatch=this.getMatch(matchId),parentMatchId=(_a=matches[index-1])==null?void 0:_a.id,route=this.looseRoutesById[routeId],pendingMs=route.options.pendingMs??this.options.defaultPendingMs,shouldPending=!!(onReady&&!this.isServer&&!resolvePreload(matchId)&&(route.options.loader||route.options.beforeLoad||routeNeedsPreload(route))&&typeof pendingMs=="number"&&pendingMs!==1/0&&(route.options.pendingComponent??((_b=this.options)==null?void 0:_b.defaultPendingComponent)));let executeBeforeLoad=!0;if((existingMatch.beforeLoadPromise||existingMatch.loaderPromise)&&(shouldPending&&setTimeout(()=>{try{triggerOnReady()}catch{}},pendingMs),await existingMatch.beforeLoadPromise,executeBeforeLoad=this.getMatch(matchId).status!=="success"),executeBeforeLoad){try{updateMatch(matchId,prev=>{const prevLoadPromise=prev.loadPromise;return{...prev,loadPromise:createControlledPromise(()=>{prevLoadPromise==null||prevLoadPromise.resolve()}),beforeLoadPromise:createControlledPromise()}});const abortController=new AbortController;let pendingTimeout;shouldPending&&(pendingTimeout=setTimeout(()=>{try{triggerOnReady()}catch{}},pendingMs));const{paramsError,searchError}=this.getMatch(matchId);paramsError&&handleSerialError(index,paramsError,"PARSE_PARAMS"),searchError&&handleSerialError(index,searchError,"VALIDATE_SEARCH");const getParentMatchContext=__name(()=>parentMatchId?this.getMatch(parentMatchId).context:this.options.context??{},"getParentMatchContext");updateMatch(matchId,prev=>({...prev,isFetching:"beforeLoad",fetchCount:prev.fetchCount+1,abortController,pendingTimeout,context:{...getParentMatchContext(),...prev.__routeContext}}));const{search,params,context,cause}=this.getMatch(matchId),preload=resolvePreload(matchId),beforeLoadFnContext={search,abortController,params,preload,context,location,navigate:__name(opts=>this.navigate({...opts,_fromLocation:location}),"navigate"),buildLocation:this.buildLocation,cause:preload?"preload":cause,matches},beforeLoadContext=await((_d=(_c=route.options).beforeLoad)==null?void 0:_d.call(_c,beforeLoadFnContext))??{};(isRedirect(beforeLoadContext)||isNotFound(beforeLoadContext))&&handleSerialError(index,beforeLoadContext,"BEFORE_LOAD"),updateMatch(matchId,prev=>({...prev,__beforeLoadContext:beforeLoadContext,context:{...getParentMatchContext(),...prev.__routeContext,...beforeLoadContext},abortController}))}catch(err){handleSerialError(index,err,"BEFORE_LOAD")}updateMatch(matchId,prev=>{var _a2;return(_a2=prev.beforeLoadPromise)==null||_a2.resolve(),{...prev,beforeLoadPromise:void 0,isFetching:!1}})}}const validResolvedMatches=matches.slice(0,firstBadMatchIndex),matchPromises=[];validResolvedMatches.forEach(({id:matchId,routeId},index)=>{matchPromises.push((async()=>{const{loaderPromise:prevLoaderPromise}=this.getMatch(matchId);let loaderShouldRunAsync=!1,loaderIsRunningAsync=!1;if(prevLoaderPromise){await prevLoaderPromise;const match=this.getMatch(matchId);match.error&&handleRedirectAndNotFound(match,match.error)}else{const parentMatchPromise=matchPromises[index-1],route=this.looseRoutesById[routeId],getLoaderContext=__name(()=>{const{params,loaderDeps,abortController,context,cause}=this.getMatch(matchId),preload2=resolvePreload(matchId);return{params,deps:loaderDeps,preload:!!preload2,parentMatchPromise,abortController,context,location,navigate:__name(opts=>this.navigate({...opts,_fromLocation:location}),"navigate"),cause:preload2?"preload":cause,route}},"getLoaderContext"),age=Date.now()-this.getMatch(matchId).updatedAt,preload=resolvePreload(matchId),staleAge=preload?route.options.preloadStaleTime??this.options.defaultPreloadStaleTime??3e4:route.options.staleTime??this.options.defaultStaleTime??0,shouldReloadOption=route.options.shouldReload,shouldReload=typeof shouldReloadOption=="function"?shouldReloadOption(getLoaderContext()):shouldReloadOption;updateMatch(matchId,prev=>({...prev,loaderPromise:createControlledPromise(),preload:!!preload&&!this.state.matches.find(d=>d.id===matchId)}));const runLoader=__name(async()=>{var _a2,_b2,_c2,_d2,_e,_f,_g,_h,_i,_j,_k;try{const potentialPendingMinPromise=__name(async()=>{const latestMatch=this.getMatch(matchId);latestMatch.minPendingPromise&&await latestMatch.minPendingPromise},"potentialPendingMinPromise");try{this.loadRouteChunk(route),updateMatch(matchId,prev=>({...prev,isFetching:"loader"}));const loaderData=await((_b2=(_a2=route.options).loader)==null?void 0:_b2.call(_a2,getLoaderContext()));handleRedirectAndNotFound(this.getMatch(matchId),loaderData),await route._lazyPromise,await potentialPendingMinPromise();const assetContext={matches,match:this.getMatch(matchId),params:this.getMatch(matchId).params,loaderData},headFnContent=(_d2=(_c2=route.options).head)==null?void 0:_d2.call(_c2,assetContext),meta=headFnContent==null?void 0:headFnContent.meta,links=headFnContent==null?void 0:headFnContent.links,headScripts=headFnContent==null?void 0:headFnContent.scripts,scripts=(_f=(_e=route.options).scripts)==null?void 0:_f.call(_e,assetContext),headers=(_h=(_g=route.options).headers)==null?void 0:_h.call(_g,{loaderData});await route._componentsPromise,updateMatch(matchId,prev=>({...prev,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),loaderData,meta,links,headScripts,headers,scripts}))}catch(e){let error=e;await potentialPendingMinPromise(),handleRedirectAndNotFound(this.getMatch(matchId),e);try{(_j=(_i=route.options).onError)==null||_j.call(_i,e)}catch(onErrorError){error=onErrorError,handleRedirectAndNotFound(this.getMatch(matchId),onErrorError)}updateMatch(matchId,prev=>({...prev,error,status:"error",isFetching:!1}))}(_k=this.serverSsr)==null||_k.onMatchSettled({router:this,match:this.getMatch(matchId)})}catch(err){updateMatch(matchId,prev=>({...prev,loaderPromise:void 0})),handleRedirectAndNotFound(this.getMatch(matchId),err)}},"runLoader"),{status,invalid}=this.getMatch(matchId);loaderShouldRunAsync=status==="success"&&(invalid||(shouldReload??age>staleAge)),preload&&route.options.preload===!1||(loaderShouldRunAsync&&!sync?(loaderIsRunningAsync=!0,(async()=>{try{await runLoader();const{loaderPromise,loadPromise}=this.getMatch(matchId);loaderPromise==null||loaderPromise.resolve(),loadPromise==null||loadPromise.resolve(),updateMatch(matchId,prev=>({...prev,loaderPromise:void 0}))}catch(err){isResolvedRedirect(err)&&await this.navigate(err)}})()):(status!=="success"||loaderShouldRunAsync&&sync)&&await runLoader())}if(!loaderIsRunningAsync){const{loaderPromise,loadPromise}=this.getMatch(matchId);loaderPromise==null||loaderPromise.resolve(),loadPromise==null||loadPromise.resolve()}return updateMatch(matchId,prev=>({...prev,isFetching:loaderIsRunningAsync?prev.isFetching:!1,loaderPromise:loaderIsRunningAsync?prev.loaderPromise:void 0,invalid:!1})),this.getMatch(matchId)})())}),await Promise.all(matchPromises),resolveAll()}catch(err){rejectAll(err)}})()}),await triggerOnReady()}catch(err){if(isRedirect(err)||isNotFound(err))throw isNotFound(err)&&!allPreload&&await triggerOnReady(),err}return matches},this.invalidate=opts=>{const invalidate=__name(d=>{var _a;return((_a=opts==null?void 0:opts.filter)==null?void 0:_a.call(opts,d))??!0?{...d,invalid:!0,...d.status==="error"?{status:"pending",error:void 0}:{}}:d},"invalidate");return this.__store.setState(s=>{var _a;return{...s,matches:s.matches.map(invalidate),cachedMatches:s.cachedMatches.map(invalidate),pendingMatches:(_a=s.pendingMatches)==null?void 0:_a.map(invalidate)}}),this.load({sync:opts==null?void 0:opts.sync})},this.resolveRedirect=err=>{const redirect2=err;return redirect2.href||(redirect2.href=this.buildLocation(redirect2).href),redirect2},this.clearCache=opts=>{const filter=opts==null?void 0:opts.filter;filter!==void 0?this.__store.setState(s=>({...s,cachedMatches:s.cachedMatches.filter(m=>!filter(m))})):this.__store.setState(s=>({...s,cachedMatches:[]}))},this.clearExpiredCache=()=>{const filter=__name(d=>{const route=this.looseRoutesById[d.routeId];if(!route.options.loader)return!0;const gcTime=(d.preload?route.options.preloadGcTime??this.options.defaultPreloadGcTime:route.options.gcTime??this.options.defaultGcTime)??5*60*1e3;return!(d.status!=="error"&&Date.now()-d.updatedAt<gcTime)},"filter");this.clearCache({filter})},this.loadRouteChunk=route=>(route._lazyPromise===void 0&&(route.lazyFn?route._lazyPromise=route.lazyFn().then(lazyRoute=>{const{id:_id,...options2}=lazyRoute.options;Object.assign(route.options,options2)}):route._lazyPromise=Promise.resolve()),route._componentsPromise===void 0&&(route._componentsPromise=route._lazyPromise.then(()=>Promise.all(componentTypes.map(async type=>{const component=route.options[type];component!=null&&component.preload&&await component.preload()})))),route._componentsPromise),this.preloadRoute=async opts=>{const next=this.buildLocation(opts);let matches=this.matchRoutes(next,{throwOnError:!0,preload:!0,dest:opts});const activeMatchIds=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(d=>d.id)),loadedMatchIds=new Set([...activeMatchIds,...this.state.cachedMatches.map(d=>d.id)]);batch(()=>{matches.forEach(match=>{loadedMatchIds.has(match.id)||this.__store.setState(s=>({...s,cachedMatches:[...s.cachedMatches,match]}))})});try{return matches=await this.loadMatches({matches,location:next,preload:!0,updateMatch:__name((id,updater)=>{activeMatchIds.has(id)?matches=matches.map(d=>d.id===id?updater(d):d):this.updateMatch(id,updater)},"updateMatch")}),matches}catch(err){if(isRedirect(err))return err.reloadDocument?void 0:await this.preloadRoute({...err,_fromLocation:next});isNotFound(err)||console.error(err);return}},this.matchRoute=(location,opts)=>{const matchLocation={...location,to:location.to?this.resolvePathWithBase(location.from||"",location.to):void 0,params:location.params||{},leaveParams:!0},next=this.buildLocation(matchLocation);if(opts!=null&&opts.pending&&this.state.status!=="pending")return!1;const baseLocation=((opts==null?void 0:opts.pending)===void 0?!this.state.isLoading:opts.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,match=matchPathname(this.basepath,baseLocation.pathname,{...opts,to:next.pathname});return!match||location.params&&!deepEqual(match,location.params,{partial:!0})?!1:match&&((opts==null?void 0:opts.includeSearch)??!0)?deepEqual(baseLocation.search,next.search,{partial:!0})?match:!1:match},this._handleNotFound=(matches,err,{updateMatch=this.updateMatch}={})=>{var _a;const routeCursor=this.routesById[err.routeId??""]??this.routeTree,matchesByRouteId={};for(const match of matches)matchesByRouteId[match.routeId]=match;!routeCursor.options.notFoundComponent&&((_a=this.options)!=null&&_a.defaultNotFoundComponent)&&(routeCursor.options.notFoundComponent=this.options.defaultNotFoundComponent),invariant(routeCursor.options.notFoundComponent);const matchForRoute=matchesByRouteId[routeCursor.id];invariant(matchForRoute,"Could not find match for route: "+routeCursor.id),updateMatch(matchForRoute.id,prev=>({...prev,status:"notFound",error:err,isFetching:!1})),err.routerCode==="BEFORE_LOAD"&&routeCursor.parentRoute&&(err.routeId=routeCursor.parentRoute.id,this._handleNotFound(matches,err,{updateMatch}))},this.hasNotFoundMatch=()=>this.__store.state.matches.some(d=>d.status==="notFound"||d.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...options,caseSensitive:options.caseSensitive??!1,notFoundMode:options.notFoundMode??"fuzzy",stringifySearch:options.stringifySearch??defaultStringifySearch,parseSearch:options.parseSearch??defaultParseSearch}),typeof document<"u"&&(window.__TSR_ROUTER__=this)}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(next,opts){const{foundRoute,matchedRoutes,routeParams}=this.getMatchedRoutes(next,opts==null?void 0:opts.dest);let isGlobalNotFound=!1;(foundRoute?foundRoute.path!=="/"&&routeParams["**"]:trimPathRight(next.pathname))&&(this.options.notFoundRoute?matchedRoutes.push(this.options.notFoundRoute):isGlobalNotFound=!0);const globalNotFoundRouteId=(()=>{if(isGlobalNotFound){if(this.options.notFoundMode!=="root")for(let i=matchedRoutes.length-1;i>=0;i--){const route=matchedRoutes[i];if(route.children)return route.id}return rootRouteId}})(),parseErrors=matchedRoutes.map(route=>{var _a;let parsedParamsError;const parseParams=((_a=route.options.params)==null?void 0:_a.parse)??route.options.parseParams;if(parseParams)try{const parsedParams=parseParams(routeParams);Object.assign(routeParams,parsedParams)}catch(err){if(parsedParamsError=new PathParamError(err.message,{cause:err}),opts!=null&&opts.throwOnError)throw parsedParamsError;return parsedParamsError}}),matches=[],getParentContext=__name(parentMatch=>(parentMatch==null?void 0:parentMatch.id)?parentMatch.context??this.options.context??{}:this.options.context??{},"getParentContext");return matchedRoutes.forEach((route,index)=>{var _a,_b;const parentMatch=matches[index-1],[preMatchSearch,strictMatchSearch,searchError]=(()=>{const parentSearch=(parentMatch==null?void 0:parentMatch.search)??next.search,parentStrictSearch=(parentMatch==null?void 0:parentMatch._strictSearch)??{};try{const strictSearch=validateSearch(route.options.validateSearch,{...parentSearch})??{};return[{...parentSearch,...strictSearch},{...parentStrictSearch,...strictSearch},void 0]}catch(err){let searchParamError=err;if(err instanceof SearchParamError||(searchParamError=new SearchParamError(err.message,{cause:err})),opts!=null&&opts.throwOnError)throw searchParamError;return[parentSearch,{},searchParamError]}})(),loaderDeps=((_b=(_a=route.options).loaderDeps)==null?void 0:_b.call(_a,{search:preMatchSearch}))??"",loaderDepsHash=loaderDeps?JSON.stringify(loaderDeps):"",{usedParams,interpolatedPath}=interpolatePath({path:route.fullPath,params:routeParams,decodeCharMap:this.pathParamsDecodeCharMap}),matchId=interpolatePath({path:route.id,params:routeParams,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath+loaderDepsHash,existingMatch=this.getMatch(matchId),previousMatch=this.state.matches.find(d=>d.routeId===route.id),cause=previousMatch?"stay":"enter";let match;if(existingMatch)match={...existingMatch,cause,params:previousMatch?replaceEqualDeep(previousMatch.params,routeParams):routeParams,_strictParams:usedParams,search:replaceEqualDeep(previousMatch?previousMatch.search:existingMatch.search,preMatchSearch),_strictSearch:strictMatchSearch};else{const status=route.options.loader||route.options.beforeLoad||route.lazyFn||routeNeedsPreload(route)?"pending":"success";match={id:matchId,index,routeId:route.id,params:previousMatch?replaceEqualDeep(previousMatch.params,routeParams):routeParams,_strictParams:usedParams,pathname:joinPaths([this.basepath,interpolatedPath]),updatedAt:Date.now(),search:previousMatch?replaceEqualDeep(previousMatch.search,preMatchSearch):preMatchSearch,_strictSearch:strictMatchSearch,searchError:void 0,status,isFetching:!1,error:void 0,paramsError:parseErrors[index],__routeContext:{},__beforeLoadContext:{},context:{},abortController:new AbortController,fetchCount:0,cause,loaderDeps:previousMatch?replaceEqualDeep(previousMatch.loaderDeps,loaderDeps):loaderDeps,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:route.options.staticData||{},loadPromise:createControlledPromise(),fullPath:route.fullPath}}opts!=null&&opts.preload||(match.globalNotFound=globalNotFoundRouteId===route.id),match.searchError=searchError;const parentContext=getParentContext(parentMatch);match.context={...parentContext,...match.__routeContext,...match.__beforeLoadContext},matches.push(match)}),matches.forEach((match,index)=>{var _a,_b,_c,_d,_e,_f,_g,_h;const route=this.looseRoutesById[match.routeId];if(!this.getMatch(match.id)&&(opts==null?void 0:opts._buildLocation)!==!0){const parentMatch=matches[index-1],parentContext=getParentContext(parentMatch),contextFnContext={deps:match.loaderDeps,params:match.params,context:parentContext,location:next,navigate:__name(opts2=>this.navigate({...opts2,_fromLocation:next}),"navigate"),buildLocation:this.buildLocation,cause:match.cause,abortController:match.abortController,preload:!!match.preload,matches};match.__routeContext=((_b=(_a=route.options).context)==null?void 0:_b.call(_a,contextFnContext))??{},match.context={...parentContext,...match.__routeContext,...match.__beforeLoadContext}}if(match.status==="success"){match.headers=(_d=(_c=route.options).headers)==null?void 0:_d.call(_c,{loaderData:match.loaderData});const assetContext={matches,match,params:match.params,loaderData:match.loaderData},headFnContent=(_f=(_e=route.options).head)==null?void 0:_f.call(_e,assetContext);match.links=headFnContent==null?void 0:headFnContent.links,match.headScripts=headFnContent==null?void 0:headFnContent.scripts,match.meta=headFnContent==null?void 0:headFnContent.meta,match.scripts=(_h=(_g=route.options).scripts)==null?void 0:_h.call(_g,assetContext)}}),matches}};__name(_RouterCore,"RouterCore");let RouterCore=_RouterCore;const _SearchParamError=class _SearchParamError extends Error{};__name(_SearchParamError,"SearchParamError");let SearchParamError=_SearchParamError;const _PathParamError=class _PathParamError extends Error{};__name(_PathParamError,"PathParamError");let PathParamError=_PathParamError;function getInitialRouterState(location){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}__name(getInitialRouterState,"getInitialRouterState");function validateSearch(validateSearch2,input){if(validateSearch2==null)return{};if("~standard"in validateSearch2){const result=validateSearch2["~standard"].validate(input);if(result instanceof Promise)throw new SearchParamError("Async validation not supported");if(result.issues)throw new SearchParamError(JSON.stringify(result.issues,void 0,2),{cause:result});return result.value}return"parse"in validateSearch2?validateSearch2.parse(input):typeof validateSearch2=="function"?validateSearch2(input):{}}__name(validateSearch,"validateSearch");const componentTypes=["component","errorComponent","pendingComponent","notFoundComponent"];function routeNeedsPreload(route){var _a;for(const componentType of componentTypes)if((_a=route.options[componentType])!=null&&_a.preload)return!0;return!1}__name(routeNeedsPreload,"routeNeedsPreload");const preloadWarning="Error preloading route! ",_BaseRoute=class _BaseRoute{constructor(options){if(this.init=opts=>{var _a,_b;this.originalIndex=opts.originalIndex;const options2=this.options,isRoot=!(options2!=null&&options2.path)&&!(options2!=null&&options2.id);if(this.parentRoute=(_b=(_a=this.options).getParentRoute)==null?void 0:_b.call(_a),isRoot)this._path=rootRouteId;else if(!this.parentRoute)throw new Error("Child Route instances must pass a 'getParentRoute: () => ParentRoute' option that returns a Route instance.");let path=isRoot?rootRouteId:options2==null?void 0:options2.path;path&&path!=="/"&&(path=trimPathLeft(path));const customId=(options2==null?void 0:options2.id)||path;let id=isRoot?rootRouteId:joinPaths([this.parentRoute.id===rootRouteId?"":this.parentRoute.id,customId]);path===rootRouteId&&(path="/"),id!==rootRouteId&&(id=joinPaths(["/",id]));const fullPath=id===rootRouteId?"/":joinPaths([this.parentRoute.fullPath,path]);this._path=path,this._id=id,this._fullPath=fullPath,this._to=fullPath,this._ssr=(options2==null?void 0:options2.ssr)??opts.defaultSsr??!0},this.addChildren=children=>this._addFileChildren(children),this._addFileChildren=children=>(Array.isArray(children)&&(this.children=children),typeof children=="object"&&children!==null&&(this.children=Object.values(children)),this),this._addFileTypes=()=>this,this.updateLoader=options2=>(Object.assign(this.options,options2),this),this.update=options2=>(Object.assign(this.options,options2),this),this.lazy=lazyFn=>(this.lazyFn=lazyFn,this),this.options=options||{},this.isRoot=!(options!=null&&options.getParentRoute),options!=null&&options.id&&(options!=null&&options.path))throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}get ssr(){return this._ssr}};__name(_BaseRoute,"BaseRoute");let BaseRoute=_BaseRoute;const _BaseRootRoute=class _BaseRootRoute extends BaseRoute{constructor(options){super(options)}};__name(_BaseRootRoute,"BaseRootRoute");let BaseRootRoute=_BaseRootRoute;function CatchBoundary(props){const errorComponent=props.errorComponent??ErrorComponent;return jsxRuntimeExports.jsx(CatchBoundaryImpl,{getResetKey:props.getResetKey,onCatch:props.onCatch,children:__name(({error,reset})=>error?reactExports.createElement(errorComponent,{error,reset}):props.children,"children")})}__name(CatchBoundary,"CatchBoundary");const _CatchBoundaryImpl=class _CatchBoundaryImpl extends reactExports.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(props){return{resetKey:props.getResetKey()}}static getDerivedStateFromError(error){return{error}}reset(){this.setState({error:null})}componentDidUpdate(prevProps,prevState){prevState.error&&prevState.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(error,errorInfo){this.props.onCatch&&this.props.onCatch(error,errorInfo)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:__name(()=>{this.reset()},"reset")})}};__name(_CatchBoundaryImpl,"CatchBoundaryImpl");let CatchBoundaryImpl=_CatchBoundaryImpl;function ErrorComponent({error}){const[show,setShow]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[jsxRuntimeExports.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),jsxRuntimeExports.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:__name(()=>setShow(d=>!d),"onClick"),children:show?"Hide Error":"Show Error"})]}),jsxRuntimeExports.jsx("div",{style:{height:".25rem"}}),show?jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:error.message?jsxRuntimeExports.jsx("code",{children:error.message}):null})}):null]})}__name(ErrorComponent,"ErrorComponent");function useStore(store,selector=d=>d){return withSelectorExports.useSyncExternalStoreWithSelector(store.subscribe,()=>store.state,()=>store.state,selector,shallow$1)}__name(useStore,"useStore");function shallow$1(objA,objB){if(Object.is(objA,objB))return!0;if(typeof objA!="object"||objA===null||typeof objB!="object"||objB===null)return!1;if(objA instanceof Map&&objB instanceof Map){if(objA.size!==objB.size)return!1;for(const[k,v]of objA)if(!objB.has(k)||!Object.is(v,objB.get(k)))return!1;return!0}if(objA instanceof Set&&objB instanceof Set){if(objA.size!==objB.size)return!1;for(const v of objA)if(!objB.has(v))return!1;return!0}const keysA=Object.keys(objA);if(keysA.length!==Object.keys(objB).length)return!1;for(let i=0;i<keysA.length;i++)if(!Object.prototype.hasOwnProperty.call(objB,keysA[i])||!Object.is(objA[keysA[i]],objB[keysA[i]]))return!1;return!0}__name(shallow$1,"shallow$1");const routerContext=reactExports.createContext(null);function getRouterContext(){return typeof document>"u"?routerContext:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=routerContext,routerContext)}__name(getRouterContext,"getRouterContext");function useRouter(opts){const value=reactExports.useContext(getRouterContext());return warning(!(((opts==null?void 0:opts.warn)??!0)&&!value)),value}__name(useRouter,"useRouter");function useRouterState(opts){const contextRouter=useRouter({warn:(opts==null?void 0:opts.router)===void 0}),router=(opts==null?void 0:opts.router)||contextRouter,previousResult=reactExports.useRef(void 0);return useStore(router.__store,state=>{if(opts!=null&&opts.select){if(opts.structuralSharing??router.options.defaultStructuralSharing){const newSlice=replaceEqualDeep(previousResult.current,opts.select(state));return previousResult.current=newSlice,newSlice}return opts.select(state)}return state})}__name(useRouterState,"useRouterState");const matchContext=reactExports.createContext(void 0),dummyMatchContext=reactExports.createContext(void 0);function useMatch(opts){const nearestMatchId=reactExports.useContext(opts.from?dummyMatchContext:matchContext);return useRouterState({select:__name(state=>{const match=state.matches.find(d=>opts.from?opts.from===d.routeId:d.id===nearestMatchId);if(invariant(!((opts.shouldThrow??!0)&&!match),`Could not find ${opts.from?`an active match from "${opts.from}"`:"a nearest match!"}`),match!==void 0)return opts.select?opts.select(match):match},"select"),structuralSharing:opts.structuralSharing})}__name(useMatch,"useMatch");function useLoaderData(opts){return useMatch({from:opts.from,strict:opts.strict,structuralSharing:opts.structuralSharing,select:__name(s=>opts.select?opts.select(s.loaderData):s.loaderData,"select")})}__name(useLoaderData,"useLoaderData");function useLoaderDeps(opts){const{select,...rest}=opts;return useMatch({...rest,select:__name(s=>select?select(s.loaderDeps):s.loaderDeps,"select")})}__name(useLoaderDeps,"useLoaderDeps");function useParams(opts){return useMatch({from:opts.from,strict:opts.strict,shouldThrow:opts.shouldThrow,structuralSharing:opts.structuralSharing,select:__name(match=>opts.select?opts.select(match.params):match.params,"select")})}__name(useParams,"useParams");function useSearch(opts){return useMatch({from:opts.from,strict:opts.strict,shouldThrow:opts.shouldThrow,structuralSharing:opts.structuralSharing,select:__name(match=>opts.select?opts.select(match.search):match.search,"select")})}__name(useSearch,"useSearch");function useNavigate(_defaultOpts){const{navigate}=useRouter();return reactExports.useCallback(options=>navigate({from:_defaultOpts==null?void 0:_defaultOpts.from,...options}),[_defaultOpts==null?void 0:_defaultOpts.from,navigate])}__name(useNavigate,"useNavigate");const _Route=class _Route extends BaseRoute{constructor(options){super(options),this.useMatch=opts=>useMatch({select:opts==null?void 0:opts.select,from:this.id,structuralSharing:opts==null?void 0:opts.structuralSharing}),this.useRouteContext=opts=>useMatch({...opts,from:this.id,select:__name(d=>opts!=null&&opts.select?opts.select(d.context):d.context,"select")}),this.useSearch=opts=>useSearch({select:opts==null?void 0:opts.select,structuralSharing:opts==null?void 0:opts.structuralSharing,from:this.id}),this.useParams=opts=>useParams({select:opts==null?void 0:opts.select,structuralSharing:opts==null?void 0:opts.structuralSharing,from:this.id}),this.useLoaderDeps=opts=>useLoaderDeps({...opts,from:this.id}),this.useLoaderData=opts=>useLoaderData({...opts,from:this.id}),this.useNavigate=()=>useNavigate({from:this.fullPath}),this.$$typeof=Symbol.for("react.memo")}};__name(_Route,"Route");let Route=_Route;function createRoute(options){return new Route(options)}__name(createRoute,"createRoute");const _RootRoute=class _RootRoute extends BaseRootRoute{constructor(options){super(options),this.useMatch=opts=>useMatch({select:opts==null?void 0:opts.select,from:this.id,structuralSharing:opts==null?void 0:opts.structuralSharing}),this.useRouteContext=opts=>useMatch({...opts,from:this.id,select:__name(d=>opts!=null&&opts.select?opts.select(d.context):d.context,"select")}),this.useSearch=opts=>useSearch({select:opts==null?void 0:opts.select,structuralSharing:opts==null?void 0:opts.structuralSharing,from:this.id}),this.useParams=opts=>useParams({select:opts==null?void 0:opts.select,structuralSharing:opts==null?void 0:opts.structuralSharing,from:this.id}),this.useLoaderDeps=opts=>useLoaderDeps({...opts,from:this.id}),this.useLoaderData=opts=>useLoaderData({...opts,from:this.id}),this.useNavigate=()=>useNavigate({from:this.fullPath}),this.$$typeof=Symbol.for("react.memo")}};__name(_RootRoute,"RootRoute");let RootRoute=_RootRoute;function createRootRoute(options){return new RootRoute(options)}__name(createRootRoute,"createRootRoute");function CatchNotFound(props){const resetKey=useRouterState({select:__name(s=>`not-found-${s.location.pathname}-${s.status}`,"select")});return jsxRuntimeExports.jsx(CatchBoundary,{getResetKey:__name(()=>resetKey,"getResetKey"),onCatch:__name((error,errorInfo)=>{var _a;if(isNotFound(error))(_a=props.onCatch)==null||_a.call(props,error,errorInfo);else throw error},"onCatch"),errorComponent:__name(({error})=>{var _a;if(isNotFound(error))return(_a=props.fallback)==null?void 0:_a.call(props,error);throw error},"errorComponent"),children:props.children})}__name(CatchNotFound,"CatchNotFound");function DefaultGlobalNotFound(){return jsxRuntimeExports.jsx("p",{children:"Not Found"})}__name(DefaultGlobalNotFound,"DefaultGlobalNotFound");function SafeFragment(props){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:props.children})}__name(SafeFragment,"SafeFragment");function renderRouteNotFound(router,route,data){return route.options.notFoundComponent?jsxRuntimeExports.jsx(route.options.notFoundComponent,{data}):router.options.defaultNotFoundComponent?jsxRuntimeExports.jsx(router.options.defaultNotFoundComponent,{data}):jsxRuntimeExports.jsx(DefaultGlobalNotFound,{})}__name(renderRouteNotFound,"renderRouteNotFound");function ScriptOnce({children,log}){return typeof document<"u"?null:jsxRuntimeExports.jsx("script",{className:"tsr-once",dangerouslySetInnerHTML:{__html:[children,"",'if (typeof __TSR_SSR__ !== "undefined") __TSR_SSR__.cleanScripts()'].filter(Boolean).join(`
`)}})}__name(ScriptOnce,"ScriptOnce");function ScrollRestoration(){const router=useRouter(),userKey=(router.options.getScrollRestorationKey||defaultGetScrollRestorationKey)(router.latestLocation),resolvedKey=userKey!==defaultGetScrollRestorationKey(router.latestLocation)?userKey:null;return!router.isScrollRestoring||!router.isServer?null:jsxRuntimeExports.jsx(ScriptOnce,{children:`(${restoreScroll.toString()})(${JSON.stringify(storageKey)},${JSON.stringify(resolvedKey)}, undefined, true)`,log:!1})}__name(ScrollRestoration,"ScrollRestoration");const Match=reactExports.memo(__name(function({matchId}){var _a,_b;const router=useRouter(),routeId=useRouterState({select:__name(s=>{var _a2;return(_a2=s.matches.find(d=>d.id===matchId))==null?void 0:_a2.routeId},"select")});invariant(routeId);const route=router.routesById[routeId],PendingComponent=route.options.pendingComponent??router.options.defaultPendingComponent,pendingElement=PendingComponent?jsxRuntimeExports.jsx(PendingComponent,{}):null,routeErrorComponent=route.options.errorComponent??router.options.defaultErrorComponent,routeOnCatch=route.options.onCatch??router.options.defaultOnCatch,routeNotFoundComponent=route.isRoot?route.options.notFoundComponent??((_a=router.options.notFoundRoute)==null?void 0:_a.options.component):route.options.notFoundComponent,ResolvedSuspenseBoundary=(!route.isRoot||route.options.wrapInSuspense)&&(route.options.wrapInSuspense??PendingComponent??((_b=route.options.errorComponent)==null?void 0:_b.preload))?reactExports.Suspense:SafeFragment,ResolvedCatchBoundary=routeErrorComponent?CatchBoundary:SafeFragment,ResolvedNotFoundBoundary=routeNotFoundComponent?CatchNotFound:SafeFragment,resetKey=useRouterState({select:__name(s=>s.loadedAt,"select")}),parentRouteId=useRouterState({select:__name(s=>{var _a2;const index=s.matches.findIndex(d=>d.id===matchId);return(_a2=s.matches[index-1])==null?void 0:_a2.routeId},"select")});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(matchContext.Provider,{value:matchId,children:jsxRuntimeExports.jsx(ResolvedSuspenseBoundary,{fallback:pendingElement,children:jsxRuntimeExports.jsx(ResolvedCatchBoundary,{getResetKey:__name(()=>resetKey,"getResetKey"),errorComponent:routeErrorComponent||ErrorComponent,onCatch:__name((error,errorInfo)=>{if(isNotFound(error))throw error;routeOnCatch==null||routeOnCatch(error,errorInfo)},"onCatch"),children:jsxRuntimeExports.jsx(ResolvedNotFoundBoundary,{fallback:__name(error=>{if(!routeNotFoundComponent||error.routeId&&error.routeId!==routeId||!error.routeId&&!route.isRoot)throw error;return reactExports.createElement(routeNotFoundComponent,error)},"fallback"),children:jsxRuntimeExports.jsx(MatchInner,{matchId})})})})}),parentRouteId===rootRouteId&&router.options.scrollRestoration?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(OnRendered,{}),jsxRuntimeExports.jsx(ScrollRestoration,{})]}):null]})},"MatchImpl"));function OnRendered(){const router=useRouter(),prevLocationRef=reactExports.useRef(void 0);return jsxRuntimeExports.jsx("script",{suppressHydrationWarning:!0,ref:__name(el=>{el&&(prevLocationRef.current===void 0||prevLocationRef.current.href!==router.latestLocation.href)&&(router.emit({type:"onRendered",...getLocationChangeInfo(router.state)}),prevLocationRef.current=router.latestLocation)},"ref")},router.latestLocation.state.key)}__name(OnRendered,"OnRendered");const MatchInner=reactExports.memo(__name(function({matchId}){var _a,_b,_c;const router=useRouter(),{match,key,routeId}=useRouterState({select:__name(s=>{const matchIndex=s.matches.findIndex(d=>d.id===matchId),match2=s.matches[matchIndex],routeId2=match2.routeId,remountFn=router.routesById[routeId2].options.remountDeps??router.options.defaultRemountDeps,remountDeps=remountFn==null?void 0:remountFn({routeId:routeId2,loaderDeps:match2.loaderDeps,params:match2._strictParams,search:match2._strictSearch});return{key:remountDeps?JSON.stringify(remountDeps):void 0,routeId:routeId2,match:pick(match2,["id","status","error"])}},"select"),structuralSharing:!0}),route=router.routesById[routeId],out=reactExports.useMemo(()=>{const Comp=route.options.component??router.options.defaultComponent;return Comp?jsxRuntimeExports.jsx(Comp,{},key):jsxRuntimeExports.jsx(Outlet,{})},[key,route.options.component,router.options.defaultComponent]),RouteErrorComponent=(route.options.errorComponent??router.options.defaultErrorComponent)||ErrorComponent;if(match.status==="notFound")return invariant(isNotFound(match.error)),renderRouteNotFound(router,route,match.error);if(match.status==="redirected")throw invariant(isRedirect(match.error)),(_a=router.getMatch(match.id))==null?void 0:_a.loadPromise;if(match.status==="error"){if(router.isServer)return jsxRuntimeExports.jsx(RouteErrorComponent,{error:match.error,reset:void 0,info:{componentStack:""}});throw match.error}if(match.status==="pending"){const pendingMinMs=route.options.pendingMinMs??router.options.defaultPendingMinMs;if(pendingMinMs&&!((_b=router.getMatch(match.id))!=null&&_b.minPendingPromise)&&!router.isServer){const minPendingPromise=createControlledPromise();Promise.resolve().then(()=>{router.updateMatch(match.id,prev=>({...prev,minPendingPromise}))}),setTimeout(()=>{minPendingPromise.resolve(),router.updateMatch(match.id,prev=>({...prev,minPendingPromise:void 0}))},pendingMinMs)}throw(_c=router.getMatch(match.id))==null?void 0:_c.loadPromise}return out},"MatchInnerImpl")),Outlet=reactExports.memo(__name(function(){const router=useRouter(),matchId=reactExports.useContext(matchContext),routeId=useRouterState({select:__name(s=>{var _a;return(_a=s.matches.find(d=>d.id===matchId))==null?void 0:_a.routeId},"select")}),route=router.routesById[routeId],parentGlobalNotFound=useRouterState({select:__name(s=>{const parentMatch=s.matches.find(d=>d.id===matchId);return invariant(parentMatch),parentMatch.globalNotFound},"select")}),childMatchId=useRouterState({select:__name(s=>{var _a;const matches=s.matches,index=matches.findIndex(d=>d.id===matchId);return(_a=matches[index+1])==null?void 0:_a.id},"select")});if(parentGlobalNotFound)return renderRouteNotFound(router,route,void 0);if(!childMatchId)return null;const nextMatch=jsxRuntimeExports.jsx(Match,{matchId:childMatchId}),pendingElement=router.options.defaultPendingComponent?jsxRuntimeExports.jsx(router.options.defaultPendingComponent,{}):null;return matchId===rootRouteId?jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:pendingElement,children:nextMatch}):nextMatch},"OutletImpl")),useLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function usePrevious(value){const ref=reactExports.useRef({value,prev:null}),current=ref.current.value;return value!==current&&(ref.current={value,prev:current}),ref.current.prev}__name(usePrevious,"usePrevious");function useIntersectionObserver(ref,callback,intersectionObserverOptions={},options={}){const isIntersectionObserverAvailable=reactExports.useRef(typeof IntersectionObserver=="function"),observerRef=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!(!ref.current||!isIntersectionObserverAvailable.current||options.disabled))return observerRef.current=new IntersectionObserver(([entry])=>{callback(entry)},intersectionObserverOptions),observerRef.current.observe(ref.current),()=>{var _a;(_a=observerRef.current)==null||_a.disconnect()}},[callback,intersectionObserverOptions,options.disabled,ref]),observerRef.current}__name(useIntersectionObserver,"useIntersectionObserver");function useForwardedRef(ref){const innerRef=reactExports.useRef(null);return reactExports.useImperativeHandle(ref,()=>innerRef.current,[]),innerRef}__name(useForwardedRef,"useForwardedRef");function Transitioner(){const router=useRouter(),mountLoadForRouter=reactExports.useRef({router,mounted:!1}),isLoading=useRouterState({select:__name(({isLoading:isLoading2})=>isLoading2,"select")}),[isTransitioning,setIsTransitioning]=reactExports.useState(!1),hasPendingMatches=useRouterState({select:__name(s=>s.matches.some(d=>d.status==="pending"),"select"),structuralSharing:!0}),previousIsLoading=usePrevious(isLoading),isAnyPending=isLoading||isTransitioning||hasPendingMatches,previousIsAnyPending=usePrevious(isAnyPending),isPagePending=isLoading||hasPendingMatches,previousIsPagePending=usePrevious(isPagePending);return router.isServer||(router.startTransition=fn=>{setIsTransitioning(!0),reactExports.startTransition(()=>{fn(),setIsTransitioning(!1)})}),reactExports.useEffect(()=>{const unsub=router.history.subscribe(router.load),nextLocation=router.buildLocation({to:router.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return trimPathRight(router.latestLocation.href)!==trimPathRight(nextLocation.href)&&router.commitLocation({...nextLocation,replace:!0}),()=>{unsub()}},[router,router.history]),useLayoutEffect(()=>{if(typeof window<"u"&&router.clientSsr||mountLoadForRouter.current.router===router&&mountLoadForRouter.current.mounted)return;mountLoadForRouter.current={router,mounted:!0},__name(async()=>{try{await router.load()}catch(err){console.error(err)}},"tryLoad")()},[router]),useLayoutEffect(()=>{previousIsLoading&&!isLoading&&router.emit({type:"onLoad",...getLocationChangeInfo(router.state)})},[previousIsLoading,router,isLoading]),useLayoutEffect(()=>{previousIsPagePending&&!isPagePending&&router.emit({type:"onBeforeRouteMount",...getLocationChangeInfo(router.state)})},[isPagePending,previousIsPagePending,router]),useLayoutEffect(()=>{previousIsAnyPending&&!isAnyPending&&(router.emit({type:"onResolved",...getLocationChangeInfo(router.state)}),router.__store.setState(s=>({...s,status:"idle",resolvedLocation:s.location})),handleHashScroll(router))},[isAnyPending,previousIsAnyPending,router]),null}__name(Transitioner,"Transitioner");function Matches(){const router=useRouter(),pendingElement=router.options.defaultPendingComponent?jsxRuntimeExports.jsx(router.options.defaultPendingComponent,{}):null,ResolvedSuspense=router.isServer||typeof document<"u"&&router.clientSsr?SafeFragment:reactExports.Suspense,inner=jsxRuntimeExports.jsxs(ResolvedSuspense,{fallback:pendingElement,children:[jsxRuntimeExports.jsx(Transitioner,{}),jsxRuntimeExports.jsx(MatchesInner,{})]});return router.options.InnerWrap?jsxRuntimeExports.jsx(router.options.InnerWrap,{children:inner}):inner}__name(Matches,"Matches");function MatchesInner(){const matchId=useRouterState({select:__name(s=>{var _a;return(_a=s.matches[0])==null?void 0:_a.id},"select")}),resetKey=useRouterState({select:__name(s=>s.loadedAt,"select")});return jsxRuntimeExports.jsx(matchContext.Provider,{value:matchId,children:jsxRuntimeExports.jsx(CatchBoundary,{getResetKey:__name(()=>resetKey,"getResetKey"),errorComponent:ErrorComponent,onCatch:__name(error=>{warning(!1,error.message||error.toString())},"onCatch"),children:matchId?jsxRuntimeExports.jsx(Match,{matchId}):null})})}__name(MatchesInner,"MatchesInner");function useMatches(opts){return useRouterState({select:__name(state=>{const matches=state.matches;return opts!=null&&opts.select?opts.select(matches):matches},"select"),structuralSharing:opts==null?void 0:opts.structuralSharing})}__name(useMatches,"useMatches");function useLinkProps(options,forwardedRef){const router=useRouter(),[isTransitioning,setIsTransitioning]=reactExports.useState(!1),hasRenderFetched=reactExports.useRef(!1),innerRef=useForwardedRef(forwardedRef),{activeProps=__name(()=>({className:"active"}),"activeProps"),inactiveProps=__name(()=>({}),"inactiveProps"),activeOptions,to,preload:userPreload,preloadDelay:userPreloadDelay,hashScrollIntoView,replace,startTransition,resetScroll,viewTransition,children,target,disabled,style,className,onClick,onFocus,onMouseEnter,onMouseLeave,onTouchStart,ignoreBlocker,...rest}=options,{params:_params,search:_search,hash:_hash,state:_state,mask:_mask,reloadDocument:_reloadDocument,...propsSafeToSpread}=rest,type=reactExports.useMemo(()=>{try{return new URL(`${to}`),"external"}catch{}return"internal"},[to]),currentSearch=useRouterState({select:__name(s=>s.location.search,"select"),structuralSharing:!0}),from=useMatches({select:__name(matches=>{var _a;return options.from??((_a=matches[matches.length-1])==null?void 0:_a.fullPath)},"select")}),_options=reactExports.useMemo(()=>({...options,from}),[options,from]),next=reactExports.useMemo(()=>router.buildLocation(_options),[router,_options,currentSearch]),preload=reactExports.useMemo(()=>_options.reloadDocument?!1:userPreload??router.options.defaultPreload,[router.options.defaultPreload,userPreload,_options.reloadDocument]),preloadDelay=userPreloadDelay??router.options.defaultPreloadDelay??0,isActive=useRouterState({select:__name(s=>{if(activeOptions!=null&&activeOptions.exact){if(!exactPathTest(s.location.pathname,next.pathname,router.basepath))return!1}else{const currentPathSplit=removeTrailingSlash(s.location.pathname,router.basepath).split("/");if(!removeTrailingSlash(next.pathname,router.basepath).split("/").every((d,i)=>d===currentPathSplit[i]))return!1}return((activeOptions==null?void 0:activeOptions.includeSearch)??!0)&&!deepEqual(s.location.search,next.search,{partial:!(activeOptions!=null&&activeOptions.exact),ignoreUndefined:!(activeOptions!=null&&activeOptions.explicitUndefined)})?!1:activeOptions!=null&&activeOptions.includeHash?s.location.hash===next.hash:!0},"select")}),doPreload=reactExports.useCallback(()=>{router.preloadRoute(_options).catch(err=>{console.warn(err),console.warn(preloadWarning)})},[_options,router]),preloadViewportIoCallback=reactExports.useCallback(entry=>{entry!=null&&entry.isIntersecting&&doPreload()},[doPreload]);if(useIntersectionObserver(innerRef,preloadViewportIoCallback,{rootMargin:"100px"},{disabled:!!disabled||preload!=="viewport"}),useLayoutEffect(()=>{hasRenderFetched.current||!disabled&&preload==="render"&&(doPreload(),hasRenderFetched.current=!0)},[disabled,doPreload,preload]),type==="external")return{...propsSafeToSpread,ref:innerRef,type,href:to,...children&&{children},...target&&{target},...disabled&&{disabled},...style&&{style},...className&&{className},...onClick&&{onClick},...onFocus&&{onFocus},...onMouseEnter&&{onMouseEnter},...onMouseLeave&&{onMouseLeave},...onTouchStart&&{onTouchStart}};const handleClick=__name(e=>{if(!disabled&&!isCtrlEvent(e)&&!e.defaultPrevented&&(!target||target==="_self")&&e.button===0){e.preventDefault(),reactDomExports.flushSync(()=>{setIsTransitioning(!0)});const unsub=router.subscribe("onResolved",()=>{unsub(),setIsTransitioning(!1)});return router.navigate({..._options,replace,resetScroll,hashScrollIntoView,startTransition,viewTransition,ignoreBlocker})}},"handleClick"),handleFocus=__name(_=>{disabled||preload&&doPreload()},"handleFocus"),handleTouchStart=handleFocus,handleEnter=__name(e=>{if(disabled)return;const eventTarget=e.target||{};if(preload){if(eventTarget.preloadTimeout)return;eventTarget.preloadTimeout=setTimeout(()=>{eventTarget.preloadTimeout=null,doPreload()},preloadDelay)}},"handleEnter"),handleLeave=__name(e=>{if(disabled)return;const eventTarget=e.target||{};eventTarget.preloadTimeout&&(clearTimeout(eventTarget.preloadTimeout),eventTarget.preloadTimeout=null)},"handleLeave"),composeHandlers=__name(handlers=>e=>{var _a;(_a=e.persist)==null||_a.call(e),handlers.filter(Boolean).forEach(handler=>{e.defaultPrevented||handler(e)})},"composeHandlers"),resolvedActiveProps=isActive?functionalUpdate$1(activeProps,{})??{}:{},resolvedInactiveProps=isActive?{}:functionalUpdate$1(inactiveProps,{}),resolvedClassName=[className,resolvedActiveProps.className,resolvedInactiveProps.className].filter(Boolean).join(" "),resolvedStyle={...style,...resolvedActiveProps.style,...resolvedInactiveProps.style};return{...propsSafeToSpread,...resolvedActiveProps,...resolvedInactiveProps,href:disabled?void 0:next.maskedLocation?router.history.createHref(next.maskedLocation.href):router.history.createHref(next.href),ref:innerRef,onClick:composeHandlers([onClick,handleClick]),onFocus:composeHandlers([onFocus,handleFocus]),onMouseEnter:composeHandlers([onMouseEnter,handleEnter]),onMouseLeave:composeHandlers([onMouseLeave,handleLeave]),onTouchStart:composeHandlers([onTouchStart,handleTouchStart]),disabled:!!disabled,target,...Object.keys(resolvedStyle).length&&{style:resolvedStyle},...resolvedClassName&&{className:resolvedClassName},...disabled&&{role:"link","aria-disabled":!0},...isActive&&{"data-status":"active","aria-current":"page"},...isTransitioning&&{"data-transitioning":"transitioning"}}}__name(useLinkProps,"useLinkProps");const Link=reactExports.forwardRef((props,ref)=>{const{_asChild,...rest}=props,{type:_type,ref:innerRef,...linkProps}=useLinkProps(rest,ref),children=typeof rest.children=="function"?rest.children({isActive:linkProps["data-status"]==="active"}):rest.children;return typeof _asChild>"u"&&delete linkProps.disabled,reactExports.createElement(_asChild||"a",{...linkProps,ref:innerRef},children)});function isCtrlEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}__name(isCtrlEvent,"isCtrlEvent");const createRouter=__name(options=>new Router(options),"createRouter"),_Router=class _Router extends RouterCore{constructor(options){super(options)}};__name(_Router,"Router");let Router=_Router;function RouterContextProvider({router,children,...rest}){router.update({...router.options,...rest,context:{...router.options.context,...rest.context}});const routerContext2=getRouterContext(),provider=jsxRuntimeExports.jsx(routerContext2.Provider,{value:router,children});return router.options.Wrap?jsxRuntimeExports.jsx(router.options.Wrap,{children:provider}):provider}__name(RouterContextProvider,"RouterContextProvider");function RouterProvider({router,...rest}){return jsxRuntimeExports.jsx(RouterContextProvider,{router,...rest,children:jsxRuntimeExports.jsx(Matches,{})})}__name(RouterProvider,"RouterProvider");function useLocation(opts){return useRouterState({select:__name(state=>state.location,"select")})}__name(useLocation,"useLocation");function functionalUpdate(updater,input){return typeof updater=="function"?updater(input):updater}__name(functionalUpdate,"functionalUpdate");function getBy(obj,path){return makePathArray(path).reduce((current,pathPart)=>{if(current===null)return null;if(typeof current<"u")return current[pathPart]},obj)}__name(getBy,"getBy");function setBy(obj,_path,updater){const path=makePathArray(_path);function doSet(parent){if(!path.length)return functionalUpdate(updater,parent);const key=path.shift();if(typeof key=="string"||typeof key=="number"&&!Array.isArray(parent))return typeof parent=="object"?(parent===null&&(parent={}),{...parent,[key]:doSet(parent[key])}):{[key]:doSet()};if(Array.isArray(parent)&&typeof key=="number"){const prefix=parent.slice(0,key);return[...prefix.length?prefix:new Array(key),doSet(parent[key]),...parent.slice(key+1)]}return[...new Array(key),doSet()]}return __name(doSet,"doSet"),doSet(obj)}__name(setBy,"setBy");function deleteBy(obj,_path){const path=makePathArray(_path);function doDelete(parent){if(!parent)return;if(path.length===1){const finalPath=path[0];if(Array.isArray(parent)&&typeof finalPath=="number")return parent.filter((_,i)=>i!==finalPath);const{[finalPath]:remove,...rest}=parent;return rest}const key=path.shift();if(typeof key=="string"&&typeof parent=="object")return{...parent,[key]:doDelete(parent[key])};if(typeof key=="number"&&Array.isArray(parent)){if(key>=parent.length)return parent;const prefix=parent.slice(0,key);return[...prefix.length?prefix:new Array(key),doDelete(parent[key]),...parent.slice(key+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return __name(doDelete,"doDelete"),doDelete(obj)}__name(deleteBy,"deleteBy");const reFindNumbers0=/^(\d*)$/gm,reFindNumbers1=/\.(\d*)\./gm,reFindNumbers2=/^(\d*)\./gm,reFindNumbers3=/\.(\d*$)/gm,reFindMultiplePeriods=/\.{2,}/gm,intPrefix="__int__",intReplace=`${intPrefix}$1`;function makePathArray(str){if(Array.isArray(str))return[...str];if(typeof str!="string")throw new Error("Path must be a string.");return str.replace(/\[/g,".").replace(/\]/g,"").replace(reFindNumbers0,intReplace).replace(reFindNumbers1,`.${intReplace}.`).replace(reFindNumbers2,`${intReplace}.`).replace(reFindNumbers3,`.${intReplace}`).replace(reFindMultiplePeriods,".").split(".").map(d=>d.indexOf(intPrefix)===0?parseInt(d.substring(intPrefix.length),10):d)}__name(makePathArray,"makePathArray");function isNonEmptyArray(obj){return!(Array.isArray(obj)&&obj.length===0)}__name(isNonEmptyArray,"isNonEmptyArray");function getAsyncValidatorArray(cause,options){const{asyncDebounceMs}=options,{onChangeAsync,onBlurAsync,onSubmitAsync,onBlurAsyncDebounceMs,onChangeAsyncDebounceMs}=options.validators||{},defaultDebounceMs=asyncDebounceMs??0,changeValidator={cause:"change",validate:onChangeAsync,debounceMs:onChangeAsyncDebounceMs??defaultDebounceMs},blurValidator={cause:"blur",validate:onBlurAsync,debounceMs:onBlurAsyncDebounceMs??defaultDebounceMs},submitValidator={cause:"submit",validate:onSubmitAsync,debounceMs:0},noopValidator=__name(validator=>({...validator,debounceMs:0}),"noopValidator");switch(cause){case"submit":return[noopValidator(changeValidator),noopValidator(blurValidator),submitValidator];case"blur":return[blurValidator];case"change":return[changeValidator];case"server":default:return[]}}__name(getAsyncValidatorArray,"getAsyncValidatorArray");function getSyncValidatorArray(cause,options){const{onChange,onBlur,onSubmit,onMount}=options.validators||{},changeValidator={cause:"change",validate:onChange},blurValidator={cause:"blur",validate:onBlur},submitValidator={cause:"submit",validate:onSubmit},mountValidator={cause:"mount",validate:onMount},serverValidator={cause:"server",validate:__name(()=>{},"validate")};switch(cause){case"mount":return[mountValidator];case"submit":return[changeValidator,blurValidator,submitValidator,serverValidator];case"server":return[serverValidator];case"blur":return[blurValidator,serverValidator];case"change":default:return[changeValidator,serverValidator]}}__name(getSyncValidatorArray,"getSyncValidatorArray");const isGlobalFormValidationError=__name(error=>!!error&&typeof error=="object"&&"fields"in error,"isGlobalFormValidationError");function shallow(objA,objB){if(Object.is(objA,objB))return!0;if(typeof objA!="object"||objA===null||typeof objB!="object"||objB===null)return!1;if(objA instanceof Map&&objB instanceof Map){if(objA.size!==objB.size)return!1;for(const[k,v]of objA)if(!objB.has(k)||!Object.is(v,objB.get(k)))return!1;return!0}if(objA instanceof Set&&objB instanceof Set){if(objA.size!==objB.size)return!1;for(const v of objA)if(!objB.has(v))return!1;return!0}const keysA=Object.keys(objA);if(keysA.length!==Object.keys(objB).length)return!1;for(let i=0;i<keysA.length;i++)if(!Object.prototype.hasOwnProperty.call(objB,keysA[i])||!Object.is(objA[keysA[i]],objB[keysA[i]]))return!1;return!0}__name(shallow,"shallow");const determineFormLevelErrorSourceAndValue=__name(({newFormValidatorError,isPreviousErrorFromFormValidator,previousErrorValue})=>newFormValidatorError?{newErrorValue:newFormValidatorError,newSource:"form"}:isPreviousErrorFromFormValidator?{newErrorValue:void 0,newSource:void 0}:previousErrorValue?{newErrorValue:previousErrorValue,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},"determineFormLevelErrorSourceAndValue"),determineFieldLevelErrorSourceAndValue=__name(({formLevelError,fieldLevelError})=>fieldLevelError?{newErrorValue:fieldLevelError,newSource:"field"}:formLevelError?{newErrorValue:formLevelError,newSource:"form"}:{newErrorValue:void 0,newSource:void 0},"determineFieldLevelErrorSourceAndValue");function prefixSchemaToErrors(issues){const schema=new Map;for(const issue of issues){const path=[...issue.path??[]].map(segment=>{const normalizedSegment=typeof segment=="object"?segment.key:segment;return typeof normalizedSegment=="number"?`[${normalizedSegment}]`:normalizedSegment}).join(".").replace(/\.\[/g,"[");schema.set(path,(schema.get(path)??[]).concat(issue))}return Object.fromEntries(schema)}__name(prefixSchemaToErrors,"prefixSchemaToErrors");const transformFormIssues=__name(issues=>{const schemaErrors=prefixSchemaToErrors(issues);return{form:schemaErrors,fields:schemaErrors}},"transformFormIssues"),standardSchemaValidators={validate({value,validationSource},schema){const result=schema["~standard"].validate(value);if(result instanceof Promise)throw new Error("async function passed to sync validator");if(result.issues)return validationSource==="field"?result.issues:transformFormIssues(result.issues)},async validateAsync({value,validationSource},schema){const result=await schema["~standard"].validate(value);if(result.issues)return validationSource==="field"?result.issues:transformFormIssues(result.issues)}},isStandardSchemaValidator=__name(validator=>!!validator&&"~standard"in validator,"isStandardSchemaValidator"),defaultFieldMeta={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,errors:[],errorMap:{},errorSourceMap:{}};function metaHelper(formApi){function handleArrayFieldMetaShift(field,index,mode,secondIndex){const affectedFields=getAffectedFields(field,index,mode,secondIndex);({insert:__name(()=>handleInsertMode(affectedFields,field,index),"insert"),remove:__name(()=>handleRemoveMode(affectedFields),"remove"),swap:__name(()=>secondIndex!==void 0&&handleSwapMode(affectedFields,field,index,secondIndex),"swap"),move:__name(()=>secondIndex!==void 0&&handleMoveMode(affectedFields,field,index,secondIndex),"move")})[mode]()}__name(handleArrayFieldMetaShift,"handleArrayFieldMetaShift");function getFieldPath(field,index){return`${field}[${index}]`}__name(getFieldPath,"getFieldPath");function getAffectedFields(field,index,mode,secondIndex){const affectedFieldKeys=[getFieldPath(field,index)];if(mode==="swap")affectedFieldKeys.push(getFieldPath(field,secondIndex));else if(mode==="move"){const[startIndex,endIndex]=[Math.min(index,secondIndex),Math.max(index,secondIndex)];for(let i=startIndex;i<=endIndex;i++)affectedFieldKeys.push(getFieldPath(field,i))}else{const currentValue=formApi.getFieldValue(field),fieldItems=Array.isArray(currentValue)?currentValue.length:0;for(let i=index+1;i<fieldItems;i++)affectedFieldKeys.push(getFieldPath(field,i))}return Object.keys(formApi.fieldInfo).filter(fieldKey=>affectedFieldKeys.some(key=>fieldKey.startsWith(key)))}__name(getAffectedFields,"getAffectedFields");function updateIndex(fieldKey,direction){return fieldKey.replace(/\[(\d+)\]/,(_,num)=>{const currIndex=parseInt(num,10);return`[${direction==="up"?currIndex+1:Math.max(0,currIndex-1)}]`})}__name(updateIndex,"updateIndex");function shiftMeta(fields,direction){(direction==="up"?fields:[...fields].reverse()).forEach(fieldKey=>{const nextFieldKey=updateIndex(fieldKey.toString(),direction),nextFieldMeta=formApi.getFieldMeta(nextFieldKey);nextFieldMeta?formApi.setFieldMeta(fieldKey,nextFieldMeta):formApi.setFieldMeta(fieldKey,getEmptyFieldMeta())})}__name(shiftMeta,"shiftMeta");const getEmptyFieldMeta=__name(()=>defaultFieldMeta,"getEmptyFieldMeta"),handleInsertMode=__name((fields,field,insertIndex)=>{shiftMeta(fields,"down"),fields.forEach(fieldKey=>{fieldKey.toString().startsWith(getFieldPath(field,insertIndex))&&formApi.setFieldMeta(fieldKey,getEmptyFieldMeta())})},"handleInsertMode"),handleRemoveMode=__name(fields=>{shiftMeta(fields,"up")},"handleRemoveMode"),handleMoveMode=__name((fields,field,fromIndex,toIndex)=>{const fromFields=new Map(Object.keys(formApi.fieldInfo).filter(fieldKey=>fieldKey.startsWith(getFieldPath(field,fromIndex))).map(fieldKey=>[fieldKey,formApi.getFieldMeta(fieldKey)]));shiftMeta(fields,fromIndex<toIndex?"up":"down"),Object.keys(formApi.fieldInfo).filter(fieldKey=>fieldKey.startsWith(getFieldPath(field,toIndex))).forEach(fieldKey=>{const fromKey=fieldKey.replace(getFieldPath(field,toIndex),getFieldPath(field,fromIndex)),fromMeta=fromFields.get(fromKey);fromMeta&&formApi.setFieldMeta(fieldKey,fromMeta)})},"handleMoveMode"),handleSwapMode=__name((fields,field,index,secondIndex)=>{fields.forEach(fieldKey=>{if(!fieldKey.toString().startsWith(getFieldPath(field,index)))return;const swappedKey=fieldKey.toString().replace(getFieldPath(field,index),getFieldPath(field,secondIndex)),[meta1,meta2]=[formApi.getFieldMeta(fieldKey),formApi.getFieldMeta(swappedKey)];meta1&&formApi.setFieldMeta(swappedKey,meta1),meta2&&formApi.setFieldMeta(fieldKey,meta2)})},"handleSwapMode");return{handleArrayFieldMetaShift}}__name(metaHelper,"metaHelper");function getDefaultFormState(defaultState){return{values:defaultState.values??{},errorMap:defaultState.errorMap??{},fieldMetaBase:defaultState.fieldMetaBase??{},isSubmitted:defaultState.isSubmitted??!1,isSubmitting:defaultState.isSubmitting??!1,isValidating:defaultState.isValidating??!1,submissionAttempts:defaultState.submissionAttempts??0,isSubmitSuccessful:defaultState.isSubmitSuccessful??!1,validationMetaMap:defaultState.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}__name(getDefaultFormState,"getDefaultFormState");const _FormApi=class _FormApi{constructor(opts){var _a;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var _a2,_b;const cleanupFieldMetaDerived=this.fieldMetaDerived.mount(),cleanupStoreDerived=this.store.mount(),cleanup=__name(()=>{cleanupFieldMetaDerived(),cleanupStoreDerived()},"cleanup");(_b=(_a2=this.options.listeners)==null?void 0:_a2.onMount)==null||_b.call(_a2,{formApi:this});const{onMount}=this.options.validators||{};return onMount&&this.validateSync("mount"),cleanup},this.update=options=>{var _a2,_b;if(!options)return;const oldOptions=this.options;this.options=options;const shouldUpdateReeval=!!((_b=(_a2=options.transform)==null?void 0:_a2.deps)!=null&&_b.some((val,i)=>val!==this.prevTransformArray[i])),shouldUpdateValues=options.defaultValues&&!shallow(options.defaultValues,oldOptions.defaultValues)&&!this.state.isTouched,shouldUpdateState=!shallow(options.defaultState,oldOptions.defaultState)&&!this.state.isTouched;!shouldUpdateValues&&!shouldUpdateState&&!shouldUpdateReeval||batch(()=>{this.baseStore.setState(()=>getDefaultFormState(Object.assign({},this.state,shouldUpdateState?options.defaultState:{},shouldUpdateValues?{values:options.defaultValues}:{},shouldUpdateReeval?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(values,opts2)=>{const{fieldMeta:currentFieldMeta}=this.state,fieldMetaBase=this.resetFieldMeta(currentFieldMeta);values&&!(opts2!=null&&opts2.keepDefaultValues)&&(this.options={...this.options,defaultValues:values}),this.baseStore.setState(()=>{var _a2;return getDefaultFormState({...this.options.defaultState,values:values??this.options.defaultValues??((_a2=this.options.defaultState)==null?void 0:_a2.values),fieldMetaBase})})},this.validateAllFields=async cause=>{const fieldValidationPromises=[];return batch(()=>{Object.values(this.fieldInfo).forEach(field=>{if(!field.instance)return;const fieldInstance=field.instance;fieldValidationPromises.push(Promise.resolve().then(()=>fieldInstance.validate(cause,{skipFormValidation:!0}))),field.instance.state.meta.isTouched||field.instance.setMeta(prev=>({...prev,isTouched:!0}))})}),(await Promise.all(fieldValidationPromises)).flat()},this.validateArrayFieldsStartingFrom=async(field,index,cause)=>{const currentValue=this.getFieldValue(field),lastIndex=Array.isArray(currentValue)?Math.max(currentValue.length-1,0):null,fieldKeysToValidate=[`${field}[${index}]`];for(let i=index+1;i<=(lastIndex??0);i++)fieldKeysToValidate.push(`${field}[${i}]`);const fieldsToValidate=Object.keys(this.fieldInfo).filter(fieldKey=>fieldKeysToValidate.some(key=>fieldKey.startsWith(key))),fieldValidationPromises=[];return batch(()=>{fieldsToValidate.forEach(nestedField=>{fieldValidationPromises.push(Promise.resolve().then(()=>this.validateField(nestedField,cause)))})}),(await Promise.all(fieldValidationPromises)).flat()},this.validateField=(field,cause)=>{var _a2;const fieldInstance=(_a2=this.fieldInfo[field])==null?void 0:_a2.instance;return fieldInstance?(fieldInstance.state.meta.isTouched||fieldInstance.setMeta(prev=>({...prev,isTouched:!0})),fieldInstance.validate(cause)):[]},this.validateSync=cause=>{const validates=getSyncValidatorArray(cause,this.options);let hasErrored=!1;const currentValidationErrorMap={};return batch(()=>{var _a2,_b;for(const validateObj of validates){if(!validateObj.validate)continue;const rawError=this.runValidator({validate:validateObj.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError,fieldErrors}=normalizeError$1(rawError),errorMapKey=getErrorMapKey$1(validateObj.cause);for(const field of Object.keys(this.state.fieldMeta)){const fieldMeta=this.getFieldMeta(field);if(!fieldMeta)continue;const{errorMap:currentErrorMap,errorSourceMap:currentErrorMapSource}=fieldMeta,newFormValidatorError=fieldErrors==null?void 0:fieldErrors[field],{newErrorValue,newSource}=determineFormLevelErrorSourceAndValue({newFormValidatorError,isPreviousErrorFromFormValidator:(currentErrorMapSource==null?void 0:currentErrorMapSource[errorMapKey])==="form",previousErrorValue:currentErrorMap==null?void 0:currentErrorMap[errorMapKey]});newSource==="form"&&(currentValidationErrorMap[field]={...currentValidationErrorMap[field],[errorMapKey]:newFormValidatorError}),(currentErrorMap==null?void 0:currentErrorMap[errorMapKey])!==newErrorValue&&this.setFieldMeta(field,prev=>({...prev,errorMap:{...prev.errorMap,[errorMapKey]:newErrorValue},errorSourceMap:{...prev.errorSourceMap,[errorMapKey]:newSource}}))}((_a2=this.state.errorMap)==null?void 0:_a2[errorMapKey])!==formError&&this.baseStore.setState(prev=>({...prev,errorMap:{...prev.errorMap,[errorMapKey]:formError}})),(formError||fieldErrors)&&(hasErrored=!0)}const submitErrKey=getErrorMapKey$1("submit");(_b=this.state.errorMap)!=null&&_b[submitErrKey]&&cause!=="submit"&&!hasErrored&&this.baseStore.setState(prev=>({...prev,errorMap:{...prev.errorMap,[submitErrKey]:void 0}}))}),{hasErrored,fieldsErrorMap:currentValidationErrorMap}},this.validateAsync=async cause=>{const validates=getAsyncValidatorArray(cause,this.options);this.state.isFormValidating||this.baseStore.setState(prev=>({...prev,isFormValidating:!0}));const promises=[];let fieldErrorsFromFormValidators;for(const validateObj of validates){if(!validateObj.validate)continue;const key=getErrorMapKey$1(validateObj.cause),fieldValidatorMeta=this.state.validationMetaMap[key];fieldValidatorMeta==null||fieldValidatorMeta.lastAbortController.abort();const controller=new AbortController;this.state.validationMetaMap[key]={lastAbortController:controller},promises.push(new Promise(async resolve=>{let rawError;try{rawError=await new Promise((rawResolve,rawReject)=>{setTimeout(async()=>{if(controller.signal.aborted)return rawResolve(void 0);try{rawResolve(await this.runValidator({validate:validateObj.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:controller.signal},type:"validateAsync"}))}catch(e){rawReject(e)}},validateObj.debounceMs)})}catch(e){rawError=e}const{formError,fieldErrors:fieldErrorsFromNormalizeError}=normalizeError$1(rawError);fieldErrorsFromNormalizeError&&(fieldErrorsFromFormValidators=fieldErrorsFromFormValidators?{...fieldErrorsFromFormValidators,...fieldErrorsFromNormalizeError}:fieldErrorsFromNormalizeError);const errorMapKey=getErrorMapKey$1(validateObj.cause);for(const field of Object.keys(this.state.fieldMeta)){const fieldMeta=this.getFieldMeta(field);if(!fieldMeta)continue;const{errorMap:currentErrorMap,errorSourceMap:currentErrorMapSource}=fieldMeta,newFormValidatorError=fieldErrorsFromFormValidators==null?void 0:fieldErrorsFromFormValidators[field],{newErrorValue,newSource}=determineFormLevelErrorSourceAndValue({newFormValidatorError,isPreviousErrorFromFormValidator:(currentErrorMapSource==null?void 0:currentErrorMapSource[errorMapKey])==="form",previousErrorValue:currentErrorMap==null?void 0:currentErrorMap[errorMapKey]});(currentErrorMap==null?void 0:currentErrorMap[errorMapKey])!==newErrorValue&&this.setFieldMeta(field,prev=>({...prev,errorMap:{...prev.errorMap,[errorMapKey]:newErrorValue},errorSourceMap:{...prev.errorSourceMap,[errorMapKey]:newSource}}))}this.baseStore.setState(prev=>({...prev,errorMap:{...prev.errorMap,[errorMapKey]:formError}})),resolve(fieldErrorsFromFormValidators?{fieldErrors:fieldErrorsFromFormValidators,errorMapKey}:void 0)}))}let results=[];const fieldsErrorMap={};if(promises.length){results=await Promise.all(promises);for(const fieldValidationResult of results)if(fieldValidationResult!=null&&fieldValidationResult.fieldErrors){const{errorMapKey}=fieldValidationResult;for(const[field,fieldError]of Object.entries(fieldValidationResult.fieldErrors)){const newErrorMap={...fieldsErrorMap[field]||{},[errorMapKey]:fieldError};fieldsErrorMap[field]=newErrorMap}}}return this.baseStore.setState(prev=>({...prev,isFormValidating:!1})),fieldsErrorMap},this.validate=cause=>{const{hasErrored,fieldsErrorMap}=this.validateSync(cause);return hasErrored&&!this.options.asyncAlways?fieldsErrorMap:this.validateAsync(cause)},this.getFieldValue=field=>getBy(this.state.values,field),this.getFieldMeta=field=>this.state.fieldMeta[field],this.getFieldInfo=field=>{var _a2;return(_a2=this.fieldInfo)[field]||(_a2[field]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(field,updater)=>{this.baseStore.setState(prev=>({...prev,fieldMetaBase:{...prev.fieldMetaBase,[field]:functionalUpdate(updater,prev.fieldMetaBase[field])}}))},this.resetFieldMeta=fieldMeta=>Object.keys(fieldMeta).reduce((acc,key)=>{const fieldKey=key;return acc[fieldKey]=defaultFieldMeta,acc},{}),this.setFieldValue=(field,updater,opts2)=>{const dontUpdateMeta=(opts2==null?void 0:opts2.dontUpdateMeta)??!1;batch(()=>{dontUpdateMeta||this.setFieldMeta(field,prev=>({...prev,isTouched:!0,isDirty:!0,errorMap:{...prev==null?void 0:prev.errorMap,onMount:void 0}})),this.baseStore.setState(prev=>({...prev,values:setBy(prev.values,field,updater)}))})},this.deleteField=field=>{const fieldsToDelete=[...Object.keys(this.fieldInfo).filter(f=>{const fieldStr=field.toString();return f!==fieldStr&&f.startsWith(fieldStr)}),field];this.baseStore.setState(prev=>{const newState={...prev};return fieldsToDelete.forEach(f=>{newState.values=deleteBy(newState.values,f),delete this.fieldInfo[f],delete newState.fieldMetaBase[f]}),newState})},this.pushFieldValue=(field,value,opts2)=>{this.setFieldValue(field,prev=>[...Array.isArray(prev)?prev:[],value],opts2),this.validateField(field,"change")},this.insertFieldValue=async(field,index,value,opts2)=>{this.setFieldValue(field,prev=>[...prev.slice(0,index),value,...prev.slice(index)],opts2),await this.validateField(field,"change"),metaHelper(this).handleArrayFieldMetaShift(field,index,"insert"),await this.validateArrayFieldsStartingFrom(field,index,"change")},this.replaceFieldValue=async(field,index,value,opts2)=>{this.setFieldValue(field,prev=>prev.map((d,i)=>i===index?value:d),opts2),await this.validateField(field,"change"),await this.validateArrayFieldsStartingFrom(field,index,"change")},this.removeFieldValue=async(field,index,opts2)=>{const fieldValue=this.getFieldValue(field),lastIndex=Array.isArray(fieldValue)?Math.max(fieldValue.length-1,0):null;if(this.setFieldValue(field,prev=>prev.filter((_d,i)=>i!==index),opts2),metaHelper(this).handleArrayFieldMetaShift(field,index,"remove"),lastIndex!==null){const start=`${field}[${lastIndex}]`;this.deleteField(start)}await this.validateField(field,"change"),await this.validateArrayFieldsStartingFrom(field,index,"change")},this.swapFieldValues=(field,index1,index2,opts2)=>{this.setFieldValue(field,prev=>{const prev1=prev[index1],prev2=prev[index2];return setBy(setBy(prev,`${index1}`,prev2),`${index2}`,prev1)},opts2),metaHelper(this).handleArrayFieldMetaShift(field,index1,"swap",index2),this.validateField(field,"change"),this.validateField(`${field}[${index1}]`,"change"),this.validateField(`${field}[${index2}]`,"change")},this.moveFieldValues=(field,index1,index2,opts2)=>{this.setFieldValue(field,prev=>(prev.splice(index2,0,prev.splice(index1,1)[0]),prev),opts2),metaHelper(this).handleArrayFieldMetaShift(field,index1,"move",index2),this.validateField(field,"change"),this.validateField(`${field}[${index1}]`,"change"),this.validateField(`${field}[${index2}]`,"change")},this.resetField=field=>{this.baseStore.setState(prev=>({...prev,fieldMetaBase:{...prev.fieldMetaBase,[field]:defaultFieldMeta},values:{...prev.values,[field]:this.options.defaultValues&&this.options.defaultValues[field]}}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((acc,[fieldName,fieldMeta])=>(Object.keys(fieldMeta).length&&fieldMeta.errors.length&&(acc[fieldName]={errors:fieldMeta.errors,errorMap:fieldMeta.errorMap}),acc),{})}),this.parseValuesWithSchema=schema=>standardSchemaValidators.validate({value:this.state.values,validationSource:"form"},schema),this.parseValuesWithSchemaAsync=schema=>standardSchemaValidators.validateAsync({value:this.state.values,validationSource:"form"},schema),this.baseStore=new Store(getDefaultFormState({...opts==null?void 0:opts.defaultState,values:(opts==null?void 0:opts.defaultValues)??((_a=opts==null?void 0:opts.defaultState)==null?void 0:_a.values)})),this.fieldMetaDerived=new Derived({deps:[this.baseStore],fn:__name(({prevDepVals,currDepVals,prevVal:_prevVal})=>{var _a2;const prevVal=_prevVal,prevBaseStore=prevDepVals==null?void 0:prevDepVals[0],currBaseStore=currDepVals[0];let originalMetaCount=0;const fieldMeta={};for(const fieldName of Object.keys(currBaseStore.fieldMetaBase)){const currBaseVal=currBaseStore.fieldMetaBase[fieldName],prevBaseVal=prevBaseStore==null?void 0:prevBaseStore.fieldMetaBase[fieldName],prevFieldInfo=prevVal==null?void 0:prevVal[fieldName];let fieldErrors=prevFieldInfo==null?void 0:prevFieldInfo.errors;if(!prevBaseVal||currBaseVal.errorMap!==prevBaseVal.errorMap){fieldErrors=Object.values(currBaseVal.errorMap??{}).filter(val=>val!==void 0);const fieldInstance=(_a2=this.getFieldInfo(fieldName))==null?void 0:_a2.instance;fieldInstance&&!fieldInstance.options.disableErrorFlat&&(fieldErrors=fieldErrors==null?void 0:fieldErrors.flat(1))}const isFieldPristine=!currBaseVal.isDirty,isFieldValid=!isNonEmptyArray(fieldErrors??[]);if(prevFieldInfo&&prevFieldInfo.isPristine===isFieldPristine&&prevFieldInfo.isValid===isFieldValid&&prevFieldInfo.errors===fieldErrors&&currBaseVal===prevBaseVal){fieldMeta[fieldName]=prevFieldInfo,originalMetaCount++;continue}fieldMeta[fieldName]={...currBaseVal,errors:fieldErrors,isPristine:isFieldPristine,isValid:isFieldValid}}return Object.keys(currBaseStore.fieldMetaBase).length&&prevVal&&originalMetaCount===Object.keys(currBaseStore.fieldMetaBase).length?prevVal:fieldMeta},"fn")}),this.store=new Derived({deps:[this.baseStore,this.fieldMetaDerived],fn:__name(({prevDepVals,currDepVals,prevVal:_prevVal})=>{var _a2,_b,_c,_d;const prevVal=_prevVal,prevBaseStore=prevDepVals==null?void 0:prevDepVals[0],currBaseStore=currDepVals[0],currFieldMeta=currDepVals[1],fieldMetaValues=Object.values(currFieldMeta).filter(Boolean),isFieldsValidating=fieldMetaValues.some(field=>field.isValidating),isFieldsValid=fieldMetaValues.every(field=>field.isValid),isTouched=fieldMetaValues.some(field=>field.isTouched),isBlurred=fieldMetaValues.some(field=>field.isBlurred),shouldInvalidateOnMount=isTouched&&((_a2=currBaseStore.errorMap)==null?void 0:_a2.onMount),isDirty=fieldMetaValues.some(field=>field.isDirty),isPristine=!isDirty,hasOnMountError=!!((_b=currBaseStore.errorMap)!=null&&_b.onMount||fieldMetaValues.some(f=>{var _a3;return(_a3=f==null?void 0:f.errorMap)==null?void 0:_a3.onMount})),isValidating=!!isFieldsValidating;let errors=(prevVal==null?void 0:prevVal.errors)??[];(!prevBaseStore||currBaseStore.errorMap!==prevBaseStore.errorMap)&&(errors=Object.values(currBaseStore.errorMap).reduce((prev,curr)=>curr===void 0?prev:curr&&isGlobalFormValidationError(curr)?(prev.push(curr.form),prev):(prev.push(curr),prev),[]));const isFormValid=errors.length===0,isValid=isFieldsValid&&isFormValid,submitInvalid=this.options.canSubmitWhenInvalid??!1,canSubmit=currBaseStore.submissionAttempts===0&&!isTouched&&!hasOnMountError||!isValidating&&!currBaseStore.isSubmitting&&isValid||submitInvalid;let errorMap=currBaseStore.errorMap;if(shouldInvalidateOnMount&&(errors=errors.filter(err=>err!==currBaseStore.errorMap.onMount),errorMap=Object.assign(errorMap,{onMount:void 0})),prevVal&&prevBaseStore&&prevVal.errorMap===errorMap&&prevVal.fieldMeta===this.fieldMetaDerived.state&&prevVal.errors===errors&&prevVal.isFieldsValidating===isFieldsValidating&&prevVal.isFieldsValid===isFieldsValid&&prevVal.isFormValid===isFormValid&&prevVal.isValid===isValid&&prevVal.canSubmit===canSubmit&&prevVal.isTouched===isTouched&&prevVal.isBlurred===isBlurred&&prevVal.isPristine===isPristine&&prevVal.isDirty===isDirty&&shallow(prevBaseStore,currBaseStore))return prevVal;let state={...currBaseStore,errorMap,fieldMeta:this.fieldMetaDerived.state,errors,isFieldsValidating,isFieldsValid,isFormValid,isValid,canSubmit,isTouched,isBlurred,isPristine,isDirty};const transformArray=((_c=this.options.transform)==null?void 0:_c.deps)??[];if(transformArray.length!==this.prevTransformArray.length||transformArray.some((val,i)=>val!==this.prevTransformArray[i])){const newObj=Object.assign({},this,{state});(_d=this.options.transform)==null||_d.fn(newObj),state=newObj.state,this.prevTransformArray=transformArray}return state},"fn")}),this.handleSubmit=this.handleSubmit.bind(this),this.update(opts||{})}get state(){return this.store.state}runValidator(props){return isStandardSchemaValidator(props.validate)?standardSchemaValidators[props.type](props.value,props.validate):props.validate(props.value)}async handleSubmit(submitMeta){var _a,_b,_c,_d,_e,_f,_g,_h;if(this.baseStore.setState(old=>({...old,isSubmitted:!1,submissionAttempts:old.submissionAttempts+1,isSubmitSuccessful:!1})),batch(()=>{Object.values(this.fieldInfo).forEach(field=>{field.instance&&(field.instance.state.meta.isTouched||field.instance.setMeta(prev=>({...prev,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const done=__name(()=>{this.baseStore.setState(prev=>({...prev,isSubmitting:!1}))},"done");if(await this.validateAllFields("submit"),!this.state.isFieldsValid){done(),(_b=(_a=this.options).onSubmitInvalid)==null||_b.call(_a,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){done(),(_d=(_c=this.options).onSubmitInvalid)==null||_d.call(_c,{value:this.state.values,formApi:this});return}batch(()=>{Object.values(this.fieldInfo).forEach(field=>{var _a2,_b2,_c2;(_c2=(_b2=(_a2=field.instance)==null?void 0:_a2.options.listeners)==null?void 0:_b2.onSubmit)==null||_c2.call(_b2,{value:field.instance.state.value,fieldApi:field.instance})})}),(_f=(_e=this.options.listeners)==null?void 0:_e.onSubmit)==null||_f.call(_e,{formApi:this});try{await((_h=(_g=this.options).onSubmit)==null?void 0:_h.call(_g,{value:this.state.values,formApi:this,meta:submitMeta??this.options.onSubmitMeta})),batch(()=>{this.baseStore.setState(prev=>({...prev,isSubmitted:!0,isSubmitSuccessful:!0})),done()})}catch(err){throw this.baseStore.setState(prev=>({...prev,isSubmitSuccessful:!1})),done(),err}}setErrorMap(errorMap){this.baseStore.setState(prev=>({...prev,errorMap:{...prev.errorMap,...errorMap}}))}};__name(_FormApi,"FormApi");let FormApi=_FormApi;function normalizeError$1(rawError){if(rawError){if(isGlobalFormValidationError(rawError)){const formError=normalizeError$1(rawError.form).formError,fieldErrors=rawError.fields;return{formError,fieldErrors}}return{formError:rawError}}return{formError:void 0}}__name(normalizeError$1,"normalizeError$1");function getErrorMapKey$1(cause){switch(cause){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}__name(getErrorMapKey$1,"getErrorMapKey$1");const _FieldApi=class _FieldApi{constructor(opts){this.options={},this.mount=()=>{var _a,_b;const cleanup=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const info=this.getInfo();info.instance=this,this.update(this.options);const{onMount}=this.options.validators||{};if(onMount){const error=this.runValidator({validate:onMount,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});error&&this.setMeta(prev=>({...prev,errorMap:{...prev==null?void 0:prev.errorMap,onMount:error},errorSourceMap:{...prev==null?void 0:prev.errorSourceMap,onMount:"field"}}))}return(_b=(_a=this.options.listeners)==null?void 0:_a.onMount)==null||_b.call(_a,{value:this.state.value,fieldApi:this}),cleanup},this.update=opts2=>{this.options=opts2;const nameHasChanged=this.name!==opts2.name;if(this.name=opts2.name,this.state.value===void 0){const formDefault=getBy(opts2.form.options.defaultValues,opts2.name),defaultValue=opts2.defaultValue??formDefault;nameHasChanged?this.setValue(val=>val||defaultValue,{dontUpdateMeta:!0}):defaultValue!==void 0&&this.setValue(defaultValue,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(updater,options)=>{this.form.setFieldValue(this.name,updater,options),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=updater=>this.form.setFieldMeta(this.name,updater),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(value,opts2)=>{this.form.pushFieldValue(this.name,value,opts2),this.triggerOnChangeListener()},this.insertValue=(index,value,opts2)=>{this.form.insertFieldValue(this.name,index,value,opts2),this.triggerOnChangeListener()},this.replaceValue=(index,value,opts2)=>{this.form.replaceFieldValue(this.name,index,value,opts2),this.triggerOnChangeListener()},this.removeValue=(index,opts2)=>{this.form.removeFieldValue(this.name,index,opts2),this.triggerOnChangeListener()},this.swapValues=(aIndex,bIndex,opts2)=>{this.form.swapFieldValues(this.name,aIndex,bIndex,opts2),this.triggerOnChangeListener()},this.moveValue=(aIndex,bIndex,opts2)=>{this.form.moveFieldValues(this.name,aIndex,bIndex,opts2),this.triggerOnChangeListener()},this.getLinkedFields=cause=>{const fields=Object.values(this.form.fieldInfo),linkedFields=[];for(const field of fields){if(!field.instance)continue;const{onChangeListenTo,onBlurListenTo}=field.instance.options.validators||{};cause==="change"&&(onChangeListenTo!=null&&onChangeListenTo.includes(this.name))&&linkedFields.push(field.instance),cause==="blur"&&(onBlurListenTo!=null&&onBlurListenTo.includes(this.name))&&linkedFields.push(field.instance)}return linkedFields},this.validateSync=(cause,errorFromForm)=>{var _a;const validates=getSyncValidatorArray(cause,this.options),linkedFieldValidates=this.getLinkedFields(cause).reduce((acc,field)=>{const fieldValidates=getSyncValidatorArray(cause,field.options);return fieldValidates.forEach(validate=>{validate.field=field}),acc.concat(fieldValidates)},[]);let hasErrored=!1;batch(()=>{const validateFieldFn=__name((field,validateObj)=>{var _a2;const errorMapKey=getErrorMapKey(validateObj.cause),fieldLevelError=validateObj.validate?normalizeError(field.runValidator({validate:validateObj.validate,value:{value:field.store.state.value,validationSource:"field",fieldApi:field},type:"validate"})):void 0,formLevelError=errorFromForm[errorMapKey],{newErrorValue,newSource}=determineFieldLevelErrorSourceAndValue({formLevelError,fieldLevelError});((_a2=field.state.meta.errorMap)==null?void 0:_a2[errorMapKey])!==newErrorValue&&field.setMeta(prev=>({...prev,errorMap:{...prev.errorMap,[errorMapKey]:newErrorValue},errorSourceMap:{...prev.errorSourceMap,[errorMapKey]:newSource}})),newErrorValue&&(hasErrored=!0)},"validateFieldFn");for(const validateObj of validates)validateFieldFn(this,validateObj);for(const fieldValitateObj of linkedFieldValidates)fieldValitateObj.validate&&validateFieldFn(fieldValitateObj.field,fieldValitateObj)});const submitErrKey=getErrorMapKey("submit");return(_a=this.state.meta.errorMap)!=null&&_a[submitErrKey]&&cause!=="submit"&&!hasErrored&&this.setMeta(prev=>({...prev,errorMap:{...prev.errorMap,[submitErrKey]:void 0},errorSourceMap:{...prev.errorSourceMap,[submitErrKey]:void 0}})),{hasErrored}},this.validateAsync=async(cause,formValidationResultPromise)=>{const validates=getAsyncValidatorArray(cause,this.options),asyncFormValidationResults=await formValidationResultPromise,linkedFields=this.getLinkedFields(cause),linkedFieldValidates=linkedFields.reduce((acc,field)=>{const fieldValidates=getAsyncValidatorArray(cause,field.options);return fieldValidates.forEach(validate=>{validate.field=field}),acc.concat(fieldValidates)},[]);this.state.meta.isValidating||this.setMeta(prev=>({...prev,isValidating:!0}));for(const linkedField of linkedFields)linkedField.setMeta(prev=>({...prev,isValidating:!0}));const validatesPromises=[],linkedPromises=[],validateFieldAsyncFn=__name((field,validateObj,promises)=>{const errorMapKey=getErrorMapKey(validateObj.cause),fieldValidatorMeta=field.getInfo().validationMetaMap[errorMapKey];fieldValidatorMeta==null||fieldValidatorMeta.lastAbortController.abort();const controller=new AbortController;this.getInfo().validationMetaMap[errorMapKey]={lastAbortController:controller},promises.push(new Promise(async resolve=>{var _a;let rawError;try{rawError=await new Promise((rawResolve,rawReject)=>{this.timeoutIds.validations[validateObj.cause]&&clearTimeout(this.timeoutIds.validations[validateObj.cause]),this.timeoutIds.validations[validateObj.cause]=setTimeout(async()=>{if(controller.signal.aborted)return rawResolve(void 0);try{rawResolve(await this.runValidator({validate:validateObj.validate,value:{value:field.store.state.value,fieldApi:field,signal:controller.signal,validationSource:"field"},type:"validateAsync"}))}catch(e){rawReject(e)}},validateObj.debounceMs)})}catch(e){rawError=e}if(controller.signal.aborted)return resolve(void 0);const fieldLevelError=normalizeError(rawError),formLevelError=(_a=asyncFormValidationResults[this.name])==null?void 0:_a[errorMapKey],{newErrorValue,newSource}=determineFieldLevelErrorSourceAndValue({formLevelError,fieldLevelError});field.setMeta(prev=>({...prev,errorMap:{...prev==null?void 0:prev.errorMap,[errorMapKey]:newErrorValue},errorSourceMap:{...prev.errorSourceMap,[errorMapKey]:newSource}})),resolve(newErrorValue)}))},"validateFieldAsyncFn");for(const validateObj of validates)validateObj.validate&&validateFieldAsyncFn(this,validateObj,validatesPromises);for(const fieldValitateObj of linkedFieldValidates)fieldValitateObj.validate&&validateFieldAsyncFn(fieldValitateObj.field,fieldValitateObj,linkedPromises);let results=[];(validatesPromises.length||linkedPromises.length)&&(results=await Promise.all(validatesPromises),await Promise.all(linkedPromises)),this.setMeta(prev=>({...prev,isValidating:!1}));for(const linkedField of linkedFields)linkedField.setMeta(prev=>({...prev,isValidating:!1}));return results.filter(Boolean)},this.validate=(cause,opts2)=>{var _a;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap}=opts2!=null&&opts2.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(cause),{hasErrored}=this.validateSync(cause,fieldsErrorMap[this.name]??{});if(hasErrored&&!this.options.asyncAlways)return(_a=this.getInfo().validationMetaMap[getErrorMapKey(cause)])==null||_a.lastAbortController.abort(),this.state.meta.errors;const formValidationResultPromise=opts2!=null&&opts2.skipFormValidation?Promise.resolve({}):this.form.validateAsync(cause);return this.validateAsync(cause,formValidationResultPromise)},this.handleChange=updater=>{this.setValue(updater)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(prev=>({...prev,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(prev=>({...prev,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=schema=>standardSchemaValidators.validate({value:this.state.value,validationSource:"field"},schema),this.parseValueWithSchemaAsync=schema=>standardSchemaValidators.validateAsync({value:this.state.value,validationSource:"field"},schema),this.form=opts.form,this.name=opts.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new Derived({deps:[this.form.store],fn:__name(()=>{const value=this.form.getFieldValue(this.name),meta=this.form.getFieldMeta(this.name)??{...defaultFieldMeta,...opts.defaultMeta};return{value,meta}},"fn")}),this.options=opts}get state(){return this.store.state}runValidator(props){return isStandardSchemaValidator(props.validate)?standardSchemaValidators[props.type](props.value,props.validate):props.validate(props.value)}setErrorMap(errorMap){this.setMeta(prev=>({...prev,errorMap:{...prev.errorMap,...errorMap}}))}triggerOnBlurListener(){var _a,_b,_c,_d,_e,_f;const formDebounceMs=(_a=this.form.options.listeners)==null?void 0:_a.onBlurDebounceMs;formDebounceMs&&formDebounceMs>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var _a2,_b2;(_b2=(_a2=this.form.options.listeners)==null?void 0:_a2.onBlur)==null||_b2.call(_a2,{formApi:this.form,fieldApi:this})},formDebounceMs)):(_c=(_b=this.form.options.listeners)==null?void 0:_b.onBlur)==null||_c.call(_b,{formApi:this.form,fieldApi:this});const fieldDebounceMs=(_d=this.options.listeners)==null?void 0:_d.onBlurDebounceMs;fieldDebounceMs&&fieldDebounceMs>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var _a2,_b2;(_b2=(_a2=this.options.listeners)==null?void 0:_a2.onBlur)==null||_b2.call(_a2,{value:this.state.value,fieldApi:this})},fieldDebounceMs)):(_f=(_e=this.options.listeners)==null?void 0:_e.onBlur)==null||_f.call(_e,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var _a,_b,_c,_d,_e,_f;const formDebounceMs=(_a=this.form.options.listeners)==null?void 0:_a.onChangeDebounceMs;formDebounceMs&&formDebounceMs>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var _a2,_b2;(_b2=(_a2=this.form.options.listeners)==null?void 0:_a2.onChange)==null||_b2.call(_a2,{formApi:this.form,fieldApi:this})},formDebounceMs)):(_c=(_b=this.form.options.listeners)==null?void 0:_b.onChange)==null||_c.call(_b,{formApi:this.form,fieldApi:this});const fieldDebounceMs=(_d=this.options.listeners)==null?void 0:_d.onChangeDebounceMs;fieldDebounceMs&&fieldDebounceMs>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var _a2,_b2;(_b2=(_a2=this.options.listeners)==null?void 0:_a2.onChange)==null||_b2.call(_a2,{value:this.state.value,fieldApi:this})},fieldDebounceMs)):(_f=(_e=this.options.listeners)==null?void 0:_e.onChange)==null||_f.call(_e,{value:this.state.value,fieldApi:this})}};__name(_FieldApi,"FieldApi");let FieldApi=_FieldApi;function normalizeError(rawError){if(rawError)return rawError}__name(normalizeError,"normalizeError");function getErrorMapKey(cause){switch(cause){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}__name(getErrorMapKey,"getErrorMapKey");const useIsomorphicLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function useField(opts){const[fieldApi]=reactExports.useState(()=>{const extendedApi=new FieldApi({...opts,form:opts.form,name:opts.name});return extendedApi.Field=Field,extendedApi});return useIsomorphicLayoutEffect(fieldApi.mount,[fieldApi]),useIsomorphicLayoutEffect(()=>{fieldApi.update(opts)}),useStore(fieldApi.store,opts.mode==="array"?state=>[state.meta,Object.keys(state.value??[]).length]:void 0),fieldApi}__name(useField,"useField");const Field=__name(({children,...fieldOptions})=>{const fieldApi=useField(fieldOptions),jsxToDisplay=reactExports.useMemo(()=>functionalUpdate(children,fieldApi),[children,fieldApi,fieldApi.state.value,fieldApi.state.meta]);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxToDisplay})},"Field");function LocalSubscribe({form,selector,children}){const data=useStore(form.store,selector);return functionalUpdate(children,data)}__name(LocalSubscribe,"LocalSubscribe");function useForm(opts){const[formApi]=reactExports.useState(()=>{const api=new FormApi(opts),extendedApi=api;return extendedApi.Field=__name(function(props){return jsxRuntimeExports.jsx(Field,{...props,form:api})},"APIField"),extendedApi.Subscribe=props=>jsxRuntimeExports.jsx(LocalSubscribe,{form:api,selector:props.selector,children:props.children}),extendedApi});return useIsomorphicLayoutEffect(formApi.mount,[]),useStore(formApi.store,state=>state.isSubmitting),useIsomorphicLayoutEffect(()=>{formApi.update(opts)}),formApi}__name(useForm,"useForm");export{Link as L,Outlet as O,RouterProvider as R,Store as S,useForm as a,useNavigate as b,useLocation as c,createRootRoute as d,createRoute as e,createRouter as f,redirect as r,useStore as u};
//# sourceMappingURL=@tanstack-CzG0gKxE.js.map
