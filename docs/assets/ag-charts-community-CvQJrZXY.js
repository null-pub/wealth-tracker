var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{l as logger_exports,i as isArray,a as isNumber,b as isFiniteNumber,c as attachDescription,d as and,e as arrayLength,f as arrayOf,r as required,u as union,g as fontOptionsDef,n as number,s as string,h as boolean,j as arrayOfDefs,o as or,p as positiveNumber,k as date,m as greaterThan,q as lessThan,t as typeUnion,v as constant,w as color,x as positiveNumberNonZero,y as moduleRegistry_exports,z as array,A as defined,B as ratio,C as callback,D as object,E as strokeOptionsDef,F as fillOptionsDef,G as lineDashOptionsDef,H as clamp,I as isValidDate,J as isFunction,K as createSvgElement,L as toArray,M as getWindow,N as instanceOf,O as entries,P as isValidNumberFormat,Q as countLines,R as iterate,S as isObject,T as sortBasedOnArray,U as isDefined,V as colorUnion,W as isDate,X as isNumberEqual,Y as isPlainObject,Z as toIterable,_ as groupBy,$ as arraysEqual,a0 as isInteger,a1 as createNumberFormatter,a2 as inRange,a3 as modulus,a4 as isRegExp,a5 as diffArrays,a6 as countFractionDigits,a7 as parseNumberFormat,a8 as findMinIndex,a9 as findMaxIndex,aa as validate,ab as ModuleType,ac as joinFormatted,ad as isString,ae as isEnumValue,af as unique,ag as isSymbol,ah as setWindow,ai as getDocument,aj as setDocument,ak as isNegative,al as createElement,am as gradientStrict,an as EventEmitter,ao as downloadUrl,ap as throttle,aq as first,ar as isHtmlElement,as as findMinValue,at as circularSliceArray,au as isBoolean,av as isColor,aw as roundTo,ax as stringifyValue}from"./ag-charts-core-DYGJlQQ5.js";var __defProp2=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__export=__name((target,all)=>{for(var name in all)__defProp2(target,name,{get:all[name],enumerable:!0})},"__export"),__decorateClass=__name((decorators,target,key,kind)=>{for(var result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1,decorator;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp2(target,key,result),result},"__decorateClass"),_a,BaseModuleInstance=(_a=class{constructor(){this.destroyFns=[]}destroy(){for(const destroyFn of this.destroyFns)destroyFn()}},__name(_a,"BaseModuleInstance"),_a),_a2,ModuleRegistry=(_a2=class{constructor(){this.modules=[],this.dependencies=new Map,this.modulesByOptionKey=new Map}register(...modules){for(const module of modules){this.registerDependencies(module);const otherModule=this.modules.find(other=>module.type===other.type&&("optionsKey"in module&&"optionsKey"in other?module.optionsKey===other.optionsKey:!0)&&module.identifier===other.identifier);if(otherModule){if(module.packageType==="enterprise"&&otherModule.packageType==="community"){const index=this.modules.indexOf(otherModule);this.modules.splice(index,1,module),"optionsKey"in module&&this.modulesByOptionKey.set(module.optionsKey,module)}}else this.modules.push(module),"optionsKey"in module&&this.modulesByOptionKey.set(module.optionsKey,module)}}hasEnterpriseModules(){return this.modules.some(m=>m.packageType==="enterprise")}*byType(...types){const yielded=new Set,modulesByType=this.modules.filter(module=>types.includes(module.type)),calculateDependencies=__name(module=>{const deps=this.dependencies.get(module);return(deps==null?void 0:deps.flatMap(calculateDependencies).concat(deps))??[]},"calculateDependencies"),unresolvable=[];for(const module of modulesByType){const uniqueKey="optionsKey"in module?module.optionsKey:module.contextKey;if(!yielded.has(uniqueKey)){for(const dependency of calculateDependencies(uniqueKey)){if(yielded.has(dependency))continue;const dependencyModule=this.modulesByOptionKey.get(dependency);if(!dependencyModule){unresolvable.push(dependency);continue}types.includes(dependencyModule.type)&&(yield dependencyModule,yielded.add(dependency))}yield module,yielded.add(uniqueKey)}}if(unresolvable.length>0)throw new Error(`Could not resolve module dependencies: ${unresolvable}`)}registerDependencies(module){if(module.dependencies==null||module.dependencies.length===0)return;const uniqueKey="optionsKey"in module?module.optionsKey:module.contextKey;this.dependencies.set(uniqueKey,module.dependencies)}},__name(_a2,"ModuleRegistry"),_a2),moduleRegistry=new ModuleRegistry,BBoxValues={containsPoint,isEmpty,normalize};function containsPoint(bbox,x,y){return x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height}__name(containsPoint,"containsPoint");function isEmpty(bbox){return bbox==null||bbox.height===0||bbox.width===0||isNaN(bbox.height)||isNaN(bbox.width)}__name(isEmpty,"isEmpty");function normalize(bbox){let{x,y,width:width2,height:height2}=bbox;return(width2==null||width2>0)&&(height2==null||height2>0)?bbox:(x!=null&&width2!=null&&width2<0&&(width2=-width2,x=x-width2),y!=null&&height2!=null&&height2<0&&(height2=-height2,y=y-height2),{x,y,width:width2,height:height2})}__name(normalize,"normalize");var interpolate=Symbol("interpolate"),isInterpolating=__name(x=>x[interpolate]!=null,"isInterpolating");function nearestSquared(x,y,objects,maxDistanceSquared=1/0){const result={nearest:void 0,distanceSquared:maxDistanceSquared};for(const obj of objects){const thisDistance=obj.distanceSquared(x,y);if(thisDistance===0)return{nearest:obj,distanceSquared:0};thisDistance<result.distanceSquared&&(result.nearest=obj,result.distanceSquared=thisDistance)}return result}__name(nearestSquared,"nearestSquared");function nearestSquaredInContainer(x,y,container,maxDistanceSquared=1/0){var _a294;const{x:tx=x,y:ty=y}=((_a294=container.transformPoint)==null?void 0:_a294.call(container,x,y))??{},result={nearest:void 0,distanceSquared:maxDistanceSquared};for(const child of container.children){const{nearest,distanceSquared:distanceSquared2}=child.nearestSquared(tx,ty,result.distanceSquared);if(distanceSquared2===0)return{nearest,distanceSquared:distanceSquared2};distanceSquared2<result.distanceSquared&&(result.nearest=nearest,result.distanceSquared=distanceSquared2)}return result}__name(nearestSquaredInContainer,"nearestSquaredInContainer");var _a3,_BBox=(_a3=class{constructor(x,y,width2,height2){this.x=x,this.y=y,this.width=width2,this.height=height2}static fromDOMRect({x,y,width:width2,height:height2}){return new _a3(x,y,width2,height2)}static merge(boxes){let left=1/0,top=1/0,right=-1/0,bottom=-1/0;for(const box of boxes)box.x<left&&(left=box.x),box.y<top&&(top=box.y),box.x+box.width>right&&(right=box.x+box.width),box.y+box.height>bottom&&(bottom=box.y+box.height);return new _a3(left,top,right-left,bottom-top)}static nearestBox(x,y,boxes){return nearestSquared(x,y,boxes)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:this.x+this.width,bottom:this.y+this.height,toJSON(){return{}}}}clone(){const{x,y,width:width2,height:height2}=this;return new _a3(x,y,width2,height2)}equals(other){return this.x===other.x&&this.y===other.y&&this.width===other.width&&this.height===other.height}containsPoint(x,y){return BBoxValues.containsPoint(this,x,y)}intersection(other){if(!this.collidesBBox(other))return;const newX1=clamp(other.x,this.x,other.x+other.width),newY1=clamp(other.y,this.y,other.y+other.height),newX2=clamp(other.x,this.x+this.width,other.x+other.width),newY2=clamp(other.y,this.y+this.height,other.y+other.height);return new _a3(newX1,newY1,newX2-newX1,newY2-newY1)}collidesBBox(other){return this.x<other.x+other.width&&this.x+this.width>other.x&&this.y<other.y+other.height&&this.y+this.height>other.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(x,y){if(this.containsPoint(x,y))return 0;const dx=x-clamp(this.x,x,this.x+this.width),dy=y-clamp(this.y,y,this.y+this.height);return dx*dx+dy*dy}shrink(amount,position){if(typeof amount=="number")this.applyMargin(amount,position);else for(const key of Object.keys(amount)){const value=amount[key];typeof value=="number"&&this.applyMargin(value,key)}return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this}grow(amount,position){if(typeof amount=="number")this.applyMargin(-amount,position);else for(const key of Object.keys(amount)){const value=amount[key];typeof value=="number"&&this.applyMargin(-value,key)}return this}applyMargin(value,position){switch(position){case"top":this.y+=value;case"bottom":this.height-=value;break;case"left":this.x+=value;case"right":this.width-=value;break;case"vertical":this.y+=value,this.height-=value*2;break;case"horizontal":this.x+=value,this.width-=value*2;break;case void 0:this.x+=value,this.y+=value,this.width-=value*2,this.height-=value*2;break}}translate(x,y){return this.x+=x,this.y+=y,this}[interpolate](other,d){return new _a3(this.x*(1-d)+other.x*d,this.y*(1-d)+other.y*d,this.width*(1-d)+other.width*d,this.height*(1-d)+other.height*d)}},__name(_a3,"_BBox"),_a3);_BBox.zero=Object.freeze(new _BBox(0,0,0,0));_BBox.NaN=Object.freeze(new _BBox(NaN,NaN,NaN,NaN));var BBox=_BBox,LONG_TIME_PERIOD_THRESHOLD=2e3,timeOfLastLog=Date.now(),logTimeGap=__name(()=>{const timeSinceLastLog=Date.now()-timeOfLastLog;if(timeSinceLastLog>LONG_TIME_PERIOD_THRESHOLD){const prettyDuration=(Math.floor(timeSinceLastLog/100)/10).toFixed(1);logger_exports.log(`**** ${prettyDuration}s since last log message ****`)}timeOfLastLog=Date.now()},"logTimeGap"),Debug={create(...debugSelectors){return Object.assign(__name((...logContent)=>{Debug.check(...debugSelectors)&&(typeof logContent[0]=="function"&&(logContent=toArray(logContent[0]())),logTimeGap(),logger_exports.log(...logContent))},"resultFn"),{check:__name(()=>Debug.check(...debugSelectors),"check"),group:__name((name,cb)=>Debug.check(...debugSelectors)?logger_exports.logGroup(name,cb):cb(),"group")})},check(...debugSelectors){return debugSelectors.length===0&&debugSelectors.push(!0),toArray(getWindow("agChartsDebug")).some(selector=>debugSelectors.includes(selector))},inDevelopmentMode(fn){if(Debug.check("dev"))return fn()}};function clearContext({context,pixelRatio,width:width2,height:height2}){context.save(),context.resetTransform(),context.clearRect(0,0,Math.ceil(width2*pixelRatio),Math.ceil(height2*pixelRatio)),context.restore()}__name(clearContext,"clearContext");function debugContext(ctx){if(Debug.check("canvas")){const save=ctx.save.bind(ctx),restore=ctx.restore.bind(ctx);let depth=0;Object.assign(ctx,{save(){save(),depth++},restore(){if(depth===0)throw new Error("AG Charts - Unable to restore() past depth 0");restore(),depth--},verifyDepthZero(){if(depth!==0)throw new Error(`AG Charts - Save/restore depth is non-zero: ${depth}`)}})}}__name(debugContext,"debugContext");function canvasDimensions(width2,height2,pixelRatio){return[Math.floor(width2*pixelRatio),Math.floor(height2*pixelRatio)]}__name(canvasDimensions,"canvasDimensions");var _a4,HdpiOffscreenCanvas=(_a4=class{constructor(options){const{width:width2,height:height2,pixelRatio,willReadFrequently=!1}=options;this.width=width2,this.height=height2,this.pixelRatio=pixelRatio;const[canvasWidth,canvasHeight]=canvasDimensions(width2,height2,pixelRatio);this.canvas=new OffscreenCanvas(canvasWidth,canvasHeight),this.context=this.canvas.getContext("2d",{willReadFrequently}),this.context.setTransform(pixelRatio,0,0,pixelRatio,0,0),debugContext(this.context)}drawImage(context,dx=0,dy=0){return context.drawImage(this.canvas,dx,dy)}transferToImageBitmap(){return this.canvas.transferToImageBitmap()}resize(width2,height2,pixelRatio){if(!(width2>0&&height2>0))return;const{canvas,context}=this;if(width2!==this.width||height2!==this.height||pixelRatio!==this.pixelRatio){const[canvasWidth,canvasHeight]=canvasDimensions(width2,height2,pixelRatio);canvas.width=canvasWidth,canvas.height=canvasHeight}context.setTransform(pixelRatio,0,0,pixelRatio,0,0),this.width=width2,this.height=height2,this.pixelRatio=pixelRatio}clear(){clearContext(this)}destroy(){this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0),this.canvas=null,this.context=null,Object.freeze(this)}},__name(_a4,"HdpiOffscreenCanvas"),_a4),ID_MAP=new Map;function resetIds(){ID_MAP.clear()}__name(resetIds,"resetIds");function createId(instance){const constructor=instance.constructor,className=Object.hasOwn(constructor,"className")?constructor.className:constructor.name;if(!className)throw new Error(`The ${constructor} is missing the 'className' property.`);const nextId=(ID_MAP.get(className)??0)+1;return ID_MAP.set(className,nextId),`${className}-${nextId}`}__name(createId,"createId");function generateUUID(){var _a294;return((_a294=crypto.randomUUID)==null?void 0:_a294.call(crypto))??generateUUIDv4()}__name(generateUUID,"generateUUID");function generateUUIDv4(){const uuidArray=new Uint8Array(16);crypto.getRandomValues(uuidArray),uuidArray[6]=uuidArray[6]&15|64,uuidArray[8]=uuidArray[8]&63|128;let uuid="";for(let i=0;i<uuidArray.length;i++)(i===4||i===6||i===8||i===10)&&(uuid+="-"),uuid+=uuidArray[i].toString(16).padStart(2,"0");return uuid}__name(generateUUIDv4,"generateUUIDv4");function SceneChangeDetection(opts){return function(target,key){const privateKey=`__${key}`;target[key]||prepareGetSet(target,key,privateKey,opts)}}__name(SceneChangeDetection,"SceneChangeDetection");function prepareGetSet(target,key,privateKey,opts){const{type="normal",changeCb,convertor,checkDirtyOnAssignment=!1}=opts??{},requiredOpts={changeCb,checkDirtyOnAssignment,convertor};let setter;switch(type){case"normal":setter=buildNormalSetter(privateKey,requiredOpts);break;case"transform":setter=buildTransformSetter(privateKey);break;case"path":setter=buildPathSetter(privateKey);break}setter=buildCheckDirtyChain(privateKey,buildChangeCallbackChain(buildConvertorChain(setter,requiredOpts),requiredOpts),requiredOpts),Object.defineProperty(target,key,{set:setter,get:__name(function(){return this[privateKey]},"getter"),enumerable:!0,configurable:!0})}__name(prepareGetSet,"prepareGetSet");function buildConvertorChain(setterFn,opts){const{convertor}=opts;return convertor?function(value){setterFn.call(this,convertor(value))}:setterFn}__name(buildConvertorChain,"buildConvertorChain");var NO_CHANGE=Symbol("no-change");function buildChangeCallbackChain(setterFn,opts){const{changeCb}=opts;return changeCb?function(value){const change=setterFn.call(this,value);return change!==NO_CHANGE&&changeCb.call(this,this),change}:setterFn}__name(buildChangeCallbackChain,"buildChangeCallbackChain");function buildCheckDirtyChain(privateKey,setterFn,opts){const{checkDirtyOnAssignment}=opts;return checkDirtyOnAssignment?function(value){const change=setterFn.call(this,value);return(value==null?void 0:value._dirty)===!0&&this.markDirty(privateKey),change}:setterFn}__name(buildCheckDirtyChain,"buildCheckDirtyChain");function buildNormalSetter(privateKey,opts){const{changeCb}=opts;return function(value){const oldValue=this[privateKey];return value!==oldValue?(this[privateKey]=value,this.markDirty(privateKey),changeCb==null||changeCb(this),value):NO_CHANGE}}__name(buildNormalSetter,"buildNormalSetter");function buildTransformSetter(privateKey){return function(value){const oldValue=this[privateKey];return value!==oldValue?(this[privateKey]=value,this.markDirtyTransform(),value):NO_CHANGE}}__name(buildTransformSetter,"buildTransformSetter");function buildPathSetter(privateKey){return function(value){const oldValue=this[privateKey];return value!==oldValue?(this[privateKey]=value,this._dirtyPath||(this._dirtyPath=!0,this.markDirty(privateKey)),value):NO_CHANGE}}__name(buildPathSetter,"buildPathSetter");var PointerEvents=(PointerEvents2=>(PointerEvents2[PointerEvents2.All=0]="All",PointerEvents2[PointerEvents2.None=1]="None",PointerEvents2))(PointerEvents||{}),_a5,_Node=(_a5=class{constructor(options){this.serialNumber=_a5._nextSerialNumber++,this.childNodeCounts={groups:0,nonGroups:0,thisComplexity:0,complexity:0},this.id=createId(this),this.pointerEvents=0,this._dirty=!0,this.dirtyZIndex=!1,this.isContainerNode=!1,this.visible=!0,this.zIndex=0,this.name=options==null?void 0:options.name,this.tag=(options==null?void 0:options.tag)??NaN,this.zIndex=(options==null?void 0:options.zIndex)??0,((options==null?void 0:options.debugDirty)??_a5._debugEnabled)&&(this._debugDirtyProperties=new Map([["__first__",[]]]))}static toSVG(node,width2,height2){var _a294,_b;const svg=node==null?void 0:node.toSVG();if(svg==null||!svg.elements.length&&!((_a294=svg.defs)!=null&&_a294.length))return;const root=createSvgElement("svg");if(root.setAttribute("width",String(width2)),root.setAttribute("height",String(height2)),root.setAttribute("viewBox",`0 0 ${width2} ${height2}`),(_b=svg.defs)!=null&&_b.length){const defs=createSvgElement("defs");defs.append(...svg.defs),root.append(defs)}return root.append(...svg.elements),root.outerHTML}static*extractBBoxes(nodes,skipInvisible){for(const n of nodes)if(!skipInvisible||n.visible&&!n.transitionOut){const bbox=n.getBBox();bbox&&(yield bbox)}}get datum(){return this._datum}set datum(datum){this._datum!==datum&&(this._previousDatum=this._datum,this._datum=datum)}get previousDatum(){return this._previousDatum}get layerManager(){return this._layerManager}get dirty(){return this._dirty}closestDatum(){for(const{datum}of this.traverseUp(!0))if(datum!=null)return datum}preRender(renderCtx,thisComplexity=1){this.childNodeCounts.groups=0,this.childNodeCounts.nonGroups=1,this.childNodeCounts.complexity=thisComplexity,this.childNodeCounts.thisComplexity=thisComplexity;for(const child of this.children()){const childCounts=child.preRender(renderCtx);this.childNodeCounts.groups+=childCounts.groups,this.childNodeCounts.nonGroups+=childCounts.nonGroups,this.childNodeCounts.complexity+=childCounts.complexity}return this.childNodeCounts}render(renderCtx){const{stats}=renderCtx;if(this._dirty=!1,this.debugDirtyProperties(),renderCtx.debugNodeSearch){const idOrName=this.name??this.id;renderCtx.debugNodeSearch.some(v=>typeof v=="string"?v===idOrName:v.test(idOrName))&&(renderCtx.debugNodes[this.name??this.id]=this)}stats&&(stats.nodesRendered++,stats.opsPerformed+=this.childNodeCounts.thisComplexity)}_setLayerManager(value){this._layerManager=value,this._debug=value==null?void 0:value.debug;for(const child of this.children())child._setLayerManager(value)}sortChildren(compareFn){if(this.dirtyZIndex=!1,!this.childNodes)return;const sortedChildren=[...this.childNodes].sort(compareFn);this.childNodes.clear();for(const child of sortedChildren)this.childNodes.add(child)}*traverseUp(includeSelf){let node=this;for(includeSelf&&(yield node);node=node.parentNode;)yield node}*children(){if(this.childNodes)for(const child of this.childNodes)yield child}*descendants(){for(const child of this.children())yield child,yield*child.descendants()}isLeaf(){var _a294;return!((_a294=this.childNodes)!=null&&_a294.size)}isRoot(){return!this.parentNode}append(nodes){var _a294;this.childNodes??(this.childNodes=new Set);for(const node of toIterable(nodes))(_a294=node.parentNode)==null||_a294.removeChild(node),this.childNodes.add(node),node.parentNode=this,node._setLayerManager(this.layerManager);this.invalidateCachedBBox(),this.dirtyZIndex=!0,this.markDirty()}appendChild(node){return this.append(node),node}removeChild(node){var _a294;if(!((_a294=this.childNodes)!=null&&_a294.delete(node)))throw new Error(`AG Charts - internal error, unknown child node ${node.name??node.id} in $${this.name??this.id}`);delete node.parentNode,node._setLayerManager(),this.invalidateCachedBBox(),this.dirtyZIndex=!0,this.markDirty()}remove(){var _a294;(_a294=this.parentNode)==null||_a294.removeChild(this)}clear(){var _a294;for(const child of this.children())delete child.parentNode,child._setLayerManager();(_a294=this.childNodes)==null||_a294.clear(),this.invalidateCachedBBox()}destroy(){var _a294;(_a294=this.parentNode)==null||_a294.removeChild(this)}setProperties(styles,pickKeys){if(pickKeys)for(const key of pickKeys)this[key]=styles[key];else Object.assign(this,styles);return this}containsPoint(_x,_y){return!1}pickNode(x,y){if(!(!this.visible||this.pointerEvents===1||!this.containsPoint(x,y))){if(this.childNodes!=null&&this.childNodes.size!==0){const children=[...this.children()];for(let i=children.length-1;i>=0;i--){const hit=children[i].pickNode(x,y);if(hit)return hit}}else if(!this.isContainerNode)return this}}pickNodes(x,y,into=[]){if(!this.visible||this.pointerEvents===1||!this.containsPoint(x,y))return into;this.isContainerNode||into.push(this);for(const child of this.children())child.pickNodes(x,y,into);return into}invalidateCachedBBox(){var _a294;this.cachedBBox!=null&&(this.cachedBBox=void 0,(_a294=this.parentNode)==null||_a294.invalidateCachedBBox())}getBBox(){return this.cachedBBox==null&&(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}markDirty(property){const{_dirty}=this;property!=null&&this._debugDirtyProperties&&this.markDebugProperties(property),!(this.cachedBBox==null&&_dirty)&&(this.invalidateCachedBBox(),this._dirty=!0,this.parentNode&&this.parentNode.markDirty())}markClean(){if(this._dirty){this._dirty=!1,this.debugDirtyProperties();for(const child of this.children())child.markClean()}}markDebugProperties(property){var _a294,_b,_c;const sources=((_a294=this._debugDirtyProperties)==null?void 0:_a294.get(property))??[],caller=((_b=new Error().stack)==null?void 0:_b.split(`
`).filter(line=>line!=="Error"&&!line.includes(".markDebugProperties")&&!line.includes(".markDirty")&&!line.includes("Object.assign ")&&!line.includes(`${this.constructor.name}.`)))??"unknown";sources.push(caller[0].replace(" at ","").trim()),(_c=this._debugDirtyProperties)==null||_c.set(property,sources)}debugDirtyProperties(){this._debugDirtyProperties!=null&&(this._debugDirtyProperties.has("__first__")||this._debugDirtyProperties.forEach((sources,property)=>{sources.length>1&&(console.groupCollapsed(`Property changed multiple times before render: ${this.constructor.name}.${property} (${sources.length}x)`),sources.forEach(source=>console.log(source)),console.groupEnd())}),this._debugDirtyProperties.clear())}onZIndexChange(){const{parentNode}=this;parentNode&&(parentNode.dirtyZIndex=!0)}toSVG(){}},__name(_a5,"_Node"),_a5);_Node._nextSerialNumber=0;_Node._debugEnabled=!1;__decorateClass([SceneChangeDetection()],_Node.prototype,"visible",2);__decorateClass([SceneChangeDetection({changeCb:__name(target=>target.onZIndexChange(),"changeCb")})],_Node.prototype,"zIndex",2);var Node=_Node,BREAK_TRANSFORM_CHAIN=Symbol("BREAK"),CONFIG_KEY="__decorator_config";function addFakeTransformToInstanceProperty(target,propertyKeyOrSymbol){initialiseConfig(target,propertyKeyOrSymbol).optional=!0}__name(addFakeTransformToInstanceProperty,"addFakeTransformToInstanceProperty");function initialiseConfig(target,propertyKeyOrSymbol){Object.getOwnPropertyDescriptor(target,CONFIG_KEY)==null&&Object.defineProperty(target,CONFIG_KEY,{value:{}});const config=target[CONFIG_KEY],propertyKey=propertyKeyOrSymbol.toString();if(typeof config[propertyKey]<"u")return config[propertyKey];const valuesMap=new WeakMap;config[propertyKey]={setters:[],getters:[],observers:[],valuesMap};const descriptor=Object.getOwnPropertyDescriptor(target,propertyKeyOrSymbol),prevSet=descriptor==null?void 0:descriptor.set,prevGet=descriptor==null?void 0:descriptor.get;return Object.defineProperty(target,propertyKeyOrSymbol,{set:__name(function(value){const{setters,observers}=config[propertyKey];let oldValue;setters.some(f=>f.length>2)&&(oldValue=prevGet?prevGet.call(this):valuesMap.get(this));for(const transformFn of setters)if(value=transformFn(this,propertyKeyOrSymbol,value,oldValue),value===BREAK_TRANSFORM_CHAIN)return;prevSet?prevSet.call(this,value):valuesMap.set(this,value);for(const observerFn of observers)observerFn(this,value,oldValue)},"setter"),get:__name(function(){let value=prevGet?prevGet.call(this):valuesMap.get(this);for(const transformFn of config[propertyKey].getters)if(value=transformFn(this,propertyKeyOrSymbol,value),value===BREAK_TRANSFORM_CHAIN)return;return value},"getter"),enumerable:!0,configurable:!1}),config[propertyKey]}__name(initialiseConfig,"initialiseConfig");function addTransformToInstanceProperty(setTransform,getTransform,configMetadata){return(target,propertyKeyOrSymbol)=>{const config=initialiseConfig(target,propertyKeyOrSymbol);config.setters.push(setTransform),getTransform&&config.getters.unshift(getTransform),configMetadata&&Object.assign(config,configMetadata)}}__name(addTransformToInstanceProperty,"addTransformToInstanceProperty");function addObserverToInstanceProperty(setObserver){return(target,propertyKeyOrSymbol)=>{initialiseConfig(target,propertyKeyOrSymbol).observers.push(setObserver)}}__name(addObserverToInstanceProperty,"addObserverToInstanceProperty");function isDecoratedObject(target){return typeof target<"u"&&CONFIG_KEY in target}__name(isDecoratedObject,"isDecoratedObject");function listDecoratedProperties(target){const targets=new Set;for(;isDecoratedObject(target);)targets.add(target==null?void 0:target[CONFIG_KEY]),target=Object.getPrototypeOf(target);return Array.from(targets).flatMap(configMap=>Object.keys(configMap))}__name(listDecoratedProperties,"listDecoratedProperties");function extractDecoratedProperties(target){return listDecoratedProperties(target).reduce((result,key)=>(result[key]=target[key]??null,result),{})}__name(extractDecoratedProperties,"extractDecoratedProperties");function extractDecoratedPropertyMetadata(target,propertyKeyOrSymbol){const propertyKey=propertyKeyOrSymbol.toString();for(;isDecoratedObject(target);){const config=target[CONFIG_KEY];if(Object.hasOwn(config,propertyKey))return config[propertyKey];target=Object.getPrototypeOf(target)}}__name(extractDecoratedPropertyMetadata,"extractDecoratedPropertyMetadata");function objectsEqual(a,b){return Array.isArray(a)?!Array.isArray(b)||a.length!==b.length?!1:a.every((av,i)=>objectsEqual(av,b[i])):isPlainObject(a)?isPlainObject(b)?objectsEqualWith(a,b,objectsEqual):!1:a===b}__name(objectsEqual,"objectsEqual");function objectsEqualWith(a,b,cmp2){for(const key of Object.keys(b))if(!(key in a))return!1;for(const key of Object.keys(a))if(!(key in b)||!cmp2(a[key],b[key]))return!1;return!0}__name(objectsEqualWith,"objectsEqualWith");function mergeDefaults(...sources){const target={};for(const source of sources){if(!isObject(source))continue;const keys=isDecoratedObject(source)?listDecoratedProperties(source):Object.keys(source);for(const key of keys)isPlainObject(target[key])&&isPlainObject(source[key])?target[key]=mergeDefaults(target[key],source[key]):target[key]??(target[key]=source[key])}return target}__name(mergeDefaults,"mergeDefaults");function merge(...sources){const target={};for(const source of sources){if(!isObject(source))continue;const keys=isDecoratedObject(source)?listDecoratedProperties(source):Object.keys(source);for(const key of keys)isPlainObject(target[key])&&isPlainObject(source[key])?target[key]=merge(target[key],source[key]):key in target||(target[key]??(target[key]=source[key]))}return target}__name(merge,"merge");function mergeArrayDefaults(dataArray,...itemDefaults){return itemDefaults&&isArray(dataArray)?dataArray.map(item=>mergeDefaults(item,...itemDefaults)):dataArray}__name(mergeArrayDefaults,"mergeArrayDefaults");function mapValues(object4,mapper){const result={};for(const[key,value]of entries(object4))result[key]=mapper(value,key,object4);return result}__name(mapValues,"mapValues");function without(object4,keys){const clone2={...object4};for(const key of keys)delete clone2[key];return clone2}__name(without,"without");function getPath(object4,path){return(isArray(path)?path:path.split(".")).reduce((value,pathKey)=>value[pathKey],object4)}__name(getPath,"getPath");var SKIP_JS_BUILTINS=new Set(["__proto__","constructor","prototype"]);function setPath(object4,path,newValue){const pathArray=isArray(path)?path.slice():path.split("."),lastKey=pathArray.pop();if(pathArray.some(p=>SKIP_JS_BUILTINS.has(p)))return;const lastObject=pathArray.reduce((value,pathKey)=>value[pathKey],object4);return lastObject[lastKey]=newValue,lastObject[lastKey]}__name(setPath,"setPath");function partialAssign(keysToCopy,target,source){if(source===void 0)return target;for(const key of keysToCopy){const value=source[key];value!==void 0&&(target[key]=value)}return target}__name(partialAssign,"partialAssign");function deepFreeze(obj){return obj==null||typeof obj!="object"||!isPlainObject(obj)||(Object.freeze(obj),Object.getOwnPropertyNames(obj).forEach(prop=>{const value=obj[prop];value!==null&&(typeof value=="object"||typeof value=="function")&&!Object.isFrozen(value)&&deepFreeze(value)})),obj}__name(deepFreeze,"deepFreeze");var twoPi=Math.PI*2,halfPi=Math.PI/2;function normalizeAngle360(radians){return radians%=twoPi,radians+=twoPi,radians%=twoPi,radians}__name(normalizeAngle360,"normalizeAngle360");function normalizeAngle360Inclusive(radians){return radians%=twoPi,radians+=twoPi,radians!==twoPi&&(radians%=twoPi),radians}__name(normalizeAngle360Inclusive,"normalizeAngle360Inclusive");function normalizeAngle180(radians){return radians%=twoPi,radians<-Math.PI?radians+=twoPi:radians>=Math.PI&&(radians-=twoPi),radians}__name(normalizeAngle180,"normalizeAngle180");function isBetweenAngles(targetAngle,startAngle,endAngle){const t=normalizeAngle360(targetAngle),a0=normalizeAngle360(startAngle),a1=normalizeAngle360(endAngle);return a0<a1?a0<=t&&t<=a1:a0>a1?a0<=t||t<=a1:!0}__name(isBetweenAngles,"isBetweenAngles");function toRadians(degrees){return degrees/180*Math.PI}__name(toRadians,"toRadians");function toDegrees(radians){return radians/Math.PI*180}__name(toDegrees,"toDegrees");function angleBetween(angle0,angle1){return angle0=normalizeAngle360(angle0),angle1=normalizeAngle360(angle1),angle1-angle0+(angle0>angle1?twoPi:0)}__name(angleBetween,"angleBetween");function getAngleRatioRadians(angle2){const normalizedAngle=normalizeAngle360(angle2);return normalizedAngle<=halfPi?normalizedAngle/halfPi:normalizedAngle<=Math.PI?(Math.PI-normalizedAngle)/halfPi:normalizedAngle<=1.5*Math.PI?(normalizedAngle-Math.PI)/halfPi:(twoPi-normalizedAngle)/halfPi}__name(getAngleRatioRadians,"getAngleRatioRadians");var lerp=__name((x,y,t)=>x*(1-t)+y*t,"lerp"),srgbToLinear=__name(value=>{const sign=value<0?-1:1,abs=Math.abs(value);return abs<=.04045?value/12.92:sign*((abs+.055)/1.055)**2.4},"srgbToLinear"),srgbFromLinear=__name(value=>{const sign=value<0?-1:1,abs=Math.abs(value);return abs>.0031308?sign*(1.055*abs**(1/2.4)-.055):12.92*value},"srgbFromLinear"),_a6,_Color=(_a6=class{constructor(r,g,b,a=1){this.r=clamp(0,r||0,1),this.g=clamp(0,g||0,1),this.b=clamp(0,b||0,1),this.a=clamp(0,a||0,1)}static validColorString(str){return str.indexOf("#")>=0?!!_a6.parseHex(str):str.indexOf("rgb")>=0?!!_a6.stringToRgba(str):_a6.nameToHex.has(str.toLowerCase())}static fromString(str){if(str.indexOf("#")>=0)return _a6.fromHexString(str);const hex=_a6.nameToHex.get(str.toLowerCase());if(hex)return _a6.fromHexString(hex);if(str.indexOf("rgb")>=0)return _a6.fromRgbaString(str);throw new Error(`Invalid color string: '${str}'`)}static parseHex(input){input=input.replace(/ /g,"").slice(1);let parts;switch(input.length){case 6:case 8:parts=[];for(let i=0;i<input.length;i+=2)parts.push(parseInt(`${input[i]}${input[i+1]}`,16));break;case 3:case 4:parts=input.split("").map(p=>parseInt(p,16)).map(p=>p+p*16);break}if((parts==null?void 0:parts.length)>=3&&parts.every(p=>p>=0))return parts.length===3&&parts.push(255),parts}static fromHexString(str){const values=_a6.parseHex(str);if(values){const[r,g,b,a]=values;return new _a6(r/255,g/255,b/255,a/255)}throw new Error(`Malformed hexadecimal color string: '${str}'`)}static stringToRgba(str){let po=-1,pc=-1;for(let i=0;i<str.length;i++){const c=str[i];if(po===-1&&c==="(")po=i;else if(c===")"){pc=i;break}}if(po===-1||pc===-1)return;const parts=str.substring(po+1,pc).split(","),rgba=[];for(let i=0;i<parts.length;i++){const part=parts[i];let value=parseFloat(part);if(!Number.isFinite(value))return;part.indexOf("%")>=0?(value=clamp(0,value,100),value/=100):i===3?value=clamp(0,value,1):(value=clamp(0,value,255),value/=255),rgba.push(value)}return rgba}static fromRgbaString(str){const rgba=_a6.stringToRgba(str);if(rgba){if(rgba.length===3)return new _a6(rgba[0],rgba[1],rgba[2]);if(rgba.length===4)return new _a6(rgba[0],rgba[1],rgba[2],rgba[3])}throw new Error(`Malformed rgb/rgba color string: '${str}'`)}static fromArray(arr){if(arr.length===4)return new _a6(arr[0],arr[1],arr[2],arr[3]);if(arr.length===3)return new _a6(arr[0],arr[1],arr[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(h,s,b,alpha=1){const rgb=_a6.HSBtoRGB(h,s,b);return new _a6(rgb[0],rgb[1],rgb[2],alpha)}static fromHSL(h,s,l,alpha=1){const rgb=_a6.HSLtoRGB(h,s,l);return new _a6(rgb[0],rgb[1],rgb[2],alpha)}static fromOKLCH(l,c,h,alpha=1){const rgb=_a6.OKLCHtoRGB(l,c,h);return new _a6(rgb[0],rgb[1],rgb[2],alpha)}static padHex(str){return str.length===1?"0"+str:str}toHexString(){let hex="#"+_a6.padHex(Math.round(this.r*255).toString(16))+_a6.padHex(Math.round(this.g*255).toString(16))+_a6.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(hex+=_a6.padHex(Math.round(this.a*255).toString(16))),hex}toRgbaString(fractionDigits=3){const components=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],k=Math.pow(10,fractionDigits);return this.a!==1?(components.push(Math.round(this.a*k)/k),`rgba(${components.join(", ")})`):`rgb(${components.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return _a6.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(r,g,b){const LSRGB0=srgbToLinear(r),LSRGB1=srgbToLinear(g),LSRGB2=srgbToLinear(b),LMS0=Math.cbrt(.4122214708*LSRGB0+.5363325363*LSRGB1+.0514459929*LSRGB2),LMS1=Math.cbrt(.2119034982*LSRGB0+.6806995451*LSRGB1+.1073969566*LSRGB2),LMS2=Math.cbrt(.0883024619*LSRGB0+.2817188376*LSRGB1+.6299787005*LSRGB2),OKLAB0=.2104542553*LMS0+.793617785*LMS1-.0040720468*LMS2,OKLAB1=1.9779984951*LMS0-2.428592205*LMS1+.4505937099*LMS2,OKLAB2=.0259040371*LMS0+.7827717662*LMS1-.808675766*LMS2,hue=Math.atan2(OKLAB2,OKLAB1)*180/Math.PI,OKLCH0=OKLAB0,OKLCH1=Math.hypot(OKLAB1,OKLAB2),OKLCH2=hue>=0?hue:hue+360;return[OKLCH0,OKLCH1,OKLCH2]}static OKLCHtoRGB(l,c,h){const OKLAB0=l,OKLAB1=c*Math.cos(h*Math.PI/180),OKLAB2=c*Math.sin(h*Math.PI/180),LMS0=(OKLAB0+.3963377774*OKLAB1+.2158037573*OKLAB2)**3,LMS1=(OKLAB0-.1055613458*OKLAB1-.0638541728*OKLAB2)**3,LMS2=(OKLAB0-.0894841775*OKLAB1-1.291485548*OKLAB2)**3,LSRGB0=4.0767416621*LMS0-3.3077115913*LMS1+.2309699292*LMS2,LSRGB1=-1.2684380046*LMS0+2.6097574011*LMS1-.3413193965*LMS2,LSRGB2=-.0041960863*LMS0-.7034186147*LMS1+1.707614701*LMS2,SRGB0=srgbFromLinear(LSRGB0),SRGB1=srgbFromLinear(LSRGB1),SRGB2=srgbFromLinear(LSRGB2);return[SRGB0,SRGB1,SRGB2]}static RGBtoHSL(r,g,b){const min=Math.min(r,g,b),max=Math.max(r,g,b),l=(max+min)/2;let h,s;if(max===min)h=0,s=0;else{const delta3=max-min;s=l>.5?delta3/(2-max-min):delta3/(max+min),max===r?h=(g-b)/delta3+(g<b?6:0):max===g?h=(b-r)/delta3+2:h=(r-g)/delta3+4,h*=360/6}return[h,s,l]}static HSLtoRGB(h,s,l){if(h=(h%360+360)%360,s===0)return[l,l,l];const q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;function hueToRgb(t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+(q-p)*6*t:t<1/2?q:t<2/3?p+(q-p)*(2/3-t)*6:p}__name(hueToRgb,"hueToRgb");const r=hueToRgb(h/360+1/3),g=hueToRgb(h/360),b=hueToRgb(h/360-1/3);return[r,g,b]}static RGBtoHSB(r,g,b){const min=Math.min(r,g,b),max=Math.max(r,g,b),S=max===0?0:(max-min)/max;let H=0;if(min!==max){const delta3=max-min,rc=(max-r)/delta3,gc=(max-g)/delta3,bc=(max-b)/delta3;r===max?H=bc-gc:g===max?H=2+rc-bc:H=4+gc-rc,H/=6,H<0&&(H=H+1)}return[H*360,S,max]}static HSBtoRGB(H,S,B){H=(H%360+360)%360/360;let r=0,g=0,b=0;if(S===0)r=g=b=B;else{const h=(H-Math.floor(H))*6,f=h-Math.floor(h),p=B*(1-S),q=B*(1-S*f),t=B*(1-S*(1-f));switch(h>>0){case 0:r=B,g=t,b=p;break;case 1:r=q,g=B,b=p;break;case 2:r=p,g=B,b=t;break;case 3:r=p,g=q,b=B;break;case 4:r=t,g=p,b=B;break;case 5:r=B,g=p,b=q;break}}return[r,g,b]}static mix(c0,c1,t){return new _a6(lerp(c0.r,c1.r,t),lerp(c0.g,c1.g,t),lerp(c0.b,c1.b,t),lerp(c0.a,c1.a,t))}static lighten(c,t){const oklch=_a6.RGBtoOKLCH(c.r,c.g,c.b);return _a6.fromOKLCH(clamp(0,oklch[0]+t,1),oklch[1],oklch[2])}static darken(c,t){const oklch=_a6.RGBtoOKLCH(c.r,c.g,c.b);return _a6.fromOKLCH(clamp(0,oklch[0]-t,1),oklch[1],oklch[2])}static interpolate(colors,count){const step=1/(colors.length-1),oklchColors=colors.map(c=>_a6.RGBtoOKLCH(c.r,c.g,c.b));return Array.from({length:count},(_,i)=>{const t=i/(count-1),index=colors.length<=2?0:Math.min(Math.floor(t*(colors.length-1)),colors.length-2),q=(t-index*step)/step,c0=oklchColors[index],c1=oklchColors[index+1];return _a6.fromOKLCH(lerp(c0[0],c1[0],q),lerp(c0[1],c1[1],q),lerp(c0[2],c1[2],q))})}},__name(_a6,"_Color"),_a6);_Color.nameToHex=new Map([["aliceblue","#F0F8FF"],["antiquewhite","#FAEBD7"],["aqua","#00FFFF"],["aquamarine","#7FFFD4"],["azure","#F0FFFF"],["beige","#F5F5DC"],["bisque","#FFE4C4"],["black","#000000"],["blanchedalmond","#FFEBCD"],["blue","#0000FF"],["blueviolet","#8A2BE2"],["brown","#A52A2A"],["burlywood","#DEB887"],["cadetblue","#5F9EA0"],["chartreuse","#7FFF00"],["chocolate","#D2691E"],["coral","#FF7F50"],["cornflowerblue","#6495ED"],["cornsilk","#FFF8DC"],["crimson","#DC143C"],["cyan","#00FFFF"],["darkblue","#00008B"],["darkcyan","#008B8B"],["darkgoldenrod","#B8860B"],["darkgray","#A9A9A9"],["darkgreen","#006400"],["darkgrey","#A9A9A9"],["darkkhaki","#BDB76B"],["darkmagenta","#8B008B"],["darkolivegreen","#556B2F"],["darkorange","#FF8C00"],["darkorchid","#9932CC"],["darkred","#8B0000"],["darksalmon","#E9967A"],["darkseagreen","#8FBC8F"],["darkslateblue","#483D8B"],["darkslategray","#2F4F4F"],["darkslategrey","#2F4F4F"],["darkturquoise","#00CED1"],["darkviolet","#9400D3"],["deeppink","#FF1493"],["deepskyblue","#00BFFF"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1E90FF"],["firebrick","#B22222"],["floralwhite","#FFFAF0"],["forestgreen","#228B22"],["fuchsia","#FF00FF"],["gainsboro","#DCDCDC"],["ghostwhite","#F8F8FF"],["gold","#FFD700"],["goldenrod","#DAA520"],["gray","#808080"],["green","#008000"],["greenyellow","#ADFF2F"],["grey","#808080"],["honeydew","#F0FFF0"],["hotpink","#FF69B4"],["indianred","#CD5C5C"],["indigo","#4B0082"],["ivory","#FFFFF0"],["khaki","#F0E68C"],["lavender","#E6E6FA"],["lavenderblush","#FFF0F5"],["lawngreen","#7CFC00"],["lemonchiffon","#FFFACD"],["lightblue","#ADD8E6"],["lightcoral","#F08080"],["lightcyan","#E0FFFF"],["lightgoldenrodyellow","#FAFAD2"],["lightgray","#D3D3D3"],["lightgreen","#90EE90"],["lightgrey","#D3D3D3"],["lightpink","#FFB6C1"],["lightsalmon","#FFA07A"],["lightseagreen","#20B2AA"],["lightskyblue","#87CEFA"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#B0C4DE"],["lightyellow","#FFFFE0"],["lime","#00FF00"],["limegreen","#32CD32"],["linen","#FAF0E6"],["magenta","#FF00FF"],["maroon","#800000"],["mediumaquamarine","#66CDAA"],["mediumblue","#0000CD"],["mediumorchid","#BA55D3"],["mediumpurple","#9370DB"],["mediumseagreen","#3CB371"],["mediumslateblue","#7B68EE"],["mediumspringgreen","#00FA9A"],["mediumturquoise","#48D1CC"],["mediumvioletred","#C71585"],["midnightblue","#191970"],["mintcream","#F5FFFA"],["mistyrose","#FFE4E1"],["moccasin","#FFE4B5"],["navajowhite","#FFDEAD"],["navy","#000080"],["oldlace","#FDF5E6"],["olive","#808000"],["olivedrab","#6B8E23"],["orange","#FFA500"],["orangered","#FF4500"],["orchid","#DA70D6"],["palegoldenrod","#EEE8AA"],["palegreen","#98FB98"],["paleturquoise","#AFEEEE"],["palevioletred","#DB7093"],["papayawhip","#FFEFD5"],["peachpuff","#FFDAB9"],["peru","#CD853F"],["pink","#FFC0CB"],["plum","#DDA0DD"],["powderblue","#B0E0E6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#FF0000"],["rosybrown","#BC8F8F"],["royalblue","#4169E1"],["saddlebrown","#8B4513"],["salmon","#FA8072"],["sandybrown","#F4A460"],["seagreen","#2E8B57"],["seashell","#FFF5EE"],["sienna","#A0522D"],["silver","#C0C0C0"],["skyblue","#87CEEB"],["slateblue","#6A5ACD"],["slategray","#708090"],["slategrey","#708090"],["snow","#FFFAFA"],["springgreen","#00FF7F"],["steelblue","#4682B4"],["tan","#D2B48C"],["teal","#008080"],["thistle","#D8BFD8"],["tomato","#FF6347"],["transparent","#00000000"],["turquoise","#40E0D0"],["violet","#EE82EE"],["wheat","#F5DEB3"],["white","#FFFFFF"],["whitesmoke","#F5F5F5"],["yellow","#FFFF00"],["yellowgreen","#9ACD32"]]);var Color=_Color,_a7,AbstractScale=(_a7=class{ticks(_ticks,_domain,_visibleRange){}niceDomain(_ticks,domain=this.domain){return domain}tickFormatter(_params){}datumFormatter(_params){}get bandwidth(){}get step(){}get inset(){}},__name(_a7,"AbstractScale"),_a7),Invalidating=__name((target,propertyKey)=>{const mappedProperty=Symbol(String(propertyKey));target[mappedProperty]=void 0,Object.defineProperty(target,propertyKey,{get(){return this[mappedProperty]},set(newValue){this[mappedProperty]!==newValue&&(this[mappedProperty]=newValue,this.invalid=!0)},enumerable:!0,configurable:!1})},"Invalidating"),convertColorStringToOklcha=__name(v=>{const color6=Color.fromString(v),[l,c,h]=Color.RGBtoOKLCH(color6.r,color6.g,color6.b);return{l,c,h,a:color6.a}},"convertColorStringToOklcha"),delta=1e-6,isAchromatic=__name(x=>x.c<delta||x.l<delta||x.l>1-delta,"isAchromatic"),interpolateOklch=__name((x,y,d)=>{d=clamp(0,d,1);let h;if(isAchromatic(x))h=y.h;else if(isAchromatic(y))h=x.h;else{const xH=x.h;let yH=y.h;const deltaH=y.h-x.h;deltaH>180?yH-=360:deltaH<-180&&(yH+=360),h=xH*(1-d)+yH*d}const c=x.c*(1-d)+y.c*d,l=x.l*(1-d)+y.l*d,a=x.a*(1-d)+y.a*d;return Color.fromOKLCH(l,c,h,a)},"interpolateOklch"),_a8,ColorScale=(_a8=class extends AbstractScale{constructor(){super(...arguments),this.type="color",this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(convertColorStringToOklcha)}update(){const{domain,range:range3}=this;domain.length<2&&(logger_exports.warnOnce("`colorDomain` should have at least 2 values."),domain.length===0?domain.push(0,1):domain.length===1&&domain.push(domain[0]+1));for(let i=1;i<domain.length;i++){const a=domain[i-1],b=domain[i];if(a>=b){logger_exports.warnOnce("`colorDomain` values should be supplied in ascending order."),domain.sort((a2,b2)=>a2-b2);break}}if(range3.length<domain.length)for(let i=range3.length;i<domain.length;i++)range3.push(range3.length>0?range3[0]:"black");this.parsedRange=this.range.map(convertColorStringToOklcha)}normalizeDomains(...domains){return{domain:domains.flat(),animatable:!0}}toDomain(){}convert(x){this.refresh();const{domain,range:range3,parsedRange}=this,d0=domain[0],d1=domain.at(-1),r0=range3[0],r1=range3[range3.length-1];if(x<=d0)return r0;if(x>=d1)return r1;let index,q;if(domain.length===2){const t=(x-d0)/(d1-d0),step=1/(range3.length-1);index=range3.length<=2?0:Math.min(Math.floor(t*(range3.length-1)),range3.length-2),q=(t-index*step)/step}else{for(index=0;index<domain.length-2&&!(x<domain[index+1]);index++);const a=domain[index],b=domain[index+1];q=(x-a)/(b-a)}const c0=parsedRange[index],c1=parsedRange[index+1];return interpolateOklch(c0,c1,q).toRgbaString()}invert(){}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&logger_exports.warnOnce("Expected update to not invalidate scale"))}},__name(_a8,"ColorScale"),_a8);__decorateClass([Invalidating],ColorScale.prototype,"domain",2);__decorateClass([Invalidating],ColorScale.prototype,"range",2);var _a9,Gradient=(_a9=class{constructor(colorSpace,stops=[],bbox){this.colorSpace=colorSpace,this.stops=stops,this.bbox=bbox,this._cache=void 0}createGradient(ctx,shapeBbox,params){const bbox=this.bbox??shapeBbox;if(isNaN(bbox.x)||isNaN(bbox.y))return;if(this._cache!=null&&this._cache.ctx===ctx&&this._cache.bbox.equals(bbox))return this._cache.gradient;const{stops,colorSpace}=this;if(stops.length===0)return;if(stops.length===1)return stops[0].color;let gradient2=this.createCanvasGradient(ctx,bbox,params);if(gradient2==null)return;const isOkLch=colorSpace==="oklch",step=.05;let c0=stops[0];gradient2.addColorStop(c0.stop,c0.color);for(let i=1;i<stops.length;i+=1){const c1=stops[i];if(isOkLch){const scale2=new ColorScale;scale2.domain=[c0.stop,c1.stop],scale2.range=[c0.color,c1.color];for(let stop=c0.stop+step;stop<c1.stop;stop+=step)gradient2.addColorStop(stop,scale2.convert(stop))}gradient2.addColorStop(c1.stop,c1.color),c0=c1}return"createPattern"in gradient2&&(gradient2=gradient2.createPattern()),this._cache={ctx,bbox,gradient:gradient2},gradient2}toSvg(shapeBbox){const bbox=this.bbox??shapeBbox,gradient2=this.createSvgGradient(bbox);return this.stops.forEach(({stop:offset4,color:color6})=>{const stop=createSvgElement("stop");stop.setAttribute("offset",`${offset4}`),stop.setAttribute("stop-color",`${color6}`),gradient2.appendChild(stop)}),gradient2}},__name(_a9,"Gradient"),_a9),_a10,ConicGradient=(_a10=class extends Gradient{constructor(colorSpace,stops,angle2=0,bbox){super(colorSpace,stops,bbox),this.angle=angle2}createCanvasGradient(ctx,bbox,params){const{angle:angle2}=this,radians=normalizeAngle360(toRadians(angle2+-90)),cx=(params==null?void 0:params.centerX)??bbox.x+bbox.width*.5,cy=(params==null?void 0:params.centerY)??bbox.y+bbox.height*.5;return ctx.createConicGradient(radians,cx,cy)}createSvgGradient(_bbox){return createSvgElement("linearGradient")}},__name(_a10,"ConicGradient"),_a10),_a11,LinearGradient=(_a11=class extends Gradient{constructor(colorSpace,stops,angle2=0,bbox){super(colorSpace,stops,bbox),this.angle=angle2}getGradientPoints(bbox){const{angle:angle2}=this,radians=normalizeAngle360(toRadians(angle2+90)),cos=Math.cos(radians),sin=Math.sin(radians),w=bbox.width,h=bbox.height,cx=bbox.x+w*.5,cy=bbox.y+h*.5,diagonal=Math.sqrt(h*h+w*w)/2,diagonalAngle=Math.atan2(h,w);let quarteredAngle;radians<Math.PI/2?quarteredAngle=radians:radians<Math.PI?quarteredAngle=Math.PI-radians:radians<1.5*Math.PI?quarteredAngle=radians-Math.PI:quarteredAngle=2*Math.PI-radians;const l=diagonal*Math.abs(Math.cos(quarteredAngle-diagonalAngle));return{x0:cx+cos*l,y0:cy+sin*l,x1:cx-cos*l,y1:cy-sin*l}}createCanvasGradient(ctx,bbox){const{x0,y0,x1,y1}=this.getGradientPoints(bbox);return ctx.createLinearGradient(x0,y0,x1,y1)}createSvgGradient(bbox){const{x0,y0,x1,y1}=this.getGradientPoints(bbox),gradient2=createSvgElement("linearGradient");return gradient2.setAttribute("x1",String(x0)),gradient2.setAttribute("y1",String(y0)),gradient2.setAttribute("x2",String(x1)),gradient2.setAttribute("y2",String(y1)),gradient2.setAttribute("gradientUnits","userSpaceOnUse"),gradient2}},__name(_a11,"LinearGradient"),_a11),_a12,RadialGradient=(_a12=class extends Gradient{constructor(colorSpace,stops,bbox){super(colorSpace,stops,bbox)}createCanvasGradient(ctx,bbox,params){const cx=(params==null?void 0:params.centerX)??bbox.x+bbox.width*.5,cy=(params==null?void 0:params.centerY)??bbox.y+bbox.height*.5,innerRadius=(params==null?void 0:params.innerRadius)??0,outerRadius=(params==null?void 0:params.outerRadius)??Math.hypot(bbox.width*.5,bbox.height*.5)/Math.SQRT2;return ctx.createRadialGradient(cx,cy,innerRadius,cx,cy,outerRadius)}createSvgGradient(bbox){const cx=bbox.x+bbox.width*.5,cy=bbox.y+bbox.height*.5,gradient2=createSvgElement("radialGradient");return gradient2.setAttribute("cx",String(cx)),gradient2.setAttribute("cy",String(cy)),gradient2.setAttribute("r",String(Math.hypot(bbox.width*.5,bbox.height*.5)/Math.SQRT2)),gradient2.setAttribute("gradientUnits","userSpaceOnUse"),gradient2}},__name(_a12,"RadialGradient"),_a12),_a13,BaseProperties=(_a13=class{handleUnknownProperties(_unknownKeys,_properties){}set(properties){const{className=this.constructor.name}=this.constructor;if(typeof properties!="object")return logger_exports.warn(`unable to set ${className} - expecting a properties object`),this;const keys=new Set(Object.keys(properties));for(const propertyKey of listDecoratedProperties(this))if(keys.has(propertyKey)){const value=properties[propertyKey],self=this;if(isProperties(self[propertyKey]))if(self[propertyKey]instanceof PropertiesArray){const array3=self[propertyKey].reset(value);array3!=null?self[propertyKey]=array3:logger_exports.warn(`unable to set [${propertyKey}] - expecting a properties array`)}else self[propertyKey].set(value);else isPlainObject(value)?self[propertyKey]=merge(value,self[propertyKey]??{}):self[propertyKey]=value;keys.delete(propertyKey)}this.handleUnknownProperties(keys,properties);for(const unknownKey of keys)logger_exports.warn(`unable to set [${unknownKey}] in ${className} - property is unknown`);return this}isValid(warningPrefix){return listDecoratedProperties(this).every(propertyKey=>{const metadata=extractDecoratedPropertyMetadata(this,propertyKey);if(metadata==null)return!0;const valid=metadata.optional===!0||typeof this[propertyKey]<"u";return valid||logger_exports.warnOnce(`${warningPrefix??""}[${propertyKey}] is required.`),valid})}toJson(){return listDecoratedProperties(this).reduce((object4,propertyKey)=>{const propertyValue=this[propertyKey];return object4[propertyKey]=isProperties(propertyValue)?propertyValue.toJson():propertyValue,object4},{})}},__name(_a13,"BaseProperties"),_a13),_a14,PropertiesArray=(_a14=class extends Array{constructor(itemFactory,...properties){super(properties.length);const value=__name(value2=>{var _a294,_b;return!!((_b=(_a294=value2==null?void 0:value2.prototype)==null?void 0:_a294.constructor)!=null&&_b.name)},"isConstructor")(itemFactory)?params=>new itemFactory().set(params):itemFactory;Object.defineProperty(this,"itemFactory",{value,enumerable:!1,configurable:!1}),this.set(properties)}set(properties){if(isArray(properties)){this.length=properties.length;for(let i=0;i<properties.length;i++)this[i]=this.itemFactory(properties[i])}return this}reset(properties){if(Array.isArray(properties))return new _a14(this.itemFactory,...properties)}toJson(){return this.map(value=>{var _a294;return((_a294=value==null?void 0:value.toJson)==null?void 0:_a294.call(value))??value})}},__name(_a14,"_PropertiesArray"),_a14);function isProperties(value){return value instanceof BaseProperties||value instanceof PropertiesArray}__name(isProperties,"isProperties");function Validate(predicate,options={}){const{optional=!1}=options;return addTransformToInstanceProperty((target,property,value)=>{const context={...options,target,property};if(optional&&typeof value>"u"||predicate(value,context))return isProperties(target[property])&&!isProperties(value)?(target[property].set(value),target[property]):value;const valueString=stringifyValue(value,50),cleanKey=String(property).replace(/^_*/,""),targetName=target.constructor.className??target.constructor.name.replace(/Properties$/,""),expectedMessage=predicate.message?`; expecting ${getPredicateMessage(predicate,context)}`:"";return logger_exports.warn(`Property [${cleanKey}] of [${targetName}] cannot be set to [${valueString}]${expectedMessage}, ignoring.`),BREAK_TRANSFORM_CHAIN},void 0,{optional})}__name(Validate,"Validate");var TempValidate=__name(()=>addFakeTransformToInstanceProperty,"TempValidate"),AND=__name((...predicates)=>{const messages=[];return predicateWithMessage((value,ctx)=>(messages.length=0,predicates.every(predicate=>{const isValid=predicate(value,ctx);return isValid||messages.push(getPredicateMessage(predicate,ctx)),isValid})),()=>messages.filter(Boolean).join(" AND "))},"AND"),OR=__name((...predicates)=>predicateWithMessage((value,ctx)=>predicates.some(predicate=>predicate(value,ctx)),ctx=>predicates.map(getPredicateMessageMapper(ctx)).filter(Boolean).join(" OR ")),"OR"),OBJECT=attachObjectRestrictions(predicateWithMessage((value,ctx)=>isProperties(value)||isObject(value)&&isProperties(ctx.target[ctx.property]),"a properties object")),PLAIN_OBJECT=attachObjectRestrictions(predicateWithMessage(value=>isObject(value),"an object")),BOOLEAN=predicateWithMessage(isBoolean,"a boolean"),FUNCTION=predicateWithMessage(isFunction,"a function"),STRING=predicateWithMessage(isString,"a string"),NUMBER=attachNumberRestrictions(predicateWithMessage(isFiniteNumber,"a number")),REAL_NUMBER=predicateWithMessage(value=>isNumber(value)&&!isNaN(value),"a real number"),NAN=predicateWithMessage(value=>isNumber(value)&&isNaN(value),"NaN"),POSITIVE_NUMBER=NUMBER.restrict({min:0}),RATIO=NUMBER.restrict({min:0,max:1}),NUMBER_OR_NAN=OR(NUMBER,NAN),ARRAY=attachArrayRestrictions(predicateWithMessage(isArray,"an array")),ARRAY_OF=__name((predicate,message)=>predicateWithMessage((value,ctx)=>isArray(value)&&value.every(item=>predicate(item,ctx)),ctx=>{const arrayMessage=getPredicateMessage(ARRAY,ctx)??"";return typeof message=="function"?`${arrayMessage} of ${message(ctx)}`:message?`${arrayMessage} of ${message}`:arrayMessage}),"ARRAY_OF"),isComparable=__name(value=>isFiniteNumber(value)||isValidDate(value),"isComparable"),LESS_THAN=__name(otherField=>predicateWithMessage((v,ctx)=>!isComparable(v)||!isComparable(ctx.target[otherField])||v<ctx.target[otherField],`to be less than ${otherField}`),"LESS_THAN"),GREATER_THAN=__name(otherField=>predicateWithMessage((v,ctx)=>!isComparable(v)||!isComparable(ctx.target[otherField])||v>ctx.target[otherField],`to be greater than ${otherField}`),"GREATER_THAN"),DATE=predicateWithMessage(isValidDate,"Date object"),DATE_OR_DATETIME_MS=OR(DATE,POSITIVE_NUMBER),colorMessage="A color string can be in one of the following formats to be valid: #rgb, #rrggbb, rgb(r, g, b), rgba(r, g, b, a) or a CSS color name such as 'white', 'orange', 'cyan', etc",COLOR_STRING=predicateWithMessage(isColor,`color string. ${colorMessage}`),COLOR_GRADIENT=attachObjectRestrictions(predicateWithMessage(value=>isObject(value)&&value.type==="gradient","a color gradient object")),COLOR_PATTERN=attachObjectRestrictions(predicateWithMessage(value=>isObject(value)&&value.type==="pattern","a color pattern object")),COLOR_STRING_ARRAY=predicateWithMessage(ARRAY_OF(COLOR_STRING),`color strings. ${colorMessage}`),BOOLEAN_ARRAY=ARRAY_OF(BOOLEAN,"boolean values"),NUMBER_ARRAY=ARRAY_OF(NUMBER,"numbers"),STRING_ARRAY=ARRAY_OF(STRING,"strings"),DATE_ARRAY=predicateWithMessage(ARRAY_OF(DATE),"Date objects"),OBJECT_ARRAY=predicateWithMessage(ARRAY_OF(OBJECT),"objects"),LINE_CAP=UNION(["butt","round","square"],"a line cap"),LINE_JOIN=UNION(["round","bevel","miter"],"a line join"),LINE_STYLE=UNION(["solid","dashed","dotted"],"a line style"),LINE_DASH=predicateWithMessage(ARRAY_OF(POSITIVE_NUMBER),"numbers specifying the length in pixels of alternating dashes and gaps, for example, [6, 3] means dashes with a length of 6 pixels with gaps between of 3 pixels."),POSITION=UNION(["top","right","bottom","left"],"a position"),FONT_STYLE=UNION(["normal","italic","oblique"],"a font style"),FONT_WEIGHT=OR(UNION(["normal","bold","bolder","lighter"],"a font weight"),NUMBER.restrict({min:1,max:1e3})),TEXT_WRAP=UNION(["never","always","hyphenate","on-space"],"a text wrap strategy"),TEXT_ALIGN=UNION(["left","center","right"],"a text align"),VERTICAL_ALIGN=UNION(["top","middle","bottom"],"a vertical align"),OVERFLOW_STRATEGY=UNION(["ellipsis","hide"],"an overflow strategy"),DIRECTION=UNION(["horizontal","vertical"],"a direction"),PLACEMENT=UNION(["inside","outside"],"a placement"),INTERACTION_RANGE=OR(UNION(["exact","nearest"],"interaction range"),NUMBER),LABEL_PLACEMENT=UNION(["top","bottom","left","right"]);function UNION(options,message="a"){return predicateWithMessage((v,ctx)=>{const option=options.find(o=>{const value=typeof o=="string"?o:o.value;return v===value});if(option==null)return!1;if(typeof option!="string"&&(option.deprecated===!0||option.deprecatedTo!=null)){const messages=[`Property [%s] with value '${option.value}' is deprecated.`];option.deprecatedTo&&messages.push(`Use ${option.deprecatedTo} instead.`),logger_exports.warnOnce(messages.join(" "),ctx.property)}return!0},`${message} keyword such as ${joinUnionOptions(options)}`)}__name(UNION,"UNION");var MIN_SPACING=OR(AND(NUMBER.restrict({min:1}),LESS_THAN("maxSpacing")),NAN),MAX_SPACING=OR(AND(NUMBER.restrict({min:1}),GREATER_THAN("minSpacing")),NAN);function predicateWithMessage(predicate,message){return predicate.message=message,predicate}__name(predicateWithMessage,"predicateWithMessage");function joinUnionOptions(options){const values=options.filter(option=>typeof option=="string"||option.undocumented!==!0).map(option=>`'${typeof option=="string"?option:option.value}'`);if(values.length===1)return values[0];const lastValue=values.pop();return`${values.join(", ")} or ${lastValue}`}__name(joinUnionOptions,"joinUnionOptions");function getPredicateMessage(predicate,ctx){return isFunction(predicate.message)?predicate.message(ctx):predicate.message}__name(getPredicateMessage,"getPredicateMessage");function getPredicateMessageMapper(ctx){return predicate=>getPredicateMessage(predicate,ctx)}__name(getPredicateMessageMapper,"getPredicateMessageMapper");function attachArrayRestrictions(predicate){return Object.assign(predicate,{restrict({length:length2,minLength}={}){let message="an array";return isNumber(minLength)&&minLength>0?message="a non-empty array":isNumber(length2)&&(message=`an array of length ${length2}`),predicateWithMessage(value=>isArray(value)&&(isNumber(length2)?value.length===length2:!0)&&(isNumber(minLength)?value.length>=minLength:!0),message)}})}__name(attachArrayRestrictions,"attachArrayRestrictions");function attachNumberRestrictions(predicate){return Object.assign(predicate,{restrict({min,max}={}){const message=["a number"],hasMin=isNumber(min),hasMax=isNumber(max);return hasMin&&hasMax?message.push(`between ${min} and ${max} inclusive`):hasMin?message.push(`greater than or equal to ${min}`):hasMax&&message.push(`less than or equal to ${max}`),predicateWithMessage(value=>isFiniteNumber(value)&&(hasMin?value>=min:!0)&&(hasMax?value<=max:!0),message.join(" "))}})}__name(attachNumberRestrictions,"attachNumberRestrictions");function attachObjectRestrictions(predicate){return Object.assign(predicate,{restrict(objectType){return predicateWithMessage(value=>value instanceof objectType,ctx=>getPredicateMessage(predicate,ctx)??`an instance of ${objectType.name}`)}})}__name(attachObjectRestrictions,"attachObjectRestrictions");var _a15,StopProperties=(_a15=class extends BaseProperties{constructor(){super(...arguments),this.color="black"}},__name(_a15,"StopProperties"),_a15);__decorateClass([TempValidate()],StopProperties.prototype,"stop",2);__decorateClass([TempValidate()],StopProperties.prototype,"color",2);function stopsAreAscending(fills){let currentStop;for(const fill of fills)if((fill==null?void 0:fill.stop)!=null){if(currentStop!=null&&fill.stop<currentStop)return!1;currentStop=fill.stop}return!0}__name(stopsAreAscending,"stopsAreAscending");function discreteColorStops(colorStops){return colorStops.flatMap((colorStop,i)=>{var _a294;const{stop}=colorStop,nextColor=(_a294=colorStops.at(i+1))==null?void 0:_a294.color;return nextColor!=null?[colorStop,{stop,color:nextColor}]:[colorStop]})}__name(discreteColorStops,"discreteColorStops");function getDefaultColorStops(defaultColorStops,fillMode){const stopOffset=fillMode==="discrete"?1:0,colorStops=defaultColorStops.map((color6,index,{length:length2})=>({stop:(index+stopOffset)/(length2-1+stopOffset),color:color6}));return fillMode==="discrete"?discreteColorStops(colorStops):colorStops}__name(getDefaultColorStops,"getDefaultColorStops");function getColorStops(baseFills,defaultColorStops,domain,fillMode="continuous"){var _a294,_b,_c,_d;const fills=baseFills.map(fill=>typeof fill=="string"?{color:fill}:fill);if(fills.length===0)return getDefaultColorStops(defaultColorStops,fillMode);if(!stopsAreAscending(fills))return logger_exports.warnOnce("[fills] must have the stops defined in ascending order"),[];const d0=Math.min(...domain),d1=Math.max(...domain),isDiscrete=fillMode==="discrete",stops=new Float64Array(fills.length);let previousDefinedStopIndex=0,nextDefinedStopIndex=-1;for(let i=0;i<fills.length;i+=1){const colorStop=fills[i];if(i>=nextDefinedStopIndex){nextDefinedStopIndex=fills.length-1;for(let j=i+1;j<fills.length;j+=1)if(((_a294=fills[j])==null?void 0:_a294.stop)!=null){nextDefinedStopIndex=j;break}}let stop=colorStop==null?void 0:colorStop.stop;if(stop==null){const stop0=(_b=fills[previousDefinedStopIndex])==null?void 0:_b.stop,stop1=(_c=fills[nextDefinedStopIndex])==null?void 0:_c.stop,value0=stop0??d0,value1=stop1??d1,stopOffset=isDiscrete&&stop0==null?1:0;stop=value0+(value1-value0)*(i-previousDefinedStopIndex+stopOffset)/(nextDefinedStopIndex-previousDefinedStopIndex+stopOffset)}else previousDefinedStopIndex=i;stops[i]=Math.max(0,Math.min(1,(stop-d0)/(d1-d0)))}let lastDefinedColor=(_d=fills.find(c=>c.color!=null))==null?void 0:_d.color,colorScale;const colorStops=fills.map((fill,i)=>{let color6=fill==null?void 0:fill.color;const stop=stops[i];return color6!=null?lastDefinedColor=color6:lastDefinedColor!=null?color6=lastDefinedColor:(colorScale==null&&(colorScale=new ColorScale,colorScale.domain=[0,1],colorScale.range=defaultColorStops),color6=colorScale.convert(stop)),{stop,color:color6}});return fillMode==="discrete"?discreteColorStops(colorStops):colorStops}__name(getColorStops,"getColorStops");function pointsDistanceSquared(x1,y1,x2,y2){const dx=x1-x2,dy=y1-y2;return dx*dx+dy*dy}__name(pointsDistanceSquared,"pointsDistanceSquared");function lineDistanceSquared(x,y,x1,y1,x2,y2,best){if(x1===x2&&y1===y2)return Math.min(best,pointsDistanceSquared(x,y,x1,y1));const dx=x2-x1,dy=y2-y1,t=Math.max(0,Math.min(1,((x-x1)*dx+(y-y1)*dy)/(dx*dx+dy*dy))),ix=x1+t*dx,iy=y1+t*dy;return Math.min(best,pointsDistanceSquared(x,y,ix,iy))}__name(lineDistanceSquared,"lineDistanceSquared");function arcDistanceSquared(x,y,cx,cy,radius,startAngle,endAngle,counterClockwise,best){counterClockwise&&([endAngle,startAngle]=[startAngle,endAngle]);const angle2=Math.atan2(y-cy,x-cx);if(!isBetweenAngles(angle2,startAngle,endAngle)){const startX=cx+Math.cos(startAngle)*radius,startY=cy+Math.sin(startAngle)*radius,endX=cx+Math.cos(startAngle)*radius,endY=cy+Math.sin(startAngle)*radius;return Math.min(best,pointsDistanceSquared(x,y,startX,startY),pointsDistanceSquared(x,y,endX,endY))}const distToArc=radius-Math.sqrt(pointsDistanceSquared(x,y,cx,cy));return Math.min(best,distToArc*distToArc)}__name(arcDistanceSquared,"arcDistanceSquared");function linearRoot(a,b){const t=-b/a;return a!==0&&t>=0&&t<=1?[t]:[]}__name(linearRoot,"linearRoot");function quadraticRoots(a,b,c){if(a===0)return linearRoot(b,c);const D=b*b-4*a*c,roots=[];if(D===0){const t=-b/(2*a);t>=0&&t<=1&&roots.push(t)}else if(D>0){const rD=Math.sqrt(D),t1=(-b-rD)/(2*a),t2=(-b+rD)/(2*a);t1>=0&&t1<=1&&roots.push(t1),t2>=0&&t2<=1&&roots.push(t2)}return roots}__name(quadraticRoots,"quadraticRoots");function cubicRoots(a,b,c,d){if(a===0)return quadraticRoots(b,c,d);const A=b/a,B=c/a,C2=d/a,Q=(3*B-A*A)/9,R=(9*A*B-27*C2-2*A*A*A)/54,D=Q*Q*Q+R*R,third=1/3,roots=[];if(D>=0){const rD=Math.sqrt(D),S=Math.sign(R+rD)*Math.pow(Math.abs(R+rD),third),T=Math.sign(R-rD)*Math.pow(Math.abs(R-rD),third),Im=Math.abs(Math.sqrt(3)*(S-T)/2),t=-.3333333333333333*A+(S+T);if(t>=0&&t<=1&&roots.push(t),Im===0){const t2=-.3333333333333333*A-(S+T)/2;t2>=0&&t2<=1&&roots.push(t2)}}else{const theta=Math.acos(R/Math.sqrt(-Q*Q*Q)),thirdA=third*A,twoSqrtQ=2*Math.sqrt(-Q),t1=twoSqrtQ*Math.cos(third*theta)-thirdA,t2=twoSqrtQ*Math.cos(third*(theta+2*Math.PI))-thirdA,t3=twoSqrtQ*Math.cos(third*(theta+4*Math.PI))-thirdA;t1>=0&&t1<=1&&roots.push(t1),t2>=0&&t2<=1&&roots.push(t2),t3>=0&&t3<=1&&roots.push(t3)}return roots}__name(cubicRoots,"cubicRoots");function segmentIntersection(ax1,ay1,ax2,ay2,bx1,by1,bx2,by2){const d=(ax2-ax1)*(by2-by1)-(ay2-ay1)*(bx2-bx1);if(d===0)return 0;const ua=((bx2-bx1)*(ay1-by1)-(ax1-bx1)*(by2-by1))/d,ub=((ax2-ax1)*(ay1-by1)-(ay2-ay1)*(ax1-bx1))/d;return ua>=0&&ua<=1&&ub>=0&&ub<=1?1:0}__name(segmentIntersection,"segmentIntersection");function cubicSegmentIntersections(px1,py1,px2,py2,px3,py3,px4,py4,x1,y1,x2,y2){let intersections=0;const A=y1-y2,B=x2-x1,C2=x1*(y2-y1)-y1*(x2-x1),bx=bezierCoefficients(px1,px2,px3,px4),by=bezierCoefficients(py1,py2,py3,py4),a=A*bx[0]+B*by[0],b=A*bx[1]+B*by[1],c=A*bx[2]+B*by[2],d=A*bx[3]+B*by[3]+C2,roots=cubicRoots(a,b,c,d);for(const t of roots){const tt=t*t,ttt=t*tt,x=bx[0]*ttt+bx[1]*tt+bx[2]*t+bx[3],y=by[0]*ttt+by[1]*tt+by[2]*t+by[3];let s;x1===x2?s=(y-y1)/(y2-y1):s=(x-x1)/(x2-x1),s>=0&&s<=1&&intersections++}return intersections}__name(cubicSegmentIntersections,"cubicSegmentIntersections");function bezierCoefficients(P1,P2,P3,P4){return[-P1+3*P2-3*P3+P4,3*P1-6*P2+3*P3,-3*P1+3*P2,P1]}__name(bezierCoefficients,"bezierCoefficients");function arcIntersections(cx,cy,r,startAngle,endAngle,counterClockwise,x1,y1,x2,y2){if(isNaN(cx)||isNaN(cy))return 0;counterClockwise&&([endAngle,startAngle]=[startAngle,endAngle]);const k=(y2-y1)/(x2-x1),y0=y1-k*x1,a=Math.pow(k,2)+1,b=2*(k*(y0-cy)-cx),c=Math.pow(cx,2)+Math.pow(y0-cy,2)-Math.pow(r,2),d=Math.pow(b,2)-4*a*c;if(d<0)return 0;const i1x=(-b+Math.sqrt(d))/2/a,i2x=(-b-Math.sqrt(d))/2/a;let intersections=0;return[i1x,i2x].forEach(x=>{if(!(x>=Math.min(x1,x2)&&x<=Math.max(x1,x2)))return;const y=k*x+y0,adjacent=x-cx,opposite=y-cy,angle2=Math.atan2(opposite,adjacent);isBetweenAngles(angle2,startAngle,endAngle)&&intersections++}),intersections}__name(arcIntersections,"arcIntersections");function evaluateBezier(p0,p1,p2,p3,t){return(1-t)**3*p0+3*(1-t)**2*t*p1+3*(1-t)*t**2*p2+t**3*p3}__name(evaluateBezier,"evaluateBezier");function solveBezier(p0,p1,p2,p3,value){if(value<=Math.min(p0,p3))return p0<p3?0:1;if(value>=Math.max(p0,p3))return p0<p3?1:0;let t0=0,t1=1,t=NaN;for(let i=0;i<12;i+=1)t=(t0+t1)/2,evaluateBezier(p0,p1,p2,p3,t)<value?t0=t:t1=t;return t}__name(solveBezier,"solveBezier");function splitBezier(p0x,p0y,p1x,p1y,p2x,p2y,p3x,p3y,t){const x01=(1-t)*p0x+t*p1x,y01=(1-t)*p0y+t*p1y,x12=(1-t)*p1x+t*p2x,y12=(1-t)*p1y+t*p2y,x23=(1-t)*p2x+t*p3x,y23=(1-t)*p2y+t*p3y,x012=(1-t)*x01+t*x12,y012=(1-t)*y01+t*y12,x123=(1-t)*x12+t*x23,y123=(1-t)*y12+t*y23,x0123=(1-t)*x012+t*x123,y0123=(1-t)*y012+t*y123;return[[{x:p0x,y:p0y},{x:x01,y:y01},{x:x012,y:y012},{x:x0123,y:y0123}],[{x:x0123,y:y0123},{x:x123,y:y123},{x:x23,y:y23},{x:p3x,y:p3y}]]}__name(splitBezier,"splitBezier");function calculateDerivativeExtrema(p0,p1,p2,p3){const a=-p0+3*p1-3*p2+p3,b=3*p0-6*p1+3*p2,c=-3*p0+3*p1;if(a===0){if(b!==0){const t=-c/b;if(t>0&&t<1)return[t]}return[]}const discriminant=b*b-4*a*c;if(discriminant>=0){const sqrtDiscriminant=Math.sqrt(discriminant),t1=(-b+sqrtDiscriminant)/(2*a),t2=(-b-sqrtDiscriminant)/(2*a);return[t1,t2].filter(t=>t>0&&t<1)}return[]}__name(calculateDerivativeExtrema,"calculateDerivativeExtrema");function calculateDerivativeExtremaXY(sx,sy,cp1x,cp1y,cp2x,cp2y,x,y){const tx=calculateDerivativeExtrema(sx,cp1x,cp2x,x),ty=calculateDerivativeExtrema(sy,cp1y,cp2y,y);return[...tx,...ty]}__name(calculateDerivativeExtremaXY,"calculateDerivativeExtremaXY");var _a16,ExtendedPath2D=(_a16=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.openedPath=!1,this.closedPath=!1}isEmpty(){return this.commands.length===0}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length||this.previousCommands.toString()!==this.commands.toString()||this.previousParams.toString()!==this.params.toString()}getPath2D(){return this.path2d}moveTo(x,y){this.openedPath=!0,this.path2d.moveTo(x,y),this.commands.push(0),this.params.push(x,y)}lineTo(x,y){this.openedPath?(this.path2d.lineTo(x,y),this.commands.push(1),this.params.push(x,y)):this.moveTo(x,y)}rect(x,y,width2,height2){this.moveTo(x,y),this.lineTo(x+width2,y),this.lineTo(x+width2,y+height2),this.lineTo(x,y+height2),this.closePath()}roundRect(x,y,width2,height2,radii){radii=Math.min(radii,width2/2,height2/2),this.moveTo(x,y+radii),this.arc(x+radii,y+radii,radii,Math.PI,1.5*Math.PI),this.lineTo(x+radii,y),this.lineTo(x+width2-radii,y),this.arc(x+width2-radii,y+radii,radii,1.5*Math.PI,2*Math.PI),this.lineTo(x+width2,y+radii),this.lineTo(x+width2,y+height2-radii),this.arc(x+width2-radii,y+height2-radii,radii,0,Math.PI/2),this.lineTo(x+width2-radii,y+height2),this.lineTo(x+radii,y+height2),this.arc(x+ +radii,y+height2-radii,radii,Math.PI/2,Math.PI),this.lineTo(x,y+height2-radii),this.closePath()}arc(x,y,r,sAngle,eAngle,counterClockwise){this.openedPath=!0,this.path2d.arc(x,y,r,sAngle,eAngle,counterClockwise),this.commands.push(2),this.params.push(x,y,r,sAngle,eAngle,counterClockwise?1:0)}cubicCurveTo(cx1,cy1,cx2,cy2,x,y){this.openedPath||this.moveTo(cx1,cy1),this.path2d.bezierCurveTo(cx1,cy1,cx2,cy2,x,y),this.commands.push(3),this.params.push(cx1,cy1,cx2,cy2,x,y)}closePath(){this.openedPath&&(this.path2d.closePath(),this.commands.push(4),this.openedPath=!1,this.closedPath=!0)}clear(trackChanges){trackChanges&&(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this.closedPath),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1,this.commands=[],this.params=[]}isPointInPath(x,y){const commands=this.commands,params=this.params,cn=commands.length,ox=-1e4,oy=-1e4;let sx=NaN,sy=NaN,px=0,py=0,intersectionCount=0;for(let ci=0,pi=0;ci<cn;ci++)switch(commands[ci]){case 0:intersectionCount+=segmentIntersection(sx,sy,px,py,ox,oy,x,y),px=params[pi++],sx=px,py=params[pi++],sy=py;break;case 1:intersectionCount+=segmentIntersection(px,py,params[pi++],params[pi++],ox,oy,x,y),px=params[pi-2],py=params[pi-1];break;case 3:intersectionCount+=cubicSegmentIntersections(px,py,params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],ox,oy,x,y),px=params[pi-2],py=params[pi-1];break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++],startAngle=params[pi++],endAngle=params[pi++],counterClockwise=!!params[pi++];if(intersectionCount+=arcIntersections(cx,cy,r,startAngle,endAngle,counterClockwise,ox,oy,x,y),!isNaN(sx)){const startX=cx+Math.cos(startAngle)*r,startY=cy+Math.sin(startAngle)*r;intersectionCount+=segmentIntersection(px,py,startX,startY,ox,oy,x,y)}px=cx+Math.cos(endAngle)*r,py=cy+Math.sin(endAngle)*r;break}case 4:intersectionCount+=segmentIntersection(sx,sy,px,py,ox,oy,x,y);break}return intersectionCount%2===1}distanceSquared(x,y){let best=1/0;const commands=this.commands,params=this.params,cn=commands.length;let sx=NaN,sy=NaN,px=0,py=0;for(let ci=0,pi=0;ci<cn;ci++)switch(commands[ci]){case 0:px=sx=params[pi++],py=sy=params[pi++];break;case 1:{const nx=params[pi++],ny=params[pi++];best=lineDistanceSquared(x,y,px,py,nx,ny,best);break}case 3:logger_exports.error("Command.Curve distanceSquare not implemented");break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++],startAngle=params[pi++],endAngle=params[pi++],startX=cx+Math.cos(startAngle)*r,startY=cy+Math.sin(startAngle)*r,counterClockwise=!!params[pi++];best=lineDistanceSquared(x,y,px,py,startX,startY,best),best=arcDistanceSquared(x,y,cx,cy,r,startAngle,endAngle,counterClockwise,best),px=cx+Math.cos(endAngle)*r,py=cy+Math.sin(endAngle)*r;break}case 4:best=lineDistanceSquared(x,y,px,py,sx,sy,best);break}return best}toSVG(transform=(x,y)=>({x,y})){const buffer=[],{commands,params}=this,addCommand=__name((command,...points)=>{buffer.push(command);for(let i=0;i<points.length;i+=2){const{x,y}=transform(points[i],points[i+1]);buffer.push(x,y)}},"addCommand");let pi=0;for(const command of commands)switch(command){case 0:addCommand("M",params[pi++],params[pi++]);break;case 1:addCommand("L",params[pi++],params[pi++]);break;case 3:addCommand("C",params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],params[pi++]);break;case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++],A0=params[pi++],A1=params[pi++],ccw=params[pi++];let sweep=ccw?A0-A1:A1-A0;sweep<0&&(sweep+=Math.ceil(-sweep/(2*Math.PI))*2*Math.PI),ccw&&(sweep=-sweep);const arcSections=Math.max(Math.ceil(Math.abs(sweep)/(Math.PI/2)),1),step=sweep/arcSections,h=4/3*Math.tan(step/4),move=buffer.length===0?"M":"L";addCommand(move,cx+Math.cos(A0)*r,cy+Math.sin(A0)*r);for(let i=0;i<arcSections;i+=1){const a0=A0+step*(i+0),a1=A0+step*(i+1),rSinStart=r*Math.sin(a0),rCosStart=r*Math.cos(a0),rSinEnd=r*Math.sin(a1),rCosEnd=r*Math.cos(a1);addCommand("C",cx+rCosStart-h*rSinStart,cy+rSinStart+h*rCosStart,cx+rCosEnd+h*rSinEnd,cy+rSinEnd-h*rCosEnd,cx+rCosEnd,cy+rSinEnd)}break}case 4:buffer.push("Z");break}return buffer.join(" ")}computeBBox(){const{commands,params}=this;let[top,left,right,bot]=[1/0,1/0,-1/0,-1/0],[sx,sy]=[NaN,NaN],[mx,my]=[NaN,NaN];const joinPoint=__name((x,y,updatestart)=>{top=Math.min(y,top),left=Math.min(x,left),right=Math.max(x,right),bot=Math.max(y,bot),updatestart&&([sx,sy]=[x,y])},"joinPoint");let pi=0;for(const command of commands)switch(command){case 0:joinPoint(params[pi++],params[pi++],!0),[mx,my]=[sx,sy];break;case 1:joinPoint(params[pi++],params[pi++],!0);break;case 3:{const cp1x=params[pi++],cp1y=params[pi++],cp2x=params[pi++],cp2y=params[pi++],x=params[pi++],y=params[pi++];joinPoint(x,y,!0),calculateDerivativeExtremaXY(sx,sy,cp1x,cp1y,cp2x,cp2y,x,y).forEach(t=>{const px=evaluateBezier(sx,cp1x,cp2x,x,t),py=evaluateBezier(sy,cp1y,cp2y,y,t);joinPoint(px,py)});break}case 2:{const cx=params[pi++],cy=params[pi++],r=params[pi++];let A0=normalizeAngle360(params[pi++]),A1=normalizeAngle360(params[pi++]);params[pi++]&&([A0,A1]=[A1,A0]);const joinAngle=__name((angle2,updatestart)=>{const px=cx+r*Math.cos(angle2),py=cy+r*Math.sin(angle2);joinPoint(px,py,updatestart)},"joinAngle");joinAngle(A0),joinAngle(A1,!0);const criticalAngles=[0,Math.PI/2,Math.PI,3*Math.PI/2];for(const crit of criticalAngles)(A0<A1&&A0<=crit&&crit<=A1||A0>A1&&(A0<=crit||crit<=A1))&&joinAngle(crit);break}case 4:[sx,sy]=[mx,my];break}return new BBox(left,top,right-left,bot-top)}},__name(_a16,"ExtendedPath2D"),_a16);function align(pixelRatio,start2,length2){const alignedStart=Math.round(start2*pixelRatio)/pixelRatio;return length2==null?alignedStart:length2===0?0:length2<1?Math.ceil(length2*pixelRatio)/pixelRatio:Math.round((length2+start2)*pixelRatio)/pixelRatio-alignedStart}__name(align,"align");function alignBefore(pixelRatio,start2){return Math.floor(start2*pixelRatio)/pixelRatio}__name(alignBefore,"alignBefore");function drawPatternUnitPolygon(path,params,moves){const{width:width2,height:height2,padding,strokeWidth}=params,x0=width2/2,y0=height2/2,w=Math.max(1,width2-padding-strokeWidth/2),h=Math.max(1,height2-padding-strokeWidth/2);let didMove=!1;for(const[dx,dy]of moves){const x=x0+(dx-.5)*w,y=y0+(dy-.5)*h;didMove?path.lineTo(x,y):path.moveTo(x,y),didMove=!0}path.closePath()}__name(drawPatternUnitPolygon,"drawPatternUnitPolygon");var PATTERNS={circles(path,{width:width2,strokeWidth,padding}){const c=width2/2,r=Math.max(1,c-padding-strokeWidth/2);path.arc(c,c,r,0,Math.PI*2)},squares(path,{width:width2,height:height2,pixelRatio,padding,strokeWidth}){const offset4=padding+strokeWidth/2;path.moveTo(align(pixelRatio,offset4),align(pixelRatio,offset4)),path.lineTo(align(pixelRatio,width2-offset4),align(pixelRatio,offset4)),path.lineTo(align(pixelRatio,width2-offset4),align(pixelRatio,height2-offset4)),path.lineTo(align(pixelRatio,offset4),align(pixelRatio,height2-offset4)),path.closePath()},triangles(path,params){drawPatternUnitPolygon(path,params,[[.5,0],[1,1],[0,1]])},diamonds(path,params){drawPatternUnitPolygon(path,params,[[.5,0],[1,.5],[.5,1],[0,.5]])},stars(path,{width:width2,height:height2,padding}){const outerRadius=Math.max(1,(width2-padding)/2),innerRadius=outerRadius/2,rotation=Math.PI/2;for(let i=0;i<5*2;i++){const radius=i%2===0?outerRadius:innerRadius,angle2=i*Math.PI/5-rotation,xCoordinate=width2/2+Math.cos(angle2)*radius,yCoordinate=height2/2+Math.sin(angle2)*radius;path.lineTo(xCoordinate,yCoordinate)}path.closePath()},hearts(path,{width:width2,height:height2,padding}){const r=Math.max(1,width2/4-padding/2),x=width2/2,y=height2/2+r/2;path.arc(x-r,y-r,r,toRadians(130),toRadians(330)),path.arc(x+r,y-r,r,toRadians(220),toRadians(50)),path.lineTo(x,y+r),path.closePath()},crosses(path,params){drawPatternUnitPolygon(path,params,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},"vertical-lines"(path,{width:width2,height:height2,pixelRatio,strokeWidth}){const x=align(pixelRatio,width2/2)-strokeWidth%2/2;path.moveTo(x,0),path.lineTo(x,height2)},"horizontal-lines"(path,{width:width2,height:height2,pixelRatio,strokeWidth}){const y=align(pixelRatio,height2/2)-strokeWidth%2/2;path.moveTo(0,y),path.lineTo(width2,y)},"forward-slanted-lines"(path,{width:width2,height:height2,strokeWidth}){const angle2=Math.atan2(height2,width2),insetX=strokeWidth*Math.cos(angle2),insetY=strokeWidth*Math.sin(angle2);path.moveTo(-insetX,insetY),path.lineTo(insetX,-insetY),path.moveTo(-insetX,height2+insetY),path.lineTo(width2+insetX,-insetY),path.moveTo(width2-insetX,height2+insetY),path.lineTo(width2+insetX,height2-insetY)},"backward-slanted-lines"(path,{width:width2,height:height2,strokeWidth}){const angle2=Math.atan2(height2,width2),insetX=strokeWidth*Math.cos(angle2),insetY=strokeWidth*Math.sin(angle2);path.moveTo(width2-insetX,-insetY),path.lineTo(width2+insetX,insetY),path.moveTo(-insetX,-insetY),path.lineTo(width2+insetX,height2+insetY),path.moveTo(-insetX,height2-insetY),path.lineTo(insetX,height2+insetY)}},_a17,Pattern=(_a17=class{constructor(patternOptions,pixelRatio=1){this.pixelRatio=pixelRatio,this._cache=void 0,this.width=Math.max((patternOptions==null?void 0:patternOptions.width)??10,1),this.height=Math.max((patternOptions==null?void 0:patternOptions.height)??10,1),this.fill=patternOptions.fill??"transparent",this.fillOpacity=patternOptions.fillOpacity??1,this.backgroundFill=patternOptions.backgroundFill??"transparent",this.backgroundFillOpacity=patternOptions.backgroundFillOpacity??1,this.stroke=patternOptions.stroke??"black",this.strokeOpacity=patternOptions.strokeOpacity??1,this.strokeWidth=patternOptions.strokeWidth??1,this.padding=patternOptions.padding??1,this.pattern=patternOptions.pattern??"forward-slanted-lines",this.rotation=patternOptions.rotation??0}getPath(){const{pattern,width:width2,height:height2,padding,strokeWidth,pixelRatio}=this,path=new ExtendedPath2D;return PATTERNS[pattern](path,{width:width2,height:height2,pixelRatio,strokeWidth,padding}),path}renderStroke(path2d,ctx){const{stroke:stroke2,strokeWidth,strokeOpacity}=this;strokeWidth&&(ctx.strokeStyle=stroke2,ctx.lineWidth=strokeWidth,ctx.globalAlpha=strokeOpacity,ctx.stroke(path2d))}renderFill(path2d,ctx){const{fill,fillOpacity}=this;ctx.fillStyle=fill,ctx.globalAlpha=fillOpacity,ctx.fill(path2d)}createCanvasPattern(ctx){const{width:width2,height:height2,backgroundFill,backgroundFillOpacity,pixelRatio,rotation}=this,offscreenPattern=new HdpiOffscreenCanvas({width:width2,height:height2,pixelRatio}),offscreenPatternCtx=offscreenPattern.context;offscreenPatternCtx.fillStyle=backgroundFill,offscreenPatternCtx.globalAlpha=backgroundFillOpacity,offscreenPatternCtx.fillRect(0,0,width2,height2);const path2d=this.getPath().getPath2D();this.renderFill(path2d,offscreenPatternCtx),this.renderStroke(path2d,offscreenPatternCtx);const pattern=ctx.createPattern(offscreenPattern.canvas,"repeat"),angle2=normalizeAngle360(toRadians(rotation)),scale2=1/pixelRatio,cos=Math.cos(angle2)*scale2,sin=Math.sin(angle2)*scale2;return pattern==null||pattern.setTransform(new DOMMatrix([cos,sin,-sin,cos,0,0])),offscreenPattern.destroy(),pattern}createPattern(ctx){if(this._cache!=null&&this._cache.ctx===ctx)return this._cache.pattern;const pattern=this.createCanvasPattern(ctx);if(pattern!=null)return this._cache={ctx,pattern},pattern}toSvg(){const{width:width2,height:height2,fill,fillOpacity,backgroundFill,backgroundFillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,rotation}=this,pattern=createSvgElement("pattern");pattern.setAttribute("viewBox",`0 0 ${width2} ${height2}`),pattern.setAttribute("width",String(width2)),pattern.setAttribute("height",String(height2)),pattern.setAttribute("patternUnits","userSpaceOnUse");const rect=createSvgElement("rect");rect.setAttribute("x","0"),rect.setAttribute("y","0"),rect.setAttribute("width",String(width2)),rect.setAttribute("height",String(height2)),rect.setAttribute("fill",backgroundFill),rect.setAttribute("fill-opacity",String(backgroundFillOpacity)),pattern.appendChild(rect);const path=createSvgElement("path");return path.setAttribute("fill",fill),path.setAttribute("fill-opacity",String(fillOpacity)),path.setAttribute("stroke-opacity",String(strokeOpacity)),path.setAttribute("stroke",stroke2),path.setAttribute("stroke-width",String(strokeWidth)),path.setAttribute("transform",`rotate(${rotation})`),path.setAttribute("d",this.getPath().toSVG()),pattern.appendChild(path),pattern}},__name(_a17,"Pattern"),_a17);function isGradientFill(fill){return isObject(fill)&&fill.type=="gradient"}__name(isGradientFill,"isGradientFill");function isStringFillArray(fills){return isArray(fills)&&fills.every(fill=>typeof fill=="string")}__name(isStringFillArray,"isStringFillArray");function isPatternFill(fill){return fill!==null&&isObject(fill)&&fill.type=="pattern"}__name(isPatternFill,"isPatternFill");function isGradientOrPatternFill(fill){return isGradientFill(fill)||isPatternFill(fill)}__name(isGradientOrPatternFill,"isGradientOrPatternFill");var _a18,_Shape=(_a18=class extends Node{constructor(){super(...arguments),this.fillOpacity=1,this.strokeOpacity=1,this.fill=_a18.defaultStyles.fill,this.stroke=_a18.defaultStyles.stroke,this.strokeWidth=_a18.defaultStyles.strokeWidth,this.lineDash=_a18.defaultStyles.lineDash,this.lineDashOffset=_a18.defaultStyles.lineDashOffset,this.lineCap=_a18.defaultStyles.lineCap,this.lineJoin=_a18.defaultStyles.lineJoin,this.miterLimit=void 0,this.opacity=_a18.defaultStyles.opacity,this.fillShadow=_a18.defaultStyles.fillShadow}restoreOwnStyles(){const{defaultStyles}=this.constructor;Object.assign(this,defaultStyles)}getGradient(fill){if(isGradientFill(fill))return this.createGradient(fill)}createGradient(fill){const{colorSpace="rgb",gradient:gradient2="linear",colorStops,rotation=0,reverse=!1}=fill;if(colorStops==null)return;let stops=getColorStops(colorStops,["black"],[0,1]);switch(reverse&&(stops=stops.map(s=>({color:s.color,stop:1-s.stop})).reverse()),gradient2){case"linear":return new LinearGradient(colorSpace,stops,rotation);case"radial":return new RadialGradient(colorSpace,stops);case"conic":return new ConicGradient(colorSpace,stops,rotation)}}getPattern(fill){if(isPatternFill(fill))return this.createPattern(fill)}createPattern(fill){var _a294,_b;const pixelRatio=((_b=(_a294=this.layerManager)==null?void 0:_a294.canvas)==null?void 0:_b.pixelRatio)??1;return new Pattern(fill,pixelRatio)}onFillChange(){typeof this.fill=="object"&&objectsEqual(this._cachedFill??{},this.fill)||(this.fillGradient=this.getGradient(this.fill),this.fillPattern=this.getPattern(this.fill),this._cachedFill=this.fill)}onStrokeChange(){this.strokeGradient=this.getGradient(this.stroke)}align(start2,length2){var _a294,_b;return align(((_b=(_a294=this.layerManager)==null?void 0:_a294.canvas)==null?void 0:_b.pixelRatio)??1,start2,length2)}preRender(renderCtx,thisComplexity){return this.dirty&&(this.cachedDefaultGradientFillBBox=void 0),super.preRender(renderCtx,thisComplexity)}fillStroke(ctx,path){this.renderFill(ctx,path),this.renderStroke(ctx,path)}renderFill(ctx,path){if(this.fill){const{globalAlpha}=ctx;this.applyFill(ctx),this.applyFillAlpha(ctx),this.applyShadow(ctx),this.executeFill(ctx,path),ctx.globalAlpha=globalAlpha}ctx.shadowColor="rgba(0, 0, 0, 0)"}executeFill(ctx,path){path?ctx.fill(path):ctx.fill()}applyFill(ctx){var _a294;const{fill,fillGradient,fillBBox=this.getDefaultGradientFillBBox()??this.getBBox(),fillParams}=this,gradientFill=fillBBox?fillGradient==null?void 0:fillGradient.createGradient(ctx,fillBBox,fillParams):void 0,patternFill=(_a294=this.fillPattern)==null?void 0:_a294.createPattern(ctx);ctx.fillStyle=patternFill??gradientFill??(typeof fill=="string"?fill:void 0)??"black"}applyStroke(ctx){var _a294;ctx.strokeStyle=((_a294=this.strokeGradient)==null?void 0:_a294.createGradient(ctx,this.getBBox()))??(typeof this.stroke=="string"?this.stroke:void 0)??"black"}applyFillAlpha(ctx){ctx.globalAlpha*=this.opacity*this.fillOpacity}applyShadow(ctx){var _a294;const pixelRatio=((_a294=this.layerManager)==null?void 0:_a294.canvas.pixelRatio)??1,fillShadow=this.fillShadow;fillShadow!=null&&fillShadow.enabled&&(ctx.shadowColor=fillShadow.color,ctx.shadowOffsetX=fillShadow.xOffset*pixelRatio,ctx.shadowOffsetY=fillShadow.yOffset*pixelRatio,ctx.shadowBlur=fillShadow.blur*pixelRatio)}renderStroke(ctx,path){if(this.stroke&&this.strokeWidth){const{globalAlpha}=ctx;this.applyStroke(ctx),ctx.globalAlpha*=this.opacity*this.strokeOpacity,ctx.lineWidth=this.strokeWidth,this.lineDash&&ctx.setLineDash(this.lineDash),this.lineDashOffset&&(ctx.lineDashOffset=this.lineDashOffset),this.lineCap&&(ctx.lineCap=this.lineCap),this.lineJoin&&(ctx.lineJoin=this.lineJoin),this.miterLimit!=null&&(ctx.miterLimit=this.miterLimit),this.executeStroke(ctx,path),ctx.globalAlpha=globalAlpha}}executeStroke(ctx,path){path?ctx.stroke(path):ctx.stroke()}getDefaultGradientFillBBox(){return this.cachedDefaultGradientFillBBox==null&&(this.cachedDefaultGradientFillBBox=Object.freeze(this.computeDefaultGradientFillBBox())),this.cachedDefaultGradientFillBBox}computeDefaultGradientFillBBox(){}containsPoint(x,y){return this.isPointInPath(x,y)}applySvgFillAttributes(element2,defs){const{fill,fillOpacity}=this;if(typeof fill=="string")element2.setAttribute("fill",fill);else if(isGradientFill(fill)&&this.fillGradient){defs??(defs=[]);const gradient2=this.fillGradient.toSvg(this.fillBBox??this.getBBox()),id=generateUUID();gradient2.setAttribute("id",id),defs.push(gradient2),element2.setAttribute("fill",`url(#${id})`)}else if(isPatternFill(fill)&&this.fillPattern){defs??(defs=[]);const pattern=this.fillPattern.toSvg(),id=generateUUID();pattern.setAttribute("id",id),defs.push(pattern),element2.setAttribute("fill",`url(#${id})`)}else element2.setAttribute("fill","none");return element2.setAttribute("fill-opacity",String(fillOpacity)),defs}applySvgStrokeAttributes(element2){const{stroke:stroke2,strokeOpacity,strokeWidth,lineDash,lineDashOffset}=this;if(stroke2!=null&&(element2.setAttribute("stroke",typeof stroke2=="string"?stroke2:"none"),element2.setAttribute("stroke-opacity",String(strokeOpacity)),element2.setAttribute("stroke-width",String(strokeWidth))),(lineDash==null?void 0:lineDash.some(d=>d!==0))===!0){const svgLineDash=lineDash.length%2===1?[...lineDash,...lineDash]:lineDash;element2.setAttribute("stroke-dasharray",svgLineDash.join(" ")),element2.setAttribute("stroke-dashoffset",String(lineDashOffset))}}},__name(_a18,"_Shape"),_a18);_Shape.defaultStyles={fill:"black",stroke:void 0,strokeWidth:0,lineDash:void 0,lineDashOffset:0,lineCap:void 0,lineJoin:void 0,opacity:1,fillShadow:void 0};__decorateClass([SceneChangeDetection()],_Shape.prototype,"fillOpacity",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"strokeOpacity",2);__decorateClass([SceneChangeDetection({changeCb:__name(s=>s.onFillChange(),"changeCb")})],_Shape.prototype,"fill",2);__decorateClass([SceneChangeDetection({changeCb:__name(s=>s.onStrokeChange(),"changeCb")})],_Shape.prototype,"stroke",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"strokeWidth",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineDash",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineDashOffset",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineCap",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineJoin",2);__decorateClass([SceneChangeDetection()],_Shape.prototype,"miterLimit",2);__decorateClass([SceneChangeDetection({convertor:__name(v=>clamp(0,v,1),"convertor")})],_Shape.prototype,"opacity",2);__decorateClass([SceneChangeDetection({checkDirtyOnAssignment:!0})],_Shape.prototype,"fillShadow",2);__decorateClass([SceneChangeDetection({changeCb:__name(s=>s.onFillChange(),"changeCb")})],_Shape.prototype,"fillBBox",2);__decorateClass([SceneChangeDetection({changeCb:__name(s=>s.onFillChange(),"changeCb")})],_Shape.prototype,"fillParams",2);var Shape=_Shape,IDENTITY_MATRIX_ELEMENTS=[1,0,0,1,0,0],_a19,Matrix=(_a19=class{get e(){return[...this.elements]}constructor(elements=IDENTITY_MATRIX_ELEMENTS){this.elements=[...elements]}setElements(elements){const e=this.elements;return e[0]=elements[0],e[1]=elements[1],e[2]=elements[2],e[3]=elements[3],e[4]=elements[4],e[5]=elements[5],this}get identity(){const e=this.elements;return isNumberEqual(e[0],1)&&isNumberEqual(e[1],0)&&isNumberEqual(e[2],0)&&isNumberEqual(e[3],1)&&isNumberEqual(e[4],0)&&isNumberEqual(e[5],0)}AxB(A,B,C2){const a=A[0]*B[0]+A[2]*B[1],b=A[1]*B[0]+A[3]*B[1],c=A[0]*B[2]+A[2]*B[3],d=A[1]*B[2]+A[3]*B[3],e=A[0]*B[4]+A[2]*B[5]+A[4],f=A[1]*B[4]+A[3]*B[5]+A[5];C2=C2??A,C2[0]=a,C2[1]=b,C2[2]=c,C2[3]=d,C2[4]=e,C2[5]=f}multiplySelf(other){return this.AxB(this.elements,other.elements),this}multiply(other){const elements=new Array(6);return other instanceof _a19?this.AxB(this.elements,other.elements,elements):this.AxB(this.elements,[other.a,other.b,other.c,other.d,other.e,other.f],elements),new _a19(elements)}preMultiplySelf(other){return this.AxB(other.elements,this.elements,this.elements),this}inverse(){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,new _a19([d,-b,-c,a,c*f-d*e,b*e-a*f])}invertSelf(){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,el[0]=d,el[1]=-b,el[2]=-c,el[3]=a,el[4]=c*f-d*e,el[5]=b*e-a*f,this}transformPoint(x,y){const e=this.elements;return{x:x*e[0]+y*e[2]+e[4],y:x*e[1]+y*e[3]+e[5]}}transformBBox(bbox,target){const el=this.elements,xx=el[0],xy=el[1],yx=el[2],yy=el[3],h_w=bbox.width*.5,h_h=bbox.height*.5,cx=bbox.x+h_w,cy=bbox.y+h_h,w=Math.abs(h_w*xx)+Math.abs(h_h*yx),h=Math.abs(h_w*xy)+Math.abs(h_h*yy);return target??(target=new BBox(0,0,0,0)),target.x=cx*xx+cy*yx+el[4]-w,target.y=cx*xy+cy*yy+el[5]-h,target.width=w+w,target.height=h+h,target}toContext(ctx){if(this.identity)return;const e=this.elements;ctx.transform(e[0],e[1],e[2],e[3],e[4],e[5])}static updateTransformMatrix(matrix,scalingX,scalingY,rotation,translationX,translationY,opts){const sx=scalingX,sy=scalingY;let scx,scy;sx===1&&sy===1?(scx=0,scy=0):(scx=(opts==null?void 0:opts.scalingCenterX)??0,scy=(opts==null?void 0:opts.scalingCenterY)??0);const r=rotation,cos=Math.cos(r),sin=Math.sin(r);let rcx,rcy;r===0?(rcx=0,rcy=0):(rcx=(opts==null?void 0:opts.rotationCenterX)??0,rcy=(opts==null?void 0:opts.rotationCenterY)??0);const tx=translationX,ty=translationY,tx4=scx*(1-sx)-rcx,ty4=scy*(1-sy)-rcy;return matrix.setElements([cos*sx,sin*sx,-sin*sy,cos*sy,cos*tx4-sin*ty4+rcx+tx,sin*tx4+cos*ty4+rcy+ty]),matrix}},__name(_a19,"_Matrix"),_a19);function isMatrixTransform(node){return isMatrixTransformType(node.constructor)}__name(isMatrixTransform,"isMatrixTransform");var MATRIX_TRANSFORM_TYPE=Symbol("isMatrixTransform");function isMatrixTransformType(cstr){return cstr[MATRIX_TRANSFORM_TYPE]===!0}__name(isMatrixTransformType,"isMatrixTransformType");function MatrixTransform(Parent){var _a294,_b;const ParentNode=Parent;if(isMatrixTransformType(Parent))return Parent;const TRANSFORM_MATRIX=Symbol("matrix_combined_transform"),_MatrixTransformInternal=class _MatrixTransformInternal extends ParentNode{constructor(){super(...arguments),this[_b]=new Matrix,this._dirtyTransform=!0}markDirtyTransform(){this._dirtyTransform=!0,super.markDirty()}updateMatrix(_matrix){}computeTransformMatrix(){this._dirtyTransform&&(this[TRANSFORM_MATRIX].setElements(IDENTITY_MATRIX_ELEMENTS),this.updateMatrix(this[TRANSFORM_MATRIX]),this._dirtyTransform=!1)}toParent(bbox){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?bbox.clone():this[TRANSFORM_MATRIX].transformBBox(bbox)}toParentPoint(x,y){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?{x,y}:this[TRANSFORM_MATRIX].transformPoint(x,y)}fromParent(bbox){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?bbox.clone():this[TRANSFORM_MATRIX].inverse().transformBBox(bbox)}fromParentPoint(x,y){return this.computeTransformMatrix(),this[TRANSFORM_MATRIX].identity?{x,y}:this[TRANSFORM_MATRIX].inverse().transformPoint(x,y)}computeBBox(){const bbox=super.computeBBox();return bbox&&this.toParent(bbox)}computeBBoxWithoutTransforms(){return super.computeBBox()}pickNode(x,y){return{x,y}=this.fromParentPoint(x,y),super.pickNode(x,y)}pickNodes(x,y,into){return{x,y}=this.fromParentPoint(x,y),super.pickNodes(x,y,into)}render(renderCtx){this.computeTransformMatrix();const{ctx}=renderCtx,matrix=this[TRANSFORM_MATRIX];let performRestore=!1;matrix.identity||(ctx.save(),performRestore=!0,matrix.toContext(ctx)),super.render(renderCtx),performRestore&&ctx.restore()}toSVG(){this.computeTransformMatrix();const svg=super.toSVG(),matrix=this[TRANSFORM_MATRIX];if(matrix.identity||svg==null)return svg;const g=createSvgElement("g");g.append(...svg.elements);const[a,b,c,d,e,f]=matrix.e;return g.setAttribute("transform",`matrix(${a} ${b} ${c} ${d} ${e} ${f})`),{elements:[g],defs:svg.defs}}};__name(_MatrixTransformInternal,"MatrixTransformInternal");let MatrixTransformInternal=_MatrixTransformInternal;return _a294=MATRIX_TRANSFORM_TYPE,_b=TRANSFORM_MATRIX,MatrixTransformInternal[_a294]=!0,MatrixTransformInternal}__name(MatrixTransform,"MatrixTransform");function Rotatable(Parent){var _a294;const ParentNode=Parent,ROTATABLE_MATRIX=Symbol("matrix_rotation"),_RotatableInternal=class _RotatableInternal extends MatrixTransform(ParentNode){constructor(){super(...arguments),this[_a294]=new Matrix,this.rotationCenterX=null,this.rotationCenterY=null,this.rotation=0}updateMatrix(matrix){super.updateMatrix(matrix);const{rotation,rotationCenterX,rotationCenterY}=this;rotation!==0&&(Matrix.updateTransformMatrix(this[ROTATABLE_MATRIX],1,1,rotation,0,0,{rotationCenterX,rotationCenterY}),matrix.multiplySelf(this[ROTATABLE_MATRIX]))}};__name(_RotatableInternal,"RotatableInternal");let RotatableInternal=_RotatableInternal;return _a294=ROTATABLE_MATRIX,__decorateClass([SceneChangeDetection({type:"transform"})],RotatableInternal.prototype,"rotationCenterX",2),__decorateClass([SceneChangeDetection({type:"transform"})],RotatableInternal.prototype,"rotationCenterY",2),__decorateClass([SceneChangeDetection({type:"transform"})],RotatableInternal.prototype,"rotation",2),RotatableInternal}__name(Rotatable,"Rotatable");function Scalable(Parent){var _a294;const ParentNode=Parent,SCALABLE_MATRIX=Symbol("matrix_scale"),_ScalableInternal=class _ScalableInternal extends MatrixTransform(ParentNode){constructor(){super(...arguments),this[_a294]=new Matrix,this.scalingX=1,this.scalingY=1,this.scalingCenterX=null,this.scalingCenterY=null}updateMatrix(matrix){super.updateMatrix(matrix);const{scalingX,scalingY,scalingCenterX,scalingCenterY}=this;scalingX===1&&scalingY===1||(Matrix.updateTransformMatrix(this[SCALABLE_MATRIX],scalingX,scalingY,0,0,0,{scalingCenterX,scalingCenterY}),matrix.multiplySelf(this[SCALABLE_MATRIX]))}};__name(_ScalableInternal,"ScalableInternal");let ScalableInternal=_ScalableInternal;return _a294=SCALABLE_MATRIX,__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingX",2),__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingY",2),__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingCenterX",2),__decorateClass([SceneChangeDetection({type:"transform"})],ScalableInternal.prototype,"scalingCenterY",2),ScalableInternal}__name(Scalable,"Scalable");function Translatable(Parent){var _a294;const ParentNode=Parent,TRANSLATABLE_MATRIX=Symbol("matrix_translation"),_TranslatableInternal=class _TranslatableInternal extends MatrixTransform(ParentNode){constructor(){super(...arguments),this[_a294]=new Matrix,this.translationX=0,this.translationY=0}updateMatrix(matrix){super.updateMatrix(matrix);const{translationX,translationY}=this;translationX===0&&translationY===0||(Matrix.updateTransformMatrix(this[TRANSLATABLE_MATRIX],1,1,0,translationX,translationY),matrix.multiplySelf(this[TRANSLATABLE_MATRIX]))}};__name(_TranslatableInternal,"TranslatableInternal");let TranslatableInternal=_TranslatableInternal;return _a294=TRANSLATABLE_MATRIX,__decorateClass([SceneChangeDetection({type:"transform"})],TranslatableInternal.prototype,"translationX",2),__decorateClass([SceneChangeDetection({type:"transform"})],TranslatableInternal.prototype,"translationY",2),TranslatableInternal}__name(Translatable,"Translatable");var _a20,Transformable=(_a20=class{static fromCanvas(node,bbox){const parents=[];for(const parent of node.traverseUp())isMatrixTransform(parent)&&parents.unshift(parent);for(const parent of parents)bbox=parent.fromParent(bbox);return isMatrixTransform(node)&&(bbox=node.fromParent(bbox)),bbox}static toCanvas(node,bbox){bbox==null?bbox=node.getBBox():isMatrixTransform(node)&&(bbox=node.toParent(bbox));for(const parent of node.traverseUp())isMatrixTransform(parent)&&(bbox=parent.toParent(bbox));return bbox}static fromCanvasPoint(node,x,y){const parents=[];for(const parent of node.traverseUp())isMatrixTransform(parent)&&parents.unshift(parent);for(const parent of parents)({x,y}=parent.fromParentPoint(x,y));return isMatrixTransform(node)&&({x,y}=node.fromParentPoint(x,y)),{x,y}}static toCanvasPoint(node,x,y){isMatrixTransform(node)&&({x,y}=node.toParentPoint(x,y));for(const parent of node.traverseUp())isMatrixTransform(parent)&&({x,y}=parent.toParentPoint(x,y));return{x,y}}},__name(_a20,"Transformable"),_a20),cmp=__name((a,b)=>Math.sign(a-b),"cmp");function compareZIndex(a,b){if(typeof a=="number"&&typeof b=="number")return cmp(a,b);const aArray=typeof a=="number"?[a]:a,bArray=typeof b=="number"?[b]:b,length2=Math.min(aArray.length,bArray.length);for(let i=0;i<length2;i+=1){const diff2=cmp(aArray[i],bArray[i]);if(diff2!==0)return diff2}return cmp(aArray.length,bArray.length)}__name(compareZIndex,"compareZIndex");var sharedOffscreenCanvas,_a21,_Group=(_a21=class extends Node{constructor(opts){super(opts),this.opacity=1,this.renderToOffscreenCanvas=!1,this.optimizeForInfrequentRedraws=!1,this.layer=void 0,this.image=void 0,this._lastWidth=NaN,this._lastHeight=NaN,this._lastDevicePixelRatio=NaN,this.isContainerNode=!0,this.renderToOffscreenCanvas=(opts==null?void 0:opts.renderToOffscreenCanvas)===!0}static is(value){return value instanceof _a21}static computeChildrenBBox(nodes,skipInvisible=!0){return BBox.merge(Node.extractBBoxes(nodes,skipInvisible))}static compareChildren(a,b){return compareZIndex(a.zIndex,b.zIndex)||a.serialNumber-b.serialNumber}containsPoint(_x,_y){return!0}computeBBox(){return _a21.computeChildrenBBox(this.children())}computeSafeClippingBBox(pixelRatio){const bbox=this.computeBBox();if(!bbox.isFinite())return;let strokeWidth=0;const strokeMiterAmount=4;for(const child of this.descendants())child instanceof Shape&&(strokeWidth=Math.max(strokeWidth,child.strokeWidth));const padding=Math.max(1,strokeWidth/2*strokeMiterAmount),{x:originX,y:originY}=Transformable.toCanvasPoint(this,0,0),x=alignBefore(pixelRatio,originX+bbox.x-padding)-originX,y=alignBefore(pixelRatio,originY+bbox.y-padding)-originY,width2=Math.ceil(bbox.x+bbox.width-x+padding),height2=Math.ceil(bbox.y+bbox.height-y+padding);return new BBox(x,y,width2,height2)}prepareSharedCanvas(width2,height2,pixelRatio){return sharedOffscreenCanvas==null||sharedOffscreenCanvas.pixelRatio!==pixelRatio?sharedOffscreenCanvas=new HdpiOffscreenCanvas({width:width2,height:height2,pixelRatio}):sharedOffscreenCanvas.resize(width2,height2,pixelRatio),sharedOffscreenCanvas}isDirty(renderCtx){const{width:width2,height:height2,devicePixelRatio}=renderCtx,{dirty,dirtyZIndex,layer}=this,layerResized=layer!=null&&(this._lastWidth!==width2||this._lastHeight!==height2),pixelRatioChanged=this._lastDevicePixelRatio!==devicePixelRatio;if(this._lastWidth=width2,this._lastHeight=height2,this._lastDevicePixelRatio=devicePixelRatio,dirty||dirtyZIndex||layerResized||pixelRatioChanged)return!0;for(const child of this.children())if(child.dirty)return!0;return!1}preRender(renderCtx){var _a294,_b;const counts=super.preRender(renderCtx,0);return counts.groups+=1,counts.nonGroups-=1,this.renderToOffscreenCanvas&&!this.optimizeForInfrequentRedraws&&counts.nonGroups>0&&this.getVisibility()?this.layer??(this.layer=(_a294=this._layerManager)==null?void 0:_a294.addLayer({name:this.name})):this.layer!=null&&((_b=this._layerManager)==null||_b.removeLayer(this.layer),this.layer=void 0),counts}render(renderCtx){const{layer,renderToOffscreenCanvas}=this,childRenderCtx={...renderCtx};if(!renderToOffscreenCanvas){this.renderInContext(childRenderCtx),super.render(childRenderCtx);return}const{ctx,stats,devicePixelRatio:pixelRatio}=renderCtx;let{image}=this;if(this.isDirty(renderCtx)){image==null||image.bitmap.close(),image=void 0;const bbox=layer?void 0:this.computeSafeClippingBBox(pixelRatio),renderOffscreen=__name((offscreenCanvas,...transform)=>{var _a294;const offscreenCtx=offscreenCanvas.context;childRenderCtx.ctx=offscreenCtx,offscreenCanvas.clear(),offscreenCtx.save(),offscreenCtx.setTransform(...transform),offscreenCtx.globalAlpha=1,this.renderInContext(childRenderCtx),offscreenCtx.restore(),(_a294=offscreenCtx.verifyDepthZero)==null||_a294.call(offscreenCtx)},"renderOffscreen");if(layer)renderOffscreen(layer,ctx.getTransform());else if(bbox){const{x,y,width:width2,height:height2}=bbox,canvas=this.prepareSharedCanvas(width2,height2,pixelRatio);renderOffscreen(canvas,pixelRatio,0,0,pixelRatio,-x*pixelRatio,-y*pixelRatio),image={bitmap:canvas.transferToImageBitmap(),x,y,width:width2,height:height2}}else this.dirtyZIndex&&this.sortChildren(_a21.compareChildren);this.image=image,stats&&stats.layersRendered++}else this.skipRender(childRenderCtx),stats&&stats.layersSkipped++;const{globalAlpha}=ctx;if(ctx.globalAlpha=globalAlpha*this.opacity,layer)ctx.save(),ctx.resetTransform(),layer.drawImage(ctx),ctx.restore();else if(image){const{bitmap,x,y,width:width2,height:height2}=image;ctx.drawImage(bitmap,0,0,width2*pixelRatio,height2*pixelRatio,x,y,width2,height2)}ctx.globalAlpha=globalAlpha,super.render(childRenderCtx)}skipRender(childRenderCtx){const{stats}=childRenderCtx;for(const child of this.children())child.markClean(),stats&&(stats.nodesSkipped+=this.childNodeCounts.groups+this.childNodeCounts.nonGroups,stats.opsSkipped+=this.childNodeCounts.complexity)}applyClip(ctx,clipRect){const{x,y,width:width2,height:height2}=clipRect;ctx.beginPath(),ctx.rect(x,y,width2,height2),ctx.clip()}renderInContext(childRenderCtx){const{ctx,stats}=childRenderCtx;this.dirtyZIndex&&this.sortChildren(_a21.compareChildren),ctx.save(),ctx.globalAlpha*=this.opacity,this.clipRect!=null&&(this.applyClip(ctx,this.clipRect),childRenderCtx.clipBBox=Transformable.toCanvas(this,this.clipRect));for(const child of this.children()){if(!child.visible){child.markClean(),stats&&(stats.nodesSkipped+=child.childNodeCounts.nonGroups+child.childNodeCounts.groups,stats.opsSkipped+=child.childNodeCounts.complexity);continue}ctx.save(),child.render(childRenderCtx),ctx.restore()}ctx.restore()}setClipRect(bbox){this.clipRect=bbox?Transformable.fromCanvas(this,bbox):void 0}setClipRectCanvasSpace(bbox){this.clipRect=bbox}_setLayerManager(layersManager){var _a294;this.layer&&((_a294=this._layerManager)==null||_a294.removeLayer(this.layer),this.layer=void 0),super._setLayerManager(layersManager)}getVisibility(){for(const node of this.traverseUp(!0))if(!node.visible)return!1;return!0}toSVG(){if(!this.visible)return;const defs=[],elements=[];for(const child of this.children()){const svg=child.toSVG();svg!=null&&(elements.push(...svg.elements),svg.defs!=null&&defs.push(...svg.defs))}return{elements,defs}}},__name(_a21,"_Group"),_a21);_Group.className="Group";__decorateClass([SceneChangeDetection({convertor:__name(v=>clamp(0,v,1),"convertor")})],_Group.prototype,"opacity",2);var Group=_Group,_a22,ScalableGroup=(_a22=class extends Scalable(Group){},__name(_a22,"ScalableGroup"),_a22),_a23,RotatableGroup=(_a23=class extends Rotatable(Group){},__name(_a23,"RotatableGroup"),_a23),_a24,TranslatableGroup=(_a24=class extends Translatable(Group){},__name(_a24,"TranslatableGroup"),_a24),_a25,TransformableGroup=(_a25=class extends Rotatable(Translatable(Group)){},__name(_a25,"TransformableGroup"),_a25),_a26,AsyncAwaitQueue=(_a26=class{constructor(){this.queue=[]}await(timeout=50){return new Promise(resolve=>{const successFn=__name(()=>{clearTimeout(timeoutHandle),resolve(!0)},"successFn"),timeoutHandle=setTimeout(__name(()=>{const queueIndex=this.queue.indexOf(successFn);queueIndex<0||(this.queue.splice(queueIndex,1),resolve(!1))},"timeoutFn"),timeout);this.queue.push(successFn)})}notify(){this.queue.splice(0).forEach(cb=>cb())}},__name(_a26,"AsyncAwaitQueue"),_a26);function pause(){return new Promise(resolve=>{setTimeout(resolve,0)})}__name(pause,"pause");function setElementBBox(element2,bbox){element2&&(bbox=BBoxValues.normalize(bbox),bbox.width==null?element2.style.removeProperty("width"):element2.style.width=`${bbox.width}px`,bbox.height==null?element2.style.removeProperty("height"):element2.style.height=`${bbox.height}px`,bbox.x==null?element2.style.removeProperty("left"):element2.style.left=`${bbox.x}px`,bbox.y==null?element2.style.removeProperty("top"):element2.style.top=`${bbox.y}px`)}__name(setElementBBox,"setElementBBox");function getElementBBox(element2){const width2=parseFloat(element2.style.width)||element2.offsetWidth,height2=parseFloat(element2.style.height)||element2.offsetHeight,x=parseFloat(element2.style.left)||element2.offsetLeft,y=parseFloat(element2.style.top)||element2.offsetTop;return{x,y,width:width2,height:height2}}__name(getElementBBox,"getElementBBox");function focusCursorAtEnd(element2){var _a294;if(element2.focus({preventScroll:!0}),((_a294=element2.lastChild)==null?void 0:_a294.textContent)==null)return;const range3=getDocument().createRange();range3.setStart(element2.lastChild,element2.lastChild.textContent.length),range3.setEnd(element2.lastChild,element2.lastChild.textContent.length);const selection=getWindow().getSelection();selection==null||selection.removeAllRanges(),selection==null||selection.addRange(range3)}__name(focusCursorAtEnd,"focusCursorAtEnd");var _id=0;function createElementId(label){return`${label??"ag-charts-element"}-${_id++}`}__name(createElementId,"createElementId");function isInputPending(){const navigator=getWindow("navigator");if("scheduling"in navigator){const scheduling=navigator.scheduling;if("isInputPending"in scheduling)return scheduling.isInputPending({includeContinuous:!0})}return!1}__name(isInputPending,"isInputPending");function getIconClassNames(icon){return`ag-charts-icon ag-charts-icon-${icon}`}__name(getIconClassNames,"getIconClassNames");var CLASS_INSTANCE_TYPE="class-instance";function jsonDiff(source,target,shallow){if(isArray(target)){if(!isArray(source)||source.length!==target.length||target.some((v,i)=>jsonDiff(source[i],v,shallow)!=null))return target}else if(isPlainObject(target)){if(!isPlainObject(source))return target;const result={},allKeys=new Set([...Object.keys(source),...Object.keys(target)]);for(const key of allKeys)if(source[key]!==target[key])if(shallow!=null&&shallow.has(key))result[key]=target[key];else if(typeof source[key]==typeof target[key]){const diff2=jsonDiff(source[key],target[key],shallow);diff2!==null&&(result[key]=diff2)}else result[key]=target[key];return Object.keys(result).length?result:null}else if(source!==target)return target;return null}__name(jsonDiff,"jsonDiff");function jsonPropertyCompare(source,target){for(const key of Object.keys(source))if(source[key]!==(target==null?void 0:target[key]))return!1;return!0}__name(jsonPropertyCompare,"jsonPropertyCompare");function deepClone(source,opts){return isArray(source)?source.map(item=>deepClone(item,opts)):isPlainObject(source)?clonePlainObject(source,opts):source instanceof Map?new Map(deepClone(Array.from(source))):shallowClone(source)}__name(deepClone,"deepClone");function clonePlainObject(source,opts){var _a294,_b;const target={};for(const key of Object.keys(source))(_a294=opts==null?void 0:opts.assign)!=null&&_a294.has(key)?target[key]=source[key]:(_b=opts==null?void 0:opts.shallow)!=null&&_b.has(key)?target[key]=shallowClone(source[key]):target[key]=deepClone(source[key],opts);return target}__name(clonePlainObject,"clonePlainObject");function shallowClone(source){return isArray(source)?source.slice(0):isPlainObject(source)?{...source}:isDate(source)?new Date(source):isRegExp(source)?new RegExp(source.source,source.flags):source}__name(shallowClone,"shallowClone");function jsonWalk(json,visit,skip,parallelJson,ctx,acc){if(isArray(json)){acc=visit(json,parallelJson,ctx,acc);let index=0;for(const node of json)acc=jsonWalk(node,visit,skip,parallelJson==null?void 0:parallelJson[index],ctx,acc),index++}else if(isPlainObject(json)){acc=visit(json,parallelJson,ctx,acc);for(const key of Object.keys(json)){if(skip!=null&&skip.has(key))continue;const value=json[key];acc=jsonWalk(value,visit,skip,parallelJson==null?void 0:parallelJson[key],ctx,acc)}}return acc}__name(jsonWalk,"jsonWalk");function jsonApply(target,source,params={}){const{path,matcherPath=path==null?void 0:path.replace(/(\[[0-9+]+])/i,"[]"),skip=[]}=params;if(target==null)throw new Error(`AG Charts - target is uninitialised: ${path??"<root>"}`);if(source==null)return target;if(isProperties(target))return target.set(source);const targetAny=target,targetType=classify(target);for(const property of Object.keys(source)){if(SKIP_JS_BUILTINS.has(property))continue;const propertyMatcherPath=`${matcherPath?matcherPath+".":""}${property}`;if(skip.includes(propertyMatcherPath))continue;const newValue=source[property],propertyPath=`${path?path+".":""}${property}`,targetClass=targetAny.constructor,currentValue=targetAny[property];try{const currentValueType=classify(currentValue),newValueType=classify(newValue);if(targetType===CLASS_INSTANCE_TYPE&&!(property in target||property==="context")){if(newValue===void 0)continue;logger_exports.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - property is unknown`);continue}if(currentValueType!=null&&newValueType!=null&&newValueType!==currentValueType&&(currentValueType!==CLASS_INSTANCE_TYPE||newValueType!=="object")){logger_exports.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - can't apply type of [${newValueType}], allowed types are: [${currentValueType}]`);continue}if(isProperties(currentValue))targetAny[property].set(newValue);else if(newValueType==="object"&&property!=="context"){if(currentValue==null){logger_exports.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - property is unknown`);continue}jsonApply(currentValue,newValue,{...params,path:propertyPath,matcherPath:propertyMatcherPath})}else targetAny[property]=newValue}catch(error){logger_exports.warn(`unable to set [${propertyPath}] in [${targetClass==null?void 0:targetClass.name}]; nested error is: ${error.message}`)}}return target}__name(jsonApply,"jsonApply");function classify(value){return value==null?null:isHtmlElement(value)||isDate(value)?"primitive":isArray(value)?"array":isObject(value)?isPlainObject(value)?"object":CLASS_INSTANCE_TYPE:isFunction(value)?"function":"primitive"}__name(classify,"classify");function jsonResolveOperations(source,params,skip,context){return jsonResolveInner(source,params,context??source,{matches:new Map},skip)}__name(jsonResolveOperations,"jsonResolveOperations");var operationResolvedUndefined=Symbol("operation-resolved-undefined");function jsonResolveInner(json,params,source,meta,skip,path=[],modifiedPaths={}){if(isArray(json)){jsonResolveVisitor(json,params,source,meta,path,modifiedPaths);let index=0;for(const node of json)jsonResolveInner(node,params,source,meta,skip,[...path,`${index}`],modifiedPaths),index++}else if(isPlainObject(json)){jsonResolveVisitor(json,params,source,meta,path,modifiedPaths);for(const key of Object.keys(json)){if(skip!=null&&skip.has(key))continue;const node=json[key];jsonResolveInner(node,params,source,meta,skip,[...path,key],modifiedPaths)}}return modifiedPaths}__name(jsonResolveInner,"jsonResolveInner");function jsonResolveVisitor(node,params,source,meta,path,modifiedPaths){if(isArray(node))for(let i=0;i<node.length;i++)node[i]=jsonResolveVisitorValue(node[i],params,source,meta,[...path,`${i}`],modifiedPaths),node[i]===operationResolvedUndefined&&(node[i]=void 0);else{let hasOperation=!1;for(const name of Object.keys(node))node[name]=jsonResolveVisitorValue(node[name],params,source,meta,[...path,name],modifiedPaths),hasOperation||(hasOperation=isKey(name,operations)),node[name]===operationResolvedUndefined&&delete node[name];if(hasOperation&&Object.keys(node).length>1)for(const key of Object.keys(node))isKey(key,operations)&&delete node[key]}}__name(jsonResolveVisitor,"jsonResolveVisitor");function jsonResolveVisitorValue(value,params,source,meta,path,modifiedPaths){const operation=getOperation(value);if(!operation)return value;modifiedPaths[path.join(".")]=value;const resolved=resolveOperation(operation.operation,operation.values,params,source,path,meta);return resolved===void 0?operationResolvedUndefined:resolved}__name(jsonResolveVisitorValue,"jsonResolveVisitorValue");function getOperation(value){if(!isPlainObject(value))return;const[operation]=Object.keys(value);if(isKey(operation,operations))return{operation,values:value[operation]}}__name(getOperation,"getOperation");function resolveOperation(operation,value,params,source,path,meta){meta.referencedParams??(meta.referencedParams=new Set);const resolveBranchFirst=["$find","$map"];isArray(value)&&!resolveBranchFirst.includes(operation)&&(value=value.map(v=>{const nestedOperation=getOperation(v);return nestedOperation?resolveOperation(nestedOperation.operation,nestedOperation.values,params,source,path,meta):v}));const fn=operations[operation];return fn(value,path,params,source,meta)}__name(resolveOperation,"resolveOperation");function isKey(key,obj){return isString(key)&&(isObject(obj)||isArray(obj))&&key in obj}__name(isKey,"isKey");function isRatio(value){return isNumber(value)&&value>=0&&value<=1}__name(isRatio,"isRatio");function isGradientFill2(fill){return isObject(fill)&&fill.type=="gradient"}__name(isGradientFill2,"isGradientFill2");function isPatternFill2(fill){return fill!==null&&isObject(fill)&&fill.type=="pattern"}__name(isPatternFill2,"isPatternFill2");function resolvePath(root,path){const relativePathParts=path.split("/");let resolvedPath=[...root];path.startsWith("/")&&(resolvedPath=[],relativePathParts.shift());let prevPartWasTwoDots=!1;for(const part of relativePathParts){if(part==="..")resolvedPath.pop(),prevPartWasTwoDots||resolvedPath.pop();else if(part===".")resolvedPath.pop();else if(part==="$index"){const index=root.findLast(v=>!isNaN(Number(v)));index!=null&&resolvedPath.push(index)}else if(part==="$prevIndex"){const index=root.findLast(v=>!isNaN(Number(v)));index!=null&&resolvedPath.push(`${Number(index)-1}`)}else part.length!==0&&resolvedPath.push(part);prevPartWasTwoDots=part===".."}return resolvedPath}__name(resolvePath,"resolvePath");var locationOperations={$ref:ref,$path:pathOperation,$palette:palette},logicOperations={$if:__name(([condition,thenValue,elseValue])=>condition?thenValue:elseValue,"$if"),$eq:__name(([a,b])=>a===b,"$eq"),$not:__name(([a])=>!a,"$not"),$or:__name(values=>isArray(values)&&values.some(Boolean),"$or"),$and:__name(values=>isArray(values)&&values.every(Boolean),"$and"),$switch:__name(()=>{},"$switch"),$isOperation:isOperationOperator},numericOperations={$isEven:isEven,$mul:mul,$round:round},transformOperations={$map:map,$find:find,$merge:merge2,$omit:omit,$value:valueOperation},fontOperations={$rem:rem},colorOperations={$mix:mix,$foregroundBackgroundMix:foregroundBackgroundMix,$foregroundBackgroundAccentMix:foregroundBackgroundAccentMix,$interpolate:interpolate2,$isGradient:__name(([value])=>isGradientFill2(value),"$isGradient"),$isPattern:__name(([value])=>isPatternFill2(value),"$isPattern")},operations={...locationOperations,...logicOperations,...numericOperations,...transformOperations,...fontOperations,...colorOperations};function ref(value,path,params,source,meta){var _a294,_b;if(!isKey(value,params)){logger_exports.warnOnce(`\`$ref\` json operation failed on [${String(value)}] at [${path.join(".")}], expecting one of [${Object.keys(params).join(", ")}].`);return}const operation=getOperation(params[value]);if((operation==null?void 0:operation.operation)!=="$ref")return params[value];if((_a294=meta.referencedParams)!=null&&_a294.has(operation.values)){logger_exports.warnOnce(`\`$ref\` json operation failed on [${String(value)}] at [${path.join(".")}], circular reference detected with [${[...meta.referencedParams].join(", ")}].`);return}return(_b=meta.referencedParams)==null||_b.add(operation.values),ref(operation.values,path,params,source,meta)}__name(ref,"ref");function palette(value,path,params,source){if(!isString(value))return;const p=params.__palette;if(["fill","fillFallback","stroke","gradient","range2"].includes(value)){const indexIndex=path.findLastIndex(v=>!isNaN(Number(v)));let index=Number(path[indexIndex]);if(isNaN(index))return;const seriesPath=path.slice(0,indexIndex),ignoreIndexSeries=["map-shape-background","map-line-background"],ignoreIndexOffset=getPath(source,seriesPath).slice(0,index).filter(s=>ignoreIndexSeries.includes(s.type)).length;switch(index-=ignoreIndexOffset,value){case"fill":return circularSliceArray(p.fills,1,index)[0];case"fillFallback":return circularSliceArray(p.fillsFallback,1,index)[0];case"stroke":return circularSliceArray(p.strokes,1,index)[0];case"gradient":return circularSliceArray(p.sequentialColors,1,index)[0];case"range2":return circularSliceArray(p.fills,2,index)}return}return value==="gradients"?p.sequentialColors:getPath(p,value)}__name(palette,"palette");function pathOperation(value,path,_params,source){let hasDefaultValue=!1,defaultValue,usingCustomBranch=!1,branch=source;if(isArray(value))hasDefaultValue=!0,defaultValue=value[1],usingCustomBranch=value.length===3,branch=usingCustomBranch?value[2]:branch,value=value[0];else if(!isString(value)){logger_exports.warnOnce(`\`$path\` json operation failed on [${String(value)}] at [${path.join(".")}], expecting a string.`);return}const resolvedPath=resolvePath(usingCustomBranch?[]:path,value);let resolvedValue=branch;for(const part of resolvedPath){if(!isKey(part,resolvedValue)){if(hasDefaultValue)return defaultValue;logger_exports.warnOnce(`\`$path\` json operation failed on [${String(value)}] at [${path.join(".")}] resolved to [${resolvedPath.join(".")}], could not find path in object.`);return}resolvedValue=resolvedValue[part]}return Object.isFrozen(resolvedValue)?deepClone(resolvedValue):resolvedValue}__name(pathOperation,"pathOperation");function isOperationOperator(value,path,_params,source){const resolvedPath=isString(value)?resolvePath(path,value):path,branch=resolvedPath.length===0?source:getPath(source,resolvedPath);return getOperation(branch)!=null}__name(isOperationOperator,"isOperationOperator");function isEven([a],path){if(typeof a=="number")return a%2===0;logger_exports.warnOnce(`\`$isEven\` json operation failed on [${String(a)}] at [${path.join(".")}], expecting a number.`)}__name(isEven,"isEven");function mul([a,b],path){if(typeof a=="number"&&typeof b=="number")return a*b;logger_exports.warnOnce(`\`$mul\` json operation failed on [${String(a)}] and [${String(b)}] at [${path.join(".")}], expecting two numbers.`)}__name(mul,"mul");function round([a],path){if(typeof a=="number")return Math.round(a);logger_exports.warnOnce(`\`$round\` json operation failed on [${String(a)}] at [${path.join(".")}], expecting a number.`)}__name(round,"round");function map([mapOperation,mapValues2],path,params,source,meta){const valuesOperation=getOperation(mapValues2);if(valuesOperation&&(mapValues2=resolveOperation(valuesOperation.operation,valuesOperation.values,params,source,path,meta)),!isArray(mapValues2))return[];const mappedOperation=getOperation(mapOperation);return mappedOperation?(meta.matches.set(path.join("."),mapValues2),mapValues2.map(()=>({[mappedOperation.operation]:mappedOperation.values}))):[]}__name(map,"map");function find([findCondition,findValues],path,params,source,meta){const valuesOperation=getOperation(findValues);if(valuesOperation&&(findValues=resolveOperation(valuesOperation.operation,valuesOperation.values,params,source,path,meta)),!isArray(findValues))return;const conditionOperation=getOperation(findCondition);return conditionOperation?findValues.find(value=>resolveOperation(conditionOperation.operation,conditionOperation.values,params,value,[],meta)):findCondition?findValues[0]:void 0}__name(find,"find");function merge2(values){if(isArray(values)){for(const value of values)if(!isPlainObject(value))return;return mergeDefaults(...values)}}__name(merge2,"merge2");function omit([keys,object4]){if(!(!isArray(keys)||!isPlainObject(object4)))return without(object4,keys)}__name(omit,"omit");function valueOperation(value,path,_params,_source,meta){var _a294;if(value!=="$1"&&value!=="$index")return value;const indexIndex=path.findLastIndex(v=>!isNaN(Number(v)));if(indexIndex===-1)return value;const index=Number(path[indexIndex]);if(value==="$index")return index;const key=path.slice(0,indexIndex).join(".");return(_a294=meta.matches.get(key))==null?void 0:_a294.at(index)}__name(valueOperation,"valueOperation");function rem([a],path,params){const fontSize="fontSize";if(isKey(fontSize,params)&&typeof params[fontSize]=="number"&&typeof a=="number")return Math.round(a*params[fontSize]);logger_exports.warnOnce(`\`$rem\` json operation failed on [${String(a)}] at [${path.join(".")}], expecting a number.`)}__name(rem,"rem");function mix([a,b,c],path){const warningPrefix=`\`$mix\` json operation failed on [${String(a)}, ${String(b)}, ${String(c)}] at [${path.join(".")}], expecting`,warningMessage=`${warningPrefix} two colors and a number between 0 and 1.`;if(typeof b!="string"||!isRatio(c)){logger_exports.warnOnce(warningMessage);return}if(typeof a=="string")try{return Color.mix(Color.fromString(a),Color.fromString(b),c).toString()}catch{logger_exports.warnOnce(warningMessage);return}if(!isGradientFill2(a)){logger_exports.warnOnce(warningMessage);return}let colorStops=a.colorStops;try{colorStops=colorStops==null?void 0:colorStops.map(value=>{let color6;return typeof value.color=="string"&&(color6=Color.mix(Color.fromString(value.color),Color.fromString(b),c).toString()),{...value,color:color6}})}catch{logger_exports.warnOnce(`${warningPrefix} a gradient, a color and a number between 0 and 1.`);return}return{...a,colorStops}}__name(mix,"mix");function foregroundBackgroundMix([background],path,params){const foregroundColor="foregroundColor",backgroundColor="backgroundColor";if(isKey(foregroundColor,params)&&isKey(backgroundColor,params)&&typeof params[foregroundColor]=="string"&&typeof params[backgroundColor]=="string"&&isRatio(background))return Color.mix(Color.fromString(params[foregroundColor]),Color.fromString(params[backgroundColor]),background).toString();logger_exports.warnOnce(`\`$foregroundBackgroundMix\` json operation failed on [${String(background)}}}] at [${path.join(".")}], expecting a number between 0 and 1.`)}__name(foregroundBackgroundMix,"foregroundBackgroundMix");function foregroundBackgroundAccentMix([background,accent],path,params){const foregroundColor="foregroundColor",backgroundColor="backgroundColor",accentColor="accentColor";if(isKey(foregroundColor,params)&&isKey(backgroundColor,params)&&isKey(accentColor,params)&&typeof params[foregroundColor]=="string"&&typeof params[backgroundColor]=="string"&&typeof params[accentColor]=="string"&&isRatio(background)&&isRatio(accent))return Color.mix(Color.mix(Color.fromString(params[foregroundColor]),Color.fromString(params[backgroundColor]),background),Color.fromString(params[accentColor]),accent).toString();logger_exports.warnOnce(`\`$foregroundBackgroundAccentMix\` json operation failed on [${String(background)}, ${String(accent)}}] at [${path.join(".")}], expecting two numbers between 0 and 1.`)}__name(foregroundBackgroundAccentMix,"foregroundBackgroundAccentMix");function interpolate2([colors,count]){if(!(!isArray(colors)||!isNumber(count)))return Color.interpolate(colors.map(color6=>Color.fromString(color6)),count).map(color6=>color6.toString())}__name(interpolate2,"interpolate2");var _a27,Mutex=(_a27=class{constructor(){this.available=!0,this.acquireQueue=[]}acquire(cb){return new Promise(resolve=>{this.acquireQueue.push([cb,resolve]),this.available&&this.dispatchNext().catch(e=>logger_exports.errorOnce(e))})}async acquireImmediately(cb){return this.available?(await this.acquire(cb),!0):!1}async waitForClearAcquireQueue(){return this.acquire(()=>Promise.resolve(void 0))}async dispatchNext(){this.available=!1;let[next,done]=this.acquireQueue.shift()??[];for(;next;){try{await next(),done==null||done()}catch(error){logger_exports.error("mutex callback error",error),done==null||done()}[next,done]=this.acquireQueue.shift()??[]}this.available=!0}},__name(_a27,"Mutex"),_a27),_a28,Observable=(_a28=class{constructor(){this.eventListeners=new Map}addEventListener(eventType,listener){if(typeof listener!="function")throw new Error("AG Charts - listener must be a Function");const eventTypeListeners=this.eventListeners.get(eventType);eventTypeListeners?eventTypeListeners.add(listener):this.eventListeners.set(eventType,new Set([listener]))}removeEventListener(type,listener){const listeners=this.eventListeners.get(type);listeners!=null&&(listeners.delete(listener),listeners.size===0&&this.eventListeners.delete(type))}hasEventListener(type){return this.eventListeners.has(type)}clearEventListeners(){this.eventListeners.clear()}fireEvent(event){var _a294;(_a294=this.eventListeners.get(event.type))==null||_a294.forEach(listener=>listener(event))}},__name(_a28,"Observable"),_a28),_a29,Padding=(_a29=class extends BaseProperties{constructor(top=0,right=top,bottom=top,left=right){super(),this.top=top,this.right=right,this.bottom=bottom,this.left=left}},__name(_a29,"Padding"),_a29);__decorateClass([TempValidate()],Padding.prototype,"top",2);__decorateClass([TempValidate()],Padding.prototype,"right",2);__decorateClass([TempValidate()],Padding.prototype,"bottom",2);__decorateClass([TempValidate()],Padding.prototype,"left",2);function ProxyProperty(proxyPath,configMetadata){const pathArray=isArray(proxyPath)?proxyPath:proxyPath.split(".");if(pathArray.length===1){const[property]=pathArray;return addTransformToInstanceProperty((target,_,value)=>target[property]=value,target=>target[property],configMetadata)}return addTransformToInstanceProperty((target,_,value)=>setPath(target,pathArray,value),target=>getPath(target,pathArray),configMetadata)}__name(ProxyProperty,"ProxyProperty");function ProxyOnWrite(proxyProperty){return addTransformToInstanceProperty((target,_,value)=>target[proxyProperty]=value)}__name(ProxyOnWrite,"ProxyOnWrite");function ProxyPropertyOnWrite(childName,childProperty){return addTransformToInstanceProperty((target,key,value)=>target[childName][childProperty??key]=value)}__name(ProxyPropertyOnWrite,"ProxyPropertyOnWrite");function ActionOnSet(opts){const{newValue:newValueFn,oldValue:oldValueFn,changeValue:changeValueFn}=opts;return addTransformToInstanceProperty((target,_,newValue,oldValue)=>(newValue!==oldValue&&(oldValue!==void 0&&(oldValueFn==null||oldValueFn.call(target,oldValue)),newValue!==void 0&&(newValueFn==null||newValueFn.call(target,newValue)),changeValueFn==null||changeValueFn.call(target,newValue,oldValue)),newValue))}__name(ActionOnSet,"ActionOnSet");function ObserveChanges(observerFn){return addObserverToInstanceProperty(observerFn)}__name(ObserveChanges,"ObserveChanges");function debouncedAnimationFrame(cb){return buildScheduler((innerCb,_delayMs)=>getWindow().requestAnimationFrame(innerCb),cb)}__name(debouncedAnimationFrame,"debouncedAnimationFrame");function debouncedCallback(cb){return buildScheduler((innerCb,delayMs=0)=>{delayMs===0?queueMicrotask(innerCb):setTimeout(innerCb,delayMs)},cb)}__name(debouncedCallback,"debouncedCallback");function buildScheduler(scheduleFn,cb){let scheduleCount=0,promiseRunning=!1,awaitingPromise,awaitingDone;const busy=__name(()=>promiseRunning,"busy"),done=__name(()=>{promiseRunning=!1,awaitingDone==null||awaitingDone(),awaitingDone=void 0,awaitingPromise=void 0,scheduleCount>0&&scheduleFn(scheduleCb)},"done"),scheduleCb=__name(()=>{const count=scheduleCount;scheduleCount=0,promiseRunning=!0;const maybePromise=cb({count});if(!maybePromise){done();return}maybePromise.then(done,done)},"scheduleCb");return{schedule(delayMs){scheduleCount===0&&!busy()&&scheduleFn(scheduleCb,delayMs),scheduleCount++},async await(){if(busy())for(awaitingPromise==null&&(awaitingPromise=new Promise(resolve=>{awaitingDone=resolve}));busy();)await awaitingPromise}}}__name(buildScheduler,"buildScheduler");function booleanParser(value){return value==="true"}__name(booleanParser,"booleanParser");function numberParser(value){return Number(value)}__name(numberParser,"numberParser");function stringParser(value){return value}__name(stringParser,"stringParser");var AttributeTypeParsers={role:stringParser,"aria-checked":booleanParser,"aria-controls":stringParser,"aria-describedby":stringParser,"aria-disabled":booleanParser,"aria-expanded":booleanParser,"aria-haspopup":booleanParser,"aria-hidden":booleanParser,"aria-label":stringParser,"aria-labelledby":stringParser,"aria-live":stringParser,"aria-orientation":stringParser,"aria-selected":booleanParser,"data-preventdefault":booleanParser,class:stringParser,id:stringParser,tabindex:numberParser,title:stringParser,placeholder:stringParser};function setAttribute(e,qualifiedName,value){value==null||value===""||value===""?e==null||e.removeAttribute(qualifiedName):e==null||e.setAttribute(qualifiedName,value.toString())}__name(setAttribute,"setAttribute");function setAttributes(e,attrs){if(attrs!=null)for(const[key,value]of entries(attrs))key!=="class"&&setAttribute(e,key,value)}__name(setAttributes,"setAttributes");function getAttribute(e,qualifiedName,defaultValue){var _a294;if(!(e instanceof HTMLElement))return;const value=e.getAttribute(qualifiedName);return value===null?defaultValue:((_a294=AttributeTypeParsers[qualifiedName])==null?void 0:_a294.call(AttributeTypeParsers,value))??void 0}__name(getAttribute,"getAttribute");function setElementStyle(e,property,value){e!=null&&(value==null?e.style.removeProperty(property):e.style.setProperty(property,value.toString()))}__name(setElementStyle,"setElementStyle");function setElementStyles(e,styles){for(const[key,value]of entries(styles))setElementStyle(e,key,value)}__name(setElementStyles,"setElementStyles");var WIDGET_HTML_EVENTS=["blur","change","contextmenu","focus","keydown","keyup","click","dblclick","mouseenter","mousemove","mouseleave","wheel","touchstart","touchmove","touchend","touchcancel"];function allocMouseEvent(type,sourceEvent,current){const{offsetX,offsetY,clientX,clientY}=sourceEvent,{currentX,currentY}=WidgetEventUtil.calcCurrentXY(current,sourceEvent);return{type,offsetX,offsetY,clientX,clientY,currentX,currentY,sourceEvent}}__name(allocMouseEvent,"allocMouseEvent");function allocTouchEvent(type,sourceEvent,_current){return{type,sourceEvent}}__name(allocTouchEvent,"allocTouchEvent");var WidgetAllocators={blur:__name(sourceEvent=>({type:"blur",sourceEvent}),"blur"),change:__name(sourceEvent=>({type:"change",sourceEvent}),"change"),contextmenu:__name((sourceEvent,current)=>allocMouseEvent("contextmenu",sourceEvent,current),"contextmenu"),focus:__name(sourceEvent=>({type:"focus",sourceEvent}),"focus"),keydown:__name(sourceEvent=>({type:"keydown",sourceEvent}),"keydown"),keyup:__name(sourceEvent=>({type:"keyup",sourceEvent}),"keyup"),click:__name((sourceEvent,current)=>allocMouseEvent("click",sourceEvent,current),"click"),dblclick:__name((sourceEvent,current)=>allocMouseEvent("dblclick",sourceEvent,current),"dblclick"),mouseenter:__name((sourceEvent,current)=>allocMouseEvent("mouseenter",sourceEvent,current),"mouseenter"),mousemove:__name((sourceEvent,current)=>allocMouseEvent("mousemove",sourceEvent,current),"mousemove"),mouseleave:__name((sourceEvent,current)=>allocMouseEvent("mouseleave",sourceEvent,current),"mouseleave"),wheel:__name(sourceEvent=>{const{offsetX,offsetY,clientX,clientY}=sourceEvent,factor=sourceEvent.deltaMode===0?.01:1,deltaX=sourceEvent.deltaX*factor,deltaY=sourceEvent.deltaY*factor;return{type:"wheel",offsetX,offsetY,clientX,clientY,deltaX,deltaY,sourceEvent}},"wheel"),touchstart:__name((sourceEvent,current)=>allocTouchEvent("touchstart",sourceEvent),"touchstart"),touchmove:__name((sourceEvent,current)=>allocTouchEvent("touchmove",sourceEvent),"touchmove"),touchend:__name((sourceEvent,current)=>allocTouchEvent("touchend",sourceEvent),"touchend"),touchcancel:__name((sourceEvent,current)=>allocTouchEvent("touchcancel",sourceEvent),"touchcancel")},_a30,WidgetEventUtil=(_a30=class{static alloc(type,sourceEvent,current){return WidgetAllocators[type](sourceEvent,current)}static isHTMLEvent(type){return WIDGET_HTML_EVENTS.includes(type)}static calcCurrentXY(current,event){const currentRect=current.getBoundingClientRect();return{currentX:event.clientX-currentRect.x,currentY:event.clientY-currentRect.y}}},__name(_a30,"WidgetEventUtil"),_a30),_a31,WidgetListenerHTML=(_a31=class{constructor(){this.widgetListeners={},this.sourceListeners={}}initSourceHandler(type,handler){this.sourceListeners??(this.sourceListeners={}),this.sourceListeners[type]=handler}lazyGetWidgetListeners(type,target){var _a294;if(!(type in(this.sourceListeners??{}))){const sourceHandler=__name(sourceEvent=>{var _a295;const widgetEvent=WidgetEventUtil.alloc(type,sourceEvent,target.getElement());for(const widgetListener of((_a295=this.widgetListeners)==null?void 0:_a295[type])??[])widgetListener(widgetEvent,target)},"sourceHandler"),opts={};type.startsWith("touch")&&(opts.passive=!1),this.initSourceHandler(type,sourceHandler),target.getElement().addEventListener(type,sourceHandler,opts)}return this.widgetListeners??(this.widgetListeners={}),(_a294=this.widgetListeners)[type]??(_a294[type]=[]),this.widgetListeners[type]}add(type,target,handler){this.lazyGetWidgetListeners(type,target).push(handler)}remove(type,target,handler){const listeners=this.lazyGetWidgetListeners(type,target),index=listeners.indexOf(handler);index>-1&&listeners.splice(index,1)}destroy(target){for(const[key,sourceHandler]of entries(this.sourceListeners??{}))target.getElement().removeEventListener(key,sourceHandler);this.widgetListeners=void 0,this.sourceListeners=void 0}},__name(_a31,"WidgetListenerHTML"),_a31),_a32,MouseDragger=(_a32=class{constructor(glob,self,myCallbacks,downEvent){this.glob=glob,this.self=self,this.window=getWindow(),this.mousegeneral=generalEvent=>{generalEvent.stopPropagation(),generalEvent.stopImmediatePropagation()},this.mousemove=moveEvent=>{var _a294;moveEvent.stopPropagation(),moveEvent.stopImmediatePropagation(),(_a294=this.glob.globalMouseDragCallbacks)==null||_a294.mousemove(moveEvent)},this.mouseup=upEvent=>{var _a294;upEvent.button===0&&(upEvent.stopPropagation(),upEvent.stopImmediatePropagation(),(_a294=this.glob.globalMouseDragCallbacks)==null||_a294.mouseup(upEvent),this.destroy())};const{window:window2,mousegeneral,mousemove,mouseup}=this;window2.addEventListener("mousedown",mousegeneral,{capture:!0}),window2.addEventListener("mouseenter",mousegeneral,{capture:!0}),window2.addEventListener("mouseleave",mousegeneral,{capture:!0}),window2.addEventListener("mouseout",mousegeneral,{capture:!0}),window2.addEventListener("mouseover",mousegeneral,{capture:!0}),window2.addEventListener("mousemove",mousemove,{capture:!0}),window2.addEventListener("mouseup",mouseup,{capture:!0}),self.mouseDragger=this,glob.globalMouseDragCallbacks=myCallbacks,glob.globalMouseDragCallbacks.mousedown(downEvent)}destroy(){const{window:window2,mousegeneral,mousemove,mouseup}=this;window2.removeEventListener("mousedown",mousegeneral,{capture:!0}),window2.removeEventListener("mouseenter",mousegeneral,{capture:!0}),window2.removeEventListener("mouseleave",mousegeneral,{capture:!0}),window2.removeEventListener("mouseout",mousegeneral,{capture:!0}),window2.removeEventListener("mouseover",mousegeneral,{capture:!0}),window2.removeEventListener("mousemove",mousemove,{capture:!0}),window2.removeEventListener("mouseup",mouseup,{capture:!0}),this.glob.globalMouseDragCallbacks=void 0,this.self.mouseDragger=void 0}},__name(_a32,"MouseDragger"),_a32);function startMouseDrag(glob,self,myCallbacks,downEvent){if(glob.globalMouseDragCallbacks==null)return new MouseDragger(glob,self,myCallbacks,downEvent)}__name(startMouseDrag,"startMouseDrag");var LONG_TAP_DURATION_MS=500,LONG_TAP_INTERRUPT_MIN_TOUCHMOVE_PXPX=100;function deltaClientSquared(a,b){const dx=a.clientX-b.clientX,dy=a.clientY-b.clientY;return dx*dx+dy*dy}__name(deltaClientSquared,"deltaClientSquared");var gIsInLongTap=!1,_a33,TouchDragger=(_a33=class{constructor(glob,self,myCallbacks,initialTouch,target){this.glob=glob,this.self=self,this.initialTouch=initialTouch,this.target=target,this.longTapInterrupted=!1,this.longtap=()=>{const{target:target2,initialTouch:initialTouch2}=this;if(!this.longTapInterrupted){target2.dispatchEvent(new TouchEvent("touchcancel",{touches:[initialTouch2],bubbles:!0})),gIsInLongTap=!0;const longTapMove=__name(e=>{e.preventDefault()},"longTapMove"),longTapEnd=__name(e=>{gIsInLongTap=!1,e.preventDefault(),target2.removeEventListener("touchmove",longTapMove),target2.removeEventListener("touchend",longTapEnd),target2.removeEventListener("touchcancel",longTapEnd)},"longTapEnd");target2.addEventListener("touchmove",longTapMove,{passive:!1}),target2.addEventListener("touchend",longTapEnd,{passive:!1}),target2.addEventListener("touchcancel",longTapEnd,{passive:!1});const{clientX,clientY}=initialTouch2,contextMenuEvent=new PointerEvent("contextmenu",{bubbles:!0,cancelable:!0,view:getWindow(),clientX,clientY,pointerType:"touch"});target2.dispatchEvent(contextMenuEvent)}},this.touchmove=moveEvent=>{var _a294;const{glob:glob2,self:self2,initialTouch:initialTouch2}=this,touch=this.findInitialFinger(moveEvent.targetTouches);touch!=null&&(this.longTapInterrupted=this.longTapInterrupted||deltaClientSquared(initialTouch2,touch)>LONG_TAP_INTERRUPT_MIN_TOUCHMOVE_PXPX,self2.dragTouchEnabled&&touch!=null&&((_a294=glob2.globalTouchDragCallbacks)==null||_a294.touchmove(moveEvent,touch)))},this.touchend=endEvent=>{var _a294;this.longTapInterrupted=!0;const touch=this.findInitialFinger(endEvent.changedTouches,endEvent.touches);touch!=null&&((_a294=this.glob.globalTouchDragCallbacks)==null||_a294.touchend(endEvent,touch)),this.destroy()},this.longtapTimer=setTimeout(this.longtap,LONG_TAP_DURATION_MS);const{touchmove,touchend}=this;target.addEventListener("touchmove",touchmove,{passive:!1}),target.addEventListener("touchstart",touchend,{passive:!1}),target.addEventListener("touchend",touchend,{passive:!1}),target.addEventListener("touchcancel",touchend,{passive:!1}),self.touchDragger=this,glob.globalTouchDragCallbacks=myCallbacks}destroy(){const{longtapTimer,touchmove,touchend}=this;clearTimeout(longtapTimer),this.target.removeEventListener("touchstart",touchend),this.target.removeEventListener("touchmove",touchmove),this.target.removeEventListener("touchend",touchend),this.target.removeEventListener("touchcancel",touchend),this.glob.globalTouchDragCallbacks=void 0,this.self.touchDragger=void 0}findInitialFinger(...touchLists){const touches=touchLists.map(touchList=>Array.from(touchList)).flat();return Array.from(touches).find(v=>v.identifier===this.initialTouch.identifier)}},__name(_a33,"TouchDragger"),_a33);function startOneFingerTouch(glob,self,myCallbacks,initialTouch,target){if(!(glob.globalTouchDragCallbacks!=null||gIsInLongTap))return new TouchDragger(glob,self,myCallbacks,initialTouch,target)}__name(startOneFingerTouch,"startOneFingerTouch");function makeMouseDrag(current,type,origin3,sourceEvent){const{currentX,currentY}=WidgetEventUtil.calcCurrentXY(current.getElement(),sourceEvent),originDeltaX=sourceEvent.pageX-origin3.pageX,originDeltaY=sourceEvent.pageY-origin3.pageY;return{type,device:"mouse",offsetX:origin3.offsetX+originDeltaX,offsetY:origin3.offsetY+originDeltaY,clientX:sourceEvent.clientX,clientY:sourceEvent.clientY,currentX,currentY,originDeltaX,originDeltaY,sourceEvent}}__name(makeMouseDrag,"makeMouseDrag");function getTouchOffsets(current,{pageX,pageY}){const{x,y}=current.getElement().getBoundingClientRect();return{offsetX:pageX-x,offsetY:pageY-y}}__name(getTouchOffsets,"getTouchOffsets");function makeTouchDrag(current,type,origin3,sourceEvent,touch){const{currentX,currentY}=WidgetEventUtil.calcCurrentXY(current.getElement(),touch),originDeltaX=touch.pageX-origin3.pageX,originDeltaY=touch.pageY-origin3.pageY;return{type,device:"touch",offsetX:origin3.offsetX+originDeltaX,offsetY:origin3.offsetY+originDeltaY,clientX:touch.clientX,clientY:touch.clientY,currentX,currentY,originDeltaX,originDeltaY,sourceEvent}}__name(makeTouchDrag,"makeTouchDrag");var GlobalCallbacks={},_a34,WidgetListenerInternal=(_a34=class{constructor(dispatchCallback){this.dispatchCallback=dispatchCallback,this.dragTouchEnabled=!0}destroy(){var _a294,_b,_c;(_a294=this.dragTriggerRemover)==null||_a294.call(this),this.dragTriggerRemover=void 0,this.dragStartListeners=void 0,this.dragMoveListeners=void 0,this.dragEndListeners=void 0,(_b=this.mouseDragger)==null||_b.destroy(),(_c=this.touchDragger)==null||_c.destroy()}add(type,target,handler){switch(type){case"drag-start":{this.dragStartListeners??(this.dragStartListeners=[]),this.dragStartListeners.push(handler),this.registerDragTrigger(target);break}case"drag-move":{this.dragMoveListeners??(this.dragMoveListeners=[]),this.dragMoveListeners.push(handler),this.registerDragTrigger(target);break}case"drag-end":{this.dragEndListeners??(this.dragEndListeners=[]),this.dragEndListeners.push(handler),this.registerDragTrigger(target);break}}}remove(type,_target,handler){switch(type){case"drag-start":return this.removeHandler(this.dragStartListeners,handler);case"drag-move":return this.removeHandler(this.dragMoveListeners,handler);case"drag-end":return this.removeHandler(this.dragEndListeners,handler)}}removeHandler(array3,handler){const index=array3==null?void 0:array3.indexOf(handler);index!==void 0&&(array3==null||array3.splice(index,1))}registerDragTrigger(target){if(this.dragTriggerRemover==null){const mouseTrigger=__name(event=>this.triggerMouseDrag(target,event),"mouseTrigger"),touchTrigger=__name(event=>this.triggerTouchDrag(target,event),"touchTrigger");target.getElement().addEventListener("mousedown",mouseTrigger),target.getElement().addEventListener("touchstart",touchTrigger,{passive:!1}),this.dragTriggerRemover=()=>{target.getElement().removeEventListener("mousedown",mouseTrigger),target.getElement().removeEventListener("touchstart",touchTrigger)}}}triggerMouseDrag(current,downEvent){downEvent.button===0&&this.startMouseDrag(current,downEvent)}startMouseDrag(current,initialDownEvent){const origin3={pageX:NaN,pageY:NaN,offsetX:NaN,offsetY:NaN};partialAssign(["pageX","pageY","offsetX","offsetY"],origin3,initialDownEvent);const dragCallbacks={mousedown:__name(downEvent=>{const dragStartEvent=makeMouseDrag(current,"drag-start",origin3,downEvent);this.dispatch("drag-start",current,dragStartEvent)},"mousedown"),mousemove:__name(moveEvent=>{const dragMoveEvent=makeMouseDrag(current,"drag-move",origin3,moveEvent);this.dispatch("drag-move",current,dragMoveEvent)},"mousemove"),mouseup:__name(upEvent=>{const dragEndEvent=makeMouseDrag(current,"drag-end",origin3,upEvent);this.dispatch("drag-end",current,dragEndEvent),this.endDrag(current,dragEndEvent)},"mouseup")};this.mouseDragger=startMouseDrag(GlobalCallbacks,this,dragCallbacks,initialDownEvent)}endDrag(target,{sourceEvent,clientX,clientY}){var _a294;const elem=target.getElement(),rect=elem.getBoundingClientRect();BBoxValues.containsPoint(rect,clientX,clientY)||(elem.dispatchEvent(new MouseEvent("mouseleave",sourceEvent)),(_a294=sourceEvent.target)==null||_a294.dispatchEvent(new MouseEvent("mouseenter",sourceEvent)))}triggerTouchDrag(current,startEvent){const touch=startEvent.targetTouches[0];startEvent.targetTouches.length===1&&touch!=null&&this.startOneFingerTouch(current,startEvent,touch)}startOneFingerTouch(current,initialEvent,initialTouch){const origin3={pageX:NaN,pageY:NaN,...getTouchOffsets(current,initialTouch)};partialAssign(["pageX","pageY"],origin3,initialTouch);const dragCallbacks={touchmove:__name((moveEvent,touch)=>{const dragMoveEvent=makeTouchDrag(current,"drag-move",origin3,moveEvent,touch);this.dispatch("drag-move",current,dragMoveEvent)},"touchmove"),touchend:__name((cancelEvent,touch)=>{const dragMoveEvent=makeTouchDrag(current,"drag-end",origin3,cancelEvent,touch);this.dispatch("drag-end",current,dragMoveEvent)},"touchend")},target=current.getElement();this.touchDragger=startOneFingerTouch(GlobalCallbacks,this,dragCallbacks,initialTouch,target);const dragStartEvent=makeTouchDrag(current,"drag-start",origin3,initialEvent,initialTouch);this.dispatch("drag-start",current,dragStartEvent)}dispatch(type,current,event){var _a294,_b,_c;switch(type){case"drag-start":(_a294=this.dragStartListeners)==null||_a294.forEach(handler=>handler(event,current));break;case"drag-move":(_b=this.dragMoveListeners)==null||_b.forEach(handler=>handler(event,current));break;case"drag-end":(_c=this.dragEndListeners)==null||_c.forEach(handler=>handler(event,current));break}this.dispatchCallback(type,event)}},__name(_a34,"WidgetListenerInternal"),_a34),_a35,WidgetBounds=(_a35=class{constructor(elem){this.elem=elem}setBounds(bounds){setElementBBox(this.elemContainer??this.elem,bounds)}getBounds(){return getElementBBox(this.elemContainer??this.elem)}static setElementContainer(widget,elemContainer){const currentBounds=widget.getBounds();setElementBBox(elemContainer,currentBounds),setElementStyles(widget.elem,{width:"100%",height:"100%"}),widget.elem.remove(),widget.elemContainer=elemContainer,widget.elemContainer.replaceChildren(widget.elem)}},__name(_a35,"WidgetBounds"),_a35),_a36,Widget=(_a36=class extends WidgetBounds{constructor(elem){super(elem),this.elem=elem,this.index=NaN,this.children=[]}getElement(){return this.elem}getBoundingClientRect(){return this.elem.getBoundingClientRect()}get clientWidth(){return this.elem.clientWidth}get clientHeight(){return this.elem.clientHeight}destroy(){var _a294,_b,_c,_d;(_a294=this.parent)==null||_a294.removeChild(this),this.children.forEach(child=>{child.parent=void 0,child.destroy()}),this.children.length=0,this.destructor(),this.elem.remove(),(_b=this.elemContainer)==null||_b.remove(),(_c=this.internalListener)==null||_c.destroy(),(_d=this.htmlListener)==null||_d.destroy(this)}setHidden(hidden){setElementStyle(this.elem,"display",hidden?"none":void 0)}isHidden(){var _a294,_b;return((_b=(_a294=getWindow())==null?void 0:_a294.getComputedStyle)==null?void 0:_b.call(_a294,this.elem).display)==="none"}setCursor(cursor){setElementStyle(this.elem,"cursor",cursor)}setTextContent(textContent){this.elem.textContent=textContent??null}setAriaDescribedBy(ariaDescribedBy){setAttribute(this.elem,"aria-describedby",ariaDescribedBy)}setAriaHidden(ariaHidden){setAttribute(this.elem,"aria-hidden",ariaHidden)}setAriaLabel(ariaLabel){setAttribute(this.elem,"aria-label",ariaLabel)}setInnerHTML(html){this.elem.innerHTML=html}isDisabled(){return getAttribute(this.elem,"aria-disabled",!1)}parseFloat(s){return s===""?0:parseFloat(s)}cssLeft(){return this.parseFloat(this.elem.style.left)}cssTop(){return this.parseFloat(this.elem.style.top)}cssWidth(){return this.parseFloat(this.elem.style.width)}cssHeight(){return this.parseFloat(this.elem.style.height)}focus(){this.elem.focus()}setPreventsDefault(preventDefault){setAttribute(this.elem,"data-preventdefault",preventDefault)}setTabIndex(tabIndex){setAttribute(this.elem,"tabindex",tabIndex)}addChild(child){this.addChildToDOM(child,this.getBefore(child)),this.children.push(child),child.index=this.children.length-1,child.parent=this,this.onChildAdded(child)}removeChild(child){const i=this.children.findIndex(value=>value===child);this.children.splice(i,1),this.removeChildFromDOM(child),this.onChildRemoved(child)}moveChild(child,domIndex){child.domIndex!==domIndex&&(child.domIndex=domIndex,this.removeChildFromDOM(child),this.addChildToDOM(child,this.getBefore(child)))}addClass(...tokens){this.elem.classList.add(...tokens)}removeClass(...tokens){this.elem.classList.remove(...tokens)}toggleClass(token,force){this.elem.classList.toggle(token,force)}appendOrInsert(child,before){before?before.getElement().insertAdjacentElement("beforebegin",child):this.elem.appendChild(child)}addChildToDOM(child,before){this.appendOrInsert(child.getElement(),before)}removeChildFromDOM(child){this.elem.removeChild(child.getElement())}onChildAdded(_child){}onChildRemoved(_child){}getBefore({domIndex}){if(domIndex!==void 0)return this.children.filter(child=>child.domIndex!==void 0&&child.domIndex>domIndex).reduce((prev,curr)=>!prev||curr.domIndex<prev.domIndex?curr:prev,void 0)}addListener(type,listener){return WidgetEventUtil.isHTMLEvent(type)?(this.htmlListener??(this.htmlListener=new WidgetListenerHTML),this.htmlListener.add(type,this,listener)):(this.internalListener??(this.internalListener=new WidgetListenerInternal(this.onDispatch.bind(this))),this.internalListener.add(type,this,listener)),()=>this.removeListener(type,listener)}removeListener(type,listener){var _a294,_b;WidgetEventUtil.isHTMLEvent(type)?(_a294=this.htmlListener)==null||_a294.remove(type,this,listener):this.htmlListener!=null&&((_b=this.internalListener)==null||_b.remove(type,this,listener))}setDragTouchEnabled(dragTouchEnabled){this.internalListener??(this.internalListener=new WidgetListenerInternal(this.onDispatch.bind(this))),this.internalListener.dragTouchEnabled=dragTouchEnabled}onDispatch(type,event){if(!event.sourceEvent.bubbles)return;let{parent}=this;for(;parent!=null;){const{internalListener}=parent;if(internalListener!=null){const parentEvent={...event,...WidgetEventUtil.calcCurrentXY(parent.getElement(),event)};internalListener.dispatch(type,parent,parentEvent)}parent=parent.parent}}static addWindowEvent(_type,listener){const pagehideHandler=__name(event=>{event.persisted||listener()},"pagehideHandler");return getWindow().addEventListener("pagehide",pagehideHandler),()=>getWindow().removeEventListener("pagehide",pagehideHandler)}},__name(_a36,"Widget"),_a36);function createCanvasContext(width2=0,height2=0){return new OffscreenCanvas(width2,height2).getContext("2d")}__name(createCanvasContext,"createCanvasContext");var _a37,LRUCache=(_a37=class{constructor(maxCacheSize=5){this.maxCacheSize=maxCacheSize,this.store=new Map}get(key){if(!this.store.has(key))return;const hit=this.store.get(key);return this.store.delete(key),this.store.set(key,hit),hit}has(key){return this.store.has(key)}set(key,value){if(this.store.set(key,value),this.store.size>this.maxCacheSize){const iterator=this.store.keys();let evictCount=this.store.size-this.maxCacheSize;for(;evictCount>0;){const evictKeyIterator=iterator.next();evictKeyIterator.done||this.store.delete(evictKeyIterator.value),evictCount--}}return value}clear(){this.store.clear()}},__name(_a37,"LRUCache"),_a37),_a38,CachedTextMeasurerPool=(_a38=class{static measureText(text2,options){return this.getMeasurer(options).measureText(text2)}static measureLines(text2,options){return this.getMeasurer(options).measureLines(text2)}static getMeasurer(options){const font2=typeof options.font=="string"?options.font:TextUtils.toFontString(options.font),key=`${font2}-${options.textAlign??"start"}-${options.textBaseline??"alphabetic"}`;return this.instanceMap.get(key)??this.createFontMeasurer(font2,options,key)}static createFontMeasurer(font2,options,key){const ctx=createCanvasContext();ctx.font=font2,ctx.textAlign=options.textAlign??"start",ctx.textBaseline=options.textBaseline??"alphabetic";const measurer2=new CachedTextMeasurer(ctx,options);return this.instanceMap.set(key,measurer2),measurer2}},__name(_a38,"CachedTextMeasurerPool"),_a38);CachedTextMeasurerPool.instanceMap=new LRUCache(10);var _a39,CachedTextMeasurer=(_a39=class{constructor(ctx,options){this.ctx=ctx,this.measureMap=new LRUCache(100),options.textAlign&&(ctx.textAlign=options.textAlign),options.textBaseline&&(ctx.textBaseline=options.textBaseline),ctx.font=typeof options.font=="string"?options.font:TextUtils.toFontString(options.font),this.textMeasurer=new SimpleTextMeasurer(t=>this.cachedCtxMeasureText(t),options.textBaseline??"alphabetic")}textWidth(text2,estimate){return this.textMeasurer.textWidth(text2,estimate)}measureText(text2){return this.textMeasurer.measureText(text2)}measureLines(text2){return this.textMeasurer.measureLines(text2)}cachedCtxMeasureText(text2){if(!this.measureMap.has(text2)){const rawResult=this.ctx.measureText(text2);this.measureMap.set(text2,{actualBoundingBoxAscent:rawResult.actualBoundingBoxAscent,emHeightAscent:rawResult.emHeightAscent,emHeightDescent:rawResult.emHeightDescent,actualBoundingBoxDescent:rawResult.actualBoundingBoxDescent,actualBoundingBoxLeft:rawResult.actualBoundingBoxLeft,actualBoundingBoxRight:rawResult.actualBoundingBoxRight,alphabeticBaseline:rawResult.alphabeticBaseline,fontBoundingBoxAscent:rawResult.fontBoundingBoxAscent,fontBoundingBoxDescent:rawResult.fontBoundingBoxDescent,hangingBaseline:rawResult.hangingBaseline,ideographicBaseline:rawResult.ideographicBaseline,width:rawResult.width})}return this.measureMap.get(text2)}},__name(_a39,"CachedTextMeasurer"),_a39),_a40,TextUtils=(_a40=class{static toFontString({fontSize=10,fontStyle,fontWeight,fontFamily,lineHeight}){let fontString="";return fontStyle&&(fontString+=`${fontStyle} `),fontWeight&&(fontString+=`${fontWeight} `),fontString+=`${fontSize}px`,lineHeight&&(fontString+=`/${lineHeight}px`),fontString+=` ${fontFamily}`,fontString.trim()}static getLineHeight(fontSize){return Math.ceil(fontSize*this.defaultLineHeight)}static getVerticalModifier(textBaseline){switch(textBaseline){case"hanging":case"top":return 0;case"middle":return .5;case"alphabetic":case"bottom":case"ideographic":default:return 1}}},__name(_a40,"TextUtils"),_a40);TextUtils.EllipsisChar="";TextUtils.defaultLineHeight=1.15;TextUtils.lineSplitter=/\r?\n/g;var _a41,SimpleTextMeasurer=(_a41=class{constructor(measureTextFn,textBaseline="alphabetic"){this.measureTextFn=measureTextFn,this.textBaseline=textBaseline,this.charMap=new Map}getMetrics(text2){const m=this.measureTextFn(text2);return m.fontBoundingBoxAscent??(m.fontBoundingBoxAscent=m.emHeightAscent),m.fontBoundingBoxDescent??(m.fontBoundingBoxDescent=m.emHeightDescent),{width:m.width,height:m.actualBoundingBoxAscent+m.actualBoundingBoxDescent,lineHeight:m.fontBoundingBoxAscent+m.fontBoundingBoxDescent,offsetTop:m.actualBoundingBoxAscent,offsetLeft:m.actualBoundingBoxLeft}}getMultilineMetrics(lines){let width2=0,height2=0,offsetTop=0,offsetLeft=0,baselineDistance=0;const verticalModifier=TextUtils.getVerticalModifier(this.textBaseline),lineMetrics=[];let index=0;const length2=lines.length;for(const line of lines){const m=this.measureTextFn(line);m.fontBoundingBoxAscent??(m.fontBoundingBoxAscent=m.emHeightAscent),m.fontBoundingBoxDescent??(m.fontBoundingBoxDescent=m.emHeightDescent),width2<m.width&&(width2=m.width),offsetLeft<m.actualBoundingBoxLeft&&(offsetLeft=m.actualBoundingBoxLeft),index===0?(height2+=m.actualBoundingBoxAscent,offsetTop+=m.actualBoundingBoxAscent):baselineDistance+=m.fontBoundingBoxAscent,index===length2-1?height2+=m.actualBoundingBoxDescent:baselineDistance+=m.fontBoundingBoxDescent,lineMetrics.push({text:line,width:m.width,height:m.actualBoundingBoxAscent+m.actualBoundingBoxDescent,lineHeight:m.fontBoundingBoxAscent+m.fontBoundingBoxDescent,offsetTop:m.actualBoundingBoxAscent,offsetLeft:m.actualBoundingBoxLeft}),index++}return height2+=baselineDistance,offsetTop+=baselineDistance*verticalModifier,{width:width2,height:height2,offsetTop,offsetLeft,lineMetrics}}textWidth(text2,estimate){if(estimate){let estimatedWidth=0;for(let i=0;i<text2.length;i++)estimatedWidth+=this.textWidth(text2.charAt(i));return estimatedWidth}return text2.length>1?this.measureTextFn(text2).width:this.charMap.get(text2)??this.charWidth(text2)}measureText(text2){return this.getMetrics(text2)}measureLines(text2){const lines=typeof text2=="string"?text2.split(TextUtils.lineSplitter):text2;return this.getMultilineMetrics(lines)}charWidth(char){const{width:width2}=this.measureTextFn(char);return this.charMap.set(char,width2),width2}},__name(_a41,"SimpleTextMeasurer"),_a41),_a42,_Text=(_a42=class extends Shape{constructor(){super(...arguments),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontSize=10,this.fontFamily="sans-serif",this.textAlign=_a42.defaultStyles.textAlign,this.textBaseline=_a42.defaultStyles.textBaseline}onTextChange(){var _a294;this.lines=((_a294=this.text)==null?void 0:_a294.split(`
`).map(s=>s.trim()))??[]}static computeBBox(lines,x,y,opts){const{offsetTop,offsetLeft,width:width2,height:height2}=CachedTextMeasurerPool.measureLines(lines,opts);return new BBox(x-offsetLeft,y-offsetTop,width2,height2)}computeBBox(){const{x,y,lines,textBaseline,textAlign}=this;return _a42.computeBBox(lines,x,y,{font:this,textBaseline,textAlign})}isPointInPath(x,y){const bbox=this.getBBox();return bbox?bbox.containsPoint(x,y):!1}render(renderCtx){const{ctx,stats}=renderCtx;if(!this.lines.length||!this.layerManager)return stats&&(stats.nodesSkipped+=1),super.render(renderCtx);const{fill,stroke:stroke2,strokeWidth}=this,{pixelRatio}=this.layerManager.canvas;if(!fill&&!(stroke2!=null&&strokeWidth>0))return super.render(renderCtx);const font2=TextUtils.toFontString(this);if(ctx.font!==font2&&(ctx.font=font2),ctx.textAlign=this.textAlign,ctx.textBaseline=this.textBaseline,fill){this.applyFill(ctx),ctx.globalAlpha*=this.opacity*this.fillOpacity;const{fillShadow}=this;fillShadow!=null&&fillShadow.enabled&&(ctx.shadowColor=fillShadow.color,ctx.shadowOffsetX=fillShadow.xOffset*pixelRatio,ctx.shadowOffsetY=fillShadow.yOffset*pixelRatio,ctx.shadowBlur=fillShadow.blur*pixelRatio),this.renderLines((line,x,y)=>ctx.fillText(line,x,y))}if(stroke2&&strokeWidth){this.applyStroke(ctx),ctx.lineWidth=strokeWidth,ctx.globalAlpha*=this.opacity*this.strokeOpacity;const{lineDash,lineDashOffset,lineCap,lineJoin}=this;lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),this.renderLines((line,x,y)=>ctx.strokeText(line,x,y))}super.render(renderCtx)}renderLines(renderCallback){const{lines,x,y}=this,lineHeight=this.lineHeight??TextUtils.getLineHeight(this.fontSize);let offsetY=(lineHeight-lineHeight*lines.length)*TextUtils.getVerticalModifier(this.textBaseline);for(const line of lines)renderCallback(line,x,y+offsetY),offsetY+=lineHeight}setFont(props){this.fontFamily=props.fontFamily,this.fontSize=props.fontSize,this.fontStyle=props.fontStyle,this.fontWeight=props.fontWeight}setAlign(props){this.textAlign=props.textAlign,this.textBaseline=props.textBaseline}toSVG(){var _a294;if(!this.visible||!this.text)return;const element2=createSvgElement("text");return this.applySvgFillAttributes(element2),element2.setAttribute("font-family",((_a294=this.fontFamily)==null?void 0:_a294.split(",")[0])??""),element2.setAttribute("font-size",String(this.fontSize)),element2.setAttribute("font-style",this.fontStyle??""),element2.setAttribute("font-weight",String(this.fontWeight??"")),element2.setAttribute("text-anchor",{center:"middle",left:"start",right:"end",start:"start",end:"end"}[this.textAlign??"start"]),element2.setAttribute("alignment-baseline",{alphabetic:"alphabetic",top:"top",bottom:"bottom",hanging:"hanging",middle:"middle",ideographic:"ideographic"}[this.textBaseline??"alphabetic"]),element2.setAttribute("x",String(this.x)),element2.setAttribute("y",String(this.y)),element2.textContent=this.text??"",{elements:[element2]}}},__name(_a42,"_Text"),_a42);_Text.className="Text";_Text.defaultStyles={...Shape.defaultStyles,textAlign:"start",fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:"sans-serif",textBaseline:"alphabetic"};__decorateClass([SceneChangeDetection()],_Text.prototype,"x",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"y",2);__decorateClass([SceneChangeDetection({changeCb:__name(o=>o.onTextChange(),"changeCb")})],_Text.prototype,"text",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontStyle",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontWeight",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontSize",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"fontFamily",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"textAlign",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"textBaseline",2);__decorateClass([SceneChangeDetection()],_Text.prototype,"lineHeight",2);var Text=_Text,_a43,RotatableText=(_a43=class extends Rotatable(Text){},__name(_a43,"RotatableText"),_a43),_a44,TransformableText=(_a44=class extends Rotatable(Translatable(Text)){},__name(_a44,"TransformableText"),_a44),_a45,TextWrapper=(_a45=class{static wrapText(text2,options){return this.wrapLines(text2,options).join(`
`)}static wrapLines(text2,options){const clippedResult=this.textWrap(text2,options);return options.overflow==="hide"&&clippedResult.some(l=>l.endsWith(TextUtils.EllipsisChar))?[]:clippedResult}static appendEllipsis(text2){return text2.replace(/[.,]{1,5}$/,"")+TextUtils.EllipsisChar}static truncateLine(text2,measurer2,maxWidth,ellipsisForce){const ellipsisWidth=measurer2.textWidth(TextUtils.EllipsisChar);let estimatedWidth=0,i=0;for(;i<text2.length;i++){const charWidth=measurer2.textWidth(text2.charAt(i));if(estimatedWidth+charWidth>maxWidth)break;estimatedWidth+=charWidth}if(text2.length===i&&(!ellipsisForce||estimatedWidth+ellipsisWidth<=maxWidth))return ellipsisForce?text2+TextUtils.EllipsisChar:text2;for(text2=text2.slice(0,i).trimEnd();text2.length&&measurer2.textWidth(text2)+ellipsisWidth>maxWidth;)text2=text2.slice(0,-1).trimEnd();return text2+TextUtils.EllipsisChar}static textWrap(text2,options){const lines=text2.split(TextUtils.lineSplitter),measurer2=CachedTextMeasurerPool.getMeasurer(options);if(options.textWrap==="never")return lines.map(line=>this.truncateLine(line.trimEnd(),measurer2,options.maxWidth));const result=[],wrapHyphenate=options.textWrap==="hyphenate",wrapOnSpace=options.textWrap==null||options.textWrap==="on-space";for(const untrimmedLine of lines){let line=untrimmedLine.trimEnd();if(line===""){result.push(line);continue}let i=0,estimatedWidth=0,lastSpaceIndex=0;for(;i<line.length;){const char=line.charAt(i);if(estimatedWidth+=measurer2.textWidth(char),char===" "&&(lastSpaceIndex=i),estimatedWidth>options.maxWidth){if(i===0)break;const actualWidth=measurer2.textWidth(line.slice(0,i+1));if(actualWidth<=options.maxWidth){estimatedWidth=actualWidth,i++;continue}if(lastSpaceIndex){const nextWord=this.getWordAt(line,lastSpaceIndex+1),textWidth=measurer2.textWidth(nextWord);if(textWidth<=options.maxWidth){result.push(line.slice(0,lastSpaceIndex).trimEnd()),line=line.slice(lastSpaceIndex).trimStart(),i=0,estimatedWidth=0,lastSpaceIndex=0;continue}else wrapOnSpace&&textWidth>options.maxWidth&&result.push(line.slice(0,lastSpaceIndex).trimEnd(),this.truncateLine(line.slice(lastSpaceIndex).trimStart(),measurer2,options.maxWidth,!0))}else wrapOnSpace&&result.push(this.truncateLine(line,measurer2,options.maxWidth,!0));if(wrapOnSpace){line="";break}const postfix=wrapHyphenate?"-":"";let newLine=line.slice(0,i).trim();for(;newLine.length&&measurer2.textWidth(newLine+postfix)>options.maxWidth;)newLine=newLine.slice(0,-1).trimEnd();if(result.push(newLine+postfix),!newLine.length){line="";break}line=line.slice(newLine.length).trimStart(),i=-1,estimatedWidth=0,lastSpaceIndex=0}i++}line&&result.push(line)}return this.avoidOrphans(result,measurer2,options),this.clipLines(result,measurer2,options)}static getWordAt(text2,position){const nextSpaceIndex=text2.indexOf(" ",position);return nextSpaceIndex===-1?text2.slice(position):text2.slice(position,nextSpaceIndex)}static clipLines(lines,measurer2,options){if(!options.maxHeight)return lines;const{height:height2,lineMetrics}=measurer2.measureLines(lines);if(height2<=options.maxHeight)return lines;for(let i=0,cumulativeHeight=0;i<lineMetrics.length;i++){const{lineHeight}=lineMetrics[i];if(cumulativeHeight+=lineHeight,cumulativeHeight>options.maxHeight){if(options.overflow==="hide")return[];const clippedResults=lines.slice(0,i||1),lastLine=clippedResults.pop();return clippedResults.concat(this.truncateLine(lastLine,measurer2,options.maxWidth,!0))}}return lines}static avoidOrphans(lines,measurer2,options){if(options.avoidOrphans===!1||lines.length<2)return;const{length:length2}=lines,lastLine=lines[length2-1],beforeLast=lines[length2-2];if(beforeLast.length<lastLine.length)return;const lastSpaceIndex=beforeLast.lastIndexOf(" ");if(lastSpaceIndex===-1||lastSpaceIndex===beforeLast.indexOf(" ")||lastLine.includes(" "))return;const lastWord=beforeLast.slice(lastSpaceIndex+1);measurer2.textWidth(lastLine+lastWord)<=options.maxWidth&&(lines[length2-2]=beforeLast.slice(0,lastSpaceIndex),lines[length2-1]=lastWord+" "+lastLine)}},__name(_a45,"TextWrapper"),_a45),_a46,Caption=(_a46=class extends BaseProperties{constructor(){super(...arguments),this.id=createId(this),this.node=new RotatableText({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(moduleCtx,where){return moduleCtx.layoutManager.addListener("layout:complete",()=>this.updateA11yText(moduleCtx,where))}computeTextWrap(containerWidth,containerHeight){const{text:text2,padding,wrapping}=this,maxWidth=Math.min(this.maxWidth??1/0,containerWidth)-padding*2,maxHeight=this.maxHeight??containerHeight-padding*2;if(!isFinite(maxWidth)&&!isFinite(maxHeight)){this.node.text=text2;return}const wrappedText=TextWrapper.wrapText(text2??"",{maxWidth,maxHeight,font:this,textWrap:wrapping});this.node.text=wrappedText,this.truncated=wrappedText.includes(TextUtils.EllipsisChar)}updateA11yText(moduleCtx,where){var _a294;const{proxyInteractionService}=moduleCtx;if(this.enabled&&this.text){const bbox=Transformable.toCanvas(this.node);if(bbox){const{id:domManagerId}=this;this.proxyText??(this.proxyText=proxyInteractionService.createProxyElement({type:"text",domManagerId,where})),this.proxyText.textContent=this.text,this.proxyText.setBounds(bbox),this.proxyText.addListener("mousemove",ev=>this.handleMouseMove(moduleCtx,ev)),this.proxyText.addListener("mouseleave",ev=>this.handleMouseLeave(moduleCtx,ev))}}else(_a294=this.proxyText)==null||_a294.destroy(),this.proxyText=void 0}handleMouseMove(moduleCtx,event){if(event!=null&&this.enabled&&this.node.visible&&this.truncated){const{x,y}=Transformable.toCanvas(this.node),canvasX=event.sourceEvent.offsetX+x,canvasY=event.sourceEvent.offsetY+y;moduleCtx.tooltipManager.updateTooltip(this.id,{canvasX,canvasY,showArrow:!1},[{type:"structured",title:this.text}])}}handleMouseLeave(moduleCtx,_event){moduleCtx.tooltipManager.removeTooltip(this.id)}},__name(_a46,"Caption"),_a46);Caption.SMALL_PADDING=10;__decorateClass([TempValidate(),ProxyPropertyOnWrite("node","visible")],Caption.prototype,"enabled",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node")],Caption.prototype,"text",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node")],Caption.prototype,"textAlign",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node")],Caption.prototype,"fontStyle",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node")],Caption.prototype,"fontWeight",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node")],Caption.prototype,"fontSize",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node")],Caption.prototype,"fontFamily",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node","fill")],Caption.prototype,"color",2);__decorateClass([TempValidate()],Caption.prototype,"spacing",2);__decorateClass([TempValidate()],Caption.prototype,"maxWidth",2);__decorateClass([TempValidate()],Caption.prototype,"maxHeight",2);__decorateClass([TempValidate()],Caption.prototype,"wrapping",2);__decorateClass([TempValidate()],Caption.prototype,"padding",2);__decorateClass([TempValidate()],Caption.prototype,"layoutStyle",2);var ChartAxisDirection=(ChartAxisDirection2=>(ChartAxisDirection2.X="x",ChartAxisDirection2.Y="y",ChartAxisDirection2))(ChartAxisDirection||{}),LayoutElement=(LayoutElement2=>(LayoutElement2[LayoutElement2.Caption=0]="Caption",LayoutElement2[LayoutElement2.Legend=1]="Legend",LayoutElement2[LayoutElement2.ToolbarLeft=2]="ToolbarLeft",LayoutElement2[LayoutElement2.ToolbarBottom=3]="ToolbarBottom",LayoutElement2[LayoutElement2.Navigator=4]="Navigator",LayoutElement2[LayoutElement2.Overlay=5]="Overlay",LayoutElement2))(LayoutElement||{}),_a47,LayoutManager=(_a47=class{constructor(){this.events=new EventEmitter,this.elements=new Map}addListener(eventName,listener){return this.events.on(eventName,listener)}registerElement(element2,listener){return this.elements.has(element2)?this.elements.get(element2).add(listener):this.elements.set(element2,new Set([listener])),()=>{var _a294;return(_a294=this.elements.get(element2))==null?void 0:_a294.delete(listener)}}createContext(width2,height2){var _a294;const context=new LayoutContext(width2,height2);for(const element2 of Object.values(LayoutElement))typeof element2=="number"&&((_a294=this.elements.get(element2))==null||_a294.forEach(listener=>listener(context)));return context}emitLayoutComplete(context,options){const eventType="layout:complete",{width:width2,height:height2}=context;this.events.emit(eventType,{type:eventType,axes:options.axes??[],chart:{width:width2,height:height2},clipSeries:options.clipSeries??!1,series:options.series})}},__name(_a47,"LayoutManager"),_a47),_a48,LayoutContext=(_a48=class{constructor(width2,height2){this.width=width2,this.height=height2,this.layoutBox=new BBox(0,0,width2,height2)}},__name(_a48,"LayoutContext"),_a48),_a49,ChartCaptions=(_a49=class{constructor(){this.title=new Caption,this.subtitle=new Caption,this.footnote=new Caption}positionCaptions(ctx){const{title,subtitle,footnote}=this,maxHeight=ctx.layoutBox.height/10;if(title.enabled){const{spacing}=title;this.positionCaption("top",title,ctx.layoutBox,maxHeight),this.shrinkLayoutByCaption("top",title,ctx.layoutBox,spacing)}subtitle.enabled&&(this.positionCaption("top",subtitle,ctx.layoutBox,maxHeight),this.shrinkLayoutByCaption("top",subtitle,ctx.layoutBox,subtitle.spacing)),footnote.enabled&&(this.positionCaption("bottom",footnote,ctx.layoutBox,maxHeight),this.shrinkLayoutByCaption("bottom",footnote,ctx.layoutBox,footnote.spacing))}positionAbsoluteCaptions(ctx){const{title,subtitle,footnote}=this,{rect}=ctx.series;for(const caption of[title,subtitle,footnote])if(caption.layoutStyle==="overlay"){if(caption.textAlign==="left")caption.node.x=rect.x+caption.padding;else if(caption.textAlign==="right"){const bbox=caption.node.getBBox();caption.node.x=rect.x+rect.width-bbox.width-caption.padding}}}computeX(align2,layoutBox){return align2==="left"?layoutBox.x:align2==="right"?layoutBox.x+layoutBox.width:layoutBox.x+layoutBox.width/2}positionCaption(vAlign,caption,layoutBox,maxHeight){const containerHeight=Math.max(TextUtils.getLineHeight(caption.fontSize),maxHeight);caption.node.x=this.computeX(caption.textAlign,layoutBox)+caption.padding,caption.node.y=layoutBox.y+(vAlign==="top"?0:layoutBox.height)+caption.padding,caption.node.textBaseline=vAlign,caption.computeTextWrap(layoutBox.width,containerHeight)}shrinkLayoutByCaption(vAlign,caption,layoutBox,spacing=0){if(caption.layoutStyle==="block"){const bbox=caption.node.getBBox();layoutBox.shrink(Math.ceil(vAlign==="top"?bbox.y-layoutBox.y+bbox.height+spacing:layoutBox.y+layoutBox.height-bbox.y+spacing),vAlign)}}},__name(_a49,"ChartCaptions"),_a49);__decorateClass([TempValidate()],ChartCaptions.prototype,"title",2);__decorateClass([TempValidate()],ChartCaptions.prototype,"subtitle",2);__decorateClass([TempValidate()],ChartCaptions.prototype,"footnote",2);var chartTypes=["candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"],_a50,ChartTypeOriginator=(_a50=class{constructor(chartService){this.chartService=chartService,this.mementoOriginatorKey="chartType"}createMemento(){var _a294,_b;let chartType=(_b=(_a294=this.chartService.publicApi)==null?void 0:_a294.getOptions())==null?void 0:_b.chartType;return chartType==null&&(chartType="candlestick"),chartType}guardMemento(blob){return blob==null||chartTypes.includes(blob)}restoreMemento(_version,_mementoVersion,memento){var _a294;if(memento==null)return;const options={chartType:memento};(_a294=this.chartService.publicApi)==null||_a294.updateDelta(options).catch(e=>logger_exports.error("error restoring state",e))}},__name(_a50,"ChartTypeOriginator"),_a50),_a51,DestroyFns=(_a51=class{constructor(){this.destroyFns=[]}destroy(){this.destroyFns.forEach(fn=>fn()),this.destroyFns.length=0}setFns(destroyFns){this.destroy(),this.destroyFns=destroyFns}push(...destroyFns){this.destroyFns.push(...destroyFns)}},__name(_a51,"DestroyFns"),_a51),VERSION="11.2.4",NOT_FOUND=Symbol("previous-memento-not-found"),_a52,HistoryManager=(_a52=class{constructor(chartEventManager){this.history=[],this.historyIndex=-1,this.originators=new Map,this.clearState=new Map,this.maxHistoryLength=100,this.debug=Debug.create(!0,"history"),this.destroyFns=new DestroyFns,this.destroyFns.setFns([chartEventManager.addListener("series-undo",this.undo.bind(this)),chartEventManager.addListener("series-redo",this.redo.bind(this))])}destroy(){this.destroyFns.destroy()}addMementoOriginator(originator){this.originators.set(originator.mementoOriginatorKey,originator),this.clearState.set(originator.mementoOriginatorKey,originator.createMemento()),this.debugEvent("History add originator:",originator.mementoOriginatorKey)}clear(){this.debug("History clear:",Object.keys(this.originators)),this.history=[],this.historyIndex=-1;for(const[mementoOriginatorKey,originator]of this.originators.entries())this.clearState.set(mementoOriginatorKey,originator.createMemento())}record(label,...originators){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.length>this.maxHistoryLength&&(this.history=this.history.slice(-this.maxHistoryLength));const mementos=new Map;for(const originator of originators){if(!this.originators.has(originator.mementoOriginatorKey))throw new Error(`Originator [${originator.mementoOriginatorKey}] has not been added to the HistoryManager.`);mementos.set(originator.mementoOriginatorKey,originator.createMemento())}this.history.push({label,mementos}),this.historyIndex=this.history.length-1,this.debugEvent(`History record: [${label}]`)}undo(){const undoAction=this.history[this.historyIndex];if(undoAction){for(const mementoOriginatorKey of undoAction.mementos.keys()){const previousMemento=this.findPreviousMemento(mementoOriginatorKey);if(previousMemento===NOT_FOUND)throw new Error(`Could not find previous memento for [${mementoOriginatorKey}].`);this.restoreMemento(mementoOriginatorKey,previousMemento)}this.historyIndex-=1,this.debugEvent(`History undo: [${undoAction.label}]`)}}redo(){const redoAction=this.history[this.historyIndex+1];if(redoAction){for(const[mementoOriginatorKey,memento]of redoAction.mementos.entries())this.restoreMemento(mementoOriginatorKey,memento);this.historyIndex+=1,this.debugEvent(`History redo: [${redoAction.label}]`)}}findPreviousMemento(mementoOriginatorKey){for(let i=this.historyIndex-1;i>=0;i--)if(this.history[i].mementos.has(mementoOriginatorKey))return this.history[i].mementos.get(mementoOriginatorKey);return this.clearState.has(mementoOriginatorKey)?this.clearState.get(mementoOriginatorKey):NOT_FOUND}restoreMemento(mementoOriginatorKey,memento){var _a294;(_a294=this.originators.get(mementoOriginatorKey))==null||_a294.restoreMemento(VERSION,VERSION,memento)}debugEvent(...logContent){this.debug(...logContent,this.history.map((action,index)=>index===this.historyIndex?`** ${action.label} **`:action.label))}},__name(_a52,"HistoryManager"),_a52),_a53,MementoCaretaker=(_a53=class{constructor(version){this.version=version.split("-")[0]}save(...originators){const packet={version:this.version};for(const originator of Object.values(originators))packet[originator.mementoOriginatorKey]=this.encode(originator,originator.createMemento());return packet}restore(blob,...originators){if(typeof blob!="object"){logger_exports.warnOnce(`Could not restore data of type [${typeof blob}], expecting an object, ignoring.`);return}if(blob==null){logger_exports.warnOnce("Could not restore data of type [null], expecting an object, ignoring.");return}if(!("version"in blob)||typeof blob.version!="string"){logger_exports.warnOnce("Could not restore data, missing [version] string in object, ignoring.");return}for(const originator of originators){const memento=this.decode(originator,blob[originator.mementoOriginatorKey]),messages=[];if(!originator.guardMemento(memento,messages)){const messagesString=messages.length>0?`

${messages.join(`

`)}

`:"";logger_exports.warnOnce(`Could not restore [${originator.mementoOriginatorKey}] data, value was invalid, ignoring.${messagesString}`,memento);return}originator.restoreMemento(this.version,blob.version,memento)}}encode(originator,memento){try{return JSON.parse(JSON.stringify(memento,_a53.encodeTypes))}catch(error){throw new Error(`Failed to encode [${originator.mementoOriginatorKey}] value [${error}].`,{cause:error})}}decode(originator,encoded){if(encoded==null)return encoded;try{return JSON.parse(JSON.stringify(encoded),_a53.decodeTypes)}catch(error){throw new Error(`Failed to decode [${originator.mementoOriginatorKey}] value [${error}].`,{cause:error})}}static encodeTypes(key,value){return isDate(this[key])?{__type:"date",value:this[key].toISOString()}:value}static decodeTypes(key,value){return isObject(this[key])&&"__type"in this[key]&&this[key].__type==="date"?new Date(this[key].value):value}},__name(_a53,"_MementoCaretaker"),_a53),_a54,StateManager=(_a54=class{constructor(){this.caretaker=new MementoCaretaker(VERSION),this.state=new Map}setState(originator,value){objectsEqual(this.state.get(originator.mementoOriginatorKey),value)||this.setStateAndRestore(originator,value)}setStateAndRestore(originator,value){this.state.set(originator.mementoOriginatorKey,value),this.restoreState(originator)}restoreState(originator){const{caretaker,state}=this;if(!state.has(originator.mementoOriginatorKey))return;const value=state.get(originator.mementoOriginatorKey);caretaker.restore({version:caretaker.version,[originator.mementoOriginatorKey]:value},originator)}},__name(_a54,"StateManager"),_a54),styles_default=`.ag-charts-wrapper,.ag-charts-wrapper:after,.ag-charts-wrapper:before,.ag-charts-wrapper *,.ag-charts-wrapper *:after,.ag-charts-wrapper *:before{box-sizing:border-box}.ag-charts-wrapper{--align-items: center;--justify-content: center;position:relative;user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ag-charts-wrapper--safe-horizontal{--justify-content: flex-start}.ag-charts-wrapper--safe-vertical{--align-items: flex-start}.ag-charts-tab-guard{width:0%;height:0%;position:absolute;pointer-events:none}.ag-charts-canvas-center{width:100%;height:100%;position:absolute;touch-action:auto;pointer-events:auto;display:flex;align-items:var(--align-items);justify-content:var(--justify-content)}.ag-charts-canvas-container,.ag-charts-canvas{position:relative;user-select:none;-webkit-user-select:none}.ag-charts-canvas-container>*,.ag-charts-canvas>*{pointer-events:none}.ag-charts-canvas canvas{display:block}.ag-charts-series-area{outline:none;pointer-events:auto;position:absolute}.ag-charts-swapchain{top:0;left:0;outline:none;opacity:0;pointer-events:none;position:absolute;width:100%;height:100%}.ag-charts-swapchain:focus-visible{opacity:1}.ag-charts-canvas-proxy,.ag-charts-canvas-overlay{inset:0;pointer-events:none;position:absolute;user-select:none;-webkit-user-select:none}.ag-charts-canvas-overlay>*{position:absolute;pointer-events:auto}.ag-charts-theme-default,.ag-charts-theme-default-dark{--ag-charts-accent-color: #2196f3;--ag-charts-background-color: #fff;--ag-charts-border-color: #dddddd;--ag-charts-foreground-color: #464646;--ag-charts-font-family: Verdana, sans-serif;--ag-charts-font-size: 12px;--ag-charts-font-weight: 400;--ag-charts-padding: 20px;--ag-charts-shadow-color: #00000080;--ag-charts-subtle-text-color: #8c8c8c;--ag-charts-text-color: #464646;--ag-charts-chrome-background-color: #fafafa;--ag-charts-chrome-font-family: Verdana, sans-serif;--ag-charts-chrome-font-size: 12px;--ag-charts-chrome-font-weight: 400;--ag-charts-chrome-subtle-text-color: #8c8c8c;--ag-charts-chrome-text-color: #181d1f;--ag-charts-input-background-color: #fff;--ag-charts-input-text-color: #464646;--ag-charts-crosshair-label-background-color: #fff;--ag-charts-crosshair-label-text-color: #464646;--ag-charts-spacing: 4px;--ag-charts-border-radius: 4px;--ag-charts-shadow: 0 2px 8px 0 color-mix(in srgb, black 8%, transparent);--ag-charts-focus-shadow: 0 0 0 3px var(--ag-charts-accent-color);--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 12%);--ag-charts-input-border-color: var(--ag-charts-border-color);--ag-charts-input-border-radius: var(--ag-charts-border-radius);--ag-charts-input-focus-border-color: var(--ag-charts-accent-color);--ag-charts-input-focus-text-color: var(--ag-charts-accent-color);--ag-charts-input-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-input-disabled-border-color: var(--ag-charts-border-color);--ag-charts-input-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-input-text-color) 50% );--ag-charts-input-placeholder-text-color: color-mix( in srgb, var(--ag-charts-input-background-color), var(--ag-charts-input-text-color) 60% );--ag-charts-button-background-color: var(--ag-charts-background-color);--ag-charts-button-border-color: var(--ag-charts-border-color);--ag-charts-button-border-radius: var(--ag-charts-border-radius);--ag-charts-button-text-color: var(--ag-charts-text-color);--ag-charts-button-focus-background-color: color-mix( in srgb, var(--ag-charts-button-background-color), var(--ag-charts-accent-color) 12% );--ag-charts-button-focus-border-color: var(--ag-charts-accent-color);--ag-charts-button-focus-text-color: var(--ag-charts-accent-color);--ag-charts-button-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-button-disabled-border-color: var(--ag-charts-border-color);--ag-charts-button-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-chrome-text-color) 50% );--ag-charts-checkbox-background-color: color-mix( in srgb, var(--ag-charts-background-color), var(--ag-charts-foreground-color) 35% );--ag-charts-checkbox-checked-background-color: var(--ag-charts-accent-color);--ag-charts-chrome-font-size-small: var(--ag-charts-chrome-font-size);--ag-charts-chrome-font-size-medium: calc(var(--ag-charts-chrome-font-size) * (13 / 12));--ag-charts-chrome-font-size-large: calc(var(--ag-charts-chrome-font-size) * (14 / 12));--ag-charts-border: solid 1px var(--ag-charts-border-color);--ag-charts-focus-border: solid 1px var(--ag-charts-accent-color);--ag-charts-focus-border-shadow: 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%);--ag-charts-layer-menu: 6;--ag-charts-layer-ui-overlay: 5;--ag-charts-layer-tooltip: 4;--ag-charts-layer-toolbar: 3;--ag-charts-layer-crosshair: 2;--ag-charts-layer-annotations: 1}.ag-charts-theme-default-dark{--ag-charts-shadow: 0 2px 12px 0 color-mix(in srgb, black 33.3%, transparent);--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 22%)}.ag-chart-canvas-wrapper .ag-charts-theme-default{--ag-charts-border-radius: var(--ag-border-radius, 4px);--ag-charts-border: var(--ag-borders-critical, solid 1px) var(--ag-charts-border-color);--ag-charts-focus-shadow: var(--ag-focus-shadow, 0 0 0 3px var(--ag-charts-accent-color));--ag-charts-focus-border-shadow: var( --ag-focus-shadow, 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%) )}.ag-charts-icon{display:block;width:20px;height:20px;speak:none;speak:never;mask:var(--icon) center / contain no-repeat;background-color:currentColor;transition:background-color .25s ease-in-out}.ag-charts-icon-align-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNyAxMGg2djFIN3pNNCA3aDEydjFINHptMSA2aDEwdjFINXoiLz48L3N2Zz4=)}.ag-charts-icon-align-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNCAxMGg2djFINHptMC0zaDEydjFINHptMCA2aDEwdjFINHoiLz48L3N2Zz4=)}.ag-charts-icon-align-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTAgMTBoNnYxaC02ek00IDdoMTJ2MUg0em0yIDZoMTB2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-arrow-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1LjI5MyA0LjVIMTIuNXYtMUgxN3Y0aC0xVjUuMjA3bC05LjY0NiA5LjY0Ny0uNzA4LS43MDh6IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDE2YTIuNSAyLjUgMCAxIDEtNSAwIDIuNSAyLjUgMCAwIDEgNSAwbS0yLjUgMS41YTEuNSAxLjUgMCAxIDAgMC0zIDEuNSAxLjUgMCAwIDAgMCAzIiBmaWxsPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-arrow-down-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02IDhMMS41IDhMMTAgMThMMTguNSA4TDE0IDhMMTQgM0w2IDNMNiA4Wk03IDRMNyA5SDMuNjYyNDRMMTAgMTYuNDU2TDE2LjMzNzYgOUwxMyA5TDEzIDRMNyA0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-arrow-up-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNCAxMkgxOC41TDEwIDJMMS41IDEySDZMNi4wMDAwMiAxN0gxNFYxMlpNMTMgMTZWMTFIMTYuMzM3NkwxMCAzLjU0NDA1TDMuNjYyNDQgMTFIN0w3LjAwMDAyIDE2SDEzWiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-callout-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtNC41MTRhMjYgMjYgMCAwIDAtMi4wMTcgMS41NGwtLjMxNC4yNmMtLjU1LjQ1Ny0xLjExNS45MjYtMS43NiAxLjQtLjY2OS40OTEtMS41NjItLjAxMi0xLjU2Mi0uOFYxNEg0LjVBMS41IDEuNSAwIDAgMSAzIDEyLjV6TTQuNSA0YS41LjUgMCAwIDAtLjUuNXY4YS41LjUgMCAwIDAgLjUuNWgxLjgzM3YzLjM3MmEzNiAzNiAwIDAgMCAxLjY3OC0xLjMzOGwuMzItLjI2NWEyNiAyNiAwIDAgMSAyLjIyNS0xLjY4NWwuMTI2LS4wODRIMTUuNWEuNS41IDAgMCAwIC41LS41di04YS41LjUgMCAwIDAtLjUtLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyAxdjNoMnYxMkg3djNINnYtM0g0VjRoMlYxek01IDVoM3YxMEg1ek0xMSAxNFY2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6bTEtN2gzdjZoLTN6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-close{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtNSA1IDEwIDEwTTUgMTUgMTUgNSIgc3Ryb2tlPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-comment-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy41MTMgMy45OTVhNi41IDYuNSAwIDAgMSA2LjA5OCAxMS40MWMtLjU4OC4zOTMtMS4yMTcuNTM2LTEuODI5LjU4NWExMyAxMyAwIDAgMS0xLjI3LjAxN0EyNyAyNyAwIDAgMCAxMCAxNkg0LjVhLjUuNSAwIDAgMS0uNS0uNVYxMHEwLS4yNDctLjAwNy0uNTEzYy0uMDA4LS40MTYtLjAxNi0uODU3LjAxNy0xLjI2OS4wNS0uNjEyLjE5Mi0xLjI0LjU4NS0xLjgzYTYuNSA2LjUgMCAwIDEgMi45MTgtMi4zOTNtMy41Ni42MWE1LjUgNS41IDAgMCAwLTUuNjQ2IDIuMzRjLS4yNjYuMzk3LS4zNzkuODQyLS40MiAxLjM1NC0uMDMuMzYtLjAyMi43MTgtLjAxNSAxLjEwOFE1IDkuNjg5IDUgMTB2NWg1cS4zMTEuMDAxLjU5My4wMDhjLjM5LjAwNy43NDcuMDE1IDEuMTA4LS4wMTUuNTEyLS4wNDEuOTU3LS4xNTQgMS4zNTUtLjQyYTUuNSA1LjUgMCAwIDAtMS45ODMtOS45NjciIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-crosshair-add-line{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-date-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMiAyaDF2MTZIMnptMTUgMGgxdjE2aC0xeiIgZmlsbD0iIzE4MUQxRiIvPjxwYXRoIGQ9Ik0xMy4xNTcgMTFINXYtMWg3Ljc5M0wxMSA4LjIwN2wuNzA3LS43MDcgMy4xODIgMy4xODItMy4xODIgMy4xODItLjcwNy0uNzA3eiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-date-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMyAySDJ2MTZoMXptMy41MDcgNC44OUw4LjUgNC44OTVWMTBINXYxaDMuNXY3aDF2LTdoNS4wODhsLTEuOTU3IDEuOTU3LjcwNy43MDcgMy4xODItMy4xODJMMTMuMzM4IDcuM2wtLjcwNy43MDdMMTQuNjI0IDEwSDkuNVY0LjkzMmwxLjk1NyAxLjk1Ny43MDctLjcwN0w4Ljk4MiAzIDUuOCA2LjE4MnoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-delete{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTguNDk2IDguOTk2QS41LjUgMCAwIDEgOSA5LjQ5MnY0YS41LjUgMCAxIDEtMSAuMDA4di00YS41LjUgMCAwIDEgLjQ5Ni0uNTA0TTEyIDkuNWEuNS41IDAgMCAwLTEgMHY0YS41LjUgMCAwIDAgMSAweiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTYgNVYzLjVBMi41IDIuNSAwIDAgMSA4LjUgMWgzQTIuNSAyLjUgMCAwIDEgMTQgMy41VjVoMi44MzNhLjUuNSAwIDAgMSAwIDFIMTV2MTAuMjVjMCAuNDE1LS4wNjYuODYzLS4zIDEuMjIxLS4yNTcuMzk0LS42NzIuNjEyLTEuMi42MTJoLTdjLS41MjggMC0uOTQzLS4yMTgtMS4yLS42MTItLjIzNC0uMzU4LS4zLS44MDYtLjMtMS4yMjFWNkgzLjMzM2EuNS41IDAgMCAxIDAtMXptMS0xLjVBMS41IDEuNSAwIDAgMSA4LjUgMmgzQTEuNSAxLjUgMCAwIDEgMTMgMy41VjVIN3pNNiAxNi4yNVY2aDh2MTAuMjVjMCAuMzM1LS4wNTkuNTU0LS4xMzguNjc1LS4wNTUuMDg1LS4xNC4xNTgtLjM2Mi4xNThoLTdjLS4yMjIgMC0uMzA3LS4wNzMtLjM2Mi0uMTU4LS4wOC0uMTIxLS4xMzgtLjM0LS4xMzgtLjY3NSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-disjoint-channel,.ag-charts-icon-disjoint-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTkuMDI4IDE3LjQ2YTIuMjUgMi4yNSAwIDAgMC00LjA5Mi0xLjg1bC05LjUxMS0yLjM3OGEyLjI1IDIuMjUgMCAxIDAtLjIyNS45NzRsOS40NzUgMi4zNjlhMi4yNTEgMi4yNTEgMCAwIDAgNC4zNTMuODg2bS0xLjY2Mi0xLjk2NWExLjI1IDEuMjUgMCAxIDEtLjg4NSAyLjMzOCAxLjI1IDEuMjUgMCAwIDEgLjg4NS0yLjMzOE00LjM0MyAxMy42NjlhMS4yNSAxLjI1IDAgMSAwLTIuMzM4LS44ODUgMS4yNSAxLjI1IDAgMCAwIDIuMzM4Ljg4NU0zLjk3IDguNzY5YTIuMjUgMi4yNSAwIDAgMCAxLjQ1NS0yLjExbDkuNTExLTIuMzc4YTIuMjUgMi4yNSAwIDEgMC0uMjYtLjk2NUw1LjIgNS42ODVhMi4yNSAyLjI1IDAgMSAwLTEuMjMgMy4wODRtLjM3My0yLjU0N2ExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjc1LTMuNDM4YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-drag-handle{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjcuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjxjaXJjbGUgY3g9IjEzLjc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iMTMuNzUiIGN5PSIxMS43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjExLjc1IiByPSIuNzUiIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjUiLz48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iMTEuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA1aDEydjFIMnoiLz48Y2lyY2xlIGN4PSIxNS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4yNSIgY3k9IjE0LjUiIHI9IjEuNzUiIHN0cm9rZT0iIzAwMCIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0xOCAxNUg2di0xaDEyem0wLTQuNUgydi0xaDE2eiIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-trend-based-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJtNC45OTYgMTIuNjc0IDMuMjkxLTUuNzQzLjg2OC40OTctMy4yOTEgNS43NDN6Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4zNTEiIGN5PSIxNC41IiByPSIxLjc1IiBzdHJva2U9IiMwMDAiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTggNmgtN1Y1aDd6bTAgNC41aC03di0xaDd6bTAgNC41SDZ2LTFoMTJ6Ii8+PC9zdmc+)}.ag-charts-icon-fill-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtOC4wNzEgNC4wNi0uOTI0LS45MjQuNzA3LS43MDcgNy4yODggNy4yODgtNC45NSA0Ljk1YTMuNSAzLjUgMCAwIDEtNC45NSAwbC0xLjQxNC0xLjQxNGEzLjUgMy41IDAgMCAxIDAtNC45NXptLjcwNy43MDhMNC41MzYgOS4wMWEyLjUgMi41IDAgMCAwIDAgMy41MzZMNS45NSAxMy45NmEyLjUgMi41IDAgMCAwIDMuNTM1IDBsNC4yNDMtNC4yNDN6bTYuOSA3LjIwMi0uMzQ1LjM2My0uMzQ0LS4zNjNhLjUuNSAwIDAgMSAuNjg4IDBtLS4zNDUgMS4wOGE4IDggMCAwIDAtLjI4LjMyMyA0LjMgNC4zIDAgMCAwLS40MDkuNTgyYy0uMTEzLjIwMS0uMTQ0LjMyNi0uMTQ0LjM3OGEuODMzLjgzMyAwIDAgMCAxLjY2NyAwYzAtLjA1Mi0uMDMxLS4xNzctLjE0NC0uMzc4YTQuMyA0LjMgMCAwIDAtLjQxLS41ODIgOCA4IDAgMCAwLS4yOC0uMzIybS0uMzQ0LTEuMDguMzQ0LjM2My4zNDQtLjM2My4wMDIuMDAyLjAwNC4wMDQuMDEzLjAxMmE2IDYgMCAwIDEgLjIwNi4yMDhjLjEzMS4xMzYuMzA4LjMyNy40ODUuNTQ1LjE3Ni4yMTUuMzYzLjQ2Ny41MDcuNzI0LjEzNy4yNDMuMjczLjU1My4yNzMuODY4YTEuODMzIDEuODMzIDAgMSAxLTMuNjY3IDBjMC0uMzE1LjEzNi0uNjI1LjI3My0uODY4LjE0NC0uMjU3LjMzLS41MDkuNTA3LS43MjRhOSA5IDAgMCAxIC42NDUtLjcwOGwuMDQ2LS4wNDUuMDEzLS4wMTIuMDA0LS4wMDR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-hollow-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1vcGFjaXR5PSIuMTUiIGQ9Ik01IDVoM3YxMEg1eiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTcgMXYzaDJ2MTJIN3YzSDZ2LTNINFY0aDJWMXpNNSA1aDN2MTBINXptNyAyaDN2NmgtM3ptLTEgN1Y2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-horizontal-line,.ag-charts-icon-horizontal-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNLjUgOS41aDcuMzA2YTIuMjUgMi4yNSAwIDAgMSA0LjM4OCAwSDE5LjV2MWgtNy4zMDZhMi4yNSAyLjI1IDAgMCAxLTQuMzg4IDBILjV6bTkuNSAxLjc1YTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-line-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQuMjQyIDIuNzIyYy0uNjEyIDAtMS4yLjI0My0xLjYzMi42NzVsLTEuMzQzIDEuMzQ0YS41LjUgMCAwIDAtLjExMi4xMTJMNC4wNSAxMS45NTljLS4yMDcuMjA3LS4zNi40Ni0uNDQ2Ljc0di4wMDFsLS42OSAyLjc2N3YuMDAyYS44Mi44MiAwIDAgMCAxLjAyMiAxLjAyMWguMDAybDIuNjM0LS44MjJjLjI4LS4wODUuNTM0LS4yMzcuNzQtLjQ0M2w3LjEwNy03LjEwOGEuNS41IDAgMCAwIC4xMTItLjExMmwxLjM0My0xLjM0M2EyLjMwOCAyLjMwOCAwIDAgMC0xLjYzMi0zLjk0TTE0LjEyMiA3bDEuMDQ0LTEuMDQ1YTEuMzA4IDEuMzA4IDAgMSAwLTEuODQ5LTEuODVMMTIuMjcxIDUuMTV6bS0yLjU1OC0xLjE0Mi02LjgwNyA2LjgwOWEuOC44IDAgMCAwLS4xOTYuMzI1bC0uNzUgMi40NjggMi40Ny0uNzQ5YS44LjggMCAwIDAgLjMyNS0uMTk0bDYuODA4LTYuODF6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTcuMzYyIDQuODczLTQuNTk0IDYuNjU0LTQuODUtMy4zMTctNC4yNTEgNi45NzctLjg1NC0uNTJMNy42MTIgNi43OWw0Ljg5OSAzLjM1IDQuMDI4LTUuODM2eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-line-style-dashed{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDR2MUgyem0xMiAwaDR2MWgtNHpNOCA5aDR2MUg4eiIvPjwvc3ZnPg==)}.ag-charts-icon-line-style-dotted{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyLjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSI4LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSIxMi41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjE0LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-line-style-solid{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDE2djFIMnoiLz48L3N2Zz4=)}.ag-charts-icon-line-with-markers-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTk4IDQuODg4LTMuNTU2IDQuOTE4YTIuMjUgMi4yNSAwIDEgMS0zLjg2Ni43NWwtMS40MzItLjlhMi4yNCAyLjI0IDAgMCAxLTIuMDA5LjQzNWwtMy44MjggNi40MjgtLjg2LS41MTJMNi40NSA5LjYyM2EyLjI1IDIuMjUgMCAxIDEgMy41MS0uNzYxbDEuMzI5LjgzNWEyLjI0IDIuMjQgMCAwIDEgMi41NTctLjQ5N2wzLjU0Mi00Ljg5OHptLTQuOTYgNS4xNTNhMS4yNSAxLjI1IDAgMSAwLS42NCAyLjQxOSAxLjI1IDEuMjUgMCAwIDAgLjY0LTIuNDE5TTkuMSA4LjMyMXEuMDY2LS4xOTIuMDY3LS40MDRhMS4yNSAxLjI1IDAgMSAwLS4wNjcuNDA0IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-lock,.ag-charts-icon-locked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMjA3IDMuNzY0YTIuODk0IDIuODk0IDAgMCAwLTIuODk1IDIuODk0VjloNS43ODlWNi42NThhMi44OTQgMi44OTQgMCAwIDAtMi44OTUtMi44OTRNMTQuMSA5VjYuNjU4YTMuODk0IDMuODk0IDAgMSAwLTcuNzg5IDB2Mi4zNDlBMi41IDIuNSAwIDAgMCA0IDExLjV2M0EyLjUgMi41IDAgMCAwIDYuNSAxN2g4YTIuNSAyLjUgMCAwIDAgMi41LTIuNXYtM0EyLjUgMi41IDAgMCAwIDE0LjUgOXpNNi41IDEwQTEuNSAxLjUgMCAwIDAgNSAxMS41djNBMS41IDEuNSAwIDAgMCA2LjUgMTZoOGExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTNhMS41IDEuNSAwIDAgMC0xLjUtMS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-measurer-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibTQuNDYxIDEyLjcxIDEuNTMyLTEuNTMxIDEuNDE0IDEuNDE0LjcwNy0uNzA3TDYuNyAxMC40NzJsMS41MzItMS41MzMgMiAyIC43MDctLjcwNy0yLTIgNi4wMS02LjAxIDIuODMgMi44MjhMNS4wNSAxNy43NzggMi4yMjIgMTQuOTVsMS41MzItMS41MzIgMS40MTQgMS40MTQuNzA3LS43MDd6TS44MDggMTQuOTVsLjcwNy0uNzA3TDE0LjI0MyAxLjUxNWwuNzA3LS43MDcuNzA3LjcwNyAyLjgyOCAyLjgyOC43MDcuNzA3LS43MDcuNzA3TDUuNzU3IDE4LjQ4NWwtLjcwNy43MDctLjcwNy0uNzA3LTIuODI4LTIuODI4em0xMS4wNzgtNi44MzVMMTAuNDcgNi43bC43MDctLjcwNyAxLjQxNSAxLjQxNHptLjgyNC0zLjY1NCAxIDEgLjcwOC0uNzA3LTEtMXoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-note-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtMy4yMWwtMS40NjkgMi41N2ExIDEgMCAwIDEtMS42ODIuMDg1TDcuMjQzIDE0SDQuNUExLjUgMS41IDAgMCAxIDMgMTIuNXpNNC41IDRhLjUuNSAwIDAgMC0uNS41djhhLjUuNSAwIDAgMCAuNS41aDMuMjU3bDIuMTk2IDMuMDc0TDExLjcxIDEzaDMuNzlhLjUuNSAwIDAgMCAuNS0uNXYtOGEuNS41IDAgMCAwLS41LS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNi41IDYuNUEuNS41IDAgMCAxIDcgNmg2YS41LjUgMCAwIDEgMCAxSDdhLjUuNSAwIDAgMS0uNS0uNU02LjUgOS41QS41LjUgMCAwIDEgNyA5aDZhLjUuNSAwIDAgMSAwIDFIN2EuNS41IDAgMCAxLS41LS41IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-ohlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTEzIDExaC0zdi0xaDNWM2gxdjJoNHYxaC00djExaC0xek02IDE3di0yaDN2LTFINlY0SDV2MUgydjFoM3YxMXoiLz48L3N2Zz4=)}.ag-charts-icon-pan-end{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0ibTYuNjQ2IDEzLjgxMy0uMzUzLjM1NC43MDcuNzA3LjM1NC0uMzU0ek0xMS4xNjYgMTBsLjM1NC4zNTQuMzU0LS4zNTQtLjM1NC0uMzU0ek03LjM1NSA1LjQ4IDcgNS4xMjZsLS43MDcuNzA3LjM1My4zNTR6bTAgOS4wNCA0LjE2Ni00LjE2Ni0uNzA3LS43MDgtNC4xNjcgNC4xNjd6bTQuMTY2LTQuODc0TDcuMzU0IDUuNDhsLS43MDguNzA3IDQuMTY3IDQuMTY3ek0xMy4wODMgNXYxMGgxVjV6Ii8+PC9zdmc+)}.ag-charts-icon-pan-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNzkgNS44MzMgOC42MjUgMTBsNC4xNjYgNC4xNjctLjcwNy43MDdMNy4yMSAxMGw0Ljg3My00Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMSAxNC4xNjcgMTEuMzc2IDEwIDcuMjEgNS44MzNsLjcwNy0uNzA3TDEyLjc5IDEwbC00Ljg3MyA0Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-start{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgNXYxMGgxVjV6TTkuNjI0IDEwbDQuMTY2LTQuMTY3LS43MDctLjcwN0w4LjIxIDEwbDQuODc0IDQuODc0LjcwNy0uNzA3eiIvPjwvc3ZnPg==)}.ag-charts-icon-parallel-channel,.ag-charts-icon-parallel-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTcuNzIgNS4zMzFBMi4yNSAyLjI1IDAgMSAwIDE0LjcwNSAzLjZsLTkuNDkgNC41NjJhMi4yNSAyLjI1IDAgMSAwIC4yMDkgMS4wMWw5LjY2Mi00LjY0NmEyLjI1IDIuMjUgMCAwIDAgMi42MzQuODA1bS4zNzMtMi41NDdhMS4yNSAxLjI1IDAgMSAxLTIuMzM4Ljg4NSAxLjI1IDEuMjUgMCAwIDEgMi4zMzgtLjg4NU00LjM0MyA4LjY3YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODVNNS4zMDcgMTYuNzI4YTIuMjUgMi4yNSAwIDEgMS0uNTI1LS44NThsOS45MjMtNC43N2EyLjI1IDIuMjUgMCAxIDEgLjM4MS45MjZ6bS0uOTY0LjI3NGExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjAyMy01LjEwNmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-position-bottom{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzem0zLTNoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgMTNoOHYxSDZ6Ii8+PC9zdmc+)}.ag-charts-icon-position-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMyAxMGgxNHYxSDN6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDdoOHYxSDZ6bTAgNmg4djFINnoiLz48L3N2Zz4=)}.ag-charts-icon-position-top{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzeiIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik02IDdoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDEzaDh2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-price-label-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNC41IDNBMS41IDEuNSAwIDAgMCAzIDQuNVYxM2ExLjUgMS41IDAgMCAwIDEuNSAxLjVoLjgzM3YuMDU3Yy4yNDItLjI5OS41OTctLjUwMyAxLS41NDhWMTMuNUg0LjVBLjUuNSAwIDAgMSA0IDEzVjQuNWEuNS41IDAgMCAxIC41LS41aDExYS41LjUgMCAwIDEgLjUuNXY4YS41LjUgMCAwIDEtLjUuNWgtNC44MThsLS4xMjYuMDg0YTI2IDI2IDAgMCAwLTIuMjI1IDEuNjg1bC0uMzIuMjY1LS4wNjguMDU2YTEuNSAxLjUgMCAwIDEtMi42MDkgMS4zNTRjLjAzMy43NjMuOTA1IDEuMjM4IDEuNTYuNzU2LjY0Ni0uNDc0IDEuMjEtLjk0MyAxLjc2MS0xLjRsLjMxMy0uMjZBMjYgMjYgMCAwIDEgMTAuOTg2IDE0SDE1LjVhMS41IDEuNSAwIDAgMCAxLjUtMS41di04QTEuNSAxLjUgMCAwIDAgMTUuNSAzeiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOC43MTYgMTQuODE1YTIuMjUgMi4yNSAwIDEgMS00LjIxIDEuNTkzIDIuMjUgMi4yNSAwIDAgMSA0LjIxLTEuNTkzbS0xLjY2MiAxLjk2NmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS41IDYuMjI4IDcuMTY3IDguMzc2IDYuNSA3Ljc2MiA5LjUgNWwzIDIuNzYyLS42NjcuNjE0eiIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yIDE4di0xaDE2djF6TTIgM1YyaDE2djF6IiBmaWxsPSIjMTgxRDFGIi8+PC9zdmc+)}.ag-charts-icon-reset{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDQgNC40NDVhNS44MSA1LjgxIDAgMCAwLTcuMjU3IDIuNDUzLjUuNSAwIDAgMS0uODY1LS41MDJBNi44MSA2LjgxIDAgMSAxIDMgOS44MTNhLjUuNSAwIDAgMSAxIDAgNS44MSA1LjgxIDAgMSAwIDguMDQtNS4zNjgiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQuMjg5IDMuMDAyYS41LjUgMCAwIDEgLjUuNXYyLjY1NWgyLjY1NWEuNS41IDAgMCAxIDAgMUg0LjI5YS41LjUgMCAwIDEtLjUtLjVWMy41MDJhLjUuNSAwIDAgMSAuNS0uNSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-settings{--icon: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkIj48cGF0aCBkPSJNMTAgMTNhMyAzIDAgMSAwIDAtNiAzIDMgMCAwIDAgMCA2bTAtMWEyIDIgMCAxIDEtLjAwMS0zLjk5OUEyIDIgMCAwIDEgMTAgMTIiLz48cGF0aCBkPSJNMi4zMSAxNC4zNDVjLS44MTctMS40OTEuMDI3LTIuNDk5LjQ3NC0yLjg2NS41MzEtLjQzNC45NjktLjM2NS45NzItMS40OC0uMDAzLTEuMTE1LS40NDEtMS4wNDYtLjk3Mi0xLjQ4MS0uNDU0LS4zNzEtMS4zMTctMS40MDUtLjQzNC0yLjkzNmwuMDA1LS4wMDljLjg4NC0xLjUyIDIuMjA3LTEuMjkgMi43NTUtMS4wODMuNjQxLjI0My44MDEuNjU2IDEuNzY4LjEwMS45NjQtLjU2LjY4Ni0uOTA0Ljc5Ni0xLjU4Mi4wOTQtLjU3OC41NTktMS44NDMgMi4zMjYtMS44NDNoLjAxYzEuNzU5LjAwNSAyLjIyMiAxLjI2NiAyLjMxNiAxLjg0My4xMS42NzgtLjE2OCAxLjAyMi43OTYgMS41ODIuOTY3LjU1NSAxLjEyNy4xNDIgMS43NjgtLjEwMS41NDktLjIwOCAxLjg3Ni0uNDM4IDIuNzYgMS4wOTJzLjAyIDIuNTY1LS40MzQgMi45MzZjLS41MzEuNDM1LS45NjkuMzY2LS45NzIgMS40ODEuMDAzIDEuMTE1LjQ0MSAxLjA0Ni45NzIgMS40OC40NTQuMzcyIDEuMzE3IDEuNDA2LjQzNCAyLjkzN2wtLjAwNS4wMDljLS44ODQgMS41Mi0yLjIwNyAxLjI5LTIuNzU1IDEuMDgzLS42NDEtLjI0My0uODAxLS42NTYtMS43NjgtLjEwMS0uOTY0LjU2LS42ODYuOTA0LS43OTYgMS41ODEtLjA5NC41NzktLjU1OSAxLjg0NC0yLjMyNiAxLjg0NGgtLjAxYy0xLjc1OS0uMDA1LTIuMjIyLTEuMjY2LTIuMzE2LTEuODQ0LS4xMS0uNjc3LjE2OC0xLjAyMS0uNzk2LTEuNTgxLS45NjctLjU1NS0xLjEyNy0uMTQyLTEuNzY4LjEwMS0uNTQ5LjIwOC0xLjg3Ni40MzgtMi43Ni0xLjA5MmwtLjAyLS4wMzZ6TTkuOTg0IDIuMTYySDEwYzEuMzU1IDAgMS4zNDIgMS4wMzkgMS4zNTMgMS40MjUuMDA4LjMxMi4wNCAxLjE2IDEuMjU5IDEuODcybC4wMTUuMDA4YzEuMjI1LjcgMS45NzYuMzA0IDIuMjUxLjE1NS4zMzctLjE4MyAxLjIyNi0uNzExIDEuOTAyLjQ0NWwuMDA4LjAxNGMuNjc4IDEuMTczLS4yMjkgMS42ODItLjU1OCAxLjg4NC0uMjY2LjE2My0uOTg0LjYxNS0uOTkxIDIuMDI3di4wMTZjLjAwNyAxLjQxMi43MjUgMS44NjQuOTkxIDIuMDI3LjMyOC4yMDEgMS4yMjkuNzA3LjU2NiAxLjg3bC0uMDA4LjAxNGMtLjY3NyAxLjE3NC0xLjU3MS42NDMtMS45MS40NTktLjI3NS0uMTQ5LTEuMDI2LS41NDUtMi4yNTEuMTU0bC0uMDE1LjAwOWMtMS4yMTkuNzEyLTEuMjUxIDEuNTYtMS4yNTkgMS44NzItLjAxMS4zODYuMDAyIDEuNDI1LTEuMzUzIDEuNDI1cy0xLjM0Mi0xLjAzOS0xLjM1My0xLjQyNWMtLjAwOC0uMzEyLS4wNC0xLjE2LTEuMjU5LTEuODcybC0uMDE1LS4wMDljLTEuMjI1LS42OTktMS45NzYtLjMwMy0yLjI1MS0uMTU0LS4zMzYuMTgzLTEuMjE5LjcwNi0xLjg5NC0uNDMybC0uMDE2LS4wMjdjLS42NzgtMS4xNzQuMjI5LTEuNjgyLjU1OC0xLjg4NC4yNjYtLjE2My45ODQtLjYxNS45OTEtMi4wMjd2LS4wMTZjLS4wMDctMS40MTItLjcyNS0xLjg2NC0uOTkxLTIuMDI3LS4zMjgtLjIwMS0xLjIyOS0uNzA3LS41NjYtMS44N2wuMDA4LS4wMTRjLjY3Ny0xLjE3NCAxLjU3MS0uNjQzIDEuOTEtLjQ1OS4yNzUuMTQ5IDEuMDI2LjU0NSAyLjI1MS0uMTU1bC4wMTUtLjAwOGMxLjIxOS0uNzEyIDEuMjUxLTEuNTYgMS4yNTktMS44NzIuMDEtLjM4NC0uMDAyLTEuNDE3IDEuMzM3LTEuNDI1Ii8+PC9zdmc+)}.ag-charts-icon-step-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzE4MUQxRiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiA0aDV2OGgzVjhoNXYxaC00djRoLTVWNUg3djEwSDJ2LTFoNHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-text-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDRIMTZWN0gxNVY1SDEwLjVWMTVIMTRWMTZINlYxNUg5LjVWNUg1VjdINFY0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-trend-line,.ag-charts-icon-trend-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS4zMTQgMTAuOTM4YTIuMjUgMi4yNSAwIDEgMSAuMDEtMWg5LjM1MmEyLjI1IDIuMjUgMCAxIDEgLjAxIDF6bS0yLjE4OS43MjlhMS4yNSAxLjI1IDAgMSAwIDAtMi41IDEuMjUgMS4yNSAwIDAgMCAwIDIuNW0xMy43NSAwYTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-unlock,.ag-charts-icon-unlocked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNjUxIDMuNWEyLjg5NCAyLjg5NCAwIDAgMC0yLjg5NCAyLjg5NFY5SDE0LjVhMi41IDIuNSAwIDAgMSAyLjUgMi41djNhMi41IDIuNSAwIDAgMS0yLjUgMi41aC04QTIuNSAyLjUgMCAwIDEgNCAxNC41di0zQTIuNSAyLjUgMCAwIDEgNi41IDloLjI1N1Y2LjM5NGEzLjg5NCAzLjg5NCAwIDEgMSA3Ljc4OSAwIC41LjUgMCAwIDEtMSAwQTIuODk0IDIuODk0IDAgMCAwIDEwLjY1IDMuNU02LjUgMTBBMS41IDEuNSAwIDAgMCA1IDExLjV2M0ExLjUgMS41IDAgMCAwIDYuNSAxNmg4YTEuNSAxLjUgMCAwIDAgMS41LTEuNXYtM2ExLjUgMS41IDAgMCAwLTEuNS0xLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-vertical-line,.ag-charts-icon-vertical-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNSA3LjgwNmEyLjI1IDIuMjUgMCAwIDEgMCA0LjM4OFYxOS41aC0xdi03LjMwNmEyLjI1IDIuMjUgMCAwIDEgMC00LjM4OFYuNWgxem0tLjUuOTQ0YTEuMjUgMS4yNSAwIDEgMSAwIDIuNSAxLjI1IDEuMjUgMCAwIDEgMC0yLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-zoom-in{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-zoom-out{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS41IDEwYS41LjUgMCAwIDEgLjUtLjVoOGEuNS41IDAgMCAxIDAgMUg2YS41LjUgMCAwIDEtLjUtLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-high-low-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyA0aDJ2MTJINFY0aDNNNSA1aDN2MTBINXpNMTEgMTRWNmg1djhoLTVtMS03aDN2NmgtM3oiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-hlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTYzIDEuODM3LTUuMzM0IDExLjYyMUw2Ljk1NyA4LjEybC00LjE5OSA5LjYyMi0uOTE2LS40IDQuNzU2LTEwLjlMMTIuNDkgMTEuOCAxNy4yNTQgMS40MnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTUuODI1IDIuNzA0LjU1IDEzLjc4NWwuOTAyLjQzIDQuNzI0LTkuOTE5IDYuMDM0IDUuMDI5IDMuMjU1LTguMTQtLjkyOC0uMzctMi43NDUgNi44NnptNy44NTIgMTQuNjM2IDUuNzgtMTMuMTM5LS45MTUtLjQwMi01LjIxOSAxMS44Ni02LjAwNS01LjUwNC0zLjI3OCA3LjY0OC45Mi4zOTQgMi43MjItNi4zNTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-zoom-in-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20taW4iPjxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiLz48bGluZSB4MT0iMjEiIHgyPSIxNi42NSIgeTE9IjIxIiB5Mj0iMTYuNjUiLz48bGluZSB4MT0iMTEiIHgyPSIxMSIgeTE9IjgiIHkyPSIxNCIvPjxsaW5lIHgxPSI4IiB4Mj0iMTQiIHkxPSIxMSIgeTI9IjExIi8+PC9zdmc+)}.ag-charts-icon-zoom-out-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20tb3V0Ij48Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4Ii8+PGxpbmUgeDE9IjIxIiB4Mj0iMTYuNjUiIHkxPSIyMSIgeTI9IjE2LjY1Ii8+PGxpbmUgeDE9IjgiIHgyPSIxNCIgeTE9IjExIiB5Mj0iMTEiLz48L3N2Zz4=)}.ag-charts-input{--input-layer-active: 1;--input-layer-focus: 2;--input-padding: calc(var(--ag-charts-spacing) * 2);--input-padding-large: calc(var(--ag-charts-spacing) * 2.5);color:var(--ag-charts-input-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);transition-duration:.25s;transition-property:none;transition-timing-function:ease-out}.ag-charts-input:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--input-layer-focus)}.ag-charts-button{background:var(--ag-charts-button-background-color);border:1px solid var(--ag-charts-border-color);border-radius:var(--ag-charts-button-border-radius);color:var(--ag-charts-button-text-color);cursor:pointer;padding:var(--input-padding);transition-property:background,border-color}.ag-charts-button:hover{background:var(--ag-charts-focus-color)}.ag-charts-button:has(.ag-charts-icon){padding:2px}.ag-charts-checkbox{--checkbox-transition-duration: .1s;appearance:none;background:var(--ag-charts-checkbox-background-color);border-radius:calc(var(--ag-charts-border-radius) * 9);cursor:pointer;height:18px;margin:0;transition-duration:var(--checkbox-transition-duration);transition-property:margin;width:29px}.ag-charts-checkbox:before{display:block;background:var(--ag-charts-input-background-color);border-radius:calc(var(--ag-charts-border-radius) * 7);content:" ";height:14px;margin:2px;transition-duration:var(--checkbox-transition-duration);transition-property:margin;transition-timing-function:var(--ag-charts-input-transition-easing);width:14px}.ag-charts-checkbox:checked{background:var(--ag-charts-checkbox-checked-background-color)}.ag-charts-checkbox:checked:before{margin-left:13px}.ag-charts-select{background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-input-border-color);border-radius:var(--ag-charts-input-border-radius);padding:3px 2px 4px;font-size:inherit}.ag-charts-textarea{--textarea-line-height: 1.38;background:var(--ag-charts-input-background-color);border:1px solid var(--ag-charts-border-color);border-radius:var(--ag-charts-input-border-radius);line-height:var(--textarea-line-height);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);padding:var(--input-padding-large) var(--input-padding)}.ag-charts-textarea::placeholder{color:var(--ag-charts-input-placeholder-text-color)}.ag-charts-proxy-container{pointer-events:none;position:absolute}.ag-charts-proxy-elem{-webkit-appearance:none;appearance:none;background:none;border:none;color:#0000;overflow:hidden;pointer-events:auto;position:absolute}.ag-charts-proxy-elem::-moz-range-thumb,.ag-charts-proxy-elem::-moz-range-track{opacity:0}.ag-charts-proxy-elem::-webkit-slider-runnable-track,.ag-charts-proxy-elem::-webkit-slider-thumb{opacity:0}.ag-charts-proxy-elem:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-focus-indicator{position:absolute;display:block;pointer-events:none;user-select:none;-webkit-user-select:none;width:100%;height:100%}.ag-charts-focus-indicator>div{position:absolute;outline:solid 1px var(--ag-charts-chrome-background-color);box-shadow:var(--ag-charts-focus-shadow)}.ag-charts-focus-indicator>svg{width:100%;height:100%;fill:none;overflow:visible}.ag-charts-focus-svg-outer-path{stroke:var(--ag-charts-chrome-background-color);stroke-width:4px}.ag-charts-focus-svg-inner-path{stroke:var(--ag-charts-accent-color);stroke-width:2px}.ag-charts-overlay{color:#181d1f;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay{color:#fff}.ag-charts-overlay--loading{color:#8c8c8c}.ag-charts-overlay__loading-background{background:#fff;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay .ag-charts-overlay__loading-background{background:#192232}.ag-charts-tooltip{--tooltip-arrow-size: 8px;--tooltip-row-spacing: 8px;--tooltip-column-spacing: 16px;position:fixed;inset:unset;margin:0;padding:0;overflow:visible;top:var(--top, 0px);left:var(--left, 0px);width:max-content;max-width:100%;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);color:var(--ag-charts-chrome-text-color);background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);border-radius:var(--ag-charts-border-radius);box-shadow:var(--ag-charts-shadow)}.ag-charts-tooltip--compact .ag-charts-tooltip-content{--tooltip-row-spacing: 2px;--tooltip-column-spacing: 8px;padding:3px 6px}.ag-charts-tooltip--arrow-top:before,.ag-charts-tooltip--arrow-right:before,.ag-charts-tooltip--arrow-bottom:before,.ag-charts-tooltip--arrow-left:before{content:"";position:absolute;display:block;width:var(--tooltip-arrow-size);height:var(--tooltip-arrow-size);border:inherit;border-bottom-color:transparent;border-right-color:transparent;background:inherit;clip-path:polygon(0 0,100% 0,100% 1px,1px 100%,0 100%)}.ag-charts-tooltip--arrow-top:before{bottom:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * .5)) rotate(45deg)}.ag-charts-tooltip--arrow-bottom:before{top:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * -.5)) rotate(225deg)}.ag-charts-tooltip--arrow-left:before{right:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * .5)) rotate(315deg)}.ag-charts-tooltip--arrow-right:before{left:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * -.5)) rotate(135deg)}.ag-charts-tooltip--no-interaction{pointer-events:none;user-select:none;-webkit-user-select:none}.ag-charts-tooltip--wrap-always{overflow-wrap:break-word;word-break:break-word;hyphens:none}.ag-charts-tooltip--wrap-hyphenate{overflow-wrap:break-word;word-break:break-word;hyphens:auto}.ag-charts-tooltip--wrap-on-space{overflow-wrap:normal;word-break:normal}.ag-charts-tooltip--wrap-never{white-space:nowrap}.ag-charts-tooltip-heading,.ag-charts-tooltip-title,.ag-charts-tooltip-label,.ag-charts-tooltip-value{overflow:hidden;text-overflow:ellipsis}.ag-charts-tooltip-content{display:grid;grid:auto-flow minmax(1em,auto) / 1fr;padding:8px 12px;gap:var(--tooltip-row-spacing)}.ag-charts-tooltip-content:has(.ag-charts-tooltip-symbol){grid:auto-flow minmax(1em,auto) / auto 1fr}.ag-charts-tooltip-heading{grid-column:1 / -1}.ag-charts-tooltip-symbol{grid-column:1 / 2;place-self:center}.ag-charts-tooltip-symbol svg{display:block}.ag-charts-tooltip-title{grid-column:-2 / -1}.ag-charts-tooltip-row{grid-column:1 / -1;display:flex;gap:var(--tooltip-column-spacing);align-items:baseline;justify-content:space-between;overflow:hidden}.ag-charts-tooltip-row--inline{grid-column:-2 / -1}.ag-charts-tooltip-label{flex:1;min-width:0}.ag-charts-tooltip-value{min-width:0}.ag-charts-tooltip-footer{grid-column:1 / -1;color:var(--ag-charts-chrome-subtle-text-color);text-align:center}.ag-charts-popover{position:absolute;border:var(--ag-charts-border);border-radius:var(--ag-charts-border-radius);background:var(--ag-charts-chrome-background-color);color:var(--ag-charts-chrome-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);box-shadow:var(--ag-charts-shadow);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-menu{--item-padding: 6px 12px;--icon-color: var(--ag-charts-chrome-text-color);display:grid;grid:auto-flow auto / 1fr;column-gap:12px;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-menu:has(.ag-charts-menu__icon,.ag-charts-menu__row--stroke-width-visible){grid:auto-flow auto / auto 1fr}.ag-charts-menu__row--stroke-width-visible:before{content:"";height:var(--strokeWidth);width:12px;background:var(--icon-color)}.ag-charts-menu__row--stroke-width-visible[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-menu__row{display:grid;grid-column:1 / -1;grid-template-columns:subgrid;align-items:center;padding:var(--item-padding)}.ag-charts-menu__row:not(.ag-charts-menu__row--active){cursor:pointer}.ag-charts-menu__row:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.ag-charts-menu__row:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.ag-charts-menu__row:focus{background:var(--ag-charts-focus-color)}.ag-charts-menu__row:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--ag-charts-layer-menu)}.ag-charts-menu__row--active{--icon-color: var(--ag-charts-accent-color);background:var(--ag-charts-focus-color);color:var(--ag-charts-accent-color)}.ag-charts-menu__label{grid-column:-1 / span 1}.ag-charts-toolbar{--toolbar-gap: calc(var(--ag-charts-spacing) * 2);--toolbar-size: 34px;--toolbar-button-padding: 6px;align-items:center;display:flex;flex-wrap:nowrap;position:absolute}.ag-charts-toolbar__button{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);color:var(--ag-charts-chrome-text-color);cursor:pointer;display:flex;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-medium);font-weight:var(--ag-charts-chrome-font-weight);justify-content:center;min-height:var(--toolbar-size);min-width:var(--toolbar-size);padding:var(--toolbar-button-padding);position:relative;transition:background-color .25s ease-in-out,border-color .25s ease-in-out,color .25s ease-in-out;white-space:nowrap}.ag-charts-toolbar__button:hover{background:var(--ag-charts-focus-color);z-index:1}.ag-charts-toolbar__button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-toolbar__button--active{background:var(--ag-charts-focus-color);border-color:var(--ag-charts-accent-color);color:var(--ag-charts-accent-color);z-index:2}.ag-charts-toolbar__button[aria-disabled=true]{background:var(--ag-charts-button-disabled-background-color);color:var(--ag-charts-button-disabled-text-color);cursor:default}.ag-charts-toolbar--horizontal{flex-direction:row;.ag-charts-toolbar__button{margin:0 0 0 -1px}.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar--vertical{flex-direction:column;.ag-charts-toolbar__button{margin:-1px 0 0;max-width:100%}.ag-charts-toolbar__button--first{border-top-left-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-left-radius:var(--ag-charts-border-radius);border-bottom-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{margin-left:var(--toolbar-gap)}.ag-charts-toolbar__icon,.ag-charts-toolbar__label{pointer-events:none}.ag-charts-floating-toolbar{border:none;display:flex;.ag-charts-toolbar{align-items:unset;position:unset}}.ag-charts-floating-toolbar__drag-handle{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);cursor:grab;display:flex;justify-content:center;min-width:24px;padding-left:0;padding-right:0}.ag-charts-floating-toolbar__drag-handle--dragging{cursor:grabbing}
`,_a55,Listeners=(_a55=class{constructor(){this.registeredListeners=new Map}addListener(eventType,handler){const record={symbol:Symbol(eventType),handler};return this.registeredListeners.has(eventType)?this.registeredListeners.get(eventType).push(record):this.registeredListeners.set(eventType,[record]),()=>this.removeListener(record.symbol)}removeListener(eventSymbol){for(const[type,listeners]of this.registeredListeners.entries()){const matchIndex=listeners.findIndex(listener=>listener.symbol===eventSymbol);if(matchIndex>=0){listeners.splice(matchIndex,1),listeners.length===0&&this.registeredListeners.delete(type);break}}}dispatch(eventType,...params){for(const listener of this.getListenersByType(eventType))try{listener.handler(...params)}catch(e){logger_exports.errorOnce(String(e))}}getListenersByType(eventType){return this.registeredListeners.get(eventType)??[]}destroy(){this.registeredListeners.clear()}},__name(_a55,"Listeners"),_a55),_a56,BaseManager=(_a56=class{constructor(){this.listeners=new Listeners,this.destroyFns=[],this.destroyed=!1}addListener(type,handler){return this.listeners.addListener(type,handler)}destroy(){this.listeners.destroy(),this.destroyFns.forEach(fn=>fn()),this.destroyed=!0}},__name(_a56,"BaseManager"),_a56),_a57,GuardedElement=(_a57=class{constructor(element2,topTabGuard,bottomTabGuard){this.element=element2,this.topTabGuard=topTabGuard,this.bottomTabGuard=bottomTabGuard,this.destroyFns=[],this.guardTabIndex=0,this.hasFocus=!1,this.initTabGuard(this.topTabGuard,el=>this.onTab(el,!1)),this.initTabGuard(this.bottomTabGuard,el=>this.onTab(el,!0)),this.element.addEventListener("focus",()=>this.onFocus(),{capture:!0}),this.element.addEventListener("blur",ev=>this.onBlur(ev),{capture:!0})}set tabIndex(index){this.guardTabIndex=index,this.guardTabIndex===0?this.setGuardIndices(void 0):this.hasFocus||this.setGuardIndices(this.guardTabIndex)}destroy(){for(const fn of this.destroyFns)fn();this.destroyFns.length=0}initTabGuard(guard,handler){const handlerBinding=__name(()=>handler(guard),"handlerBinding");guard.addEventListener("focus",handlerBinding),this.destroyFns.push(()=>guard.removeEventListener("focus",handlerBinding))}setGuardIndices(index){const tabindex=index;setAttribute(this.topTabGuard,"tabindex",tabindex),setAttribute(this.bottomTabGuard,"tabindex",tabindex)}onFocus(){this.hasFocus=!0,this.guardTabIndex!==0&&this.setGuardIndices(0)}onBlur({relatedTarget}){const{topTabGuard:top,bottomTabGuard:bot}=this;this.hasFocus=!1,this.guardTabIndex!==0&&relatedTarget!==top&&relatedTarget!==bot&&this.setGuardIndices(this.guardTabIndex)}onTab(guard,reverse){if(this.guardTabIndex!==0){let focusTarget;guard.tabIndex===0?(focusTarget=this.findExitTarget(!reverse),this.setGuardIndices(this.guardTabIndex)):focusTarget=this.findEnterTarget(reverse),focusTarget==null||focusTarget.focus()}}static queryFocusable(element2,selectors){const myWindow=getWindow();return Array.from(element2.querySelectorAll(selectors)).filter(e=>{if(e instanceof HTMLElement){const style=myWindow.getComputedStyle(e);return style.display!=="none"&&style.visibility!=="none"}return!1})}findEnterTarget(reverse){const focusables=_a57.queryFocusable(this.element,'[tabindex="0"]'),index=reverse?focusables.length-1:0;return focusables[index]}findExitTarget(reverse){const focusables=_a57.queryFocusable(getDocument(),"[tabindex]").filter(e=>e.tabIndex>0).sort((a,b)=>a.tabIndex-b.tabIndex),{before,after}=_a57.findBeforeAndAfter(focusables,this.guardTabIndex);return reverse?before:after}static findBeforeAndAfter(elements,targetTabIndex){let left=0,right=elements.length-1,before,after;for(;left<=right;){const mid=Math.floor((left+right)/2),currentTabIndex=elements[mid].tabIndex;if(currentTabIndex===targetTabIndex){before=elements[mid-1]||void 0,after=elements[mid+1]||void 0;break}else currentTabIndex<targetTabIndex?(before=elements[mid],left=mid+1):(after=elements[mid],right=mid-1)}return{before,after}}},__name(_a57,"_GuardedElement"),_a57);function addRemovableEventListener(destroyFns,elem,type,listener,options){elem.addEventListener(type,listener);const remover=__name(()=>elem.removeEventListener(type,listener,options),"remover");return destroyFns.push(remover),remover}__name(addRemovableEventListener,"addRemovableEventListener");function addEscapeEventListener(destroyFns,elem,onEscape){addRemovableEventListener(destroyFns,elem,"keydown",event=>{event.key==="Escape"&&onEscape(event)})}__name(addEscapeEventListener,"addEscapeEventListener");function addMouseCloseListener(destroyFns,menu,hideCallback){const self=addRemovableEventListener(destroyFns,window,"mousedown",event=>{[0,2].includes(event.button)&&!containsPoint2(menu,event)&&(hideCallback(),self())});return self}__name(addMouseCloseListener,"addMouseCloseListener");function addTouchCloseListener(destroyFns,menu,hideCallback){const self=addRemovableEventListener(destroyFns,window,"touchstart",event=>{Array.from(event.targetTouches).some(touch=>!containsPoint2(menu,touch))&&(hideCallback(),self())});return self}__name(addTouchCloseListener,"addTouchCloseListener");function containsPoint2(container,event){if(event.target instanceof Element){const{x,y,width:width2,height:height2}=container.getBoundingClientRect(),{clientX:ex,clientY:ey}=event;return ex>=x&&ey>=y&&ex<=x+width2&&ey<=y+height2}return!1}__name(containsPoint2,"containsPoint2");function hasNoModifiers(event){return!(event.shiftKey||event.altKey||event.ctrlKey||event.metaKey)}__name(hasNoModifiers,"hasNoModifiers");function matchesKey(event,key,...morekeys){return hasNoModifiers(event)&&(event.key===key||morekeys.some(altkey=>event.key===altkey))}__name(matchesKey,"matchesKey");function linkTwoButtons(destroyFns,src,dst,key){dst&&addRemovableEventListener(destroyFns,src,"keydown",event=>{matchesKey(event,key)&&dst.focus()})}__name(linkTwoButtons,"linkTwoButtons");function linkThreeButtons(destroyFns,curr,next,nextKey,prev,prevKey){linkTwoButtons(destroyFns,curr,prev,prevKey),linkTwoButtons(destroyFns,curr,next,nextKey),addRemovableEventListener(destroyFns,curr,"keydown",event=>{matchesKey(event,nextKey,prevKey)&&event.preventDefault()})}__name(linkThreeButtons,"linkThreeButtons");var PREV_NEXT_KEYS={horizontal:{nextKey:"ArrowRight",prevKey:"ArrowLeft"},vertical:{nextKey:"ArrowDown",prevKey:"ArrowUp"}};function initRovingTabIndex(opts){const{orientation,buttons,wrapAround=!1,onEscape,onFocus,onBlur}=opts,{nextKey,prevKey}=PREV_NEXT_KEYS[orientation],setTabIndices=__name(event=>{event.target&&"tabIndex"in event.target&&(buttons.forEach(b=>b.tabIndex=-1),event.target.tabIndex=0)},"setTabIndices"),[c,m]=wrapAround?[buttons.length,buttons.length]:[0,1/0],destroyFns=[];for(let i=0;i<buttons.length;i++){const prev=buttons[(c+i-1)%m],curr=buttons[i],next=buttons[(c+i+1)%m];addRemovableEventListener(destroyFns,curr,"focus",setTabIndices),onFocus&&addRemovableEventListener(destroyFns,curr,"focus",onFocus),onBlur&&addRemovableEventListener(destroyFns,curr,"blur",onBlur),onEscape&&addEscapeEventListener(destroyFns,curr,onEscape),linkThreeButtons(destroyFns,curr,next,nextKey,prev,prevKey),curr.tabIndex=i===0?0:-1}return destroyFns}__name(initRovingTabIndex,"initRovingTabIndex");var _a58,MenuCloserImp=(_a58=class{constructor(menu,lastFocus,closeCallback){this.lastFocus=lastFocus,this.closeCallback=closeCallback,this.destroyFns=[],this.destroyFns.push(addMouseCloseListener(this.destroyFns,menu,()=>this.close(!0))),this.destroyFns.push(addTouchCloseListener(this.destroyFns,menu,()=>this.close(!0)))}close(mousedown){this.destroyFns.forEach(d=>d()),this.destroyFns.length=0,this.closeCallback(),this.finishClosing(mousedown)}finishClosing(mousedown){var _a294;this.destroyFns.forEach(d=>d()),this.destroyFns.length=0,setAttribute(this.lastFocus,"aria-expanded",!1),mousedown||(_a294=this.lastFocus)==null||_a294.focus({preventScroll:!0}),this.lastFocus=void 0}},__name(_a58,"MenuCloserImp"),_a58);function initMenuKeyNav(opts){var _a294;const{sourceEvent,orientation,menu,buttons,closeCallback,overrideFocusVisible,autoCloseOnBlur=!1}=opts,{nextKey,prevKey}=PREV_NEXT_KEYS[orientation],lastFocus=getLastFocus(sourceEvent);setAttribute(lastFocus,"aria-expanded",!0);const menuCloser=new MenuCloserImp(menu,lastFocus,closeCallback),onEscape=__name(()=>menuCloser.close(),"onEscape"),{destroyFns}=menuCloser;if(menu.role="menu",menu.ariaOrientation=orientation,destroyFns.push(...initRovingTabIndex({orientation,buttons,onEscape,wrapAround:!0})),menu.tabIndex=-1,addEscapeEventListener(destroyFns,menu,onEscape),addRemovableEventListener(destroyFns,menu,"keydown",ev=>{var _a295;ev.target===menu&&(ev.key===nextKey||ev.key===prevKey)&&(ev.preventDefault(),(_a295=buttons[0])==null||_a295.focus())}),autoCloseOnBlur){const handler=__name(ev=>{!buttons.includes(ev.relatedTarget)&&onEscape()},"handler");for(const button of buttons)addRemovableEventListener(destroyFns,button,"blur",handler)}return(_a294=buttons[0])==null||_a294.focus({preventScroll:!0}),overrideFocusVisible!==void 0&&(buttons.forEach(b=>b.setAttribute("data-focus-visible-override",overrideFocusVisible.toString())),addRemovableEventListener(destroyFns,menu,"keydown",__name(()=>{buttons.forEach(b=>b.setAttribute("data-focus-visible-override","true"))},"keydownTrueOverrider"),{once:!0})),menuCloser}__name(initMenuKeyNav,"initMenuKeyNav");function makeAccessibleClickListener(element2,onclick){return event=>{if(element2.ariaDisabled==="true")return event.preventDefault();onclick(event)}}__name(makeAccessibleClickListener,"makeAccessibleClickListener");function isButtonClickEvent(event){return"button"in event?event.button===0:hasNoModifiers(event)&&(event.code==="Space"||event.key==="Enter")}__name(isButtonClickEvent,"isButtonClickEvent");function getLastFocus(sourceEvent){if((sourceEvent==null?void 0:sourceEvent.target)instanceof HTMLElement&&"tabindex"in sourceEvent.target.attributes)return sourceEvent.target}__name(getLastFocus,"getLastFocus");function stopPageScrolling(element2){const handler=__name(event=>{if(event.defaultPrevented)return;getAttribute(event.target,"data-preventdefault",!0)&&matchesKey(event,"ArrowRight","ArrowLeft","ArrowDown","ArrowUp")&&event.preventDefault()},"handler");return element2.addEventListener("keydown",handler),()=>element2.removeEventListener("keydown",handler)}__name(stopPageScrolling,"stopPageScrolling");var _a59,PixelRatioObserver=(_a59=class{constructor(callback5){this.callback=callback5,this.devicePixelRatio=getWindow("devicePixelRatio")??1,this.devicePixelRatioMediaQuery=void 0,this.devicePixelRatioListener=e=>{e.matches||(this.devicePixelRatio=getWindow("devicePixelRatio")??1,this.unregisterDevicePixelRatioListener(),this.registerDevicePixelRatioListener(),this.callback(this.pixelRatio))}}get pixelRatio(){return this.devicePixelRatio}observe(){this.registerDevicePixelRatioListener()}disconnect(){this.unregisterDevicePixelRatioListener()}unregisterDevicePixelRatioListener(){var _a294;(_a294=this.devicePixelRatioMediaQuery)==null||_a294.removeEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=void 0}registerDevicePixelRatioListener(){var _a294;const devicePixelRatioMediaQuery=(_a294=getWindow("matchMedia"))==null?void 0:_a294(`(resolution: ${this.pixelRatio}dppx)`);devicePixelRatioMediaQuery==null||devicePixelRatioMediaQuery.addEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=devicePixelRatioMediaQuery}},__name(_a59,"PixelRatioObserver"),_a59),_a60,SizeMonitor=(_a60=class{constructor(){var _a294;this.elements=new Map,this.documentReady=!1,this.queuedObserveRequests=[],this.onLoad=()=>{this.documentReady=!0,this.queuedObserveRequests.forEach(([el,cb])=>this.observe(el,cb)),this.queuedObserveRequests=[],this.observeWindow()},typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(entries9=>{for(const{target,contentRect:{width:width2,height:height2}}of entries9){const entry=this.elements.get(target);this.checkSize(entry,target,width2,height2)}}));let animationFrame;this.pixelRatioObserver=new PixelRatioObserver(()=>{clearTimeout(animationFrame),animationFrame=setTimeout(()=>this.checkPixelRatio(),0)}),this.documentReady=getDocument("readyState")==="complete",this.documentReady?this.observeWindow():(_a294=getWindow())==null||_a294.addEventListener("load",this.onLoad)}destroy(){var _a294,_b,_c;(_a294=getWindow())==null||_a294.removeEventListener("load",this.onLoad),(_b=this.resizeObserver)==null||_b.disconnect(),this.resizeObserver=void 0,(_c=this.pixelRatioObserver)==null||_c.disconnect(),this.pixelRatioObserver=void 0}observeWindow(){var _a294;(_a294=this.pixelRatioObserver)==null||_a294.observe()}checkPixelRatio(){var _a294;const pixelRatio=((_a294=this.pixelRatioObserver)==null?void 0:_a294.pixelRatio)??1;for(const[element2,entry]of this.elements)if(entry.size!=null&&entry.size.pixelRatio!==pixelRatio){const{width:width2,height:height2}=entry.size;entry.size={width:width2,height:height2,pixelRatio},entry.cb(entry.size,element2)}}checkSize(entry,element2,width2,height2){var _a294,_b,_c;if(entry&&(width2!==((_a294=entry.size)==null?void 0:_a294.width)||height2!==((_b=entry.size)==null?void 0:_b.height))){const pixelRatio=((_c=this.pixelRatioObserver)==null?void 0:_c.pixelRatio)??1;entry.size={width:width2,height:height2,pixelRatio},entry.cb(entry.size,element2)}}observe(element2,cb){var _a294;if(!this.documentReady){this.queuedObserveRequests.push([element2,cb]);return}this.elements.has(element2)?this.removeFromQueue(element2):(_a294=this.resizeObserver)==null||_a294.observe(element2);const entry={cb};this.elements.set(element2,entry)}unobserve(element2){var _a294;(_a294=this.resizeObserver)==null||_a294.unobserve(element2),this.elements.delete(element2),this.removeFromQueue(element2),this.elements.size||this.destroy()}removeFromQueue(element2){this.queuedObserveRequests=this.queuedObserveRequests.filter(([el])=>el!==element2)}},__name(_a60,"SizeMonitor"),_a60),_a61,StateTracker=(_a61=class extends Map{constructor(defaultValue,defaultState){super(),this.defaultValue=defaultValue,this.defaultState=defaultState}set(key,value){return this.delete(key),typeof value<"u"&&super.set(key,value),this}stateId(){return Array.from(this.keys()).pop()??this.defaultState}stateValue(){return Array.from(this.values()).pop()??this.defaultValue}},__name(_a61,"StateTracker"),_a61),domLayout_default='<div role="presentation" class="ag-charts-wrapper ag-charts-styles" data-ag-charts><div role="presentation" class="ag-charts-canvas-center"><div role="presentation" class="ag-charts-canvas-container"><div role="presentation" class="ag-charts-canvas" aria-hidden="true"></div><div role="figure" class="ag-charts-canvas-proxy"><div role="presentation" class="ag-charts-series-area"></div></div><div role="presentation" class="ag-charts-canvas-overlay ag-charts-tooltip-container"></div></div></div></div>',DOM_ELEMENT_CLASSES=["styles","canvas","canvas-center","canvas-container","canvas-overlay","canvas-proxy","series-area","tooltip-container"],CONTAINER_MODIFIERS={safeHorizontal:"ag-charts-wrapper--safe-horizontal",safeVertical:"ag-charts-wrapper--safe-vertical"},domElementConfig=new Map([["styles",{childElementType:"style"}],["canvas",{childElementType:"canvas"}],["canvas-proxy",{childElementType:"div"}],["canvas-overlay",{childElementType:"div"}],["canvas-center",{childElementType:"div"}],["series-area",{childElementType:"div"}],["tooltip-container",{childElementType:"div"}]]);function setupObserver(element2,cb){if(typeof IntersectionObserver>"u")return;const observer=new IntersectionObserver(observedEntries=>{for(const entry of observedEntries)entry.target===element2&&cb(entry.intersectionRatio)},{root:element2});return observer.observe(element2),observer}__name(setupObserver,"setupObserver");var NULL_DOMRECT={x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0,toJSON(){return NULL_DOMRECT}};function createTabGuardElement(guardedElem,where){const div=createElement("div");return div.className="ag-charts-tab-guard",guardedElem.insertAdjacentElement(where,div),div}__name(createTabGuardElement,"createTabGuardElement");var _a62,_DOMManager=(_a62=class extends BaseManager{constructor(initialContainer,styleContainer,mode="normal"){super(),this.styleContainer=styleContainer,this.mode=mode,this.anchorName=`--${createId(this)}`,this.styles=new Map,this.pendingContainer=void 0,this.container=void 0,this.documentRoot=void 0,this.initiallyConnected=void 0,this.containerSize=void 0,this.sizeMonitor=new SizeMonitor,this.cursorState=new StateTracker("default"),this.minWidth=0,this.minHeight=0,this.element=this.initDOM(),this.rootElements=this.initRootElements(),this.rootElements.canvas.element.style.setProperty("anchor-name",this.anchorName);let hidden=!1;if(this.observer=setupObserver(this.element,intersectionRatio=>{intersectionRatio===0&&!hidden&&this.listeners.dispatch("hidden",{type:"hidden"}),hidden=intersectionRatio===0}),this.setSizeOptions(),this.updateContainerSize(),this.addStyles("ag-charts-community",styles_default),this.setContainer(initialContainer),this.destroyFns.push(stopPageScrolling(this.element)),this.mode==="normal"){const guardedElement=this.rootElements["canvas-center"].element;if(guardedElement==null)throw new Error("Error initializing tab guards");const topGuard=createTabGuardElement(guardedElement,"beforebegin"),botGuard=createTabGuardElement(guardedElement,"afterend");this.tabGuards=new GuardedElement(guardedElement,topGuard,botGuard)}}initDOM(){if(this.mode==="normal"){const templateEl=createElement("div");return templateEl.innerHTML=domLayout_default,templateEl.firstChild}const element2=createElement("div");element2.role="presentation",element2.classList.add("ag-charts-canvas-container","ag-charts-canvas","ag-charts-tooltip-container");const seriesArea=createElement("div");return element2.appendChild(seriesArea),seriesArea.role="presentation",seriesArea.classList.add("ag-charts-series-area"),element2}initRootElements(){return DOM_ELEMENT_CLASSES.reduce((r,c)=>{const cssClass=`ag-charts-${c}`;let el=this.element.classList.contains(cssClass)?this.element:this.element.querySelector(`.${cssClass}`);if(!el&&this.mode==="normal")throw new Error(`AG Charts - unable to find DOM element ${cssClass}`);return el??(el=createElement("div")),r[c]={element:el,children:new Map,listeners:[]},r},{})}destroy(){var _a294;super.destroy(),(_a294=this.observer)==null||_a294.unobserve(this.element),this.container&&this.sizeMonitor.unobserve(this.container),this.pendingContainer=void 0,Object.values(this.rootElements).forEach(el=>{el.children.forEach(c=>c.remove()),el.element.remove()}),this.element.remove()}postRenderUpdate(){this.mode!=="minimal"&&(this.pendingContainer==null||this.pendingContainer===this.container||(_a62.batchedUpdateContainer.length===0&&getWindow().setTimeout(this.applyBatchedUpdateContainer.bind(this),0),_a62.batchedUpdateContainer.push(this)))}applyBatchedUpdateContainer(){for(const manager of _a62.batchedUpdateContainer)manager.destroyed||manager.updateContainer();_a62.batchedUpdateContainer.splice(0)}setSizeOptions(minWidth=300,minHeight=300,optionsWidth,optionsHeight){const{style}=this.element;style.width=`${optionsWidth??minWidth}px`,style.height=`${optionsHeight??minHeight}px`,this.minWidth=optionsWidth??minWidth,this.minHeight=optionsHeight??minHeight,this.updateContainerClassName()}updateContainerSize(){const{style:centerStyle}=this.rootElements["canvas-center"].element;centerStyle.visibility=this.containerSize==null?"hidden":"",this.containerSize?(centerStyle.width=`${this.containerSize.width??0}px`,centerStyle.height=`${this.containerSize.height??0}px`):(centerStyle.width="",centerStyle.height=""),this.updateContainerClassName()}setTabGuardIndex(tabIndex){this.tabGuards&&(this.tabGuards.tabIndex=tabIndex)}setContainer(newContainer){newContainer!==this.container&&(this.pendingContainer=newContainer,(this.mode==="minimal"||this.container==null)&&this.updateContainer())}updateContainer(){const{pendingContainer}=this;if(!(pendingContainer==null||pendingContainer===this.container)){if(this.container&&(this.container.removeChild(this.element),this.sizeMonitor.unobserve(this.container)),this.documentRoot!=null)for(const id of this.rootElements.styles.children.keys())this.removeChild("styles",id);this.container=pendingContainer,this.pendingContainer=void 0,this.documentRoot=this.getShadowDocumentRoot(pendingContainer),this.initiallyConnected=this.mode==="minimal"||pendingContainer.isConnected;for(const[id,styles]of this.styles)this.addStyles(id,styles);pendingContainer.appendChild(this.element),this.sizeMonitor.observe(pendingContainer,size=>{this.containerSize=size,this.updateContainerSize(),this.listeners.dispatch("resize",{type:"resize"})}),this.listeners.dispatch("container-changed",{type:"container-changed"})}}setThemeClass(themeClassName){const themeClassNamePrefix="ag-charts-theme-";this.element.classList.forEach(className=>{className.startsWith(themeClassNamePrefix)&&className!==themeClassName&&this.element.classList.remove(className)}),this.element.classList.add(themeClassName)}setThemeParameters(params){const keysMap={accentColor:"accent-color",axisColor:"axis-color",backgroundColor:"background-color",borderColor:"border-color",foregroundColor:"foreground-color",fontFamily:"font-family",fontSize:"font-size",fontWeight:"font-weight",gridLineColor:"grid-line-color",padding:"padding",subtleTextColor:"subtle-text-color",textColor:"text-color",chromeBackgroundColor:"chrome-background-color",chromeFontFamily:"chrome-font-family",chromeFontSize:"chrome-font-size",chromeFontWeight:"chrome-font-weight",chromeSubtleTextColor:"chrome-subtle-text-color",chromeTextColor:"chrome-text-color",inputBackgroundColor:"input-background-color",inputTextColor:"input-text-color",crosshairLabelBackgroundColor:"crosshair-label-background-color",crosshairLabelTextColor:"crosshair-label-text-color"},lengthKeys=["fontSize","chromeFontSize"];for(const[key,value]of entries(params)){let formattedValue=`${value}`;lengthKeys.includes(key)&&(formattedValue=`${value}px`),this.element.style.setProperty(`--ag-charts-${keysMap[key]}`,formattedValue)}}updateCanvasLabel(ariaLabel){setAttribute(this.rootElements["canvas-proxy"].element,"aria-label",ariaLabel)}getEventElement(defaultElem,eventType){return["focus","blur","keydown","keyup"].includes(eventType)?this.rootElements["series-area"].element:defaultElem}addEventListener(type,listener,options){this.getEventElement(this.element,type).addEventListener(type,listener,options)}removeEventListener(type,listener,options){this.getEventElement(this.element,type).removeEventListener(type,listener,options)}getBoundingClientRect(){return this.rootElements.canvas.element.getBoundingClientRect()}getOverlayClientRect(){var _a294;const window2=getWindow(),windowBBox=new BBox(0,0,window2.innerWidth,window2.innerHeight),containerBBox=this.getRawOverlayClientRect();return((_a294=windowBBox.intersection(containerBBox))==null?void 0:_a294.toDOMRect())??NULL_DOMRECT}getRawOverlayClientRect(){var _a294,_b,_c;let element2=this.element;const fullScreenElement=(_a294=this.element.getRootNode())==null?void 0:_a294.fullscreenElement;for(;element2!=null;){let isContainer;if(fullScreenElement!=null&&element2===fullScreenElement)isContainer=!0;else{const styleMap=(_b=element2.computedStyleMap)==null?void 0:_b.call(element2),overflowY=(_c=styleMap==null?void 0:styleMap.get("overflow-y"))==null?void 0:_c.toString();isContainer=overflowY==="auto"||overflowY==="scroll"}if(isContainer)return BBox.fromDOMRect(element2.getBoundingClientRect());element2=element2.parentElement}if(this.documentRoot!=null)return BBox.fromDOMRect(this.documentRoot.getBoundingClientRect());const{innerWidth,innerHeight}=getWindow();return new BBox(0,0,innerWidth,innerHeight)}getShadowDocumentRoot(current=this.container){var _a294;const docRoot=((_a294=current==null?void 0:current.ownerDocument)==null?void 0:_a294.body)??getDocument("body");for(;current!=null;){if(current===docRoot)return;if(current.parentNode instanceof DocumentFragment)return current;current=current.parentNode}}getParent(domElementClass){return this.rootElements[domElementClass].element}getChildBoundingClientRect(type){const{children}=this.rootElements[type],childRects=[];for(const child of children.values())childRects.push(BBox.fromDOMRect(child.getBoundingClientRect()));return BBox.merge(childRects)}isManagedChildDOMElement(el,domElementClass,id){const{children}=this.rootElements[domElementClass],search=children==null?void 0:children.get(id);return search!=null&&el.contains(search)}contains(element2,domElementClass){return domElementClass==null?this.element.contains(element2):this.rootElements[domElementClass].element.contains(element2)}addStyles(id,styles){const dataAttribute="data-ag-charts";if(this.styles.set(id,styles),this.container==null)return;const checkId=__name(el=>el.getAttribute(dataAttribute)===id,"checkId"),addStyleElement=__name(el=>{const metaElements=new Set(["TITLE","META"]);let skippingMetaElements=!0,insertAfterEl;for(const child of el.children){if(skippingMetaElements&&metaElements.has(child.tagName)){insertAfterEl=child;continue}if(skippingMetaElements=!1,checkId(child))return;child.hasAttribute(dataAttribute)&&(insertAfterEl=child)}const styleEl=createElement("style");return insertAfterEl==null?el.prepend(styleEl):el.insertBefore(styleEl,insertAfterEl.nextSibling),styleEl},"addStyleElement");let styleElement;this.styleContainer?styleElement=addStyleElement(this.styleContainer):this.initiallyConnected===!1?styleElement=this.addChild("styles",id):this.documentRoot==null&&!_a62.headStyles.has(id)?(styleElement=addStyleElement(getDocument("head")),_a62.headStyles.add(id)):this.documentRoot!=null&&(styleElement=this.addChild("styles",id)),!(styleElement==null||checkId(styleElement))&&(styleElement.setAttribute(dataAttribute,id),styleElement.innerHTML=styles)}removeStyles(id){this.removeChild("styles",id)}updateCursor(callerId,style){this.cursorState.set(callerId,style),this.element.style.cursor=this.cursorState.stateValue()}getCursor(){return this.element.style.cursor}addChild(domElementClass,id,child,insert){const{element:element2,children,listeners}=this.rootElements[domElementClass];if(!children)throw new Error("AG Charts - unable to create DOM elements after destroy()");if(children.has(id))return children.get(id);const{childElementType="div"}=domElementConfig.get(domElementClass)??{};if(child&&child.tagName.toLowerCase()!==childElementType.toLowerCase())throw new Error("AG Charts - mismatching DOM element type");const newChild=child??createElement(childElementType);for(const[type,fn,opts]of listeners)newChild.addEventListener(type,fn,opts);if(children.set(id,newChild),insert){const queryResult=element2.querySelector(insert.query);if(queryResult==null)throw new Error(`AG Charts - addChild query failed ${insert.query}`);queryResult.insertAdjacentElement(insert.where,newChild)}else element2==null||element2.appendChild(newChild);return newChild}removeChild(domElementClass,id){var _a294;const{children}=this.rootElements[domElementClass];children&&((_a294=children.get(id))==null||_a294.remove(),children.delete(id))}incrementDataCounter(name){const{dataset}=this.element;dataset[name]??(dataset[name]="0"),dataset[name]=String(Number(dataset[name])+1)}setDataBoolean(name,value){this.element.dataset[name]=String(value)}updateContainerClassName(){const{element:element2,containerSize,minWidth,minHeight}=this;element2.classList.toggle(CONTAINER_MODIFIERS.safeHorizontal,minWidth>=((containerSize==null?void 0:containerSize.width)??1/0)),element2.classList.toggle(CONTAINER_MODIFIERS.safeVertical,minHeight>=((containerSize==null?void 0:containerSize.height)??1/0))}},__name(_a62,"_DOMManager"),_a62);_DOMManager.batchedUpdateContainer=[];_DOMManager.headStyles=new Set;var DOMManager=_DOMManager,_a63,BoundedTextWidget=(_a63=class extends Widget{constructor(){super(createElement("div")),this.textElement=createSvgElement("text"),this.textElement.role="presentation",this.svgElement=createSvgElement("svg"),this.svgElement.appendChild(this.textElement),this.svgElement.style.width="100%",this.svgElement.style.opacity="0",this.svgElement.role="presentation",this.elem.appendChild(this.svgElement),this.elem.role="presentation"}set textContent(text2){var _a294;this.textElement.textContent=text2;const bboxCalculator=this.textElement,bbox=(_a294=bboxCalculator.getBBox)==null?void 0:_a294.call(bboxCalculator);bbox&&this.svgElement.setAttribute("viewBox",`${bbox.x} ${bbox.y} ${bbox.width} ${bbox.height}`)}get textContent(){return this.textElement.textContent}destructor(){}},__name(_a63,"BoundedTextWidget"),_a63),_a64,ButtonWidget=(_a64=class extends Widget{constructor(){super(createElement("button")),this.setEnabled(!0)}destructor(){}setEnabled(enabled){setAttribute(this.elem,"aria-disabled",!enabled),setElementStyle(this.elem,"pointer-events",enabled?void 0:"none")}addListener(type,listener){return super.addListener(type,(ev,current)=>{(type==="click"||type==="dblclick")&&this.isDisabled()||listener(ev,current)})}},__name(_a64,"ButtonWidget"),_a64),_a65,GroupWidget=(_a65=class extends Widget{constructor(){super(createElement("div")),setAttribute(this.elem,"role","group")}destructor(){}},__name(_a65,"GroupWidget"),_a65),_a66,RovingTabContainerWidget=(_a66=class extends Widget{constructor(initialOrientation,role){super(createElement("div")),this.focusedChildIndex=0,this.onChildFocus=(_event,child)=>{const oldFocus=this.children[this.focusedChildIndex];this.focusedChildIndex=child.index,oldFocus==null||oldFocus.setTabIndex(-1),child.setTabIndex(0)},this.onChildKeyDown=(event,child)=>{var _a294;const rovingOrientation=this.orientation,[primaryKeys,secondaryKeys]=rovingOrientation==="both"?[PREV_NEXT_KEYS.horizontal,PREV_NEXT_KEYS.vertical]:[PREV_NEXT_KEYS[rovingOrientation],void 0];let targetIndex=-1;if(hasNoModifiers(event.sourceEvent)){const key=event.sourceEvent.key;key===primaryKeys.nextKey||key===(secondaryKeys==null?void 0:secondaryKeys.nextKey)?targetIndex=child.index+1:(key===primaryKeys.prevKey||key===(secondaryKeys==null?void 0:secondaryKeys.prevKey))&&(targetIndex=child.index-1)}(_a294=this.children[targetIndex])==null||_a294.focus()},this.orientation=initialOrientation,setAttribute(this.elem,"role",role)}get orientation(){return getAttribute(this.elem,"aria-orientation")??"both"}set orientation(orientation){setAttribute(this.elem,"aria-orientation",orientation!=="both"?orientation:void 0)}focus(){var _a294;(_a294=this.children[this.focusedChildIndex])==null||_a294.focus()}onChildAdded(child){child.addListener("focus",this.onChildFocus),child.addListener("keydown",this.onChildKeyDown),child.setTabIndex(this.children.length===1?0:-1)}onChildRemoved(removedChild){removedChild.removeListener("focus",this.onChildFocus),removedChild.removeListener("keydown",this.onChildKeyDown);const{focusedChildIndex,children}=this,removedFocusedChild=focusedChildIndex===removedChild.index;for(let i=0;i<children.length;i++){const child=children[i];child.index===focusedChildIndex&&(this.focusedChildIndex=i),child.index=i}if(removedFocusedChild){const newFocusChild=children[focusedChildIndex]??children[focusedChildIndex-1];newFocusChild?(this.focusedChildIndex=newFocusChild.index,newFocusChild.setTabIndex(0)):this.focusedChildIndex=0}}},__name(_a66,"RovingTabContainerWidget"),_a66),_a67,ListWidget=(_a67=class extends RovingTabContainerWidget{constructor(){super("both","list"),this.setHidden(!0)}destructor(){this.children.forEach(c=>c.getElement().parentElement.remove())}addChildToDOM(child,before){const listItem=createElement("div");setAttribute(listItem,"role","listitem"),setElementStyle(listItem,"position","absolute"),Widget.setElementContainer(child,listItem),this.appendOrInsert(listItem,before),this.setHidden(!1)}removeChildFromDOM(child){child.getElement().parentElement.remove(),this.setHidden(this.children.length===0)}setHidden(hidden){this.children.length===0&&(hidden=!0),super.setHidden(hidden)}},__name(_a67,"ListWidget"),_a67),_a68,NativeWidget=(_a68=class extends Widget{constructor(elem){super(elem)}destructor(){}},__name(_a68,"NativeWidget"),_a68),percentFormatter=new Intl.NumberFormat("en-US",{style:"percent"});function formatValue(value,maximumFractionDigits=2){return typeof value=="number"?formatNumber(value,maximumFractionDigits):typeof value=="string"?value:String(value??"")}__name(formatValue,"formatValue");function formatPercent(value){return percentFormatter.format(value)}__name(formatPercent,"formatPercent");var numberFormatters=new Map().set(2,new Intl.NumberFormat("en-US",{maximumFractionDigits:2,useGrouping:!1}));function formatNumber(value,maximumFractionDigits){let formatter=numberFormatters.get(maximumFractionDigits);return formatter||(formatter=new Intl.NumberFormat("en-US",{maximumFractionDigits,useGrouping:!1}),numberFormatters.set(maximumFractionDigits,formatter)),formatter.format(value)}__name(formatNumber,"formatNumber");var _a69,_SliderWidget=(_a69=class extends Widget{constructor(){super(createElement("input")),this._step=_a69.STEP_ONE,this.orientation="both"}get step(){return this._step}set step(step){this._step=step,this.getElement().step=step.attributeValue}get keyboardStep(){var _a294;return((_a294=this._keyboardStep)==null?void 0:_a294.step)??this._step}set keyboardStep(step){var _a294;if(step!==((_a294=this._keyboardStep)==null?void 0:_a294.step)&&(this._keyboardStep!==void 0&&(this.removeListener("keydown",this._keyboardStep.onKeyDown),this.removeListener("keyup",this._keyboardStep.onKeyUp),this.removeListener("blur",this._keyboardStep.onBlur),this._keyboardStep=void 0),step!==void 0)){const onKeyDown=__name(()=>this.getElement().step=step.attributeValue,"onKeyDown"),resetStep=__name(()=>this.getElement().step=this._step.attributeValue,"resetStep");this._keyboardStep={step,onKeyDown,onKeyUp:resetStep,onBlur:resetStep},this.addListener("keydown",this._keyboardStep.onKeyDown),this.addListener("keyup",this._keyboardStep.onKeyUp),this.addListener("blur",this._keyboardStep.onBlur)}}get orientation(){return getAttribute(this.elem,"aria-orientation")??"both"}set orientation(orientation){setAttribute(this.elem,"aria-orientation",orientation!=="both"?orientation:void 0),_a69.registerDefaultPreventers(this,orientation)}destructor(){}clampValueRatio(clampMin,clampMax){const ratio5=this.getValueRatio(),clampedRatio=clamp(clampMin,ratio5,clampMax);return clampedRatio!==ratio5&&this.setValueRatio(clampedRatio),clampedRatio}setValueRatio(ratio5,opts){const{divider}=this.step,value=Math.round(ratio5*1e4)/divider,{ariaValueText=formatPercent(value/divider)}=opts??{},elem=this.getElement();elem.value=`${value}`,elem.ariaValueText=ariaValueText}getValueRatio(){return parseFloat(this.getElement().value)/this.step.divider}static registerDefaultPreventers(target,orientation){orientation==="both"?target.removeListener("keydown",_a69.onKeyDown):target.addListener("keydown",_a69.onKeyDown)}static onKeyDown(ev,current){let ignoredKeys=[];const{orientation}=current;orientation==="horizontal"?ignoredKeys=["ArrowUp","ArrowDown"]:orientation==="vertical"&&(ignoredKeys=["ArrowLeft","ArrowRight"]),ignoredKeys.includes(ev.sourceEvent.code)&&ev.sourceEvent.preventDefault()}},__name(_a69,"_SliderWidget"),_a69);_SliderWidget.STEP_ONE={attributeValue:"1",divider:1};_SliderWidget.STEP_HUNDRETH={attributeValue:"0.01",divider:100};var SliderWidget=_SliderWidget,_a70,SwitchWidget=(_a70=class extends ButtonWidget{constructor(){super(),setAttribute(this.elem,"role","switch"),this.setChecked(!1)}setChecked(checked){setAttribute(this.elem,"aria-checked",checked)}},__name(_a70,"SwitchWidget"),_a70),_a71,ToolbarWidget=(_a71=class extends RovingTabContainerWidget{constructor(orientation="horizontal"){super(orientation,"toolbar")}destructor(){}},__name(_a71,"ToolbarWidget"),_a71);function checkType(type,meta){var _a294;return((_a294=meta.params)==null?void 0:_a294.type)===type}__name(checkType,"checkType");function allocateResult(type){if(type==="button")return new ButtonWidget;if(type==="slider")return new SliderWidget;if(type==="toolbar")return new ToolbarWidget;if(type==="group")return new GroupWidget;if(type==="list")return new ListWidget;if(type==="region")return new NativeWidget(createElement("div"));if(type==="text")return new BoundedTextWidget;if(type==="listswitch")return new SwitchWidget;throw Error("AG Charts - error allocating meta")}__name(allocateResult,"allocateResult");function allocateMeta(params){const meta={params,result:void 0};return meta.result=allocateResult(meta.params.type),meta}__name(allocateMeta,"allocateMeta");var _a72,ProxyInteractionService=(_a72=class{constructor(localeManager,domManager){this.localeManager=localeManager,this.domManager=domManager,this.destroyFns=[]}destroy(){this.destroyFns.forEach(fn=>fn())}addLocalisation(fn){fn(),this.destroyFns.push(this.localeManager.addListener("locale-changed",fn))}createProxyContainer(args){const meta=allocateMeta(args),{params,result}=meta,div=result.getElement();return this.domManager.addChild("canvas-proxy",params.domManagerId,div),div.classList.add(...params.classList,"ag-charts-proxy-container"),div.role=params.type,"ariaOrientation"in params&&(div.ariaOrientation=params.ariaOrientation),checkType("toolbar",meta)&&(meta.result.orientation=meta.params.orientation),this.addLocalisation(()=>{div.ariaLabel=this.localeManager.t(params.ariaLabel.id,params.ariaLabel.params)}),result}createProxyElement(args){const meta=allocateMeta(args);if(checkType("button",meta)){const{params,result}=meta,button=result.getElement();if(this.initInteract(params,result),typeof params.textContent=="string")button.textContent=params.textContent;else{const{textContent}=params;this.addLocalisation(()=>{button.textContent=this.localeManager.t(textContent.id,textContent.params)})}this.setParent(meta.params,meta.result)}if(checkType("slider",meta)){const{params,result}=meta,slider=result.getElement();this.initInteract(params,result),slider.type="range",slider.role="presentation",slider.style.margin="0px",this.addLocalisation(()=>{slider.ariaLabel=this.localeManager.t(params.ariaLabel.id,params.ariaLabel.params)}),this.setParent(meta.params,meta.result)}if(checkType("text",meta)){const{params,result}=meta;this.initElement(params,result),this.setParent(meta.params,meta.result)}if(checkType("listswitch",meta)){const{params,result:button}=meta;this.initInteract(params,button),button.setTextContent(params.textContent),button.setChecked(params.ariaChecked),button.setAriaDescribedBy(params.ariaDescribedBy),this.setParent(meta.params,meta.result)}if(checkType("region",meta)){const{params,result}=meta,region=result.getElement();this.initInteract(params,result),region.role="region",this.setParent(meta.params,meta.result)}return meta.result}initElement(params,widget){const element2=widget.getElement();return setAttribute(element2,"id",params.id),setElementStyle(element2,"cursor",params.cursor),element2.classList.toggle("ag-charts-proxy-elem",!0),element2}initInteract(params,widget){const{tabIndex,domIndex}=params,element2=this.initElement(params,widget);tabIndex!==void 0&&(element2.tabIndex=tabIndex),domIndex!==void 0&&(widget.domIndex=domIndex)}setParent(params,element2){var _a294;if("parent"in params)(_a294=params.parent)==null||_a294.addChild(element2);else{const insert={where:params.where,query:".ag-charts-series-area"};this.domManager.addChild("canvas-proxy",params.domManagerId,element2.getElement(),insert)}}},__name(_a72,"ProxyInteractionService"),_a72),AG_CHARTS_LOCALE_EN_US={ariaAnnounceHoverDatum:"${datum}",ariaAnnounceChart:"chart, ${seriesCount}[number] series",ariaAnnounceHierarchyChart:"hierarchy chart, ${caption}",ariaAnnounceGaugeChart:"gauge chart, ${caption}",ariaAnnounceHierarchyDatum:"level ${level}[number], ${count}[number] children, ${description}",ariaAnnounceFlowProportionLink:"link ${index} of ${count}, from ${from} to ${to}, ${sizeName} ${size}",ariaAnnounceFlowProportionNode:"node ${index} of ${count}, ${description}",ariaDescriptionLegendItem:"Press Space or Enter to toggle visibility",ariaLabelAddHorizontalLine:"Add Horizontal Line",ariaLabelAnnotationOptionsToolbar:"Annotation Options",ariaLabelAnnotationSettingsDialog:"Annotation Settings",ariaLabelColorPicker:"Color picker",ariaLabelFinancialCharts:"Financial Charts",ariaLabelLegend:"Legend",ariaLabelLegendPagination:"Legend Pagination",ariaLabelLegendPagePrevious:"Previous Legend Page",ariaLabelLegendPageNext:"Next Legend Page",ariaLabelLegendItem:"${label}, Legend item ${index}[number] of ${count}[number]",ariaLabelLegendItemUnknown:"Unknown legend item",ariaLabelNavigator:"Navigator",ariaLabelNavigatorRange:"Range",ariaLabelNavigatorMinimum:"Minimum",ariaLabelNavigatorMaximum:"Maximum",ariaLabelRangesToolbar:"Ranges",ariaLabelSettingsTabBar:"Settings",ariaLabelZoomToolbar:"Zoom",ariaValuePanRange:"${min}[percent0to2dp] to ${max}[percent0to2dp]",iconAltTextLineStyleSolid:"Solid",iconAltTextLineStyleDashed:"Long-dashed",iconAltTextLineStyleDotted:"Short-dashed",iconAltTextPositionTop:"Top",iconAltTextPositionCenter:"Center",iconAltTextPositionBottom:"Bottom",iconAltTextAlignLeft:"Left",iconAltTextAlignCenter:"Center",iconAltTextAlignRight:"Right",iconAltTextClose:"Close",overlayLoadingData:"Loading data...",overlayNoData:"No data to display",overlayNoVisibleSeries:"No visible series",overlayUnsupportedBrowser:"Incompatible browser version. Please upgrade your browser.",seriesHistogramTooltipFrequency:"Frequency",seriesHistogramTooltipSum:"${yName} (sum)",seriesHistogramTooltipCount:"${yName} (count)",seriesHistogramTooltipMean:"${yName} (mean)",toolbarSeriesTypeDropdown:"Chart Type",toolbarSeriesTypeOHLC:"OHLC",toolbarSeriesTypeHLC:"HLC",toolbarSeriesTypeHighLow:"High Low",toolbarSeriesTypeCandles:"Candles",toolbarSeriesTypeHollowCandles:"Hollow Candles",toolbarSeriesTypeLine:"Line",toolbarSeriesTypeLineWithMarkers:"Line with Markers",toolbarSeriesTypeStepLine:"Step Line",toolbarAnnotationsTrendLine:"Trend Line",toolbarAnnotationsFibonacciRetracement:"Fib Retracement",toolbarAnnotationsFibonacciRetracementTrendBased:"Fib Trend Based",toolbarAnnotationsHorizontalLine:"Horizontal Line",toolbarAnnotationsVerticalLine:"Vertical Line",toolbarAnnotationsParallelChannel:"Parallel Channel",toolbarAnnotationsDisjointChannel:"Disjoint Channel",toolbarAnnotationsClearAll:"Clear All",toolbarAnnotationsFillColor:"Fill Color",toolbarAnnotationsLineColor:"Line Color",toolbarAnnotationsLineStyle:"Line Style",toolbarAnnotationsLineStrokeWidth:"Line Stroke Width",toolbarAnnotationsSettings:"Settings",toolbarAnnotationsTextColor:"Text Color",toolbarAnnotationsTextSize:"Text Size",toolbarAnnotationsLock:"Lock",toolbarAnnotationsUnlock:"Unlock",toolbarAnnotationsDelete:"Delete",toolbarAnnotationsDragHandle:"Drag Toolbar",toolbarAnnotationsLineAnnotations:"Trend Lines",toolbarAnnotationsFibonacciAnnotations:"Fibonacci",toolbarAnnotationsTextAnnotations:"Text Annotations",toolbarAnnotationsShapeAnnotations:"Arrows",toolbarAnnotationsMeasurerAnnotations:"Measurers",toolbarAnnotationsCallout:"Callout",toolbarAnnotationsComment:"Comment",toolbarAnnotationsNote:"Note",toolbarAnnotationsText:"Text",toolbarAnnotationsArrow:"Arrow",toolbarAnnotationsArrowUp:"Arrow Up",toolbarAnnotationsArrowDown:"Arrow Down",toolbarAnnotationsDateRange:"Date Range",toolbarAnnotationsPriceRange:"Price Range",toolbarAnnotationsDatePriceRange:"Date and Price",toolbarAnnotationsQuickDatePriceRange:"Measure",toolbarRange1Month:"1M",toolbarRange1MonthAria:"1 month",toolbarRange3Months:"3M",toolbarRange3MonthsAria:"3 months",toolbarRange6Months:"6M",toolbarRange6MonthsAria:"6 months",toolbarRangeYearToDate:"YTD",toolbarRangeYearToDateAria:"Year to date",toolbarRange1Year:"1Y",toolbarRange1YearAria:"1 year",toolbarRangeAll:"All",toolbarRangeAllAria:"All",toolbarZoomZoomOut:"Zoom out",toolbarZoomZoomIn:"Zoom in",toolbarZoomPanLeft:"Pan left",toolbarZoomPanRight:"Pan right",toolbarZoomPanStart:"Pan to the start",toolbarZoomPanEnd:"Pan to the end",toolbarZoomReset:"Reset the zoom",contextMenuDownload:"Download",contextMenuToggleSeriesVisibility:"Toggle Visibility",contextMenuToggleOtherSeries:"Toggle Other Series",contextMenuZoomToCursor:"Zoom to here",contextMenuPanToCursor:"Pan to here",dialogHeaderChannel:"Channel",dialogHeaderLine:"Line",dialogHeaderFibonacciRange:"Fib Retracement",dialogHeaderDateRange:"Date Range",dialogHeaderPriceRange:"Price Range",dialogHeaderDatePriceRange:"Date and Price",dialogHeaderText:"Text",dialogInputAlign:"Align",dialogInputColorPicker:"Color",dialogInputColorPickerAltText:"Text Color",dialogInputFillColorPicker:"Fill",dialogInputFillColorPickerAltText:"Fill Color",dialogInputExtendChannelStart:"Extend channel start",dialogInputExtendChannelEnd:"Extend channel end",dialogInputExtendLineStart:"Extend line start",dialogInputExtendLineEnd:"Extend line end",dialogInputExtendAbove:"Extend above",dialogInputExtendBelow:"Extend below",dialogInputExtendLeft:"Extend left",dialogInputExtendRight:"Extend right",dialogInputReverse:"Reverse",dialogInputShowFill:"Show Fill",dialogInputFontSize:"Size",dialogInputFontSizeAltText:"Font Size",dialogInputLineStyle:"Dash",dialogInputPosition:"Position",dialogInputStrokeWidth:"Weight",dialogInputStrokeWidthAltText:"Line Weight",dialogInputFibonacciBands:"Bands",dialogInputFibonacciBandsAltText:"Fibonacci Bands",inputTextareaPlaceholder:"Add Text",measurerDateRangeBars:"${value}[number] bars",measurerPriceRangeValue:"${value}[number]",measurerPriceRangePercent:"${value}[percent]",measurerVolume:"Vol ${value}",tooltipPaginationStatus:"${index}[number] of ${count}[number]"},messageRegExp=/\$\{(\w+)}(?:\[(\w+)])?/gi,formatters={number:new Intl.NumberFormat("en-US"),percent:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),percent0to2dp:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}),date:new Intl.DateTimeFormat("en-US",{dateStyle:"full"}),time:new Intl.DateTimeFormat("en-US",{timeStyle:"full"}),datetime:new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"full"})},defaultMessageFormatter=__name(({defaultValue,variables})=>defaultValue==null?void 0:defaultValue.replaceAll(messageRegExp,(_,match,format)=>{const value=variables[match],formatter=format!=null?formatters[format]:null;return format!=null&&formatter==null&&logger_exports.warnOnce(`Format style [${format}] is not supported`),formatter!=null?formatter.format(value):typeof value=="number"?formatters.number.format(value):value instanceof Date?formatters.datetime.format(value):String(value)}),"defaultMessageFormatter"),_a73,LocaleManager=(_a73=class extends Listeners{constructor(){super(...arguments),this.localeText=void 0,this.getLocaleText=void 0}setLocaleText(localeText){this.localeText!==localeText&&(this.localeText=localeText,this.dispatch("locale-changed"))}setLocaleTextFormatter(getLocaleText){this.getLocaleText=getLocaleText,this.getLocaleText!==getLocaleText&&(this.getLocaleText=getLocaleText,this.dispatch("locale-changed"))}t(key,variables={}){const{localeText=AG_CHARTS_LOCALE_EN_US,getLocaleText}=this,defaultValue=localeText[key];return(getLocaleText==null?void 0:getLocaleText({key,defaultValue,variables}))??defaultMessageFormatter({defaultValue,variables})??key}},__name(_a73,"LocaleManager"),_a73),_a74,HdpiCanvas=(_a74=class{constructor(options){this.enabled=!0,this.width=600,this.height=300;const{width:width2,height:height2,canvasElement,willReadFrequently=!1}=options;this.pixelRatio=options.pixelRatio??getWindow("devicePixelRatio")??1,this.element=canvasElement??createElement("canvas"),this.element.style.display="block",this.element.style.width=(width2??this.width)+"px",this.element.style.height=(height2??this.height)+"px",this.element.width=Math.round((width2??this.width)*this.pixelRatio),this.element.height=Math.round((height2??this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently}),this.onEnabledChange(),this.resize(width2??0,height2??0,this.pixelRatio),debugContext(this.context)}drawImage(context,dx=0,dy=0){return context.drawImage(this.context.canvas,dx,dy)}toDataURL(type){return this.element.toDataURL(type)}resize(width2,height2,pixelRatio){if(!(width2>0&&height2>0))return;const{element:element2,context}=this;element2.width=Math.round(width2*pixelRatio),element2.height=Math.round(height2*pixelRatio),context.setTransform(pixelRatio,0,0,pixelRatio,0,0),element2.style.width=width2+"px",element2.style.height=height2+"px",this.width=width2,this.height=height2,this.pixelRatio=pixelRatio}clear(){clearContext(this)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}},__name(_a74,"HdpiCanvas"),_a74);__decorateClass([ObserveChanges(target=>target.onEnabledChange())],HdpiCanvas.prototype,"enabled",2);var _a75,LayersManager=(_a75=class{constructor(canvas){this.canvas=canvas,this.debug=Debug.create(!0,"scene"),this.layersMap=new Map,this.nextLayerId=0}get size(){return this.layersMap.size}resize(width2,height2,pixelRatio){this.canvas.resize(width2,height2,pixelRatio),this.layersMap.forEach(({canvas})=>canvas.resize(width2,height2,pixelRatio))}addLayer(opts){const{width:width2,height:height2,pixelRatio}=this.canvas,{name}=opts,canvas=new HdpiOffscreenCanvas({width:width2,height:height2,pixelRatio});return this.layersMap.set(canvas,{id:this.nextLayerId++,name,canvas}),this.debug("Scene.addLayer() - layers",this.layersMap),canvas}removeLayer(canvas){this.layersMap.has(canvas)&&(this.layersMap.delete(canvas),canvas.destroy(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}clear(){for(const layer of this.layersMap.values())layer.canvas.destroy();this.layersMap.clear()}},__name(_a75,"LayersManager"),_a75);function formatBytes(value){for(const unit of["B","KB","MB","GB"]){if(value<1536)return`${value.toFixed(1)}${unit}`;value/=1024}return`${value.toFixed(1)}TB}`}__name(formatBytes,"formatBytes");function memoryUsage(){if(!("memory"in performance))return;const{totalJSHeapSize,usedJSHeapSize,jsHeapSizeLimit}=performance.memory,result=[];for(const amount of[usedJSHeapSize,totalJSHeapSize,jsHeapSizeLimit])typeof amount=="number"&&result.push(formatBytes(amount));return`Heap ${result.join(" / ")}`}__name(memoryUsage,"memoryUsage");function debugStats(layersManager,debugSplitTimes,ctx,renderCtxStats,extraDebugStats={},seriesRect=BBox.zero){if(!Debug.check("scene:stats","scene:stats:verbose"))return;const{layersRendered=0,layersSkipped=0,nodesRendered=0,nodesSkipped=0,opsPerformed=0,opsSkipped=0}=renderCtxStats??{},end2=performance.now(),{start:start2,...durations}=debugSplitTimes,splits=Object.entries(durations).map(([n,t])=>time(n,t)).filter(v=>v!=null).join(" + "),extras=Object.entries(extraDebugStats).map(([k,v])=>`${k}: ${JSON.stringify(v)}`).join(" ; "),detailedStats=Debug.check("scene:stats:verbose"),memUsage=memoryUsage(),stats=[`${time("",start2,end2)} (${splits})`,`${extras}`,`Layers: ${detailedStats?pct(layersRendered,layersSkipped):layersManager.size}`,detailedStats?`Nodes: ${pct(nodesRendered,nodesSkipped)}`:null,detailedStats?`Ops: ${pct(opsPerformed,opsSkipped)}`:null,detailedStats&&memUsage?memUsage:null].filter(isString),measurer2=new SimpleTextMeasurer(t=>ctx.measureText(t)),statsSize=new Map(stats.map(t=>[t,measurer2.measureLines(t)])),width2=Math.max(...Array.from(statsSize.values(),s=>s.width)),height2=accumulate(statsSize.values(),s=>s.height),x=2+seriesRect.x;ctx.save(),ctx.fillStyle="white",ctx.fillRect(x,0,width2,height2),ctx.fillStyle="black";let y=0;for(const[stat,size]of statsSize.entries())y+=size.height,ctx.fillText(stat,x,y);ctx.restore()}__name(debugStats,"debugStats");function prepareSceneNodeHighlight(ctx){const config=toArray(getWindow("agChartsSceneDebug")),result=[];for(const name of config)name==="layout"?result.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):result.push(name);ctx.debugNodeSearch=result}__name(prepareSceneNodeHighlight,"prepareSceneNodeHighlight");function debugSceneNodeHighlight(ctx,debugNodes){ctx.save();for(const[name,node]of Object.entries(debugNodes)){const bbox=Transformable.toCanvas(node);if(!bbox){logger_exports.log(`Scene.render() - no bbox for debugged node [${name}].`);continue}ctx.globalAlpha=.8,ctx.strokeStyle="red",ctx.lineWidth=1,ctx.strokeRect(bbox.x,bbox.y,bbox.width,bbox.height),ctx.fillStyle="red",ctx.strokeStyle="white",ctx.font="16px sans-serif",ctx.textBaseline="top",ctx.textAlign="left",ctx.lineWidth=2,ctx.strokeText(name,bbox.x,bbox.y,bbox.width),ctx.fillText(name,bbox.x,bbox.y,bbox.width)}ctx.restore()}__name(debugSceneNodeHighlight,"debugSceneNodeHighlight");var skippedProperties=new Set,allowedProperties=new Set(["gradient","zIndex","clipRect","cachedBBox","childNodeCounts","path","__zIndex","name","__scalingCenterX","__scalingCenterY","__rotationCenterX","__rotationCenterY","_previousDatum","__fill","__lineDash","borderPath","borderClipPath","_clipPath"]);function nodeProps(node){const{...allProps}=node;for(const prop of Object.keys(allProps))allowedProperties.has(prop)||typeof allProps[prop]!="number"&&typeof allProps[prop]!="string"&&typeof allProps[prop]!="boolean"&&(skippedProperties.add(prop),delete allProps[prop]);return allProps}__name(nodeProps,"nodeProps");function buildTree(node,mode){if(!Debug.check(!0,"scene"))return{};let order=0;return{node:mode==="json"?nodeProps(node):node,name:node.name??node.id,dirty:node.dirty,...Array.from(node.children(),c=>buildTree(c,mode)).reduce((result,childTree)=>{let{name:treeNodeName}=childTree;const{node:{visible,opacity,zIndex,translationX,translationY,rotation,scalingX,scalingY},node:childNode}=childTree;(!visible||opacity<=0)&&(treeNodeName=`(${treeNodeName})`),Group.is(childNode)&&childNode.renderToOffscreenCanvas&&(treeNodeName=`*${treeNodeName}*`);const zIndexString=Array.isArray(zIndex)?`(${zIndex.join(", ")})`:zIndex,key=[`${(order++).toString().padStart(3,"0")}|`,`${treeNodeName??"<unknown>"}`,`z: ${zIndexString}`,translationX&&`x: ${translationX}`,translationY&&`y: ${translationY}`,rotation&&`r: ${rotation}`,scalingX!=null&&scalingX!==1&&`sx: ${scalingX}`,scalingY!=null&&scalingY!==1&&`sy: ${scalingY}`].filter(v=>!!v).join(" ");let selectedKey=key,index=1;for(;result[selectedKey]!=null&&index<100;)selectedKey=`${key} (${index++})`;return result[selectedKey]=childTree,result},{})}}__name(buildTree,"buildTree");function buildDirtyTree(node){if(!node.dirty)return{dirtyTree:{},paths:[]};const childrenDirtyTree=Array.from(node.children(),c=>buildDirtyTree(c)).filter(c=>c.paths.length>0),name=Group.is(node)?node.name??node.id:node.id,paths=childrenDirtyTree.length?childrenDirtyTree.flatMap(c=>c.paths).map(p=>`${name}.${p}`):[name];return{dirtyTree:{name,node,dirty:node.dirty,...childrenDirtyTree.map(c=>c.dirtyTree).filter(t=>t.dirty!=null).reduce((result,childTree)=>(result[childTree.name??"<unknown>"]=childTree,result),{})},paths}}__name(buildDirtyTree,"buildDirtyTree");function pct(rendered,skipped){const total=rendered+skipped;return`${rendered} / ${total} (${Math.round(100*rendered/total)}%)`}__name(pct,"pct");function time(name,start2,end2){const duration=end2!=null?end2-start2:start2;return`${name}: ${Math.round(duration*100)/100}ms`}__name(time,"time");function accumulate(iterator,mapper){let sum2=0;for(const item of iterator)sum2+=mapper(item);return sum2}__name(accumulate,"accumulate");var _a76,Scene=(_a76=class{constructor(canvasOptions){this.debug=Debug.create(!0,"scene"),this.id=createId(this),this.root=null,this.pendingSize=null,this.isDirty=!1,this.updateDebugFlags(),this.canvas=new HdpiCanvas(canvasOptions),this.layersManager=new LayersManager(this.canvas)}get width(){var _a294;return((_a294=this.pendingSize)==null?void 0:_a294[0])??this.canvas.width}get height(){var _a294;return((_a294=this.pendingSize)==null?void 0:_a294[1])??this.canvas.height}get pixelRatio(){var _a294;return((_a294=this.pendingSize)==null?void 0:_a294[2])??this.canvas.pixelRatio}setContainer(value){var _a294;const{element:element2}=this.canvas;return(_a294=element2.parentElement)==null||_a294.removeChild(element2),value.appendChild(element2),this}setRoot(node){var _a294;return this.root===node?this:(this.isDirty=!0,(_a294=this.root)==null||_a294._setLayerManager(),this.root=node,node&&(node.visible=!0,node._setLayerManager(this.layersManager)),this)}updateDebugFlags(){Debug.inDevelopmentMode(()=>Node._debugEnabled=!0)}clear(){this.canvas.clear()}attachNode(node){return this.appendChild(node),()=>this.removeChild(node)}appendChild(node){var _a294;return(_a294=this.root)==null||_a294.appendChild(node),this}removeChild(node){var _a294;return(_a294=this.root)==null||_a294.removeChild(node),this}download(fileName,fileFormat){downloadUrl(this.canvas.toDataURL(fileFormat),(fileName==null?void 0:fileName.trim())??"image")}getDataURL(fileFormat){return this.canvas.toDataURL(fileFormat)}resize(width2,height2,pixelRatio){return width2=Math.round(width2),height2=Math.round(height2),pixelRatio??(pixelRatio=this.pixelRatio),width2>0&&height2>0&&(width2!==this.width||height2!==this.height||pixelRatio!==this.pixelRatio)?(this.pendingSize=[width2,height2,pixelRatio],this.isDirty=!0,!0):!1}render(opts){var _a294;const{debugSplitTimes={start:performance.now()},extraDebugStats,seriesRect}=opts??{},{canvas,canvas:{context:ctx}={},root,pendingSize,width:width2,height:height2,pixelRatio:devicePixelRatio}=this;if(!ctx)return;const renderStartTime=performance.now();let resized=!1;if(pendingSize&&(resized=!0,this.layersManager.resize(...pendingSize),this.pendingSize=null),root&&!root.visible){this.isDirty=!1;return}if((root==null?void 0:root.dirty)===!1&&!this.isDirty){this.debug.check()&&this.debug("Scene.render() - no-op",{tree:buildTree(root,"console")}),debugStats(this.layersManager,debugSplitTimes,ctx,void 0,extraDebugStats,seriesRect);return}const renderCtx={ctx,width:width2,height:height2,devicePixelRatio,debugNodes:{}};Debug.check("scene:stats:verbose")&&(renderCtx.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0,opsPerformed:0,opsSkipped:0}),prepareSceneNodeHighlight(renderCtx);let canvasCleared=!1;if(((root==null?void 0:root.dirty)!==!1||resized)&&(canvasCleared=!0,canvas.clear()),root&&Debug.check("scene:dirtyTree")){const{dirtyTree,paths}=buildDirtyTree(root);Debug.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree,paths})}if(root&&canvasCleared){if(root.visible&&root.preRender(renderCtx),this.debug.check()){const tree=buildTree(root,"console");this.debug("Scene.render() - before",{canvasCleared,tree})}root.visible&&(ctx.save(),root.render(renderCtx),ctx.restore())}debugSplitTimes[""]=performance.now()-renderStartTime,(_a294=ctx.verifyDepthZero)==null||_a294.call(ctx),this.isDirty=!1,debugStats(this.layersManager,debugSplitTimes,ctx,renderCtx.stats,extraDebugStats,seriesRect),debugSceneNodeHighlight(ctx,renderCtx.debugNodes),root&&this.debug.check()&&this.debug("Scene.render() - after",{tree:buildTree(root,"console"),canvasCleared})}toSVG(){const{root,width:width2,height:height2}=this;if(root!=null)return Node.toSVG(root,width2,height2)}strip(){const{context,pixelRatio}=this.canvas;context.setTransform(pixelRatio,0,0,pixelRatio,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1}destroy(){this.strip(),this.canvas.destroy(),Object.assign(this,{canvas:void 0})}},__name(_a76,"Scene"),_a76);Scene.className="Scene";function needsContext(caller,_params){return"context"in caller}__name(needsContext,"needsContext");function callWithContext(caller,fn,params){return needsContext(caller)&&params[0]!=null&&typeof params[0]=="object"&&(params[0].context=caller.context),fn(...params)}__name(callWithContext,"callWithContext");var _a77,CallbackCache=(_a77=class{constructor(){this.cache=new WeakMap}call(caller,fn,...params){let serialisedParams,paramCache=this.cache.get(fn);try{serialisedParams=JSON.stringify(params)}catch{return this.invoke(caller,fn,params,paramCache)}return paramCache==null&&(paramCache=new Map,this.cache.set(fn,paramCache)),paramCache.has(serialisedParams)?paramCache.get(serialisedParams):this.invoke(caller,fn,params,paramCache,serialisedParams)}invoke(caller,fn,params,paramCache,serialisedParams){try{const result=callWithContext(caller,fn,params);return paramCache&&serialisedParams!=null&&paramCache.set(serialisedParams,result),result}catch(e){logger_exports.warnOnce("User callback errored, ignoring",e);return}}invalidateCache(){this.cache=new WeakMap}},__name(_a77,"CallbackCache"),_a77),_a78,AnnotationManager=(_a78=class extends BaseManager{constructor(annotationRoot,fireChartEvent){super(),this.annotationRoot=annotationRoot,this.fireChartEvent=fireChartEvent,this.mementoOriginatorKey="annotations",this.annotations=[]}createMemento(){return this.annotations}guardMemento(blob){return blob==null||isArray(blob)}restoreMemento(_version,_mementoVersion,memento){this.annotations=this.cleanData(memento??[]).map(annotation=>{const annotationTheme=this.getAnnotationTypeStyles(annotation.type);return mergeDefaults(annotation,annotationTheme)}),this.listeners.dispatch("restore-annotations",{type:"restore-annotations",annotations:this.annotations})}updateData(annotations){this.annotations=this.cleanData(annotations??[])}fireChangedEvent(){this.fireChartEvent({type:"annotations",annotations:deepClone([...this.annotations])})}attachNode(node){return this.annotationRoot.append(node),()=>{var _a294;return(_a294=this.annotationRoot)==null||_a294.removeChild(node),this}}setAnnotationStyles(styles){this.styles=styles}getAnnotationTypeStyles(type){var _a294;return(_a294=this.styles)==null?void 0:_a294[type]}cleanData(annotations){for(const annotation of annotations)"textAlign"in annotation&&delete annotation.textAlign;return annotations}},__name(_a78,"AnnotationManager"),_a78),ZIndexMap=(ZIndexMap2=>(ZIndexMap2[ZIndexMap2.CHART_BACKGROUND=0]="CHART_BACKGROUND",ZIndexMap2[ZIndexMap2.AXIS_GRID=1]="AXIS_GRID",ZIndexMap2[ZIndexMap2.AXIS=2]="AXIS",ZIndexMap2[ZIndexMap2.ZOOM_SELECTION=3]="ZOOM_SELECTION",ZIndexMap2[ZIndexMap2.SERIES_CROSSLINE_RANGE=4]="SERIES_CROSSLINE_RANGE",ZIndexMap2[ZIndexMap2.SERIES_LAYER=5]="SERIES_LAYER",ZIndexMap2[ZIndexMap2.AXIS_FOREGROUND=6]="AXIS_FOREGROUND",ZIndexMap2[ZIndexMap2.SERIES_CROSSHAIR=7]="SERIES_CROSSHAIR",ZIndexMap2[ZIndexMap2.SERIES_CROSSLINE_LINE=8]="SERIES_CROSSLINE_LINE",ZIndexMap2[ZIndexMap2.SERIES_ANNOTATION=9]="SERIES_ANNOTATION",ZIndexMap2[ZIndexMap2.CHART_ANNOTATION=10]="CHART_ANNOTATION",ZIndexMap2[ZIndexMap2.CHART_ANNOTATION_FOCUSED=11]="CHART_ANNOTATION_FOCUSED",ZIndexMap2[ZIndexMap2.STATUS_BAR=12]="STATUS_BAR",ZIndexMap2[ZIndexMap2.SERIES_LABEL=13]="SERIES_LABEL",ZIndexMap2[ZIndexMap2.LEGEND=14]="LEGEND",ZIndexMap2[ZIndexMap2.NAVIGATOR=15]="NAVIGATOR",ZIndexMap2[ZIndexMap2.FOREGROUND=16]="FOREGROUND",ZIndexMap2))(ZIndexMap||{}),_a79,AxisManager=(_a79=class{constructor(sceneRoot){this.sceneRoot=sceneRoot,this.axes=new Map,this.axisGridGroup=new Group({name:"Axes-Grids",zIndex:1}),this.axisGroup=new Group({name:"Axes",zIndex:2}),this.axisLabelGroup=new Group({name:"Axes-Labels",zIndex:13}),this.axisCrosslineRangeGroup=new Group({name:"Axes-Crosslines-Range",zIndex:4}),this.axisCrosslineLineGroup=new Group({name:"Axes-Crosslines-Line",zIndex:8}),this.axisCrosslineLabelGroup=new Group({name:"Axes-Crosslines-Label",zIndex:13}),this.sceneRoot.appendChild(this.axisGroup),this.sceneRoot.appendChild(this.axisGridGroup),this.sceneRoot.appendChild(this.axisLabelGroup),this.sceneRoot.appendChild(this.axisCrosslineRangeGroup),this.sceneRoot.appendChild(this.axisCrosslineLineGroup),this.sceneRoot.appendChild(this.axisCrosslineLabelGroup)}updateAxes(oldAxes,newAxes){var _a294;const axisNodes={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const axis of oldAxes)newAxes.includes(axis)||(axis.detachAxis(axisNodes),axis.destroy());for(const axis of newAxes)oldAxes!=null&&oldAxes.includes(axis)||axis.attachAxis(axisNodes);this.axes.clear();for(const axis of newAxes){const ctx=axis.createAxisContext();this.axes.has(ctx.direction)?(_a294=this.axes.get(ctx.direction))==null||_a294.push(ctx):this.axes.set(ctx.direction,[ctx])}}getAxisContext(direction){return this.axes.get(direction)??[]}destroy(){this.axes.clear(),this.sceneRoot.removeChild(this.axisGroup),this.sceneRoot.removeChild(this.axisGridGroup)}},__name(_a79,"AxisManager"),_a79),_a80,DataService=(_a80=class extends Listeners{constructor(animationManager){super(),this.animationManager=animationManager,this.dispatchOnlyLatest=!0,this.dispatchThrottle=0,this.requestThrottle=300,this.isLoadingInitialData=!1,this.isLoadingData=!1,this.freshRequests=[],this.requestCounter=0,this.debug=Debug.create(!0,"data-model","data-source"),this.throttledFetch=this.createThrottledFetch(this.requestThrottle),this.throttledDispatch=this.createThrottledDispatch(this.dispatchThrottle)}updateCallback(dataSourceCallback){typeof dataSourceCallback=="function"&&(this.debug("DataService - updated data source callback"),this.dataSourceCallback=dataSourceCallback,this.isLoadingInitialData=!0,this.animationManager.skip(),this.dispatch("data-source-change"))}clearCallback(){this.dataSourceCallback=void 0}load(params){this.isLoadingData=!0,this.throttledFetch(params)}isLazy(){return this.dataSourceCallback!=null}isLoading(){return this.isLazy()&&(this.isLoadingInitialData||this.isLoadingData)}createThrottledFetch(requestThrottle){return throttle(params=>this.fetch(params).catch(e=>logger_exports.error("callback failed",e)),requestThrottle,{leading:!1,trailing:!0})}createThrottledDispatch(dispatchThrottle){return throttle((id,data)=>{this.debug(`DataService - dispatching 'data-load' | ${id}`),this.dispatch("data-load",{type:"data-load",data})},dispatchThrottle,{leading:!0,trailing:!0})}async fetch(params){if(!this.dataSourceCallback)throw new Error("DataService - [dataSource.getData] callback not initialised");const start2=performance.now(),id=this.requestCounter++;this.debug(`DataService - requesting | ${id}`),this.freshRequests.push(id);let response;try{response=await this.dataSourceCallback(params),this.debug(`DataService - response | ${performance.now()-start2}ms | ${id}`)}catch(error){this.debug(`DataService - request failed | ${id}`),logger_exports.errorOnce(`DataService - request failed | [${error}]`)}this.isLoadingInitialData=!1;const requestIndex=this.freshRequests.findIndex(rid=>rid===id);if(requestIndex===-1||this.dispatchOnlyLatest&&requestIndex!==this.freshRequests.length-1){this.debug(`DataService - discarding stale request | ${id}`);return}this.freshRequests=this.freshRequests.slice(requestIndex+1),this.freshRequests.length===0&&(this.isLoadingData=!1),Array.isArray(response)?this.throttledDispatch(id,response):this.dispatch("data-error")}},__name(_a80,"DataService"),_a80);__decorateClass([ActionOnSet({newValue(dispatchThrottle){this.throttledDispatch=this.createThrottledDispatch(dispatchThrottle)}})],DataService.prototype,"dispatchThrottle",2);__decorateClass([ActionOnSet({newValue(requestThrottle){this.throttledFetch=this.createThrottledFetch(requestThrottle)}})],DataService.prototype,"requestThrottle",2);function interpolateNumber(a,b){return d=>Number(a)*(1-d)+Number(b)*d}__name(interpolateNumber,"interpolateNumber");function interpolateColor(a,b){if(typeof a=="string")try{a=Color.fromString(a)}catch{a=Color.fromArray([0,0,0])}if(typeof b=="string")try{b=Color.fromString(b)}catch{b=Color.fromArray([0,0,0])}return d=>Color.mix(a,b,d).toRgbaString()}__name(interpolateColor,"interpolateColor");var easing_exports={};__export(easing_exports,{easeIn:__name(()=>easeIn,"easeIn"),easeInOut:__name(()=>easeInOut,"easeInOut"),easeInOutQuad:__name(()=>easeInOutQuad,"easeInOutQuad"),easeInQuad:__name(()=>easeInQuad,"easeInQuad"),easeOut:__name(()=>easeOut,"easeOut"),easeOutQuad:__name(()=>easeOutQuad,"easeOutQuad"),inverseEaseOut:__name(()=>inverseEaseOut,"inverseEaseOut"),linear:__name(()=>linear,"linear")});var linear=__name(n=>n,"linear"),easeIn=__name(n=>1-Math.cos(n*Math.PI/2),"easeIn"),easeOut=__name(n=>Math.sin(n*Math.PI/2),"easeOut"),easeInOut=__name(n=>-(Math.cos(n*Math.PI)-1)/2,"easeInOut"),easeInQuad=__name(n=>n*n,"easeInQuad"),easeOutQuad=__name(n=>1-(1-n)**2,"easeOutQuad"),easeInOutQuad=__name(n=>n<.5?2*n*n:1-(-2*n+2)**2/2,"easeInOutQuad"),inverseEaseOut=__name(x=>2*Math.asin(x)/Math.PI,"inverseEaseOut"),QUICK_TRANSITION=.2,PHASE_ORDER=["initial","remove","update","add","trailing","end","none"],PHASE_METADATA={initial:{animationDuration:1,animationDelay:0},add:{animationDuration:.25,animationDelay:.75},remove:{animationDuration:.25,animationDelay:0},update:{animationDuration:.5,animationDelay:.25},trailing:{animationDuration:QUICK_TRANSITION,animationDelay:1,skipIfNoEarlierAnimations:!0},end:{animationDelay:1+QUICK_TRANSITION,animationDuration:0,skipIfNoEarlierAnimations:!0},none:{animationDuration:0,animationDelay:0}},RepeatType=(RepeatType2=>(RepeatType2.Loop="loop",RepeatType2.Reverse="reverse",RepeatType2))(RepeatType||{});function isNodeArray(array3){return array3.every(n=>n instanceof Node)}__name(isNodeArray,"isNodeArray");function deconstructSelectionsOrNodes(selectionsOrNodes){return isNodeArray(selectionsOrNodes)?{nodes:selectionsOrNodes,selections:[]}:{nodes:[],selections:selectionsOrNodes}}__name(deconstructSelectionsOrNodes,"deconstructSelectionsOrNodes");function animationValuesEqual(a,b){return a===b?!0:Array.isArray(a)&&Array.isArray(b)?a.length===b.length&&a.every((v,i)=>animationValuesEqual(v,b[i])):isInterpolating(a)&&isInterpolating(b)?a.equals(b):isPlainObject(a)&&isPlainObject(b)?objectsEqualWith(a,b,animationValuesEqual):!1}__name(animationValuesEqual,"animationValuesEqual");var _a81,Animation=(_a81=class{constructor(opts){var _a294,_b,_c;this.isComplete=!1,this.elapsed=0,this.iteration=0,this.isPlaying=!1,this.isReverse=!1,this.id=opts.id,this.groupId=opts.groupId,this.autoplay=opts.autoplay??!0,this.ease=opts.ease??linear,this.phase=opts.phase;const durationProportion=opts.duration??PHASE_METADATA[this.phase].animationDuration;this.duration=durationProportion*opts.defaultDuration,this.delay=(opts.delay??0)*opts.defaultDuration,this.onComplete=opts.onComplete,this.onPlay=opts.onPlay,this.onStop=opts.onStop,this.onUpdate=opts.onUpdate,this.interpolate=this.createInterpolator(opts.from,opts.to),this.from=opts.from,opts.skip===!0&&((_a294=this.onUpdate)==null||_a294.call(this,opts.to,!1,this),(_b=this.onStop)==null||_b.call(this,this),(_c=this.onComplete)==null||_c.call(this,this),this.isComplete=!0),opts.collapsable!==!1&&(this.duration=this.checkCollapse(opts,this.duration))}checkCollapse(opts,calculatedDuration){return animationValuesEqual(opts.from,opts.to)?0:calculatedDuration}play(initialUpdate=!1){var _a294,_b;this.isPlaying||this.isComplete||(this.isPlaying=!0,(_a294=this.onPlay)==null||_a294.call(this,this),this.autoplay&&(this.autoplay=!1,initialUpdate&&((_b=this.onUpdate)==null||_b.call(this,this.from,!0,this))))}stop(){var _a294;this.isPlaying=!1,this.isComplete||(this.isComplete=!0,(_a294=this.onStop)==null||_a294.call(this,this))}update(time2){var _a294,_b;if(this.isComplete)return time2;!this.isPlaying&&this.autoplay&&this.play(!0);const previousElapsed=this.elapsed;if(this.elapsed+=time2,this.delay>this.elapsed)return 0;const value=this.interpolate(this.isReverse?1-this.delta:this.delta);(_a294=this.onUpdate)==null||_a294.call(this,value,!1,this);const totalDuration=this.delay+this.duration;return this.elapsed>=totalDuration?(this.stop(),this.isComplete=!0,(_b=this.onComplete)==null||_b.call(this,this),time2-(totalDuration-previousElapsed)):0}get delta(){return this.ease(clamp(0,(this.elapsed-this.delay)/this.duration,1))}createInterpolator(from3,to){if(typeof to!="object"||isInterpolating(to))return this.interpolateValue(from3,to);const interpolatorEntries=[];for(const key of Object.keys(to)){const interpolator=this.interpolateValue(from3[key],to[key]);interpolator!=null&&interpolatorEntries.push([key,interpolator])}return d=>{const result={};for(const[key,interpolator]of interpolatorEntries)result[key]=interpolator(d);return result}}interpolateValue(a,b){if(!(a==null||b==null)){if(isInterpolating(a))return d=>a[interpolate](b,d);try{switch(typeof a){case"number":return interpolateNumber(a,b);case"string":return interpolateColor(a,b);case"boolean":if(a===b)return()=>a;break;case"object":return()=>a}}catch{}throw new Error(`Unable to interpolate values: ${a}, ${b}`)}}},__name(_a81,"Animation"),_a81),_a82,AnimationBatch=(_a82=class{constructor(maxAnimationTime){this.maxAnimationTime=maxAnimationTime,this.debug=Debug.create(!0,"animation"),this.controllers=new Map,this.stoppedCbs=new Set,this.currentPhase=0,this.phases=new Map(PHASE_ORDER.map(p=>[p,[]])),this.skipAnimations=!1,this.animationTimeConsumed=0,this.isReady=!1}get size(){return this.controllers.size}get consumedTimeMs(){return this.animationTimeConsumed}isActive(){return this.controllers.size>0}getActiveControllers(){return this.phases.get(PHASE_ORDER[this.currentPhase])??[]}checkOverlappingId(id){id!=null&&this.controllers.has(id)&&(this.controllers.get(id).stop(),this.debug(`Skipping animation batch due to update of existing animation: ${id}`),this.skip())}addAnimation(animation){var _a294;if(animation.isComplete)return;if(PHASE_ORDER.indexOf(animation.phase)<this.currentPhase){this.debug("Skipping animation due to being for an earlier phase",animation.id),animation.stop();return}this.controllers.set(animation.id,animation),(_a294=this.phases.get(animation.phase))==null||_a294.push(animation)}removeAnimation(animation){this.controllers.delete(animation.id);const phase=this.phases.get(animation.phase),index=phase==null?void 0:phase.indexOf(animation);index!=null&&index>=0&&(phase==null||phase.splice(index,1))}progress(deltaTime){if(!this.isReady)return;let unusedTime=deltaTime===0?.01:deltaTime;const refresh=__name(()=>{const phase2=PHASE_ORDER[this.currentPhase];return{phaseControllers:[...this.getActiveControllers()],phase:phase2,phaseMeta:PHASE_METADATA[phase2]}},"refresh");let{phase,phaseControllers,phaseMeta}=refresh();const arePhasesComplete=__name(()=>PHASE_ORDER[this.currentPhase]==null,"arePhasesComplete"),progressPhase=__name(()=>{for({phase,phaseControllers,phaseMeta}=refresh();!arePhasesComplete()&&phaseControllers.length===0;)this.currentPhase++,{phase,phaseControllers,phaseMeta}=refresh(),this.debug(`AnimationBatch - phase changing to ${phase}`,{unusedTime},phaseControllers)},"progressPhase"),total=this.controllers.size;this.debug(`AnimationBatch - ${deltaTime}ms; phase ${phase} with ${phaseControllers==null?void 0:phaseControllers.length} of ${total}`);do{const phaseDeltaTime=unusedTime,skipPhase=phaseMeta.skipIfNoEarlierAnimations&&this.animationTimeConsumed===0;let completeCount=0;for(const controller of phaseControllers)skipPhase?controller.stop():unusedTime=Math.min(controller.update(phaseDeltaTime),unusedTime),controller.isComplete&&(completeCount++,this.removeAnimation(controller));this.animationTimeConsumed+=phaseDeltaTime-unusedTime,this.debug(`AnimationBatch - updated ${phaseControllers.length} controllers; ${completeCount} completed`),this.debug(`AnimationBatch - animationTimeConsumed: ${this.animationTimeConsumed}`),progressPhase()}while(unusedTime>0&&!arePhasesComplete());this.animationTimeConsumed>this.maxAnimationTime&&(this.debug("Animation batch exceeded max animation time, skipping",[...this.controllers]),this.stop())}ready(){if(this.isReady)return;this.isReady=!0,this.debug(`AnimationBatch - ready; skipped: ${this.skipAnimations}`,[...this.controllers]);let skipAll=!0;for(const[,controller]of this.controllers)if(controller.duration>0&&PHASE_METADATA[controller.phase].skipIfNoEarlierAnimations!==!0){skipAll=!1;break}if(!skipAll)for(const[,controller]of this.controllers)controller.autoplay&&controller.play(!0)}skip(skip=!0){if(this.skipAnimations===!1&&skip===!0){for(const controller of this.controllers.values())controller.stop();this.controllers.clear()}this.skipAnimations=skip}play(){for(const controller of this.controllers.values())controller.play()}stop(){for(const controller of this.controllers.values())try{controller.stop(),this.removeAnimation(controller)}catch(error){logger_exports.error("Error during animation stop",error)}this.dispatchStopped()}stopByAnimationId(id){if(id!=null&&this.controllers.has(id)){const controller=this.controllers.get(id);controller&&(controller.stop(),this.removeAnimation(controller))}}stopByAnimationGroupId(id){for(const controller of this.controllers.values())controller.groupId===id&&this.stopByAnimationId(controller.id)}dispatchStopped(){this.stoppedCbs.forEach(cb=>cb()),this.stoppedCbs.clear()}isSkipped(){return this.skipAnimations}destroy(){this.stop(),this.controllers.clear()}},__name(_a82,"AnimationBatch"),_a82),InteractionState=(InteractionState2=>(InteractionState2[InteractionState2.Default=32]="Default",InteractionState2[InteractionState2.ZoomDrag=16]="ZoomDrag",InteractionState2[InteractionState2.Annotations=8]="Annotations",InteractionState2[InteractionState2.ContextMenu=4]="ContextMenu",InteractionState2[InteractionState2.Animation=2]="Animation",InteractionState2[InteractionState2.AnnotationsSelected=1]="AnnotationsSelected",InteractionState2[InteractionState2.Clickable=41]="Clickable",InteractionState2[InteractionState2.Focusable=34]="Focusable",InteractionState2[InteractionState2.Keyable=43]="Keyable",InteractionState2[InteractionState2.ContextMenuable=36]="ContextMenuable",InteractionState2[InteractionState2.AnnotationsMoveable=9]="AnnotationsMoveable",InteractionState2[InteractionState2.AnnotationsDraggable=57]="AnnotationsDraggable",InteractionState2[InteractionState2.ZoomDraggable=50]="ZoomDraggable",InteractionState2[InteractionState2.ZoomClickable=34]="ZoomClickable",InteractionState2[InteractionState2.ZoomWheelable=59]="ZoomWheelable",InteractionState2[InteractionState2.All=63]="All",InteractionState2))(InteractionState||{}),_a83,InteractionManager=(_a83=class{constructor(){this.stateQueue=34}pushState(state){this.stateQueue|=state}popState(state){this.stateQueue&=~state}isState(allowedStates){return!!(this.stateQueue&-this.stateQueue&allowedStates)}},__name(_a83,"InteractionManager"),_a83);function validAnimationDuration(testee){return testee==null?!0:!isNaN(testee)&&testee>=0&&testee<=2}__name(validAnimationDuration,"validAnimationDuration");var _a84,AnimationManager=(_a84=class{constructor(interactionManager,chartUpdateMutex){this.interactionManager=interactionManager,this.chartUpdateMutex=chartUpdateMutex,this.defaultDuration=1e3,this.batch=new AnimationBatch(this.defaultDuration*1.5),this.debug=Debug.create(!0,"animation"),this.events=new EventEmitter,this.rafAvailable=typeof requestAnimationFrame<"u",this.isPlaying=!0,this.requestId=null,this.skipAnimations=!0,this.currentAnonymousAnimationId=0}addListener(eventName,listener){return this.events.on(eventName,listener)}animate(opts){const batch=this.batch;try{batch.checkOverlappingId(opts.id)}catch(error){this.failsafeOnError(error);return}let{id}=opts;id==null&&(id=`__${this.currentAnonymousAnimationId}`,this.currentAnonymousAnimationId+=1);const skip=this.isSkipped()||opts.phase==="none";skip&&this.debug("AnimationManager - skipping animation");const{delay,duration}=opts;if(!validAnimationDuration(delay))throw new Error(`Animation delay of ${delay} is unsupported (${id})`);if(!validAnimationDuration(duration))throw new Error(`Animation duration of ${duration} is unsupported (${id})`);const animation=new Animation({...opts,id,skip,autoplay:this.isPlaying?opts.autoplay:!1,phase:opts.phase,defaultDuration:this.defaultDuration});if(!this.forceTimeJump(animation,this.defaultDuration))return this.batch.addAnimation(animation),animation}play(){if(!this.isPlaying){this.isPlaying=!0,this.debug("AnimationManager.play()");try{this.batch.play()}catch(error){this.failsafeOnError(error)}this.requestAnimation()}}stop(){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.stop()"),this.batch.stop()}stopByAnimationId(id){try{this.batch.stopByAnimationId(id)}catch(error){this.failsafeOnError(error)}}stopByAnimationGroupId(id){try{this.batch.stopByAnimationGroupId(id)}catch(error){this.failsafeOnError(error)}}reset(){this.isPlaying?(this.stop(),this.play()):this.stop()}skip(skip=!0){this.skipAnimations=skip}isSkipped(){return!this.rafAvailable||this.skipAnimations||this.batch.isSkipped()}isActive(){return this.isPlaying&&this.batch.isActive()}skipCurrentBatch(){this.debug.check()&&this.debug("AnimationManager - skipCurrentBatch()",{stack:new Error().stack}),this.batch.skip()}isSkippingFrames(){return!0}scheduleAnimationFrame(cb){this.requestId=getWindow().requestAnimationFrame(t=>{cb(t).catch(e=>logger_exports.error(e))})}forceTimeJump(_animation,_defaultDuration){return!1}requestAnimation(){if(!this.rafAvailable||!this.batch.isActive()||this.requestId!==null)return;let prevTime;const onAnimationFrame=__name(async time2=>{const executeAnimationFrame=__name(()=>{const deltaTime=time2-(prevTime??time2);prevTime=time2,this.debug("AnimationManager - onAnimationFrame()",{controllersCount:this.batch.size,deltaTime}),this.interactionManager.pushState(2);try{this.batch.progress(deltaTime)}catch(error){this.failsafeOnError(error)}this.events.emit("animation-frame",{type:"animation-frame",deltaMs:deltaTime})},"executeAnimationFrame");this.isSkippingFrames()?await this.chartUpdateMutex.acquireImmediately(executeAnimationFrame):await this.chartUpdateMutex.acquire(executeAnimationFrame),this.batch.isActive()?this.scheduleAnimationFrame(onAnimationFrame):(this.batch.stop(),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}))},"onAnimationFrame");this.events.emit("animation-start",{type:"animation-start",deltaMs:0}),this.scheduleAnimationFrame(onAnimationFrame)}cancelAnimation(){this.requestId!==null&&(cancelAnimationFrame(this.requestId),this.requestId=null,this.startBatch())}failsafeOnError(error,cancelAnimation=!0){logger_exports.error("Error during animation, skipping animations",error),cancelAnimation&&this.cancelAnimation()}startBatch(skipAnimations){this.debug(`AnimationManager - startBatch() with skipAnimations=${skipAnimations}.`),this.reset(),this.batch.destroy(),this.batch=new AnimationBatch(this.defaultDuration*1.5),skipAnimations===!0&&this.batch.skip()}endBatch(){this.batch.isActive()?(this.batch.ready(),this.requestAnimation()):(this.interactionManager.popState(2),this.batch.isSkipped()&&this.batch.skip(!1))}onBatchStop(cb){this.batch.stoppedCbs.add(cb)}destroy(){this.stop(),this.events.clear()}},__name(_a84,"AnimationManager"),_a84),_a85,ChartEventManager=(_a85=class extends BaseManager{seriesEvent(type){this.listeners.dispatch(type,{type})}seriesKeyNavZoom(delta3,widgetEvent){const event={type:"series-keynav-zoom",delta:delta3,widgetEvent};this.listeners.dispatch("series-keynav-zoom",event)}legendItemClick(legendType,series,itemId,enabled,legendItemName){const event={type:"legend-item-click",legendType,series,itemId,enabled,legendItemName};this.listeners.dispatch("legend-item-click",event)}legendItemDoubleClick(legendType,series,itemId,enabled,numVisibleItems,legendItemName){const event={type:"legend-item-double-click",legendType,series,itemId,enabled,legendItemName,numVisibleItems};this.listeners.dispatch("legend-item-double-click",event)}},__name(_a85,"ChartEventManager"),_a85),_a86,ContextMenuRegistry=(_a86=class{constructor(){this.defaultActions=[],this.disabledActions=new Set,this.hiddenActions=new Set,this.listeners=new Listeners}static check(type,event){return event.type===type}static checkCallback(desiredType,type,_callback){return desiredType===type}dispatchContext(type,pointerEvent,context,position){const{sourceEvent}=pointerEvent;if(sourceEvent.defaultPrevented)return;const x=(position==null?void 0:position.x)??pointerEvent.canvasX,y=(position==null?void 0:position.y)??pointerEvent.canvasY,event={type,x,y,context,sourceEvent};this.listeners.dispatch("",event)}addListener(handler){return this.listeners.addListener("",handler)}filterActions(type){return this.defaultActions.filter(action=>action.id!=null&&!this.hiddenActions.has(action.id)&&["all",type].includes(action.type))}registerDefaultAction(action){const didAdd=action.id!=null&&!this.defaultActions.some(({id})=>id===action.id);return didAdd&&this.defaultActions.push(action),()=>{const index=didAdd?this.defaultActions.findIndex(({id})=>id===action.id):-1;index!==-1&&this.defaultActions.splice(index,1)}}enableAction(actionId){this.disabledActions.delete(actionId)}disableAction(actionId){this.disabledActions.add(actionId)}showAction(actionId){this.hiddenActions.add(actionId)}hideAction(actionId){this.hiddenActions.delete(actionId)}isDisabled(actionId){return this.disabledActions.has(actionId)}},__name(_a86,"ContextMenuRegistry"),_a86),_a87,HighlightManager=(_a87=class extends BaseManager{constructor(){super(...arguments),this.highlightStates=new StateTracker}updateHighlight(callerId,highlightedDatum){const{activeHighlight:previousHighlight}=this;this.highlightStates.set(callerId,highlightedDatum),this.activeHighlight=this.highlightStates.stateValue(),this.isEqual(this.activeHighlight,previousHighlight)||this.listeners.dispatch("highlight-change",{type:"highlight-change",currentHighlight:this.activeHighlight,previousHighlight,callerId})}getActiveHighlight(){return this.activeHighlight}isEqual(a,b){return a===b||a!=null&&b!=null&&(a==null?void 0:a.series)===(b==null?void 0:b.series)&&(a==null?void 0:a.itemId)===(b==null?void 0:b.itemId)&&(a==null?void 0:a.datum)===(b==null?void 0:b.datum)}},__name(_a87,"HighlightManager"),_a87);function datumBoundaryPoints(datum,domain){if(datum==null||domain.length===0)return[!1,!1];const datumValue=datum.valueOf(),d0=domain[0],d1=domain[domain.length-1];if(typeof d0=="string")return[datumValue===d0,datumValue===d1];let min=d0.valueOf(),max=d1.valueOf();return min>max&&([min,max]=[max,min]),[datumValue===min,datumValue===max]}__name(datumBoundaryPoints,"datumBoundaryPoints");function datumStylerProperties(datum,xKey,yKey,xDomain,yDomain){const{xValue,yValue}=datum,[min,max]=datumBoundaryPoints(yValue,yDomain),[first2,last]=datumBoundaryPoints(xValue,xDomain);return{xKey,yKey,xValue,yValue,first:first2,last,min,max}}__name(datumStylerProperties,"datumStylerProperties");function visibleRangeIndices(length2,[range0,range1],xRange){const xMinIndex=findMinIndex(0,length2-1,index=>{var _a294;const x1=((_a294=xRange(index))==null?void 0:_a294[1])??NaN;return!Number.isFinite(x1)||x1>range0})??0;let xMaxIndex=findMaxIndex(0,length2-1,index=>{var _a294;const x0=((_a294=xRange(index))==null?void 0:_a294[0])??NaN;return!Number.isFinite(x0)||x0<range1})??length2-1;return xMaxIndex=Math.min(xMaxIndex+1,length2),[xMinIndex,xMaxIndex]}__name(visibleRangeIndices,"visibleRangeIndices");function getDatumRefPoint(series,datum,movedBounds){var _a294,_b;if(movedBounds){const{x,y,width:width2,height:height2}=movedBounds;return{canvasX:x+width2/2,canvasY:y+height2/2}}const refPoint=((_a294=datum.yBar)==null?void 0:_a294.upperPoint)??datum.midPoint??((_b=series.datumMidPoint)==null?void 0:_b.call(series,datum));if(refPoint){const{x,y}=Transformable.toCanvasPoint(series.contentGroup,refPoint.x,refPoint.y);return{canvasX:Math.round(x),canvasY:Math.round(y)}}}__name(getDatumRefPoint,"getDatumRefPoint");function countExpandingSearch(min,max,start2,countUntil,iteratee){let i=-1,count=0,shift=0,reachedAnEnd=!1;for(;count<countUntil&&i<=max-min;){i+=1;const index=start2+shift;if(reachedAnEnd||(shift*=-1),shift>=0&&(shift+=1),reachedAnEnd&&shift<0&&(shift-=1),index<min||index>max){reachedAnEnd=!0;continue}iteratee(index)&&(count+=1)}return count}__name(countExpandingSearch,"countExpandingSearch");var _a88,TooltipManager=(_a88=class{constructor(localeManager,domManager,tooltip){this.domManager=domManager,this.tooltip=tooltip,this.stateTracker=new StateTracker,this.suppressState=new StateTracker(!1),this.appliedState=null,this.destroyFns=[],this.destroyFns.push(tooltip.setup(localeManager,domManager),domManager.addListener("hidden",()=>this.tooltip.hide()))}destroy(){this.destroyFns.forEach(fn=>fn())}updateTooltip(callerId,meta,content,pagination){var _a294;content??(content=(_a294=this.stateTracker.get(callerId))==null?void 0:_a294.content),this.stateTracker.set(callerId,{meta,content,pagination}),this.applyStates()}removeTooltip(callerId){this.stateTracker.delete(callerId),this.applyStates()}suppressTooltip(callerId){this.suppressState.set(callerId,!0)}unsuppressTooltip(callerId){this.suppressState.delete(callerId)}applyStates(){var _a294;const id=this.stateTracker.stateId(),state=id?this.stateTracker.get(id):void 0;if(this.suppressState.stateValue()||(state==null?void 0:state.meta)==null||(state==null?void 0:state.content)==null){this.appliedState=null,this.tooltip.hide();return}const canvasRect=this.domManager.getBoundingClientRect(),boundingRect=this.tooltip.bounds==="extended"?this.domManager.getOverlayClientRect():canvasRect;if(((_a294=this.appliedState)==null?void 0:_a294.content)===(state==null?void 0:state.content)){const renderInstantly=this.tooltip.isVisible();this.tooltip.show(boundingRect,canvasRect,state==null?void 0:state.meta,null,void 0,renderInstantly)}else this.tooltip.show(boundingRect,canvasRect,state==null?void 0:state.meta,state==null?void 0:state.content,state==null?void 0:state.pagination);this.appliedState=state}static makeTooltipMeta(event,series,datum,movedBounds){var _a294;const{canvasX,canvasY}=event,tooltip=series.properties.tooltip,{placement,defaultPlacement,anchorTo,defaultAnchorTo,xOffset,yOffset}=tooltip.position,refPoint=getDatumRefPoint(series,datum,movedBounds);return{canvasX,canvasY,nodeCanvasX:(refPoint==null?void 0:refPoint.canvasX)??canvasX,nodeCanvasY:(refPoint==null?void 0:refPoint.canvasY)??canvasY,enableInteraction:((_a294=tooltip.interaction)==null?void 0:_a294.enabled)??!1,showArrow:tooltip.showArrow,position:{placement,defaultPlacement,anchorTo,defaultAnchorTo,xOffset,yOffset}}}isEnteringInteractiveTooltip(event){const{tooltip}=this,relatedTarget=event.relatedTarget;return tooltip.interactive&&tooltip.enabled&&tooltip.isVisible()&&tooltip.contains(relatedTarget)}},__name(_a88,"TooltipManager"),_a88),DRAG_THRESHOLD_PX=3,DOUBLE_TAP_TIMER_MS=505,DOUBLE_TAP_THRESHOLD_PX=30;function makeSynthetic(device,type,event){const{offsetX,offsetY,clientX,clientY,currentX,currentY,sourceEvent}=event;return{type,device,offsetX,offsetY,clientX,clientY,currentX,currentY,sourceEvent}}__name(makeSynthetic,"makeSynthetic");function checkDragDistance(dx,dy){const distanceSquared2=dx*dx+dy*dy,thresholdSquared=DRAG_THRESHOLD_PX*DRAG_THRESHOLD_PX;return distanceSquared2>=thresholdSquared}__name(checkDragDistance,"checkDragDistance");function checkDoubleTapDistance(t1,t2){const dx=t1.clientX-t2.clientX,dy=t1.clientY-t2.clientY,distanceSquared2=dx*dx+dy*dy,thresholdSquared=DOUBLE_TAP_THRESHOLD_PX*DOUBLE_TAP_THRESHOLD_PX;return distanceSquared2<thresholdSquared}__name(checkDoubleTapDistance,"checkDoubleTapDistance");var _a89,DragInterpreter=(_a89=class{constructor(widget){this.destroyFns=[],this.listeners=new Listeners,this.isDragging=!1,this.touch={distanceTravelledX:0,distanceTravelledY:0,clientX:0,clientY:0},this.destroyFns.push(widget.addListener("touchstart",this.onTouchStart.bind(this)),widget.addListener("touchmove",this.onTouchMove.bind(this)),widget.addListener("touchend",this.onTouchEnd.bind(this)),widget.addListener("mousemove",this.onMouseMove.bind(this)),widget.addListener("dblclick",this.onDblClick.bind(this)),widget.addListener("drag-start",this.onDragStart.bind(this)),widget.addListener("drag-move",this.onDragMove.bind(this)),widget.addListener("drag-end",this.onDragEnd.bind(this)))}destroy(){this.destroyFns.forEach(fn=>fn()),this.listeners.destroy()}addListener(type,handler){return this.listeners.addListener(type,handler)}dispatch(event){this.listeners.dispatch(event.type,event)}onTouchStart(e){const{clientX,clientY}=e.sourceEvent.targetTouches[0]??{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX=0,this.touch.distanceTravelledY=0,this.touch.clientX=clientX,this.touch.clientY=clientY}onTouchMove(e){const{clientX,clientY}=e.sourceEvent.targetTouches[0]??{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX+=Math.abs(this.touch.clientX-clientX),this.touch.distanceTravelledY+=Math.abs(this.touch.clientY-clientY),this.touch.clientX=clientX,this.touch.clientY=clientY}onTouchEnd(event){event.sourceEvent.preventDefault()}onMouseMove(event){this.dispatch(event)}onDblClick(event){this.dispatch({device:"mouse",...event})}onDragStart(event){this.dragStartEvent=event}onDragMove(event){this.dragStartEvent!=null&&checkDragDistance(event.originDeltaX,event.originDeltaY)&&(this.dispatch(this.dragStartEvent),this.dispatch({...this.dragStartEvent,type:"drag-move"}),this.dragStartEvent=void 0,this.isDragging=!0),this.isDragging&&this.dispatch(event)}onDragEnd(event){if(this.isDragging){this.dispatch(event),this.isDragging=!1;return}if(event.device==="mouse"){const click=makeSynthetic("mouse","click",event);this.dispatch(click)}else if(event.sourceEvent.type==="touchend"){if(checkDragDistance(this.touch.distanceTravelledX,this.touch.distanceTravelledY))return;const click=makeSynthetic("touch","click",event);this.dispatch(click);const now=Date.now();if(this.lastClick!==void 0&&now-this.lastClick.time<=DOUBLE_TAP_TIMER_MS&&checkDoubleTapDistance(this.lastClick,event)){const dblClick=makeSynthetic(event.device,"dblclick",event);this.dispatch(dblClick),this.lastClick=void 0}else this.lastClick={time:now,clientX:event.clientX,clientY:event.clientY}}}},__name(_a89,"DragInterpreter"),_a89),_a90,DOMManagerWidget=(_a90=class extends NativeWidget{constructor(elem){super(elem)}addChildToDOM(){}removeChildFromDOM(){}},__name(_a90,"DOMManagerWidget"),_a90),_a91,WidgetSet=(_a91=class{constructor(domManager){this.seriesWidget=new DOMManagerWidget(domManager.getParent("series-area")),this.chartWidget=new DOMManagerWidget(domManager.getParent("canvas-proxy")),this.containerWidget=new DOMManagerWidget(domManager.getParent("canvas-container")),this.containerWidget.addChild(this.chartWidget),this.chartWidget.addChild(this.seriesWidget),this.seriesDragInterpreter=new DragInterpreter(this.seriesWidget)}destroy(){this.seriesDragInterpreter.destroy(),this.seriesWidget.destroy(),this.chartWidget.destroy(),this.containerWidget.destroy()}},__name(_a91,"WidgetSet"),_a91);function clampArray(value,array3){const[min,max]=findMinMax(array3);return clamp(min,value,max)}__name(clampArray,"clampArray");function findMinMax(array3){if(array3.length===0)return[];const result=[1/0,-1/0];for(const val of array3)val<result[0]&&(result[0]=val),val>result[1]&&(result[1]=val);return result}__name(findMinMax,"findMinMax");function findRangeExtent(array3){const[min,max]=findMinMax(array3);return max-min}__name(findRangeExtent,"findRangeExtent");var _a92,_ContinuousScale=(_a92=class extends AbstractScale{constructor(domain=[],range3=[]){super(),this.domain=domain,this.range=range3,this.defaultClamp=!1}static is(value){return value instanceof _a92}normalizeDomains(...domains){let min,minValue=1/0,max,maxValue=-1/0;for(const domain of domains)for(const d of domain){const value=d.valueOf();value<minValue&&(minValue=value,min=d),value>maxValue&&(maxValue=value,max=d)}return min!=null&&max!=null?{domain:[min,max],animatable:!0}:{domain:[],animatable:!1}}transform(x){return x}transformInvert(x){return x}calcBandwidth(smallestInterval=1){const{domain}=this,rangeDistance=this.getPixelRange();if(domain.length===0)return rangeDistance;const intervals=Math.abs(domain[1].valueOf()-domain[0].valueOf())/smallestInterval+1,maxBands=Math.floor(rangeDistance),bands=Math.min(intervals,maxBands);return rangeDistance/Math.max(1,bands)}convert(value,clamp24=this.defaultClamp){const{domain}=this;if(!domain||domain.length<2)return NaN;const d0=Number(this.transform(domain[0])),d1=Number(this.transform(domain[1])),x=Number(this.transform(value)),{range:range3}=this,[r0,r1]=range3;if(clamp24){const[start2,stop]=findMinMax([d0,d1]);if(x<start2)return r0;if(x>stop)return r1}return d0===d1?(r0+r1)/2:x===d0?r0:x===d1?r1:r0+(x-d0)/(d1-d0)*(r1-r0)}invert(x,_nearest){const domain=this.domain.map(d2=>this.transform(d2)),[d0,d1]=domain,{range:range3}=this,[r0,r1]=range3;let d;return r0===r1?d=this.toDomain((Number(d0)+Number(d1))/2):d=this.toDomain(Number(d0)+(x-r0)/(r1-r0)*(Number(d1)-Number(d0))),this.transformInvert(d)}getPixelRange(){const[a,b]=this.range;return Math.abs(b-a)}},__name(_a92,"_ContinuousScale"),_a92);_ContinuousScale.defaultTickCount=5;var ContinuousScale=_ContinuousScale;function compareDates(a,b){return a.valueOf()-b.valueOf()}__name(compareDates,"compareDates");function deduplicateSortedArray(values){let v0=NaN;const out=[];for(const v of values){const v1=v.valueOf();v0!==v1&&out.push(v),v0=v1}return out}__name(deduplicateSortedArray,"deduplicateSortedArray");function sortAndUniqueDates(values){const sortedValues=values.slice().sort(compareDates);return datesSortOrder(sortedValues)==null?deduplicateSortedArray(sortedValues):sortedValues}__name(sortAndUniqueDates,"sortAndUniqueDates");function datesSortOrder(d){if(d.length===0)return 1;const sign=Number(d[d.length-1])>Number(d[0])?1:-1;let v0=-1/0*sign;for(const v of d){const v1=v.valueOf();if(Math.sign(v1-v0)!==sign)return;v0=v1}return sign}__name(datesSortOrder,"datesSortOrder");var CONSTANTS={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function dayOfYear(date4,startOfYear=new Date(date4.getFullYear(),0,1)){const startOffset=date4.getTimezoneOffset()-startOfYear.getTimezoneOffset(),timeDiff=date4.getTime()-startOfYear.getTime()+startOffset*6e4,timeOneDay=36e5*24;return Math.floor(timeDiff/timeOneDay)}__name(dayOfYear,"dayOfYear");function weekOfYear(date4,startDay){const startOfYearDay=new Date(date4.getFullYear(),0,1).getDay(),firstWeekStartOffset=(startDay-startOfYearDay+7)%7,startOffset=new Date(date4.getFullYear(),0,firstWeekStartOffset+1);return startOffset<=date4?Math.floor(dayOfYear(date4,startOffset)/7)+1:0}__name(weekOfYear,"weekOfYear");var SUNDAY=0,MONDAY=1,THURSDAY=4;function isoWeekOfYear(date4,year2=date4.getFullYear()){const firstOfYearDay=new Date(year2,0,1).getDay(),firstThursdayOffset=(THURSDAY-firstOfYearDay+7)%7,startOffset=new Date(year2,0,firstThursdayOffset-(THURSDAY-MONDAY)+1);return startOffset<=date4?Math.floor(dayOfYear(date4,startOffset)/7)+1:isoWeekOfYear(date4,year2-1)}__name(isoWeekOfYear,"isoWeekOfYear");function timezone(date4){const offset4=date4.getTimezoneOffset(),unsignedOffset=Math.abs(offset4);return`${offset4>0?"-":"+"}${pad(Math.floor(unsignedOffset/60),2,"0")}${pad(Math.floor(unsignedOffset%60),2,"0")}`}__name(timezone,"timezone");var FORMATTERS={a:__name(d=>CONSTANTS.shortDays[d.getDay()],"a"),A:__name(d=>CONSTANTS.days[d.getDay()],"A"),b:__name(d=>CONSTANTS.shortMonths[d.getMonth()],"b"),B:__name(d=>CONSTANTS.months[d.getMonth()],"B"),c:"%x, %X",d:__name((d,p)=>pad(d.getDate(),2,p??"0"),"d"),e:"%_d",f:__name((d,p)=>pad(d.getMilliseconds()*1e3,6,p??"0"),"f"),H:__name((d,p)=>pad(d.getHours(),2,p??"0"),"H"),I:__name((d,p)=>{const hours=d.getHours()%12;return hours===0?"12":pad(hours,2,p??"0")},"I"),j:__name((d,p)=>pad(dayOfYear(d)+1,3,p??"0"),"j"),m:__name((d,p)=>pad(d.getMonth()+1,2,p??"0"),"m"),M:__name((d,p)=>pad(d.getMinutes(),2,p??"0"),"M"),L:__name((d,p)=>pad(d.getMilliseconds(),3,p??"0"),"L"),p:__name(d=>d.getHours()<12?"AM":"PM","p"),Q:__name(d=>String(d.getTime()),"Q"),s:__name(d=>String(Math.floor(d.getTime()/1e3)),"s"),S:__name((d,p)=>pad(d.getSeconds(),2,p??"0"),"S"),u:__name(d=>{let day2=d.getDay();return day2<1&&(day2+=7),String(day2%7)},"u"),U:__name((d,p)=>pad(weekOfYear(d,SUNDAY),2,p??"0"),"U"),V:__name((d,p)=>pad(isoWeekOfYear(d),2,p??"0"),"V"),w:__name((d,p)=>pad(d.getDay(),2,p??"0"),"w"),W:__name((d,p)=>pad(weekOfYear(d,MONDAY),2,p??"0"),"W"),x:"%-m/%-d/%Y",X:"%-I:%M:%S %p",y:__name((d,p)=>pad(d.getFullYear()%100,2,p??"0"),"y"),Y:__name((d,p)=>pad(d.getFullYear(),4,p??"0"),"Y"),Z:__name(d=>timezone(d),"Z"),"%":__name(()=>"%","%")},PADS={_:" ",0:"0","-":""};function pad(value,size,padChar){const output=String(Math.floor(value));return output.length>=size?output:`${padChar.repeat(size-output.length)}${output}`}__name(pad,"pad");function buildFormatter(formatString){const formatParts=[];for(;formatString.length>0;){let nextEscapeIdx=formatString.indexOf("%");if(nextEscapeIdx!==0){const literalPart=nextEscapeIdx>0?formatString.substring(0,nextEscapeIdx):formatString;formatParts.push(literalPart)}if(nextEscapeIdx<0)break;const maybePadSpecifier=formatString[nextEscapeIdx+1],maybePad=PADS[maybePadSpecifier];maybePad!=null&&nextEscapeIdx++;const maybeFormatterSpecifier=formatString[nextEscapeIdx+1],maybeFormatter=FORMATTERS[maybeFormatterSpecifier];if(typeof maybeFormatter=="function")formatParts.push([maybeFormatter,maybePad]);else if(typeof maybeFormatter=="string"){const formatter=buildFormatter(maybeFormatter);formatParts.push([formatter,maybePad])}else formatParts.push(`${maybePad??""}${maybeFormatterSpecifier}`);formatString=formatString.substring(nextEscapeIdx+2)}return dateTime=>{const dateTimeAsDate=typeof dateTime=="number"?new Date(dateTime):dateTime;return formatParts.map(c=>typeof c=="string"?c:c[0](dateTimeAsDate,c[1])).join("")}}__name(buildFormatter,"buildFormatter");var time_exports={};__export(time_exports,{TimeInterval:__name(()=>TimeInterval,"TimeInterval"),day:__name(()=>day,"day"),friday:__name(()=>friday,"friday"),hour:__name(()=>hour,"hour"),millisecond:__name(()=>millisecond,"millisecond"),minute:__name(()=>minute,"minute"),monday:__name(()=>monday,"monday"),month:__name(()=>month,"month"),saturday:__name(()=>saturday,"saturday"),second:__name(()=>second,"second"),sunday:__name(()=>sunday,"sunday"),thursday:__name(()=>thursday,"thursday"),tuesday:__name(()=>tuesday,"tuesday"),utcDay:__name(()=>utcDay,"utcDay"),utcHour:__name(()=>utcHour,"utcHour"),utcMinute:__name(()=>utcMinute,"utcMinute"),utcMonth:__name(()=>utcMonth,"utcMonth"),utcYear:__name(()=>utcYear,"utcYear"),wednesday:__name(()=>wednesday,"wednesday"),year:__name(()=>year,"year")});var _a93,TimeInterval=(_a93=class{constructor(_encode,_decode,_rangeCallback){this._encode=_encode,this._decode=_decode,this._rangeCallback=_rangeCallback}floor(date4){const d=new Date(date4),e=this._encode(d);return this._decode(e)}ceil(date4){const d=new Date(Number(date4)-1),e=this._encode(d);return this._decode(e+1)}range(start2,stop,{extend=!1,visibleRange=[0,1]}={}){var _a294;let reversed=!1;start2.getTime()>stop.getTime()&&([start2,stop]=[stop,start2],reversed=!0);const rangeCallback=(_a294=this._rangeCallback)==null?void 0:_a294.call(this,start2,stop),e0=this._encode(extend?this.floor(start2):this.ceil(start2)),e1=this._encode(extend?this.ceil(stop):this.floor(stop));if(e1<e0)return[];const de=e1-e0;let startIndex,endIndex;reversed?(startIndex=Math.ceil(e0+(1-visibleRange[1])*de),endIndex=Math.floor(e0+(1-visibleRange[0])*de)):(startIndex=Math.floor(e0+visibleRange[0]*de),endIndex=Math.ceil(e0+visibleRange[1]*de));const range3=[];for(let e=startIndex;e<=endIndex;e+=1){const d=this._decode(e);range3.push(d)}return rangeCallback==null||rangeCallback(),range3}},__name(_a93,"TimeInterval"),_a93),_a94,CountableTimeInterval=(_a94=class extends TimeInterval{getOffset(snapTo,step){return Math.floor(this._encode(new Date(snapTo)))%step}every(step,options){let offset4=0,rangeCallback;const unsafeStep=step;step=Math.max(1,Math.round(step)),unsafeStep!==step&&logger_exports.warnOnce(`interval step of [${unsafeStep}] rounded to [${step}].`);const{snapTo="start"}=options??{};if(typeof snapTo=="string"){const initialOffset=offset4;rangeCallback=__name((start2,stop)=>{const s=snapTo==="start"?start2:stop;return offset4=this.getOffset(s,step),()=>offset4=initialOffset},"rangeCallback")}else typeof snapTo=="number"?offset4=this.getOffset(new Date(snapTo),step):snapTo instanceof Date&&(offset4=this.getOffset(snapTo,step));const encode13=__name(date4=>Math.floor((this._encode(date4)-offset4)/step),"encode13"),decode13=__name(encoded=>this._decode(encoded*step+offset4),"decode13");return new TimeInterval(encode13,decode13,rangeCallback)}},__name(_a94,"CountableTimeInterval"),_a94);function encode(date4){return date4.getTime()}__name(encode,"encode");function decode(encoded){return new Date(encoded)}__name(decode,"decode");var millisecond=new CountableTimeInterval(encode,decode),durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,offset=new Date().getTimezoneOffset()*durationMinute;function encode2(date4){return Math.floor((date4.getTime()-offset)/durationSecond)}__name(encode2,"encode2");function decode2(encoded){return new Date(offset+encoded*durationSecond)}__name(decode2,"decode2");var second=new CountableTimeInterval(encode2,decode2),offset2=new Date().getTimezoneOffset()*durationMinute;function encode3(date4){return Math.floor((date4.getTime()-offset2)/durationMinute)}__name(encode3,"encode3");function decode3(encoded){return new Date(offset2+encoded*durationMinute)}__name(decode3,"decode3");var minute=new CountableTimeInterval(encode3,decode3),offset3=new Date().getTimezoneOffset()*durationMinute;function encode4(date4){return Math.floor((date4.getTime()-offset3)/durationHour)}__name(encode4,"encode4");function decode4(encoded){return new Date(offset3+encoded*durationHour)}__name(decode4,"decode4");var hour=new CountableTimeInterval(encode4,decode4);function encode5(date4){const tzOffsetMs=date4.getTimezoneOffset()*durationMinute;return Math.floor((date4.getTime()-tzOffsetMs)/durationDay)}__name(encode5,"encode5");function decode5(encoded){const d=new Date(1970,0,1);return d.setDate(d.getDate()+encoded),d}__name(decode5,"decode5");var day=new CountableTimeInterval(encode5,decode5);function weekday(weekStart){const dayShift=(7+weekStart-4)%7;function encode13(date4){const tzOffsetMs=date4.getTimezoneOffset()*durationMinute;return Math.floor((date4.getTime()-tzOffsetMs)/durationWeek-dayShift/7)}__name(encode13,"encode13");function decode13(encoded){const d=new Date(1970,0,1);return d.setDate(d.getDate()+encoded*7+dayShift),d}return __name(decode13,"decode13"),new CountableTimeInterval(encode13,decode13)}__name(weekday,"weekday");var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6);function encode6(date4){return date4.getFullYear()*12+date4.getMonth()}__name(encode6,"encode6");function decode6(encoded){const year2=Math.floor(encoded/12),month2=encoded-year2*12;return new Date(year2,month2,1)}__name(decode6,"decode6");var month=new CountableTimeInterval(encode6,decode6);function encode7(date4){return date4.getFullYear()}__name(encode7,"encode7");function decode7(encoded){const d=new Date;return d.setFullYear(encoded),d.setMonth(0,1),d.setHours(0,0,0,0),d}__name(decode7,"decode7");var year=new CountableTimeInterval(encode7,decode7);function encode8(date4){return Math.floor(date4.getTime()/durationMinute)}__name(encode8,"encode8");function decode8(encoded){return new Date(encoded*durationMinute)}__name(decode8,"decode8");var utcMinute=new CountableTimeInterval(encode8,decode8);function encode9(date4){return Math.floor(date4.getTime()/durationHour)}__name(encode9,"encode9");function decode9(encoded){return new Date(encoded*durationHour)}__name(decode9,"decode9");var utcHour=new CountableTimeInterval(encode9,decode9);function encode10(date4){return Math.floor(date4.getTime()/durationDay)}__name(encode10,"encode10");function decode10(encoded){const d=new Date(0);return d.setUTCDate(d.getUTCDate()+encoded),d.setUTCHours(0,0,0,0),d}__name(decode10,"decode10");var utcDay=new CountableTimeInterval(encode10,decode10);function encode11(date4){return date4.getUTCFullYear()*12+date4.getUTCMonth()}__name(encode11,"encode11");function decode11(encoded){const year2=Math.floor(encoded/12),month2=encoded-year2*12;return new Date(Date.UTC(year2,month2,1))}__name(decode11,"decode11");var utcMonth=new CountableTimeInterval(encode11,decode11);function encode12(date4){return date4.getUTCFullYear()}__name(encode12,"encode12");function decode12(encoded){const d=new Date;return d.setUTCFullYear(encoded),d.setUTCMonth(0,1),d.setUTCHours(0,0,0,0),d}__name(decode12,"decode12");var utcYear=new CountableTimeInterval(encode12,decode12);function dateToNumber(value){return value instanceof Date?value.getTime():value}__name(dateToNumber,"dateToNumber");function defaultTimeTickFormat(ticks,domain,formatOffset){const formatString=calculateDefaultTimeTickFormat(ticks,domain,formatOffset),formatter=buildFormatter(formatString);return date4=>formatter(date4)}__name(defaultTimeTickFormat,"defaultTimeTickFormat");function calculateDefaultTimeTickFormat(ticks,domain,formatOffset=0){let minInterval=1/0;for(let i=1;i<ticks.length;i++)minInterval=Math.min(minInterval,Math.abs(ticks[i].valueOf()-ticks[i-1].valueOf()));const[d0,d1]=domain.length===0?[0,0]:findMinMax([domain[0].valueOf(),domain[domain.length-1].valueOf()]),startYear=new Date(d0).getFullYear(),yearChange=new Date(d1).getFullYear()-startYear>0,timeFormat=isFinite(minInterval)?getIntervalLowestGranularityFormat(minInterval,ticks):getLowestGranularityFormat(ticks[0]);return formatStringBuilder(Math.max(timeFormat-formatOffset,0),yearChange,ticks)}__name(calculateDefaultTimeTickFormat,"calculateDefaultTimeTickFormat");function getIntervalLowestGranularityFormat(value,ticks){return value<durationSecond?0:value<durationMinute?1:value<durationHour?2:value<durationDay?3:value<durationWeek?4:value<durationDay*28||value<durationDay*31&&hasDuplicateMonth(ticks)?5:value<durationYear?6:7}__name(getIntervalLowestGranularityFormat,"getIntervalLowestGranularityFormat");function getLowestGranularityFormat(value){return second.floor(value)<value?0:minute.floor(value)<value?1:hour.floor(value)<value?2:day.floor(value)<value?3:month.floor(value)<value?sunday.floor(value)<value?4:5:year.floor(value)<value?6:7}__name(getLowestGranularityFormat,"getLowestGranularityFormat");function hasDuplicateMonth(ticks){let prevMonth=new Date(ticks[0]).getMonth();for(let i=1;i<ticks.length;i++){const tickMonth=new Date(ticks[i]).getMonth();if(prevMonth===tickMonth)return!0;prevMonth=tickMonth}return!1}__name(hasDuplicateMonth,"hasDuplicateMonth");function formatStringBuilder(defaultTimeFormat,yearChange,ticks){const firstTick=dateToNumber(ticks[0]),lastTick=dateToNumber(ticks.at(-1)),extent2=Math.abs(lastTick-firstTick),activeYear=yearChange||defaultTimeFormat===7,activeDate=extent2===0,formatParts=[["hour",6*durationHour,14*durationDay,3,"%I %p"],["hour",durationMinute,6*durationHour,3,"%I:%M"],["second",1e3,6*durationHour,1,":%S"],["ms",0,6*durationHour,0,".%L"],["am/pm",durationMinute,6*durationHour,3,"%p"]," ",["day",durationDay,durationWeek,4,"%a"],["month",activeDate?0:durationWeek,52*durationWeek,5,"%b %d"],["month",5*durationWeek,10*durationYear,6,"%B"]," ",["year",activeYear?0:durationYear,1/0,7,"%Y"]].filter(v=>{if(typeof v=="string")return!0;const[_,min,max,format]=v;return format>=defaultTimeFormat&&min<=extent2&&extent2<max}).reduce((r,next)=>(typeof next=="string"?r.result.push(next):r.used.has(next[0])||(r.result.push(next),r.used.add(next[0])),r),{result:[],used:new Set}).result,firstFormat=formatParts.findIndex(v=>typeof v!="string"),lastFormat=formatParts.findLastIndex(v=>typeof v!="string");return formatParts.slice(firstFormat,lastFormat+1).map(v=>typeof v=="string"?v:v[4]).join("").replaceAll(/\s+/g," ").trim()}__name(formatStringBuilder,"formatStringBuilder");function filterVisibleTicks(ticks,reversed,visibleRange){if(visibleRange==null||visibleRange[0]===0&&visibleRange[1]===1)return ticks;const vt0=clamp(0,Math.floor(visibleRange[0]*ticks.length),ticks.length),vt1=clamp(0,Math.ceil(visibleRange[1]*ticks.length),ticks.length),t0=reversed?ticks.length-vt1:vt0,t1=reversed?ticks.length-vt0:vt1;return ticks.slice(t0,t1)}__name(filterVisibleTicks,"filterVisibleTicks");var _a95,_BandScale=(_a95=class extends AbstractScale{constructor(){super(...arguments),this.invalid=!0,this.range=[0,1],this.round=!1,this.interval=void 0,this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(value){return value instanceof _a95}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(value){value=clamp(0,value,1),this._paddingInner=value,this._paddingOuter=value}get padding(){return this._paddingInner}set paddingInner(value){this.invalid=!0,this._paddingInner=clamp(0,value,1)}get paddingInner(){return this._paddingInner}set paddingOuter(value){this.invalid=!0,this._paddingOuter=clamp(0,value,1)}get paddingOuter(){return this._paddingOuter}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&logger_exports.warnOnce("Expected update to not invalidate scale"))}ticks(_params,domain=this.domain,visibleRange){return filterVisibleTicks(domain,!1,visibleRange)}convert(d,_clamp){this.refresh();const i=this.getIndex(d);return i==null||i<0||i>=this.domain.length?NaN:this.ordinalRange(i)}invertNearestIndex(position){this.refresh();const{domain}=this;if(domain.length===0)return-1;let low=0,high=domain.length-1,closestDistance=1/0,closestIndex=0;for(;low<=high;){const mid=(high+low)/2|0,p=this.ordinalRange(mid),distance2=Math.abs(p-position);if(distance2===0)return mid;distance2<closestDistance&&(closestDistance=distance2,closestIndex=mid),p<position?low=mid+1:high=mid-1}return closestIndex}update(){const count=this.domain.length;if(count===0)return;const[r0,r1]=this.range;let{_paddingInner:paddingInner}=this;const{_paddingOuter:paddingOuter,round:round4}=this,rangeDistance=r1-r0;let rawStep;count===1?(paddingInner=0,rawStep=rangeDistance*(1-paddingOuter*2)):rawStep=rangeDistance/Math.max(1,count-paddingInner+paddingOuter*2);const step=round4?Math.floor(rawStep):rawStep;let inset=r0+(rangeDistance-step*(count-paddingInner))/2,bandwidth=step*(1-paddingInner);round4&&(inset=Math.round(inset),bandwidth=Math.round(bandwidth)),this._step=step,this._inset=inset,this._bandwidth=bandwidth,this._rawBandwidth=rawStep*(1-paddingInner)}ordinalRange(i){const{_inset:inset,_step:step,range:range3}=this,min=Math.min(range3[0],range3[1]),max=Math.max(range3[0],range3[1]);return clamp(min,inset+step*i,max)}},__name(_a95,"_BandScale"),_a95);__decorateClass([Invalidating],_BandScale.prototype,"range",2);__decorateClass([Invalidating],_BandScale.prototype,"round",2);__decorateClass([Invalidating],_BandScale.prototype,"interval",2);var BandScale=_BandScale,tInterval=__name((timeInterval,baseDuration,step)=>({duration:baseDuration*step,timeInterval,step}),"tInterval"),TickIntervals=[tInterval(second,durationSecond,1),tInterval(second,durationSecond,5),tInterval(second,durationSecond,15),tInterval(second,durationSecond,30),tInterval(minute,durationMinute,1),tInterval(minute,durationMinute,5),tInterval(minute,durationMinute,15),tInterval(minute,durationMinute,30),tInterval(hour,durationHour,1),tInterval(hour,durationHour,3),tInterval(hour,durationHour,6),tInterval(hour,durationHour,12),tInterval(day,durationDay,1),tInterval(day,durationDay,2),tInterval(sunday,durationWeek,1),tInterval(sunday,durationWeek,2),tInterval(sunday,durationWeek,3),tInterval(month,durationMonth,1),tInterval(month,durationMonth,2),tInterval(month,durationMonth,3),tInterval(month,durationMonth,4),tInterval(month,durationMonth,6),tInterval(year,durationYear,1)],TickMultipliers=[1,2,5,10];function isCloseToInteger(n,delta3){return Math.abs(Math.round(n)-n)<delta3}__name(isCloseToInteger,"isCloseToInteger");function createTicks(start2,stop,count,minCount,maxCount,visibleRange){if(count<2)return[start2,stop];const step=tickStep(start2,stop,count,minCount,maxCount);if(!Number.isFinite(step))return[];if(isCloseToInteger(start2/step,1e-12)||(start2=Math.ceil(start2/step)*step),isCloseToInteger(stop/step,1e-12)||(stop=Math.floor(stop/step)*step),visibleRange!=null&&visibleRange[0]!==0&&visibleRange[1]!==1){const rangeExtent=stop-start2,adjustedStart=start2+rangeExtent*visibleRange[0],adjustedEnd=stop-rangeExtent*(1-visibleRange[1]);return range(adjustedStart-adjustedStart%step,adjustedEnd+adjustedEnd%step,step)}return range(start2,stop,step)}__name(createTicks,"createTicks");function getTickTimeInterval(start2,stop,count,minCount,maxCount,targetInterval){const target=Math.abs(stop-start2)/Math.max(count,1);let i=0;for(const tickInterval of TickIntervals){if(target<=tickInterval.duration)break;i++}if(i===0){const step2=Math.max(tickStep(start2,stop,count,minCount,maxCount),1);return millisecond.every(step2)}else if(i===TickIntervals.length){const step2=tickStep(start2/durationYear,stop/durationYear,count,minCount,maxCount);return year.every(step2)}const i0=TickIntervals[i-1],i1=TickIntervals[i],{timeInterval,step}=target-i0.duration<i1.duration-target?i0:i1;return timeInterval.every(step)}__name(getTickTimeInterval,"getTickTimeInterval");function tickStep(start2,end2,count,minCount=0,maxCount=1/0){if(start2===end2)return clamp(1,minCount,maxCount);if(count<1)return NaN;const extent2=Math.abs(end2-start2),step=10**Math.floor(Math.log10(extent2/count));let m=NaN,minDiff=1/0,isInBounds=!1;for(const multiplier of TickMultipliers){const c=Math.ceil(extent2/(multiplier*step)),validBounds=c>=minCount&&c<=maxCount;if(isInBounds&&!validBounds)continue;const diffCount=Math.abs(c-count);(minDiff>diffCount||isInBounds!==validBounds)&&(isInBounds||(isInBounds=validBounds),minDiff=diffCount,m=multiplier)}return m*step}__name(tickStep,"tickStep");function decimalPlaces(decimal){for(let i=decimal.length-1;i>=0;i-=1)if(decimal[i]!=="0")return i+1;return 0}__name(decimalPlaces,"decimalPlaces");function tickFormat(ticks,format){const options=parseNumberFormat(format??",f");(options.precision==null||isNaN(options.precision))&&(!options.type||"eEFgGnprs".includes(options.type)?options.precision=Math.max(...ticks.map(x=>{if(!Number.isFinite(x))return 0;const[integer,decimal]=x.toExponential((options.type?6:12)-1).split(/[.e]/g);return(integer!=="1"&&integer!=="-1"?1:0)+decimalPlaces(decimal)+1})):"f%".includes(options.type)&&(options.precision=Math.max(...ticks.map(x=>{if(!Number.isFinite(x)||x===0)return 0;const l=Math.floor(Math.log10(Math.abs(x))),digits=options.type?6:12,decimal=x.toExponential(digits-1).split(/[.e]/g)[1],decimalLength=decimalPlaces(decimal);return Math.max(0,decimalLength-l)}))));const formatter=createNumberFormatter(options);return n=>formatter(Number(n))}__name(tickFormat,"tickFormat");function range(start2,end2,step){if(!Number.isFinite(step)||step<=0)return[];const f=10**countFractionDigits(step),d0=Math.min(start2,end2),d1=Math.max(start2,end2),out=[];for(let i=0;;i+=1){const p=Math.round((d0+step*i)*f)/f;if(p>d1)break;out.push(p)}return out}__name(range,"range");function isDenseInterval(count,availableRange){return count>=availableRange?(logger_exports.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}__name(isDenseInterval,"isDenseInterval");function niceTicksDomain(start2,end2){const extent2=Math.abs(end2-start2),step=10**Math.floor(Math.log10(extent2));let minError=1/0,ticks=[start2,end2];for(const multiplier of TickMultipliers){const m=multiplier*step,d0=Math.floor(start2/m)*m,d1=Math.ceil(end2/m)*m,error=1-extent2/Math.abs(d1-d0);minError>error&&(minError=error,ticks=[d0,d1])}return ticks}__name(niceTicksDomain,"niceTicksDomain");function estimateTickCount(rangeExtent,zoomExtent,minSpacing,maxSpacing,defaultTickCount,defaultMinSpacing){if(rangeExtent<=0)return{minTickCount:0,maxTickCount:0,tickCount:0};defaultMinSpacing=Math.max(defaultMinSpacing,rangeExtent/(defaultTickCount+1)),minSpacing??(minSpacing=defaultMinSpacing),maxSpacing??(maxSpacing=rangeExtent),minSpacing>maxSpacing&&(minSpacing===defaultMinSpacing?minSpacing=maxSpacing:maxSpacing=minSpacing);const maxTickCount=Math.max(1,Math.floor(rangeExtent/(zoomExtent*minSpacing))),minTickCount=Math.min(maxTickCount,Math.ceil(rangeExtent/(zoomExtent*maxSpacing))),tickCount=clamp(minTickCount,Math.floor(defaultTickCount/zoomExtent),maxTickCount);return{minTickCount,maxTickCount,tickCount}}__name(estimateTickCount,"estimateTickCount");var _a96,TimeScale=(_a96=class extends ContinuousScale{constructor(){super([],[0,1]),this.type="time"}toDomain(d){return new Date(d)}convert(value,clamp24){return value instanceof Date||(value=new Date(value)),super.convert(value,clamp24)}invert(value){return new Date(super.invert(value))}niceDomain(ticks,domain=this.domain){if(domain.length<2)return[];let[d0,d1]=domain;const maxAttempts=4,availableRange=this.getPixelRange();for(let i=0;i<maxAttempts;i++){const[n0,n1]=updateNiceDomainIteration(d0,d1,ticks,availableRange);if(dateToNumber(d0)===dateToNumber(n0)&&dateToNumber(d1)===dateToNumber(n1))break;d0=n0,d1=n1}return[d0,d1]}ticks(params,domain=this.domain,visibleRange=[0,1]){const{nice,interval,tickCount=ContinuousScale.defaultTickCount,minTickCount,maxTickCount}=params;if(domain.length<2)return[];const timestamps=domain.map(dateToNumber),start2=timestamps[0],stop=timestamps[timestamps.length-1];if(interval!=null){const availableRange=this.getPixelRange();return getDateTicksForInterval({start:start2,stop,interval,availableRange,visibleRange})??getDefaultDateTicks({start:start2,stop,tickCount,minTickCount,maxTickCount,visibleRange})}else{if(nice&&tickCount===2)return domain;if(nice&&tickCount===1)return domain.slice(0,1)}return getDefaultDateTicks({start:start2,stop,tickCount,minTickCount,maxTickCount,visibleRange})}_tickFormatter({domain,ticks,specifier},formatOffset){return specifier!=null?buildFormatter(specifier):defaultTimeTickFormat(ticks,domain,formatOffset)}tickFormatter(params){return this._tickFormatter(params)}datumFormatter(params){return this._tickFormatter(params,1)}},__name(_a96,"TimeScale"),_a96);function getDefaultDateTicks({start:start2,stop,tickCount,minTickCount,maxTickCount,visibleRange}){const t=getTickTimeInterval(start2,stop,tickCount,minTickCount,maxTickCount);return t?t.range(new Date(start2),new Date(stop),{visibleRange}):[]}__name(getDefaultDateTicks,"getDefaultDateTicks");function getDateTicksForInterval({start:start2,stop,interval,availableRange,visibleRange}){if(!interval)return[];if(interval instanceof TimeInterval){const ticks2=interval.range(new Date(start2),new Date(stop),{visibleRange});return isDenseInterval(ticks2.length,availableRange)?void 0:ticks2}const absInterval=Math.abs(interval);if(isDenseInterval(Math.abs(stop-start2)/absInterval,availableRange))return;const timeInterval=TickIntervals.findLast(tickInterval=>absInterval%tickInterval.duration===0);if(timeInterval)return timeInterval.timeInterval.every(absInterval/(timeInterval.duration/timeInterval.step)).range(new Date(start2),new Date(stop),{visibleRange});let date4=new Date(Math.min(start2,stop));const stopDate=new Date(Math.max(start2,stop)),ticks=[];for(;date4<=stopDate;)ticks.push(date4),date4=new Date(date4),date4.setMilliseconds(date4.getMilliseconds()+absInterval);return ticks}__name(getDateTicksForInterval,"getDateTicksForInterval");function updateNiceDomainIteration(d0,d1,ticks,availableRange){const{interval}=ticks,start2=Math.min(dateToNumber(d0),dateToNumber(d1)),stop=Math.max(dateToNumber(d0),dateToNumber(d1));let i;if(interval instanceof TimeInterval)i=interval;else{let tickCount;typeof interval=="number"&&(tickCount=(stop-start2)/Math.max(interval,1),isDenseInterval(tickCount,availableRange)&&(tickCount=null)),tickCount??(tickCount=ticks.tickCount??ContinuousScale.defaultTickCount),i=getTickTimeInterval(start2,stop,tickCount,ticks.minTickCount,ticks.maxTickCount)}if(i){const domain=i.range(new Date(start2),new Date(stop),{extend:!0});return d0>d1&&domain.reverse(),[domain[0],domain.at(-1)]}else return[d0,d1]}__name(updateNiceDomainIteration,"updateNiceDomainIteration");var _a97,OrdinalTimeScale=(_a97=class extends BandScale{constructor(){super(...arguments),this.type="ordinal-time",this._domain=[],this.isReversed=!1}static is(value){return value instanceof _a97}set domain(domain){domain!==this._domain&&(this.invalid=!0,this._domain=domain,this.isReversed=domain.length>0&&domain[0]>domain[domain.length-1],this.sortedTimestamps=void 0,this.precomputedSteps=void 0)}get domain(){return this._domain}toDomain(value){return new Date(value)}normalizeDomains(...domains){const sortedDomains=domains.filter(domain=>domain.length>0);if(sortedDomains.length===0)return{domain:[],animatable:!1};if(sortedDomains.length===1){let domain=sortedDomains[0];const sortOrder=datesSortOrder(domain);return sortOrder===-1?domain=domain.slice().reverse():sortOrder==null&&(domain=sortAndUniqueDates(domain.slice())),{domain,animatable:!0}}return{domain:sortAndUniqueDates(sortedDomains.flat()),animatable:!0}}ticks({interval,maxTickCount},domain=this.domain,visibleRange=[0,1]){if(!domain.length)return[];this.refresh();const{isReversed}=this;if(interval==null)return getDefaultTicks(domain,maxTickCount,isReversed,visibleRange);const[t0,t1]=[domain[0].valueOf(),domain.at(-1).valueOf()],start2=Math.min(t0,t1),stop=Math.max(t0,t1),[r0,r1]=this.range,availableRange=Math.abs(r1-r0),ticks=getDateTicksForInterval({start:start2,stop,interval,availableRange,visibleRange})??getDefaultTicks(domain,maxTickCount,isReversed,visibleRange);let lastIndex=-1;return ticks.filter(tick=>{const index=this.findInterval(tick.valueOf()),duplicated=index===lastIndex;return lastIndex=index,!duplicated})}getSortedTimestamps(){let{sortedTimestamps}=this;return sortedTimestamps==null&&(sortedTimestamps=this.domain.map(dateToNumber),this.isReversed&&sortedTimestamps.reverse(),this.sortedTimestamps=sortedTimestamps),sortedTimestamps}getPrecomputedSteps(){const{domain}=this;let{precomputedSteps}=this;const computedStepCount=domain.length<1e4?domain.length:Math.ceil(domain.length/16);if(precomputedSteps!=null||computedStepCount<=1)return precomputedSteps;const sortedTimestamps=this.getSortedTimestamps();precomputedSteps=new Int32Array(computedStepCount);const d0=sortedTimestamps[0],dRange=sortedTimestamps[sortedTimestamps.length-1]-d0,low=0,high=sortedTimestamps.length-1;for(let i=0;i<precomputedSteps.length;i+=1)precomputedSteps[i]=this.findIntervalInRange(d0+i/computedStepCount*dRange,low,high);this.precomputedSteps=precomputedSteps}findIntervalInRange(target,low,high){const sortedTimestamps=this.getSortedTimestamps();for(;low<=high;){const mid=(low+high)/2|0;if(sortedTimestamps[mid]===target)return mid;sortedTimestamps[mid]<target?low=mid+1:high=mid-1}return low}findInterval(target){const precomputedSteps=this.getPrecomputedSteps();let low,high;if(precomputedSteps==null)low=0,high=this.domain.length-1;else{const sortedTimestamps=this.getSortedTimestamps(),d0=sortedTimestamps[0],d1=sortedTimestamps[sortedTimestamps.length-1],i=Math.min((target-d0)/(d1-d0)*precomputedSteps.length|0,precomputedSteps.length-1|0);low=precomputedSteps[i],high=i<precomputedSteps.length-2?precomputedSteps[i+1]:sortedTimestamps.length-1}return this.findIntervalInRange(target,low,high)}tickFormatter({domain,ticks,specifier}){return specifier!=null?buildFormatter(specifier):defaultTimeTickFormat(ticks,domain)}datumFormatter(params){return this.tickFormatter(params)}invert(position,nearest=!1){this.refresh();const{domain}=this;if(nearest){const index=this.invertNearestIndex(position-this.bandwidth/2);return index!=null?domain[index]:void 0}return findMinValue(0,domain.length-1,i=>this.ordinalRange(i)>=position?domain[i]:void 0)??domain[0]}getIndex(value){const sortedTimestamps=this.getSortedTimestamps(),n=Number(value);if(n<sortedTimestamps[0])return;let i=this.findInterval(n);return this.isReversed&&(i=this.domain.length-i-1),i}},__name(_a97,"_OrdinalTimeScale"),_a97);function getDefaultTicks(domain,maxTickCount,isReversed,visibleRange){const ticks=[],tickEvery=Math.ceil(domain.length/maxTickCount),tickOffset=Math.floor(tickEvery/2),startIndex=Math.floor(visibleRange[0]*domain.length),endIndex=Math.ceil(visibleRange[1]*domain.length);for(let index=startIndex;index<endIndex;index+=1){const tickIndex=isReversed?domain.length-1-index:index;(tickEvery<=0||(tickIndex+tickOffset)%tickEvery===0)&&ticks.push(domain[index])}return isReversed&&ticks.reverse(),ticks}__name(getDefaultTicks,"getDefaultTicks");var Vec4={bottomCenter,center,clone,collides,end,from,height,round:round2,start,topCenter,origin,width};function start(a){return{x:a.x1,y:a.y1}}__name(start,"start");function end(a){return{x:a.x2,y:a.y2}}__name(end,"end");function topCenter(a){return{x:(a.x1+a.x2)/2,y:Math.min(a.y1,a.y2)}}__name(topCenter,"topCenter");function center(a){return{x:(a.x1+a.x2)/2,y:(a.y1+a.y2)/2}}__name(center,"center");function bottomCenter(a){return{x:(a.x1+a.x2)/2,y:Math.max(a.y1,a.y2)}}__name(bottomCenter,"bottomCenter");function width(a){return Math.abs(a.x2-a.x1)}__name(width,"width");function height(a){return Math.abs(a.y2-a.y1)}__name(height,"height");function round2(a){return{x1:Math.round(a.x1),y1:Math.round(a.y1),x2:Math.round(a.x2),y2:Math.round(a.y2)}}__name(round2,"round2");function clone(a){return{x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2}}__name(clone,"clone");function collides(a,b){const an=normalise(a),bn=normalise(b);return an.x1<=bn.x2&&an.x2>=bn.x1&&an.y1<=bn.y2&&an.y2>=bn.y1}__name(collides,"collides");function normalise(a){return{x1:Math.min(a.x1,a.x2),x2:Math.max(a.x1,a.x2),y1:Math.min(a.y1,a.y2),y2:Math.max(a.y1,a.y2)}}__name(normalise,"normalise");function from(a,b,c,d){if(typeof a=="number")return{x1:a,y1:b,x2:c,y2:d};if("width"in a)return normalise({x1:a.x,y1:a.y,x2:a.x+a.width,y2:a.y+a.height});throw new Error(`Values can not be converted into a vector4: [${JSON.stringify(a)}] [${b}] [${c}] [${d}]`)}__name(from,"from");function origin(){return{x1:0,y1:0,x2:0,y2:0}}__name(origin,"origin");function normalize2(screenMin,min,screenMax,max,target){return min+(max-min)*((target-screenMin)/(screenMax-screenMin))}__name(normalize2,"normalize2");function unnormalize(screenMin,min,screenMax,max,ratio5){return screenMin+(ratio5-min)*((screenMax-screenMin)/(max-min))}__name(unnormalize,"unnormalize");function calcWorldAxis(viewportMin,viewportMax,ratio5){return[unnormalize(viewportMin,ratio5.min,viewportMax,ratio5.max,0),unnormalize(viewportMin,ratio5.min,viewportMax,ratio5.max,1)]}__name(calcWorldAxis,"calcWorldAxis");function calcWorldVec4(viewport,ratioX,ratioY){const[x1,x2]=calcWorldAxis(viewport.x1,viewport.x2,ratioX),[y1,y2]=calcWorldAxis(viewport.y1,viewport.y2,ratioY);return{x1,x2,y1,y2}}__name(calcWorldVec4,"calcWorldVec4");function panAxesUnnormalized(worldMin,worldMax,viewportMin,viewportMax,targetMin,targetMax){if(viewportMin<=targetMin&&targetMax<=viewportMax)return viewportMin;const minDiff=targetMin-viewportMin,maxDiff=targetMax-viewportMax,diff2=Math.abs(minDiff)<Math.abs(maxDiff)?minDiff:maxDiff;return clamp(worldMin,viewportMin+diff2,worldMax)}__name(panAxesUnnormalized,"panAxesUnnormalized");function calcPanToBBoxRatios(viewportBBox,ratios,targetBBox){const{x:ratioX={min:0,max:1},y:ratioY={min:0,max:1}}=ratios,target=Vec4.from(targetBBox),viewport=Vec4.from(viewportBBox),world=calcWorldVec4(viewport,ratioX,ratioY),x=panAxesUnnormalized(world.x1,world.x2,viewport.x1,viewport.x2,target.x1,target.x2),y=panAxesUnnormalized(world.y1,world.y2,viewport.y1,viewport.y2,target.y1,target.y2),result={x:{min:normalize2(viewport.x1,ratioX.min,viewport.x2,ratioX.max,x),max:normalize2(viewport.x1,ratioX.min,viewport.x2,ratioX.max,x+viewportBBox.width)},y:{min:normalize2(viewport.y1,ratioY.min,viewport.y2,ratioY.max,y),max:normalize2(viewport.y1,ratioY.min,viewport.y2,ratioY.max,y+viewportBBox.height)}},diffX=result.x.max-result.x.min,diffY=result.y.max-result.y.min;return result.x.min=clamp(0,result.x.min,1-diffX),result.x.max=result.x.min+diffX,result.y.min=clamp(0,result.y.min,1-diffY),result.y.max=result.y.min+diffY,result}__name(calcPanToBBoxRatios,"calcPanToBBoxRatios");var expectedMementoKeys=["rangeX","rangeY","ratioX","ratioY","autoScaledAxes"],_a98,ZoomManagerAutoScaleAxis=(_a98=class{constructor(){this.enabled=!1,this.padding=0,this.manuallyAdjusted=!1}},__name(_a98,"ZoomManagerAutoScaleAxis"),_a98),rangeValidator=__name(axis=>attachDescription((value,{options})=>!ContinuousScale.is(axis==null?void 0:axis.scale)&&!OrdinalTimeScale.is(axis==null?void 0:axis.scale)||value==null||options.end==null?!0:value<=options.end,"to be less than end"),"rangeValidator"),_a99,ZoomManager=(_a99=class extends BaseManager{constructor(fireChartEvent,layoutManager){super(),this.fireChartEvent=fireChartEvent,this.mementoOriginatorKey="zoom",this.axisZoomManagers=new Map,this.state=new StateTracker(void 0,"initial"),this.axes=[],this.didLayoutAxes=!1,this.autoScaleYAxis=new ZoomManagerAutoScaleAxis,this.lastRestoredState=void 0,this.independentAxes=!1,this.navigatorModule=!1,this.zoomModule=!1,this.pendingMemento=void 0,this.destroyFns.push(layoutManager.addListener("layout:complete",()=>{const{pendingMemento}=this,shouldPerformInitialLayout=!this.didLayoutAxes;this.didLayoutAxes=!0,pendingMemento?this.restoreMemento(pendingMemento.version,pendingMemento.mementoVersion,pendingMemento.memento):shouldPerformInitialLayout&&this.autoScaleYZoom("zoom-manager")}))}createMemento(){return this.getMementoRanges()}guardMemento(blob,messages){if(blob==null)return!0;if(!isObject(blob))return!1;for(const key of Object.keys(blob))if(!expectedMementoKeys.includes(key))return!1;const primaryX=this.getPrimaryAxis("x"),primaryY=this.getPrimaryAxis("y"),zoomMementoDefs={rangeX:{start:and(or(number,date),rangeValidator(primaryX)),end:or(number,date)},rangeY:{start:and(or(number,date),rangeValidator(primaryY)),end:or(number,date)},ratioX:{start:and(ratio,lessThan("end")),end:ratio},ratioY:{start:and(ratio,lessThan("end")),end:ratio},autoScaledAxes:arrayOf(union("y"))},result=validate(blob,zoomMementoDefs);return result.errors.length>0?(messages.push(...result.errors.map(e=>e.message)),!1):!0}restoreMemento(version,mementoVersion,memento){var _a294;const{independentAxes}=this;if(!this.axes||!this.didLayoutAxes){this.pendingMemento={version,mementoVersion,memento};return}this.pendingMemento=void 0;const zoom=this.getDefinedZoom();if(memento!=null&&memento.rangeX?zoom.x=this.rangeToRatio(memento.rangeX,"x")??{min:0,max:1}:memento!=null&&memento.ratioX?zoom.x={min:memento.ratioX.start??0,max:memento.ratioX.end??1}:zoom.x={min:0,max:1},!this.navigatorModule||this.zoomModule){let yAutoScale=(_a294=memento==null?void 0:memento.autoScaledAxes)==null?void 0:_a294.includes("y");memento!=null&&memento.rangeY?(zoom.y=this.rangeToRatio(memento.rangeY,"y")??{min:0,max:1},yAutoScale??(yAutoScale=!1)):memento!=null&&memento.ratioY?(zoom.y={min:memento.ratioY.start??0,max:memento.ratioY.end??1},yAutoScale??(yAutoScale=!1)):(zoom.y={min:0,max:1},yAutoScale??(yAutoScale=!0)),zoom.autoScaleYAxis=yAutoScale}if(this.lastRestoredState=zoom,independentAxes!==!0){this.updateZoom("zoom-manager",zoom);return}const primaryX=this.getPrimaryAxis("x"),primaryY=this.getPrimaryAxis("y");for(const axis of[primaryX,primaryY])axis&&this.updateAxisZoom("zoom-manager",axis.id,zoom[axis.direction])}updateAxes(axes){this.axes=axes;const zoomManagers=new Map(axes.map(axis=>[axis.id,this.axisZoomManagers.get(axis.id)]));this.axisZoomManagers.clear();for(const axis of axes)this.axisZoomManagers.set(axis.id,zoomManagers.get(axis.id)??new AxisZoomManager(axis));this.state.size>0&&axes.length>0&&this.updateZoom(this.state.stateId(),this.state.stateValue())}setIndependentAxes(independent=!0){this.independentAxes=independent}setAutoScaleYAxis(enabled,padding){this.autoScaleYAxis.enabled=enabled,this.autoScaleYAxis.padding=padding}setNavigatorEnabled(enabled=!0){this.navigatorModule=enabled}setZoomModuleEnabled(enabled=!0){this.zoomModule=enabled}isNavigatorEnabled(){return this.navigatorModule}isZoomEnabled(){return this.zoomModule}updateZoom(callerId,newZoom){if(newZoom!=null&&newZoom.x&&(newZoom.x.min<0||newZoom.x.max>1)&&(logger_exports.warnOnce(`Attempted to update x-axis zoom to an invalid ratio of [{ min: ${newZoom.x.min}, max: ${newZoom.x.max} }], expecting a ratio of 0 to 1, ignoring.`),newZoom.x=void 0),newZoom!=null&&newZoom.y&&(newZoom.y.min<0||newZoom.y.max>1)&&(logger_exports.warnOnce(`Attempted to update y-axis zoom to an invalid ratio of [{ min: ${newZoom.y.min}, max: ${newZoom.y.max} }], expecting a ratio of 0 to 1, ignoring.`),newZoom.y=void 0),this.axisZoomManagers.size===0){const stateId=this.state.stateId();(stateId==="initial"||stateId===callerId)&&this.state.set(callerId,newZoom);return}this.state.set(callerId,newZoom);const autoScaleYAxis=newZoom==null?void 0:newZoom.autoScaleYAxis;autoScaleYAxis!=null&&(this.autoScaleYAxis.manuallyAdjusted=!autoScaleYAxis),this.axisZoomManagers.forEach(axis=>{axis.updateZoom(callerId,newZoom==null?void 0:newZoom[axis.getDirection()])}),this.applyChanges(callerId)}updateAxisZoom(callerId,axisId,newZoom){var _a294;(_a294=this.axisZoomManagers.get(axisId))==null||_a294.updateZoom(callerId,newZoom),this.applyChanges(callerId)}resetZoom(callerId){var _a294,_b,_c,_d;this.autoScaleYAxis.manuallyAdjusted=!1;const zoom=this.getRestoredZoom();this.updateZoom(callerId,{x:{min:((_a294=zoom==null?void 0:zoom.x)==null?void 0:_a294.min)??0,max:((_b=zoom==null?void 0:zoom.x)==null?void 0:_b.max)??1},y:{min:((_c=zoom==null?void 0:zoom.y)==null?void 0:_c.min)??0,max:((_d=zoom==null?void 0:zoom.y)==null?void 0:_d.max)??1},autoScaleYAxis:(zoom==null?void 0:zoom.autoScaleYAxis)??!0})}resetAxisZoom(callerId,axisId){const axisZoomManager=this.axisZoomManagers.get(axisId),direction=axisZoomManager==null?void 0:axisZoomManager.getDirection();if(direction==null)return;const restoredZoom=this.getRestoredZoom();if(direction==="y"){const autoScaleYAxis=(restoredZoom==null?void 0:restoredZoom.autoScaleYAxis)??!0;this.autoScaleYAxis.manuallyAdjusted=!autoScaleYAxis}this.updateAxisZoom(callerId,axisId,(restoredZoom==null?void 0:restoredZoom[direction])??{min:0,max:1})}setAxisManuallyAdjusted(_callerId,axisId){var _a294;((_a294=this.axisZoomManagers.get(axisId))==null?void 0:_a294.getDirection())==="y"&&(this.autoScaleYAxis.manuallyAdjusted=!0)}updatePrimaryAxisZoom(callerId,direction,newZoom){const primaryAxis=this.getPrimaryAxis(direction);primaryAxis&&this.updateAxisZoom(callerId,primaryAxis.id,newZoom)}panToBBox(callerId,seriesRect,target){if(!this.isZoomEnabled()&&!this.isNavigatorEnabled())return!1;const zoom=this.getZoom();if(zoom===void 0||!zoom.x&&!zoom.y)return!1;if(!(seriesRect.width>0&&seriesRect.height>0&&Math.abs(target.width)<=Math.abs(seriesRect.width)&&Math.abs(target.height)<=Math.abs(seriesRect.height)))return logger_exports.warnOnce("cannot pan to target BBox - chart too small?"),!1;const newZoom=calcPanToBBoxRatios(seriesRect,zoom,target);return this.independentAxes?(this.updatePrimaryAxisZoom(callerId,"x",newZoom.x),this.updatePrimaryAxisZoom(callerId,"y",newZoom.y)):this.updateZoom(callerId,newZoom),!0}fireZoomPanStartEvent(callerId){this.listeners.dispatch("zoom-pan-start",{type:"zoom-pan-start",callerId})}extendToEnd(callerId,direction,extent2){return this.extendWith(callerId,direction,end2=>Number(end2)-extent2)}extendWith(callerId,direction,fn){const axis=this.getPrimaryAxis(direction);if(!axis)return;const extents=this.getDomainExtents(axis);if(!extents)return;const[,end2]=extents,start2=fn(end2),ratio5=this.rangeToRatio({start:start2,end:end2},direction);ratio5&&this.updateZoom(callerId,{[direction]:ratio5})}updateWith(callerId,direction,fn){const axis=this.getPrimaryAxis(direction);if(!axis)return;const extents=this.getDomainExtents(axis);if(!extents)return;let[start2,end2]=extents;[start2,end2]=fn(start2,end2);const ratio5=this.rangeToRatio({start:start2,end:end2},direction);ratio5&&this.updateZoom(callerId,{[direction]:ratio5})}getZoom(){let x,y;if(this.axisZoomManagers.forEach(axis=>{axis.getDirection()==="x"?x??(x=axis.getZoom()):axis.getDirection()==="y"&&(y??(y=axis.getZoom()))}),x||y)return{x,y}}getAxisZoom(axisId){var _a294;return((_a294=this.axisZoomManagers.get(axisId))==null?void 0:_a294.getZoom())??{min:0,max:1}}getAxisZooms(){const axes={};for(const[axisId,axis]of this.axisZoomManagers.entries())axes[axisId]={direction:axis.getDirection(),zoom:axis.getZoom()};return axes}getRestoredZoom(){return this.lastRestoredState}getPrimaryAxisId(direction){var _a294;return(_a294=this.getPrimaryAxis(direction))==null?void 0:_a294.id}isVisibleItemsCountAtLeast(zoom,minVisibleItems){const xAxis=this.getPrimaryAxis("x"),yAxis=this.getPrimaryAxis("y"),processedSeriesIds=new Set;let visibleItemsCount=0;const xVisibleRange=[zoom.x.min,zoom.x.max],yVisibleRange=[zoom.y.min,zoom.y.max];for(const series of(xAxis==null?void 0:xAxis.boundSeries)??[]){processedSeriesIds.add(series.id);const remainingItems=minVisibleItems-(visibleItemsCount??0),seriesVisibleItems=series.getVisibleItems(xVisibleRange,yVisibleRange,remainingItems);if(visibleItemsCount+=seriesVisibleItems,visibleItemsCount>=minVisibleItems)return!0}for(const series of(yAxis==null?void 0:yAxis.boundSeries)??[]){if(processedSeriesIds.has(series.id))continue;const remainingItems=minVisibleItems-(visibleItemsCount??0),seriesVisibleItems=series.getVisibleItems(xVisibleRange,yVisibleRange,remainingItems);if(visibleItemsCount+=seriesVisibleItems,visibleItemsCount>=minVisibleItems)return!0}return processedSeriesIds.size===0}getMementoRanges(){const zoom=this.getDefinedZoom();let autoScaledAxes;return this.autoScaleYAxis.enabled&&(autoScaledAxes=this.autoScaleYAxis.manuallyAdjusted?[]:["y"]),{rangeX:this.getRangeDirection(zoom.x,"x"),rangeY:this.getRangeDirection(zoom.y,"y"),ratioX:{start:zoom.x.min,end:zoom.x.max},ratioY:{start:zoom.y.min,end:zoom.y.max},autoScaledAxes}}autoScaleYZoom(callerId,applyChanges=!0){var _a294,_b;if(!this.isZoomEnabled())return;const{independentAxes,autoScaleYAxis}=this,zoom=this.getZoom();if((zoom==null?void 0:zoom.x)==null||!autoScaleYAxis.enabled||autoScaleYAxis.manuallyAdjusted)return;const{padding}=autoScaleYAxis;let zoomY;if(((_a294=zoom.x)==null?void 0:_a294.min)===0&&((_b=zoom.x)==null?void 0:_b.max)===1?zoomY={min:0,max:1}:independentAxes?zoomY=this.primaryAxisZoom("y",zoom.x,{padding}):zoomY=this.combinedAxisZoom("y",zoom.x,{padding}),zoomY!=null){if(independentAxes){const primaryAxis=this.getPrimaryAxis("y"),primaryAxisManager=primaryAxis==null?void 0:this.axisZoomManagers.get(primaryAxis.id);primaryAxisManager==null||primaryAxisManager.updateZoom("zoom-manager",zoomY)}else for(const axisZoomManager of this.axisZoomManagers.values())axisZoomManager.getDirection()==="y"&&axisZoomManager.updateZoom("zoom-manager",zoomY);applyChanges&&this.applyChanges(callerId)}}applyChanges(callerId){if(this.autoScaleYZoom(callerId,!1),!Array.from(this.axisZoomManagers.values(),axis=>axis.applyChanges()).includes(!0))return;const axes={};for(const[axisId,axis]of this.axisZoomManagers.entries())axes[axisId]=axis.getZoom();this.listeners.dispatch("zoom-change",{type:"zoom-change",...this.getZoom(),axes,callerId}),this.fireChartEvent({type:"zoom",...this.getMementoRanges()})}getRangeDirection(ratio5,direction){const axis=this.getPrimaryAxis(direction);if(!axis||!ContinuousScale.is(axis.scale)&&!OrdinalTimeScale.is(axis.scale))return;const extents=this.getDomainPixelExtents(axis);if(!extents)return;const[d0,d1]=extents;let start2,end2;return d0<=d1?(start2=axis.scale.invert(0),end2=axis.scale.invert(d0+(d1-d0)*ratio5.max)):(start2=axis.scale.invert(d0-(d0-d1)*ratio5.min),end2=axis.scale.invert(0)),{start:start2,end:end2}}rangeToRatio(range3,direction){var _a294,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l;const axis=this.getPrimaryAxis(direction);if(!axis)return;const extents=this.getDomainPixelExtents(axis);if(!extents)return;const[d0,d1]=extents;let r0=range3.start==null?d0:(_b=(_a294=axis.scale).convert)==null?void 0:_b.call(_a294,range3.start),r1=range3.end==null?d1:(_d=(_c=axis.scale).convert)==null?void 0:_d.call(_c,range3.end);if(!isFiniteNumber(r0)||!isFiniteNumber(r1))return;const[dMin,dMax]=[Math.min(d0,d1),Math.max(d0,d1)];if(r0<dMin||r0>dMax){logger_exports.warnOnce(`Invalid range start [${range3.start}], expecting a value between [${(_f=(_e=axis.scale).invert)==null?void 0:_f.call(_e,d0)}] and [${(_h=(_g=axis.scale).invert)==null?void 0:_h.call(_g,d1)}], ignoring.`);return}if(r1<dMin||r1>dMax){logger_exports.warnOnce(`Invalid range end [${range3.end}], expecting a value between [${(_j=(_i=axis.scale).invert)==null?void 0:_j.call(_i,d0)}] and [${(_l=(_k=axis.scale).invert)==null?void 0:_l.call(_k,d1)}], ignoring.`);return}r0=Math.min(dMax,Math.max(dMin,r0)),r1=Math.min(dMax,Math.max(dMin,r1));const diff2=d1-d0,min=Math.abs((r0-d0)/diff2),max=Math.abs((r1-d0)/diff2);return{min,max}}getPrimaryAxis(direction){var _a294;return(_a294=this.axes)==null?void 0:_a294.find(a=>a.direction===direction)}getDomainExtents(axis){const{domain}=axis.scale,d0=domain.at(0),d1=domain.at(-1);if(!(d0==null||d1==null))return[d0,d1]}getDomainPixelExtents(axis){var _a294,_b,_c,_d;const{domain}=axis.scale,d0=(_b=(_a294=axis.scale).convert)==null?void 0:_b.call(_a294,domain.at(0)),d1=(_d=(_c=axis.scale).convert)==null?void 0:_d.call(_c,domain.at(-1));if(!(!isFiniteNumber(d0)||!isFiniteNumber(d1)))return[d0,d1]}getDefinedZoom(){var _a294,_b,_c,_d;const zoom=this.getZoom();return{x:{min:((_a294=zoom==null?void 0:zoom.x)==null?void 0:_a294.min)??0,max:((_b=zoom==null?void 0:zoom.x)==null?void 0:_b.max)??1},y:{min:((_c=zoom==null?void 0:zoom.y)==null?void 0:_c.min)??0,max:((_d=zoom==null?void 0:zoom.y)==null?void 0:_d.max)??1}}}zoomBounds(xAxis,yAxis,zoom,padding){const xScale=xAxis.scale,xScaleRange=xScale.range;xScale.range=[0,1];const yScale=yAxis.scale,yScaleRange=yScale.range;yScale.range=[0,1];let min=1,minPadding=!1,max=0,maxPadding=!1;for(const series of yAxis.boundSeries){const{connectsToYAxis}=series,yValues=series.getRange("y",[zoom.min,zoom.max]);for(const yValue of yValues){const y=yScale.convert(yValue);Number.isFinite(y)&&(y<min&&(min=y,minPadding=!connectsToYAxis||yValue<0),y>max&&(max=y,maxPadding=!connectsToYAxis||yValue>0))}}if(isFiniteNumber(yAxis.min)&&(min=0),isFiniteNumber(yAxis.max)&&(max=1),xScale.range=xScaleRange,yScale.range=yScaleRange,min>=max)return;const totalPadding=(minPadding?padding:0)+(maxPadding?padding:0),paddedDelta=Math.min((max-min)*(1+totalPadding),1);if(!(paddedDelta<=0)){if(minPadding&&maxPadding){const mid=(max+min)/2;min=mid-paddedDelta/2,max=mid+paddedDelta/2}else!minPadding&&maxPadding?max=min+paddedDelta:minPadding&&!maxPadding&&(min=max-paddedDelta);return min<0?(max+=-min,min=0):max>1&&(min-=max-1,max=1),{min,max}}}primaryAxisZoom(direction,zoom,{padding=0}={}){const crossDirection=direction==="x"?"y":"x",xAxis=this.getPrimaryAxis(crossDirection),yAxis=this.getPrimaryAxis(direction);if(!(xAxis==null||yAxis==null))return this.zoomBounds(xAxis,yAxis,zoom,padding)}combinedAxisZoom(direction,zoom,{padding=0}={}){const crossDirection=direction==="x"?"y":"x",seriesXAxes=new Map;for(const xAxis of this.axes)if(xAxis.direction===crossDirection)for(const series of xAxis.boundSeries)seriesXAxes.set(series,xAxis);let min=1,max=0;for(const yAxis of this.axes)if(yAxis.direction===direction)for(const series of yAxis.boundSeries){const xAxis=seriesXAxes.get(series);if(xAxis==null)continue;const bounds=this.zoomBounds(xAxis,yAxis,zoom,padding);if(bounds==null)return;min=Math.min(min,bounds.min),max=Math.max(max,bounds.max)}const delta3=1e-6;if(min<delta3&&(min=0),max>1-delta3&&(max=1),!(min>max))return{min,max}}},__name(_a99,"ZoomManager"),_a99),_a100,AxisZoomManager=(_a100=class{constructor(axis){this.axis=axis;const[min=0,max=1]=axis.visibleRange;this.state=new StateTracker({min,max}),this.currentZoom=this.state.stateValue()}getDirection(){return this.axis.direction}updateZoom(callerId,newZoom){this.state.set(callerId,newZoom)}getZoom(){return deepClone(this.state.stateValue())}hasChanges(){const currentZoom=this.currentZoom,pendingZoom=this.state.stateValue();return currentZoom.min!==pendingZoom.min||currentZoom.max!==pendingZoom.max}applyChanges(){const hasChanges=this.hasChanges();return this.currentZoom=this.state.stateValue(),hasChanges}},__name(_a100,"AxisZoomManager"),_a100);function circleRectOverlap(c,unitCenter,x,y,w,h){if(c.size===0)return!1;let cx=c.x,cy=c.y;unitCenter!=null&&(cx-=(unitCenter.x-.5)*c.size,cy-=(unitCenter.y-.5)*c.size);let edgeX=cx;cx<x?edgeX=x:cx>x+w&&(edgeX=x+w);let edgeY=cy;cy<y?edgeY=y:cy>y+h&&(edgeY=y+h);const dx=cx-edgeX,dy=cy-edgeY;return Math.sqrt(dx*dx+dy*dy)<=c.size*.5}__name(circleRectOverlap,"circleRectOverlap");function rectRectOverlap(r1,x2,y2,w2,h2){const xOverlap=r1.x+r1.width>x2&&r1.x<x2+w2,yOverlap=r1.y+r1.height>y2&&r1.y<y2+h2;return xOverlap&&yOverlap}__name(rectRectOverlap,"rectRectOverlap");function rectContainsRect(r1,r2x,r2y,r2w,r2h){return r2x+r2w<r1.x+r1.width&&r2x>r1.x&&r2y>r1.y&&r2y+r2h<r1.y+r1.height}__name(rectContainsRect,"rectContainsRect");function isPointLabelDatum(x){return x!=null&&typeof x.point=="object"&&typeof x.label=="object"}__name(isPointLabelDatum,"isPointLabelDatum");var labelPlacements={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},"top-left":{x:-1,y:-1},"top-right":{x:1,y:-1},"bottom-left":{x:-1,y:1},"bottom-right":{x:1,y:1}};function placeLabels(data,bounds,padding=5){var _a294;const result=new Map,previousResults=[],sortedDataClone=new Map([...data.entries()].map(([k,d])=>[k,d.toSorted((a,b)=>b.point.size-a.point.size)])),dataValues=[...sortedDataClone.values()].flat();for(const[seriesId,datums]of sortedDataClone.entries()){const labels=[];if((_a294=datums[0])!=null&&_a294.label){for(let index=0,ln=datums.length;index<ln;index++){const d=datums[index],{point,label,anchor}=d,{text:text2,width:width2,height:height2}=label,r=point.size*.5;let dx=0,dy=0;if(r>0&&d.placement!=null){const placement=labelPlacements[d.placement];dx=(width2*.5+r+padding)*placement.x,dy=(height2*.5+r+padding)*placement.y}const x=point.x-width2*.5+dx-(((anchor==null?void 0:anchor.x)??.5)-.5)*point.size,y=point.y-height2*.5+dy-(((anchor==null?void 0:anchor.y)??.5)-.5)*point.size;if(!(!bounds||rectContainsRect(bounds,x,y,width2,height2))||dataValues.some(dataDatum=>circleRectOverlap(dataDatum.point,dataDatum.anchor,x,y,width2,height2))||previousResults.some(pr=>rectRectOverlap(pr,x,y,width2,height2)))continue;const resultDatum={index,text:text2,x,y,width:width2,height:height2,datum:d};labels.push(resultDatum),previousResults.push(resultDatum)}result.set(seriesId,labels)}}return result}__name(placeLabels,"placeLabels");function axisLabelsOverlap(data,padding=0){const result=[];for(let index=0;index<data.length;index++){const datum=data[index],{point:{x,y},label:{text:text2}}=datum;let{width:width2,height:height2}=datum.label;if(width2+=padding,height2+=padding,result.some(l=>rectRectOverlap(l,x,y,width2,height2)))return!0;result.push({index,text:text2,x,y,width:width2,height:height2,datum})}return!1}__name(axisLabelsOverlap,"axisLabelsOverlap");var _a101,SeriesLabelLayoutManager=(_a101=class{constructor(){this.labelData=new Map}updateLabels(placedLabelSeries,padding,seriesRect=BBox.zero){var _a294;const bounds={x:-padding.left,y:-padding.top,width:seriesRect.width+padding.left+padding.right,height:seriesRect.height+padding.top+padding.bottom},expectedSeriesId=new Set(placedLabelSeries.map(s=>s.id));for(const seriesId of this.labelData.keys())expectedSeriesId.has(seriesId)||this.labelData.delete(seriesId);for(const series of placedLabelSeries){const labelData=series.getLabelData();labelData.every(isPointLabelDatum)&&this.labelData.set(series.id,labelData)}const placedLabels=placeLabels(this.labelData,bounds,5);for(const series of placedLabelSeries)(_a294=series.updatePlacedLabelData)==null||_a294.call(series,placedLabels.get(series.id)??[])}},__name(_a101,"SeriesLabelLayoutManager"),_a101),_a102,LegendManager=(_a102=class extends BaseManager{constructor(){super(...arguments),this.mementoOriginatorKey="legend",this.legendDataMap=new Map}createMemento(){return this.getData().filter(({hideInLegend,isFixed})=>!hideInLegend&&!isFixed).map(({enabled,seriesId,itemId,legendItemName})=>({visible:enabled,seriesId,itemId,legendItemName}))}guardMemento(blob){return blob==null||isArray(blob)}restoreMemento(_version,_mementoVersion,memento){memento==null||memento.forEach(datum=>{const{seriesId,data}=this.getRestoredData(datum)??{};!seriesId||!data||this.updateData(seriesId,data)}),this.update()}getRestoredData(datum){const{seriesId,itemId,legendItemName,visible}=datum;if(seriesId){const data=(this.legendDataMap.get(seriesId)??[]).map(d=>{const match=d.seriesId===seriesId&&(!itemId||d.itemId===itemId);return match&&d.isFixed&&this.warnFixed(d.seriesId,d.itemId),!d.isFixed&&match?{...d,enabled:visible}:d});return{seriesId,data}}if(!(itemId==null&&legendItemName==null))for(const legendDatum of this.getData()){if(itemId!=null&&legendDatum.itemId!==itemId||legendItemName!=null&&legendDatum.legendItemName!==legendItemName)continue;if(legendDatum.isFixed){this.warnFixed(legendDatum.seriesId,itemId);return}const seriesLegendData=(this.legendDataMap.get(legendDatum.seriesId)??[]).map(d=>d.itemId===itemId||d.legendItemName===legendItemName?{...d,enabled:visible}:d);return{seriesId:legendDatum.seriesId,data:seriesLegendData}}}warnFixed(seriesId,itemId){logger_exports.warnOnce(`The legend item with seriesId [${seriesId}] and itemId [${itemId}] is not configurable, this series item cannot be toggled through the legend.`)}update(data){this.listeners.dispatch("legend-change",{type:"legend-change",legendData:data??this.getData()})}updateData(seriesId,data=[]){this.legendDataMap.set(seriesId,data)}clearData(){this.legendDataMap.clear()}toggleItem(enabled,seriesId,itemId,legendItemName){if(legendItemName){this.getData().forEach(datum=>{const newData=(this.legendDataMap.get(datum.seriesId)??[]).map(d=>d.legendItemName===legendItemName?{...d,enabled}:d);this.updateData(datum.seriesId,newData)});return}const seriesLegendData=this.getData(seriesId),singleLegendItem=seriesLegendData.length===1,data=seriesLegendData.map(datum=>itemId==null&&singleLegendItem||datum.itemId===itemId?{...datum,enabled}:datum);this.updateData(seriesId,data)}getData(seriesId){return seriesId?this.legendDataMap.get(seriesId)??[]:[...this.legendDataMap].reduce((data,[_,legendData])=>data.concat(legendData),[])}getDatum({seriesId,itemId}={}){return this.getData(seriesId).find(datum=>datum.itemId===itemId)}getSeriesEnabled(seriesId){const data=this.getData(seriesId);if(data.length>0)return data.some(d=>d.enabled)}getItemEnabled({seriesId,itemId}={}){var _a294;return((_a294=this.getDatum({seriesId,itemId}))==null?void 0:_a294.enabled)??!0}},__name(_a102,"LegendManager"),_a102),_a103,SeriesStateManager=(_a103=class{constructor(){this.groups={}}registerSeries({internalId,seriesGrouping,visible,type}){var _a294;seriesGrouping&&((_a294=this.groups)[type]??(_a294[type]={}),this.groups[type][internalId]={grouping:seriesGrouping,visible})}updateSeries({internalId,seriesGrouping,visible,type}){var _a294;if(!seriesGrouping)return;const entry=(_a294=this.groups[type])==null?void 0:_a294[internalId];entry&&(entry.grouping=seriesGrouping,entry.visible=visible)}deregisterSeries({internalId,type}){this.groups[type]&&delete this.groups[type][internalId],this.groups[type]&&Object.keys(this.groups[type]).length===0&&delete this.groups[type]}getVisiblePeerGroupIndex({type,seriesGrouping,visible}){if(!seriesGrouping)return{visibleGroupCount:visible?1:0,visibleSameStackCount:visible?1:0,index:0};const visibleGroupsSet=new Set,visibleSameStackSet=new Set;for(const entry of Object.values(this.groups[type]??{}))entry.visible&&(visibleGroupsSet.add(entry.grouping.groupIndex),entry.grouping.groupIndex===seriesGrouping.groupIndex&&visibleSameStackSet.add(entry.grouping.stackIndex));const visibleGroups=Array.from(visibleGroupsSet);return visibleGroups.sort((a,b)=>a-b),{visibleGroupCount:visibleGroups.length,visibleSameStackCount:visibleSameStackSet.size,index:visibleGroups.indexOf(seriesGrouping.groupIndex)}}},__name(_a103,"SeriesStateManager"),_a103),ChartUpdateType=(ChartUpdateType2=>(ChartUpdateType2[ChartUpdateType2.FULL=0]="FULL",ChartUpdateType2[ChartUpdateType2.UPDATE_DATA=1]="UPDATE_DATA",ChartUpdateType2[ChartUpdateType2.PROCESS_DATA=2]="PROCESS_DATA",ChartUpdateType2[ChartUpdateType2.PERFORM_LAYOUT=3]="PERFORM_LAYOUT",ChartUpdateType2[ChartUpdateType2.SERIES_UPDATE=4]="SERIES_UPDATE",ChartUpdateType2[ChartUpdateType2.PRE_SCENE_RENDER=5]="PRE_SCENE_RENDER",ChartUpdateType2[ChartUpdateType2.SCENE_RENDER=6]="SCENE_RENDER",ChartUpdateType2[ChartUpdateType2.NONE=7]="NONE",ChartUpdateType2))(ChartUpdateType||{}),_a104,UpdateService=(_a104=class{constructor(updateCallback){this.updateCallback=updateCallback,this.events=new EventEmitter}addListener(eventName,listener){return this.events.on(eventName,listener)}removeListener(eventName,listener){return this.events.on(eventName,listener)}destroy(){this.events.clear()}update(type=0,options){this.updateCallback(type,options)}dispatchUpdateComplete(){this.events.emit("update-complete",{type:"update-complete"})}dispatchPreDomUpdate(){this.events.emit("pre-dom-update",{type:"pre-dom-update"})}dispatchPreSceneRender(){this.events.emit("pre-scene-render",{type:"pre-scene-render"})}dispatchProcessData({series}){this.events.emit("process-data",{type:"process-data",series})}},__name(_a104,"UpdateService"),_a104),_a105,ChartContext=(_a105=class{constructor(chart,vars){this.callbackCache=new CallbackCache,this.chartEventManager=new ChartEventManager,this.highlightManager=new HighlightManager,this.layoutManager=new LayoutManager,this.localeManager=new LocaleManager,this.seriesStateManager=new SeriesStateManager,this.stateManager=new StateManager,this.seriesLabelLayoutManager=new SeriesLabelLayoutManager,this.contextModules=[];const{scene,root,syncManager,container,fireEvent,updateCallback,updateMutex,styleContainer,chartType,domMode}=vars;this.chartService=chart,this.syncManager=syncManager,this.domManager=new DOMManager(container,styleContainer,domMode),this.widgets=new WidgetSet(this.domManager);const canvasElement=this.domManager.addChild("canvas","scene-canvas",scene==null?void 0:scene.canvas.element);this.scene=scene??new Scene({canvasElement}),this.scene.setRoot(root),this.axisManager=new AxisManager(root),this.legendManager=new LegendManager,this.annotationManager=new AnnotationManager(chart.annotationRoot,fireEvent),this.chartTypeOriginator=new ChartTypeOriginator(chart),this.interactionManager=new InteractionManager,this.contextMenuRegistry=new ContextMenuRegistry,this.updateService=new UpdateService(updateCallback),this.proxyInteractionService=new ProxyInteractionService(this.localeManager,this.domManager),this.historyManager=new HistoryManager(this.chartEventManager),this.animationManager=new AnimationManager(this.interactionManager,updateMutex),this.dataService=new DataService(this.animationManager),this.tooltipManager=new TooltipManager(this.localeManager,this.domManager,chart.tooltip),this.zoomManager=new ZoomManager(fireEvent,this.layoutManager);for(const module of moduleRegistry.byType("context")){if(!module.chartTypes.includes(chartType))continue;const moduleInstance=module.moduleFactory(this);this.contextModules.push(moduleInstance),this[module.contextKey]=moduleInstance}}destroy(){this.animationManager.destroy(),this.highlightManager.destroy(),this.axisManager.destroy(),this.callbackCache.invalidateCache(),this.chartEventManager.destroy(),this.domManager.destroy(),this.highlightManager.destroy(),this.proxyInteractionService.destroy(),this.syncManager.destroy(),this.tooltipManager.destroy(),this.zoomManager.destroy(),this.widgets.destroy(),this.contextModules.forEach(m=>m.destroy())}},__name(_a105,"ChartContext"),_a105),_a106,ChartHighlight=(_a106=class extends BaseProperties{constructor(){super(...arguments),this.range="tooltip"}},__name(_a106,"ChartHighlight"),_a106);__decorateClass([TempValidate(UNION(["tooltip","node"],"a range"))],ChartHighlight.prototype,"range",2);function setsEqual(a,b){if(a.size!==b.size)return!1;for(const value of a)if(!b.has(value))return!1;return!0}__name(setsEqual,"setsEqual");function idsMapEqual(a,b){if(a==null||b==null)return a===b;if(a.size!==b.size)return!1;for(const[key,aValue]of a){const bValue=b.get(key);if(bValue==null||!setsEqual(aValue,bValue))return!1}return!0}__name(idsMapEqual,"idsMapEqual");function propsEqual(a,b){if(a.length!==b.length)return!1;for(let i=0;i<a.length;i+=1){const{type:typeA,idsMap:idsMapA,scopes:scopesA,data:dataA,...propA}=a[i],{type:typeB,idsMap:idsMapB,scopes:scopesB,data:dataB,...propB}=b[i];if(typeA!==typeB||scopesA&&scopesB&&!arraysEqual(scopesA,scopesB)||dataA&&dataB&&dataA!==dataB||!objectsEqual(propA,propB)||!idsMapEqual(idsMapA,idsMapB))return!1}return!0}__name(propsEqual,"propsEqual");function optsEqual(a,b){const{props:propsA,...restA}=a,{props:propsB,...restB}=b;return objectsEqual(restA,restB)&&propsEqual(propsA,propsB)}__name(optsEqual,"optsEqual");function canReuseCachedData(cachedDataItem,data,ids,opts){return data===cachedDataItem.data&&arraysEqual(ids,cachedDataItem.ids)&&optsEqual(opts,cachedDataItem.opts)}__name(canReuseCachedData,"canReuseCachedData");var _a107,DiscreteDomain=(_a107=class{constructor(){this.domain=new Set}static is(value){return value instanceof _a107}extend(val){this.domain.add(val)}getDomain(){return Array.from(this.domain)}},__name(_a107,"_DiscreteDomain"),_a107),_a108,ContinuousDomain=(_a108=class{constructor(){this.domain=[1/0,-1/0]}static is(value){return value instanceof _a108}static extendDomain(values,domain=[1/0,-1/0]){for(const value of values)typeof value=="number"&&(domain[0]>value&&(domain[0]=value),domain[1]<value&&(domain[1]=value));return domain}extend(value){this.domain[0]>value&&(this.domain[0]=value),this.domain[1]<value&&(this.domain[1]=value)}getDomain(){return[...this.domain]}},__name(_a108,"_ContinuousDomain"),_a108),MIN=0,MAX=1,SPAN=2,_a109,RangeLookup=(_a109=class{constructor(allValues){const dataLength=allValues.reduce((acc,v)=>Math.max(acc,v.length),0);let maxLevelSize=1<<32-Math.clz32(dataLength);dataLength===maxLevelSize/2&&(maxLevelSize=maxLevelSize>>>1),this.maxLevelSize=maxLevelSize;const buffer=new Float64Array((maxLevelSize*2-1)*2).fill(NaN);for(const values of allValues)for(let i=0;i<values.length;i+=1){const value=Number(values[i]),bufferIndex=maxLevelSize+i-1,bufferMinIndex=(bufferIndex*SPAN|0)+MIN,bufferMaxIndex=(bufferIndex*SPAN|0)+MAX,prevMinValue=buffer[bufferMinIndex],prevMaxValue=buffer[bufferMaxIndex];(!Number.isFinite(prevMinValue)||value<prevMinValue)&&(buffer[bufferMinIndex]=value),(!Number.isFinite(prevMaxValue)||value>prevMaxValue)&&(buffer[bufferMaxIndex]=value)}for(let size=maxLevelSize/2|0;size>=1;size=size/2|0){const start2=size-1|0,end2=start2+size|0;for(let i=0;i<size;i+=1){const nodeIndex=start2+i,leftIndex=end2+i*2,rightIndex=leftIndex+1,aMin=buffer[(leftIndex*SPAN|0)+MIN],bMin=buffer[(rightIndex*SPAN|0)+MIN];buffer[(nodeIndex*SPAN|0)+MIN]=!Number.isFinite(bMin)||aMin<bMin?aMin:bMin;const aMax=buffer[(leftIndex*SPAN|0)+MAX],bMax=buffer[(rightIndex*SPAN|0)+MAX];buffer[(nodeIndex*SPAN|0)+MAX]=!Number.isFinite(bMax)||aMax>bMax?aMax:bMax}}this.buffer=buffer}computeRangeInto(buffer,start2,end2,bufferIndex,currentStart,step,into){const currentEnd=currentStart+step-1;if(currentEnd<start2||currentStart>=end2)return into;if(currentStart>=start2&&currentEnd<end2){const min=buffer[(bufferIndex*SPAN|0)+MIN],max=buffer[(bufferIndex*SPAN|0)+MAX];Number.isFinite(min)&&(into[0]=Math.min(into[0],min)),Number.isFinite(max)&&(into[1]=Math.max(into[1],max))}else step>1&&(bufferIndex=bufferIndex*2|0,step=step/2|0,this.computeRangeInto(buffer,start2,end2,bufferIndex+1|0,currentStart,step,into),this.computeRangeInto(buffer,start2,end2,bufferIndex+2|0,currentStart+step,step,into));return into}rangeBetween(start2,end2){if(start2>end2)return[NaN,NaN];const{maxLevelSize,buffer}=this,range3=[1/0,-1/0];return this.computeRangeInto(buffer,start2,end2,0,0,maxLevelSize,range3),range3}get range(){const{buffer}=this;return[buffer[MIN],buffer[MAX]]}},__name(_a109,"RangeLookup"),_a109),DOMAIN_RANGES=Symbol("domain-ranges");function toKeyString(keys){return keys.map(key=>isObject(key)?JSON.stringify(key):key).join("-")}__name(toKeyString,"toKeyString");function fixNumericExtent(extent2){const numberExtent=extent2==null?void 0:extent2.map(Number);return numberExtent!=null&&numberExtent.every(Number.isFinite)?numberExtent:[]}__name(fixNumericExtent,"fixNumericExtent");function getMissCount(scopeProvider,missMap){return(missMap==null?void 0:missMap.get(scopeProvider.id))??0}__name(getMissCount,"getMissCount");function isScoped(obj){return"scopes"in obj&&Array.isArray(obj.scopes)}__name(isScoped,"isScoped");function createArray(length2,value){const out=[];for(let i=0;i<length2;i+=1)out[i]=value;return out}__name(createArray,"createArray");function datumKeys(keys,columnScope,datumIndex){var _a294;const out=[];for(const k of keys){const key=(_a294=k.get(columnScope))==null?void 0:_a294[datumIndex];if(key==null)return;out.push(key)}return out}__name(datumKeys,"datumKeys");function getPathComponents(path){const components=[];let matchIndex=0,matchGroup;const regExp=new RegExp(`((?:(?:^|\\.)\\s*\\w+|\\[\\s*(?:'(?:[^']|(?<!\\\\)\\\\')*'|"(?:[^"]|(?<!\\\\)\\\\")*"|-?\\d+)\\s*\\])\\s*)`,"g");for(;matchGroup=regExp.exec(path);){if(matchGroup.index!==matchIndex)return;matchIndex=matchGroup.index+matchGroup[0].length;const match=matchGroup[1].trim();if(match.startsWith("."))components.push(match.slice(1).trim());else if(match.startsWith("[")){const accessor=match.slice(1,-1).trim();accessor.startsWith("'")?components.push(accessor.slice(1,-1).replace(new RegExp("(?<!\\\\)\\\\'","g"),"'")):accessor.startsWith('"')?components.push(accessor.slice(1,-1).replace(new RegExp('(?<!\\\\)\\\\"',"g"),'"')):components.push(accessor)}else components.push(match)}if(matchIndex===path.length)return components}__name(getPathComponents,"getPathComponents");function createPathAccessor(components){return datum=>{let current=datum;for(const component of components)current=current[component];return current}}__name(createPathAccessor,"createPathAccessor");var _a110,DataModel=(_a110=class{constructor(opts,mode="standalone",suppressFieldDotNotation=!1){var _a294;this.opts=opts,this.mode=mode,this.suppressFieldDotNotation=suppressFieldDotNotation,this.debug=Debug.create(!0,"data-model"),this.scopeCache=new Map,this.keys=[],this.values=[],this.aggregates=[],this.groupProcessors=[],this.propertyProcessors=[],this.reducers=[],this.processors=[],this.markScopeDatumInvalid=function(scopes,data,datumIndex,invalidData){for(const scope of scopes)invalidData.has(scope)||invalidData.set(scope,createArray(data.length,!1)),invalidData.get(scope)[datumIndex]=!0};let keys=!0;for(const next of opts.props){if(next.type==="key"&&!keys)throw new Error("AG Charts - internal config error: keys must come before values.");next.type==="value"&&keys&&(keys=!1)}const verifyMatchGroupId=__name(({matchGroupIds=[]})=>{for(const matchGroupId of matchGroupIds)if(this.values.every(def=>def.groupId!==matchGroupId))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${matchGroupId}).`)},"verifyMatchGroupId"),keyScopes=new Set,valueScopes=new Set;for(const def of opts.props){const scopes=def.type==="key"?keyScopes:valueScopes;switch(isScoped(def)&&((_a294=def.scopes)==null||_a294.forEach(s=>scopes.add(s))),def.type){case"key":this.keys.push({...def,index:this.keys.length,missing:new Map});break;case"value":if(def.property==null)throw new Error(`AG Charts - internal config error: no properties specified for value definitions: ${JSON.stringify(def)}`);this.values.push({...def,index:this.values.length,missing:new Map});break;case"aggregate":verifyMatchGroupId(def),this.aggregates.push({...def,index:this.aggregates.length});break;case"group-value-processor":verifyMatchGroupId(def),this.groupProcessors.push({...def,index:this.groupProcessors.length});break;case"property-value-processor":this.propertyProcessors.push({...def,index:this.propertyProcessors.length});break;case"reducer":this.reducers.push({...def,index:this.reducers.length});break;case"processor":this.processors.push({...def,index:this.processors.length});break}}if(this.opts.groupByKeys||this.opts.groupByFn!=null){const ungroupedScopes=new Set(valueScopes.values());if(keyScopes.forEach(s=>ungroupedScopes.delete(s)),ungroupedScopes.size>0)throw new Error(`AG Charts - scopes missing key for grouping, illegal configuration: ${[...ungroupedScopes.values()]}`)}}resolveProcessedDataDefById(scope,searchId){var _a294;const def=(_a294=this.scopeCache.get(scope.id))==null?void 0:_a294.get(searchId);if(!def)throw new Error(`AG Charts - didn't find property definition for [${searchId}, ${scope.id}]`);return{index:def.index,def}}resolveProcessedDataIndexById(scope,searchId){return this.resolveProcessedDataDefById(scope,searchId).index}resolveKeysById(scope,searchId,processedData){const index=this.resolveProcessedDataIndexById(scope,searchId),keys=processedData.keys[index];if(keys==null)throw new Error(`AG Charts - didn't find keys for [${searchId}, ${scope.id}]`);return keys.get(scope.id)}hasColumnById(scope,searchId){var _a294;return((_a294=this.scopeCache.get(scope.id))==null?void 0:_a294.get(searchId))!=null}resolveColumnById(scope,searchId,processedData){var _a294;const index=this.resolveProcessedDataIndexById(scope,searchId),column=(_a294=processedData.columns)==null?void 0:_a294[index];if(column==null)throw new Error(`AG Charts - didn't find column for [${searchId}, ${scope.id}]`);return column}*forEachDatum(scope,processedData,group){const columnIndex=processedData.columnScopes.findIndex(s=>s.has(scope.id));for(const datumIndex of group.datumIndices[columnIndex]??[])yield processedData.columns[columnIndex][datumIndex]}*forEachGroupDatum(scope,processedData){const columnIndex=processedData.columnScopes.findIndex(s=>s.has(scope.id)),output={groupIndex:0,columnIndex},empty=[];for(const group of processedData.groups){output.group=group;let valueIndex=0;for(const datumIndex of group.datumIndices[columnIndex]??empty)output.datumIndex=datumIndex,output.valueIndex=valueIndex++,yield output;output.groupIndex++}}*forEachGroupDatumTuple(scope,processedData){const output={columnIndex:processedData.columnScopes.findIndex(s=>s.has(scope.id)),datumIndexes:[void 0,void 0,void 0]};for(const next of this.forEachGroupDatum(scope,processedData))output.group=output.nextGroup,output.groupIndex=output.nextGroupIndex,output.nextGroup=next.group,output.nextGroupIndex=next.groupIndex,output.datumIndexes[0]=output.datumIndexes[1],output.datumIndexes[1]=output.datumIndexes[2],output.datumIndexes[2]=next.datumIndex,output.group!=null&&output.datumIndexes[1]!=null&&(yield output);output.group=output.nextGroup,output.groupIndex=output.nextGroupIndex,output.nextGroup=void 0,output.nextGroupIndex=void 0,output.datumIndexes[0]=output.datumIndexes[1],output.datumIndexes[1]=output.datumIndexes[2],output.datumIndexes[2]=void 0,output.group!=null&&output.datumIndexes[1]!=null&&(yield output)}getDomain(scope,searchId,type,processedData){const domains=this.getDomainsByType(type??"value",processedData);return(domains==null?void 0:domains[this.resolveProcessedDataIndexById(scope,searchId)])??[]}getDomainBetweenRange(scope,searchIds,[i0,i1],processedData){const columnIndices=searchIds.map(searchId=>this.resolveProcessedDataIndexById(scope,searchId)),cacheKey=columnIndices.join(":"),domainRanges=processedData[DOMAIN_RANGES];let rangeLookup=domainRanges.get(cacheKey);if(rangeLookup==null){const values=columnIndices.map(columnIndex=>processedData.columns[columnIndex]);rangeLookup=new RangeLookup(values),domainRanges.set(cacheKey,rangeLookup)}return rangeLookup.rangeBetween(i0,i1)}getDomainsByType(type,processedData){switch(type){case"key":return processedData.domain.keys;case"value":return processedData.domain.values;case"aggregate":return processedData.domain.aggValues;case"group-value-processor":return processedData.domain.groups;default:return null}}processData(sources){const{opts:{groupByKeys,groupByFn},aggregates,groupProcessors,reducers,processors,propertyProcessors}=this,start2=performance.now();if(groupByKeys&&this.keys.length===0)return;let processedData=this.extractData(sources);groupByKeys?processedData=this.groupData(processedData):groupByFn&&(processedData=this.groupData(processedData,groupByFn(processedData))),groupProcessors.length>0&&processedData.type==="grouped"&&this.postProcessGroups(processedData),aggregates.length>0&&processedData.type==="ungrouped"?this.aggregateUngroupedData(processedData):aggregates.length>0&&processedData.type==="grouped"&&this.aggregateGroupedData(processedData),propertyProcessors.length>0&&this.postProcessProperties(processedData),reducers.length>0&&this.reduceData(processedData),processors.length>0&&this.postProcessData(processedData),this.warnDataMissingProperties(sources);const end2=performance.now();return processedData.time=end2-start2,this.debug.check()&&logProcessedData(processedData),this.processScopeCache(),processedData}warnDataMissingProperties(sources){var _a294;if(sources.size!==0)for(const def of iterate(this.keys,this.values))for(const[scope,missCount]of def.missing){if(missCount<(((_a294=sources.get(scope))==null?void 0:_a294.length)??1/0))continue;const scopeHint=scope==null?"":` for ${scope}`;logger_exports.warnOnce(`the key '${def.property}' was not found in any data element${scopeHint}.`)}}processScopeCache(){var _a294;this.scopeCache.clear();for(const def of iterate(this.keys,this.values,this.aggregates))if(def.idsMap)for(const[scope,ids]of def.idsMap)for(const id of ids)if(!this.scopeCache.has(scope))this.scopeCache.set(scope,new Map([[id,def]]));else{if((_a294=this.scopeCache.get(scope))!=null&&_a294.has(id))throw new Error("duplicate definition ids on the same scope are not allowed.");this.scopeCache.get(scope).set(id,def)}}valueGroupIdxLookup({matchGroupIds}){const result=[];for(const[index,def]of this.values.entries())(!matchGroupIds||def.groupId&&matchGroupIds.includes(def.groupId))&&result.push(index);return result}valueIdxLookup(scopes,prop){const noScopesToMatch=scopes==null||scopes.length===0,propId=typeof prop=="string"?prop:prop.id,hasMatchingScopeId=__name(def=>{if(def.idsMap){for(const[scope,ids]of def.idsMap)if(scopes!=null&&scopes.includes(scope)&&ids.has(propId))return!0}return!1},"hasMatchingScopeId"),result=this.values.reduce((res,def,index)=>((def.scopes==null||noScopesToMatch&&!def.scopes.length||def.scopes.some(s=>scopes==null?void 0:scopes.includes(s)))&&(def.property===propId||def.id===propId||hasMatchingScopeId(def))&&res.push(index),res),[]);if(result.length===0)throw new Error(`AG Charts - configuration error, unknown property ${JSON.stringify(prop)} in scope(s) ${JSON.stringify(scopes)}`);return result}extractData(sources){const{dataDomain,processValue,allScopesHaveSameDefs}=this.initDataDomainProcessor(),{keys:keyDefs,values:valueDefs}=this,{invalidData,invalidKeys,allKeyMappings}=this.extractKeys(keyDefs,sources,processValue),{columns,columnScopes,partialValidDataCount,maxDataLength}=this.extractValues(invalidData,valueDefs,sources,invalidKeys,processValue),propertyDomain=__name(def=>{const defDomain=dataDomain.get(def),result=defDomain.getDomain();return ContinuousDomain.is(defDomain)&&result[0]>result[1]?[]:result},"propertyDomain");return{type:"ungrouped",input:{count:maxDataLength},scopes:new Set(sources.keys()),dataSources:sources,aggregation:void 0,keys:[...allKeyMappings.values()],columns,columnScopes,invalidKeys,invalidData,domain:{keys:keyDefs.map(propertyDomain),values:valueDefs.map(propertyDomain)},defs:{allScopesHaveSameDefs,keys:keyDefs,values:valueDefs},partialValidDataCount,time:0,[DOMAIN_RANGES]:new Map}}extractKeys(keyDefs,sources,processValue){const invalidKeys=new Map,invalidData=new Map,allKeys=new Map;let keyDefKeys,scopeDataProcessed;const cloneScope=__name((source,target)=>{const sourceScope=scopeDataProcessed.get(source);keyDefKeys.set(target,keyDefKeys.get(sourceScope)),invalidKeys.has(sourceScope)&&(invalidKeys.set(target,invalidKeys.get(sourceScope)),invalidData.set(target,invalidData.get(sourceScope)))},"cloneScope");for(const keyDef of keyDefs){const{invalidValue,scopes:keyScopes}=keyDef;keyDefKeys=new Map,scopeDataProcessed=new Map,allKeys.set(keyDef,keyDefKeys);for(const scope of keyScopes??[]){const data=sources.get(scope)??[];if(scopeDataProcessed.has(data)){cloneScope(data,scope);continue}const keys=[];keyDefKeys.set(scope,keys),scopeDataProcessed.set(data,scope);let invalidScopeKeys,invalidScopeData;for(let datumIndex=0;datumIndex<data.length;datumIndex++){if(data[datumIndex]==null||typeof data[datumIndex]!="object")continue;const result=processValue(keyDef,data[datumIndex],datumIndex,scope);if(result.valid){keys.push(result.value);continue}keys.push(invalidValue),invalidScopeKeys??(invalidScopeKeys=createArray(data.length,!1)),invalidScopeData??(invalidScopeData=createArray(data.length,!1)),invalidScopeKeys[datumIndex]=!0,invalidScopeData[datumIndex]=!0}invalidScopeKeys&&invalidScopeData&&(invalidKeys.set(scope,invalidScopeKeys),invalidData.set(scope,invalidScopeData))}}return{invalidData,invalidKeys,allKeyMappings:allKeys}}extractValues(invalidData,valueDefs,sources,invalidKeys,processValue){var _a294;let partialValidDataCount=0;const columns=[],allColumnScopes=[];let maxDataLength=0;for(const def of valueDefs){const{invalidValue}=def;if(new Set(def.scopes.map(s=>sources.get(s))).size>1)throw new Error(`AG Charts - more than one data source for: ${JSON.stringify(def)}`);const columnScopes=new Set(def.scopes),columnScope=first(def.scopes),columnSource=sources.get(columnScope),column=new Array;for(let datumIndex=0;datumIndex<columnSource.length;datumIndex++){if(columnSource[datumIndex]==null||typeof columnSource[datumIndex]!="object")continue;const valueDatum=columnSource[datumIndex],invalidKey=(_a294=invalidKeys.get(columnScope))==null?void 0:_a294[datumIndex],result=processValue(def,valueDatum,datumIndex,def.scopes);let value=result.value;(invalidKey||!result.valid)&&this.markScopeDatumInvalid(def.scopes,columnSource,datumIndex,invalidData),invalidKey?value=invalidValue:result.valid||(partialValidDataCount+=1,value=invalidValue),column[datumIndex]=value}columns.push(column),allColumnScopes.push(columnScopes),maxDataLength=Math.max(maxDataLength,column.length)}return{columns,columnScopes:allColumnScopes,partialValidDataCount,maxDataLength}}groupData(data,groupingFn){var _a294;const groups=new Map,{keys:dataKeys,columns:allColumns,columnScopes,invalidKeys,invalidData}=data,allScopes=data.scopes,processedColumnIndexes=new Set;for(const scope of allScopes){const scopeColumnIndexes=allColumns.map((_,idx)=>idx).filter(idx=>!processedColumnIndexes.has(idx)&&columnScopes[idx].has(scope));if(scopeColumnIndexes.length===0)continue;for(const idx of scopeColumnIndexes)processedColumnIndexes.add(idx);const siblingScopes=new Set;for(const columnIdx of scopeColumnIndexes)for(const columnScope of columnScopes[columnIdx])siblingScopes.add(columnScope);const scopeKeys=dataKeys.map(k=>k.get(scope)).filter(k=>k!=null),firstColumn=allColumns[first(scopeColumnIndexes)],scopeInvalidData=invalidData==null?void 0:invalidData.get(scope),scopeInvalidKeys=invalidKeys==null?void 0:invalidKeys.get(scope);for(let datumIndex=0;datumIndex<firstColumn.length;datumIndex++){if((scopeInvalidKeys==null?void 0:scopeInvalidKeys[datumIndex])===!0)continue;const keys=scopeKeys.map(k=>k[datumIndex]);if(keys==null||keys.length===0)throw new Error("AG Charts - no keys found for scope: "+scope);const group=(groupingFn==null?void 0:groupingFn(keys))??keys,groupStr=toKeyString(group),outputGroup=groups.get(groupStr)??{keys:group,datumIndices:[],validScopes:allScopes};if(groups.has(groupStr)||groups.set(groupStr,outputGroup),(scopeInvalidData==null?void 0:scopeInvalidData[datumIndex])===!0){outputGroup.validScopes===allScopes&&(outputGroup.validScopes=new Set(allScopes.values()));for(const invalidScope of siblingScopes)outputGroup.validScopes.delete(invalidScope)}for(const columnIdx of scopeColumnIndexes)(_a294=outputGroup.datumIndices)[columnIdx]??(_a294[columnIdx]=[]),outputGroup.datumIndices[columnIdx].push(datumIndex)}}const resultGroups=[],resultData=[];for(const{keys,datumIndices,validScopes}of groups.values())resultGroups.push(keys),resultData.push({datumIndices,keys,aggregation:[],validScopes});return{...data,type:"grouped",domain:{...data.domain,groups:resultGroups},groups:resultData}}aggregateUngroupedData(processedData){const domainAggValues=this.aggregates.map(()=>[1/0,-1/0]);processedData.domain.aggValues=domainAggValues;const{keys,columns,dataSources}=processedData,onlyScope=first(dataSources.keys()),rawData=dataSources.get(onlyScope);processedData.aggregation=rawData==null?void 0:rawData.map((_,datumIndex)=>{var _a294,_b,_c;const aggregation=[];for(const[index,def]of this.aggregates.entries()){const indices=this.valueGroupIdxLookup(def);let groupAggValues=((_a294=def.groupAggregateFunction)==null?void 0:_a294.call(def))??[1/0,-1/0];const valuesToAgg=indices.map(columnIndex=>columns[columnIndex][datumIndex]),k=datumKeys(keys,onlyScope,datumIndex),valuesAgg=k!=null?def.aggregateFunction(valuesToAgg,k):void 0;valuesAgg&&(groupAggValues=((_b=def.groupAggregateFunction)==null?void 0:_b.call(def,valuesAgg,groupAggValues))??ContinuousDomain.extendDomain(valuesAgg,groupAggValues));const finalValues=((_c=def.finalFunction)==null?void 0:_c.call(def,groupAggValues))??groupAggValues;aggregation[index]=finalValues,ContinuousDomain.extendDomain(finalValues,domainAggValues[index])}return aggregation})}aggregateGroupedData(processedData){var _a294,_b,_c;const domainAggValues=this.aggregates.map(()=>[1/0,-1/0]);processedData.domain.aggValues=domainAggValues;const{columns}=processedData;for(const[index,def]of this.aggregates.entries()){const indices=this.valueGroupIdxLookup(def);for(const group of processedData.groups){group.aggregation??(group.aggregation=[]);const groupKeys=group.keys;let groupAggValues=((_a294=def.groupAggregateFunction)==null?void 0:_a294.call(def))??[1/0,-1/0];const maxDatumIndex=Math.max(...indices.map(columnIndex=>{var _a295;return((_a295=group.datumIndices[columnIndex])==null?void 0:_a295.length)??0}));for(let datumIndex=0;datumIndex<maxDatumIndex;datumIndex++){const valuesToAgg=indices.map(columnIndex=>{var _a295;return columns[columnIndex][(_a295=group.datumIndices[columnIndex])==null?void 0:_a295[datumIndex]]}),valuesAgg=def.aggregateFunction(valuesToAgg,groupKeys);valuesAgg&&(groupAggValues=((_b=def.groupAggregateFunction)==null?void 0:_b.call(def,valuesAgg,groupAggValues))??ContinuousDomain.extendDomain(valuesAgg,groupAggValues))}const finalValues=((_c=def.finalFunction)==null?void 0:_c.call(def,groupAggValues))??groupAggValues;group.aggregation[index]=finalValues,ContinuousDomain.extendDomain(finalValues,domainAggValues[index])}}}postProcessGroups(processedData){const{groupProcessors}=this,{columnScopes,columns,invalidData}=processedData;for(const processor of groupProcessors){const valueIndexes=this.valueGroupIdxLookup(processor),adjustFn=processor.adjust()();for(const dataGroup of processedData.groups)adjustFn(columns,valueIndexes,dataGroup);for(const valueIndex of valueIndexes){const isDiscrete=this.values[valueIndex].valueType==="category",column=columns[valueIndex],columnScope=first(columnScopes[valueIndex]),invalidDatums=invalidData==null?void 0:invalidData.get(columnScope),domain=isDiscrete?new DiscreteDomain:new ContinuousDomain;for(let datumIndex=0;datumIndex<column.length;datumIndex+=1)(invalidDatums==null?void 0:invalidDatums[datumIndex])!==!0&&domain.extend(column[datumIndex]);processedData.domain.values[valueIndex]=domain.getDomain()}}}postProcessProperties(processedData){for(const{adjust,property,scopes}of this.propertyProcessors)for(const idx of this.valueIdxLookup(scopes,property))adjust()(processedData,idx)}reduceData(processedData){var _a294;processedData.reduced??(processedData.reduced={});const{dataSources,keys}=processedData;for(const def of this.reducers){const reducer=def.reducer();let accValue=def.initialValue;if(processedData.type==="grouped")for(const group of processedData.groups)accValue=reducer(accValue,group.keys);else{const onlyScope=first(dataSources.keys()),keyColumns=keys.map(k=>k.get(onlyScope)).filter(k=>k!=null),keysParam=keyColumns.map(()=>{}),rawData=dataSources.get(onlyScope);for(let datumIndex=0;datumIndex<rawData.length;datumIndex+=1){for(let keyIdx=0;keyIdx<keysParam.length;keyIdx++)keysParam[keyIdx]=(_a294=keyColumns[keyIdx])==null?void 0:_a294[datumIndex];accValue=reducer(accValue,keysParam)}}processedData.reduced[def.property]=accValue}}postProcessData(processedData){processedData.reduced??(processedData.reduced={});for(const def of this.processors)processedData.reduced[def.property]=def.calculate(processedData,processedData.reduced[def.property])}initDataDomainProcessor(){const{keys:keyDefs,values:valueDefs}=this,scopes=new Set;for(const valueDef of valueDefs)if(valueDef.scopes)for(const scope of valueDef.scopes)scopes.add(scope);const dataDomain=new Map,processorFns=new Map;let allScopesHaveSameDefs=!0;const initDataDomain=__name(()=>{for(const def of iterate(keyDefs,valueDefs))def.valueType==="category"?dataDomain.set(def,new DiscreteDomain):(dataDomain.set(def,new ContinuousDomain),allScopesHaveSameDefs&&(allScopesHaveSameDefs=(def.scopes??[]).length===scopes.size))},"initDataDomain");initDataDomain();const accessors=this.buildAccessors(iterate(keyDefs,valueDefs)),reusableResult={value:void 0,missing:!1,valid:!1};return{dataDomain,processValue:__name((def,datum,idx,valueScopes)=>{var _a294,_b;let valueInDatum,value;if(accessors.has(def.property)){try{value=accessors.get(def.property)(datum)}catch{}valueInDatum=value!=null}else valueInDatum=def.property in datum,value=valueInDatum?datum[def.property]:def.missingValue;def.forceValue!=null&&(value=valueInDatum&&isNegative(value)?-1*def.forceValue:def.forceValue,valueInDatum=!0),reusableResult.missing=!valueInDatum;const missingValueDef="missingValue"in def;if(!valueInDatum&&!missingValueDef)if(typeof valueScopes=="string"){const missCount=def.missing.get(valueScopes)??0;def.missing.set(valueScopes,missCount+1)}else for(const scope of valueScopes){const missCount=def.missing.get(scope)??0;def.missing.set(scope,missCount+1)}if(dataDomain.has(def)||initDataDomain(),valueInDatum&&((_a294=def.validation)==null?void 0:_a294.call(def,value,datum,idx))===!1)if(reusableResult.valid=!1,"invalidValue"in def)value=def.invalidValue;else return this.mode!=="integrated"&&logger_exports.warnOnce(`invalid value of type [${typeof value}] for [${def.scopes} / ${def.id}] ignored:`,`[${value}]`),reusableResult.value=void 0,reusableResult;else reusableResult.valid=!0;if(def.processor){let processor=processorFns.get(def);processor==null&&(processor=def.processor(),processorFns.set(def,processor)),value=processor(value,idx)}return(_b=dataDomain.get(def))==null||_b.extend(value),reusableResult.value=value,reusableResult},"processValue"),initDataDomain,scopes,allScopesHaveSameDefs}}buildAccessors(defs){const result=new Map;if(this.suppressFieldDotNotation)return result;for(const def of defs){if(!(def.property.includes(".")||def.property.includes("[")))continue;const components=getPathComponents(def.property);if(components==null){logger_exports.warnOnce("Invalid property path [%s]",def.property);continue}const accessor=createPathAccessor(components);result.set(def.property,accessor)}return result}},__name(_a110,"DataModel"),_a110);function logProcessedData(processedData){const logValues=__name((name,data)=>{data.length>0&&(logger_exports.log(`DataModel.processData() - ${name}`),logger_exports.table(data))},"logValues");logger_exports.log("DataModel.processData() - processedData",processedData),logValues("Key Domains",processedData.domain.keys),logValues("Group Domains",processedData.domain.groups??[]),logValues("Value Domains",processedData.domain.values),logValues("Aggregate Domains",processedData.domain.aggValues??[])}__name(logProcessedData,"logProcessedData");var _a111,_DataController=(_a111=class{constructor(mode,suppressFieldDotNotation){this.mode=mode,this.suppressFieldDotNotation=suppressFieldDotNotation,this.debug=Debug.create(!0,"data-model"),this.requested=[],this.status="setup"}async request(id,data,opts){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");return new Promise((resolve,reject)=>{this.requested.push({id,opts,data,resolve,reject})})}execute(cachedData){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");this.status="executed",this.debug("DataController.execute() - requested",this.requested);const valid=this.validateRequests(this.requested);this.debug("DataController.execute() - validated",valid);const merged=this.mergeRequested(valid);this.debug("DataController.execute() - merged",merged),this.debug.check()&&(getWindow().processedData=[]);const nextCachedData=[];for(const{data,ids,opts,resolves,rejects}of merged){const reusableCache=cachedData==null?void 0:cachedData.find(cacheItem=>canReuseCachedData(cacheItem,data,ids,opts));let dataModel,processedData;if(reusableCache==null)try{dataModel=new DataModel(opts,this.mode,this.suppressFieldDotNotation);const sources=new Map(valid.map(v=>[v.id,v.data]));processedData=dataModel.processData(sources)}catch(error){rejects.forEach(cb=>cb(error));continue}else({dataModel,processedData}=reusableCache);nextCachedData.push({opts,data,ids,dataModel,processedData}),this.debug.check()&&getWindow("processedData").push(processedData),(processedData==null?void 0:processedData.partialValidDataCount)===0?resolves.forEach(resolve=>resolve({dataModel,processedData})):processedData?this.splitResult(dataModel,processedData,ids,resolves):rejects.forEach(cb=>cb(new Error("AG Charts - no processed data generated")))}return nextCachedData}validateRequests(requested){const valid=[];for(const[index,request]of requested.entries())index>0&&request.data.length!==requested[0].data.length&&request.opts.groupByData===!1&&request.opts.groupByKeys===!1?request.reject(new Error("all series[].data arrays must be of the same length and have matching keys.")):valid.push(request);return valid}mergeRequested(requested){const grouped=[];for(const request of requested){const match=grouped.find(_a111.groupMatch(request));match?match.push(request):grouped.push([request])}return grouped.map(_a111.mergeRequests)}splitResult(dataModel,processedData,scopes,resolves){for(let i=0;i<scopes.length;i++){const resolve=resolves[i];resolve({dataModel,processedData})}}static groupMatch({data,opts}){function keys(props2){return props2.filter(p=>p.type==="key").map(p=>p.property).join(";")}__name(keys,"keys");const{groupByData,groupByKeys=!1,groupByFn,props}=opts,propsKeys=keys(props);return([group])=>(groupByData===!1||group.data===data)&&(group.opts.groupByKeys??!1)===groupByKeys&&group.opts.groupByFn===groupByFn&&keys(group.opts.props)===propsKeys}static mergeRequests(requests){const crossScopeMergableTypes=new Set(["key","group-value-processor"]);return requests.reduce((result,{id,data,resolve,reject,opts:{props,...opts}})=>{var _a294;result.ids.push(id),result.rejects.push(reject),result.resolves.push(resolve),result.data??(result.data=data),result.opts??(result.opts={...opts,props:[]});for(const prop of props){const clone2={...prop,scopes:[id],data};_a111.createIdsMap(id,clone2);const match=result.opts.props.find(existing=>existing.type===clone2.type&&(crossScopeMergableTypes.has(existing.type)||existing.data===clone2.data)&&_a111.deepEqual(existing,clone2));if(!match){result.opts.props.push(clone2);continue}match.scopes??(match.scopes=[]),match.scopes.push(...clone2.scopes??[]),(match.type==="key"||match.type==="value")&&((_a294=clone2.idsMap)!=null&&_a294.size)&&_a111.mergeIdsMap(clone2.idsMap,match.idsMap)}return result},{ids:[],rejects:[],resolves:[],data:null,opts:null})}static mergeIdsMap(fromMap,toMap){for(const[scope,ids]of fromMap){const toMapValue=toMap.get(scope);if(toMapValue==null)toMap.set(scope,new Set(ids));else for(const id of ids)toMapValue.add(id)}}static createIdsMap(scope,prop){prop.id!=null&&(prop.idsMap??(prop.idsMap=new Map),prop.idsMap.has(scope)?prop.idsMap.get(scope).add(prop.id):prop.idsMap.set(scope,new Set([prop.id])))}static deepEqual(a,b){if(a===b)return!0;if(a&&b&&typeof a=="object"&&typeof b=="object"){if(a.constructor!==b.constructor)return!1;let i,length2;if(Array.isArray(a)){if(length2=a.length,length2!==b.length)return!1;for(i=length2-1;i>=0;i--)if(!_a111.deepEqual(a[i],b[i]))return!1;return!0}const keys=Object.keys(a);if(length2=keys.length,length2!==Object.keys(b).length)return!1;for(i=length2-1;i>=0;i--){const key=keys[i];if(!_a111.skipKeys.has(key)&&(!Object.hasOwn(b,key)||!_a111.deepEqual(a[key],b[key])))return!1}return!0}return!1}},__name(_a111,"_DataController"),_a111);_DataController.skipKeys=new Set(["id","idsMap","type","scopes","data"]);var DataController=_DataController,_a112,AxisRegistry=(_a112=class{constructor(){this.axesMap=new Map,this.themeTemplates=new Map}register(axisType,module){this.axesMap.set(axisType,module.moduleFactory),module.themeTemplate&&this.setThemeTemplate(axisType,module.themeTemplate)}create(axisType,moduleContext){const axisFactory=this.axesMap.get(axisType);if(axisFactory)return axisFactory(moduleContext);throw new Error(`AG Charts - unknown axis type: ${axisType}`)}has(axisType){return this.axesMap.has(axisType)}keys(){return this.axesMap.keys()}setThemeTemplate(axisType,themeTemplate){return this.themeTemplates.set(axisType,themeTemplate),this}getThemeTemplate(axisType){return this.themeTemplates.get(axisType)}},__name(_a112,"AxisRegistry"),_a112),axisRegistry=new AxisRegistry,EXPECTED_ENTERPRISE_MODULES=[{type:"root",optionsKey:"animation",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"]},{type:"root",optionsKey:"annotations",chartTypes:["cartesian"]},{type:"root",optionsKey:"background",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsInnerKey:"image"},{type:"root",optionsKey:"foreground",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsInnerKey:"image"},{type:"root",optionsKey:"chartToolbar",chartTypes:["cartesian"]},{type:"root",optionsKey:"contextMenu",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"]},{type:"root",optionsKey:"statusBar",chartTypes:["cartesian"],identifier:"status-bar"},{type:"root",optionsKey:"dataSource",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"]},{type:"root",optionsKey:"sync",chartTypes:["cartesian"]},{type:"root",optionsKey:"zoom",chartTypes:["cartesian","topology"]},{type:"root",optionsKey:"ranges",chartTypes:["cartesian"]},{type:"legend",optionsKey:"gradientLegend",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],identifier:"gradient"},{type:"root",optionsKey:"navigator",chartTypes:["cartesian"]},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-number"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"bar",community:!0},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"line",community:!0},{type:"axis",optionsKey:"axes[]",chartTypes:["cartesian"],identifier:"ordinal-time"},{type:"axis-option",optionsKey:"crosshair",chartTypes:["cartesian"]},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"box-plot"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"candlestick"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"cone-funnel"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"funnel"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"ohlc"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"heatmap"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-area"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-bar"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"waterfall"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"nightingale"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-area"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-line"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-bar"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-column"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"sunburst"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"treemap"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-marker"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape-background"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line-background"},{type:"series",optionsKey:"series[]",chartTypes:["flow-proportion"],identifier:"chord"},{type:"series",optionsKey:"series[]",chartTypes:["flow-proportion"],identifier:"sankey"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"pyramid"},{type:"series",optionsKey:"series[]",chartTypes:["gauge"],identifier:"linear-gauge"},{type:"series",optionsKey:"series[]",chartTypes:["gauge"],identifier:"radial-gauge"},{type:"series-option",optionsKey:"errorBar",chartTypes:["cartesian"],identifier:"error-bars"},{type:"context",contextKey:"sharedToolbar",chartTypes:["cartesian"]}];function getEnterpriseSeriesChartTypes(type){var _a294;return(_a294=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type==="series"&&s.identifier===type))==null?void 0:_a294.chartTypes}__name(getEnterpriseSeriesChartTypes,"getEnterpriseSeriesChartTypes");function isEnterpriseCartesian(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="cartesian"))==="cartesian"}__name(isEnterpriseCartesian,"isEnterpriseCartesian");function isEnterprisePolar(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="polar"))==="polar"}__name(isEnterprisePolar,"isEnterprisePolar");function isEnterpriseHierarchy(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="hierarchy"))==="hierarchy"}__name(isEnterpriseHierarchy,"isEnterpriseHierarchy");function isEnterpriseTopology(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="topology"))==="topology"}__name(isEnterpriseTopology,"isEnterpriseTopology");function isEnterpriseFlowProportion(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="flow-proportion"))==="flow-proportion"}__name(isEnterpriseFlowProportion,"isEnterpriseFlowProportion");function isEnterpriseStandalone(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="standalone"))==="standalone"}__name(isEnterpriseStandalone,"isEnterpriseStandalone");function isEnterpriseGauge(seriesType){var _a294;return((_a294=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a294.find(v=>v==="gauge"))==="gauge"}__name(isEnterpriseGauge,"isEnterpriseGauge");function isEnterpriseModule(module){return module.packageType==="enterprise"}__name(isEnterpriseModule,"isEnterpriseModule");function verifyIfModuleExpected(module){if(!isEnterpriseModule(module))throw new Error("AG Charts - internal configuration error, only enterprise modules need verification.");const stub=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type===module.type&&("optionsKey"in s&&"optionsKey"in module?s.optionsKey===module.optionsKey:!0)&&("contextKey"in s&&"contextKey"in module?s.contextKey===module.contextKey:!0)&&s.identifier===module.identifier&&module.chartTypes.every(t=>s.chartTypes.includes(t)));return stub&&(stub.useCount??(stub.useCount=0),stub.useCount++),stub!=null}__name(verifyIfModuleExpected,"verifyIfModuleExpected");function getUnusedExpectedModules(){return EXPECTED_ENTERPRISE_MODULES.filter(({useCount})=>useCount==null||useCount===0)}__name(getUnusedExpectedModules,"getUnusedExpectedModules");var _a113,LegendRegistry=(_a113=class{constructor(){this.legendMap=new Map,this.themeTemplates=new Map}register(legendType,{optionsKey,moduleFactory,themeTemplate}){this.legendMap.set(legendType,{optionsKey,moduleFactory}),this.themeTemplates.set(optionsKey,themeTemplate)}create(legendType,moduleContext){var _a294;const legendFactory=(_a294=this.legendMap.get(legendType))==null?void 0:_a294.moduleFactory;if(legendFactory)return legendFactory(moduleContext);throw new Error(`AG Charts - unknown legend type: ${legendType}`)}getThemeTemplates(){return Object.fromEntries(this.themeTemplates)}getKeys(){return Array.from(this.legendMap.entries()).reduce((result,[legendType,record])=>(result[legendType]=record.optionsKey,result),{})}},__name(_a113,"LegendRegistry"),_a113),legendRegistry=new LegendRegistry,_a114,ChartTypes=(_a114=class extends Map{get(seriesType){return super.get(seriesType)??"unknown"}isCartesian(seriesType){return this.get(seriesType)==="cartesian"}isPolar(seriesType){return this.get(seriesType)==="polar"}isHierarchy(seriesType){return this.get(seriesType)==="hierarchy"}isTopology(seriesType){return this.get(seriesType)==="topology"}isFlowProportion(seriesType){return this.get(seriesType)==="flow-proportion"}isStandalone(seriesType){return this.get(seriesType)==="standalone"}isGauge(seriesType){return this.get(seriesType)==="gauge"}get seriesTypes(){return Array.from(this.keys())}get cartesianTypes(){return this.seriesTypes.filter(t=>this.isCartesian(t))}get polarTypes(){return this.seriesTypes.filter(t=>this.isPolar(t))}get hierarchyTypes(){return this.seriesTypes.filter(t=>this.isHierarchy(t))}get topologyTypes(){return this.seriesTypes.filter(t=>this.isTopology(t))}get flowProportionTypes(){return this.seriesTypes.filter(t=>this.isFlowProportion(t))}get standaloneTypes(){return this.seriesTypes.filter(t=>this.isStandalone(t))}get gaugeTypes(){return this.seriesTypes.filter(t=>this.isGauge(t))}},__name(_a114,"ChartTypes"),_a114),_a115,ChartDefaults=(_a115=class extends Map{set(chartType,defaults){return super.set(chartType,mergeDefaults(defaults,this.get(chartType)))}},__name(_a115,"ChartDefaults"),_a115),chartTypes2=new ChartTypes,publicChartTypes=new ChartTypes,chartDefaults=new ChartDefaults,_a116,SeriesRegistry=(_a116=class{constructor(){this.seriesMap=new Map,this.themeTemplates=new Map}register(seriesType,{chartTypes:[chartType],moduleFactory,tooltipDefaults,defaultAxes,themeTemplate,solo,stackable,groupable,stackedByDefault,hidden}){this.setThemeTemplate(seriesType,themeTemplate),this.seriesMap.set(seriesType,{moduleFactory,tooltipDefaults,defaultAxes,solo,stackable,groupable,stackedByDefault}),chartTypes2.set(seriesType,chartType),hidden||publicChartTypes.set(seriesType,chartType)}create(seriesType,moduleContext){var _a294;const seriesFactory=(_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.moduleFactory;if(seriesFactory)return seriesFactory(moduleContext);throw new Error(`AG Charts - unknown series type: ${seriesType}`)}cloneDefaultAxes(seriesType){var _a294;const defaultAxes=(_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.defaultAxes;return defaultAxes==null?null:{axes:deepClone(defaultAxes)}}setThemeTemplate(seriesType,themeTemplate){const currentTemplate=this.themeTemplates.get(seriesType);this.themeTemplates.set(seriesType,mergeDefaults(themeTemplate,currentTemplate))}getThemeTemplate(seriesType){return this.themeTemplates.get(seriesType)}getTooltipDefauls(seriesType){var _a294;return(_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.tooltipDefaults}isSolo(seriesType){var _a294;return((_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.solo)??!1}isGroupable(seriesType){var _a294;return((_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.groupable)??!1}isStackable(seriesType){var _a294;return((_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.stackable)??!1}isStackedByDefault(seriesType){var _a294;return((_a294=this.seriesMap.get(seriesType))==null?void 0:_a294.stackedByDefault)??!1}},__name(_a116,"SeriesRegistry"),_a116),seriesRegistry=new SeriesRegistry,_a117,_SyncManager=(_a117=class extends BaseManager{constructor(chart){super(),this.chart=chart}subscribe(groupId=_a117.DEFAULT_GROUP){let syncGroup=this.get(groupId);return syncGroup||(syncGroup=new Set,_a117.chartsGroups.set(groupId,syncGroup)),syncGroup.add(this.chart),this}unsubscribe(groupId=_a117.DEFAULT_GROUP){var _a294;return(_a294=this.get(groupId))==null||_a294.delete(this.chart),this}getChart(){return this.chart}getGroup(groupId=_a117.DEFAULT_GROUP){const syncGroup=this.get(groupId);return syncGroup?Array.from(syncGroup):[]}getGroupSiblings(groupId=_a117.DEFAULT_GROUP){return this.getGroup(groupId).filter(chart=>chart!==this.chart)}get(groupId){return _a117.chartsGroups.get(groupId)}},__name(_a117,"_SyncManager"),_a117);_SyncManager.chartsGroups=new Map;_SyncManager.DEFAULT_GROUP=Symbol("sync-group-default");var SyncManager=_SyncManager,_a118,Keyboard=(_a118=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!1}},__name(_a118,"Keyboard"),_a118);__decorateClass([TempValidate()],Keyboard.prototype,"enabled",2);__decorateClass([TempValidate()],Keyboard.prototype,"tabIndex",2);var fromToMotion_exports={};__export(fromToMotion_exports,{NODE_UPDATE_STATE_TO_PHASE_MAPPING:__name(()=>NODE_UPDATE_STATE_TO_PHASE_MAPPING,"NODE_UPDATE_STATE_TO_PHASE_MAPPING"),fromToMotion:__name(()=>fromToMotion,"fromToMotion"),staticFromToMotion:__name(()=>staticFromToMotion,"staticFromToMotion")});var NODE_UPDATE_STATE_TO_PHASE_MAPPING={added:"add",updated:"update",removed:"remove",unknown:"initial","no-op":"none"};function fromToMotion(groupId,subId,animationManager,selectionsOrNodes,fns,getDatumId,diff2){const{fromFn,toFn,applyFn=__name((node,props)=>node.setProperties(props),"applyFn")}=fns,{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes),processNodes=__name((liveNodes,subNodes)=>{let prevFromProps,liveNodeIndex=0,nodeIndex=0;for(const node of subNodes){const isLive=liveNodes[liveNodeIndex]===node,ctx={last:nodeIndex>=subNodes.length-1,lastLive:liveNodeIndex>=liveNodes.length-1,prev:subNodes[nodeIndex-1],prevFromProps,prevLive:liveNodes[liveNodeIndex-1],next:subNodes[nodeIndex+1],nextLive:liveNodes[liveNodeIndex+(isLive?1:0)]},animationId=`${groupId}_${subId}_${node.id}`;animationManager.stopByAnimationId(animationId);let status="unknown";isLive?getDatumId&&diff2&&(status=calculateStatus(node,node.datum,getDatumId,diff2)):status="removed",node.transitionOut=status==="removed";const{phase,start:start2,finish,delay,duration,...from3}=fromFn(node,node.datum,status,ctx),{phase:toPhase,start:toStart,finish:toFinish,delay:toDelay,duration:toDuration,...to}=toFn(node,node.datum,status,ctx),collapsable=finish==null;animationManager.animate({id:animationId,groupId,phase:phase??toPhase??"update",duration:duration??toDuration,delay:delay??toDelay,from:from3,to,ease:easeOut,collapsable,onPlay:__name(()=>{const startProps={...start2,...toStart,...from3};applyFn(node,startProps,"start")},"onPlay"),onUpdate(props){applyFn(node,props,"update")},onStop:__name(()=>{const endProps={...start2,...toStart,...from3,...to,...finish,...toFinish};applyFn(node,endProps,"end")},"onStop")}),isLive&&liveNodeIndex++,nodeIndex++,prevFromProps=from3}},"processNodes");let selectionIndex=0;for(const selection of selections){const selectionNodes=selection.nodes(),liveNodes=selectionNodes.filter(n=>!selection.isGarbage(n));processNodes(liveNodes,selectionNodes),animationManager.animate({id:`${groupId}_${subId}_selection_${selectionIndex}`,groupId,phase:"end",from:0,to:1,ease:easeOut,onStop(){selection.cleanup()}}),selectionIndex++}processNodes(nodes,nodes)}__name(fromToMotion,"fromToMotion");function staticFromToMotion(groupId,subId,animationManager,selectionsOrNodes,from3,to,extraOpts){const{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes),{start:start2,finish,phase}=extraOpts;animationManager.animate({id:`${groupId}_${subId}`,groupId,phase:phase??"update",from:from3,to,ease:easeOut,onPlay:__name(()=>{if(start2){for(const node of nodes)node.setProperties(start2);for(const selection of selections)for(const node of selection.nodes())node.setProperties(start2)}},"onPlay"),onUpdate(props){for(const node of nodes)node.setProperties(props);for(const selection of selections)for(const node of selection.nodes())node.setProperties(props)},onStop:__name(()=>{for(const node of nodes)node.setProperties({...to,...finish});for(const selection of selections){for(const node of selection.nodes())node.setProperties({...to,...finish});selection.cleanup()}},"onStop")})}__name(staticFromToMotion,"staticFromToMotion");function calculateStatus(node,datum,getDatumId,diff2){const id=getDatumId(node,datum);return diff2.added.has(id)?"added":diff2.removed.has(id)?"removed":"updated"}__name(calculateStatus,"calculateStatus");var resetMotion_exports={};__export(resetMotion_exports,{resetMotion:__name(()=>resetMotion,"resetMotion")});function resetMotion(selectionsOrNodes,propsFn){const{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes);for(const selection of selections){for(const node of selection.nodes()){const from3=propsFn(node,node.datum);node.setProperties(from3)}selection.cleanup()}for(const node of nodes){const from3=propsFn(node,node.datum);node.setProperties(from3)}}__name(resetMotion,"resetMotion");var debugColor="color: green",debugQuietColor="color: grey";function StateMachineProperty(){return addObserverToInstanceProperty(()=>{})}__name(StateMachineProperty,"StateMachineProperty");function applyProperties(parentState,childState){const childProperties=listDecoratedProperties(childState);if(childProperties.length===0)return;const properties=extractDecoratedProperties(parentState);for(const property of childProperties)property in properties&&(childState[property]=properties[property])}__name(applyProperties,"applyProperties");var _a119,AbstractStateMachine=(_a119=class{transitionRoot(event,data){this.parent?this.parent.transitionRoot(event,data):this.transition(event,data)}},__name(_a119,"AbstractStateMachine"),_a119),_a120,_StateMachine=(_a120=class extends AbstractStateMachine{constructor(defaultState,states,enterEach){super(),this.defaultState=defaultState,this.states=states,this.enterEach=enterEach,this.debug=Debug.create(!0,"animation"),this.state=defaultState,this.debug(`%c${this.constructor.name} | init -> ${defaultState}`,debugColor)}transition(event,data){var _a294,_b,_c,_d;if(!this.transitionChild(event,data)||this.state===_a120.child||this.state===_a120.parent)return;const currentState=this.state,currentStateConfig=this.states[this.state];let destination=currentStateConfig[event];const debugPrefix=`%c${this.constructor.name} | ${this.state} -> ${event} ->`;if(Array.isArray(destination))destination=destination.find(transition=>{if(!transition.guard)return!0;const valid=transition.guard(data);return valid||this.debug(`${debugPrefix} (guarded)`,transition.target,debugQuietColor),valid});else if(typeof destination=="object"&&!(destination instanceof _a120)&&destination.guard&&!destination.guard(data)){this.debug(`${debugPrefix} (guarded)`,destination.target,debugQuietColor);return}if(!destination){this.debug(`${debugPrefix} ${this.state}`,debugQuietColor);return}const destinationState=this.getDestinationState(destination),exitFn=destinationState===this.state?void 0:currentStateConfig.onExit;this.debug(`${debugPrefix} ${destinationState}`,debugColor),this.state=destinationState,typeof destination=="function"?destination(data):typeof destination=="object"&&!(destination instanceof _a120)&&((_a294=destination.action)==null||_a294.call(destination,data)),exitFn==null||exitFn(),(_b=this.enterEach)==null||_b.call(this,currentState,destinationState),destinationState!==currentState&&destinationState!==_a120.child&&destinationState!==_a120.parent&&((_d=(_c=this.states[destinationState]).onEnter)==null||_d.call(_c,currentState,data))}transitionAsync(event,data){setTimeout(()=>{this.transition(event,data)},0)}is(value){return this.state===_a120.child&&this.childState?this.childState.is(value):this.state===value}resetHierarchy(){this.debug(`%c${this.constructor.name} | ${this.state} -> [resetHierarchy] -> ${this.defaultState}`,"color: green"),this.state=this.defaultState}transitionChild(event,data){var _a294,_b;return this.state!==_a120.child||!this.childState||(applyProperties(this,this.childState),this.childState.transition(event,data),!this.childState.is(_a120.parent))?!0:(this.debug(`%c${this.constructor.name} | ${this.state} -> ${event} -> ${this.defaultState}`,debugColor),this.state=this.defaultState,(_b=(_a294=this.states[this.state]).onEnter)==null||_b.call(_a294),this.childState.resetHierarchy(),!1)}getDestinationState(destination){let state=this.state;return typeof destination=="string"?state=destination:destination instanceof _a120?(this.childState=destination,this.childState.parent=this,state=_a120.child):typeof destination=="object"&&(destination.target instanceof _a120?(this.childState=destination.target,this.childState.parent=this,state=_a120.child):destination.target!=null&&(state=destination.target)),state}},__name(_a120,"_StateMachine"),_a120);_StateMachine.child="__child";_StateMachine.parent="__parent";var StateMachine=_StateMachine,_a121,ParallelStateMachine=(_a121=class extends AbstractStateMachine{constructor(...stateMachines){super(),this.stateMachines=stateMachines;for(const stateMachine of stateMachines)stateMachine.parent=this}transition(event,data){for(const stateMachine of this.stateMachines)applyProperties(this,stateMachine),stateMachine.transition(event,data)}transitionAsync(event,data){for(const stateMachine of this.stateMachines)applyProperties(this,stateMachine),stateMachine.transitionAsync(event,data)}},__name(_a121,"ParallelStateMachine"),_a121),_a122,ModuleMap=(_a122=class{constructor(){this.moduleMap=new Map}*modules(){for(const m of this.moduleMap.values())yield m.moduleInstance}addModule(module,moduleFactory){if(this.moduleMap.has(module.optionsKey))throw new Error(`AG Charts - module already initialised: ${module.optionsKey}`);this.moduleMap.set(module.optionsKey,{module,moduleInstance:moduleFactory(module)})}removeModule(module){var _a294;const moduleKey=isString(module)?module:module.optionsKey;(_a294=this.moduleMap.get(moduleKey))==null||_a294.moduleInstance.destroy(),this.moduleMap.delete(moduleKey)}getModule(module){var _a294;return(_a294=this.moduleMap.get(isString(module)?module:module.optionsKey))==null?void 0:_a294.moduleInstance}isEnabled(module){return this.moduleMap.has(isString(module)?module:module.optionsKey)}mapModules(callback5){return Array.from(this.moduleMap.values(),(m,i)=>callback5(m.moduleInstance,i))}destroy(){var _a294;for(const moduleKey of this.moduleMap.keys())(_a294=this.moduleMap.get(moduleKey))==null||_a294.moduleInstance.destroy();this.moduleMap.clear()}},__name(_a122,"ModuleMap"),_a122),_a123,Selection=(_a123=class{constructor(parentNode,classOrFactory,autoCleanup=!0){this.parentNode=parentNode,this.autoCleanup=autoCleanup,this.garbageBin=new Set,this._nodesMap=new Map,this._nodes=[],this.data=[],this.debug=Debug.create(!0,"scene","scene:selections"),this.nodeFactory=Object.prototype.isPrototypeOf.call(Node,classOrFactory)?()=>new classOrFactory:classOrFactory}static select(parent,classOrFactory,garbageCollection=!0){return new _a123(parent,classOrFactory,garbageCollection)}static selectAll(parent,predicate){const results=[],traverse=__name(node=>{predicate(node)&&results.push(node);for(const child of node.children())traverse(child)},"traverse");return traverse(parent),results}static selectByClass(node,...Classes){return _a123.selectAll(node,n=>Classes.some(C2=>n instanceof C2))}static selectByTag(node,tag){return _a123.selectAll(node,n=>n.tag===tag)}createNode(datum,initializer,idx){const node=this.nodeFactory(datum);return node.datum=datum,initializer==null||initializer(node),idx==null?this._nodes.push(node):this._nodes.splice(idx,0,node),this.parentNode.appendChild(node),node}update(data,initializer,getDatumId){if(this.garbageBin.size>0&&this.debug("Selection - update() called with pending garbage",data),getDatumId){const dataMap=new Map(data.map((datum,idx)=>[getDatumId(datum),[datum,idx]]));for(const[node,datumId]of this._nodesMap.entries())if(dataMap.has(datumId)){const[newDatum]=dataMap.get(datumId);node.datum=newDatum,this.garbageBin.delete(node),dataMap.delete(datumId)}else this.garbageBin.add(node);for(const[datumId,[datum,idx]]of dataMap.entries())this._nodesMap.set(this.createNode(datum,initializer,idx),datumId)}else{const maxLength=Math.max(data.length,this.data.length);for(let i=0;i<maxLength;i++)i>=data.length?this.garbageBin.add(this._nodes[i]):i>=this._nodes.length?this.createNode(data[i],initializer):(this._nodes[i].datum=data[i],this.garbageBin.delete(this._nodes[i]))}return this.data=data.slice(),this.autoCleanup&&this.cleanup(),this}cleanup(){return this.garbageBin.size===0?this:(this._nodes=this._nodes.filter(node=>this.garbageBin.has(node)?(this._nodesMap.delete(node),this.garbageBin.delete(node),node.destroy(),!1):!0),this)}clear(){return this.update([]),this}isGarbage(node){return this.garbageBin.has(node)}each(iterate4){for(const entry of this._nodes.entries())iterate4(entry[1],entry[1].datum,entry[0]);return this}*[Symbol.iterator](){for(let index=0;index<this._nodes.length;index++){const node=this._nodes[index];yield{node,datum:node.datum,index}}}select(predicate){return _a123.selectAll(this.parentNode,predicate)}selectByClass(Class){return _a123.selectByClass(this.parentNode,Class)}selectByTag(tag){return _a123.selectByTag(this.parentNode,tag)}nodes(){return this._nodes}at(index){return this._nodes.at(index)}get length(){return this._nodes.length}},__name(_a123,"_Selection"),_a123),_a124,Line=(_a124=class extends Shape{constructor(opts={}){super(opts),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.restoreOwnStyles()}set x(value){this.x1=value,this.x2=value}set y(value){this.y1=value,this.y2=value}get midPoint(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}}computeBBox(){return new BBox(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(x,y){return this.x1===this.x2||this.y1===this.y2?this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(x,y):!1}distanceSquared(px,py){const{x1,y1,x2,y2}=this;return lineDistanceSquared(px,py,x1,y1,x2,y2,1/0)}render(renderCtx){var _a294;const{ctx,devicePixelRatio}=renderCtx;let{x1,y1,x2,y2}=this;if(x1===x2){const{strokeWidth}=this,x=Math.round(x1*devicePixelRatio)/devicePixelRatio+Math.trunc(strokeWidth*devicePixelRatio)%2/(devicePixelRatio*2);x1=x,x2=x}else if(y1===y2){const{strokeWidth}=this,y=Math.round(y1*devicePixelRatio)/devicePixelRatio+Math.trunc(strokeWidth*devicePixelRatio)%2/(devicePixelRatio*2);y1=y,y2=y}ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y2),this.fillStroke(ctx),(_a294=this.fillShadow)==null||_a294.markClean(),super.render(renderCtx)}toSVG(){if(!this.visible)return;const element2=createSvgElement("line");return element2.setAttribute("x1",String(this.x1)),element2.setAttribute("y1",String(this.y1)),element2.setAttribute("x2",String(this.x2)),element2.setAttribute("y2",String(this.y2)),this.applySvgStrokeAttributes(element2),{elements:[element2]}}},__name(_a124,"Line"),_a124);Line.className="Line";Line.defaultStyles={...Shape.defaultStyles,fill:void 0,strokeWidth:1};__decorateClass([SceneChangeDetection()],Line.prototype,"x1",2);__decorateClass([SceneChangeDetection()],Line.prototype,"y1",2);__decorateClass([SceneChangeDetection()],Line.prototype,"x2",2);__decorateClass([SceneChangeDetection()],Line.prototype,"y2",2);var _a125,Range=(_a125=class extends Shape{constructor(opts={}){super(opts),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.startLine=!1,this.endLine=!1,this.isRange=!1,this.restoreOwnStyles()}computeBBox(){return new BBox(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1)}isPointInPath(_x,_y){return!1}render(renderCtx){var _a294;const{ctx}=renderCtx;let{x1,y1,x2,y2}=this;x1=this.align(x1),y1=this.align(y1),x2=this.align(x2),y2=this.align(y2);const{fill,opacity,isRange}=this;if(!!(isRange&&fill)){const{fillOpacity}=this;this.applyFill(ctx),ctx.globalAlpha=opacity*fillOpacity,ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y1),ctx.lineTo(x2,y2),ctx.lineTo(x1,y2),ctx.closePath(),ctx.fill()}const{stroke:stroke2,strokeWidth,startLine,endLine}=this;if(!!((startLine||endLine)&&stroke2&&strokeWidth)){const{strokeOpacity,lineDash,lineDashOffset,lineCap,lineJoin}=this;this.applyStroke(ctx),ctx.globalAlpha=opacity*strokeOpacity,ctx.lineWidth=strokeWidth,lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),ctx.beginPath(),startLine&&(ctx.moveTo(x1,y1),ctx.lineTo(x2,y1)),endLine&&(ctx.moveTo(x2,y2),ctx.lineTo(x1,y2)),ctx.stroke()}(_a294=this.fillShadow)==null||_a294.markClean(),super.render(renderCtx)}},__name(_a125,"Range"),_a125);Range.className="Range";Range.defaultStyles={...Shape.defaultStyles,strokeWidth:1};__decorateClass([SceneChangeDetection()],Range.prototype,"x1",2);__decorateClass([SceneChangeDetection()],Range.prototype,"y1",2);__decorateClass([SceneChangeDetection()],Range.prototype,"x2",2);__decorateClass([SceneChangeDetection()],Range.prototype,"y2",2);__decorateClass([SceneChangeDetection()],Range.prototype,"startLine",2);__decorateClass([SceneChangeDetection()],Range.prototype,"endLine",2);__decorateClass([SceneChangeDetection()],Range.prototype,"isRange",2);var _a126,Label=(_a126=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0}getFont(){return TextUtils.toFontString(this)}},__name(_a126,"Label"),_a126);__decorateClass([TempValidate()],Label.prototype,"enabled",2);__decorateClass([TempValidate()],Label.prototype,"color",2);__decorateClass([TempValidate()],Label.prototype,"fontStyle",2);__decorateClass([TempValidate()],Label.prototype,"fontWeight",2);__decorateClass([TempValidate()],Label.prototype,"fontSize",2);__decorateClass([TempValidate()],Label.prototype,"fontFamily",2);__decorateClass([TempValidate()],Label.prototype,"formatter",2);function calculateLabelRotation(opts){const{parallelFlipRotation=0,regularFlipRotation=0}=opts,configuredRotation=opts.rotation?normalizeAngle360(toRadians(opts.rotation)):0,parallelFlipFlag=!configuredRotation&&parallelFlipRotation>=0&&parallelFlipRotation<=Math.PI?-1:1,regularFlipFlag=!configuredRotation&&regularFlipRotation>=0&&regularFlipRotation<=Math.PI?-1:1;let defaultRotation=0;return opts.parallel?defaultRotation=parallelFlipFlag*Math.PI/2:regularFlipFlag===-1&&(defaultRotation=Math.PI),{configuredRotation,defaultRotation,parallelFlipFlag,regularFlipFlag}}__name(calculateLabelRotation,"calculateLabelRotation");function getLabelSpacing(minSpacing,rotated){return minSpacing??(rotated?0:10)}__name(getLabelSpacing,"getLabelSpacing");function getTextBaseline(parallel,labelRotation,sideFlag,parallelFlipFlag){return parallel&&!labelRotation?sideFlag*parallelFlipFlag===-1?"hanging":"bottom":"middle"}__name(getTextBaseline,"getTextBaseline");function getTextAlign(parallel,labelRotation,labelAutoRotation,sideFlag,regularFlipFlag){const labelRotated=labelRotation>0&&labelRotation<=Math.PI,labelAutoRotated=labelAutoRotation>0&&labelAutoRotation<=Math.PI,alignFlag=labelRotated||labelAutoRotated?-1:1;if(parallel)if(labelRotation||labelAutoRotation){if(sideFlag*alignFlag===-1)return"end"}else return"center";else if(sideFlag*regularFlipFlag===-1)return"end";return"start"}__name(getTextAlign,"getTextAlign");function createLabelData(tickData,labelX,labelMatrix,textMeasurer){const labelData=[];for(const{tickLabel:text2,translationY}of tickData){if(!text2)continue;const{width:width2,height:height2}=textMeasurer.measureLines(text2),bbox=new BBox(labelX,translationY,width2,height2),translatedBBox=new BBox(labelX,translationY,0,0);labelMatrix.transformBBox(translatedBBox,bbox);const{x,y}=bbox;labelData.push({point:{x,y},label:{text:text2,width:width2,height:height2}})}return labelData}__name(createLabelData,"createLabelData");function isStringObject(value){return value!=null&&Object.hasOwn(value,"toString")&&isString(value.toString())}__name(isStringObject,"isStringObject");function isNumberObject(value){return value!=null&&Object.hasOwn(value,"valueOf")&&isFiniteNumber(value.valueOf())}__name(isNumberObject,"isNumberObject");function isContinuous(value){return isFiniteNumber(value)||isValidDate(value)||isNumberObject(value)}__name(isContinuous,"isContinuous");function checkDatum(value,isContinuousScale){return value!=null&&(!isContinuousScale||isContinuous(value))}__name(checkDatum,"checkDatum");function transformIntegratedCategoryValue(value){return isStringObject(value)&&Object.hasOwn(value,"id")?value.id:value}__name(transformIntegratedCategoryValue,"transformIntegratedCategoryValue");var MATCHING_CROSSLINE_TYPE=__name(property=>property==="value"?predicateWithMessage((_,ctx)=>ctx.target.type==="line",ctx=>ctx.target.type==="range"?"crossLine type 'range' to have a 'range' property instead of 'value'":"crossLine property 'type' to be 'line'"):predicateWithMessage((_,ctx)=>ctx.target.type==="range",ctx=>ctx.target.type==="line"?"crossLine type 'line' to have a 'value' property instead of 'range'":"crossLine property 'type' to be 'range'"),"MATCHING_CROSSLINE_TYPE");function getCrossLineValue(crossLine){switch(crossLine.type){case"line":return crossLine.value;case"range":return crossLine.range}}__name(getCrossLineValue,"getCrossLineValue");function validateCrossLineValue(value,scale2){if(value==null)return!1;const isContinuous2=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),validValue=__name(val=>checkDatum(val,isContinuous2)&&!isNaN(scale2.convert(val)),"validValue");if(isArray(value)){const[start2,end2]=value;return validValue(start2)&&validValue(end2)}else return validValue(value)}__name(validateCrossLineValue,"validateCrossLineValue");var horizontalCrosslineTranslationDirections={top:{xTranslationDirection:0,yTranslationDirection:-1},bottom:{xTranslationDirection:0,yTranslationDirection:1},left:{xTranslationDirection:-1,yTranslationDirection:0},right:{xTranslationDirection:1,yTranslationDirection:0},"top-left":{xTranslationDirection:1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"bottom-right":{xTranslationDirection:-1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:1,yTranslationDirection:0},"inside-right":{xTranslationDirection:-1,yTranslationDirection:0},"inside-top":{xTranslationDirection:0,yTranslationDirection:1},"inside-bottom":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-right":{xTranslationDirection:-1,yTranslationDirection:-1}},verticalCrossLineTranslationDirections={top:{xTranslationDirection:1,yTranslationDirection:0},bottom:{xTranslationDirection:-1,yTranslationDirection:0},left:{xTranslationDirection:0,yTranslationDirection:-1},right:{xTranslationDirection:0,yTranslationDirection:1},"top-left":{xTranslationDirection:-1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"bottom-right":{xTranslationDirection:1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:0,yTranslationDirection:1},"inside-right":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top":{xTranslationDirection:-1,yTranslationDirection:0},"inside-bottom":{xTranslationDirection:1,yTranslationDirection:0},"inside-top-left":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"inside-bottom-right":{xTranslationDirection:1,yTranslationDirection:-1}};function calculateLabelTranslation({yDirection,padding=0,position="top",bbox}){const crossLineTranslationDirections=yDirection?horizontalCrosslineTranslationDirections:verticalCrossLineTranslationDirections,{xTranslationDirection,yTranslationDirection}=crossLineTranslationDirections[position],xTranslation=xTranslationDirection*(padding+bbox.width/2),yTranslation=yTranslationDirection*(padding+bbox.height/2);return{xTranslation,yTranslation}}__name(calculateLabelTranslation,"calculateLabelTranslation");function calculateLabelChartPadding({yDirection,bbox,padding=0,position="top"}){const chartPadding={};return position.startsWith("inside")||(position==="top"&&!yDirection?chartPadding.top=padding+bbox.height:position==="bottom"&&!yDirection?chartPadding.bottom=padding+bbox.height:position==="left"&&yDirection?chartPadding.left=padding+bbox.width:position==="right"&&yDirection&&(chartPadding.right=padding+bbox.width)),chartPadding}__name(calculateLabelChartPadding,"calculateLabelChartPadding");var POSITION_TOP_COORDINATES=__name(({direction,xEnd,yStart,yEnd})=>direction==="y"?{x:xEnd/2,y:yStart}:{x:xEnd,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2},"POSITION_TOP_COORDINATES"),POSITION_LEFT_COORDINATES=__name(({direction,xStart,xEnd,yStart,yEnd})=>direction==="y"?{x:xStart,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}:{x:xEnd/2,y:yStart},"POSITION_LEFT_COORDINATES"),POSITION_RIGHT_COORDINATES=__name(({direction,xEnd,yStart,yEnd})=>direction==="y"?{x:xEnd,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}:{x:xEnd/2,y:isNaN(yEnd)?yStart:yEnd},"POSITION_RIGHT_COORDINATES"),POSITION_BOTTOM_COORDINATES=__name(({direction,xStart,xEnd,yStart,yEnd})=>direction==="y"?{x:xEnd/2,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2},"POSITION_BOTTOM_COORDINATES"),POSITION_INSIDE_COORDINATES=__name(({xEnd,yStart,yEnd})=>({x:xEnd/2,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}),"POSITION_INSIDE_COORDINATES"),POSITION_TOP_LEFT_COORDINATES=__name(({direction,xStart,xEnd,yStart})=>direction==="y"?{x:xStart/2,y:yStart}:{x:xEnd,y:yStart},"POSITION_TOP_LEFT_COORDINATES"),POSITION_BOTTOM_LEFT_COORDINATES=__name(({direction,xStart,yStart,yEnd})=>direction==="y"?{x:xStart,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:yStart},"POSITION_BOTTOM_LEFT_COORDINATES"),POSITION_TOP_RIGHT_COORDINATES=__name(({direction,xEnd,yStart,yEnd})=>direction==="y"?{x:xEnd,y:yStart}:{x:xEnd,y:isNaN(yEnd)?yStart:yEnd},"POSITION_TOP_RIGHT_COORDINATES"),POSITION_BOTTOM_RIGHT_COORDINATES=__name(({direction,xStart,xEnd,yStart,yEnd})=>direction==="y"?{x:xEnd,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:isNaN(yEnd)?yStart:yEnd},"POSITION_BOTTOM_RIGHT_COORDINATES"),labelDirectionHandling={top:{c:POSITION_TOP_COORDINATES},bottom:{c:POSITION_BOTTOM_COORDINATES},left:{c:POSITION_LEFT_COORDINATES},right:{c:POSITION_RIGHT_COORDINATES},"top-left":{c:POSITION_TOP_LEFT_COORDINATES},"top-right":{c:POSITION_TOP_RIGHT_COORDINATES},"bottom-left":{c:POSITION_BOTTOM_LEFT_COORDINATES},"bottom-right":{c:POSITION_BOTTOM_RIGHT_COORDINATES},inside:{c:POSITION_INSIDE_COORDINATES},"inside-left":{c:POSITION_LEFT_COORDINATES},"inside-right":{c:POSITION_RIGHT_COORDINATES},"inside-top":{c:POSITION_TOP_COORDINATES},"inside-bottom":{c:POSITION_BOTTOM_COORDINATES},"inside-top-left":{c:POSITION_TOP_LEFT_COORDINATES},"inside-bottom-left":{c:POSITION_BOTTOM_LEFT_COORDINATES},"inside-top-right":{c:POSITION_TOP_RIGHT_COORDINATES},"inside-bottom-right":{c:POSITION_BOTTOM_RIGHT_COORDINATES}};UNION(["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right","inside","inside-left","inside-right","inside-top","inside-bottom","inside-top-left","inside-bottom-left","inside-top-right","inside-bottom-right"],"crossLine label position");var _a127,CartesianCrossLineLabel=(_a127=class extends BaseProperties{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}},__name(_a127,"CartesianCrossLineLabel"),_a127);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"enabled",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"text",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"fontStyle",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"fontWeight",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"fontSize",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"fontFamily",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"padding",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"color",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"position",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"rotation",2);__decorateClass([TempValidate()],CartesianCrossLineLabel.prototype,"parallel",2);var _a128,CartesianCrossLine=(_a128=class extends BaseProperties{constructor(){super(),this.id=createId(this),this.defaultColorRange=[],this.fill="#c16068",this.label=new CartesianCrossLineLabel,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction="x",this.rangeGroup=new Group({name:this.id}),this.lineGroup=new Group({name:this.id}),this.labelGroup=new Group({name:this.id}),this.crossLineRange=new Range,this.crossLineLabel=new TransformableText,this.labelPoint=void 0,this.data=void 0,this.startLine=!1,this.endLine=!1,this._isRange=void 0,this.lineGroup.append(this.crossLineRange),this.labelGroup.append(this.crossLineLabel),this.crossLineRange.pointerEvents=1}update(visible){const{enabled,type,data,scale:scale2}=this;if(!scale2||!enabled||!visible||!this.isValid()||!validateCrossLineValue(getCrossLineValue(this),scale2)||data==null){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=visible,this.lineGroup.visible=visible,this.labelGroup.visible=visible,this.updateNodes();const isRange=type==="range";isRange!==this._isRange&&(isRange?this.rangeGroup.appendChild(this.crossLineRange):this.lineGroup.appendChild(this.crossLineRange)),this._isRange=isRange}calculateLayout(visible,reversedAxis){if(!visible)return;const{type,range:range3,value,scale:scale2,gridLength,sideFlag,direction,label:{position="top"},clippedRange,strokeWidth=0}=this;if(this.data=void 0,!scale2)return;const bandwidth=scale2.bandwidth??0,step=scale2.step??0,rangePadding=(reversedAxis?-1:1)*(scale2 instanceof BandScale?(step-bandwidth)/2:0),[xStart,xEnd]=[0,sideFlag*gridLength];let yStart,yEnd,clampedYStart,clampedYEnd;if(type==="line"){const offset4=bandwidth/2;yStart=scale2.convert(value)+offset4,yEnd=NaN,clampedYStart=scale2.convert(value,!0)+offset4,clampedYEnd=NaN}else if(range3){const[r0,r1]=range3,ordinalTimeScalePadding=(r0==null?void 0:r0.valueOf())===(r1==null?void 0:r1.valueOf())&&OrdinalTimeScale.is(scale2)?bandwidth/2+rangePadding:0;yStart=scale2.convert(r0)+ordinalTimeScalePadding,yEnd=scale2.convert(r1)+bandwidth,clampedYStart=scale2.convert(r0,!0)+ordinalTimeScalePadding-rangePadding,clampedYEnd=scale2.convert(r1,!0)+bandwidth+rangePadding}else return;clampedYStart=clampArray(clampedYStart,clippedRange),clampedYEnd=clampArray(clampedYEnd,clippedRange);const validRange=(yStart===clampedYStart||yEnd===clampedYEnd||clampedYStart!==clampedYEnd)&&Math.abs(clampedYEnd-clampedYStart)>0;if(validRange&&clampedYStart>clampedYEnd&&([clampedYStart,clampedYEnd]=[clampedYEnd,clampedYStart],[yStart,yEnd]=[yEnd,yStart]),yStart-rangePadding>=clampedYStart&&(yStart-=rangePadding),yEnd+rangePadding<=clampedYEnd&&(yEnd+=rangePadding),this.startLine=strokeWidth>0&&yStart>=clampedYStart&&yStart<=clampedYStart+rangePadding,this.endLine=strokeWidth>0&&yEnd>=clampedYEnd-bandwidth-rangePadding&&yEnd<=clampedYEnd,type==="range"&&!validRange&&!this.startLine&&!this.endLine||(this.data=[clampedYStart,clampedYEnd],this.label.enabled===!1||!this.label.text))return;const{c=POSITION_TOP_COORDINATES}=labelDirectionHandling[position]??{},{x:labelX,y:labelY}=c({direction,xStart,xEnd,yStart:clampedYStart,yEnd:clampedYEnd});this.labelPoint={x:labelX,y:labelY}}updateNodes(){this.updateRangeNode();const{label}=this;label.enabled!==!1&&label.text&&(this.updateLabel(),this.positionLabel())}updateRangeNode(){const{type,crossLineRange,sideFlag,gridLength,data,startLine,endLine,fill,fillOpacity,stroke:stroke2,strokeWidth,lineDash}=this;crossLineRange.x1=0,crossLineRange.x2=sideFlag*gridLength,crossLineRange.y1=(data==null?void 0:data[0])??0,crossLineRange.y2=(data==null?void 0:data[1])??0,crossLineRange.startLine=startLine,crossLineRange.endLine=endLine,crossLineRange.isRange=type==="range",crossLineRange.fill=fill,crossLineRange.fillOpacity=fillOpacity??1,crossLineRange.stroke=stroke2,crossLineRange.strokeWidth=strokeWidth??1,crossLineRange.strokeOpacity=this.strokeOpacity??1,crossLineRange.lineDash=lineDash}updateLabel(){const{crossLineLabel,label}=this;label.text&&(crossLineLabel.fontStyle=label.fontStyle,crossLineLabel.fontWeight=label.fontWeight,crossLineLabel.fontSize=label.fontSize,crossLineLabel.fontFamily=label.fontFamily,crossLineLabel.fill=label.color,crossLineLabel.text=label.text)}positionLabel(){const{crossLineLabel,labelPoint:{x=void 0,y=void 0}={},label:{parallel,rotation,position="top",padding=0},direction,parallelFlipRotation,regularFlipRotation}=this;if(x===void 0||y===void 0)return;const{defaultRotation,configuredRotation}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation});crossLineLabel.rotation=defaultRotation+configuredRotation,crossLineLabel.textBaseline="middle",crossLineLabel.textAlign="center";const bbox=crossLineLabel.getBBox();if(!bbox)return;const yDirection=direction==="y",{xTranslation,yTranslation}=calculateLabelTranslation({yDirection,padding,position,bbox});crossLineLabel.translationX=x+xTranslation,crossLineLabel.translationY=y+yTranslation}computeLabelBBox(){const{label}=this;if(label.enabled===!1||!label.text)return;const tempText=new TransformableText;tempText.fontFamily=label.fontFamily,tempText.fontSize=label.fontSize,tempText.fontStyle=label.fontStyle,tempText.fontWeight=label.fontWeight,tempText.text=label.text;const{labelPoint:{x=void 0,y=void 0}={},label:{parallel,rotation,position="top",padding=0},direction,parallelFlipRotation,regularFlipRotation}=this;if(x===void 0||y===void 0)return;const{configuredRotation}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation});tempText.rotation=configuredRotation,tempText.textBaseline="middle",tempText.textAlign="center";const bbox=tempText.getBBox();if(!bbox)return;const yDirection=direction==="y",{xTranslation,yTranslation}=calculateLabelTranslation({yDirection,padding,position,bbox});return tempText.x=x+xTranslation,tempText.y=y+yTranslation,tempText.getBBox()}calculatePadding(padding){const{data,direction,label:{padding:labelPadding=0,position="top"}}=this;if(data==null)return;const crossLineLabelBBox=this.computeLabelBBox();if((crossLineLabelBBox==null?void 0:crossLineLabelBBox.x)==null||(crossLineLabelBBox==null?void 0:crossLineLabelBBox.y)==null)return;const chartPadding=calculateLabelChartPadding({yDirection:direction==="y",padding:labelPadding,position,bbox:crossLineLabelBBox});padding.left=Math.max(padding.left??0,chartPadding.left??0),padding.right=Math.max(padding.right??0,chartPadding.right??0),padding.top=Math.max(padding.top??0,chartPadding.top??0),padding.bottom=Math.max(padding.bottom??0,chartPadding.bottom??0)}},__name(_a128,"CartesianCrossLine"),_a128);CartesianCrossLine.className="CrossLine";__decorateClass([TempValidate()],CartesianCrossLine.prototype,"enabled",2);__decorateClass([TempValidate(UNION(["range","line"],"a crossLine type"))],CartesianCrossLine.prototype,"type",2);__decorateClass([TempValidate(AND(MATCHING_CROSSLINE_TYPE("range"),ARRAY.restrict({length:2})))],CartesianCrossLine.prototype,"range",2);__decorateClass([TempValidate(MATCHING_CROSSLINE_TYPE("value"))],CartesianCrossLine.prototype,"value",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"defaultColorRange",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"fill",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"fillOpacity",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"stroke",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"strokeWidth",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"lineDash",2);__decorateClass([TempValidate()],CartesianCrossLine.prototype,"label",2);var GRID_STYLE_KEYS=["stroke","lineDash"];ARRAY_OF(value=>isObject(value)&&Object.keys(value).every(key=>GRID_STYLE_KEYS.includes(key)),"objects with gridline style properties such as 'stroke' or 'lineDash'");var _a129,AxisGridLine=(_a129=class{constructor(){this.enabled=!0,this.width=1,this.style=[{stroke:void 0,lineDash:[]}]}},__name(_a129,"AxisGridLine"),_a129);__decorateClass([TempValidate()],AxisGridLine.prototype,"enabled",2);__decorateClass([TempValidate()],AxisGridLine.prototype,"width",2);__decorateClass([TempValidate()],AxisGridLine.prototype,"style",2);var TICK_INTERVAL=predicateWithMessage(value=>isFiniteNumber(value)&&value>0||value instanceof TimeInterval,"a non-zero positive Number value or, for a time axis, a Time Interval such as 'agCharts.time.month'"),_a130,AxisInterval=(_a130=class extends BaseProperties{},__name(_a130,"AxisInterval"),_a130);__decorateClass([TempValidate()],AxisInterval.prototype,"step",2);__decorateClass([TempValidate()],AxisInterval.prototype,"values",2);__decorateClass([TempValidate()],AxisInterval.prototype,"minSpacing",2);__decorateClass([TempValidate()],AxisInterval.prototype,"maxSpacing",2);var _a131,AxisLabel=(_a131=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.spacing=5,this.color="#575757",this.avoidCollisions=!0,this.mirrored=!1,this.parallel=!1}getSideFlag(){return this.mirrored?1:-1}getFont(){return TextUtils.toFontString(this)}},__name(_a131,"AxisLabel"),_a131);__decorateClass([TempValidate()],AxisLabel.prototype,"enabled",2);__decorateClass([TempValidate()],AxisLabel.prototype,"fontStyle",2);__decorateClass([TempValidate()],AxisLabel.prototype,"fontWeight",2);__decorateClass([TempValidate(NUMBER.restrict({min:1}))],AxisLabel.prototype,"fontSize",2);__decorateClass([TempValidate()],AxisLabel.prototype,"fontFamily",2);__decorateClass([TempValidate()],AxisLabel.prototype,"spacing",2);__decorateClass([TempValidate()],AxisLabel.prototype,"minSpacing",2);__decorateClass([TempValidate()],AxisLabel.prototype,"color",2);__decorateClass([TempValidate()],AxisLabel.prototype,"rotation",2);__decorateClass([TempValidate()],AxisLabel.prototype,"avoidCollisions",2);__decorateClass([TempValidate()],AxisLabel.prototype,"mirrored",2);__decorateClass([TempValidate()],AxisLabel.prototype,"parallel",2);__decorateClass([TempValidate()],AxisLabel.prototype,"itemStyler",2);__decorateClass([TempValidate()],AxisLabel.prototype,"formatter",2);__decorateClass([TempValidate()],AxisLabel.prototype,"format",2);var _a132,AxisLine=(_a132=class{constructor(){this.enabled=!0,this.width=1,this.stroke=void 0}},__name(_a132,"AxisLine"),_a132);__decorateClass([TempValidate()],AxisLine.prototype,"enabled",2);__decorateClass([TempValidate()],AxisLine.prototype,"width",2);__decorateClass([TempValidate()],AxisLine.prototype,"stroke",2);var _a133,AxisTick=(_a133=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.width=1,this.size=6}},__name(_a133,"AxisTick"),_a133);__decorateClass([TempValidate()],AxisTick.prototype,"enabled",2);__decorateClass([TempValidate()],AxisTick.prototype,"width",2);__decorateClass([TempValidate()],AxisTick.prototype,"size",2);__decorateClass([TempValidate()],AxisTick.prototype,"stroke",2);var _a134,AxisTitle=(_a134=class extends BaseProperties{constructor(){super(...arguments),this.caption=new Caption,this.enabled=!1,this.spacing=Caption.SMALL_PADDING,this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always"}},__name(_a134,"AxisTitle"),_a134);__decorateClass([TempValidate()],AxisTitle.prototype,"enabled",2);__decorateClass([TempValidate()],AxisTitle.prototype,"text",2);__decorateClass([TempValidate()],AxisTitle.prototype,"spacing",2);__decorateClass([TempValidate()],AxisTitle.prototype,"fontStyle",2);__decorateClass([TempValidate()],AxisTitle.prototype,"fontWeight",2);__decorateClass([TempValidate()],AxisTitle.prototype,"fontSize",2);__decorateClass([TempValidate()],AxisTitle.prototype,"fontFamily",2);__decorateClass([TempValidate()],AxisTitle.prototype,"color",2);__decorateClass([TempValidate()],AxisTitle.prototype,"wrapping",2);__decorateClass([TempValidate()],AxisTitle.prototype,"formatter",2);var NiceMode=(NiceMode2=>(NiceMode2[NiceMode2.TickAndDomain=0]="TickAndDomain",NiceMode2[NiceMode2.TicksOnly=1]="TicksOnly",NiceMode2[NiceMode2.Off=2]="Off",NiceMode2))(NiceMode||{});function prepareAxisAnimationContext(axis){const[requestedRangeMin,requestedRangeMax]=findMinMax(axis.range),min=Math.floor(requestedRangeMin),max=Math.ceil(requestedRangeMax);return{min,max,visible:min!==max}}__name(prepareAxisAnimationContext,"prepareAxisAnimationContext");var fullCircle=Math.PI*2,halfCircle=fullCircle/2;function normaliseEndRotation(start2,end2){return Math.abs(end2-start2)<halfCircle?end2:start2>end2?end2+fullCircle:end2-fullCircle}__name(normaliseEndRotation,"normaliseEndRotation");function prepareAxisAnimationFunctions(ctx){const outOfBounds=__name((y,range3)=>{const[min=ctx.min,max=ctx.max]=findMinMax(range3??[]);return y<min||y>max},"outOfBounds");return{tick:{fromFn(node,datum,status){let y=node.y1+node.translationY,opacity=node.opacity;return(status==="added"||outOfBounds(node.datum.translationY,node.datum.range))&&(y=datum.translationY,opacity=0),{y:0,translationY:y,opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]}},toFn(_node,datum,status){const y=datum.translationY;let opacity=1;return status==="removed"&&(opacity=0),{y:0,translationY:y,opacity,finish:{y,translationY:0}}},applyFn(node,props){node.setProperties(props),node.visible=!outOfBounds(node.y)}},line:{fromFn(node,datum){return{...node.previousDatum??datum,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.updated}},toFn(_node,datum){return{...datum}}},label:{fromFn(node,newDatum,status){const datum=node.previousDatum??newDatum,x=datum.x,y=datum.y,rotationCenterX=datum.rotationCenterX;let translationY=Math.round(node.translationY),rotation=datum.rotation,opacity=node.opacity;return status==="removed"||outOfBounds(datum.y,datum.range)?rotation=newDatum.rotation:(status==="added"||outOfBounds(node.datum.y,node.datum.range))&&(translationY=Math.round(datum.translationY),opacity=0,rotation=newDatum.rotation),{x,y,rotationCenterX,translationY,rotation,opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]}},toFn(node,datum,status){var _a294;const x=datum.x,y=datum.y,rotationCenterX=datum.rotationCenterX,translationY=Math.round(datum.translationY);let rotation=0,opacity=1;return status==="added"?rotation=datum.rotation:status==="removed"?(opacity=0,rotation=datum.rotation):rotation=normaliseEndRotation(((_a294=node.previousDatum)==null?void 0:_a294.rotation)??datum.rotation,datum.rotation),{x,y,rotationCenterX,translationY,rotation,opacity,finish:{rotation:datum.rotation}}}},group:{fromFn(node,_datum){const{rotation,translationX,translationY}=node;return{rotation,translationX,translationY,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.updated}},toFn(_node,datum){const{rotation,translationX,translationY}=datum;return{rotation,translationX,translationY}}}}}__name(prepareAxisAnimationFunctions,"prepareAxisAnimationFunctions");function resetAxisGroupFn(){return(_node,datum)=>({rotation:datum.rotation,rotationCenterX:datum.rotationCenterX,rotationCenterY:datum.rotationCenterY,translationX:datum.translationX,translationY:datum.translationY})}__name(resetAxisGroupFn,"resetAxisGroupFn");function resetAxisSelectionFn(ctx){const{visible:rangeVisible,min,max}=ctx;return(_node,datum)=>{const y=datum.translationY,visible=rangeVisible&&y>=min&&y<=max;return{y,translationY:0,opacity:1,visible}}}__name(resetAxisSelectionFn,"resetAxisSelectionFn");function resetAxisLabelSelectionFn(){return(_node,datum)=>({x:datum.x,y:datum.y,translationY:datum.translationY,rotation:datum.rotation,rotationCenterX:datum.rotationCenterX})}__name(resetAxisLabelSelectionFn,"resetAxisLabelSelectionFn");function resetAxisLineSelectionFn(){return(_node,datum)=>({...datum})}__name(resetAxisLineSelectionFn,"resetAxisLineSelectionFn");var _a135,TranslatableLine=(_a135=class extends Translatable(Line){},__name(_a135,"TranslatableLine"),_a135),AxisGroupZIndexMap=(AxisGroupZIndexMap2=>(AxisGroupZIndexMap2[AxisGroupZIndexMap2.TickLines=0]="TickLines",AxisGroupZIndexMap2[AxisGroupZIndexMap2.AxisLine=1]="AxisLine",AxisGroupZIndexMap2[AxisGroupZIndexMap2.TickLabels=2]="TickLabels",AxisGroupZIndexMap2))(AxisGroupZIndexMap||{}),_a136,_Axis=(_a136=class{constructor(moduleCtx,scale2){this.moduleCtx=moduleCtx,this.scale=scale2,this.id=createId(this),this.nice=!0,this.reverse=!1,this.keys=[],this.interval=new AxisInterval,this.dataDomain={domain:[],clipped:!1},this.layoutConstraints={stacked:!0,align:"start",width:100,unit:"percent"},this.boundSeries=[],this.includeInvisibleDomains=!1,this.interactionEnabled=!0,this.axisGroup=new TransformableGroup({name:`${this.id}-axis`}),this.tickLineGroup=this.axisGroup.appendChild(new Group({name:`${this.id}-Axis-tick-lines`,zIndex:0})),this.tickLabelGroup=this.axisGroup.appendChild(new Group({name:`${this.id}-Axis-tick-labels`,zIndex:2})),this.labelGroup=new Group({name:`${this.id}-Labels`,zIndex:9}),this.gridGroup=new TransformableGroup({name:`${this.id}-Axis-grid`,zIndex:1}),this.gridLineGroup=this.gridGroup.appendChild(new Group({name:`${this.id}-gridLines`})),this.crossLineRangeGroup=new TransformableGroup({name:`${this.id}-CrossLines-Range`,zIndex:4}),this.crossLineLineGroup=new TransformableGroup({name:`${this.id}-CrossLines-Line`,zIndex:8}),this.crossLineLabelGroup=new TransformableGroup({name:`${this.id}-CrossLines-Label`,zIndex:13}),this.tickLineGroupSelection=Selection.select(this.tickLineGroup,TranslatableLine,!1),this.tickLabelGroupSelection=Selection.select(this.tickLabelGroup,TransformableText,!1),this.gridLineGroupSelection=Selection.select(this.gridLineGroup,TranslatableLine,!1),this._crossLines=[],this.line=new AxisLine,this.tick=new AxisTick,this.gridLine=new AxisGridLine,this.label=this.createLabel(),this.defaultTickMinSpacing=_a136.defaultTickMinSpacing,this.translation={x:0,y:0},this.rotation=0,this.layout={label:{fractionDigits:0,spacing:this.label.spacing,format:this.label.format}},this.axisContext=void 0,this.labelFormatter=void 0,this.datumFormatter=void 0,this.scaleFormatterParams=void 0,this.destroyFns=[],this.range=[0,1],this.visibleRange=[0,1],this.title=new AxisTitle,this.gridLength=0,this.gridPadding=0,this.seriesAreaPadding=0,this.animatable=!0,this._scaleNiceDomainInputDomain=void 0,this._scaleNiceDomainRangeExtent=NaN,this.moduleMap=new ModuleMap,this.range=this.scale.range.slice(),this.crossLines.forEach(crossLine=>this.initCrossLine(crossLine))}get type(){return this.constructor.type??""}get labelNodes(){return this.tickLabelGroupSelection.nodes()}set crossLines(value){const{CrossLineConstructor}=this.constructor;this._crossLines.forEach(crossLine=>this.detachCrossLine(crossLine)),this._crossLines=value.map(crossLine=>{const instance=new CrossLineConstructor;return instance.set(crossLine),instance}),this._crossLines.forEach(crossLine=>{this.attachCrossLine(crossLine),this.initCrossLine(crossLine)})}get crossLines(){return this._crossLines}resetAnimation(_phase){}attachCrossLine(crossLine){this.crossLineRangeGroup.appendChild(crossLine.rangeGroup),this.crossLineLineGroup.appendChild(crossLine.lineGroup),this.crossLineLabelGroup.appendChild(crossLine.labelGroup)}detachCrossLine(crossLine){this.crossLineRangeGroup.removeChild(crossLine.rangeGroup),this.crossLineLineGroup.removeChild(crossLine.lineGroup),this.crossLineLabelGroup.removeChild(crossLine.labelGroup)}destroy(){this.moduleMap.destroy(),this.destroyFns.forEach(f=>f())}updateScale(){const{range:rr,visibleRange:vr,scale:scale2}=this,span=(rr[1]-rr[0])/(vr[1]-vr[0]),shift=span*vr[0],start2=rr[0]-shift;scale2.range=[start2,start2+span],this.crossLines.forEach(crossLine=>{crossLine.clippedRange=[rr[0],rr[1]]})}setCrossLinesVisible(visible){this.crossLineRangeGroup.visible=visible,this.crossLineLineGroup.visible=visible,this.crossLineLabelGroup.visible=visible}attachAxis(groups){groups.gridNode.appendChild(this.gridGroup),groups.axisNode.appendChild(this.axisGroup),groups.labelNode.appendChild(this.labelGroup),groups.crossLineRangeNode.appendChild(this.crossLineRangeGroup),groups.crossLineLineNode.appendChild(this.crossLineLineGroup),groups.crossLineLabelNode.appendChild(this.crossLineLabelGroup)}detachAxis(groups){groups.gridNode.removeChild(this.gridGroup),groups.axisNode.removeChild(this.axisGroup),groups.labelNode.removeChild(this.labelGroup),groups.crossLineRangeNode.removeChild(this.crossLineRangeGroup),groups.crossLineLineNode.removeChild(this.crossLineLineGroup),groups.crossLineLabelNode.removeChild(this.crossLineLabelGroup)}attachLabel(axisLabelNode){this.labelGroup.append(axisLabelNode)}inRange(value,tolerance=0){const[min,max]=findMinMax(this.range);return value>=min-tolerance&&value<=max+tolerance}getRangeOverflow(value){const{range:rr,visibleRange:vr}=this,size=(rr[1]-rr[0])/(vr[1]-vr[0]),[min,max]=findMinMax([rr[0]-size*vr[0],rr[0]-size*vr[0]+size]);return value<min?value-min:value>max?value-max:0}defaultDatumFormatter(datum,fractionDigits){return formatValue(datum,fractionDigits+1)}defaultLabelFormatter(datum,fractionDigits){return formatValue(datum,fractionDigits)}onGridLengthChange(value,prevValue){prevValue^value&&this.onGridVisibilityChange(),this.crossLines.forEach(crossLine=>this.initCrossLine(crossLine))}onGridVisibilityChange(){this.gridLineGroupSelection.clear()}createLabel(){return new AxisLabel}update(){this.updatePosition(),this.updateSelections(),this.tickLineGroup.visible=this.tick.enabled,this.gridLineGroup.visible=this.gridLine.enabled,this.tickLabelGroup.visible=this.label.enabled,this.updateLabels(),this.updateGridLines(),this.updateTickLines(),this.updateCrossLines()}getAxisLineCoordinates(){const[min,max]=findMinMax(this.range);return{x:0,y1:min,y2:max}}getLabelStyles(params,additionalStyles){const{label}=this,defaultStyle={color:label.color,spacing:label.spacing,fontFamily:label.fontFamily,fontSize:label.fontSize,fontStyle:label.fontStyle,fontWeight:label.fontWeight};let stylerOutput;label.itemStyler&&(stylerOutput=this.moduleCtx.callbackCache.call(this,label.itemStyler,{...params,...defaultStyle}));const{color:fill,fontFamily,fontSize,fontStyle,fontWeight,spacing}=mergeDefaults(stylerOutput,additionalStyles,defaultStyle);return{fill,fontFamily,fontSize,fontStyle,fontWeight,spacing}}getTickSize(){return this.tick.enabled?this.tick.size:0}processData(){const{includeInvisibleDomains,boundSeries,direction}=this,domains=(includeInvisibleDomains?boundSeries:boundSeries.filter(s=>s.isEnabled())).map(series=>series.getDomain(direction));this.setDomains(...domains)}setDomains(...domains){let domain,animatable;domains.length>0?{domain,animatable}=this.scale.normalizeDomains(...domains):(domain=[],animatable=!0),this.dataDomain=this.normaliseDataDomain(domain),this.reverse&&this.dataDomain.domain.reverse(),this.animatable=animatable}calculateLayout(initialPrimaryTickCount){const{scale:scale2,label,visibleRange,nice}=this;this.updateScale();const rangeExtent=findRangeExtent(this.range),domain=this.dataDomain.domain;let tickLayoutDomain;visibleRange[0]===0&&visibleRange[1]===1?tickLayoutDomain=void 0:nice?this._scaleNiceDomainInputDomain===domain&&this._scaleNiceDomainRangeExtent===rangeExtent?tickLayoutDomain=this.scale.domain:tickLayoutDomain=this.calculateTickLayout(domain,0,[0,1]).niceDomain:tickLayoutDomain=domain;let niceMode;nice?tickLayoutDomain==null?niceMode=0:niceMode=1:niceMode=2;const{niceDomain,primaryTickCount,ticks,tickDomain,fractionDigits,bbox}=this.calculateTickLayout(tickLayoutDomain??domain,niceMode,visibleRange,initialPrimaryTickCount);this.scale.domain=niceDomain,this._scaleNiceDomainInputDomain=nice?domain:void 0,this._scaleNiceDomainRangeExtent=nice?rangeExtent:NaN;const specifier=label.format;this.labelFormatter=scale2.tickFormatter({domain:tickDomain,specifier,ticks,fractionDigits})??(value=>this.defaultLabelFormatter(value,fractionDigits)),this.datumFormatter=scale2.datumFormatter({domain:tickDomain,specifier,ticks,fractionDigits})??(value=>this.defaultDatumFormatter(value,fractionDigits)),this.scaleFormatterParams={domain:tickDomain,ticks,fractionDigits},this.layout.label={fractionDigits,spacing:this.label.spacing,format:this.label.format};const sideFlag=label.getSideFlag(),anySeriesActive=this.isAnySeriesActive(),{rotation,parallelFlipRotation,regularFlipRotation}=this.calculateRotations();return this.crossLines.forEach(crossLine=>{var _a295;var _a294;crossLine.sideFlag=-sideFlag,crossLine.direction=rotation===-Math.PI/2?"x":"y",crossLine instanceof CartesianCrossLine&&((_a294=crossLine.label).parallel??(_a294.parallel=label.parallel)),crossLine.parallelFlipRotation=parallelFlipRotation,crossLine.regularFlipRotation=regularFlipRotation,(_a295=crossLine.calculateLayout)==null||_a295.call(crossLine,anySeriesActive,this.reverse)}),{primaryTickCount,bbox}}getTransformBox(bbox){const matrix=new Matrix,{rotation,translationX,translationY}=this.getAxisTransform();return Matrix.updateTransformMatrix(matrix,1,1,rotation,translationX,translationY),matrix.transformBBox(bbox)}calculateRotations(){const rotation=toRadians(this.rotation),parallelFlipRotation=normalizeAngle360(rotation),regularFlipRotation=normalizeAngle360(rotation-Math.PI/2);return{rotation,parallelFlipRotation,regularFlipRotation}}updateCrossLines(){const anySeriesActive=this.isAnySeriesActive();this.crossLines.forEach(crossLine=>{crossLine.update(anySeriesActive)})}updateTickLines(){const{tick,label}=this,sideFlag=label.getSideFlag();this.tickLineGroupSelection.each((line,datum)=>{line.strokeWidth=datum.tickWidth??tick.width,line.stroke=datum.tickStroke??tick.stroke,line.x1=sideFlag*(datum.tickSize??this.getTickSize()),line.x2=0})}getAxisTransform(){return{rotation:toRadians(this.rotation),translationX:Math.floor(this.translation.x),translationY:Math.floor(this.translation.y)}}updatePosition(){const{crossLineRangeGroup,crossLineLineGroup,crossLineLabelGroup,gridGroup,translation}=this,{rotation}=this.calculateRotations(),translationX=Math.floor(translation.x),translationY=Math.floor(translation.y);crossLineRangeGroup.setProperties({rotation,translationX,translationY}),crossLineLineGroup.setProperties({rotation,translationX,translationY}),crossLineLabelGroup.setProperties({rotation,translationX,translationY}),gridGroup.setProperties({rotation,translationX,translationY})}updateGridLines(){const sideFlag=this.label.getSideFlag(),{gridLine:{style,width:width2},gridPadding,gridLength}=this;gridLength===0||style.length===0||this.gridLineGroupSelection.each((line,_,index)=>{const{stroke:stroke2,lineDash}=style[index%style.length];line.setProperties({x1:gridPadding,x2:-sideFlag*gridLength+gridPadding,stroke:stroke2,strokeWidth:width2,lineDash})})}formatTick(value,index,domain,fractionDigits,defaultFormatter){const{labelFormatter,label:{formatter},moduleCtx:{callbackCache}}=this;let result;if(formatter){const boundSeries=this.getFormatterBoundSeries();result=callbackCache.call(this,formatter,{value,index,domain,fractionDigits,boundSeries})}else defaultFormatter?result=defaultFormatter(value):labelFormatter&&(result=labelFormatter(value));return String(result??value)}formatDatum(value){const{label:{formatter},moduleCtx:{callbackCache},datumFormatter:valueFormatter=this.labelFormatter}=this;let result;if(formatter){const{domain}=this.scale,boundSeries=this.getFormatterBoundSeries();result=callbackCache.call(this,formatter,{value,index:NaN,domain,boundSeries})}else valueFormatter?result=callbackCache.call(this,valueFormatter,value):isArray(value)&&(result=value.filter(Boolean).join(" - "));return String(result??value)}getScaleValueFormatter(format){const{scaleFormatterParams}=this;let formatter;try{format!=null&&scaleFormatterParams!=null&&(formatter=this.scale.tickFormatter({...scaleFormatterParams,specifier:format}))}catch{logger_exports.warnOnce(`the format string ${format} is invalid, ignoring.`)}return formatter??(formatter=__name(value=>this.formatDatum(value),"formatter")),formatter}getBBox(){return this.axisGroup.getBBox()}initCrossLine(crossLine){crossLine.scale=this.scale,crossLine.gridLength=this.gridLength}isAnySeriesActive(){return this.boundSeries.some(s=>this.includeInvisibleDomains||s.isEnabled())}clipTickLines(x,y,width2,height2){this.tickLineGroup.setClipRect(new BBox(x,y,width2,height2))}clipGrid(x,y,width2,height2){this.gridGroup.setClipRect(new BBox(x,y,width2,height2))}getFormatterBoundSeries(){const{direction}=this,boundSeries=[];for(const series of this.boundSeries){const keys=series.getKeys(direction),names=series.getNames(direction);for(let idx=0;idx<keys.length;idx++)boundSeries.push({key:keys[idx],name:names[idx]})}return boundSeries}getTitleFormatterParams(domain){var _a294;const{direction}=this,boundSeries=this.getFormatterBoundSeries();return{domain,direction,boundSeries,defaultValue:(_a294=this.title)==null?void 0:_a294.text}}normaliseDataDomain(d){return{domain:[...d],clipped:!1}}getLayoutState(){return{id:this.id,rect:this.getBBox(),gridPadding:this.gridPadding,seriesAreaPadding:this.seriesAreaPadding,tickSize:this.getTickSize(),direction:this.direction,domain:this.dataDomain.domain,scale:this.scale,...this.layout}}getModuleMap(){return this.moduleMap}createModuleContext(){return this.axisContext??(this.axisContext=this.createAxisContext()),{...this.moduleCtx,parent:this.axisContext}}createAxisContext(){const{scale:scale2}=this;return{axisId:this.id,scale:this.scale,direction:this.direction,continuous:ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),getCanvasBounds:__name(()=>Transformable.toCanvas(this.axisGroup),"getCanvasBounds"),seriesKeyProperties:__name(()=>this.boundSeries.reduce((keys,series)=>(series.getKeyProperties(this.direction).forEach(key=>keys.add(key)),keys),new Set),"seriesKeyProperties"),seriesIds:__name(()=>this.boundSeries.map(series=>series.id),"seriesIds"),scaleValueFormatter:__name(specifier=>this.getScaleValueFormatter(specifier),"scaleValueFormatter"),scaleInvert:__name(val=>scale2.invert(val,!0),"scaleInvert"),scaleInvertNearest:__name(val=>scale2.invert(val,!0),"scaleInvertNearest"),attachLabel:__name(node=>this.attachLabel(node),"attachLabel"),inRange:__name((value,tolerance)=>this.inRange(value,tolerance),"inRange"),getRangeOverflow:__name(value=>this.getRangeOverflow(value),"getRangeOverflow")}}isReversed(){return this.reverse}},__name(_a136,"_Axis"),_a136);_Axis.defaultTickMinSpacing=50;_Axis.CrossLineConstructor=CartesianCrossLine;__decorateClass([TempValidate()],_Axis.prototype,"nice",2);__decorateClass([TempValidate()],_Axis.prototype,"reverse",2);__decorateClass([TempValidate()],_Axis.prototype,"keys",2);__decorateClass([TempValidate()],_Axis.prototype,"interval",2);__decorateClass([TempValidate()],_Axis.prototype,"title",2);__decorateClass([ObserveChanges((target,value,oldValue)=>target.onGridLengthChange(value,oldValue))],_Axis.prototype,"gridLength",2);var Axis=_Axis;function calculateNiceSecondaryAxis(domain,primaryTickCount,reverse){let[start2,stop]=findMinMax(domain);start2=calculateNiceStart(Math.floor(start2),stop,primaryTickCount);const step=getTickStep(start2,stop,primaryTickCount),segments=primaryTickCount-1;stop=start2+segments*step;const d=reverse?[stop,start2]:[start2,stop],ticks=getTicks(start2,step,primaryTickCount);return{domain:d,ticks}}__name(calculateNiceSecondaryAxis,"calculateNiceSecondaryAxis");function calculateNiceStart(a,b,count){const rawStep=Math.abs(b-a)/(count-1),order=Math.floor(Math.log10(rawStep)),magnitude=Math.pow(10,order);return Math.floor(a/magnitude)*magnitude}__name(calculateNiceStart,"calculateNiceStart");function getTicks(start2,step,count){const stepPower=Math.floor(Math.log10(step)),fractionDigits=step>0&&step<1?Math.abs(stepPower):0,f=Math.pow(10,fractionDigits),ticks=[];for(let i=0;i<count;i++){const tick=start2+step*i;ticks[i]=Math.round(tick*f)/f}return ticks}__name(getTicks,"getTicks");function getTickStep(start2,stop,count){const segments=count-1,rawStep=(stop-start2)/segments;return calculateNextNiceStep(rawStep)}__name(getTickStep,"getTickStep");function calculateNextNiceStep(rawStep){const order=Math.floor(Math.log10(rawStep)),magnitude=Math.pow(10,order),step=rawStep/magnitude*10;return step>0&&step<=1?magnitude/10:step>1&&step<=2?2*magnitude/10:step>1&&step<=5?5*magnitude/10:step>5&&step<=10?10*magnitude/10:step>10&&step<=20?20*magnitude/10:step>20&&step<=40?40*magnitude/10:step>40&&step<=50?50*magnitude/10:step>50&&step<=100?100*magnitude/10:step}__name(calculateNextNiceStep,"calculateNextNiceStep");function createIdsGenerator(){const idsCounter=new Map;return name=>{const counter=idsCounter.get(name);return counter?(idsCounter.set(name,counter+1),`${name}_${counter}`):(idsCounter.set(name,1),name)}}__name(createIdsGenerator,"createIdsGenerator");var _a137,AxisTickGenerator=(_a137=class{constructor(axis){this.axis=axis}estimateTickCount(visibleRange,minSpacing,maxSpacing){return estimateTickCount(findRangeExtent(this.axis.range),findRangeExtent(visibleRange),minSpacing,maxSpacing,ContinuousScale.defaultTickCount,this.axis.defaultTickMinSpacing)}filterTicks(ticks,tickCount){const{minSpacing,maxSpacing}=this.axis.interval,keepEvery=minSpacing!=null||maxSpacing!=null?Math.ceil(ticks.length/tickCount):2,offset4=ticks.length%keepEvery?-1:0;return ticks.filter((_,i)=>(i+offset4)%keepEvery===0)}generateTicks({domain,primaryTickCount,visibleRange,niceMode,parallelFlipRotation,regularFlipRotation,labelX,sideFlag}){const{scale:scale2,label,interval:{minSpacing,maxSpacing}}=this.axis,{parallel,rotation,fontFamily,fontSize,fontStyle,fontWeight}=label,secondaryAxis=primaryTickCount!==void 0,{defaultRotation,configuredRotation,parallelFlipFlag,regularFlipFlag}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation}),initialRotation=configuredRotation+defaultRotation,labelMatrix=new Matrix,{maxTickCount}=this.estimateTickCount(visibleRange,minSpacing,maxSpacing),maxIterations=!(ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2))||isNaN(maxTickCount)?10:maxTickCount;let textAlign=getTextAlign(parallel,configuredRotation,0,sideFlag,regularFlipFlag);const textBaseline=getTextBaseline(parallel,configuredRotation,sideFlag,parallelFlipFlag),font2=TextUtils.toFontString({fontFamily,fontSize,fontStyle,fontWeight}),textMeasurer=CachedTextMeasurerPool.getMeasurer({font:font2}),textProps={fontFamily,fontSize,fontStyle,fontWeight,textBaseline,textAlign},checkLabelOverlap=label.enabled&&label.avoidCollisions,getLabelOverlap=__name(({ticks},iterationRotation)=>{if(!checkLabelOverlap)return!1;const rotated=configuredRotation!==0||iterationRotation!==0,labelRotation=initialRotation+iterationRotation,labelSpacing=getLabelSpacing(label.minSpacing,rotated);Matrix.updateTransformMatrix(labelMatrix,1,1,labelRotation,0,0);const labelData=createLabelData(ticks,labelX,labelMatrix,textMeasurer);return axisLabelsOverlap(labelData,labelSpacing)},"getLabelOverlap");let tickData={tickDomain:[],ticks:[],rawTicks:[],fractionDigits:0,niceDomain:void 0},index=0,autoRotation=0,labelOverlap=!0,terminate=!1;for(;!terminate&&labelOverlap&&index<=maxIterations;){autoRotation=0;for(const strategy of this.getTickStrategies({domain,niceMode,secondaryAxis,index}))({tickData,index,autoRotation,terminate}=strategy({index,tickData,textProps,terminate,primaryTickCount,visibleRange,get labelOverlap(){return getLabelOverlap(tickData,autoRotation)}}));labelOverlap=getLabelOverlap(tickData,autoRotation)}textAlign=getTextAlign(parallel,configuredRotation,autoRotation,sideFlag,regularFlipFlag);const combinedRotation=defaultRotation+configuredRotation+autoRotation;return!secondaryAxis&&tickData.rawTicks.length>0&&(primaryTickCount=tickData.rawTicks.length),{tickData,primaryTickCount,combinedRotation,textBaseline,textAlign}}getTickStrategies({domain,niceMode,index:iteration,secondaryAxis}){const{scale:scale2,label,interval}=this.axis,{minSpacing}=interval,continuous=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),avoidLabelCollisions=label.enabled&&label.avoidCollisions,filterTicks=!continuous&&iteration!==0&&avoidLabelCollisions,autoRotate=label.autoRotate===!0&&label.rotation===void 0,strategies=[];let tickGenerationType;interval.values?tickGenerationType=3:secondaryAxis?tickGenerationType=1:filterTicks?tickGenerationType=2:tickGenerationType=0;const tickGenerationStrategy=__name(({index,tickData,primaryTickCount,visibleRange,terminate})=>this.createTickData(domain,niceMode,visibleRange,primaryTickCount,tickGenerationType,index,tickData,terminate),"tickGenerationStrategy");if(strategies.push(tickGenerationStrategy),!continuous&&minSpacing!=null){const tickFilterStrategy=__name(({index,tickData,primaryTickCount,visibleRange,terminate})=>this.createTickData(domain,niceMode,visibleRange,primaryTickCount,2,index,tickData,terminate),"tickFilterStrategy");strategies.push(tickFilterStrategy)}if(avoidLabelCollisions&&autoRotate){const autoRotateStrategy=__name(({index,tickData,labelOverlap,terminate})=>({index,tickData,autoRotation:labelOverlap?normalizeAngle360(toRadians(label.autoRotateAngle??0)):0,terminate}),"autoRotateStrategy");strategies.push(autoRotateStrategy)}return strategies}createTickData(domain,niceMode,visibleRange,primaryTickCount,tickGenerationType,index,tickData,terminate){const{scale:scale2,interval}=this.axis,{step,values,minSpacing,maxSpacing}=interval,{maxTickCount,minTickCount,tickCount}=this.estimateTickCount(visibleRange,minSpacing,maxSpacing),continuous=ContinuousScale.is(scale2)||OrdinalTimeScale.is(scale2),maxIterations=!continuous||isNaN(maxTickCount)?10:maxTickCount,countTicks=__name(i=>continuous?Math.max(tickCount-i,minTickCount):maxTickCount,"countTicks"),regenerateTicks=step==null&&values==null&&countTicks(index)>minTickCount&&(continuous||tickGenerationType===2);for(;index<=maxIterations;){const previousTicks=tickData.rawTicks;if(tickData=this.getTicks({domain,niceMode,visibleRange,tickGenerationType,previousTicks,minTickCount,maxTickCount,primaryTickCount,tickCount:countTicks(index)}),index++,!regenerateTicks||!arraysEqual(tickData.rawTicks,previousTicks))break}return terminate||(terminate=step!=null||values!=null),{tickData,index,autoRotation:0,terminate}}getTicks({domain,niceMode,visibleRange,tickGenerationType,previousTicks,tickCount,minTickCount,maxTickCount,primaryTickCount}){const{axis}=this,{label,range:range3,scale:scale2,interval}=axis,idGenerator=createIdsGenerator(),domainParams={nice:niceMode===0,interval:interval.step,tickCount,minTickCount,maxTickCount},tickParams={...domainParams,nice:niceMode===0||niceMode===1};let niceDomain=niceMode===0?scale2.niceDomain(domainParams,domain):domain,tickDomain=niceDomain,rawTicks;switch(tickGenerationType){case 3:if(tickDomain=interval.values,rawTicks=interval.values,ContinuousScale.is(scale2)){const[d0,d1]=findMinMax(niceDomain.map(Number));rawTicks=rawTicks.filter(value=>Number(value)>=d0&&Number(value)<=d1).sort((a,b)=>Number(a)-Number(b))}break;case 1:if(ContinuousScale.is(scale2)){const secondaryAxisTicks=calculateNiceSecondaryAxis(domain.map(Number),primaryTickCount??0,axis.reverse);rawTicks=secondaryAxisTicks.ticks,niceDomain=secondaryAxisTicks.domain.map(d=>scale2.toDomain(d))}else rawTicks=scale2.ticks(tickParams,niceDomain,visibleRange)??[];break;case 2:rawTicks=this.filterTicks(previousTicks,tickCount);break;default:rawTicks=scale2.ticks(tickParams,niceDomain,visibleRange)??[]}const fractionDigits=rawTicks.reduce((max,tick)=>Math.max(max,typeof tick=="number"?countFractionDigits(tick):0),0),formatParams={domain:tickDomain,ticks:rawTicks,fractionDigits,specifier:label.format},labelFormatter=scale2.tickFormatter(formatParams),scaleDomain=scale2.domain;scale2.domain=niceDomain;const halfBandwidth=(scale2.bandwidth??0)/2,ticks=[];for(let i=0;i<rawTicks.length;i++){const tick=rawTicks[i],translationY=scale2.convert(tick)+halfBandwidth;if(range3.length>0&&!axis.inRange(translationY,.001))continue;const tickLabel=label.enabled?axis.formatTick(tick,i,niceDomain,fractionDigits,labelFormatter):"";ticks.push({tick,tickId:idGenerator(tickLabel),tickLabel,translationY:Math.floor(translationY)})}return scale2.domain=scaleDomain,{tickDomain,rawTicks,fractionDigits,ticks,niceDomain}}},__name(_a137,"AxisTickGenerator"),_a137),_a138,CartesianAxisLabel=(_a138=class extends AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}},__name(_a138,"CartesianAxisLabel"),_a138);__decorateClass([TempValidate()],CartesianAxisLabel.prototype,"autoRotate",2);__decorateClass([TempValidate()],CartesianAxisLabel.prototype,"autoRotateAngle",2);var _a139,_CartesianAxis=(_a139=class extends Axis{constructor(moduleCtx,scale2){super(moduleCtx,scale2),this.lineNode=this.axisGroup.appendChild(new TranslatableLine({name:`${this.id}-Axis-line`,zIndex:1})),this.tempText=new TransformableText({debugDirty:!1}),this.tempCaption=new Caption,this.tickGenerator=new AxisTickGenerator(this),this.generatedTicks=void 0,this.animationManager=moduleCtx.animationManager,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(()=>this.resetSelectionNodes(),"action")},reset:"empty"},ready:{update:__name(data=>this.animateReadyUpdate(data),"update"),resize:__name(()=>this.resetSelectionNodes(),"resize"),reset:"empty"}}),this.axisGroup.appendChild(this.title.caption.node);let previousSize;this.destroyFns.push(moduleCtx.layoutManager.addListener("layout:complete",e=>{const size=[e.chart.width,e.chart.height];previousSize!=null&&!arraysEqual(size,previousSize)&&this.animationState.transition("resize"),previousSize=size}),this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}static is(value){return value instanceof _a139}resetAnimation(phase){phase==="initial"&&this.animationState.transition("reset")}get direction(){return this.position==="top"||this.position==="bottom"?"x":"y"}createAxisContext(){return{...super.createAxisContext(),position:this.position}}createLabel(){return new CartesianAxisLabel}updateDirection(){switch(this.position){case"top":this.rotation=-90,this.label.mirrored=!0,this.label.parallel=!0;break;case"right":this.rotation=0,this.label.mirrored=!0,this.label.parallel=!1;break;case"bottom":this.rotation=-90,this.label.mirrored=!1,this.label.parallel=!0;break;case"left":this.rotation=0,this.label.mirrored=!1,this.label.parallel=!1;break}this.axisContext&&(this.axisContext.position=this.position,this.axisContext.direction=this.direction)}calculateLayout(primaryTickCount){return this.updateDirection(),super.calculateLayout(primaryTickCount)}calculateTickLayout(domain,niceMode,visibleRange,initialPrimaryTickCount){const sideFlag=this.label.getSideFlag(),{parallelFlipRotation,regularFlipRotation}=this.calculateRotations(),labelX=sideFlag*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding);if(niceMode===2&&this.label.enabled===!1&&this.tick.enabled===!1&&this.gridLine.enabled===!1)return this.generatedTicks={ticks:[],labels:[]},{ticks:[],tickDomain:domain,niceDomain:domain,primaryTickCount:initialPrimaryTickCount,fractionDigits:0,bbox:this.tickBBox(domain,[],[])};const tickGenerationResult=this.tickGenerator.generateTicks({domain,niceMode,visibleRange,primaryTickCount:initialPrimaryTickCount,parallelFlipRotation,regularFlipRotation,labelX,sideFlag}),{tickData,primaryTickCount=initialPrimaryTickCount}=tickGenerationResult,{ticks,tickDomain,rawTicks,fractionDigits,niceDomain=domain}=tickData,labels=ticks.map(d=>this.getTickLabelProps(d,tickGenerationResult)),bbox=this.tickBBox(tickDomain,ticks,labels);return this.generatedTicks={ticks,labels},{ticks:rawTicks,tickDomain,niceDomain,primaryTickCount,fractionDigits,bbox}}update(){var _a294;this.updateDirection();const previousTicksIds=Array.from(this.tickLabelGroupSelection.nodes(),node=>node.datum.tickId);if(super.update(),this.animatable||this.moduleCtx.animationManager.skipCurrentBatch(),this.generatedTicks){const{ticks}=this.generatedTicks;if(this.animationManager.isSkipped())this.resetSelectionNodes();else{const tickIds=ticks.map(datum=>datum.tickId),diff2=diffArrays(previousTicksIds,tickIds);this.animationState.transition("update",diff2)}}const{enabled,stroke:stroke2,width:width2}=this.line;this.lineNode.setProperties({stroke:stroke2,strokeWidth:enabled?width2:0}),this.updateTitle(this.scale.domain,!((_a294=this.generatedTicks)!=null&&_a294.ticks.length))}updatePosition(){super.updatePosition(),this.axisGroup.datum=this.getAxisTransform()}tickBBox(domain,ticks,labels){var _a294;const sideFlag=this.label.getSideFlag(),boxes=[],{x,y1,y2}=this.getAxisLineCoordinates(),lineBox=new BBox(x+Math.min(sideFlag*this.seriesAreaPadding,0),y1,this.seriesAreaPadding,y2-y1);if(boxes.push(lineBox),this.tick.enabled)for(const datum of ticks){const{x1,x2,y}=this.getTickLineCoordinates(datum),tickLineBox=new BBox(x1,y,x2-x1,0);boxes.push(tickLineBox)}const{tempText}=this;if(this.label.enabled)for(const datum of labels){if(!datum.visible)continue;tempText.setProperties({...datum,translationY:Math.round(datum.translationY)});const box=tempText.getBBox();box&&boxes.push(box)}if((_a294=this.title)!=null&&_a294.enabled){const spacing=BBox.merge(boxes).width;this.setTitleProps(this.tempCaption,{domain,spacing});const titleBox=this.tempCaption.node.getBBox();titleBox&&boxes.push(titleBox)}const bbox=BBox.merge(boxes);return this.getTransformBox(bbox)}setTitleProps(caption,params){const{title}=this;if(!title.enabled){caption.enabled=!1,caption.node.visible=!1;return}caption.enabled=!0,caption.color=title.color,caption.fontFamily=title.fontFamily,caption.fontSize=title.fontSize,caption.fontStyle=title.fontStyle,caption.fontWeight=title.fontWeight,caption.wrapping=title.wrapping;const titleNode=caption.node,padding=(title.spacing??0)+params.spacing,sideFlag=this.label.getSideFlag(),parallelFlipRotation=normalizeAngle360(this.rotation),titleRotationFlag=sideFlag===-1&&parallelFlipRotation>Math.PI&&parallelFlipRotation<Math.PI*2?-1:1,rotation=titleRotationFlag*sideFlag*Math.PI/2,textBaseline=titleRotationFlag===1?"bottom":"top",{range:range3}=this,x=Math.floor(titleRotationFlag*sideFlag*(range3[0]+range3[1])/2),y=Math.floor(sideFlag===-1?titleRotationFlag*-padding:-padding),{callbackCache}=this.moduleCtx,{formatter=__name(p=>p.defaultValue,"formatter")}=title,text2=callbackCache.call(this,formatter,this.getTitleFormatterParams(params.domain));caption.text=text2,titleNode.setProperties({visible:!0,text:text2,textBaseline,x,y,rotation})}getTickLabelProps(datum,tickGenerationResult){const{combinedRotation,textBaseline,textAlign}=tickGenerationResult,{range:range3}=this.scale,text2=datum.tickLabel,labelX=this.label.getSideFlag()*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),visible=text2!==""&&text2!=null;return{...this.getLabelStyles({value:datum.tickLabel}),tickId:datum.tickId,rotation:combinedRotation,rotationCenterX:labelX,translationY:datum.translationY,text:text2,textAlign,textBaseline,visible,x:labelX,y:0,range:range3}}getTickLineCoordinates(datum){const x=this.label.getSideFlag()*this.getTickSize(),x1=Math.min(0,x),x2=x1+Math.abs(x),y=datum.translationY;return{x1,x2,y}}updateSelections(){if(!this.generatedTicks)return;const lineData=this.getAxisLineCoordinates(),{ticks,labels}=this.generatedTicks,getDatumId=__name(datum=>datum.tickId,"getDatumId");this.lineNode.datum=lineData,this.gridLineGroupSelection.update(this.gridLength?ticks:[],void 0,getDatumId),this.tickLineGroupSelection.update(ticks,void 0,getDatumId),this.tickLabelGroupSelection.update(labels,void 0,getDatumId)}updateTitle(domain,noVisibleTicks,spacing){const{title,tickLineGroup,tickLabelGroup,lineNode}=this;title.enabled&&!noVisibleTicks&&spacing==null&&(spacing=Group.computeChildrenBBox([tickLineGroup,tickLabelGroup,lineNode]).width+(tickLabelGroup.visible?0:this.seriesAreaPadding)),spacing??(spacing=0),this.setTitleProps(title.caption,{domain,spacing})}updateLabels(){this.label.enabled&&this.tickLabelGroupSelection.each((node,datum)=>{node.fill=datum.fill,node.fontFamily=datum.fontFamily,node.fontSize=datum.fontSize,node.fontStyle=datum.fontStyle,node.fontWeight=datum.fontWeight,node.text=datum.text,node.textBaseline=datum.textBaseline,node.textAlign=datum.textAlign??"center"})}animateReadyUpdate(diff2){const{animationManager}=this.moduleCtx,selectionCtx=prepareAxisAnimationContext(this),fns=prepareAxisAnimationFunctions(selectionCtx);fromToMotion(this.id,"axis-group",animationManager,[this.axisGroup],fns.group),fromToMotion(this.id,"line",animationManager,[this.lineNode],fns.line),fromToMotion(this.id,"line-paths",animationManager,[this.gridLineGroupSelection,this.tickLineGroupSelection],fns.tick,(_,d)=>d.tickId,diff2),fromToMotion(this.id,"tick-labels",animationManager,[this.tickLabelGroupSelection],fns.label,(_,d)=>d.tickId,diff2)}resetSelectionNodes(){const selectionCtx=prepareAxisAnimationContext(this);resetMotion([this.axisGroup],resetAxisGroupFn()),resetMotion([this.gridLineGroupSelection,this.tickLineGroupSelection],resetAxisSelectionFn(selectionCtx)),resetMotion([this.tickLabelGroupSelection],resetAxisLabelSelectionFn()),resetMotion([this.lineNode],resetAxisLineSelectionFn())}},__name(_a139,"_CartesianAxis"),_a139);__decorateClass([TempValidate()],_CartesianAxis.prototype,"thickness",2);__decorateClass([TempValidate()],_CartesianAxis.prototype,"position",2);var CartesianAxis=_CartesianAxis,CartesianAxisPositions=["top","right","bottom","left"];function isAxisPosition(position){return typeof position=="string"&&CartesianAxisPositions.includes(position)}__name(isAxisPosition,"isAxisPosition");function guessInvalidPositions(axes){const invalidAxes=[],usedPositions=[],guesses=[...CartesianAxisPositions];for(const axis of axes)axis instanceof CartesianAxis&&(isAxisPosition(axis.position)?usedPositions.push(axis.position):invalidAxes.push(axis));for(const axis of invalidAxes){let nextGuess;do nextGuess=guesses.pop();while(nextGuess&&usedPositions.includes(nextGuess));if(nextGuess==null)break;axis.position=nextGuess}}__name(guessInvalidPositions,"guessInvalidPositions");var MATCHING_KEYS=["direction","xKey","yKey","sizeKey","angleKey","radiusKey","normalizedTo"];function matchSeriesOptions(series,optSeries,oldOptsSeries){var _a294,_b;const generateKey=__name((type,i,opts)=>{const result=[type];for(const key of MATCHING_KEYS)key in i&&i[key]!=null&&result.push(`${key}=${i[key]}`);return opts!=null&&opts.seriesGrouping&&result.push(`seriesGrouping.groupId=${opts==null?void 0:opts.seriesGrouping.groupId}`),result.join(";")},"generateKey"),seriesMap=new Map;let idx=0;for(const s of series){const key=generateKey(s.type,s.properties,oldOptsSeries==null?void 0:oldOptsSeries[idx]);seriesMap.has(key)||seriesMap.set(key,[]),(_a294=seriesMap.get(key))==null||_a294.push([s,idx++])}const optsMap=new Map;idx=0;for(const o of optSeries){const key=generateKey(o.type,o,o);optsMap.has(key)||optsMap.set(key,[]),(_b=optsMap.get(key))==null||_b.push([o,idx++])}if(![...seriesMap.keys()].some(k=>optsMap.has(k)))return{status:"no-overlap",oldKeys:seriesMap.keys(),newKeys:optsMap.keys()};const changes=[];for(const[key,optsTuples]of optsMap.entries())for(const[opts,targetIdx]of optsTuples){const seriesArray=seriesMap.get(key);if(seriesArray==null||seriesArray.length<1){changes.push({opts,targetIdx,idx:targetIdx,status:"add"}),seriesMap.delete(key);continue}const[outputSeries,currentIdx]=seriesArray.shift(),previousOpts=(oldOptsSeries==null?void 0:oldOptsSeries[currentIdx])??{},diff2=jsonDiff(previousOpts,opts??{}),{groupIndex,stackIndex}=(diff2==null?void 0:diff2.seriesGrouping)??{};groupIndex!=null||stackIndex!=null?changes.push({opts,series:outputSeries,diff:diff2,targetIdx,idx:currentIdx,status:"series-grouping"}):diff2?changes.push({opts,series:outputSeries,diff:diff2,targetIdx,idx:currentIdx,status:"update"}):changes.push({opts,series:outputSeries,targetIdx,idx:currentIdx,status:"no-op"}),seriesArray.length===0&&seriesMap.delete(key)}for(const seriesArray of seriesMap.values())for(const[outputSeries,currentIdx]of seriesArray)changes.push({series:outputSeries,idx:currentIdx,targetIdx:-1,status:"remove"});return{status:"overlap",changes}}__name(matchSeriesOptions,"matchSeriesOptions");function optionsType(input){var _a294;const{series}=input;return((_a294=series==null?void 0:series[0])==null?void 0:_a294.type)??"line"}__name(optionsType,"optionsType");function isAgCartesianChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isCartesian(specifiedType)||isEnterpriseCartesian(specifiedType)}__name(isAgCartesianChartOptions,"isAgCartesianChartOptions");function isAgPolarChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isPolar(specifiedType)||isEnterprisePolar(specifiedType)}__name(isAgPolarChartOptions,"isAgPolarChartOptions");function isAgHierarchyChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isHierarchy(specifiedType)||isEnterpriseHierarchy(specifiedType)}__name(isAgHierarchyChartOptions,"isAgHierarchyChartOptions");function isAgTopologyChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isTopology(specifiedType)||isEnterpriseTopology(specifiedType)}__name(isAgTopologyChartOptions,"isAgTopologyChartOptions");function isAgFlowProportionChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isFlowProportion(specifiedType)||isEnterpriseFlowProportion(specifiedType)}__name(isAgFlowProportionChartOptions,"isAgFlowProportionChartOptions");function isAgStandaloneChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isStandalone(specifiedType)||isEnterpriseStandalone(specifiedType)}__name(isAgStandaloneChartOptions,"isAgStandaloneChartOptions");function isAgGaugeChartOptions(input){const specifiedType=optionsType(input);return chartTypes2.isGauge(specifiedType)||isEnterpriseGauge(specifiedType)}__name(isAgGaugeChartOptions,"isAgGaugeChartOptions");function isAgPolarChartOptionsWithSeriesBasedLegend(input){const specifiedType=optionsType(input);return isAgPolarChartOptions(input)&&specifiedType!=="pie"&&specifiedType!=="donut"}__name(isAgPolarChartOptionsWithSeriesBasedLegend,"isAgPolarChartOptionsWithSeriesBasedLegend");var _a140,ModulesManager=(_a140=class extends ModuleMap{applyOptions(options){for(const m of this.moduleMap.values())m.module.optionsKey in options&&isProperties(m.moduleInstance)&&m.moduleInstance.set(options[m.module.optionsKey])}*legends(){for(const{module,moduleInstance}of this.moduleMap.values())module.type==="legend"&&(yield{legendType:module.identifier,legend:moduleInstance})}},__name(_a140,"ModulesManager"),_a140),DEFAULT_OVERLAY_CLASS="ag-charts-overlay",DEFAULT_OVERLAY_DARK_CLASS="ag-charts-dark-overlay",_a141,Overlay=(_a141=class extends BaseProperties{constructor(className,defaultMessageId){super(),this.className=className,this.defaultMessageId=defaultMessageId,this.enabled=!0}getText(localeManager){return localeManager.t(this.text??this.defaultMessageId)}getElement(animationManager,localeManager,rect){var _a294;if((_a294=this.content)==null||_a294.remove(),this.focusBox=rect,this.renderer){const htmlContent=this.renderer();if(htmlContent instanceof HTMLElement)this.content=htmlContent;else{const tempDiv=createElement("div");tempDiv.innerHTML=htmlContent,this.content=tempDiv.firstElementChild}}else{const content=createElement("div",{display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",height:"100%",margin:"8px",fontFamily:"var(--ag-charts-font-family)",fontSize:"var(--ag-charts-font-size)",fontWeight:"var(--ag-charts-font-weight)"});content.innerText=this.getText(localeManager),this.content=content,animationManager==null||animationManager.animate({from:0,to:1,id:"overlay",phase:"add",groupId:"opacity",onUpdate(value){content.style.opacity=String(value)},onStop(){content.style.opacity="1"}})}return this.content}removeElement(cleanup=()=>{var _a294;return(_a294=this.content)==null?void 0:_a294.remove()},animationManager){if(this.content){if(animationManager){const{content}=this;animationManager.animate({from:1,to:0,phase:"remove",id:"overlay",groupId:"opacity",onUpdate(value){content.style.opacity=String(value)},onStop(){cleanup==null||cleanup()}})}else cleanup==null||cleanup();this.content=void 0,this.focusBox=void 0}}},__name(_a141,"Overlay"),_a141);__decorateClass([TempValidate()],Overlay.prototype,"enabled",2);__decorateClass([TempValidate()],Overlay.prototype,"text",2);__decorateClass([TempValidate()],Overlay.prototype,"renderer",2);var _a142,ChartOverlays=(_a142=class extends BaseProperties{constructor(){super(...arguments),this.darkTheme=!1,this.loading=new Overlay("ag-charts-loading-overlay","overlayLoadingData"),this.noData=new Overlay("ag-charts-no-data-overlay","overlayNoData"),this.noVisibleSeries=new Overlay("ag-charts-no-visible-series","overlayNoVisibleSeries"),this.unsupportedBrowser=new Overlay("ag-charts-unsupported-browser","overlayUnsupportedBrowser")}getFocusInfo(localeManager){for(const overlay of[this.loading,this.noData,this.noVisibleSeries,this.unsupportedBrowser])if(overlay.focusBox!==void 0)return{text:overlay.getText(localeManager),rect:overlay.focusBox}}destroy(){this.loading.removeElement(),this.noData.removeElement(),this.noVisibleSeries.removeElement(),this.unsupportedBrowser.removeElement()}},__name(_a142,"ChartOverlays"),_a142);__decorateClass([TempValidate()],ChartOverlays.prototype,"darkTheme",2);__decorateClass([TempValidate()],ChartOverlays.prototype,"loading",2);__decorateClass([TempValidate()],ChartOverlays.prototype,"noData",2);__decorateClass([TempValidate()],ChartOverlays.prototype,"noVisibleSeries",2);__decorateClass([TempValidate()],ChartOverlays.prototype,"unsupportedBrowser",2);function getLoadingSpinner(text2,defaultDuration){const{animationDuration}=PHASE_METADATA.add,duration=animationDuration*defaultDuration,container=createElement("div",`${DEFAULT_OVERLAY_CLASS}--loading`,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",boxSizing:"border-box",font:"13px Verdana, sans-serif",userSelect:"none",animation:`ag-charts-loading ${duration}ms linear 50ms both`}),matrix=createElement("span",{width:"45px",height:"40px",backgroundImage:["linear-gradient(#0000 calc(1 * 100% / 6), #ccc 0 calc(3 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(2 * 100% / 6), #ccc 0 calc(4 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(3 * 100% / 6), #ccc 0 calc(5 * 100% / 6), #0000 0)"].join(""),backgroundSize:"10px 400%",backgroundRepeat:"no-repeat",animation:"ag-charts-loading-matrix 1s infinite linear"}),label=createElement("p",{marginTop:"1em"});label.innerText=text2;const background=createElement("div",`${DEFAULT_OVERLAY_CLASS}__loading-background`,{position:"absolute",inset:"0",opacity:"0.5",zIndex:"-1"}),animationStyles=createElement("style");return animationStyles.innerText=["@keyframes ag-charts-loading { from { opacity: 0 } to { opacity: 1 } }","@keyframes ag-charts-loading-matrix {","0% { background-position: 0% 0%, 50% 0%, 100% 0%; }","100% { background-position: 0% 100%, 50% 100%, 100% 100%; }","}"].join(" "),container.replaceChildren(animationStyles,matrix,label,background),container}__name(getLoadingSpinner,"getLoadingSpinner");var SeriesZIndexMap=(SeriesZIndexMap2=>(SeriesZIndexMap2[SeriesZIndexMap2.BACKGROUND=0]="BACKGROUND",SeriesZIndexMap2[SeriesZIndexMap2.ANY_CONTENT=1]="ANY_CONTENT",SeriesZIndexMap2))(SeriesZIndexMap||{}),SeriesContentZIndexMap=(SeriesContentZIndexMap2=>(SeriesContentZIndexMap2[SeriesContentZIndexMap2.FOREGROUND=0]="FOREGROUND",SeriesContentZIndexMap2[SeriesContentZIndexMap2.HIGHLIGHT=1]="HIGHLIGHT",SeriesContentZIndexMap2[SeriesContentZIndexMap2.LABEL=2]="LABEL",SeriesContentZIndexMap2))(SeriesContentZIndexMap||{});function getShapeFill(fill,defaultGradient,defaultPattern){if(isGradientFill(fill))return{type:"gradient",gradient:fill.gradient??defaultGradient.gradient,colorStops:fill.colorStops??defaultGradient.colorStops,bounds:fill.bounds??defaultGradient.bounds,rotation:fill.rotation??defaultGradient.rotation,reverse:fill.reverse??defaultGradient.reverse};if(isPatternFill(fill)&&defaultPattern){const pattern=fill.pattern??defaultPattern.pattern;let strokeWidth=fill.strokeWidth;pattern==="backward-slanted-lines"||pattern==="forward-slanted-lines"||pattern==="horizontal-lines"||pattern==="vertical-lines"?strokeWidth??(strokeWidth=defaultPattern.strokeWidth):strokeWidth??(strokeWidth=0);const width2=fill.width??fill.height??defaultPattern.width,height2=fill.height??fill.width??defaultPattern.height;return{type:"pattern",pattern,width:width2,height:height2,padding:fill.padding??defaultPattern.padding,fill:fill.fill??defaultPattern.fill,fillOpacity:fill.fillOpacity??defaultPattern.fillOpacity,backgroundFill:fill.backgroundFill??defaultPattern.backgroundFill,backgroundFillOpacity:fill.backgroundFillOpacity??defaultPattern.backgroundFillOpacity,stroke:fill.stroke??defaultPattern.stroke,strokeOpacity:fill.strokeOpacity??defaultPattern.strokeOpacity,strokeWidth,rotation:fill.rotation??defaultPattern.rotation}}return fill}__name(getShapeFill,"getShapeFill");function getShapeStyle(style,defaultGradient,defaultPattern){return!isGradientFill(style==null?void 0:style.fill)&&!isPatternFill(style==null?void 0:style.fill)?style:{...style,fill:getShapeFill(style.fill,defaultGradient,defaultPattern)}}__name(getShapeStyle,"getShapeStyle");function applyShapeFillBBox(shape,fill,fillBBox,fillParams){fillBBox==null||!isGradientFill(fill)||fill.bounds==null||fill.bounds==="item"?shape.fillBBox=void 0:shape.fillBBox=fillBBox[fill.bounds],shape.fillParams=fillParams}__name(applyShapeFillBBox,"applyShapeFillBBox");function applyShapeStyle(shape,style,overrides,fillBBox,fillParams){const fill=(overrides==null?void 0:overrides.fill)??style.fill;shape.fill=fill,applyShapeFillBBox(shape,(overrides==null?void 0:overrides.fill)??style.fill,fillBBox,fillParams),shape.fillOpacity=(overrides==null?void 0:overrides.fillOpacity)??style.fillOpacity??1,shape.stroke=(overrides==null?void 0:overrides.stroke)??style.stroke,shape.strokeOpacity=(overrides==null?void 0:overrides.strokeOpacity)??style.strokeOpacity??1,shape.strokeWidth=(overrides==null?void 0:overrides.strokeWidth)??style.strokeWidth??0,shape.lineDash=(overrides==null?void 0:overrides.lineDash)??style.lineDash,shape.lineDashOffset=(overrides==null?void 0:overrides.lineDashOffset)??style.lineDashOffset??0}__name(applyShapeStyle,"applyShapeStyle");var SeriesNodePickMode=(SeriesNodePickMode2=>(SeriesNodePickMode2[SeriesNodePickMode2.EXACT_SHAPE_MATCH=0]="EXACT_SHAPE_MATCH",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_NODE=1]="NEAREST_NODE",SeriesNodePickMode2[SeriesNodePickMode2.AXIS_ALIGNED=2]="AXIS_ALIGNED",SeriesNodePickMode2))(SeriesNodePickMode||{}),CROSS_FILTER_MARKER_FILL_OPACITY_FACTOR=.25,CROSS_FILTER_MARKER_STROKE_OPACITY_FACTOR=.125,_a143,SeriesNodeEvent=(_a143=class{constructor(type,event,nodeDatum,series){this.type=type,this.event=event,this.defaultPrevented=!1,this.datum=nodeDatum.datum,this.seriesId=series.id}preventDefault(){this.defaultPrevented=!0}},__name(_a143,"SeriesNodeEvent"),_a143),_a144,SeriesGroupingChangedEvent=(_a144=class{constructor(series,seriesGrouping,oldGrouping){this.series=series,this.seriesGrouping=seriesGrouping,this.oldGrouping=oldGrouping,this.type="groupingChanged"}},__name(_a144,"SeriesGroupingChangedEvent"),_a144),_a145,Series=(_a145=class extends Observable{constructor(seriesOpts){super(),this.destroyFns=[],this.usesPlacedLabels=!1,this.seriesGrouping=void 0,this.NodeEvent=SeriesNodeEvent,this.internalId=createId(this),this.contentGroup=new TranslatableGroup({name:`${this.internalId}-content`,zIndex:1}),this.highlightGroup=new TranslatableGroup({name:`${this.internalId}-highlight`,zIndex:1}),this.annotationGroup=new TranslatableGroup({name:`${this.internalId}-annotation`}),this.labelGroup=new TranslatableGroup({name:`${this.internalId}-series-labels`}),this.axes={x:void 0,y:void 0},this.directions=["x","y"],this.nodeDataRefresh=!0,this.moduleMap=new ModuleMap,this.datumCallbackCache=new Map,this.connectsToYAxis=!1,this._declarationOrder=-1,this.seriesListeners=new Listeners,this._pickNodeCache=new LRUCache;const{moduleCtx,pickModes,directionKeys={},directionNames={},canHaveAxes=!1,usesPlacedLabels=!1}=seriesOpts;this.ctx=moduleCtx,this.directionKeys=directionKeys,this.directionNames=directionNames,this.canHaveAxes=canHaveAxes,this.usesPlacedLabels=usesPlacedLabels,this.highlightGroup=new TranslatableGroup({name:`${this.internalId}-highlight`}),this.highlightNode=this.highlightGroup.appendChild(new Group({name:"highlightNode",zIndex:0})),this.highlightLabel=this.highlightGroup.appendChild(new Group({name:"highlightLabel",zIndex:10})),this.pickModes=pickModes}get pickModeAxis(){return"main"}get id(){var _a294;return((_a294=this.properties)==null?void 0:_a294.id)??this.internalId}get type(){return this.constructor.type??""}get focusable(){return!0}get data(){return this._data??this._chartData}set visible(newVisibility){this.properties.visible=newVisibility,this.ctx.legendManager.toggleItem(newVisibility,this.id),this.ctx.legendManager.update(),this.visibleMaybeChanged()}get visible(){return this.ctx.legendManager.getSeriesEnabled(this.id)??this.properties.visible}get hasData(){return this.data!=null&&this.data.length>0}get tooltipEnabled(){var _a294;return(_a294=this.properties.tooltip)==null?void 0:_a294.enabled}onDataChange(){this.nodeDataRefresh=!0,this._pickNodeCache.clear()}setOptionsData(input){this._data=input,this.onDataChange()}setChartData(input){this._chartData=input,this.data===input&&this.onDataChange()}onSeriesGroupingChange(prev,next){const{internalId,type,visible}=this;prev&&this.ctx.seriesStateManager.deregisterSeries(this),next&&this.ctx.seriesStateManager.registerSeries({internalId,type,visible,seriesGrouping:next}),this.fireEvent(new SeriesGroupingChangedEvent(this,next,prev))}getBandScalePadding(){return{inner:1,outer:0}}attachSeries(seriesContentNode,seriesNode,annotationNode){seriesContentNode.appendChild(this.contentGroup),seriesNode.appendChild(this.highlightGroup),seriesNode.appendChild(this.labelGroup),annotationNode==null||annotationNode.appendChild(this.annotationGroup)}detachSeries(seriesContentNode,seriesNode,annotationNode){seriesContentNode==null||seriesContentNode.removeChild(this.contentGroup),seriesNode.removeChild(this.highlightGroup),seriesNode.removeChild(this.labelGroup),annotationNode==null||annotationNode.removeChild(this.annotationGroup)}setSeriesIndex(index){return index===this._declarationOrder?!1:(this._declarationOrder=index,this.contentGroup.zIndex=[1,index,0],this.highlightGroup.zIndex=[1,index,1],this.labelGroup.zIndex=[1,index,2],this.annotationGroup.zIndex=index,!0)}renderToOffscreenCanvas(){return!1}addEventListener(type,listener){return super.addEventListener(type,listener)}removeEventListener(type,listener){return super.removeEventListener(type,listener)}hasEventListener(type){return super.hasEventListener(type)}addListener(type,listener){return this.seriesListeners.addListener(type,listener)}dispatch(type,event){this.seriesListeners.dispatch(type,event)}addChartEventListeners(){}destroy(){this.destroyFns.forEach(f=>f()),this.destroyFns=[],this.resetDatumCallbackCache(),this.ctx.seriesStateManager.deregisterSeries(this)}getDirectionValues(direction,properties){const resolvedDirection=this.resolveKeyDirection(direction),keys=properties==null?void 0:properties[resolvedDirection],values=[];if(!keys)return values;const addValues=__name((...items)=>{for(const value of items)Array.isArray(value)?addValues(...value):typeof value=="object"?addValues(...Object.values(value)):values.push(value)},"addValues");return addValues(...keys.map(key=>this.properties[key])),values}getKeys(direction){return this.getDirectionValues(direction,this.directionKeys)}getKeyProperties(direction){return this.directionKeys[this.resolveKeyDirection(direction)]??[]}getNames(direction){return this.getDirectionValues(direction,this.directionNames)}resolveKeyDirection(direction){return direction}getDomain(direction){const seriesDomain=this.getSeriesDomain(direction),moduleDomains=this.moduleMap.mapModules(module=>module.getDomain(direction)).flat();return moduleDomains.length!==0?seriesDomain.concat(moduleDomains):seriesDomain}getRange(direction,visibleRange){return this.getSeriesRange(direction,visibleRange)}getVisibleItems(_xVisibleRange,_yVisibleRange,_minVisibleItems){return 1/0}markNodeDataDirty(){this.nodeDataRefresh=!0,this._pickNodeCache.clear(),this.visibleMaybeChanged()}visibleMaybeChanged(){this.ctx.seriesStateManager.updateSeries(this)}getOpacity(){const{dimOpacity=1,enabled=!0}=this.properties.highlightStyle.series;if(!enabled||dimOpacity===1)return 1;switch(this.isItemIdHighlighted()){case 0:case 1:return 1;case 2:default:return dimOpacity}}getStrokeWidth(defaultStrokeWidth){const{strokeWidth,enabled=!0}=this.properties.highlightStyle.series;if(!enabled||strokeWidth===void 0)return defaultStrokeWidth;switch(this.isItemIdHighlighted()){case 1:return strokeWidth;case 0:case 2:return defaultStrokeWidth}}isItemIdHighlighted(){var _a294,_b;const series=(_b=(_a294=this.ctx.highlightManager)==null?void 0:_a294.getActiveHighlight())==null?void 0:_b.series;return series==null?0:series!==this?2:1}getModuleTooltipParams(){return this.moduleMap.mapModules(module=>module.getTooltipParams()).reduce((total,current)=>Object.assign(total,current),{})}pickNodes(point,intent,exactMatchOnly=!1){const{pickModes,pickModeAxis,visible,contentGroup}=this;if(!visible||!contentGroup.visible||intent==="highlight"&&!this.properties.highlight.enabled||intent==="highlight-tooltip"&&!this.properties.highlight.enabled)return;let maxDistance=1/0;if(intent==="tooltip"||intent==="highlight-tooltip"){const{tooltip}=this.properties;maxDistance=typeof tooltip.range=="number"?tooltip.range:1/0,exactMatchOnly||(exactMatchOnly=tooltip.range==="exact")}else if(intent==="event"||intent==="context-menu"){const{nodeClickRange}=this.properties;maxDistance=typeof nodeClickRange=="number"?nodeClickRange:1/0,exactMatchOnly||(exactMatchOnly=nodeClickRange==="exact")}const selectedPickModes=pickModes.filter(m=>!exactMatchOnly||m===0),{x,y}=point,key=JSON.stringify({x,y,maxDistance,selectedPickModes});if(this._pickNodeCache.has(key))return this._pickNodeCache.get(key);for(const pickMode of selectedPickModes){let result;switch(pickMode){case 0:{const exact=this.pickNodesExactShape(point);result=exact.length===0?void 0:{datums:exact,distance:0};break}case 1:{const closest=this.pickNodeClosestDatum(point),exact=(closest==null?void 0:closest.distance)===0?this.pickNodesExactShape(point):void 0;exact!=null&&exact.length!==0?result={datums:exact,distance:0}:closest?result={datums:[closest.datum],distance:closest.distance}:result=void 0;break}case 2:{const closest=pickModeAxis!=null?this.pickNodeMainAxisFirst(point,pickModeAxis==="main-category"):void 0;result=closest!=null?{datums:[closest.datum],distance:closest.distance}:void 0;break}}if(result&&result.distance<=maxDistance)return this._pickNodeCache.set(key,{pickMode,datums:result.datums,distance:result.distance})}return this._pickNodeCache.set(key,void 0)}pickNodesExactShape(point){const datums=[];for(const node of this.contentGroup.pickNodes(point.x,point.y)){const datum=node.closestDatum();datum!=null&&datum.missing!==!0&&datums.push(datum)}return datums}pickNodeClosestDatum(_point){throw new Error("AG Charts - Series.pickNodeClosestDatum() not implemented")}pickNodeNearestDistantObject(point,items){var _a294;const match=nearestSquared(point.x,point.y,items),datum=(_a294=match.nearest)==null?void 0:_a294.closestDatum();if(datum!=null&&datum.missing!==!0)return{datum,distance:Math.sqrt(match.distanceSquared)}}pickNodeMainAxisFirst(_point,_requireCategoryAxis){throw new Error("AG Charts - Series.pickNodeMainAxisFirst() not implemented")}getLabelData(){return[]}updatePlacedLabelData(_labels){}fireNodeClickEvent(event,datum){const clickEvent=new this.NodeEvent("seriesNodeClick",event,datum,this);return this.fireEvent(clickEvent),!clickEvent.defaultPrevented}fireNodeDoubleClickEvent(event,datum){const clickEvent=new this.NodeEvent("seriesNodeDoubleClick",event,datum,this);return this.fireEvent(clickEvent),!clickEvent.defaultPrevented}createNodeContextMenuActionEvent(event,datum){return new this.NodeEvent("nodeContextMenuAction",event,datum,this)}onLegendInitialState(legendType,initialState){const{visible=!0,itemId,legendItemName}=initialState??{};this.toggleSeriesItem(visible,legendType,itemId,legendItemName)}onLegendItemClick(event){const{enabled,itemId,series,legendType}=event,legendItemName="legendItemName"in this.properties?this.properties.legendItemName:void 0,legendItemKey="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,matchedLegendItemName=legendItemName!=null&&legendItemName===event.legendItemName;(series.id===this.id||matchedLegendItemName||legendItemKey!=null)&&this.toggleSeriesItem(enabled,legendType,itemId,legendItemName,event)}onLegendItemDoubleClick(event){const{enabled,itemId,series,numVisibleItems,legendType}=event,legendItemName="legendItemName"in this.properties?this.properties.legendItemName:void 0,legendItemKey="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,matchedLegendItemName=legendItemName!=null&&legendItemName===event.legendItemName;series.id===this.id||matchedLegendItemName||legendItemKey!=null?this.toggleSeriesItem(!0,legendType,itemId,legendItemName,event):enabled&&numVisibleItems===1?this.toggleSeriesItem(!0,legendType,void 0,legendItemName):this.toggleSeriesItem(!1,legendType,void 0,legendItemName)}toggleSeriesItem(enabled,legendType,itemId,legendItemName,legendEvent){const seriesId=this.id;(enabled||legendType!=="category")&&(this.visible=enabled),this.nodeDataRefresh=!0,this._pickNodeCache.clear();const event={type:"seriesVisibilityChange",seriesId,itemId,legendItemName:(legendEvent==null?void 0:legendEvent.legendItemName)??legendItemName,visible:enabled};this.fireEvent(event),this.ctx.legendManager.toggleItem(enabled,seriesId,itemId,legendItemName)}isEnabled(){return this.visible}getModuleMap(){return this.moduleMap}createModuleContext(){return{...this.ctx,series:this}}getLabelText(label,params,defaultFormatter=formatValue){return label.formatter?this.ctx.callbackCache.call(this.properties,label.formatter,{seriesId:this.id,...params})??this.callWithContext(defaultFormatter,params.value):this.callWithContext(defaultFormatter,params.value)}getMarkerStyle(marker,datum,params,highlighted=!1,size=marker.size??0,defaultStyle){const{itemStyler,fillGradientDefaults:fillGradientDefaults2,fillPatternDefaults:fillPatternDefaults2}=marker;let markerStyle=getShapeStyle(mergeDefaults({size},defaultStyle,marker.getStyle()),fillGradientDefaults2,fillPatternDefaults2);if(itemStyler&&params){const style=this.ctx.callbackCache.call(this.properties,itemStyler,{seriesId:this.id,...markerStyle,...params,highlighted,datum});markerStyle=getShapeStyle(mergeDefaults(style,markerStyle),fillGradientDefaults2,fillPatternDefaults2)}return markerStyle}updateMarkerStyle(marker,markerNode,datum,point,params,highlighted,defaultStyle,fillBBox,{applyTranslation=!0,selected=!0}={}){const activeStyle=this.getMarkerStyle(marker,datum,params,highlighted,point==null?void 0:point.size,defaultStyle),{shape,size}=activeStyle,visible=this.visible&&size>0&&point&&!isNaN(point.x)&&!isNaN(point.y);if(applyShapeStyle(markerNode,activeStyle,void 0,fillBBox),applyTranslation?markerNode.setProperties({visible,shape,size,x:point==null?void 0:point.x,y:point==null?void 0:point.y,scalingCenterX:point==null?void 0:point.x,scalingCenterY:point==null?void 0:point.y}):markerNode.setProperties({visible,shape,size}),selected||(markerNode.fillOpacity*=CROSS_FILTER_MARKER_FILL_OPACITY_FACTOR,markerNode.strokeOpacity*=CROSS_FILTER_MARKER_STROKE_OPACITY_FACTOR),typeof marker.shape=="function"&&!markerNode.dirtyPath){markerNode.path.clear(!0),markerNode.updatePath(),markerNode.checkPathDirty();const bb=markerNode.getBBox();if(point!==void 0&&bb.isFinite()){const center2=bb.computeCenter(),[dx,dy]=["x","y"].map(key=>(activeStyle.strokeWidth??0)+Math.abs(center2[key]-point[key]));point.focusSize=Math.max(bb.width+dx,bb.height+dy)}}}get nodeDataDependencies(){return this._nodeDataDependencies??{seriesRectWidth:NaN,seriesRectHeight:NaN}}checkResize(newSeriesRect){const{width:seriesRectWidth,height:seriesRectHeight}=newSeriesRect??{width:NaN,height:NaN},newNodeDataDependencies=newSeriesRect?{seriesRectWidth,seriesRectHeight}:void 0,resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;return resize&&(this._nodeDataDependencies=newNodeDataDependencies,this.markNodeDataDirty()),resize}pickFocus(_opts){}resetDatumCallbackCache(){this.datumCallbackCache.clear()}cachedDatumCallback(id,fn){const{datumCallbackCache}=this,existing=datumCallbackCache.get(id);if(existing!=null)return existing;try{const value=fn();return datumCallbackCache.set(id,value),value}catch(error){logger_exports.error(String(error))}}callWithContext(fn,...params){return callWithContext(this.properties,fn,params)}},__name(_a145,"Series"),_a145);__decorateClass([ActionOnSet({changeValue:__name(function(newVal,oldVal){this.onSeriesGroupingChange(oldVal,newVal)},"changeValue")})],Series.prototype,"seriesGrouping",2);function ScenePathChangeDetection(opts){const{changeCb,convertor}=opts??{};return SceneChangeDetection({type:"path",convertor,changeCb})}__name(ScenePathChangeDetection,"ScenePathChangeDetection");var _a146,Path=(_a146=class extends Shape{constructor(){super(...arguments),this.path=new ExtendedPath2D,this._clipX=NaN,this._clipY=NaN,this.clip=!1,this._dirtyPath=!0,this.lastPixelRatio=NaN}set clipX(value){this._clipX=value,this.dirtyPath=!0}set clipY(value){this._clipY=value,this.dirtyPath=!0}set dirtyPath(value){this._dirtyPath!==value&&(this._dirtyPath=value,value&&this.markDirty("path"))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){var _a294,_b;this._dirtyPath||(this.dirtyPath=this.path.isDirty()||(((_a294=this.fillShadow)==null?void 0:_a294.isDirty())??!1)||(((_b=this._clipPath)==null?void 0:_b.isDirty())??!1))}computeBBox(){return this.updatePathIfDirty(),this.path.computeBBox()}isPointInPath(x,y){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(x,y)}distanceSquared(x,y){return this.distanceSquaredTransformedPoint(x,y)}svgPathData(transform){return this.updatePathIfDirty(),this.path.toSVG(transform)}distanceSquaredTransformedPoint(x,y){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(x,y)?0:this.path.distanceSquared(x,y)}isDirtyPath(){return!1}updatePath(){}updatePathIfDirty(){(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1)}preRender(renderCtx){return renderCtx.devicePixelRatio!==this.lastPixelRatio&&(this.dirtyPath=!0),this.lastPixelRatio=renderCtx.devicePixelRatio,this.updatePathIfDirty(),super.preRender(renderCtx,this.path.commands.length)}render(renderCtx){var _a294,_b;const{ctx}=renderCtx;if(this.clip&&!isNaN(this._clipX)&&!isNaN(this._clipY)){ctx.save();const margin=this.strokeWidth/2;this._clipPath??(this._clipPath=new ExtendedPath2D),this._clipPath.clear(),this._clipPath.rect(-margin,-margin,this._clipX+margin,this._clipY+margin+margin),ctx.clip((_a294=this._clipPath)==null?void 0:_a294.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(ctx),ctx.restore()}else this._clipPath=void 0,this.drawPath(ctx);(_b=this.fillShadow)==null||_b.markClean(),super.render(renderCtx)}drawPath(ctx){this.fillStroke(ctx,this.path.getPath2D())}toSVG(){if(!this.visible)return;const element2=createSvgElement("path");element2.setAttribute("d",this.svgPathData());const defs=this.applySvgFillAttributes(element2,[]);return this.applySvgStrokeAttributes(element2),{elements:[element2],defs}}},__name(_a146,"Path"),_a146);Path.className="Path";__decorateClass([ScenePathChangeDetection()],Path.prototype,"clip",2);__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipX",1);__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipY",1);var _a147,FocusIndicator=(_a147=class{constructor(swapChain){this.swapChain=swapChain,this.hasBeenActivated=!1,this.div=createElement("div"),this.svg=createSvgElement("svg"),this.outerPath=createSvgElement("path"),this.innerPath=createSvgElement("path"),this.svg.append(this.outerPath),this.svg.append(this.innerPath),this.outerPath.classList.add("ag-charts-focus-svg-outer-path"),this.innerPath.classList.add("ag-charts-focus-svg-inner-path"),this.element=createElement("div","ag-charts-focus-indicator"),this.element.ariaHidden="true",this.element.append(this.svg),this.swapChain.addListener("swap",parent=>this.onSwap(parent))}clear(){}update(focus,rect,clip){if(rect!=null)if(focus instanceof Path){const transform=__name((localX,localY)=>{let{x,y}=Transformable.toCanvasPoint(focus,localX,localY);return x-=rect.x??0,y-=rect.y??0,{x,y}},"transform"),d=focus.svgPathData(transform);this.outerPath.setAttribute("d",d),this.innerPath.setAttribute("d",d),this.show(this.svg)}else{let bbox;if(clip){const x0=Math.max(focus.x-rect.x,0),y0=Math.max(focus.y-rect.y,0),x1=Math.min(focus.x+focus.width-rect.x,rect.width),y1=Math.min(focus.y+focus.height-rect.y,rect.height);bbox=new BBox(x0,y0,x1-x0,y1-y0)}else bbox=new BBox(focus.x-rect.x,focus.y-rect.y,focus.width,focus.height);setElementBBox(this.div,bbox),this.show(this.div)}}onSwap(newParent){newParent!==this.element.parentElement&&(this.element.remove(),newParent.appendChild(this.element),this.overrideFocusVisible(this.focusVisible))}show(child){this.hasBeenActivated=!0,this.element.innerHTML="",this.element.append(child)}overrideFocusVisible(focusVisible){this.focusVisible=focusVisible;const opacity={true:"1",false:"0",undefined:""},parent=this.element.parentElement;parent==null||parent.style.setProperty("opacity",opacity[`${focusVisible}`])}isFocusVisible(force=!1){if(!force&&!this.hasBeenActivated)return!1;const parent=this.element.parentElement;return parent!=null&&getWindow().getComputedStyle(parent).opacity==="1"}},__name(_a147,"FocusIndicator"),_a147),_a148,FocusSwapChain=(_a148=class{constructor(label1,label2,id,announcerRole){this.label1=label1,this.label2=label2,this.hasFocus=!1,this.skipDispatch=!1,this.listeners={blur:[],focus:[],swap:[]},this.onBlur=e=>(setElementStyle(e.target,"pointer-events",void 0),!this.skipDispatch&&this.dispatch("blur",e)),this.onFocus=e=>(setElementStyle(e.target,"pointer-events","auto"),!this.skipDispatch&&this.dispatch("focus",e)),setAttribute(this.label1,"id",`${id}-label1`),setAttribute(this.label2,"id",`${id}-label2`),setElementStyle(this.label1,"display","none"),setElementStyle(this.label2,"display","none"),this.activeAnnouncer=this.createAnnouncer(announcerRole),this.inactiveAnnouncer=this.createAnnouncer(announcerRole),setAttribute(this.activeAnnouncer,"tabindex",0),this.label2.insertAdjacentElement("afterend",this.activeAnnouncer),this.label2.insertAdjacentElement("afterend",this.inactiveAnnouncer),this.swap("")}createAnnouncer(role){const announcer=createElement("div");return announcer.role=role,announcer.className="ag-charts-swapchain",announcer.addEventListener("blur",this.onBlur),announcer.addEventListener("focus",this.onFocus),announcer}destroy(){for(const announcer of[this.activeAnnouncer,this.inactiveAnnouncer])announcer.removeEventListener("blur",this.onBlur),announcer.removeEventListener("focus",this.onFocus),announcer.remove()}focus(opts){this.focusOptions=opts,this.activeAnnouncer.focus(opts),this.focusOptions=void 0}update(newLabel){this.skipDispatch=!0,this.swap(newLabel),this.hasFocus&&this.activeAnnouncer.focus(this.focusOptions),this.skipDispatch=!1}addListener(type,handler){this.listeners[type].push(handler),type==="swap"&&handler(this.activeAnnouncer)}dispatch(type,param){type==="focus"?this.hasFocus=!0:type==="blur"&&(this.hasFocus=!1),this.listeners[type].forEach(fn=>fn(param))}swap(newLabel){const userTabIndex=this.activeAnnouncer.tabIndex;this.label2.textContent=newLabel,[this.inactiveAnnouncer,this.activeAnnouncer]=[this.activeAnnouncer,this.inactiveAnnouncer],[this.label1,this.label2]=[this.label2,this.label1],setAttributes(this.inactiveAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!0,tabindex:void 0}),setAttributes(this.activeAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!1,tabindex:userTabIndex}),this.dispatch("swap",this.activeAnnouncer)}},__name(_a148,"FocusSwapChain"),_a148),KEY_BINDINGS={arrowdown:{bindings:[{code:"ArrowDown"}]},arrowleft:{bindings:[{code:"ArrowLeft"}]},arrowright:{bindings:[{code:"ArrowRight"}]},arrowup:{bindings:[{code:"ArrowUp"}]},delete:{bindings:[{key:"Backspace"},{key:"Delete"}],activatesFocusIndicator:!1},redo:{bindings:[{key:"y",ctrlOrMeta:!0},{key:"z",ctrlOrMeta:!0,shift:!0}],activatesFocusIndicator:!1},undo:{bindings:[{key:"z",ctrlOrMeta:!0}],activatesFocusIndicator:!1},submit:{bindings:[{key:"Enter"},{code:"Enter"},{code:"Space"}]},zoomin:{bindings:[{key:"+"},{code:"ZoomIn"},{code:"Add"}],activatesFocusIndicator:!1},zoomout:{bindings:[{key:"-"},{code:"ZoomOut"},{code:"Substract"}],activatesFocusIndicator:!1}};function matchesKeyBinding(e,bindings){for(const kb of bindings)if("code"in kb){if(kb.code===e.code)return!0}else if(kb.key===e.key&&(kb.shift===void 0||kb.shift===e.shiftKey)&&(kb.ctrlOrMeta===void 0||kb.ctrlOrMeta===e.ctrlKey||kb.ctrlOrMeta===e.metaKey))return!0;return!1}__name(matchesKeyBinding,"matchesKeyBinding");function mapKeyboardEventToAction(event){for(const[actionName,{activatesFocusIndicator=!0,bindings}]of entries(KEY_BINDINGS))if(matchesKeyBinding(event,bindings))return{name:actionName,activatesFocusIndicator}}__name(mapKeyboardEventToAction,"mapKeyboardEventToAction");function computeCenter(series,hoverRect,pick){const refPoint=getDatumRefPoint(series,pick.datum,pick.movedBounds);if(refPoint!=null)return{x:refPoint.canvasX,y:refPoint.canvasY};const bboxOrPath=pick.bounds;if(bboxOrPath!=null){if(bboxOrPath instanceof BBox){const{x:centerX,y:centerY}=bboxOrPath.computeCenter();return{x:hoverRect.x+centerX,y:hoverRect.y+centerY}}return Transformable.toCanvas(bboxOrPath).computeCenter()}}__name(computeCenter,"computeCenter");function getPickedFocusBBox({bounds}){return bounds instanceof BBox?bounds:bounds!=null?Transformable.toCanvas(bounds):BBox.NaN}__name(getPickedFocusBBox,"getPickedFocusBBox");function makeKeyboardPointerEvent(series,hoverRect,pick){const{x:canvasX,y:canvasY}=computeCenter(series,hoverRect,pick)??{};if(canvasX!==void 0&&canvasY!==void 0)return{type:"keyboard",canvasX,canvasY}}__name(makeKeyboardPointerEvent,"makeKeyboardPointerEvent");function createDeprecationWarning(){return(key,message)=>{const msg=[`Property [${key}] is deprecated.`,message].filter(Boolean).join(" ");logger_exports.warnOnce(msg)}}__name(createDeprecationWarning,"createDeprecationWarning");function Deprecated(message,opts){const warnDeprecated=createDeprecationWarning(),def=opts==null?void 0:opts.default;return addTransformToInstanceProperty((_,key,value)=>(value!==def&&warnDeprecated(key.toString(),message),value))}__name(Deprecated,"Deprecated");function DeprecatedAndRenamedTo(newPropName,mapValue){const warnDeprecated=createDeprecationWarning();return addTransformToInstanceProperty((target,key,value)=>(value!==target[newPropName]&&(warnDeprecated(key.toString(),`Use [${newPropName}] instead.`),setPath(target,newPropName,mapValue?mapValue(value):value)),BREAK_TRANSFORM_CHAIN),(target,key)=>(warnDeprecated(key.toString(),`Use [${newPropName}] instead.`),getPath(target,newPropName)))}__name(DeprecatedAndRenamedTo,"DeprecatedAndRenamedTo");function calculatePlacement(naturalWidth,naturalHeight,container,bounds){let{top,right,bottom,left,width:width2,height:height2}=bounds;return left!=null?width2!=null?right=container.width-left+width2:right!=null&&(width2=container.width-left-right):right!=null&&width2!=null&&(left=container.width-right-width2),top!=null?height2!=null?bottom=container.height-top-height2:bottom!=null&&(height2=container.height-bottom-top):bottom!=null&&height2!=null&&(top=container.height-bottom-height2),width2==null?height2==null?(width2=naturalWidth,height2=naturalHeight):width2=Math.ceil(naturalWidth*height2/naturalHeight):height2==null&&(height2=Math.ceil(naturalHeight*width2/naturalWidth)),left==null&&(right==null?left=Math.floor((container.width-width2)/2):left=container.width-right-width2),top==null&&(bottom==null?top=Math.floor((container.height-height2)/2):top=container.height-height2-bottom),{x:left,y:top,width:width2,height:height2}}__name(calculatePlacement,"calculatePlacement");var M=.1,K=200,C=12,DELTA=.5,_a149,SpringAnimation=(_a149=class extends Listeners{constructor(){super(...arguments),this.x1=NaN,this.y1=NaN,this.x=NaN,this.y=NaN,this.vx=0,this.vy=0,this.t0=NaN,this.animationFrameHandle=void 0}reset(){this.x=NaN,this.y=NaN,this.animationFrameHandle!=null&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0)}update(x,y){if(Number.isNaN(this.x)||Number.isNaN(this.y)){this.x=x,this.y=y,this.vx=0,this.vy=0,this.emitUpdate(),this.animationFrameHandle!=null&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0);return}this.x1=x,this.y1=y,this.t0=Date.now(),this.animationFrameHandle==null&&(this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this)))}onFrame(){this.animationFrameHandle=void 0;const{x1,y1,t0}=this,t1=Date.now(),dt=t1-t0;this.t0=t1;const stepT=.001,iterations=Math.ceil(dt/(stepT*1e3))|0;let{x,y,vx,vy}=this;for(let i=0;i<iterations;i+=1){const dx=x-x1,dy=y-y1,ax=-(K*dx+C*vx)/M,ay=-(K*dy+C*vy)/M;vx+=ax*stepT,vy+=ay*stepT,x+=vx*stepT,y+=vy*stepT}Math.hypot(x-x1,y-y1)<DELTA?(this.x=this.x1,this.y=this.y1,this.vx=0,this.vy=0):(this.x=x,this.y=y,this.vx=vx,this.vy=vy,this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this))),this.emitUpdate()}emitUpdate(){this.dispatch("update",{type:"update",x:this.x,y:this.y})}},__name(_a149,"SpringAnimation"),_a149),element=null;function sanitizeHtml(text2){return text2===""?"":(element??(element=createElement("div")),element.textContent=String(text2),element.innerHTML.replace(/\n/g,"<br>"))}__name(sanitizeHtml,"sanitizeHtml");function drawMarkerUnitPolygon(params,moves){const{path,size}=params,{x:x0,y:y0}=params;path.clear();let didMove=!1;for(const[dx,dy]of moves){const x=x0+(dx-.5)*size,y=y0+(dy-.5)*size;didMove?path.lineTo(x,y):path.moveTo(x,y),didMove=!0}path.closePath()}__name(drawMarkerUnitPolygon,"drawMarkerUnitPolygon");var MARKER_SHAPES={circle({path,x,y,size}){const r=size/2;path.clear(),path.arc(x,y,r,0,Math.PI*2),path.closePath()},cross(params){drawMarkerUnitPolygon(params,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},diamond(params){drawMarkerUnitPolygon(params,[[.5,0],[1,.5],[.5,1],[0,.5]])},heart({path,x,y,size}){const r=size/4;y=y+r/2,path.clear(),path.arc(x-r,y-r,r,toRadians(130),toRadians(330)),path.arc(x+r,y-r,r,toRadians(220),toRadians(50)),path.lineTo(x,y+r),path.closePath()},pin({path,x,y,size:s}){path.moveTo(x+(.15625-.5)*s,y+(.34375-.5)*s),path.cubicCurveTo(x+(.15625-.5)*s,y+(.151491-.5)*s,x+(.307741-.5)*s,y+(0-.5)*s,x+(.5-.5)*s,y+(0-.5)*s),path.cubicCurveTo(x+(.692259-.5)*s,y+(0-.5)*s,x+(.84375-.5)*s,y+(.151491-.5)*s,x+(.84375-.5)*s,y+(.34375-.5)*s),path.cubicCurveTo(x+(.84375-.5)*s,y+(.493824-.5)*s,x+(.784625-.5)*s,y+(.600181-.5)*s,x+(.716461-.5)*s,y+(.695393-.5)*s),path.cubicCurveTo(x+(.699009-.5)*s,y+(.719769-.5)*s,x+(.681271-.5)*s,y+(.743104-.5)*s,x+(.663785-.5)*s,y+(.766105-.5)*s),path.cubicCurveTo(x+(.611893-.5)*s,y+(.834367-.5)*s,x+(.562228-.5)*s,y+(.899699-.5)*s,x+(.528896-.5)*s,y+(.980648-.5)*s),path.cubicCurveTo(x+(.524075-.5)*s,y+(.992358-.5)*s,x+(.512663-.5)*s,y+(1-.5)*s,x+(.5-.5)*s,y+(1-.5)*s),path.cubicCurveTo(x+(.487337-.5)*s,y+(1-.5)*s,x+(.475925-.5)*s,y+(.992358-.5)*s,x+(.471104-.5)*s,y+(.980648-.5)*s),path.cubicCurveTo(x+(.487337-.5)*s,y+(1-.5)*s,x+(.475925-.5)*s,y+(.992358-.5)*s,x+(.471104-.5)*s,y+(.980648-.5)*s),path.cubicCurveTo(x+(.437772-.5)*s,y+(.899699-.5)*s,x+(.388107-.5)*s,y+(.834367-.5)*s,x+(.336215-.5)*s,y+(.766105-.5)*s),path.cubicCurveTo(x+(.318729-.5)*s,y+(.743104-.5)*s,x+(.300991-.5)*s,y+(.719769-.5)*s,x+(.283539-.5)*s,y+(.695393-.5)*s),path.cubicCurveTo(x+(.215375-.5)*s,y+(.600181-.5)*s,x+(.15625-.5)*s,y+(.493824-.5)*s,x+(.15625-.5)*s,y+(.34375-.5)*s),path.closePath()},plus(params){drawMarkerUnitPolygon(params,[[1/3,0],[2/3,0],[2/3,1/3],[1,1/3],[1,2/3],[2/3,2/3],[2/3,1],[1/3,1],[1/3,2/3],[0,2/3],[0,1/3],[1/3,1/3]])},square({path,x,y,size,pixelRatio}){const hs=size/2;path.clear(),path.moveTo(align(pixelRatio,x-hs),align(pixelRatio,y-hs)),path.lineTo(align(pixelRatio,x+hs),align(pixelRatio,y-hs)),path.lineTo(align(pixelRatio,x+hs),align(pixelRatio,y+hs)),path.lineTo(align(pixelRatio,x-hs),align(pixelRatio,y+hs)),path.closePath()},star({path,x,y,size}){const outerRadius=size/2,innerRadius=outerRadius/2,rotation=Math.PI/2;for(let i=0;i<5*2;i++){const radius=i%2===0?outerRadius:innerRadius,angle2=i*Math.PI/5-rotation,xCoordinate=x+Math.cos(angle2)*radius,yCoordinate=y+Math.sin(angle2)*radius;path.lineTo(xCoordinate,yCoordinate)}path.closePath()},triangle(params){drawMarkerUnitPolygon(params,[[.5,0],[1,.87],[0,.87]])}},_a150,InternalMarker=(_a150=class extends Path{constructor(){super(...arguments),this.shape="square",this.x=0,this.y=0,this.size=12}updatePath(){var _a294,_b;const{path,shape,x,y,size}=this,pixelRatio=((_b=(_a294=this.layerManager)==null?void 0:_a294.canvas)==null?void 0:_b.pixelRatio)??1,anchor=Marker.anchor(shape),drawParams={path,x:x-(anchor.x-.5)*size,y:y-(anchor.y-.5)*size,size,pixelRatio};path.clear(),typeof shape=="string"?MARKER_SHAPES[shape](drawParams):typeof shape=="function"&&shape(drawParams)}computeBBox(){const{x,y,size}=this,anchor=Marker.anchor(this.shape);return new BBox(x-size*anchor.x,y-size*anchor.y,size,size)}executeFill(ctx,path){if(path)return super.executeFill(ctx,path)}executeStroke(ctx,path){if(path)return super.executeStroke(ctx,path)}},__name(_a150,"InternalMarker"),_a150);__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"shape",2);__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"y",2);__decorateClass([ScenePathChangeDetection({convertor:Math.abs})],InternalMarker.prototype,"size",2);var _a151,Marker=(_a151=class extends Rotatable(Scalable(Translatable(InternalMarker))){static anchor(shape){return shape==="pin"?{x:.5,y:1}:typeof shape=="function"&&"anchor"in shape?shape.anchor:{x:.5,y:.5}}constructor(options){super(options),(options==null?void 0:options.shape)!=null&&(this.shape=options.shape)}},__name(_a151,"Marker"),_a151);function legendSymbolSvg(symbol,size,lineSize=size*(5/3)){var _a294;const group=new Group,markerStrokeWidth=Math.min(symbol.marker.strokeWidth??1,2),lineStrokeWidth=Math.min(((_a294=symbol.line)==null?void 0:_a294.strokeWidth)??0,2),width2=Math.max(symbol.marker.enabled===!1?0:size,symbol.line==null?0:lineSize),height2=Math.max(symbol.marker.enabled===!1?0:size,lineStrokeWidth);if(symbol.line!=null){const{stroke:stroke2,strokeOpacity,lineDash}=symbol.line,line=new Line;line.x1=0,line.y1=height2/2,line.x2=width2,line.y2=height2/2,line.stroke=stroke2,line.strokeOpacity=strokeOpacity,line.strokeWidth=lineStrokeWidth,line.lineDash=lineDash,group.append(line)}if(symbol.marker.enabled!==!1){const{shape,fill,fillOpacity,stroke:stroke2,strokeOpacity,lineDash,lineDashOffset}=symbol.marker,marker=new Marker;marker.shape=shape??"square",marker.size=size,marker.fill=fill,marker.fillOpacity=fillOpacity??1,marker.stroke=stroke2,marker.strokeOpacity=strokeOpacity??1,marker.strokeWidth=markerStrokeWidth,marker.lineDash=lineDash,marker.lineDashOffset=lineDashOffset??0;const anchor=Marker.anchor(shape),x=width2/2+(anchor.x-.5)*size,y=height2/2+(anchor.y-.5)*size,scale2=size/(size+markerStrokeWidth);marker.x=x,marker.y=y,marker.scalingCenterX=x,marker.scalingCenterY=y,marker.scalingX=scale2,marker.scalingY=scale2,group.append(marker)}return Group.toSVG(group,width2,height2)}__name(legendSymbolSvg,"legendSymbolSvg");var DEFAULT_TOOLTIP_CLASS="ag-charts-tooltip",DEFAULT_TOOLTIP_DARK_CLASS="ag-charts-tooltip--dark";function aggregateTooltipContent(content){const out=[],groupedContents=new Map;for(const item of content)if(item.type==="structured"){const{heading}=item,insertionTarget=heading!=null?groupedContents.get(heading):void 0,groupedItem={type:"structured",heading,items:[item]};insertionTarget==null?(groupedContents.set(heading,groupedItem),out.push(groupedItem)):insertionTarget.items.push(item)}else out.push(item);return out}__name(aggregateTooltipContent,"aggregateTooltipContent");function tooltipContentAriaLabel(ungroupedContent){const content=aggregateTooltipContent(ungroupedContent),ariaLabel=[];return content.forEach(c=>{if(c.type==="raw")return"";c.heading!=null&&ariaLabel.push(c.heading),c.items.forEach(i=>{var _a294;i.title!=null&&ariaLabel.push(i.title),(_a294=i.data)==null||_a294.forEach(datum=>{ariaLabel.push(datum.label??datum.fallbackLabel,datum.value)})})}),ariaLabel.join("; ")}__name(tooltipContentAriaLabel,"tooltipContentAriaLabel");function dataHtml(label,value,inline){let rowHtml="";label==null?rowHtml+=`<span class="${DEFAULT_TOOLTIP_CLASS}-label">${sanitizeHtml(value)}</span>`:(rowHtml+=`<span class="${DEFAULT_TOOLTIP_CLASS}-label">${sanitizeHtml(label)}</span>`,rowHtml+=" ",rowHtml+=`<span class="${DEFAULT_TOOLTIP_CLASS}-value">${sanitizeHtml(value)}</span>`);const rowClassNames=[`${DEFAULT_TOOLTIP_CLASS}-row`];return inline&&rowClassNames.push(`${DEFAULT_TOOLTIP_CLASS}-row--inline`),rowHtml=`<div class="${rowClassNames.join(" ")}">${rowHtml}</div>`,rowHtml}__name(dataHtml,"dataHtml");function tooltipRowContentHtml(content){var _a294,_b,_c;let html="";const dataInline=content.title==null&&((_a294=content.data)==null?void 0:_a294.length)===1,symbol=content.symbol==null?void 0:legendSymbolSvg(content.symbol,12);return symbol!=null&&(content.title!=null||(_b=content.data)!=null&&_b.length)&&(html+=`<span class="${DEFAULT_TOOLTIP_CLASS}-symbol">${symbol}</span>`),content.title!=null&&(html+=`<span class="${DEFAULT_TOOLTIP_CLASS}-title">${sanitizeHtml(content.title)}</span>`,html+=" "),(_c=content.data)==null||_c.forEach(datum=>{html+=dataHtml(datum.label??datum.fallbackLabel,datum.value,dataInline),html+=" "}),html}__name(tooltipRowContentHtml,"tooltipRowContentHtml");function tooltipPaginationContentHtml(localeManager,pagination){if(localeManager==null||pagination.length===1)return;const text2=localeManager==null?void 0:localeManager.t("tooltipPaginationStatus",{index:pagination.index+1,count:pagination.length});return`<div class="${DEFAULT_TOOLTIP_CLASS}-footer">${text2}</div>`}__name(tooltipPaginationContentHtml,"tooltipPaginationContentHtml");function tooltipContentHtml(localeManager,content,mode,pagination){var _a294,_b;const singleItem=content.items.length===1?content.items[0]:void 0;let compact,compactTitle,compactFallbackLabel;switch(mode){case"compact":compact=!0,compactTitle=singleItem==null?void 0:singleItem.title;break;case"single":compact=singleItem!=null&&(content.heading==null||singleItem.title==null)&&((_a294=singleItem.data)==null?void 0:_a294.length)===1&&singleItem.data[0].label==null&&singleItem.data[0].value!=null,compactFallbackLabel=content.heading??(singleItem==null?void 0:singleItem.title);break;case"shared":compact=!1}let html="";if(compact&&singleItem!=null?(compactTitle!=null&&(html+=dataHtml(void 0,compactTitle,!1)),(_b=singleItem.data)==null||_b.forEach(datum=>{html+=dataHtml(datum.label??compactFallbackLabel,datum.value,!1),html+=" "})):(content.heading!=null&&(html+=`<span class="${DEFAULT_TOOLTIP_CLASS}-heading">${sanitizeHtml(content.heading)}</span>`,html+=" "),content.items.forEach(item=>{html+=tooltipRowContentHtml(item)})),html.length===0)return;const paginationContent=mode!=="compact"&&pagination!=null?tooltipPaginationContentHtml(localeManager,pagination):void 0;return paginationContent+null&&(html+=paginationContent),html=`<div class="${DEFAULT_TOOLTIP_CLASS}-content">${html.trimEnd()}</div>`,html}__name(tooltipContentHtml,"tooltipContentHtml");function tooltipPaginationHtml(localeManager,pagination){const paginationContent=pagination==null?void 0:tooltipPaginationContentHtml(localeManager,pagination);return paginationContent==null?"":`<div class="${DEFAULT_TOOLTIP_CLASS}-content">${paginationContent}</div>`}__name(tooltipPaginationHtml,"tooltipPaginationHtml");function tooltipHtml(localeManager,content,mode,pagination){const aggregatedContent=aggregateTooltipContent(content);if(aggregatedContent.length!==0){if(aggregatedContent.length===1&&aggregatedContent[0].type==="structured")return tooltipContentHtml(localeManager,aggregatedContent[0],mode,pagination);{const htmlRows=aggregatedContent.map(c=>c.type==="structured"?tooltipContentHtml(localeManager,c,mode):c.rawHtmlString);return pagination!=null&&htmlRows.push(tooltipPaginationHtml(localeManager,pagination)??""),htmlRows.join("")}}}__name(tooltipHtml,"tooltipHtml");var horizontalAlignments={left:-1,"top-left":-1,"bottom-left":-1,top:0,center:0,bottom:0,right:1,"top-right":1,"bottom-right":1},verticalAlignments={"top-left":-1,top:-1,"top-right":-1,left:0,center:0,right:0,"bottom-left":1,bottom:1,"bottom-right":1},arrowPositions={left:3,"top-left":void 0,"bottom-left":void 0,top:2,center:void 0,bottom:1,right:0,"top-right":void 0,"bottom-right":void 0},directionChecks={top:2,bottom:2,left:1,right:1,"top-right":3,"top-left":3,"bottom-right":3,"bottom-left":3,center:0};UNION(["single","shared","compact"]);UNION(["pointer","node","top","right","bottom","left","top-left","top-right","bottom-right","bottom-left"],"a position type");UNION(["pointer","node","chart"],"an anchorTo");var PLACEMENT_UNION=UNION(["top","right","bottom","left","top-right","bottom-right","bottom-left","top-left","center"],"a placement");OR(PLACEMENT_UNION,ARRAY_OF(PLACEMENT_UNION));var _a152,TooltipPosition=(_a152=class extends BaseProperties{constructor(){super(...arguments),this.xOffset=0,this.yOffset=0}get defaultAnchorTo(){const{type,_seriesOverrideType}=this,defaultType=type??_seriesOverrideType??"pointer";return defaultType==="node"||defaultType==="pointer"?defaultType:"chart"}get defaultPlacement(){const{type,_seriesOverrideType}=this,defaultType=type??_seriesOverrideType??"pointer";return defaultType==="node"||defaultType==="pointer"?"top":defaultType}},__name(_a152,"TooltipPosition"),_a152);__decorateClass([TempValidate(),Deprecated("Use `anchorTo` and/or `placement` options instead.")],TooltipPosition.prototype,"type",2);__decorateClass([TempValidate()],TooltipPosition.prototype,"_seriesOverrideType",2);__decorateClass([TempValidate()],TooltipPosition.prototype,"xOffset",2);__decorateClass([TempValidate()],TooltipPosition.prototype,"yOffset",2);__decorateClass([TempValidate()],TooltipPosition.prototype,"anchorTo",2);__decorateClass([TempValidate()],TooltipPosition.prototype,"placement",2);var _a153,Tooltip=(_a153=class extends BaseProperties{constructor(){super(),this.enabled=!0,this.mode="single",this.delay=0,this.range=void 0,this.wrapping="hyphenate",this.position=new TooltipPosition,this.pagination=!1,this.darkTheme=!1,this.bounds="extended",this.destroyFns=[],this.springAnimation=new SpringAnimation,this.enableInteraction=!1,this.wrapTypes=["always","hyphenate","on-space","never"],this.sizeMonitor=new SizeMonitor,this._elementSize=void 0,this._showTimeout=void 0,this.arrowPosition=void 0,this._visible=!1,this.positionParams=void 0,this.localeManager=void 0,this.destroyFns.push(this.springAnimation.addListener("update",this.updateTooltipPosition.bind(this)))}get interactive(){return this.enableInteraction}setup(localeManager,domManager){return"togglePopover"in getWindow().HTMLElement.prototype&&(this.element=domManager.addChild("tooltip-container",DEFAULT_TOOLTIP_CLASS),this.element.setAttribute("popover","manual"),this.element.className=DEFAULT_TOOLTIP_CLASS,this.element.style.positionAnchor=domManager.anchorName,this.sizeMonitor.observe(this.element,size=>{this._elementSize=size,this.updateTooltipPosition()})),this.localeManager=localeManager,()=>{domManager.removeChild("tooltip-container",DEFAULT_TOOLTIP_CLASS),this.destroyFns.forEach(f=>f()),this.element&&this.sizeMonitor.unobserve(this.element)}}isVisible(){return this._visible}contains(node){var _a294;return((_a294=this.element)==null?void 0:_a294.contains(node))??!1}updateTooltipPosition(){var _a294,_b,_c,_d,_e,_f;const{element:element2,_elementSize:elementSize,positionParams}=this;if(element2==null||elementSize==null||positionParams==null)return;const{canvasRect,relativeRect,meta}=positionParams,{x:canvasX,y:canvasY}=this.springAnimation;let placements2=((_a294=meta.position)==null?void 0:_a294.placement)??this.position.placement??((_b=meta.position)==null?void 0:_b.defaultPlacement)??this.position.defaultPlacement;Array.isArray(placements2)||(placements2=[placements2]);const anchorTo=((_c=meta.position)==null?void 0:_c.anchorTo)??this.position.anchorTo??((_d=meta.position)==null?void 0:_d.defaultAnchorTo)??this.position.defaultAnchorTo,xOffset=((_e=meta.position)==null?void 0:_e.xOffset)??0,yOffset=((_f=meta.position)==null?void 0:_f.yOffset)??0,minX=relativeRect.x,minY=relativeRect.y,maxX=relativeRect.width-elementSize.width-1+minX,maxY=relativeRect.height-elementSize.height+minY;let i=0,placement,position,constrained=!1;do{placement=placements2[i],i+=1;const tooltipBounds=this.getTooltipBounds({elementSize,placement,anchorTo,canvasX,canvasY,yOffset,xOffset,canvasRect});position=calculatePlacement(elementSize.width,elementSize.height,relativeRect,tooltipBounds),constrained=!1,directionChecks[placement]&1&&(constrained||(constrained=position.x<minX||position.x>maxX)),directionChecks[placement]&2&&(constrained||(constrained=position.y<minY||position.y>maxY))}while(i<placements2.length&&constrained);const left=clamp(minX,position.x,maxX),top=clamp(minY,position.y,maxY);constrained||(constrained=left!==position.x||top!==position.y);const defaultShowArrow=anchorTo!=="chart"&&!constrained&&!xOffset&&!yOffset,showArrow=meta.showArrow??this.showArrow??defaultShowArrow;this.arrowPosition=showArrow?arrowPositions[placement]:void 0,this.updateClassModifiers(),element2.style.translate=`${left}px ${top}px`}show(boundingRect,canvasRect,meta,content,pagination,instantly=!1){var _a294,_b;const{element:element2}=this;if(element2!=null&&content!=null&&content.length!==0){const html=tooltipHtml(this.localeManager,content,this.mode,this.pagination?pagination:void 0);if(html==null){this.toggle(!1);return}element2.innerHTML=html}else if(element2==null||element2.innerHTML===""){this.toggle(!1);return}const relativeRect={x:boundingRect.x-canvasRect.x,y:boundingRect.y-canvasRect.y,width:boundingRect.width,height:boundingRect.height};switch(this.positionParams={canvasRect,relativeRect,meta},((_a294=meta.position)==null?void 0:_a294.anchorTo)??this.position.anchorTo??((_b=meta.position)==null?void 0:_b.defaultAnchorTo)??this.position.defaultAnchorTo){case"node":this.springAnimation.update(meta.nodeCanvasX??meta.canvasX,meta.nodeCanvasY??meta.canvasY);break;case"pointer":this.springAnimation.update(meta.canvasX,meta.canvasY);break;case"chart":this.springAnimation.reset()}meta.enableInteraction?(this.enableInteraction=!0,element2.style.pointerEvents="auto",element2.removeAttribute("aria-hidden"),element2.tabIndex=-1):(this.enableInteraction=!1,element2.style.pointerEvents="none",element2.setAttribute("aria-hidden","true"),element2.removeAttribute("tabindex")),element2.style.setProperty("--top",`${canvasRect.top}px`),element2.style.setProperty("--left",`${canvasRect.left}px`),this.updateClassModifiers(),this.toggle(!0,instantly)}hide(){this.toggle(!1)}toggle(visible,instantly=!1){const{delay}=this;visible&&delay>0&&!instantly?this._showTimeout??(this._showTimeout=setTimeout(()=>{this._showTimeout=void 0,this.toggleCallback(!0)},delay)):(clearTimeout(this._showTimeout),this._showTimeout=void 0,this.toggleCallback(visible))}toggleCallback(visible){var _a294;(_a294=this.element)!=null&&_a294.isConnected&&this._visible!==visible&&(this._visible=visible,this.element.togglePopover(visible),visible?this.updateTooltipPosition():this.springAnimation.reset())}updateClassModifiers(){var _a294;if(!((_a294=this.element)!=null&&_a294.isConnected))return;const{classList}=this.element,toggleClass=__name((name,include)=>classList.toggle(`${DEFAULT_TOOLTIP_CLASS}--${name}`,include),"toggleClass");toggleClass("no-interaction",!this.enableInteraction),toggleClass("arrow-top",this.arrowPosition===1),toggleClass("arrow-right",this.arrowPosition===3),toggleClass("arrow-bottom",this.arrowPosition===2),toggleClass("arrow-left",this.arrowPosition===0),toggleClass("compact",this.mode==="compact"),classList.toggle(DEFAULT_TOOLTIP_DARK_CLASS,this.darkTheme);for(const wrapType of this.wrapTypes)classList.toggle(`${DEFAULT_TOOLTIP_CLASS}--wrap-${wrapType}`,wrapType===this.wrapping)}getTooltipBounds(opts){const{elementSize,anchorTo,placement,canvasX,canvasY,yOffset,xOffset,canvasRect}=opts,{width:tooltipWidth,height:tooltipHeight}=elementSize,bounds={width:tooltipWidth,height:tooltipHeight};if(anchorTo==="node"||anchorTo==="pointer"){const horizontalAlignment=horizontalAlignments[placement],verticalAlignment=verticalAlignments[placement];return bounds.top=canvasY+yOffset+tooltipHeight*(verticalAlignment-1)/2+8*verticalAlignment,bounds.left=canvasX+xOffset+tooltipWidth*(horizontalAlignment-1)/2+8*horizontalAlignment,bounds}switch(placement){case"top":return bounds.top=yOffset,bounds.left=canvasRect.width/2-tooltipWidth/2+xOffset,bounds;case"right":return bounds.top=canvasRect.height/2-tooltipHeight/2+yOffset,bounds.left=canvasRect.width-tooltipWidth/2+xOffset,bounds;case"left":return bounds.top=canvasRect.height/2-tooltipHeight/2+yOffset,bounds.left=xOffset,bounds;case"bottom":return bounds.top=canvasRect.height-tooltipHeight+yOffset,bounds.left=canvasRect.width/2-tooltipWidth/2+xOffset,bounds;case"top-left":return bounds.top=yOffset,bounds.left=xOffset,bounds;case"top-right":return bounds.top=yOffset,bounds.left=canvasRect.width-tooltipWidth+xOffset,bounds;case"bottom-right":return bounds.top=canvasRect.height-tooltipHeight+yOffset,bounds.left=canvasRect.width-tooltipWidth+xOffset,bounds;case"bottom-left":return bounds.top=canvasRect.height-tooltipHeight+yOffset,bounds.left=xOffset,bounds}return bounds}},__name(_a153,"Tooltip"),_a153);__decorateClass([TempValidate()],Tooltip.prototype,"enabled",2);__decorateClass([TempValidate()],Tooltip.prototype,"mode",2);__decorateClass([TempValidate()],Tooltip.prototype,"showArrow",2);__decorateClass([TempValidate()],Tooltip.prototype,"delay",2);__decorateClass([TempValidate()],Tooltip.prototype,"range",2);__decorateClass([TempValidate()],Tooltip.prototype,"wrapping",2);__decorateClass([TempValidate()],Tooltip.prototype,"position",2);__decorateClass([TempValidate()],Tooltip.prototype,"pagination",2);__decorateClass([TempValidate()],Tooltip.prototype,"darkTheme",2);__decorateClass([TempValidate(UNION(["extended","canvas"]))],Tooltip.prototype,"bounds",2);function pickedNodesEqual(a,b){return a.series===b.series&&objectsEqual(a.datumIndex,b.datumIndex)}__name(pickedNodesEqual,"pickedNodesEqual");var _a154,PickedNodeState=(_a154=class{constructor(){this.candidates=[]}get current(){return this.active}reset(){this.candidates.length=0,this.active=void 0}update(nextCandidates,previousActive){this.candidates=nextCandidates;let nextIndex=previousActive!=null?nextCandidates.findIndex(c=>pickedNodesEqual(c,previousActive)):-1;return nextIndex===-1&&(nextIndex=0),this.active=nextCandidates[nextIndex],{current:this.active,index:nextIndex,length:nextCandidates.length}}next(){const{candidates,active}=this,hoverIndex=active==null?-1:candidates.findIndex(c=>pickedNodesEqual(c,active));if(hoverIndex===-1)return;let nextIndex=hoverIndex+1;return nextIndex>=candidates.length&&(nextIndex=0),this.active=candidates[nextIndex],{current:this.active,index:nextIndex,length:this.candidates.length}}},__name(_a154,"PickedNodeState"),_a154),_a155,SeriesAreaManager=(_a155=class extends BaseManager{constructor(chart){super(),this.chart=chart,this.id=createId(this),this.series=[],this.highlight={pendingHoverEvent:void 0,appliedHoverEvent:void 0,stashedHoverEvent:void 0},this.tooltip={lastHover:void 0},this.hoverDevice="pointer",this.previousInputDevice="keyboard",this.focus={sortedSeries:[],series:void 0,seriesIndex:0,datumIndex:0,datum:void 0},this.hoverScheduler=debouncedAnimationFrame(()=>{if(!(!this.tooltip.lastHover&&!this.highlight.pendingHoverEvent)){if(this.chart.getUpdateType()<=4){this.hoverScheduler.schedule();return}this.highlight.pendingHoverEvent&&this.handleHoverHighlight(!1),this.tooltip.lastHover&&this.handleHoverTooltip(this.tooltip.lastHover,!1)}}),this.tooltipCandidates=new PickedNodeState;const label1=chart.ctx.domManager.addChild("series-area","series-area-aria-label1"),label2=chart.ctx.domManager.addChild("series-area","series-area-aria-label2");this.swapChain=new FocusSwapChain(label1,label2,this.id,"img"),this.swapChain.addListener("blur",event=>this.onBlur(event)),this.swapChain.addListener("focus",()=>this.onFocus()),chart.ctx.domManager.mode==="normal"&&(this.focusIndicator=new FocusIndicator(this.swapChain),this.focusIndicator.overrideFocusVisible(chart.mode==="integrated"?!1:void 0));const{seriesDragInterpreter,seriesWidget,containerWidget}=chart.ctx.widgets;seriesWidget.setTabIndex(-1),this.destroyFns.push(()=>chart.ctx.domManager.removeChild("series-area","series-area-aria-label1"),()=>chart.ctx.domManager.removeChild("series-area","series-area-aria-label2"),seriesWidget.addListener("focus",()=>this.swapChain.focus()),seriesWidget.addListener("mousemove",event=>this.onHover(event)),seriesWidget.addListener("wheel",event=>this.onWheel(event)),seriesWidget.addListener("mouseleave",event=>this.onLeave(event)),seriesWidget.addListener("keydown",event=>this.onKeyDown(event)),seriesWidget.addListener("contextmenu",(event,current)=>this.onContextMenu(event,current)),seriesDragInterpreter.addListener("drag-move",event=>this.onDragMove(event)),seriesDragInterpreter.addListener("click",event=>this.onClick(event,seriesWidget)),seriesDragInterpreter.addListener("dblclick",event=>this.onClick(event,seriesWidget)),containerWidget.addListener("contextmenu",(event,current)=>this.onContextMenu(event,current)),containerWidget.addListener("click",(event,current)=>this.onClick(event,current)),containerWidget.addListener("dblclick",(event,current)=>this.onClick(event,current)),chart.ctx.animationManager.addListener("animation-start",()=>this.clearAll()),chart.ctx.domManager.addListener("resize",()=>this.clearAll()),chart.ctx.highlightManager.addListener("highlight-change",event=>this.changeHighlightDatum(event)),chart.ctx.layoutManager.addListener("layout:complete",event=>this.layoutComplete(event)),chart.ctx.updateService.addListener("pre-scene-render",()=>this.preSceneRender()),chart.ctx.updateService.addListener("update-complete",()=>this.updateComplete()),chart.ctx.zoomManager.addListener("zoom-change",()=>this.clearAll()),chart.ctx.zoomManager.addListener("zoom-pan-start",()=>this.clearAll()))}isState(allowedStates){return this.chart.ctx.interactionManager.isState(allowedStates)}isIgnoredTouch(event){return!(event.device!=="touch"||event.type==="click"||this.chart.ctx.chartService.touch.dragAction==="hover"||this.chart.ctx.chartService.touch.dragAction==="drag"&&this.isState(9))}dataChanged(){var _a295;var _a294;(_a294=this.highlight).stashedHoverEvent??(_a294.stashedHoverEvent=this.highlight.appliedHoverEvent),this.chart.ctx.tooltipManager.removeTooltip(this.id),(_a295=this.focusIndicator)==null||_a295.clear(),this.clearHighlight()}preSceneRender(){this.highlight.stashedHoverEvent!=null&&(this.highlight.pendingHoverEvent=this.highlight.stashedHoverEvent,this.highlight.stashedHoverEvent=void 0,this.handleHoverHighlight(!0)),this.tooltip.lastHover!=null&&this.handleHoverTooltip(this.tooltip.lastHover,!0)}updateComplete(){var _a294;this.isState(34)&&((_a294=this.focusIndicator)!=null&&_a294.isFocusVisible())&&this.handleSeriesFocus(0,0,!0)}update(type,opts){this.chart.ctx.updateService.update(type,opts)}seriesChanged(series){this.focus.sortedSeries=[...series].sort((a,b)=>{let fpA=a.properties.focusPriority??1/0,fpB=b.properties.focusPriority??1/0;return fpA===fpB&&([fpA,fpB]=[a._declarationOrder,b._declarationOrder]),fpA<fpB?-1:fpA>fpB?1:0}),this.series=series}layoutComplete(event){this.seriesRect=event.series.rect,this.hoverRect=event.series.paddedRect,this.chart.ctx.widgets.seriesWidget.setBounds(event.series.paddedRect),this.chart.ctx.domManager.mode==="normal"&&this.chart.ctx.widgets.chartWidget.setBounds(event.chart)}onContextMenu(event,current){var _a294;const{sourceEvent}=event;if(sourceEvent.currentTarget!=current.getElement())return;if(sourceEvent.target==this.chart.ctx.widgets.containerWidget.getElement()){if(this.isState(36)){const{currentX:canvasX2,currentY:canvasY2}=event;this.chart.ctx.contextMenuRegistry.dispatchContext("all",{sourceEvent,canvasX:canvasX2,canvasY:canvasY2},{})}return}let pickedNode,position;if((_a294=this.focusIndicator)!=null&&_a294.isFocusVisible())pickedNode=this.chart.ctx.highlightManager.getActiveHighlight(),pickedNode&&this.seriesRect&&pickedNode.midPoint&&(position=Transformable.toCanvasPoint(pickedNode.series.contentGroup,pickedNode.midPoint.x,pickedNode.midPoint.y));else if(this.isState(36)){const pick=this.pickNodes({x:event.currentX,y:event.currentY},"context-menu");pick&&(this.chart.ctx.highlightManager.updateHighlight(this.id),pickedNode=pick.matches[0].datum)}const pickedSeries=pickedNode==null?void 0:pickedNode.series;this.clearAll();const canvasX=event.currentX+current.cssLeft(),canvasY=event.currentY+current.cssTop();this.chart.ctx.contextMenuRegistry.dispatchContext("series-area",{sourceEvent,canvasX,canvasY},{pickedSeries,pickedNode},position)}onLeave(event){if(!this.isState(41))return;const relatedTarget=event.sourceEvent.relatedTarget;(relatedTarget==null?void 0:relatedTarget.className)!=="ag-charts-text-input__textarea"&&(this.chart.ctx.tooltipManager.isEnteringInteractiveTooltip(event.sourceEvent)||(this.chart.ctx.domManager.updateCursor(this.id),this.hoverDevice!=="keyboard"&&this.clearAll()))}onWheel(_event){var _a294;this.isState(41)&&((_a294=this.focusIndicator)==null||_a294.overrideFocusVisible(!1),this.previousInputDevice="pointer")}onDragMove(event){var _a294;this.isState(41)&&((_a294=this.focusIndicator)==null||_a294.overrideFocusVisible(!1),this.onHoverLikeEvent(event))}onHover(event){this.isState(41)&&this.onHoverLikeEvent(event)}onHoverLikeEvent(event){var _a294;if(!this.isIgnoredTouch(event)&&((event.device==="touch"||excludesType(event,"drag-move"))&&(this.tooltip.lastHover=event),event.device==="touch"&&this.chart.ctx.chartService.touch.dragAction==="hover"&&event.sourceEvent.preventDefault(),this.hoverDevice="pointer",this.previousInputDevice="pointer",this.highlight.pendingHoverEvent=event,this.hoverScheduler.schedule(),this.isState(32))){const{currentX:x,currentY:y}=event,matches=(_a294=this.pickNodes({x,y},"event"))==null?void 0:_a294.matches,found=matches==null?void 0:matches[0];found!=null&&found.series.hasEventListener("seriesNodeClick")||found!=null&&found.series.hasEventListener("seriesNodeDoubleClick")||matches!=null&&matches.length>1&&this.chart.tooltip.pagination?this.chart.ctx.domManager.updateCursor(this.id,"pointer"):this.chart.ctx.domManager.updateCursor(this.id)}}onClick(event,current){var _a294;if(event.device==="touch"&&current===this.chart.ctx.widgets.seriesWidget&&this.swapChain.focus({preventScroll:!0}),!this.isState(41))return;if(current===this.chart.ctx.widgets.seriesWidget){if(!current.getElement().contains(event.sourceEvent.target))return}else if(event.sourceEvent.target!=current.getElement())return;if((_a294=this.focusIndicator)==null||_a294.overrideFocusVisible(!1),this.onHoverLikeEvent(event),!this.isState(32))return;if(current==this.chart.ctx.widgets.seriesWidget&&this.checkSeriesNodeClick(event)){this.update(4),event.sourceEvent.preventDefault();return}const newEvent={type:event.type==="click"?"click":"doubleClick",event:event.sourceEvent};this.chart.fireEvent(newEvent)}onFocus(){var _a294;this.isState(34)&&(this.hoverDevice=(_a294=this.focusIndicator)!=null&&_a294.isFocusVisible(!0)?"keyboard":"pointer",this.handleFocus(0,0))}onBlur(event){var _a294;this.isState(34)&&(this.hoverDevice="pointer",this.chart.ctx.tooltipManager.isEnteringInteractiveTooltip(event)||this.clearAll(),(_a294=this.focusIndicator)==null||_a294.overrideFocusVisible(void 0))}onKeyDown(widgetEvent){var _a294;if(!this.isState(43))return;const action=mapKeyboardEventToAction(widgetEvent.sourceEvent);switch((action==null?void 0:action.activatesFocusIndicator)===!1&&((_a294=this.focusIndicator)==null||_a294.overrideFocusVisible(this.previousInputDevice==="keyboard")),action==null?void 0:action.name){case"redo":return this.chart.ctx.chartEventManager.seriesEvent("series-redo");case"undo":return this.chart.ctx.chartEventManager.seriesEvent("series-undo");case"zoomin":return this.chart.ctx.chartEventManager.seriesKeyNavZoom(1,widgetEvent);case"zoomout":return this.chart.ctx.chartEventManager.seriesKeyNavZoom(-1,widgetEvent);case"arrowup":return this.onArrow(-1,0,widgetEvent);case"arrowdown":return this.onArrow(1,0,widgetEvent);case"arrowleft":return this.onArrow(0,-1,widgetEvent);case"arrowright":return this.onArrow(0,1,widgetEvent);case"submit":return this.onSubmit(widgetEvent)}}onArrow(seriesIndexDelta,datumIndexDelta,event){var _a294;this.isState(34)&&(this.hoverDevice="keyboard",this.previousInputDevice="keyboard",(_a294=this.focusIndicator)==null||_a294.overrideFocusVisible(!0),this.focus.seriesIndex+=seriesIndexDelta,this.focus.datumIndex+=datumIndexDelta,this.handleFocus(seriesIndexDelta,datumIndexDelta),event.sourceEvent.preventDefault(),this.chart.ctx.chartEventManager.seriesEvent("series-focus-change"))}onSubmit(event){if(!this.isState(34))return;const{series,datum}=this.focus,sourceEvent=event.sourceEvent;series!==void 0&&datum!==void 0?series.fireNodeClickEvent(sourceEvent,datum):this.chart.fireEvent({type:"click",event:sourceEvent}),sourceEvent.preventDefault()}checkSeriesNodeClick(event){var _a295,_b,_c;var _a294;const result=this.pickNodes({x:event.currentX,y:event.currentY},"event");if(result==null||result.matches.length===0)return;const paginationUpdate=this.chart.tooltip.pagination?(_a295=this.tooltipCandidates.update(result.matches,this.tooltipCandidates.current))==null?void 0:_a295.current:void 0,{series,datum}=paginationUpdate??result.matches[0],distance2=paginationUpdate==null?result.distance:0;if(event.type==="click"){const nextTooltipCandidate=series.fireNodeClickEvent(event.sourceEvent,datum)&&this.chart.tooltip.pagination?this.tooltipCandidates.next():void 0;if(nextTooltipCandidate!=null){event.sourceEvent.preventDefault();const{currentX,currentY}=event,canvasX=currentX+(((_b=this.hoverRect)==null?void 0:_b.x)??0),canvasY=currentY+(((_c=this.hoverRect)==null?void 0:_c.y)??0);(_a294=this.highlight).pendingHoverEvent??(_a294.pendingHoverEvent=this.highlight.appliedHoverEvent),this.handleHoverHighlight(!1),this.showTooltip(nextTooltipCandidate.current,canvasX,canvasY,{index:nextTooltipCandidate.index,length:nextTooltipCandidate.length})}return!0}return event.type==="dblclick"?(event.preventZoomDblClick=distance2===0,series.fireNodeDoubleClickEvent(event.sourceEvent,datum),!0):!1}handleFocus(seriesIndexDelta,datumIndexDelta){var _a294;const overlayFocus=this.chart.overlays.getFocusInfo(this.chart.ctx.localeManager);overlayFocus==null?this.handleSeriesFocus(seriesIndexDelta,datumIndexDelta):(_a294=this.focusIndicator)==null||_a294.update(overlayFocus.rect,this.seriesRect,!1)}handleSeriesFocus(otherIndexDelta,datumIndexDelta,refresh=!1){if(this.chart.chartType==="hierarchy"||this.chart.chartType==="gauge"){this.handleSoloSeriesFocus(otherIndexDelta,datumIndexDelta,refresh);return}const{focus}=this,visibleSeries=focus.sortedSeries.filter(s=>s.visible&&s.focusable);if(visibleSeries.length===0)return;const oldDatumIndex=focus.datumIndex-datumIndexDelta,oldOtherIndex=focus.seriesIndex-otherIndexDelta;focus.seriesIndex=clamp(0,focus.seriesIndex,visibleSeries.length-1),focus.series=visibleSeries[focus.seriesIndex];const datumIndex=this.focus.datumIndex,otherIndex=this.focus.seriesIndex;this.updatePickedFocus(datumIndex,datumIndexDelta,oldDatumIndex,otherIndex,otherIndexDelta,oldOtherIndex,refresh)}handleSoloSeriesFocus(otherIndexDelta,datumIndexDelta,refresh){this.focus.series=this.focus.sortedSeries[0];const datumIndex=this.focus.datumIndex,otherIndex=this.focus.seriesIndex,oldDatumIndex=this.focus.datumIndex-datumIndexDelta,oldOtherIndex=this.focus.seriesIndex-otherIndexDelta;this.updatePickedFocus(datumIndex,datumIndexDelta,oldDatumIndex,otherIndex,otherIndexDelta,oldOtherIndex,refresh)}updatePickedFocus(datumIndex,datumIndexDelta,oldDatumIndex,otherIndex,otherIndexDelta,oldOtherIndex,refresh){var _a294,_b,_c,_d;const{focus,hoverRect,seriesRect}=this;if(focus.series===void 0||hoverRect===void 0)return;const pick=(_a294=focus==null?void 0:focus.series)==null?void 0:_a294.pickFocus({datumIndex,datumIndexDelta,otherIndex,otherIndexDelta,seriesRect});if(!pick)return;const{datum}=pick;if(pick.otherIndex!==void 0&&(focus.seriesIndex=pick.otherIndex),focus.datumIndex=pick.datumIndex,focus.datum=datum,(_b=this.focusIndicator)!=null&&_b.isFocusVisible()&&this.chart.ctx.animationManager.reset(),(_c=this.focusIndicator)!=null&&_c.isFocusVisible()){const focusBBox=getPickedFocusBBox(pick),{x,y}=focusBBox.computeCenter();if(!hoverRect.containsPoint(x,y)&&this.chart.ctx.zoomManager.panToBBox(this.id,hoverRect,focusBBox))return;const{x1,x2,y1,y2}=Vec4.from(focusBBox),nw=hoverRect.containsPoint(x1,y1),ne=hoverRect.containsPoint(x2,y1),sw=hoverRect.containsPoint(x1,y2),se=hoverRect.containsPoint(x2,y2);if(!(nw||ne||sw||se)){const hoverBounds=Vec4.from(hoverRect);pick.movedBounds=focusBBox.clone(),x1<hoverBounds.x1&&x2<hoverBounds.x1?(pick.movedBounds.x=hoverBounds.x1-2,pick.movedBounds.width=4):x1>hoverBounds.x2&&x2>hoverBounds.x2&&(pick.movedBounds.x=hoverBounds.x2-2,pick.movedBounds.width=4),y1<hoverBounds.y1&&y2<hoverBounds.y1?(pick.movedBounds.y=hoverBounds.y1-2,pick.movedBounds.height=4):y1>hoverBounds.y2&&y2>hoverBounds.y2&&(pick.movedBounds.y=hoverBounds.y2-2,pick.movedBounds.height=4)}}(_d=this.focusIndicator)==null||_d.update(pick.movedBounds??pick.bounds,this.seriesRect,pick.clipFocusBox);const keyboardEvent=makeKeyboardPointerEvent(focus.series,hoverRect,pick);if(keyboardEvent!==void 0&&this.hoverDevice==="keyboard"){this.tooltip.lastHover=void 0,this.highlight.appliedHoverEvent=void 0,this.highlight.pendingHoverEvent=void 0,this.highlight.stashedHoverEvent=void 0;const tooltipContent=this.chart.getTooltipContent(focus.series,datum.datumIndex,datum),meta=TooltipManager.makeTooltipMeta(keyboardEvent,focus.series,datum,pick.movedBounds);this.chart.ctx.highlightManager.updateHighlight(this.id,datum),focus.series.tooltipEnabled??this.chart.tooltip.enabled?this.chart.ctx.tooltipManager.updateTooltip(this.id,meta,tooltipContent):this.chart.ctx.tooltipManager.removeTooltip(this.id),refresh||(datumIndexDelta===0&&otherIndexDelta===0||oldDatumIndex!==pick.datumIndex||oldOtherIndex!==(pick.otherIndex??focus.seriesIndex))&&this.swapChain.update(this.getDatumAriaText(datum,tooltipContent))}}getDatumAriaText(datum,tooltipContent){var _a294,_b;const description=tooltipContent==null?"":tooltipContentAriaLabel(tooltipContent);return this.chart.ctx.localeManager.t("ariaAnnounceHoverDatum",{datum:((_b=(_a294=datum.series).getDatumAriaText)==null?void 0:_b.call(_a294,datum,description))??description})}clearHighlight(){this.highlight.pendingHoverEvent=void 0,this.highlight.appliedHoverEvent=void 0,this.chart.ctx.highlightManager.updateHighlight(this.id)}clearTooltip(){this.chart.ctx.tooltipManager.removeTooltip(this.id),this.tooltip.lastHover=void 0}clearAll(){var _a294;this.clearHighlight(),this.clearTooltip(),(_a294=this.focusIndicator)==null||_a294.clear()}handleHoverHighlight(redisplay){var _a294,_b,_c;this.highlight.appliedHoverEvent=this.highlight.pendingHoverEvent,this.highlight.pendingHoverEvent=void 0;const event=this.highlight.appliedHoverEvent;if(!event||!this.isState(41))return;const{currentX,currentY}=event,canvasX=event.currentX+(((_a294=this.hoverRect)==null?void 0:_a294.x)??0),canvasY=event.currentY+(((_b=this.hoverRect)==null?void 0:_b.y)??0);if(redisplay?this.chart.ctx.animationManager.isActive():!((_c=this.hoverRect)!=null&&_c.containsPoint(canvasX,canvasY))){this.clearHighlight();return}const{range:range3}=this.chart.highlight,intent=range3==="tooltip"?"highlight-tooltip":"highlight",pick=this.pickNodes({x:currentX,y:currentY},intent);if(!pick||pick.matches.length===0){this.chart.ctx.highlightManager.updateHighlight(this.id);return}const{current:tooltipPick}=this.tooltipCandidates,tooltipMatch=tooltipPick==null?void 0:pick.matches.find(m=>pickedNodesEqual(m,tooltipPick)),datum=(tooltipMatch==null?void 0:tooltipMatch.datum)??pick.matches[0].datum;this.chart.ctx.highlightManager.updateHighlight(this.id,datum),this.hoverDevice="pointer"}handleHoverTooltip(event,redisplay){var _a294,_b,_c;const{current:previousHover}=this.tooltipCandidates;if(this.tooltipCandidates.reset(),!this.isState(41))return;const{currentX,currentY}=event,canvasX=currentX+(((_a294=this.hoverRect)==null?void 0:_a294.x)??0),canvasY=currentY+(((_b=this.hoverRect)==null?void 0:_b.y)??0),targetElement=event.sourceEvent.target;if(redisplay?this.chart.ctx.animationManager.isActive():!((_c=this.hoverRect)!=null&&_c.containsPoint(canvasX,canvasY))){this.hoverDevice=="pointer"&&this.clearTooltip();return}if(targetElement&&this.chart.tooltip.interactive&&this.chart.ctx.domManager.isManagedChildDOMElement(targetElement,"canvas-overlay",DEFAULT_TOOLTIP_CLASS))return;const pick=this.pickNodes({x:event.currentX,y:event.currentY},"tooltip");if(!pick||pick.matches.length===0){this.hoverDevice=="pointer"&&this.clearTooltip();return}if(this.hoverDevice="pointer",pick.distance===0){const{current,index,length:length2}=this.tooltipCandidates.update(pick.matches,this.chart.tooltip.pagination?previousHover:void 0);this.showTooltip(current,canvasX,canvasY,{index,length:length2})}else this.showTooltip(pick.matches[0],canvasX,canvasY)}showTooltip({series,datum,datumIndex},canvasX,canvasY,pagination){const content=this.chart.getTooltipContent(series,datumIndex,datum);if((series.tooltipEnabled??this.chart.tooltip.enabled)&&content!=null){const meta=TooltipManager.makeTooltipMeta({type:"pointermove",canvasX,canvasY},series,datum,void 0);this.chart.ctx.tooltipManager.updateTooltip(this.id,meta,content,pagination)}else this.chart.ctx.tooltipManager.removeTooltip(this.id)}changeHighlightDatum(event){const seriesToUpdate=new Set,{series:newSeries=void 0,datum:newDatum}=event.currentHighlight??{},{series:lastSeries=void 0,datum:lastDatum}=event.previousHighlight??{};lastSeries&&seriesToUpdate.add(lastSeries),newSeries&&seriesToUpdate.add(newSeries),lastSeries!=null&&lastSeries.properties.cursor&&lastDatum&&this.chart.ctx.domManager.updateCursor(lastSeries.id),newSeries!=null&&newSeries.properties.cursor&&(newSeries==null?void 0:newSeries.properties.cursor)!=="default"&&newDatum&&this.chart.ctx.domManager.updateCursor(newSeries.id,newSeries.properties.cursor),newSeries==null||lastSeries==null?this.update(4):this.update(4,{seriesToUpdate})}pickNodes(point,intent,exactMatchOnly){const reverseSeries=[...this.series].reverse();let result;for(const series of reverseSeries){if(!series.visible||!series.contentGroup.visible)continue;const pick=series.pickNodes(point,intent,exactMatchOnly);if(pick==null||pick.datums.length===0)continue;const{datums,distance:distance2}=pick;if(pick.datums.length!==0){if(distance2===0){(result==null?void 0:result.distance)!==0&&(result={matches:[],distance:0});for(const datum of datums){const{datumIndex}=datum;result.matches.push({series,datum,datumIndex})}}else if(result==null||result.distance>distance2){const[datum]=datums,{datumIndex}=datum;result={matches:[{series,datum,datumIndex}],distance:distance2}}}}return result}},__name(_a155,"SeriesAreaManager"),_a155);function excludesType(obj,excluded){return obj.type!==excluded}__name(excludesType,"excludesType");var SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION=30,_a156,SeriesLayerManager=(_a156=class{constructor(seriesRoot){this.seriesRoot=seriesRoot,this.groups=new Map,this.series=new Map,this.expectedSeriesCount=1,this.mode="normal"}setSeriesCount(count){this.expectedSeriesCount=count}requestGroup(seriesConfig){const{internalId,type,contentGroup:seriesContentGroup,seriesGrouping}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{},seriesInfo=this.series.get(internalId);if(seriesInfo!=null)throw new Error(`AG Charts - series already has an allocated layer: ${JSON.stringify(seriesInfo)}`);this.series.size===0&&(this.mode=this.expectedSeriesCount>=SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION?"aggressive-grouping":"normal");let group=this.groups.get(type);group==null&&(group=new Map,this.groups.set(type,group));const lookupIndex=this.lookupIdx(groupIndex);let groupInfo=group.get(lookupIndex);return groupInfo==null&&(groupInfo={type,id:lookupIndex,seriesIds:[],group:this.seriesRoot.appendChild(new Group({name:`${seriesConfig.contentGroup.name??type}-managed-layer`,zIndex:seriesConfig.contentGroup.zIndex,renderToOffscreenCanvas:!1}))},group.set(lookupIndex,groupInfo)),this.series.set(internalId,{layerState:groupInfo,seriesConfig}),groupInfo.seriesIds.push(internalId),groupInfo.group.appendChild(seriesContentGroup),groupInfo.group}changeGroup(seriesConfig){var _a294,_b;const{internalId,seriesGrouping,type,contentGroup,oldGrouping}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{};(_b=(_a294=this.groups.get(type))==null?void 0:_a294.get(groupIndex))!=null&&_b.seriesIds.includes(internalId)||(this.series.has(internalId)&&this.releaseGroup({internalId,seriesGrouping:oldGrouping,type,contentGroup}),this.requestGroup(seriesConfig))}releaseGroup(seriesConfig){var _a294,_b,_c;const{internalId,contentGroup,type}=seriesConfig;if(!this.series.has(internalId))throw new Error(`AG Charts - series doesn't have an allocated layer: ${internalId}`);const groupInfo=(_a294=this.series.get(internalId))==null?void 0:_a294.layerState;groupInfo&&(groupInfo.seriesIds=groupInfo.seriesIds.filter(v=>v!==internalId),groupInfo.group.removeChild(contentGroup)),(groupInfo==null?void 0:groupInfo.seriesIds.length)===0?(this.seriesRoot.removeChild(groupInfo.group),(_b=this.groups.get(groupInfo.type))==null||_b.delete(groupInfo.id),(_c=this.groups.get(type))==null||_c.delete(internalId)):groupInfo!=null&&groupInfo.seriesIds.length>0&&(groupInfo.group.zIndex=this.getLowestSeriesZIndex(groupInfo.seriesIds)),this.series.delete(internalId)}updateLayerCompositing(){this.groups.forEach(groups=>{groups.forEach(groupInfo=>{const{group,seriesIds}=groupInfo;let renderToOffscreenCanvas;if(seriesIds.length===0)renderToOffscreenCanvas=!1;else if(seriesIds.length>1)renderToOffscreenCanvas=!0;else{const series=this.series.get(seriesIds[0]);renderToOffscreenCanvas=(series==null?void 0:series.seriesConfig.renderToOffscreenCanvas())===!0}group.renderToOffscreenCanvas=renderToOffscreenCanvas,group.zIndex=this.getLowestSeriesZIndex(seriesIds)})})}lookupIdx(groupIndex){return this.mode==="normal"?groupIndex:typeof groupIndex=="string"&&(groupIndex=Number(groupIndex.split("-").at(-1)),!groupIndex)?0:Math.floor(clamp(0,groupIndex/this.expectedSeriesCount,1)*SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION)}destroy(){this.groups.forEach(groups=>{groups.forEach(groupInfo=>{this.seriesRoot.removeChild(groupInfo.group)})}),this.groups.clear(),this.series.clear()}getLowestSeriesZIndex(seriesIds){return seriesIds.reduce((currentLowest,seriesId)=>{const series=this.series.get(seriesId),zIndex=series==null?void 0:series.seriesConfig.contentGroup.zIndex;return currentLowest==null||zIndex==null?zIndex:compareZIndex(currentLowest,zIndex)<=0?currentLowest:zIndex},void 0)??1}},__name(_a156,"SeriesLayerManager"),_a156),_a157,Touch=(_a157=class extends BaseProperties{constructor(){super(...arguments),this.dragAction="drag"}},__name(_a157,"Touch"),_a157);__decorateClass([TempValidate(UNION(["none","drag","hover"]))],Touch.prototype,"dragAction",2);var _a158,DataWindowProcessor=(_a158=class{constructor(chart,dataService,updateService,zoomManager,animationManager){this.chart=chart,this.dataService=dataService,this.updateService=updateService,this.zoomManager=zoomManager,this.animationManager=animationManager,this.dirtyZoom=!1,this.dirtyDataSource=!1,this.lastAxisZooms=new Map,this.destroyFns=[],this.destroyFns.push(this.dataService.addListener("data-source-change",()=>this.onDataSourceChange()),this.dataService.addListener("data-load",()=>this.onDataLoad()),this.dataService.addListener("data-error",()=>this.onDataError()),this.updateService.addListener("update-complete",()=>this.onUpdateComplete()),this.zoomManager.addListener("zoom-change",()=>this.onZoomChange()))}destroy(){this.destroyFns.forEach(cb=>cb())}onDataLoad(){this.animationManager.skip(),this.updateService.update(1)}onDataError(){this.updateService.update(3)}onDataSourceChange(){this.dirtyDataSource=!0}onUpdateComplete(){!this.dirtyZoom&&!this.dirtyDataSource||this.updateWindow()}onZoomChange(){this.dirtyZoom=!0}updateWindow(){if(!this.dataService.isLazy())return;const axis=this.getValidAxis();let window2,shouldRefresh=!0;if(axis){const zoom=this.zoomManager.getAxisZoom(axis.id);window2=this.getAxisWindow(axis,zoom),shouldRefresh=this.shouldRefresh(axis,zoom)}this.dirtyZoom=!1,this.dirtyDataSource=!1,shouldRefresh&&this.dataService.load({windowStart:window2==null?void 0:window2.min,windowEnd:window2==null?void 0:window2.max})}getValidAxis(){return this.chart.axes.find(axis=>axis.type==="time")}shouldRefresh(axis,zoom){if(this.dirtyDataSource)return!0;if(!this.dirtyZoom)return!1;const lastZoom=this.lastAxisZooms.get(axis.id);return lastZoom&&zoom.min===lastZoom.min&&zoom.max===lastZoom.max?!1:(this.lastAxisZooms.set(axis.id,zoom),!0)}getAxisWindow(axis,zoom){const{domain}=axis.scale;if(!zoom||domain.length===0||isNaN(Number(domain[0])))return;const diff2=Number(domain[1])-Number(domain[0]),min=new Date(Number(domain[0])+diff2*zoom.min),max=new Date(Number(domain[0])+diff2*zoom.max);return{min,max}}},__name(_a158,"DataWindowProcessor"),_a158),isSafariRegexp=/^((?!chrome|android).)*safari/i,safariVersionRegexp=/Version\/(\d+(\.\d+)?)/,isChromeRegexp=/Chrome/,chromeVersionRegexp=/Chrome\/(\d+)/,isEdge=/Edg/,isOpera=/OPR/;function isUnsupportedBrowser(){const{userAgent}=getWindow("navigator");if(isSafariRegexp.test(userAgent)){const versionExec=safariVersionRegexp.exec(userAgent);if(versionExec==null)return!1;const version=parseFloat(versionExec[1]),supported=Math.floor(version)>16;return supported||logger_exports.warnOnce(`Unsupported Safari version: ${version}; ${userAgent}`),!supported}else if(isChromeRegexp.test(userAgent)&&!isEdge.test(userAgent)&&!isOpera.test(userAgent)){const versionExec=chromeVersionRegexp.exec(userAgent);if(versionExec==null)return!1;const version=parseInt(versionExec[1],10),supported=version>126;return supported||logger_exports.warnOnce(`Unsupported Chrome version: ${version}; ${userAgent}`),!supported}return!1}__name(isUnsupportedBrowser,"isUnsupportedBrowser");var visibleIgnoredSeries=new Set(["map-shape-background","map-line-background"]),_a159,OverlaysProcessor=(_a159=class{constructor(chartLike,overlays,dataService,layoutManager,localeManager,animationManager,domManager){this.chartLike=chartLike,this.overlays=overlays,this.dataService=dataService,this.layoutManager=layoutManager,this.localeManager=localeManager,this.animationManager=animationManager,this.domManager=domManager,this.destroyFns=[],this.overlayElem=this.domManager.addChild("canvas-overlay","overlay"),this.overlayElem.role="status",this.overlayElem.ariaAtomic="false",this.overlayElem.ariaLive="polite",this.overlayElem.classList.toggle(DEFAULT_OVERLAY_CLASS),this.destroyFns.push(this.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)))}destroy(){this.destroyFns.forEach(cb=>cb()),this.domManager.removeChild("canvas-overlay","overlay")}onLayoutComplete({series:{rect}}){const isLoading=this.dataService.isLoading(),hasData=this.chartLike.series.some(s=>s.hasData),anySeriesVisible=this.chartLike.series.some(s=>s.visible&&!visibleIgnoredSeries.has(s.type));this.overlays.darkTheme?this.overlayElem.classList.add(DEFAULT_OVERLAY_DARK_CLASS):this.overlayElem.classList.remove(DEFAULT_OVERLAY_DARK_CLASS),this.overlayElem.style.left=`${rect.x}px`,this.overlayElem.style.top=`${rect.y}px`,this.overlayElem.style.width=`${rect.width}px`,this.overlayElem.style.height=`${rect.height}px`;const loadingShown=isLoading,noDataShown=!isLoading&&!hasData,noVisibleSeriesShown=hasData&&!anySeriesVisible,unsupportedBrowser=this.overlays.unsupportedBrowser.enabled&&isUnsupportedBrowser();loadingShown?this.showOverlay(this.overlays.loading,rect):this.hideOverlay(this.overlays.loading),noDataShown?this.showOverlay(this.overlays.noData,rect):this.hideOverlay(this.overlays.noData),noVisibleSeriesShown?this.showOverlay(this.overlays.noVisibleSeries,rect):this.hideOverlay(this.overlays.noVisibleSeries),unsupportedBrowser?this.showOverlay(this.overlays.unsupportedBrowser,rect):this.hideOverlay(this.overlays.unsupportedBrowser);const shown=loadingShown||noDataShown||noVisibleSeriesShown||unsupportedBrowser;setAttribute(this.overlayElem,"aria-hidden",!shown)}showOverlay(overlay,seriesRect){if(!overlay.enabled)return;const element2=overlay.getElement(this.animationManager,this.localeManager,seriesRect);this.overlayElem.appendChild(element2)}hideOverlay(overlay){overlay.removeElement(()=>{this.overlayElem.innerText=""},this.animationManager)}},__name(_a159,"OverlaysProcessor"),_a159),debug=Debug.create(!0,"opts"),_a160,SeriesArea=(_a160=class extends BaseProperties{constructor(){super(...arguments),this.padding=new Padding(0)}},__name(_a160,"SeriesArea"),_a160);__decorateClass([TempValidate()],SeriesArea.prototype,"clip",2);__decorateClass([TempValidate()],SeriesArea.prototype,"padding",2);var _a161,_Chart=(_a161=class extends Observable{constructor(options,resources){var _a294;super(),this.id=createId(this),this.seriesRoot=new TranslatableGroup({name:`${this.id}-series-root`,zIndex:5}),this.annotationRoot=new TranslatableGroup({name:`${this.id}-annotation-root`,zIndex:9}),this.titleGroup=new Group({name:"titles",zIndex:13}),this.debug=Debug.create(),this.extraDebugStats={},this.data=[],this._firstAutoSize=!0,this._autoSizeNotify=new AsyncAwaitQueue,this.padding=new Padding(20),this.seriesArea=new SeriesArea,this.keyboard=new Keyboard,this.touch=new Touch,this.mode="standalone",this.chartCaptions=new ChartCaptions,this.suppressFieldDotNotation=!1,this.destroyed=!1,this._destroyFns=[],this.skipSync=!1,this.chartAnimationPhase="initial",this.modulesManager=new ModulesManager,this.processors=[],this.queuedUserOptions=[],this.queuedChartOptions=[],this.firstApply=!0,this._pendingFactoryUpdatesCount=0,this._performUpdateSkipAnimations=!1,this._performUpdateNotify=new AsyncAwaitQueue,this.performUpdateType=7,this.runningUpdateType=7,this.updateShortcutCount=0,this.seriesToUpdate=new Set,this.updateMutex=new Mutex,this.updateRequestors={},this.performUpdateTrigger=debouncedCallback(({count})=>{this.destroyed||this.updateMutex.acquire(async()=>{try{await this.performUpdate(count)}catch(error){logger_exports.error("update error",error)}}).catch(e=>logger_exports.errorOnce(e))}),this._performUpdateSplits={},this.axes=[],this.series=[],this._cachedData=void 0,this.onSeriesNodeClick=event=>{this.fireEvent(event)},this.onSeriesNodeDoubleClick=event=>{this.fireEvent(event)},this.onSeriesVisibilityChange=event=>{this.fireEvent(event)},this.seriesGroupingChanged=event=>{if(!(event instanceof SeriesGroupingChangedEvent))return;const{series,seriesGrouping,oldGrouping}=event;series.contentGroup.isRoot()||this.seriesLayerManager.changeGroup({internalId:series.internalId,type:series.type,contentGroup:series.contentGroup,renderToOffscreenCanvas:__name(()=>series.renderToOffscreenCanvas(),"renderToOffscreenCanvas"),seriesGrouping,oldGrouping})},this.chartOptions=options;const scene=resources==null?void 0:resources.scene,container=(resources==null?void 0:resources.container)??options.processedOptions.container??void 0,styleContainer=(resources==null?void 0:resources.styleContainer)??options.specialOverrides.styleContainer;scene&&(this._firstAutoSize=!1,this._lastAutoSize=[scene.width,scene.height,scene.pixelRatio]);const root=new Group({name:"root"});root.visible=!1,root.append(this.seriesRoot),root.append(this.annotationRoot),root.append(this.titleGroup),this.titleGroup.append(this.title.node),this.titleGroup.append(this.subtitle.node),this.titleGroup.append(this.footnote.node),this.tooltip=new Tooltip,this.seriesLayerManager=new SeriesLayerManager(this.seriesRoot),this.mode=options.userOptions.mode??this.mode;const ctx=this.ctx=new ChartContext(this,{chartType:this.getChartType(),scene,root,container,styleContainer,domMode:options.optionMetadata.domMode,syncManager:new SyncManager(this),fireEvent:__name(event=>this.fireEvent(event),"fireEvent"),updateCallback:__name((type,opts)=>this.update(type,opts),"updateCallback"),updateMutex:this.updateMutex});this._destroyFns.push(ctx.domManager.addListener("resize",()=>this.parentResize(ctx.domManager.containerSize))),this.overlays=new ChartOverlays,(_a294=this.overlays.loading).renderer??(_a294.renderer=()=>getLoadingSpinner(this.overlays.loading.getText(ctx.localeManager),ctx.animationManager.defaultDuration)),this.processors=[new DataWindowProcessor(this,ctx.dataService,ctx.updateService,ctx.zoomManager,ctx.animationManager),new OverlaysProcessor(this,this.overlays,ctx.dataService,ctx.layoutManager,ctx.localeManager,ctx.animationManager,ctx.domManager)],this.highlight=new ChartHighlight,this.container=container;const moduleContext=this.getModuleContext();ctx.domManager.setDataBoolean("animating",!1),this.seriesAreaManager=new SeriesAreaManager(this.initSeriesAreaDependencies()),this._destroyFns.push(ctx.layoutManager.registerElement(0,e=>{e.layoutBox.shrink(this.padding.toJson()),this.chartCaptions.positionCaptions(e)}),ctx.layoutManager.addListener("layout:complete",e=>this.chartCaptions.positionAbsoluteCaptions(e)),ctx.dataService.addListener("data-load",event=>{this.data=event.data}),this.title.registerInteraction(moduleContext,"beforebegin"),this.subtitle.registerInteraction(moduleContext,"beforebegin"),this.footnote.registerInteraction(moduleContext,"afterend"),Widget.addWindowEvent("page-left",()=>this.destroy()),ctx.animationManager.addListener("animation-frame",()=>{this.update(6)}),ctx.animationManager.addListener("animation-start",()=>ctx.domManager.setDataBoolean("animating",!0)),ctx.animationManager.addListener("animation-stop",()=>ctx.domManager.setDataBoolean("animating",!1)),ctx.zoomManager.addListener("zoom-change",()=>{this.series.forEach(s=>{var _a295;return(_a295=s.animationState)==null?void 0:_a295.transition("updateData")});const skipAnimations=this.chartAnimationPhase!=="initial";this.update(3,{forceNodeDataRefresh:!0,skipAnimations})})),this.parentResize(ctx.domManager.containerSize)}static getInstance(element2){return _a161.chartsInstances.get(element2)}get canvasElement(){return this.ctx.scene.canvas.element}download(fileName,fileFormat){this.ctx.scene.download(fileName,fileFormat)}getCanvasDataURL(fileFormat){return this.ctx.scene.getDataURL(fileFormat)}toSVG(){return this.ctx.scene.toSVG()}getOptions(){return this.queuedUserOptions.at(-1)??this.chartOptions.userOptions}getChartOptions(){return this.queuedChartOptions.at(-1)??this.chartOptions}overrideFocusVisible(visible){var _a294;(_a294=this.seriesAreaManager.focusIndicator)==null||_a294.overrideFocusVisible(visible)}initSeriesAreaDependencies(){const{ctx,tooltip,highlight,overlays,seriesRoot,mode}=this,chartType=this.getChartType();return{fireEvent:this.fireEvent.bind(this),getUpdateType:__name(()=>this.performUpdateType,"getUpdateType"),getTooltipContent:__name((series,datumIndex,removeThisDatum)=>this.getTooltipContent(series,datumIndex,removeThisDatum),"getTooltipContent"),chartType,ctx,tooltip,highlight,overlays,seriesRoot,mode}}getModuleContext(){return this.ctx}getTooltipContent(series,datumIndex,removeMeDatum){const baseTooltipContent=series.properties.tooltip.enabled!==!1?series.getTooltipContent(datumIndex,removeMeDatum):void 0,tooltipContent=baseTooltipContent==null?[]:[baseTooltipContent];if(this.tooltip.mode!=="shared"||this.series.length===1)return tooltipContent;const categoryValue=series.getCategoryValue(datumIndex);return categoryValue==null?tooltipContent:this.series.flatMap(s=>{if(s===series)return tooltipContent;if(!s.isEnabled()||s.properties.tooltip.enabled===!1)return[];const seriesDatumIndex=s.datumIndexForCategoryValue(categoryValue),seriesTooltipContent=seriesDatumIndex==null?void 0:s.getTooltipContent(seriesDatumIndex,void 0);return seriesTooltipContent==null?[]:[seriesTooltipContent]})}getCaptionText(){return[this.title,this.subtitle,this.footnote].filter(caption=>caption.enabled&&caption.text).map(caption=>caption.text).join(". ")}getAriaLabel(){return this.ctx.localeManager.t("ariaAnnounceChart",{seriesCount:this.series.length})}resetAnimations(){this.chartAnimationPhase="initial";for(const series of this.series)series.resetAnimation(this.chartAnimationPhase);for(const axis of this.axes)axis.resetAnimation(this.chartAnimationPhase);this.animationRect=void 0,this.ctx.animationManager.reset()}skipAnimations(){this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0}detachAndClear(){this.container=void 0,this.ctx.scene.clear()}destroy(opts){if(this.destroyed)return;const keepTransferableResources=opts==null?void 0:opts.keepTransferableResources;let result;return this.performUpdateType=7,this._destroyFns.forEach(fn=>fn()),this.processors.forEach(p=>p.destroy()),this.overlays.destroy(),this.modulesManager.destroy(),keepTransferableResources?(this.ctx.scene.strip(),result={container:this.container,scene:this.ctx.scene}):(this.ctx.scene.destroy(),this.container=void 0),this.destroySeries(this.series),this.seriesLayerManager.destroy(),this.axes.forEach(a=>a.destroy()),this.axes=[],this.animationRect=void 0,this.ctx.destroy(),this.destroyed=!0,Object.freeze(this),result}requestFactoryUpdate(cb){this.destroyed||(this._pendingFactoryUpdatesCount++,this.updateMutex.acquire(async()=>{if(!this.destroyed)try{await cb(this)}finally{this.destroyed||this._pendingFactoryUpdatesCount--}}).catch(e=>logger_exports.errorOnce(e)))}clearCallbackCache(){this.ctx.callbackCache.invalidateCache();for(const series of this.series)series.resetDatumCallbackCache()}update(type=0,opts){if(this.destroyed)return;const{forceNodeDataRefresh=!1,skipAnimations,seriesToUpdate=this.series,newAnimationBatch}=opts??{};this.ctx.widgets.seriesWidget.setDragTouchEnabled(this.touch.dragAction!=="none"),forceNodeDataRefresh&&this.series.forEach(series=>series.markNodeDataDirty());for(const series of seriesToUpdate)this.seriesToUpdate.add(series);if(skipAnimations&&(this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0),newAnimationBatch&&this.ctx.animationManager.isActive()&&(this._performUpdateSkipAnimations=!0),this.skipSync=(opts==null?void 0:opts.skipSync)??!1,this.debug.check()){let stack=new Error().stack??"<unknown>";stack=stack.replace(/\([^)]*/g,""),this.updateRequestors[stack]=type}type<this.performUpdateType&&(this.performUpdateType=type,this.ctx.domManager.setDataBoolean("updatePending",!0),this.performUpdateTrigger.schedule(opts==null?void 0:opts.backOffMs))}async performUpdate(count){const{performUpdateType,extraDebugStats,_performUpdateSplits:splits,ctx}=this,seriesToUpdate=[...this.seriesToUpdate];this.clearCallbackCache(),this.performUpdateType=7,this.seriesToUpdate.clear(),this.runningUpdateType=performUpdateType,this.updateShortcutCount===0&&performUpdateType<6&&(ctx.animationManager.startBatch(this._performUpdateSkipAnimations),ctx.animationManager.onBatchStop(()=>this.chartAnimationPhase="ready")),this.ctx.scene.updateDebugFlags(),this.debug("Chart.performUpdate() - start",ChartUpdateType[performUpdateType]);let previousSplit=performance.now();splits.start??(splits.start=previousSplit);const updateSplits=__name(splitName=>{splits[splitName]??(splits[splitName]=0),splits[splitName]+=performance.now()-previousSplit,previousSplit=performance.now()},"updateSplits");switch(performUpdateType){case 0:if(this.checkUpdateShortcut(0))break;this.ctx.updateService.dispatchPreDomUpdate(),this.updateDOM();case 1:if(this.checkUpdateShortcut(1))break;await this.updateData(),updateSplits("");case 2:if(this.checkUpdateShortcut(2))break;await this.processData(),this.seriesAreaManager.dataChanged(),updateSplits("");case 3:if(await this.checkFirstAutoSize(),this.checkUpdateShortcut(3))break;await this.processLayout(),updateSplits("");case 4:{if(this.checkUpdateShortcut(4))break;await this.updateSeries(seriesToUpdate),updateSplits(""),this.updateAriaLabels(),this.seriesLayerManager.updateLayerCompositing()}case 5:if(this.checkUpdateShortcut(5))break;ctx.updateService.dispatchPreSceneRender(),updateSplits("");case 6:if(this.checkUpdateShortcut(6))break;ctx.animationManager.endBatch(),extraDebugStats.updateShortcutCount=this.updateShortcutCount,ctx.scene.render({debugSplitTimes:splits,extraDebugStats,seriesRect:this.seriesRect}),this.extraDebugStats={};for(const key of Object.keys(splits))delete splits[key];this.ctx.domManager.incrementDataCounter("sceneRenders"),this.ctx.domManager.postRenderUpdate();case 7:this.updateShortcutCount=0,this.updateRequestors={},this._performUpdateSkipAnimations=!1,ctx.animationManager.endBatch()}this.destroyed||(ctx.updateService.dispatchUpdateComplete(),this.ctx.domManager.setDataBoolean("updatePending",!1),this.runningUpdateType=7),this._performUpdateNotify.notify();const end2=performance.now();this.debug("Chart.performUpdate() - end",{chart:this,durationMs:Math.round((end2-splits.start)*100)/100,count,performUpdateType:ChartUpdateType[performUpdateType]})}updateThemeClassName(){const themeClassNamePrefix="ag-charts-theme-",validThemeClassNames=[`${themeClassNamePrefix}default`,`${themeClassNamePrefix}default-dark`];let themeClassName=validThemeClassNames[0],isDark=!1,{theme}=this.chartOptions.processedOptions;for(;typeof theme!="string"&&theme!=null;)theme=theme.baseTheme;typeof theme=="string"&&(themeClassName=theme.replace("ag-",themeClassNamePrefix),isDark=theme.includes("-dark")),validThemeClassNames.includes(themeClassName)||(themeClassName=isDark?validThemeClassNames[1]:validThemeClassNames[0]),this.ctx.domManager.setThemeClass(themeClassName)}updateDOM(){this.updateThemeClassName();const{enabled,tabIndex}=this.keyboard;this.ctx.domManager.setTabGuardIndex(enabled?tabIndex??0:-1),this.ctx.domManager.setThemeParameters(this.chartOptions.themeParameters)}updateAriaLabels(){this.ctx.domManager.updateCanvasLabel(this.getAriaLabel())}checkUpdateShortcut(checkUpdateType){return this.destroyed?!0:this.updateShortcutCount>3?(logger_exports.warn("exceeded the maximum number of simultaneous updates (4), discarding changes and rendering",this.updateRequestors),!1):this.performUpdateType<=checkUpdateType?(this.updateShortcutCount++,!0):!1}async checkFirstAutoSize(){this.width!=null&&this.height!=null||this._lastAutoSize||await this._autoSizeNotify.await(500)||this.debug("Chart.checkFirstAutoSize() - timeout for first size update.")}onAxisChange(newValue,oldValue){oldValue==null&&newValue.length===0||this.ctx.axisManager.updateAxes(oldValue??[],newValue)}onSeriesChange(newValue,oldValue){var _a294,_b;const seriesToDestroy=(oldValue==null?void 0:oldValue.filter(series=>!newValue.includes(series)))??[];this.destroySeries(seriesToDestroy),(_a294=this.seriesLayerManager)==null||_a294.setSeriesCount(newValue.length);for(const series of newValue){if(oldValue!=null&&oldValue.includes(series))continue;const seriesContentNode=this.seriesLayerManager.requestGroup(series);series.attachSeries(seriesContentNode,this.seriesRoot,this.annotationRoot);const chart=this;series.chart={get mode(){return chart.mode},get isMiniChart(){return!1},get seriesRect(){return chart.seriesRect}},series.resetAnimation(this.chartAnimationPhase),this.addSeriesListeners(series),series.addChartEventListeners()}(_b=this.seriesAreaManager)==null||_b.seriesChanged(newValue)}destroySeries(allSeries){allSeries==null||allSeries.forEach(series=>{series.removeEventListener("seriesNodeClick",this.onSeriesNodeClick),series.removeEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),series.removeEventListener("groupingChanged",this.seriesGroupingChanged),series.destroy(),this.seriesLayerManager.releaseGroup(series),series.detachSeries(void 0,this.seriesRoot,this.annotationRoot),series.chart=void 0})}addSeriesListeners(series){this.hasEventListener("seriesNodeClick")&&series.addEventListener("seriesNodeClick",this.onSeriesNodeClick),this.hasEventListener("seriesNodeDoubleClick")&&series.addEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),this.hasEventListener("seriesVisibilityChange")&&series.addEventListener("seriesVisibilityChange",this.onSeriesVisibilityChange),series.addEventListener("groupingChanged",this.seriesGroupingChanged)}assignSeriesToAxes(){for(const axis of this.axes)axis.boundSeries=this.series.filter(s=>s.axes[axis.direction]===axis)}assignAxesToSeries(){const directionToAxesMap=groupBy(this.axes,axis=>axis.direction);for(const series of this.series)for(const direction of series.directions){const directionAxes=directionToAxesMap[direction];if(!directionAxes){logger_exports.warnOnce(`no available axis for direction [${direction}]; check series and axes configuration.`);return}const seriesKeys=series.getKeys(direction),newAxis=directionAxes.find(axis=>!axis.keys.length||seriesKeys.some(key=>axis.keys.includes(key)));if(!newAxis){logger_exports.warnOnce(`no matching axis for direction [${direction}] and keys [${seriesKeys}]; check series and axes configuration.`);return}series.axes[direction]=newAxis}}parentResize(size){if(size==null||this.width!=null&&this.height!=null)return;let{width:width2,height:height2}=size;const{pixelRatio}=size;if(width2=Math.floor(width2),height2=Math.floor(height2),width2===0&&height2===0)return;const[autoWidth=0,autoHeight=0,autoPixelRatio=1]=this._lastAutoSize??[];autoWidth===width2&&autoHeight===height2&&autoPixelRatio===pixelRatio||(this._lastAutoSize=[width2,height2,pixelRatio],this.resize("SizeMonitor",{}))}resize(source,opts){var _a294,_b,_c;const{scene,animationManager}=this.ctx,{inWidth,inHeight,inMinWidth,inMinHeight,inOverrideDevicePixelRatio}=opts;this.ctx.domManager.setSizeOptions(inMinWidth??this.minWidth,inMinHeight??this.minHeight,inWidth??this.width,inHeight??this.height);const width2=inWidth??this.width??((_a294=this._lastAutoSize)==null?void 0:_a294[0]),height2=inHeight??this.height??((_b=this._lastAutoSize)==null?void 0:_b[1]),pixelRatio=inOverrideDevicePixelRatio??this.overrideDevicePixelRatio??((_c=this._lastAutoSize)==null?void 0:_c[2]);if(this.debug(`Chart.resize() from ${source}`,{width:width2,height:height2,pixelRatio,stack:new Error().stack}),!(width2==null||height2==null||!isFiniteNumber(width2)||!isFiniteNumber(height2))&&scene.resize(width2,height2,pixelRatio)){animationManager.reset();let skipAnimations=!0;(this.width==null||this.height==null)&&this._firstAutoSize&&(skipAnimations=!1,this._firstAutoSize=!1),this.update(3,{forceNodeDataRefresh:!0,skipAnimations}),this._autoSizeNotify.notify()}}async updateData(){this.series.forEach(s=>s.setChartData(this.data));const modulePromises=this.modulesManager.mapModules(m=>{var _a294;return(_a294=m.updateData)==null?void 0:_a294.call(m,this.data)});await Promise.all(modulePromises)}async processData(){this.series.some(s=>s.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes());const dataController=new DataController(this.mode,this.suppressFieldDotNotation),seriesPromises=this.series.map(s=>s.processData(dataController)),modulePromises=this.modulesManager.mapModules(m=>{var _a294;return(_a294=m.processData)==null?void 0:_a294.call(m,dataController)});this._cachedData=dataController.execute(this._cachedData),await Promise.all([...seriesPromises,...modulePromises]);for(const axis of this.axes)axis.processData();this.updateLegends()}updateLegends(initialStateLegend){for(const{legend,legendType}of this.modulesManager.legends())legendType==="category"?this.setCategoryLegendData(initialStateLegend):this.setLegendData(legendType,legend)}setCategoryLegendData(initialState){var _a294;const{ctx:{legendManager,stateManager}}=this;initialState&&this.series.forEach(s=>{const seriesState=initialState.find(init=>init.seriesId===s.id);s.onLegendInitialState("category",seriesState)});const legendData=this.series.flatMap(s=>{const seriesLegendData=s.getLegendData("category");return legendManager.updateData(s.id,seriesLegendData),seriesLegendData});if(initialState){stateManager.setStateAndRestore(legendManager,initialState);return}if(this.mode!=="integrated"){const seriesMarkerFills={},seriesTypeMap=new Map(this.series.map(s=>[s.id,s.type]));for(const{seriesId,symbol:{marker},label}of legendData.filter(d=>!d.hideInLegend)){if(marker.fill==null)continue;const seriesType=seriesTypeMap.get(seriesId),markerFill=seriesMarkerFills[seriesType]??(seriesMarkerFills[seriesType]={});markerFill[_a294=label.text]??(markerFill[_a294]=marker.fill),markerFill[label.text]!==marker.fill&&logger_exports.warnOnce(`legend item '${label.text}' has multiple fill colors, this may cause unexpected behaviour.`)}}legendManager.update()}setLegendData(legendType,legend){legend.data=this.series.filter(s=>s.properties.showInLegend).flatMap(s=>s.getLegendData(legendType))}async processLayout(){var _a294;const oldRect=this.animationRect,{width:width2,height:height2}=this.ctx.scene,ctx=this.ctx.layoutManager.createContext(width2,height2);await this.performLayout(ctx),oldRect&&!((_a294=this.animationRect)!=null&&_a294.equals(oldRect))&&this.ctx.animationManager.skipCurrentBatch(),this.debug("Chart.performUpdate() - seriesRect",this.seriesRect)}async updateSeries(seriesToUpdate){const{seriesRect}=this;await Promise.all(seriesToUpdate.map(series=>series.update({seriesRect}))),this.ctx.seriesLabelLayoutManager.updateLabels(this.series.filter(s=>s.visible&&s.usesPlacedLabels),this.padding,this.seriesRect)}async waitForUpdate(timeoutMs=1e4,failOnTimeout=!1){const start2=performance.now();for(;(this._pendingFactoryUpdatesCount>0||this.performUpdateType!==7||this.runningUpdateType!==7)&&!this.destroyed;){if(this._pendingFactoryUpdatesCount>0&&await this.updateMutex.waitForClearAcquireQueue(),(this.performUpdateType!==7||this.runningUpdateType!==7)&&await this._performUpdateNotify.await(),performance.now()-start2>timeoutMs){const message=`Chart.waitForUpdate() timeout of ${timeoutMs} reached - first chart update taking too long.`;if(failOnTimeout)throw new Error(message);logger_exports.warnOnce(message)}isInputPending()&&await pause()}}filterMiniChartSeries(series){return series==null?void 0:series.filter(s=>s.showInMiniChart!==!1)}applyOptions(newChartOptions){var _a294,_b,_c,_d,_e;const deltaOptions=this.firstApply?newChartOptions.processedOptions:newChartOptions.diffOptions(this.chartOptions);if(deltaOptions==null||Object.keys(deltaOptions).length===0)return;const oldOpts=this.firstApply?{}:this.chartOptions.processedOptions,newOpts=newChartOptions.processedOptions;debug("Chart.applyOptions() - applying delta",deltaOptions);const modulesChanged=this.applyModules(newOpts),skip=["type","data","series","listeners","preset","theme","legend.listeners","navigator.miniChart.series","navigator.miniChart.label","locale.localeText","axes","topology","nodes","initialState","styleContainer"];deltaOptions.listeners&&this.registerListeners(this,deltaOptions.listeners),jsonApply(this,deltaOptions,{skip});let forceNodeDataRefresh=!1,seriesStatus="no-op";deltaOptions.series!=null&&(seriesStatus=this.applySeries(this,deltaOptions.series,oldOpts==null?void 0:oldOpts.series),forceNodeDataRefresh=!0),seriesStatus==="replaced"&&this.resetAnimations(),this.applyAxes(this,newOpts,oldOpts,seriesStatus,[])&&(forceNodeDataRefresh=!0),deltaOptions.data&&(this.data=deltaOptions.data),(_a294=deltaOptions.legend)!=null&&_a294.listeners&&this.modulesManager.isEnabled("legend")&&Object.assign(this.legend.listeners,deltaOptions.legend.listeners),(_b=deltaOptions.locale)!=null&&_b.localeText&&(this.modulesManager.getModule("locale").localeText=(_c=deltaOptions.locale)==null?void 0:_c.localeText),this.chartOptions=newChartOptions;const navigatorModule=this.modulesManager.getModule("navigator"),zoomModule=this.modulesManager.getModule("zoom");!(navigatorModule!=null&&navigatorModule.enabled)&&!(zoomModule!=null&&zoomModule.enabled)&&this.ctx.zoomManager.updateZoom("chart");const miniChart=navigatorModule==null?void 0:navigatorModule.miniChart,miniChartSeries=((_e=(_d=newOpts.navigator)==null?void 0:_d.miniChart)==null?void 0:_e.series)??newOpts.series;(miniChart==null?void 0:miniChart.enabled)===!0&&miniChartSeries!=null?this.applyMiniChartOptions(miniChart,miniChartSeries,newOpts,oldOpts):(miniChart==null?void 0:miniChart.enabled)===!1&&(miniChart.series=[],miniChart.axes=[]),this.ctx.annotationManager.setAnnotationStyles(newChartOptions.annotationThemes),forceNodeDataRefresh||(forceNodeDataRefresh=this.shouldForceNodeDataRefresh(deltaOptions,seriesStatus));const updateType=forceNodeDataRefresh||modulesChanged?0:3;this.maybeResetAnimations(seriesStatus),this.shouldClearLegendData(newOpts,oldOpts,seriesStatus)&&this.ctx.legendManager.clearData(),this.applyInitialState(newOpts),debug("Chart.applyOptions() - update type",ChartUpdateType[updateType],{seriesStatus,forceNodeDataRefresh}),this.update(updateType,{forceNodeDataRefresh,newAnimationBatch:!0}),this.firstApply=!1}applyInitialState(options){var _a294,_b,_c;const{annotationManager,chartTypeOriginator,historyManager,stateManager,zoomManager}=this.ctx,{initialState}=options;if("annotations"in options&&((_a294=options.annotations)!=null&&_a294.enabled)&&(initialState==null?void 0:initialState.annotations)!=null){const annotations=initialState.annotations.map(annotation=>{const annotationTheme=annotationManager.getAnnotationTypeStyles(annotation.type);return mergeDefaults(annotation,annotationTheme)});stateManager.setState(annotationManager,annotations)}(initialState==null?void 0:initialState.chartType)!=null&&stateManager.setState(chartTypeOriginator,initialState.chartType),((_b=options.navigator)!=null&&_b.enabled||(_c=options.zoom)!=null&&_c.enabled)&&(initialState==null?void 0:initialState.zoom)!=null&&stateManager.setState(zoomManager,initialState.zoom),(initialState==null?void 0:initialState.legend)!=null&&this.updateLegends(initialState.legend),initialState!=null&&historyManager.clear()}maybeResetAnimations(seriesStatus){if(this.mode==="standalone")switch(seriesStatus){case"series-grouping-change":case"replaced":this.resetAnimations();break}}shouldForceNodeDataRefresh(deltaOptions,seriesStatus){const seriesDataUpdate=!!deltaOptions.data||seriesStatus==="data-change"||seriesStatus==="replaced",legendKeys=legendRegistry.getKeys(),optionsHaveLegend=Object.values(legendKeys).some(legendKey=>deltaOptions[legendKey]!=null),otherRefreshUpdate=deltaOptions.title!=null&&deltaOptions.subtitle!=null;return seriesDataUpdate||optionsHaveLegend||otherRefreshUpdate}shouldClearLegendData(options,oldOpts,seriesStatus){const seriesChanged=seriesStatus==="replaced"||seriesStatus==="series-grouping-change"||seriesStatus==="updated",legendRemoved=oldOpts.legend!=null&&options.legend==null;return seriesChanged||legendRemoved}applyMiniChartOptions(miniChart,miniChartSeries,completeOptions,oldOpts){var _a294,_b,_c,_d;const oldSeries=((_b=(_a294=oldOpts==null?void 0:oldOpts.navigator)==null?void 0:_a294.miniChart)==null?void 0:_b.series)??(oldOpts==null?void 0:oldOpts.series),miniChartSeriesStatus=this.applySeries(miniChart,this.filterMiniChartSeries(miniChartSeries),this.filterMiniChartSeries(oldSeries));this.applyAxes(miniChart,completeOptions,oldOpts,miniChartSeriesStatus,["axes[].tick","axes[].thickness","axes[].title","axes[].crosshair","axes[].gridLine","axes[].label"]);const series=miniChart.series;for(const s of series)s.properties.id=void 0;const axes=miniChart.axes,horizontalAxis=axes.find(axis=>axis.direction==="x");for(const axis of axes)axis.nice=!1,axis.gridLine.enabled=!1,axis.label.enabled=axis===horizontalAxis,axis.tick.enabled=!1,axis.interactionEnabled=!1;if(horizontalAxis!=null){const miniChartOpts=(_c=completeOptions.navigator)==null?void 0:_c.miniChart,labelOptions=miniChartOpts==null?void 0:miniChartOpts.label,intervalOptions=(_d=miniChartOpts==null?void 0:miniChartOpts.label)==null?void 0:_d.interval;if(horizontalAxis.line.enabled=!1,horizontalAxis.label.set(without(labelOptions,["interval","rotation","minSpacing","autoRotate","autoRotateAngle"])),horizontalAxis.tick.set(without(intervalOptions,["enabled","width","size","color","interval","step"])),horizontalAxis.type==="grouped-category"){horizontalAxis.label.enabled=!1,horizontalAxis.label.rotation=0;const{depthOptions}=horizontalAxis;if(depthOptions.length===0)depthOptions.set([{label:{enabled:!0}}]);else for(let i=1;i<depthOptions.length;i++)depthOptions[i].label.enabled=!1}const step=intervalOptions==null?void 0:intervalOptions.step;step!=null&&(horizontalAxis.interval.step=step)}}applyModules(options){var _a294;const{type:chartType}=this.constructor;let modulesChanged=!1;for(const module of moduleRegistry.byType("root","legend")){const shouldBeEnabled=options[module.optionsKey]!=null&&module.chartTypes.includes(chartType);shouldBeEnabled!==this.modulesManager.isEnabled(module)&&(shouldBeEnabled?(this.modulesManager.addModule(module,m=>m.moduleFactory(this.getModuleContext())),module.type==="legend"&&((_a294=this.modulesManager.getModule(module))==null||_a294.attachLegend(this.ctx.scene)),this[module.optionsKey]=this.modulesManager.getModule(module)):(this.modulesManager.removeModule(module),delete this[module.optionsKey]),modulesChanged=!0)}return modulesChanged}initSeriesDeclarationOrder(series){for(let idx=0;idx<series.length;idx++)series[idx].setSeriesIndex(idx)}applySeries(chart,optSeries,oldOptSeries){var _a294;if(!optSeries)return"no-change";const matchResult=matchSeriesOptions(chart.series,optSeries,oldOptSeries);if(matchResult.status==="no-overlap"){debug(`Chart.applySeries() - creating new series instances, status: ${matchResult.status}`,matchResult);const chartSeries=optSeries.map(opts=>this.createSeries(opts));return this.initSeriesDeclarationOrder(chartSeries),chart.series=chartSeries,"replaced"}debug("Chart.applySeries() - matchResult",matchResult);const seriesInstances=[];let dataChanged=!1,groupingChanged=!1,isUpdated=!1;const changes=matchResult.changes.toSorted((a,b)=>a.targetIdx-b.targetIdx);for(const change of changes)switch(groupingChanged||(groupingChanged=change.status==="series-grouping"),dataChanged||(dataChanged=((_a294=change.diff)==null?void 0:_a294.data)!=null),isUpdated||(isUpdated=change.status!=="no-op"),change.status){case"add":{const newSeries=this.createSeries(change.opts);seriesInstances.push(newSeries),debug("Chart.applySeries() - created new series",newSeries);break}case"remove":debug(`Chart.applySeries() - removing series at previous idx ${change.idx}`,change.series);break;case"no-op":seriesInstances.push(change.series),debug(`Chart.applySeries() - no change to series at previous idx ${change.idx}`,change.series);break;case"series-grouping":case"update":default:{const{series,diff:diff2,idx}=change;debug(`Chart.applySeries() - applying series diff previous idx ${idx}`,diff2,series),this.applySeriesValues(series,diff2),series.markNodeDataDirty(),seriesInstances.push(series)}}return this.initSeriesDeclarationOrder(seriesInstances),debug("Chart.applySeries() - final series instances",seriesInstances),chart.series=seriesInstances,groupingChanged?"series-grouping-change":dataChanged?"data-change":isUpdated?"updated":"no-op"}applyAxes(chart,options,oldOpts,seriesStatus,skip=[]){if(!("axes"in options)||!options.axes)return!1;skip=["axes[].type",...skip];const{axes}=options;return!(seriesStatus==="replaced")&&chart.axes.length===axes.length&&chart.axes.every((a,i)=>a.type===axes[i].type)&&isAgCartesianChartOptions(oldOpts)?(chart.axes.forEach((axis,index)=>{var _a294;const previousOpts=((_a294=oldOpts.axes)==null?void 0:_a294[index])??{},axisDiff=jsonDiff(previousOpts,axes[index]);debug(`Chart.applyAxes() - applying axis diff idx ${index}`,axisDiff);const path=`axes[${index}]`;jsonApply(axis,axisDiff,{path,skip})}),!0):(debug(`Chart.applyAxes() - creating new axes instances; seriesStatus: ${seriesStatus}`),chart.axes=this.createAxis(axes,skip),!0)}createSeries(seriesOptions){const seriesInstance=seriesRegistry.create(seriesOptions.type,this.getModuleContext());return this.applySeriesOptionModules(seriesInstance,seriesOptions),this.applySeriesValues(seriesInstance,seriesOptions),seriesInstance}applySeriesOptionModules(series,options){const moduleContext=series.createModuleContext(),moduleMap=series.getModuleMap();for(const module of moduleRegistry.byType("series-option"))module.optionsKey in options&&module.seriesTypes.includes(series.type)&&moduleMap.addModule(module,m=>m.moduleFactory(moduleContext))}applySeriesValues(target,options){const moduleMap=target.getModuleMap(),{type:_,data,listeners,seriesGrouping,showInMiniChart:__,...seriesOptions}=options;for(const moduleDef of EXPECTED_ENTERPRISE_MODULES)if(moduleDef.type==="series-option"&&moduleDef.optionsKey in seriesOptions){const module=moduleMap.getModule(moduleDef.optionsKey);if(module){const moduleOptions=seriesOptions[moduleDef.optionsKey];delete seriesOptions[moduleDef.optionsKey],module.properties.set(moduleOptions)}}target.properties.set(seriesOptions),"data"in options&&target.setOptionsData(data),listeners&&this.registerListeners(target,listeners,{nodeClick:"seriesNodeClick",nodeDoubleClick:"seriesNodeDoubleClick"}),"seriesGrouping"in options&&(seriesGrouping==null?target.seriesGrouping=void 0:target.seriesGrouping={...target.seriesGrouping,...seriesGrouping})}createAxis(options,skip){const newAxes=[],moduleContext=this.getModuleContext();for(let index=0;index<options.length;index++){const axisOptions=options[index],axis=axisRegistry.create(axisOptions.type,moduleContext);this.applyAxisModules(axis,axisOptions),jsonApply(axis,axisOptions,{path:`axes[${index}]`,skip}),newAxes.push(axis)}return guessInvalidPositions(newAxes),newAxes}applyAxisModules(axis,options){const moduleContext=axis.createModuleContext(),moduleMap=axis.getModuleMap();for(const module of moduleRegistry.byType("axis-option")){const shouldBeEnabled=options[module.optionsKey]!=null;shouldBeEnabled!==moduleMap.isEnabled(module)&&(shouldBeEnabled?(moduleMap.addModule(module,m=>m.moduleFactory(moduleContext)),axis[module.optionsKey]=moduleMap.getModule(module)):(moduleMap.removeModule(module),delete axis[module.optionsKey]))}}registerListeners(source,listeners,mapping){source.clearEventListeners();for(const[property,listener]of entries(listeners))if(isFunction(listener)){const mappedEventName=mapping==null?void 0:mapping[property];mappedEventName==null?source.addEventListener(property,listener):source.addEventListener(mappedEventName,e=>{if((e==null?void 0:e.type)===mappedEventName){const clone2=new Proxy(e,{get(target,p,receiver){return p==="type"?property:Reflect.get(target,p,receiver)}});listener(clone2)}else listener(e)})}}},__name(_a161,"_Chart"),_a161);_Chart.chartsInstances=new WeakMap;__decorateClass([ActionOnSet({newValue(value){this.destroyed||(this.ctx.domManager.setContainer(value),_Chart.chartsInstances.set(value,this))},oldValue(value){_Chart.chartsInstances.delete(value)}})],_Chart.prototype,"container",2);__decorateClass([ActionOnSet({newValue(value){this.resize("width option",{inWidth:value})}})],_Chart.prototype,"width",2);__decorateClass([ActionOnSet({newValue(value){this.resize("height option",{inHeight:value})}})],_Chart.prototype,"height",2);__decorateClass([ActionOnSet({newValue(value){this.resize("minWidth option",{inMinWidth:value})}})],_Chart.prototype,"minWidth",2);__decorateClass([ActionOnSet({newValue(value){this.resize("minHeight option",{inMinHeight:value})}})],_Chart.prototype,"minHeight",2);__decorateClass([ActionOnSet({newValue(value){this.resize("overrideDevicePixelRatio option",{inOverrideDevicePixelRatio:value})}})],_Chart.prototype,"overrideDevicePixelRatio",2);__decorateClass([TempValidate()],_Chart.prototype,"padding",2);__decorateClass([TempValidate()],_Chart.prototype,"seriesArea",2);__decorateClass([TempValidate()],_Chart.prototype,"keyboard",2);__decorateClass([TempValidate()],_Chart.prototype,"touch",2);__decorateClass([TempValidate(UNION(["standalone","integrated"],"a chart mode"))],_Chart.prototype,"mode",2);__decorateClass([ProxyProperty("chartCaptions.title")],_Chart.prototype,"title",2);__decorateClass([ProxyProperty("chartCaptions.subtitle")],_Chart.prototype,"subtitle",2);__decorateClass([ProxyProperty("chartCaptions.footnote")],_Chart.prototype,"footnote",2);__decorateClass([TempValidate()],_Chart.prototype,"suppressFieldDotNotation",2);__decorateClass([ActionOnSet({changeValue(newValue,oldValue){this.onAxisChange(newValue,oldValue)}})],_Chart.prototype,"axes",2);__decorateClass([ActionOnSet({changeValue(newValue,oldValue){this.onSeriesChange(newValue,oldValue)}})],_Chart.prototype,"series",2);var Chart=_Chart,debug2=Debug.create(!0,"opts"),DESTROYED_ERROR="AG Charts - Chart was destroyed, cannot perform request.",_a162,_AgChartInstanceProxy=(_a162=class{constructor(chart,factoryApi,licenseManager){this.factoryApi=factoryApi,this.licenseManager=licenseManager,this.chart=chart}async update(options){if(!this.chart)throw new Error(DESTROYED_ERROR);return debug2.group("AgChartInstance.update()",async()=>{var _a294;this.factoryApi.update(options,this),await((_a294=this.chart)==null?void 0:_a294.waitForUpdate())})}async updateDelta(deltaOptions){if(!this.chart)throw new Error(DESTROYED_ERROR);return debug2.group("AgChartInstance.updateDelta()",async()=>{var _a294;this.factoryApi.updateUserDelta(this,deltaOptions),await((_a294=this.chart)==null?void 0:_a294.waitForUpdate())})}getOptions(){if(!this.chart)throw new Error(DESTROYED_ERROR);const options=deepClone(this.chart.getOptions());for(const key of Object.keys(options))key.startsWith("_")&&delete options[key];return options}waitForUpdate(){if(!this.chart)throw new Error(DESTROYED_ERROR);return this.chart.waitForUpdate()}async download(opts){var _a294;if(!this.chart)throw new Error(DESTROYED_ERROR);const clone2=await this.prepareResizedChart(this,this.chart,opts);try{(_a294=clone2.chart)==null||_a294.download(opts==null?void 0:opts.fileName,opts==null?void 0:opts.fileFormat)}finally{clone2.destroy()}}async __toSVG(opts){var _a294;if(!this.chart)throw new Error(DESTROYED_ERROR);const clone2=await this.prepareResizedChart(this,this.chart,{width:600,height:300,...opts});try{return(_a294=clone2==null?void 0:clone2.chart)==null?void 0:_a294.toSVG()}finally{clone2==null||clone2.destroy()}}async getImageDataURL(opts){if(!this.chart)throw new Error(DESTROYED_ERROR);const clone2=await this.prepareResizedChart(this,this.chart,opts);try{return clone2.chart.getCanvasDataURL(opts==null?void 0:opts.fileFormat)}finally{clone2.destroy()}}getState(){return this.factoryApi.caretaker.save(...this.getEnabledOriginators())}async setState(state){const{chart}=this;if(!chart)return;const originators=this.getEnabledOriginators();if(!originators.includes(chart.ctx.legendManager)){await this.setStateOriginators(state,originators);return}await this.setStateOriginators(state,originators.filter(originator=>originator!==chart.ctx.zoomManager)),await this.setStateOriginators(state,[chart.ctx.zoomManager])}resetAnimations(){var _a294;(_a294=this.chart)==null||_a294.resetAnimations()}skipAnimations(){var _a294;(_a294=this.chart)==null||_a294.skipAnimations()}destroy(){this.releaseChart?(this.releaseChart(),this.releaseChart=void 0):this.chart&&(this.chart.publicApi=void 0,this.chart.destroy()),this.chart=void 0}async prepareResizedChart(proxy,chart,opts={}){var _a294,_b,_c,_d,_e,_f;const width2=opts.width??chart.width??chart.ctx.scene.canvas.width,height2=opts.height??chart.height??chart.ctx.scene.canvas.height,state=proxy.getState(),isEnterprise=moduleRegistry.hasEnterpriseModules(),processedOverrides={...chart.chartOptions.processedOverrides,container:document.createElement("div"),width:width2,height:height2};opts.width!=null&&opts.height!=null&&(processedOverrides.overrideDevicePixelRatio=1);const userOptions=chart.getOptions();isEnterprise&&(processedOverrides.animation={enabled:!1},(_a294=this.licenseManager)!=null&&_a294.isDisplayWatermark()&&(processedOverrides.foreground={text:this.licenseManager.getWatermarkMessage(),image:{url:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=",width:170,height:25,right:25,bottom:50,opacity:.7}}));const specialOverrides={...chart.chartOptions.specialOverrides},optionsMetadata={...chart.chartOptions.optionMetadata},cloneProxy=this.factoryApi.create(userOptions,processedOverrides,specialOverrides,optionsMetadata);await cloneProxy.setState(state),(_b=cloneProxy.chart)==null||_b.ctx.zoomManager.updateZoom("chartProxy",chart.ctx.zoomManager.getZoom()),(_c=cloneProxy.chart)==null||_c.ctx.legendManager.clearData(),(_d=cloneProxy.chart)==null||_d.ctx.legendManager.update(chart.ctx.legendManager.getData()),chart.series.forEach((series,index)=>{series.visible||(cloneProxy.chart.series[index].visible=!1)});const legendPages=[];for(const legend of chart.modulesManager.legends())legendPages.push(((_e=legend.legend.pagination)==null?void 0:_e.currentPage)??0);for(const legend of cloneProxy.chart.modulesManager.legends()){const page=legendPages.shift()??0;legend.legend.pagination&&legend.legend.pagination.setPage(page)}return(_f=cloneProxy.chart)==null||_f.update(0,{forceNodeDataRefresh:!0}),await cloneProxy.waitForUpdate(),cloneProxy}getEnabledOriginators(){var _a294,_b,_c;if(!this.chart)return[];const{chartOptions:{processedOptions,optionMetadata},ctx:{annotationManager,chartTypeOriginator,zoomManager,legendManager}}=this.chart,originators=[];return"annotations"in processedOptions&&((_a294=processedOptions.annotations)!=null&&_a294.enabled)&&originators.push(annotationManager),optionMetadata.presetType==="price-volume"&&originators.push(chartTypeOriginator),((_b=processedOptions.navigator)!=null&&_b.enabled||(_c=processedOptions.zoom)!=null&&_c.enabled)&&originators.push(zoomManager),"legend"in this.chart&&originators.push(legendManager),originators}async setStateOriginators(state,originators){var _a294,_b;this.factoryApi.caretaker.restore(state,...originators),(_a294=this.chart)==null||_a294.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),await((_b=this.chart)==null?void 0:_b.waitForUpdate())}},__name(_a162,"_AgChartInstanceProxy"),_a162);_AgChartInstanceProxy.chartInstances=new WeakMap;__decorateClass([ActionOnSet({oldValue(chart){chart.destroyed||(chart.publicApi=void 0),_AgChartInstanceProxy.chartInstances.delete(chart)},newValue(chart){chart&&(chart.publicApi=this,_AgChartInstanceProxy.chartInstances.set(chart,this))}})],_AgChartInstanceProxy.prototype,"chart",2);var AgChartInstanceProxy=_AgChartInstanceProxy,_a163,Locale=(_a163=class extends BaseModuleInstance{constructor(ctx){super(),this.ctx=ctx,this.localeText=void 0}},__name(_a163,"Locale"),_a163);__decorateClass([ObserveChanges(target=>{target.ctx.localeManager.setLocaleText(target.localeText)}),TempValidate()],Locale.prototype,"localeText",2);__decorateClass([ObserveChanges(target=>{target.ctx.localeManager.setLocaleTextFormatter(target.getLocaleText)}),TempValidate()],Locale.prototype,"getLocaleText",2);var LocaleModule={type:"root",optionsKey:"locale",packageType:"community",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:__name(ctx=>new Locale(ctx),"moduleFactory")},_a164,CategoryScale=(_a164=class extends BandScale{constructor(){super(...arguments),this.type="band",this.index=void 0,this._domain=[]}set domain(values){this._domain!==values&&(this.invalid=!0,this._domain=values,this.index=void 0)}get domain(){return this._domain}normalizeDomains(...domains){let normalizedDomain;const seenDomains=new Set;let animatable=!0;for(const domain of domains)seenDomains.has(domain)||(seenDomains.add(domain),normalizedDomain==null?normalizedDomain=deduplicateCategories(domain):(animatable&&(animatable=domainOrderedToNormalizedDomain(domain,normalizedDomain)),normalizedDomain=deduplicateCategories([...normalizedDomain,...domain])));return normalizedDomain??(normalizedDomain=[]),{domain:normalizedDomain,animatable}}toDomain(_value){}invert(position,nearest=!1){this.refresh();const offset4=nearest?this.bandwidth/2:0,index=this.invertNearestIndex(Math.max(0,position-offset4));return nearest||position===this.ordinalRange(index)?this.domain[index]:void 0}getIndex(value){let{index}=this;if(index==null){const{domain}=this;index=new Map;for(let i=0;i<domain.length;i++)index.set(dateToNumber(domain[i]),i);this.index=index}return index.get(dateToNumber(value))}},__name(_a164,"CategoryScale"),_a164);function deduplicateCategories(d){let domain;const uniqueValues=new Set;for(const value of d){const key=dateToNumber(value),lastSize=uniqueValues.size;uniqueValues.add(key),uniqueValues.size!==lastSize?domain==null||domain.push(value):domain??(domain=d.slice(0,uniqueValues.size))}return domain??d}__name(deduplicateCategories,"deduplicateCategories");function domainOrderedToNormalizedDomain(domain,normalizedDomain){let normalizedIndex=-1;for(const value of domain){const normalizedNextIndex=normalizedDomain.indexOf(value);if(normalizedNextIndex===-1)normalizedIndex=1/0;else{if(normalizedNextIndex<=normalizedIndex)return!1;normalizedIndex=normalizedNextIndex}}return!0}__name(domainOrderedToNormalizedDomain,"domainOrderedToNormalizedDomain");var _a165,_CategoryAxis=(_a165=class extends CartesianAxis{constructor(moduleCtx,scale2=new CategoryScale){super(moduleCtx,scale2),this.groupPaddingInner=.1,this.includeInvisibleDomains=!0,this.nice=!1}static is(value){return value instanceof _a165}normaliseDataDomain(domain){return{domain,clipped:!1}}updateScale(){super.updateScale();let{paddingInner,paddingOuter}=this;if(!isFiniteNumber(paddingInner)||!isFiniteNumber(paddingOuter)){const padding=this.reduceBandScalePadding();paddingInner??(paddingInner=padding.inner),paddingOuter??(paddingOuter=padding.outer)}this.scale.paddingInner=paddingInner??0,this.scale.paddingOuter=paddingOuter??0}reduceBandScalePadding(){return this.boundSeries.reduce((result,series)=>{var _a294;const padding=(_a294=series.getBandScalePadding)==null?void 0:_a294.call(series);return padding&&(result.inner>padding.inner&&(result.inner=padding.inner),result.outer<padding.outer&&(result.outer=padding.outer)),result},{inner:1/0,outer:-1/0})}},__name(_a165,"_CategoryAxis"),_a165);_CategoryAxis.className="CategoryAxis";_CategoryAxis.type="category";__decorateClass([TempValidate()],_CategoryAxis.prototype,"groupPaddingInner",2);__decorateClass([TempValidate()],_CategoryAxis.prototype,"paddingInner",2);__decorateClass([TempValidate()],_CategoryAxis.prototype,"paddingOuter",2);var CategoryAxis=_CategoryAxis,_a166,GroupedCategoryScale=(_a166=class extends CategoryScale{normalizeDomains(...domains){const{domain}=super.normalizeDomains(...domains);return{domain,animatable:!1}}getIndex(value){return super.getIndex(value)??this.getMatchIndex(value)}getMatchIndex(value){const key=JSON.stringify(value),match=this._domain.find(d=>JSON.stringify(d)===key);if(match!=null)return super.getIndex(match)}},__name(_a166,"GroupedCategoryScale"),_a166);function extent(values){if(values.length===0)return null;let min=1/0,max=-1/0;for(const n of values){const v=n instanceof Date?n.getTime():n;typeof v=="number"&&(v<min&&(min=v),v>max&&(max=v))}const result=[min,max];return result.every(isFinite)?result:null}__name(extent,"extent");function normalisedExtentWithMetadata(d,min,max){let clipped=!1;return d.length>2&&(d=extent(d)??[NaN,NaN]),min!=null&&(clipped||(clipped=min>d[0]),d=[min,d[1]]),max!=null&&(clipped||(clipped=max<d[1]),d=[d[0],max]),d[0]>d[1]&&(d=[]),{extent:d,clipped}}__name(normalisedExtentWithMetadata,"normalisedExtentWithMetadata");var memorizedFns=new WeakMap;function memo(params,fnGenerator){var _a294,_b,_c;const serialisedParams=JSON.stringify(params,null,0);return memorizedFns.has(fnGenerator)||memorizedFns.set(fnGenerator,new Map),(_a294=memorizedFns.get(fnGenerator))!=null&&_a294.has(serialisedParams)||(_b=memorizedFns.get(fnGenerator))==null||_b.set(serialisedParams,fnGenerator(params)),(_c=memorizedFns.get(fnGenerator))==null?void 0:_c.get(serialisedParams)}__name(memo,"memo");function simpleMemorize(fn,cacheCallback2){const primitiveCache=new Map,paramsToKeys=__name((...params)=>params.map(v=>typeof v=="object"||typeof v=="symbol"?v:(primitiveCache.has(v)||primitiveCache.set(v,{v}),primitiveCache.get(v))),"paramsToKeys"),empty={},cache=new WeakMap;return(...p)=>{const keys=p.length===0?[empty]:paramsToKeys(...p);let currentCache=cache;for(const key of keys.slice(0,-1))currentCache.has(key)||currentCache.set(key,new WeakMap),currentCache=currentCache.get(key);const finalKey=keys.at(-1);let cachedValue=currentCache.get(finalKey);return cachedValue?cacheCallback2==null||cacheCallback2("hit",fn,p):(cachedValue=fn(...p),currentCache.set(finalKey,cachedValue),cacheCallback2==null||cacheCallback2("miss",fn,p)),cachedValue}}__name(simpleMemorize,"simpleMemorize");function sumValues(values,accumulator=[0,0]){for(const value of values)typeof value=="number"&&(value<0&&(accumulator[0]+=value),value>0&&(accumulator[1]+=value));return accumulator}__name(sumValues,"sumValues");function sum(id,matchGroupId){return{id,matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:__name(values=>sumValues(values),"aggregateFunction")}}__name(sum,"sum");function groupSum(id,matchGroupId){return{id,type:"aggregate",matchGroupIds:matchGroupId?[matchGroupId]:void 0,aggregateFunction:__name(values=>sumValues(values),"aggregateFunction"),groupAggregateFunction:__name((next,acc=[0,0])=>(acc[0]+=(next==null?void 0:next[0])??0,acc[1]+=(next==null?void 0:next[1])??0,acc),"groupAggregateFunction")}}__name(groupSum,"groupSum");function range2(id,matchGroupId){return{id,matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:__name(values=>ContinuousDomain.extendDomain(values),"aggregateFunction")}}__name(range2,"range2");function groupCount(id){return{id,type:"aggregate",aggregateFunction:__name(()=>[0,1],"aggregateFunction"),groupAggregateFunction:__name((next,acc=[0,0])=>(acc[0]+=(next==null?void 0:next[0])??0,acc[1]+=(next==null?void 0:next[1])??0,acc),"groupAggregateFunction")}}__name(groupCount,"groupCount");function groupAverage(id,matchGroupId){return{id,matchGroupIds:matchGroupId?[matchGroupId]:void 0,type:"aggregate",aggregateFunction:__name(values=>sumValues(values),"aggregateFunction"),groupAggregateFunction:__name((next,acc=[0,0,-1])=>(acc[0]+=(next==null?void 0:next[0])??0,acc[1]+=(next==null?void 0:next[1])??0,acc[2]++,acc),"groupAggregateFunction"),finalFunction:__name((acc=[0,0,0])=>{const result=acc[0]+acc[1];return result>=0?[0,result/acc[2]]:[result/acc[2],0]},"finalFunction")}}__name(groupAverage,"groupAverage");function area(id,aggFn,matchGroupId){const result={id,matchGroupIds:matchGroupId?[matchGroupId]:void 0,type:"aggregate",aggregateFunction:__name((values,keyRange=[])=>{const keyWidth=keyRange[1]-keyRange[0];return aggFn.aggregateFunction(values).map(v=>v/keyWidth)},"aggregateFunction")};return aggFn.groupAggregateFunction&&(result.groupAggregateFunction=aggFn.groupAggregateFunction),result}__name(area,"area");function accumulatedValue(onlyPositive){return()=>{let value=0;return datum=>isFiniteNumber(datum)?(value+=onlyPositive?Math.max(0,datum):datum,value):datum}}__name(accumulatedValue,"accumulatedValue");function trailingAccumulatedValue(){return()=>{let value=0;return datum=>{if(!isFiniteNumber(datum))return datum;const trailingValue=value;return value+=datum,trailingValue}}}__name(trailingAccumulatedValue,"trailingAccumulatedValue");function basicContinuousCheckDatumValidation(value){return value!=null&&isContinuous(value)}__name(basicContinuousCheckDatumValidation,"basicContinuousCheckDatumValidation");function basicDiscreteCheckDatumValidation(value){return value!=null}__name(basicDiscreteCheckDatumValidation,"basicDiscreteCheckDatumValidation");function getValidationFn(scaleType){switch(scaleType){case"number":case"log":case"ordinal-time":case"time":case"color":return basicContinuousCheckDatumValidation;default:return basicDiscreteCheckDatumValidation}}__name(getValidationFn,"getValidationFn");function getValueType(scaleType){switch(scaleType){case"number":case"log":case"time":case"color":return"range";default:return"category"}}__name(getValueType,"getValueType");function keyProperty(propName,scaleType,opts={}){return{property:propName,type:"key",valueType:getValueType(scaleType),validation:getValidationFn(scaleType),...opts}}__name(keyProperty,"keyProperty");function valueProperty(propName,scaleType,opts={}){return{property:propName,type:"value",valueType:getValueType(scaleType),validation:getValidationFn(scaleType),...opts}}__name(valueProperty,"valueProperty");function rowCountProperty(propName,opts={}){return{property:propName,type:"value",valueType:"range",missingValue:1,processor:__name(()=>()=>1,"processor"),...opts}}__name(rowCountProperty,"rowCountProperty");var noopProcessor=__name(function(v){return v},"noopProcessor");function processorChain(...chain){const filteredChain=chain.filter(fn=>fn!=null);return filteredChain.length===0?()=>noopProcessor:filteredChain.length===1?filteredChain[0]:()=>{const processorInstances=filteredChain.map(fn=>fn());return(value,index)=>processorInstances.reduce((r,p)=>p(r,index),value)}}__name(processorChain,"processorChain");function rangedValueProperty(propName,opts={}){const{min=-1/0,max=1/0,processor,...defOpts}=opts;return{type:"value",property:propName,valueType:"range",validation:basicContinuousCheckDatumValidation,processor:processorChain(processor,()=>datum=>isFiniteNumber(datum)?clamp(min,datum,max):datum),...defOpts}}__name(rangedValueProperty,"rangedValueProperty");function accumulativeValueProperty(propName,scaleType,opts={}){const{onlyPositive,processor,...defOpts}=opts;return{...valueProperty(propName,scaleType,defOpts),processor:processorChain(processor,accumulatedValue(onlyPositive))}}__name(accumulativeValueProperty,"accumulativeValueProperty");function trailingAccumulatedValueProperty(propName,scaleType,opts={}){return{...valueProperty(propName,scaleType,opts),processor:trailingAccumulatedValue()}}__name(trailingAccumulatedValueProperty,"trailingAccumulatedValueProperty");function groupAccumulativeValueProperty(propName,mode,sum2,opts,scaleType){return[valueProperty(propName,scaleType,opts),accumulateGroup(opts.groupId,mode,sum2,opts.separateNegative),...opts.rangeId!=null?[range2(opts.rangeId,opts.groupId)]:[]]}__name(groupAccumulativeValueProperty,"groupAccumulativeValueProperty");function groupStackValueProperty(propName,scaleType,opts){return[valueProperty(propName,scaleType,opts),accumulateStack(opts.groupId)]}__name(groupStackValueProperty,"groupStackValueProperty");var SMALLEST_KEY_INTERVAL={type:"reducer",property:"smallestKeyInterval",initialValue:1/0,reducer:__name(()=>{let prevX=NaN;return(smallestSoFar=1/0,keys)=>{const nextX=typeof keys[0]=="number"?keys[0]:Number(keys[0]),interval=Math.abs(nextX-prevX);return prevX=nextX,!isNaN(interval)&&interval>0&&interval<smallestSoFar?interval:smallestSoFar}},"reducer")},LARGEST_KEY_INTERVAL={type:"reducer",property:"largestKeyInterval",initialValue:-1/0,reducer:__name(()=>{let prevX=NaN;return(largestSoFar=-1/0,keys)=>{const nextX=typeof keys[0]=="number"?keys[0]:Number(keys[0]),interval=Math.abs(nextX-prevX);return prevX=nextX,!isNaN(interval)&&interval>0&&interval>largestSoFar?interval:largestSoFar}},"reducer")},SORT_DOMAIN_GROUPS={type:"processor",property:"sortedGroupDomain",calculate:__name(({domain:{groups}})=>groups==null?void 0:groups.slice().sort((a,b)=>{for(let i=0;i<a.length;i++){const result=a[i]-b[i];if(result!==0)return result}return 0}),"calculate")};function normaliseFnBuilder({normaliseTo}){const normalise2=__name((val,extent2)=>{if(extent2===0)return null;const result=(val??0)*normaliseTo/extent2;return result>=0?Math.min(normaliseTo,result):Math.max(-normaliseTo,result)},"normalise2");return()=>()=>(columns,valueIndexes,dataGroup)=>{const extent2=normaliseFindExtent(columns,valueIndexes,dataGroup);for(const valueIdx of valueIndexes)for(const datumIndex of dataGroup.datumIndices[valueIdx]??[]){const column=columns[valueIdx],value=column[datumIndex];if(value==null){column[datumIndex]=void 0;continue}column[datumIndex]=typeof value=="number"?normalise2(value,extent2):value.map(v=>normalise2(v,extent2))}}}__name(normaliseFnBuilder,"normaliseFnBuilder");function normaliseFindExtent(columns,valueIndexes,dataGroup){const valuesExtent=[0,0];for(const valueIdx of valueIndexes){const column=columns[valueIdx];for(const datumIndex of dataGroup.datumIndices[valueIdx]??[]){const value=column[datumIndex];if(value==null)continue;const valueExtent=typeof value=="number"?value:Math.max(...value.map(v=>v??0)),valIdx=valueExtent<0?0:1;valIdx===0?valuesExtent[valIdx]=Math.min(valuesExtent[valIdx],valueExtent):valuesExtent[valIdx]=Math.max(valuesExtent[valIdx],valueExtent)}}return Math.max(Math.abs(valuesExtent[0]),valuesExtent[1])}__name(normaliseFindExtent,"normaliseFindExtent");function normaliseGroupTo(matchGroupIds,normaliseTo){return{type:"group-value-processor",matchGroupIds,adjust:memo({normaliseTo},normaliseFnBuilder)}}__name(normaliseGroupTo,"normaliseGroupTo");function normalisePropertyFnBuilder({normaliseTo,zeroDomain,rangeMin,rangeMax}){const normaliseSpan=normaliseTo[1]-normaliseTo[0],normalise2=__name((val,start2,span)=>{const result=normaliseTo[0]+(val-start2)/span*normaliseSpan;return span===0?zeroDomain:result>=normaliseTo[1]?normaliseTo[1]:result<normaliseTo[0]?normaliseTo[0]:result},"normalise2");return()=>(pData,pIdx)=>{let[start2,end2]=pData.domain.values[pIdx];rangeMin!=null&&(start2=rangeMin),rangeMax!=null&&(end2=rangeMax);const span=end2-start2;pData.domain.values[pIdx]=[normaliseTo[0],normaliseTo[1]];const column=pData.columns[pIdx];for(let datumIndex=0;datumIndex<column.length;datumIndex+=1)column[datumIndex]=normalise2(column[datumIndex],start2,span)}}__name(normalisePropertyFnBuilder,"normalisePropertyFnBuilder");function normalisePropertyTo(property,normaliseTo,zeroDomain,rangeMin,rangeMax){return{type:"property-value-processor",property,adjust:memo({normaliseTo,rangeMin,rangeMax,zeroDomain},normalisePropertyFnBuilder)}}__name(normalisePropertyTo,"normalisePropertyTo");var ANIMATION_VALIDATION_UNIQUE_KEYS=1,ANIMATION_VALIDATION_ORDERED_KEYS=2,animationValidationProcessKey=__name((count,def,keyValues,column)=>{var _a294,_b;let validation=ANIMATION_VALIDATION_UNIQUE_KEYS|ANIMATION_VALIDATION_ORDERED_KEYS;if(def.valueType==="category")return keyValues.length!==count&&(validation&=-2),validation;let lastValue=(_a294=column[0])==null?void 0:_a294.valueOf();for(let d=1;validation!==0&&d<column.length;d++){const keyValue=(_b=column[d])==null?void 0:_b.valueOf();(!Number.isFinite(keyValue)||lastValue>keyValue)&&(validation&=-3),Number.isFinite(keyValue)&&lastValue===keyValue&&(validation&=-2),lastValue=keyValue}return validation},"animationValidationProcessKey");function animationValidation(valueKeyIds){return{type:"processor",property:"animationValidation",calculate(result){const{keys:keysDefs,values:valuesDef}=result.defs,{input:{count},domain:{keys:domainKeys,values:domainValues},keys,columns}=result;let validation=ANIMATION_VALIDATION_UNIQUE_KEYS|ANIMATION_VALIDATION_ORDERED_KEYS;if(count!==0){for(let i=0;validation!==0&&i<keysDefs.length;i++)for(const scope of keysDefs[i].scopes)validation&=animationValidationProcessKey(count,keysDefs[i],domainKeys[i],keys[i].get(scope));for(let i=0;validation!==0&&i<valuesDef.length;i++){const value=valuesDef[i];valueKeyIds!=null&&valueKeyIds.includes(value.id)&&(validation&=animationValidationProcessKey(count,value,domainValues[i],columns[i]))}}return{uniqueKeys:(validation&ANIMATION_VALIDATION_UNIQUE_KEYS)!==0,orderedKeys:(validation&ANIMATION_VALIDATION_ORDERED_KEYS)!==0}}}}__name(animationValidation,"animationValidation");function buildGroupAccFn({mode,separateNegative}){return()=>()=>(columns,valueIndexes,dataGroup)=>{const acc=[0,0];for(const valueIdx of valueIndexes)for(const datumIndex of dataGroup.datumIndices[valueIdx]??[]){const column=columns[valueIdx],currentVal=column[datumIndex],accIndex=isNegative(currentVal)&&separateNegative?0:1;isFiniteNumber(currentVal)&&(mode==="normal"&&(acc[accIndex]+=currentVal),column[datumIndex]=acc[accIndex],mode==="trailing"&&(acc[accIndex]+=currentVal))}}}__name(buildGroupAccFn,"buildGroupAccFn");function buildGroupWindowAccFn({mode,sum:sum2}){return()=>{const lastValues=[];let firstRow=!0;return()=>(columns,valueIndexes,dataGroup)=>{let acc=0;for(const valueIdx of valueIndexes){const column=columns[valueIdx];for(const datumIndex of dataGroup.datumIndices[valueIdx]??[]){const currentVal=column[datumIndex],lastValue=firstRow&&sum2==="current"?0:lastValues[valueIdx];lastValues[valueIdx]=currentVal;const sumValue=sum2==="current"?currentVal:lastValue;if(!isFiniteNumber(currentVal)||!isFiniteNumber(lastValue)){column[datumIndex]=acc;continue}mode==="normal"&&(acc+=sumValue),column[datumIndex]=acc,mode==="trailing"&&(acc+=sumValue)}}firstRow=!1}}}__name(buildGroupWindowAccFn,"buildGroupWindowAccFn");function accumulateGroup(matchGroupId,mode,sum2,separateNegative=!1){let adjust;if(mode.startsWith("window")){const modeParam=mode.endsWith("-trailing")?"trailing":"normal";adjust=memo({mode:modeParam,sum:sum2},buildGroupWindowAccFn)}else adjust=memo({mode,separateNegative},buildGroupAccFn);return{type:"group-value-processor",matchGroupIds:[matchGroupId],adjust}}__name(accumulateGroup,"accumulateGroup");function groupStackAccFn(){return()=>(columns,valueIndexes,dataGroup)=>{const acc=new Float64Array(valueIndexes.length);let stackCount=0;for(const valueIdx of valueIndexes){const column=columns[valueIdx];for(const datumIndex of dataGroup.datumIndices[valueIdx]??[]){const currentValue=column[datumIndex];acc[stackCount]=Number.isFinite(currentValue)?currentValue:NaN,stackCount+=1,column[datumIndex]=acc.subarray(0,stackCount)}}}}__name(groupStackAccFn,"groupStackAccFn");function accumulateStack(matchGroupId){return{type:"group-value-processor",matchGroupIds:[matchGroupId],adjust:groupStackAccFn}}__name(accumulateStack,"accumulateStack");function valueIdentifier(value){return value.id??value.property}__name(valueIdentifier,"valueIdentifier");function valueIndices(id,previousData,processedData){var _a294,_b;const properties=new Map,previousValues=previousData.defs.values;for(let previousIndex=0;previousIndex<previousValues.length;previousIndex+=1){const previousValue=previousValues[previousIndex];if(((_a294=previousValue.scopes)==null?void 0:_a294.includes(id))===!1)continue;const valueId=valueIdentifier(previousValue);if(properties.has(valueId))return;properties.set(valueId,previousIndex)}const indices=[],nextValues=processedData.defs.values;for(let nextIndex=0;nextIndex<nextValues.length;nextIndex+=1){const nextValue=nextValues[nextIndex];if(((_b=nextValue.scopes)==null?void 0:_b.includes(id))===!1)continue;const valueId=valueIdentifier(nextValue),previousIndex=properties.get(valueId);if(previousIndex==null)return;properties.delete(valueId),indices.push({previousIndex,nextIndex})}if(properties.size===0)return indices}__name(valueIndices,"valueIndices");function columnsEqual(previousColumns,nextColumns,indices,previousDatumIndex,nextDatumIndex){for(const{previousIndex,nextIndex}of indices){const previousColumn=previousColumns[previousIndex],nextColumn=nextColumns[nextIndex],previousValue=previousColumn[previousDatumIndex],nextValue=nextColumn[nextDatumIndex];if(previousValue!==nextValue)return!1}return!0}__name(columnsEqual,"columnsEqual");function diff(id,previousData,updateMovedData=!0){return{type:"processor",property:"diff",calculate(processedData,previousValue){const moved=new Map,added=new Map,updated=new Map,removed=new Map,previousKeys=previousData.keys,keys=processedData.keys,previousColumns=previousData.columns,columns=processedData.columns,indices=valueIndices(id,previousData,processedData);if(indices==null)return previousValue;const length2=Math.max(previousData.input.count,processedData.input.count);for(let i=0;i<length2;i++){const hasPreviousDatum=i<previousData.input.count,hasDatum=i<processedData.input.count,prevKeys=hasPreviousDatum?datumKeys(previousKeys,id,i):void 0,prevId=prevKeys!=null?createDatumId(prevKeys):"",dKeys=hasDatum?datumKeys(keys,id,i):void 0,datumId=dKeys!=null?createDatumId(dKeys):"";if(hasDatum&&hasPreviousDatum&&prevId===datumId){columnsEqual(previousColumns,columns,indices,i,i)||updated.set(datumId,i);continue}const removedIndex=removed.get(datumId);removedIndex!=null?((updateMovedData||!columnsEqual(previousColumns,columns,indices,removedIndex,i))&&(updated.set(datumId,i),moved.set(datumId,i)),removed.delete(datumId)):hasDatum&&added.set(datumId,i);const addedIndex=added.get(prevId);addedIndex!=null?((updateMovedData||!columnsEqual(previousColumns,columns,indices,addedIndex,i))&&(updated.set(prevId,i),moved.set(prevId,i)),added.delete(prevId)):hasPreviousDatum&&(updated.delete(prevId),removed.set(prevId,i))}const value={changed:added.size>0||updated.size>0||removed.size>0,added:new Set(added.keys()),updated:new Set(updated.keys()),removed:new Set(removed.keys()),moved:new Set(moved.keys())};return{...previousValue,[id]:value}}}}__name(diff,"diff");function createDatumId(keys,...extraKeys){let result;return isArray(keys)?result=keys.map(key=>transformIntegratedCategoryValue(key)).join("___"):result=transformIntegratedCategoryValue(keys),(typeof result=="string"||typeof result=="number"||typeof result=="boolean"||result instanceof Date)&&extraKeys.length>0&&(result+=`___${extraKeys.join("___")}`),result}__name(createDatumId,"createDatumId");var _a167,Dimensions=(_a167=class{constructor(){this.top=1/0,this.right=-1/0,this.bottom=-1/0,this.left=1/0}update(x,y){x>this.right&&(this.right=x),x<this.left&&(this.left=x),y>this.bottom&&(this.bottom=y),y<this.top&&(this.top=y)}},__name(_a167,"Dimensions"),_a167),_a168,TreeNode=(_a168=class{constructor(label="",parent,refId){this.label=label,this.parent=parent,this.refId=refId,this.x=0,this.y=0,this.subtreeLeft=NaN,this.subtreeRight=NaN,this.children=[],this.leafCount=0,this.prelim=0,this.mod=0,this.ancestor=this,this.change=0,this.shift=0,this.index=0,this.screenX=0,this.depth=parent?parent.depth+1:0}insertTick(tick,index){let root=this;for(let i=0;i<tick.length;i++){const pathPart=tick[i],isNotLeaf=i!==tick.length-1,{children}=root,existingNode=children.find(child=>child.label===pathPart);if(existingNode&&isNotLeaf)root=existingNode;else{const node=new _a168(pathPart,root,index);node.index=children.length,children.push(node),isNotLeaf&&(root=node)}}}getLeftSibling(){var _a294;return this.index>0?(_a294=this.parent)==null?void 0:_a294.children[this.index-1]:void 0}getLeftmostSibling(){var _a294;return this.index>0?(_a294=this.parent)==null?void 0:_a294.children[0]:void 0}nextLeft(){return this.children[0]}nextRight(){return this.children.at(-1)}getSiblings(){var _a294;return((_a294=this.parent)==null?void 0:_a294.children.filter((_,i)=>i!==this.index))??[]}},__name(_a168,"_TreeNode"),_a168);function ticksToTree(ticks){const maxDepth=ticks.reduce((depth,tick)=>depth<tick.length?tick.length:depth,0),root=new TreeNode;for(let i=0;i<ticks.length;i++){const tick=ticks[i];for(;tick.length<maxDepth;)tick.push("");root.insertTick(tick,i)}return root}__name(ticksToTree,"ticksToTree");function moveSubtree(wm,wp,shift){const subtrees=wp.index-wm.index,ratio5=shift/subtrees;wp.change-=ratio5,wp.shift+=shift,wm.change+=ratio5,wp.prelim+=shift,wp.mod+=shift}__name(moveSubtree,"moveSubtree");function ancestor(vim,v,defaultAncestor){return v.getSiblings().indexOf(vim.ancestor)>=0?vim.ancestor:defaultAncestor}__name(ancestor,"ancestor");function executeShifts({children}){let shift=0,change=0;for(let i=children.length-1;i>=0;i--){const w=children[i];w.prelim+=shift,w.mod+=shift,change+=w.change,shift+=w.shift+change}}__name(executeShifts,"executeShifts");function apportion(v,defaultAncestor){const w=v.getLeftSibling();if(w){let vop=v,vip=v,vim=w,vom=vip.getLeftmostSibling(),sip=vip.mod,sop=vop.mod,sim=vim.mod,som=vom.mod;for(;vim.nextRight()&&vip.nextLeft();){vim=vim.nextRight(),vip=vip.nextLeft(),vom=vom.nextLeft(),vop=vop.nextRight(),vop.ancestor=v;const shift=vim.prelim+sim-(vip.prelim+sip)+1;shift>0&&(moveSubtree(ancestor(vim,v,defaultAncestor),v,shift),sip+=shift,sop+=shift),sim+=vim.mod,sip+=vip.mod,som+=vom.mod,sop+=vop.mod}vim.nextRight()&&!vop.nextRight()?vop.mod+=sim-sop:(vip.nextLeft()&&!vom.nextLeft()&&(vom.mod+=sip-som),defaultAncestor=v)}return defaultAncestor}__name(apportion,"apportion");function firstWalk(node){const{children}=node;if(children.length){let[defaultAncestor]=children;for(const child of children)firstWalk(child),defaultAncestor=apportion(child,defaultAncestor);executeShifts(node);const midpoint=(children[0].prelim+children.at(-1).prelim)/2,leftSibling=node.getLeftSibling();leftSibling?(node.prelim=leftSibling.prelim+1,node.mod=node.prelim-midpoint):node.prelim=midpoint}else{const leftSibling=node.getLeftSibling();node.prelim=leftSibling?leftSibling.prelim+1:0}}__name(firstWalk,"firstWalk");function secondWalk(v,m,layout){v.x=v.prelim+m,v.y=v.depth,layout.insertNode(v);for(const w of v.children)secondWalk(w,m+v.mod,layout)}__name(secondWalk,"secondWalk");function thirdWalk(v){const{children}=v;let leafCount=0;for(const w of children)thirdWalk(w),w.children.length?leafCount+=w.leafCount:leafCount++;v.leafCount=leafCount,children.length?(v.subtreeLeft=children[0].subtreeLeft,v.subtreeRight=children[children.length-1].subtreeRight,v.x=(v.subtreeLeft+v.subtreeRight)/2):(v.subtreeLeft=v.x,v.subtreeRight=v.x)}__name(thirdWalk,"thirdWalk");function treeLayout(ticks){const layout=new TreeLayout,root=ticksToTree(ticks);return firstWalk(root),secondWalk(root,-root.prelim,layout),thirdWalk(root),layout}__name(treeLayout,"treeLayout");var _a169,TreeLayout=(_a169=class{constructor(){this.dimensions=new Dimensions,this.nodes=[],this.depth=0}insertNode(node){this.depth<node.depth&&(this.depth=node.depth),this.dimensions.update(node.x,node.y),this.nodes.push(node)}scalingX(width2,flip){let scalingX=1;if(width2>0){const{left,right}=this.dimensions;scalingX=width2/(right-left)}return flip&&(scalingX*=-1),scalingX}},__name(_a169,"TreeLayout"),_a169),_a170,DepthLabelProperties=(_a170=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0}},__name(_a170,"DepthLabelProperties"),_a170);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"enabled",2);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"avoidCollisions",2);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"color",2);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"spacing",2);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"fontStyle",2);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"fontWeight",2);__decorateClass([TempValidate(NUMBER.restrict({min:1}))],DepthLabelProperties.prototype,"fontSize",2);__decorateClass([TempValidate()],DepthLabelProperties.prototype,"fontFamily",2);var _a171,DepthTickProperties=(_a171=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0}},__name(_a171,"DepthTickProperties"),_a171);__decorateClass([TempValidate()],DepthTickProperties.prototype,"enabled",2);__decorateClass([TempValidate()],DepthTickProperties.prototype,"width",2);__decorateClass([TempValidate()],DepthTickProperties.prototype,"stroke",2);var _a172,DepthProperties=(_a172=class extends BaseProperties{constructor(){super(...arguments),this.label=new DepthLabelProperties,this.tick=new DepthTickProperties}},__name(_a172,"DepthProperties"),_a172);__decorateClass([TempValidate()],DepthProperties.prototype,"label",2);__decorateClass([TempValidate()],DepthProperties.prototype,"tick",2);var _a173,GroupedCategoryAxis=(_a173=class extends CategoryAxis{constructor(moduleCtx){super(moduleCtx,new GroupedCategoryScale),this.tickScale=new GroupedCategoryScale,this.depthOptions=new PropertiesArray(DepthProperties),this.includeInvisibleDomains=!0,this.tickScale.paddingInner=1,this.tickScale.paddingOuter=0}resizeTickTree(){if(!this.tickTreeLayout)return;const{nodes}=this.tickTreeLayout,{range:range3,step,inset,bandwidth}=this.scale,width2=Math.abs(range3[1]-range3[0])-step,scalingX=this.tickTreeLayout.scalingX(width2,range3[0]>range3[1]),shiftX=inset+bandwidth/2;let offsetX=0;for(const node of nodes){const screenX=node.x*scalingX;offsetX>screenX&&(offsetX=screenX),node.screenX=screenX+shiftX}for(const node of nodes)node.screenX-=offsetX}getDepthOptionsMap(maxDepth){var _a294,_b,_c,_d;const optionsMap=[],{depthOptions,label}=this;for(let i=0;i<maxDepth;i++)optionsMap.push(((_a294=depthOptions[i])==null?void 0:_a294.label.enabled)??label.enabled?{enabled:!0,spacing:((_b=depthOptions[i])==null?void 0:_b.label.spacing)??label.spacing,lineHeight:TextUtils.getLineHeight(((_c=depthOptions[i])==null?void 0:_c.label.fontSize)??label.fontSize??10),avoidCollisions:((_d=depthOptions[i])==null?void 0:_d.label.avoidCollisions)??label.avoidCollisions}:{enabled:!1,spacing:0,lineHeight:0,avoidCollisions:!1});return optionsMap}updateCategoryLabels(){this.computedLayout&&this.tickLabelGroupSelection.update(this.computedLayout.tickLabelLayout).each((node,datum)=>node.setProperties(datum))}updateAxisLine(){this.computedLayout&&(this.lineNode.visible=this.line.enabled,this.lineNode.stroke=this.line.stroke,this.lineNode.strokeWidth=this.line.width)}computeLayout(){var _a294;if(this.updateDirection(),this.updateScale(),this.resizeTickTree(),!((_a294=this.tickTreeLayout)!=null&&_a294.depth))return{bbox:BBox.zero,separatorLayout:[],tickLabelLayout:[]};const{step}=this.scale,{title,label,range:range3,depthOptions}=this,{depth:maxDepth,nodes:treeLabels}=this.tickTreeLayout,keepEvery=Math.ceil(label.fontSize/step),rotation=toRadians(this.rotation),isHorizontal=this.position==="top"||this.position==="bottom",sideFlag=label.getSideFlag(),tickLabelLayout=[],labelBBoxes=new Map,tempText=new TransformableText,{defaultRotation,configuredRotation}=calculateLabelRotation({rotation:label.rotation,parallel:label.parallel,regularFlipRotation:normalizeAngle360(rotation-Math.PI/2),parallelFlipRotation:normalizeAngle360(rotation)}),labelRotation=defaultRotation+configuredRotation,optionsMap=this.getDepthOptionsMap(maxDepth),setLabelProps=__name((datum,index)=>{var _a295,_b;const depth=maxDepth-datum.depth;if(!((_a295=optionsMap[depth])!=null&&_a295.enabled)||index%keepEvery!==0||!inRange(datum.screenX,range3))return!1;const text2=this.formatTick(datum.label,index-1,this.scale.domain),labelStyles=this.getLabelStyles({value:text2,depth},(_b=depthOptions[depth])==null?void 0:_b.label);return tempText.setProperties({...labelStyles,text:text2,textAlign:"center",textBaseline:label.parallel?"hanging":"bottom",rotation:0,translationX:0,translationY:datum.screenX}),!0},"setLabelProps");let maxLeafLabelWidth=0;const depthLines={};treeLabels.forEach((datum,index)=>{const depth=maxDepth-datum.depth,nodeLines=countLines(datum.label);if(depthLines[depth]??(depthLines[depth]=1),depthLines[depth]<nodeLines&&(depthLines[depth]=nodeLines),!(!setLabelProps(datum,index)||!tempText.getBBox())&&(labelBBoxes.set(index,tempText.getBBox()),!datum.leafCount)){tempText.rotation=labelRotation;const{width:width3}=tempText.getBBox();maxLeafLabelWidth<width3&&(maxLeafLabelWidth=width3)}});const idGenerator=createIdsGenerator(),labelX=sideFlag*optionsMap[0].spacing,separatorData=new Map,nestedPadding=__name(d=>{let v=maxLeafLabelWidth;for(let i=1;i<=d;i++)v+=optionsMap[i].spacing,(label.mirrored||i!==d)&&(v+=depthLines[i]*optionsMap[i].lineHeight);return v},"nestedPadding");treeLabels.forEach((datum,index)=>{var _a295;if(index===0)return;const visible=setLabelProps(datum,index),isLeaf=!datum.children.length,depth=maxDepth-datum.depth;if(datum.parent){const separatorX=isLeaf?datum.x:datum.x-(datum.leafCount-1)/2;if(!separatorData.has(separatorX)){const tickOptions=(_a295=this.depthOptions[depth])==null?void 0:_a295.tick;let v=maxLeafLabelWidth;for(let i=0;i<=depth;i++)v+=optionsMap[i].spacing,i!==0&&(v+=depthLines[i]*optionsMap[i].lineHeight);separatorData.set(separatorX,{tickSize:v,tickStroke:tickOptions==null?void 0:tickOptions.stroke,tickWidth:(tickOptions==null?void 0:tickOptions.enabled)!==!1?tickOptions==null?void 0:tickOptions.width:0})}}if(!visible)return;if(tempText.x=labelX,tempText.y=0,isLeaf){const{width:width3}=labelBBoxes.get(index),angleRatio=getAngleRatioRadians(labelRotation);tempText.rotation=labelRotation,tempText.textAlign="end",tempText.textBaseline="middle",tempText.rotationCenterX=labelX-width3/2,tempText.translationX=(optionsMap[depth].spacing-width3)/2*angleRatio*sideFlag,label.mirrored&&(tempText.translationX+=width3)}else tempText.rotation=isHorizontal?defaultRotation:-Math.PI/2,tempText.rotationCenterX=labelX,tempText.translationX=sideFlag*nestedPadding(depth);if(optionsMap[depth].avoidCollisions){const availableRange=isLeaf?step:datum.leafCount*step;if(tempText.getBBox().height>availableRange){labelBBoxes.delete(index);return}}const{text:text2=""}=tempText;tickLabelLayout.push({text:text2,visible:!0,range:this.scale.range,tickId:idGenerator(text2),fill:tempText.fill,fontFamily:tempText.fontFamily,fontSize:tempText.fontSize,fontStyle:tempText.fontStyle,fontWeight:tempText.fontWeight,rotation:tempText.rotation,rotationCenterX:tempText.rotationCenterX,textAlign:tempText.textAlign,textBaseline:tempText.textBaseline,translationX:tempText.translationX,translationY:tempText.translationY,x:tempText.x,y:tempText.y}),labelBBoxes.set(index,Transformable.toCanvas(tempText))});const{enabled,stroke:stroke2,width:width2}=this.line;this.lineNode.datum={x:0,y1:range3[0],y2:range3[1]},this.lineNode.setProperties({stroke:stroke2,strokeWidth:enabled?width2:0});const separatorLayout=[...separatorData.values()];separatorLayout.push(separatorLayout[0]);const axisBoxes=[this.lineNode.getBBox(),new BBox(0,0,separatorLayout[0].tickSize*sideFlag,0)];title.enabled&&(this.updateTitle(this.scale.domain,!1,separatorLayout[0].tickSize),axisBoxes.push(title.caption.node.getBBox()));const mergedBBox=BBox.merge(iterate(labelBBoxes.values(),axisBoxes));return{bbox:this.getTransformBox(mergedBBox),separatorLayout,tickLabelLayout}}update(){if(!this.computedLayout)return;this.moduleCtx.animationManager.skipCurrentBatch();const{tickScale,gridLine,gridLength}=this,{separatorLayout}=this.computedLayout,ticksData=tickScale.ticks({nice:!1,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}).map((tick,index)=>({...separatorLayout[index],tick,tickId:createDatumId(tick,index),tickLabel:tick.filter(Boolean).join(" - "),translationY:Math.round(tickScale.convert(tick))}));this.gridLineGroupSelection.update(gridLine.enabled&&gridLength?ticksData:[]),this.tickLineGroupSelection.update(this.tick.enabled?ticksData:[]),this.updatePosition(),this.updateCategoryLabels(),this.updateAxisLine(),this.updateGridLines(),this.updateTickLines(),this.updateTitle(this.scale.domain),this.resetSelectionNodes()}calculateLayout(){const{separatorLayout,tickLabelLayout,bbox}=this.computeLayout();return this.computedLayout={separatorLayout,tickLabelLayout},{bbox,niceDomain:this.scale.domain}}onGridVisibilityChange(){this.gridLineGroupSelection.clear(),this.tickLabelGroupSelection.clear()}updateScale(){super.updateScale(),this.tickScale.range=this.scale.range,this.scale.paddingOuter=this.scale.paddingInner/2}processData(){const{direction}=this,flatDomains=this.boundSeries.filter(s=>s.visible).flatMap(series=>series.getDomain(direction));this.dataDomain={domain:extent(flatDomains)??this.filterDuplicateArrays(flatDomains),clipped:!1},this.isReversed()&&this.dataDomain.domain.reverse();const domain=this.dataDomain.domain.map(datum=>toArray(isObject(datum)&&"value"in datum?datum.value:datum));this.tickTreeLayout=treeLayout(domain);const orderedDomain=[];for(const node of this.tickTreeLayout.nodes)node.leafCount||node.refId==null||orderedDomain.push(this.dataDomain.domain[node.refId]);this.scale.domain=sortBasedOnArray(this.dataDomain.domain,orderedDomain),this.tickScale.domain=domain.concat([[""]])}updateGridLines(){if(!this.gridLength)return;const{width:width2,style}=this.gridLine,lineSize=this.gridLength*-this.label.getSideFlag();this.gridLineGroupSelection.each((line,datum,index)=>{const{stroke:stroke2,lineDash}=style[index%style.length],y=datum.translationY;line.visible=this.inRange(y),line.x1=0,line.x2=lineSize,line.y=y,line.stroke=stroke2,line.strokeWidth=width2,line.lineDash=lineDash})}filterDuplicateArrays(array3){const seen=new Set;return array3.filter(item=>{const key=isArray(item)?JSON.stringify(item):item;return seen.has(key)?!1:(seen.add(key),!0)})}},__name(_a173,"GroupedCategoryAxis"),_a173);GroupedCategoryAxis.className="GroupedCategoryAxis";GroupedCategoryAxis.type="grouped-category";__decorateClass([TempValidate()],GroupedCategoryAxis.prototype,"depthOptions",2);var logFunctions={2:(_base,x)=>Math.log2(x),[Math.E]:(_base,x)=>Math.log(x),10:(_base,x)=>Math.log10(x)},DEFAULT_LOG=__name((base,x)=>Math.log(x)/Math.log(base),"DEFAULT_LOG");function log(base,domain,x){const start2=Math.min(...domain),fn=logFunctions[base]??DEFAULT_LOG;return start2>=0?fn(base,x):-fn(base,-x)}__name(log,"log");var powFunctions={[Math.E]:(_base,x)=>Math.exp(x),10:(_base,x)=>x>=0?10**x:1/10**-x},DEFAULT_POW=__name((base,x)=>base**x,"DEFAULT_POW");function pow(base,domain,x){const start2=Math.min(...domain),fn=powFunctions[base]??DEFAULT_POW;return start2>=0?fn(base,x):-fn(base,-x)}__name(pow,"pow");var _a174,LogScale=(_a174=class extends ContinuousScale{constructor(d=[1,10],r=[0,1]){super(d,r),this.type="log",this.defaultClamp=!0,this.base=10,this.log=x=>log(this.base,this.domain,x),this.pow=x=>pow(this.base,this.domain,x)}toDomain(d){return d}transform(x){const[min,max]=findMinMax(this.domain);return min>=0!=max>=0?NaN:min>=0?Math.log(x):-Math.log(-x)}transformInvert(x){const[min,max]=findMinMax(this.domain);return min>=0!=max>=0?NaN:min>=0?Math.exp(x):-Math.exp(-x)}niceDomain(_ticks,domain=this.domain){if(domain.length<2)return[];const{base}=this,[d0,d1]=domain,roundStart=d0>d1?Math.ceil:Math.floor,roundStop=d0>d1?Math.floor:Math.ceil,n0=pow(base,domain,roundStart(log(base,domain,d0))),n1=pow(base,domain,roundStop(log(base,domain,d1)));return[n0,n1]}ticks({interval,tickCount=ContinuousScale.defaultTickCount},domain=this.domain,visibleRange){if(!domain||domain.length<2||tickCount<1)return[];const base=this.base,[d0,d1]=domain,start2=Math.min(d0,d1),stop=Math.max(d0,d1);let p0=this.log(start2),p1=this.log(stop);if(interval){const inBounds=__name(tick=>tick>=start2&&tick<=stop,"inBounds"),step=Math.min(Math.abs(interval),Math.abs(p1-p0)),ticks2=range(p0,p1,step).map(this.pow).filter(inBounds);if(!isDenseInterval(ticks2.length,this.getPixelRange()))return ticks2}if(!isInteger(base)||p1-p0>=tickCount)return createTicks(p0,p1,Math.min(p1-p0,tickCount)).map(this.pow);let ticks=[];const isPositive=start2>0;p0=Math.floor(p0)-1,p1=Math.round(p1)+1;const availableSpacing=findRangeExtent(this.range)/tickCount;let lastTickPosition=1/0;for(let p=p0;p<=p1;p++){const nextMagnitudeTickPosition=this.convert(this.pow(p+1));for(let k=1;k<base;k++){const q=isPositive?k:base-k+1,t=this.pow(p)*q,tickPosition=this.convert(t),prevSpacing=Math.abs(lastTickPosition-tickPosition),nextSpacing=Math.abs(tickPosition-nextMagnitudeTickPosition),fits=prevSpacing>=availableSpacing&&nextSpacing>=availableSpacing;t>=start2&&t<=stop&&(k===1||fits||ticks.length===0)&&(ticks.push(t),lastTickPosition=tickPosition)}}return ticks=filterVisibleTicks(ticks,isPositive,visibleRange),ticks}tickFormatter({specifier}){return specifier!=null?createNumberFormatter(specifier):String}datumFormatter(params){return this.tickFormatter(params)}},__name(_a174,"LogScale"),_a174),_a175,LinearScale=(_a175=class extends ContinuousScale{constructor(){super([0,1],[0,1]),this.type="number"}static getTickStep(start2,stop,ticks){const{interval,tickCount=ContinuousScale.defaultTickCount,minTickCount,maxTickCount}=ticks;return interval??tickStep(start2,stop,tickCount,minTickCount,maxTickCount)}toDomain(d){return d}ticks({interval,tickCount=ContinuousScale.defaultTickCount,minTickCount,maxTickCount},domain=this.domain,visibleRange){if(!domain||domain.length<2||tickCount<1||!domain.every(isFinite))return[];const[d0,d1]=domain;if(interval){const step=Math.abs(interval);if(!isDenseInterval((d1-d0)/step,this.getPixelRange()))return range(d0,d1,step)}return createTicks(d0,d1,tickCount,minTickCount,maxTickCount,visibleRange)}niceDomain(ticks,domain=this.domain){if(domain.length<2)return[];const{tickCount=ContinuousScale.defaultTickCount}=ticks;let[start2,stop]=domain;if(tickCount===1)[start2,stop]=niceTicksDomain(start2,stop);else if(tickCount>1){const roundStart=start2>stop?Math.ceil:Math.floor,roundStop=start2>stop?Math.floor:Math.ceil,maxAttempts=4;for(let i=0;i<maxAttempts;i++){const prev0=start2,prev1=stop,step=_a175.getTickStep(start2,stop,ticks),[d0,d1]=domain;if(start2=roundStart(d0/step)*step,stop=roundStop(d1/step)*step,start2===prev0&&stop===prev1)break}}return[start2,stop]}tickFormatter({ticks:specifiedTicks,fractionDigits,specifier}){return specifier!=null?tickFormat(specifiedTicks,specifier):x=>formatValue(x,fractionDigits)}datumFormatter({ticks:specifiedTicks,fractionDigits,specifier}){return specifier!=null?tickFormat(specifiedTicks,specifier):x=>formatValue(x,fractionDigits+1)}},__name(_a175,"_LinearScale"),_a175),_a176,NumberAxis=(_a176=class extends CartesianAxis{constructor(moduleCtx,scale2=new LinearScale){super(moduleCtx,scale2)}normaliseDataDomain(d){const{min,max}=this,{extent:extent2,clipped}=normalisedExtentWithMetadata(d,min,max);return{domain:extent2,clipped}}},__name(_a176,"NumberAxis"),_a176);NumberAxis.className="NumberAxis";NumberAxis.type="number";__decorateClass([TempValidate(AND(NUMBER_OR_NAN,LESS_THAN("max")))],NumberAxis.prototype,"min",2);__decorateClass([TempValidate(AND(NUMBER_OR_NAN,GREATER_THAN("min")))],NumberAxis.prototype,"max",2);var _a177,LogAxis=(_a177=class extends NumberAxis{normaliseDataDomain(d){const{min,max}=this,{extent:extent2,clipped}=normalisedExtentWithMetadata(d,min,max);return extent2[0]<0&&extent2[1]>0||d[0]<0&&d[1]>0?(logger_exports.warn("The log axis domain crosses zero, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped}):extent2[0]===0||extent2[1]===0||d[0]===0||d[1]===0?(logger_exports.warn("The log axis domain contains a value of 0, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped}):{domain:extent2,clipped}}set base(value){this.scale.base=value}get base(){return this.scale.base}constructor(moduleCtx){super(moduleCtx,new LogScale)}defaultDatumFormatter(datum,_fractionDigits){return String(datum)}defaultLabelFormatter(datum,_fractionDigits){return String(datum)}},__name(_a177,"LogAxis"),_a177);LogAxis.className="LogAxis";LogAxis.type="log";var _a178,TimeAxis=(_a178=class extends CartesianAxis{constructor(moduleCtx){super(moduleCtx,new TimeScale),this.min=void 0,this.max=void 0}normaliseDataDomain(d){var _a294;let{min,max}=this,clipped=!1;return typeof min=="number"&&(min=new Date(min)),typeof max=="number"&&(max=new Date(max)),d.length>2&&(d=((_a294=extent(d))==null?void 0:_a294.map(x=>new Date(x)))??[]),min instanceof Date&&(clipped||(clipped=min>d[0]),d=[min,d[1]]),max instanceof Date&&(clipped||(clipped=max<d[1]),d=[d[0],max]),d[0]>d[1]&&(d=[]),{domain:d,clipped}}},__name(_a178,"TimeAxis"),_a178);TimeAxis.className="TimeAxis";TimeAxis.type="time";__decorateClass([TempValidate(AND(DATE_OR_DATETIME_MS,LESS_THAN("max")))],TimeAxis.prototype,"min",2);__decorateClass([TempValidate(AND(DATE_OR_DATETIME_MS,GREATER_THAN("min")))],TimeAxis.prototype,"max",2);var drawCorner=__name((path,{x0,y0,x1,y1,cx,cy},cornerRadius,move)=>{if(move&&path.moveTo(x0,y0),x0!==x1||y0!==y1){const r0=Math.atan2(y0-cy,x0-cx),r1=Math.atan2(y1-cy,x1-cx);path.arc(cx,cy,cornerRadius,r0,r1)}else path.lineTo(x0,y0)},"drawCorner"),epsilon=1e-6,cornerEdges=__name((leadingEdge,trailingEdge,leadingInset,trailingInset,cornerRadius)=>{let leadingClipped=!1,trailingClipped=!1,leading0=trailingInset-Math.sqrt(Math.max(cornerRadius**2-leadingInset**2,0)),leading1=0,trailing0=0,trailing1=leadingInset-Math.sqrt(Math.max(cornerRadius**2-trailingInset**2,0));return leading0>leadingEdge?(leadingClipped=!0,leading0=leadingEdge,leading1=leadingInset-Math.sqrt(Math.max(cornerRadius**2-(trailingInset-leadingEdge)**2))):leading0<epsilon&&(leading0=0),trailing1>trailingEdge?(trailingClipped=!0,trailing0=trailingInset-Math.sqrt(Math.max(cornerRadius**2-(leadingInset-trailingEdge)**2)),trailing1=trailingEdge):trailing1<epsilon&&(trailing1=0),{leading0,leading1,trailing0,trailing1,leadingClipped,trailingClipped}},"cornerEdges"),clippedRoundRect=__name((path,x,y,width2,height2,cornerRadii,clipBBox)=>{let{topLeft:topLeftCornerRadius,topRight:topRightCornerRadius,bottomRight:bottomRightCornerRadius,bottomLeft:bottomLeftCornerRadius}=cornerRadii;const maxVerticalCornerRadius=Math.max(topLeftCornerRadius+bottomLeftCornerRadius,topRightCornerRadius+bottomRightCornerRadius),maxHorizontalCornerRadius=Math.max(topLeftCornerRadius+topRightCornerRadius,bottomLeftCornerRadius+bottomRightCornerRadius);if(maxVerticalCornerRadius<=0&&maxHorizontalCornerRadius<=0){clipBBox==null?path.rect(x,y,width2,height2):path.rect(clipBBox.x,clipBBox.y,clipBBox.width,clipBBox.height);return}else if(clipBBox==null&&topLeftCornerRadius===topRightCornerRadius&&topLeftCornerRadius===bottomRightCornerRadius&&topLeftCornerRadius===bottomLeftCornerRadius){path.roundRect(x,y,width2,height2,topLeftCornerRadius);return}if(width2<0&&(x+=width2,width2=Math.abs(width2)),height2<0&&(y+=height2,height2=Math.abs(height2)),width2<=0||height2<=0)return;if(clipBBox==null)clipBBox=new BBox(x,y,width2,height2);else{const x0=Math.max(x,clipBBox.x),x1=Math.min(x+width2,clipBBox.x+clipBBox.width),y0=Math.max(y,clipBBox.y),y1=Math.min(y+height2,clipBBox.y+clipBBox.height);clipBBox=new BBox(x0,y0,x1-x0,y1-y0)}const borderScale=Math.max(maxVerticalCornerRadius/height2,maxHorizontalCornerRadius/width2,1);borderScale>1&&(topLeftCornerRadius/=borderScale,topRightCornerRadius/=borderScale,bottomRightCornerRadius/=borderScale,bottomLeftCornerRadius/=borderScale);let drawTopLeftCorner=!0,drawTopRightCorner=!0,drawBottomRightCorner=!0,drawBottomLeftCorner=!0,topLeftCorner,topRightCorner,bottomRightCorner,bottomLeftCorner;if(drawTopLeftCorner){const nodes=cornerEdges(clipBBox.height,clipBBox.width,Math.max(x+topLeftCornerRadius-clipBBox.x,0),Math.max(y+topLeftCornerRadius-clipBBox.y,0),topLeftCornerRadius);nodes.leadingClipped&&(drawBottomLeftCorner=!1),nodes.trailingClipped&&(drawTopRightCorner=!1);const x0=Math.max(clipBBox.x+nodes.leading1,clipBBox.x),y0=Math.max(clipBBox.y+nodes.leading0,clipBBox.y),x1=Math.max(clipBBox.x+nodes.trailing1,clipBBox.x),y1=Math.max(clipBBox.y+nodes.trailing0,clipBBox.y),cx=x+topLeftCornerRadius,cy=y+topLeftCornerRadius;topLeftCorner={x0,y0,x1,y1,cx,cy}}if(drawTopRightCorner){const nodes=cornerEdges(clipBBox.width,clipBBox.height,Math.max(y+topRightCornerRadius-clipBBox.y,0),Math.max(clipBBox.x+clipBBox.width-(x+width2-topRightCornerRadius),0),topRightCornerRadius);nodes.leadingClipped&&(drawTopLeftCorner=!1),nodes.trailingClipped&&(drawBottomRightCorner=!1);const x0=Math.min(clipBBox.x+clipBBox.width-nodes.leading0,clipBBox.x+clipBBox.width),y0=Math.max(clipBBox.y+nodes.leading1,clipBBox.y),x1=Math.min(clipBBox.x+clipBBox.width-nodes.trailing0,clipBBox.x+clipBBox.width),y1=Math.max(clipBBox.y+nodes.trailing1,clipBBox.y),cx=x+width2-topRightCornerRadius,cy=y+topRightCornerRadius;topRightCorner={x0,y0,x1,y1,cx,cy}}if(drawBottomRightCorner){const nodes=cornerEdges(clipBBox.height,clipBBox.width,Math.max(clipBBox.x+clipBBox.width-(x+width2-bottomRightCornerRadius),0),Math.max(clipBBox.y+clipBBox.height-(y+height2-bottomRightCornerRadius),0),bottomRightCornerRadius);nodes.leadingClipped&&(drawTopRightCorner=!1),nodes.trailingClipped&&(drawBottomLeftCorner=!1);const x0=Math.min(clipBBox.x+clipBBox.width-nodes.leading1,clipBBox.x+clipBBox.width),y0=Math.min(clipBBox.y+clipBBox.height-nodes.leading0,clipBBox.y+clipBBox.height),x1=Math.min(clipBBox.x+clipBBox.width-nodes.trailing1,clipBBox.x+clipBBox.width),y1=Math.min(clipBBox.y+clipBBox.height-nodes.trailing0,clipBBox.y+clipBBox.height),cx=x+width2-bottomRightCornerRadius,cy=y+height2-bottomRightCornerRadius;bottomRightCorner={x0,y0,x1,y1,cx,cy}}if(drawBottomLeftCorner){const nodes=cornerEdges(clipBBox.width,clipBBox.height,Math.max(clipBBox.y+clipBBox.height-(y+height2-bottomLeftCornerRadius),0),Math.max(x+bottomLeftCornerRadius-clipBBox.x,0),bottomLeftCornerRadius);nodes.leadingClipped&&(drawBottomRightCorner=!1),nodes.trailingClipped&&(drawTopLeftCorner=!1);const x0=Math.max(clipBBox.x+nodes.leading0,clipBBox.x),y0=Math.min(clipBBox.y+clipBBox.height-nodes.leading1,clipBBox.y+clipBBox.height),x1=Math.max(clipBBox.x+nodes.trailing0,clipBBox.x),y1=Math.min(clipBBox.y+clipBBox.height-nodes.trailing1,clipBBox.y+clipBBox.height),cx=x+bottomLeftCornerRadius,cy=y+height2-bottomLeftCornerRadius;bottomLeftCorner={x0,y0,x1,y1,cx,cy}}let didMove=!1;drawTopLeftCorner&&topLeftCorner!=null&&(drawCorner(path,topLeftCorner,topLeftCornerRadius,!didMove),didMove||(didMove=!0)),drawTopRightCorner&&topRightCorner!=null&&(drawCorner(path,topRightCorner,topRightCornerRadius,!didMove),didMove||(didMove=!0)),drawBottomRightCorner&&bottomRightCorner!=null&&(drawCorner(path,bottomRightCorner,bottomRightCornerRadius,!didMove),didMove||(didMove=!0)),drawBottomLeftCorner&&bottomLeftCorner!=null&&drawCorner(path,bottomLeftCorner,bottomLeftCornerRadius,!didMove),path.closePath()},"clippedRoundRect"),_a179,Rect=(_a179=class extends Path{constructor(){super(...arguments),this.borderPath=new ExtendedPath2D,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=Shape.defaultStyles.strokeWidth,this.effectiveStrokeWidth=Shape.defaultStyles.strokeWidth,this.hittester=super.isPointInPath.bind(this),this.distanceCalculator=super.distanceSquaredTransformedPoint.bind(this),this.microPixelEffectOpacity=1}set cornerRadius(cornerRadius){this.topLeftCornerRadius=cornerRadius,this.topRightCornerRadius=cornerRadius,this.bottomRightCornerRadius=cornerRadius,this.bottomLeftCornerRadius=cornerRadius}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth||!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){var _a294;const{path,borderPath,crisp,topLeftCornerRadius:topLeft,topRightCornerRadius:topRight,bottomRightCornerRadius:bottomRight,bottomLeftCornerRadius:bottomLeft}=this;let{x,y,width:w,height:h,strokeWidth,clipBBox}=this;const pixelSize=1/(((_a294=this.layerManager)==null?void 0:_a294.canvas.pixelRatio)??1);let microPixelEffectOpacity=1;if(path.clear(!0),borderPath.clear(!0),crisp&&(w<=pixelSize&&(microPixelEffectOpacity*=w/pixelSize),h<=pixelSize&&(microPixelEffectOpacity*=h/pixelSize),w=this.align(x,w),h=this.align(y,h),x=this.align(x),y=this.align(y),clipBBox=clipBBox!=null?new BBox(this.align(clipBBox.x),this.align(clipBBox.y),this.align(clipBBox.x,clipBBox.width),this.align(clipBBox.y,clipBBox.height)):void 0),strokeWidth)if(w<pixelSize){const lx=x+pixelSize/2;borderPath.moveTo(lx,y),borderPath.lineTo(lx,y+h),strokeWidth=pixelSize,this.borderClipPath=void 0}else if(h<pixelSize){const ly=y+pixelSize/2;borderPath.moveTo(x,ly),borderPath.lineTo(x+w,ly),strokeWidth=pixelSize,this.borderClipPath=void 0}else if(strokeWidth<w&&strokeWidth<h){const halfStrokeWidth=strokeWidth/2;x+=halfStrokeWidth,y+=halfStrokeWidth,w-=strokeWidth,h-=strokeWidth;const adjustedClipBBox=clipBBox==null?void 0:clipBBox.clone().shrink(halfStrokeWidth),cornerRadii={topLeft:topLeft>0?topLeft-strokeWidth:0,topRight:topRight>0?topRight-strokeWidth:0,bottomRight:bottomRight>0?bottomRight-strokeWidth:0,bottomLeft:bottomLeft>0?bottomLeft-strokeWidth:0};this.borderClipPath=void 0,w>0&&h>0&&(adjustedClipBBox==null||(adjustedClipBBox==null?void 0:adjustedClipBBox.width)>0&&(adjustedClipBBox==null?void 0:adjustedClipBBox.height)>0)&&(clippedRoundRect(path,x,y,w,h,cornerRadii,adjustedClipBBox),clippedRoundRect(borderPath,x,y,w,h,cornerRadii,adjustedClipBBox))}else this.borderClipPath=this.borderClipPath??new ExtendedPath2D,this.borderClipPath.clear(!0),this.borderClipPath.rect(x,y,w,h),borderPath.rect(x,y,w,h);else{const cornerRadii={topLeft,topRight,bottomRight,bottomLeft};this.borderClipPath=void 0,clippedRoundRect(path,x,y,w,h,cornerRadii,clipBBox)}if([topLeft,topRight,bottomRight,bottomLeft].every(r=>r===0)){const bbox=this.getBBox();this.hittester=bbox.containsPoint.bind(bbox),this.distanceSquared=(hitX,hitY)=>this.getBBox().distanceSquared(hitX,hitY)}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=strokeWidth,this.lastUpdatePathStrokeWidth=strokeWidth,this.microPixelEffectOpacity=microPixelEffectOpacity}computeBBox(){const{x,y,width:width2,height:height2,clipBBox}=this;return(clipBBox==null?void 0:clipBBox.clone())??new BBox(x,y,width2,height2)}isPointInPath(x,y){return this.hittester(x,y)}get midPoint(){return{x:this.x+this.width/2,y:this.y+this.height/2}}distanceSquared(x,y){return this.distanceCalculator(x,y)}applyFillAlpha(ctx){const{fillOpacity,microPixelEffectOpacity,opacity}=this;ctx.globalAlpha*=opacity*fillOpacity*microPixelEffectOpacity}renderStroke(ctx){const{stroke:stroke2,effectiveStrokeWidth}=this;if(stroke2&&effectiveStrokeWidth){const{globalAlpha}=ctx,{strokeOpacity,lineDash,lineDashOffset,lineCap,lineJoin,borderPath,borderClipPath,opacity,microPixelEffectOpacity}=this;borderClipPath&&ctx.clip(borderClipPath.getPath2D()),this.applyStroke(ctx),ctx.globalAlpha*=opacity*strokeOpacity*microPixelEffectOpacity,ctx.lineWidth=effectiveStrokeWidth,lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),ctx.stroke(borderPath.getPath2D()),ctx.globalAlpha=globalAlpha}}},__name(_a179,"Rect"),_a179);Rect.className="Rect";__decorateClass([ScenePathChangeDetection()],Rect.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"y",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"width",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"height",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topLeftCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topRightCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomRightCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomLeftCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"clipBBox",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"crisp",2);var _a180,Background=(_a180=class extends BaseModuleInstance{constructor(ctx){super(),this.ctx=ctx,this.rectNode=new Rect,this.textNode=new Text,this.fill="white",this.node=this.createNode(),this.node.append([this.rectNode,this.textNode]),this.visible=!0,this.destroyFns.push(ctx.scene.attachNode(this.node),ctx.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)))}createNode(){return new Group({name:"background",zIndex:0})}onLayoutComplete(e){const{width:width2,height:height2}=e.chart;this.rectNode.width=width2,this.rectNode.height=height2}},__name(_a180,"Background"),_a180);__decorateClass([TempValidate(),ProxyPropertyOnWrite("node","visible")],Background.prototype,"visible",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("rectNode","fill")],Background.prototype,"fill",2);__decorateClass([TempValidate()],Background.prototype,"image",2);__decorateClass([TempValidate(),ProxyPropertyOnWrite("textNode")],Background.prototype,"text",2);var BackgroundModule={type:"root",optionsKey:"background",packageType:"community",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:__name(ctx=>new Background(ctx),"moduleFactory")};function gridLayout({orientation,bboxes,maxHeight,maxWidth,itemPaddingY=0,itemPaddingX=0,forceResult=!1}){const horizontal=orientation==="horizontal",primary={max:horizontal?maxWidth:maxHeight,fn:horizontal?b=>b.width:b=>b.height,padding:horizontal?itemPaddingX:itemPaddingY},secondary={max:horizontal?maxHeight:maxWidth,fn:horizontal?b=>b.height:b=>b.width,padding:horizontal?itemPaddingY:itemPaddingX};let processedBBoxCount=0;const rawPages=[];for(;processedBBoxCount<bboxes.length;){const unprocessedBBoxes=bboxes.slice(processedBBoxCount),result=processBBoxes(unprocessedBBoxes,processedBBoxCount,primary,secondary,forceResult);if(!result)return;processedBBoxCount+=result.processedBBoxCount,rawPages.push(result.pageIndices)}return buildPages(rawPages,orientation,bboxes,itemPaddingY,itemPaddingX)}__name(gridLayout,"gridLayout");function processBBoxes(bboxes,indexOffset,primary,secondary,forceResult){let startingGuess=estimateStartingGuess(bboxes,primary);if(startingGuess<1){if(!forceResult)return;startingGuess=1}let guess=startingGuess;for(;guess>=1;){const pageIndices=calculatePage(bboxes,indexOffset,guess,primary,secondary,forceResult);if(pageIndices==null&&guess<=1)return;if(pageIndices==null){guess--;continue}if(typeof pageIndices=="number"){if(pageIndices<=1)return;guess=pageIndices<guess&&pageIndices>1?pageIndices:guess,guess--;continue}return{processedBBoxCount:pageIndices.length*pageIndices[0].length,pageIndices}}}__name(processBBoxes,"processBBoxes");function calculatePage(bboxes,indexOffset,primaryCount,primary,secondary,forceResult){const result=[];let sumSecondary=0,currentMaxSecondary=0,currentPrimaryIndices=[];const maxPrimaryValues=[];for(let bboxIndex=0;bboxIndex<bboxes.length;bboxIndex++){const primaryValueIdx=(bboxIndex+primaryCount)%primaryCount;primaryValueIdx===0&&(sumSecondary+=currentMaxSecondary,currentMaxSecondary=0,currentPrimaryIndices.length>0&&result.push(currentPrimaryIndices),currentPrimaryIndices=[]);const primaryValue=primary.fn(bboxes[bboxIndex])+primary.padding;maxPrimaryValues[primaryValueIdx]=Math.max(maxPrimaryValues[primaryValueIdx]??0,primaryValue),currentMaxSecondary=Math.max(currentMaxSecondary,secondary.fn(bboxes[bboxIndex])+secondary.padding);const currentSecondaryDimension=sumSecondary+currentMaxSecondary,returnResult=!forceResult||result.length>0;if(currentSecondaryDimension>secondary.max&&returnResult){currentPrimaryIndices=[];break}if(maxPrimaryValues.reduce((sum2,next)=>sum2+next,0)>primary.max&&!forceResult)return maxPrimaryValues.length<primaryCount?maxPrimaryValues.length:void 0;currentPrimaryIndices.push(bboxIndex+indexOffset)}return currentPrimaryIndices.length>0&&result.push(currentPrimaryIndices),result.length>0?result:void 0}__name(calculatePage,"calculatePage");function buildPages(rawPages,orientation,bboxes,itemPaddingY,itemPaddingX){let maxPageWidth=0,maxPageHeight=0;return{pages:rawPages.map(indices=>{orientation==="horizontal"&&(indices=transpose(indices));let endIndex=0;const columns=indices.map(colIndices=>{const colBBoxes=colIndices.map(bboxIndex=>(endIndex=Math.max(bboxIndex,endIndex),bboxes[bboxIndex]));let columnHeight=0,columnWidth=0;return colBBoxes.forEach(bbox=>{columnHeight+=bbox.height+itemPaddingY,columnWidth=Math.max(columnWidth,bbox.width+itemPaddingX)}),{indices:colIndices,bboxes:colBBoxes,columnHeight:Math.ceil(columnHeight),columnWidth:Math.ceil(columnWidth)}});let pageWidth=0,pageHeight=0;return columns.forEach(column=>{pageWidth+=column.columnWidth,pageHeight=Math.max(pageHeight,column.columnHeight)}),maxPageWidth=Math.max(pageWidth,maxPageWidth),maxPageHeight=Math.max(pageHeight,maxPageHeight),{columns,startIndex:indices[0][0],endIndex,pageWidth,pageHeight}}),maxPageWidth,maxPageHeight}}__name(buildPages,"buildPages");function transpose(data){const result=[];for(const _ of data[0])result.push([]);return data.forEach((innerData,dataIdx)=>{innerData.forEach((item,itemIdx)=>{result[itemIdx][dataIdx]=item})}),result}__name(transpose,"transpose");function estimateStartingGuess(bboxes,primary){const n=bboxes.length;let primarySum=0;for(let bboxIndex=0;bboxIndex<n;bboxIndex++)if(primarySum+=primary.fn(bboxes[bboxIndex])+primary.padding,primarySum>primary.max)return n/bboxIndex<2?Math.ceil(n/2):bboxIndex;return n}__name(estimateStartingGuess,"estimateStartingGuess");var _a181,PaginationLabel=(_a181=class extends BaseProperties{constructor(){super(...arguments),this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}},__name(_a181,"PaginationLabel"),_a181);__decorateClass([TempValidate()],PaginationLabel.prototype,"color",2);__decorateClass([TempValidate()],PaginationLabel.prototype,"fontStyle",2);__decorateClass([TempValidate()],PaginationLabel.prototype,"fontWeight",2);__decorateClass([TempValidate()],PaginationLabel.prototype,"fontSize",2);__decorateClass([TempValidate()],PaginationLabel.prototype,"fontFamily",2);var _a182,PaginationMarkerStyle=(_a182=class extends BaseProperties{constructor(){super(...arguments),this.size=15,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=1,this.strokeOpacity=1}},__name(_a182,"PaginationMarkerStyle"),_a182);__decorateClass([TempValidate()],PaginationMarkerStyle.prototype,"size",2);__decorateClass([TempValidate()],PaginationMarkerStyle.prototype,"fill",2);__decorateClass([TempValidate()],PaginationMarkerStyle.prototype,"fillOpacity",2);__decorateClass([TempValidate()],PaginationMarkerStyle.prototype,"stroke",2);__decorateClass([TempValidate()],PaginationMarkerStyle.prototype,"strokeWidth",2);__decorateClass([TempValidate()],PaginationMarkerStyle.prototype,"strokeOpacity",2);var _a183,PaginationMarker=(_a183=class extends BaseProperties{constructor(parent){super(),this.parent=parent,this.shape="triangle",this.size=15,this.padding=8}},__name(_a183,"PaginationMarker"),_a183);__decorateClass([ActionOnSet({changeValue(){this.parent.marker===this&&this.parent.onMarkerShapeChange()}})],PaginationMarker.prototype,"shape",2);__decorateClass([TempValidate()],PaginationMarker.prototype,"size",2);__decorateClass([TempValidate()],PaginationMarker.prototype,"padding",2);var _a184,Pagination=(_a184=class extends BaseProperties{constructor(chartUpdateCallback,pageUpdateCallback){super(),this.chartUpdateCallback=chartUpdateCallback,this.pageUpdateCallback=pageUpdateCallback,this.id=createId(this),this.marker=new PaginationMarker(this),this.activeStyle=new PaginationMarkerStyle,this.inactiveStyle=new PaginationMarkerStyle,this.highlightStyle=new PaginationMarkerStyle,this.label=new PaginationLabel,this.group=new TranslatableGroup({name:"pagination"}),this.labelNode=new Text,this.totalPages=0,this.currentPage=0,this.translationX=0,this.translationY=0,this.nextButtonDisabled=!1,this.previousButtonDisabled=!1,this._visible=!0,this._enabled=!0,this._orientation="vertical",this.nextButton=new Marker,this.previousButton=new Marker,this.labelNode.setProperties({textBaseline:"middle",fontSize:12,fontFamily:"Verdana, sans-serif",fill:"black",y:1}),this.group.append([this.nextButton,this.previousButton,this.labelNode]),this.update(),this.updateMarkers()}set visible(value){this._visible=value,this.updateGroupVisibility()}get visible(){return this._visible}set enabled(value){this._enabled=value,this.updateGroupVisibility()}get enabled(){return this._enabled}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible}set orientation(value){switch(this._orientation=value,value){case"horizontal":{this.previousButton.rotation=-Math.PI/2,this.nextButton.rotation=Math.PI/2;break}case"vertical":default:this.previousButton.rotation=0,this.nextButton.rotation=Math.PI}}get orientation(){return this._orientation}update(){this.updateLabel(),this.updatePositions(),this.enableOrDisableButtons()}updatePositions(){this.group.translationX=this.translationX,this.group.translationY=this.translationY,this.updateLabelPosition(),this.updateNextButtonPosition()}updateLabelPosition(){const{size:markerSize,padding:markerPadding}=this.marker;this.nextButton.size=markerSize,this.previousButton.size=markerSize,this.labelNode.x=markerSize/2+markerPadding}updateNextButtonPosition(){const labelBBox=this.labelNode.getBBox();this.nextButton.translationX=labelBBox.width+(this.marker.size/2+this.marker.padding)*2}updateLabel(){const{currentPage,totalPages:pages,labelNode,label:{color:color6,fontStyle,fontWeight,fontSize,fontFamily}}=this;labelNode.text=`${currentPage+1} / ${pages}`,labelNode.fill=color6,labelNode.fontStyle=fontStyle,labelNode.fontWeight=fontWeight,labelNode.fontSize=fontSize,labelNode.fontFamily=fontFamily}updateMarkers(){const{nextButton,previousButton,nextButtonDisabled,previousButtonDisabled,activeStyle,inactiveStyle,highlightStyle,highlightActive}=this,buttonStyle=__name((button,disabled)=>disabled?inactiveStyle:button===highlightActive?highlightStyle:activeStyle,"buttonStyle");this.updateMarker(nextButton,buttonStyle("next",nextButtonDisabled)),this.updateMarker(previousButton,buttonStyle("previous",previousButtonDisabled))}updateMarker(marker,style){const{shape,size}=this.marker;marker.shape=shape,marker.size=size,marker.fill=style.fill,marker.fillOpacity=style.fillOpacity??1,marker.stroke=style.stroke,marker.strokeWidth=style.strokeWidth,marker.strokeOpacity=style.strokeOpacity}enableOrDisableButtons(){const{currentPage,totalPages}=this,zeroPagesToDisplay=totalPages===0,onLastPage=currentPage===totalPages-1,onFirstPage=currentPage===0;this.nextButtonDisabled=onLastPage||zeroPagesToDisplay,this.previousButtonDisabled=onFirstPage||zeroPagesToDisplay}setPage(pageNumber){pageNumber=clamp(0,pageNumber,Math.max(0,this.totalPages-1)),this.currentPage!==pageNumber&&(this.currentPage=pageNumber,this.onPaginationChanged())}getCursor(node){return{previous:this.previousButtonDisabled,next:this.nextButtonDisabled}[node]?void 0:"pointer"}onClick(event,node){event.preventDefault(),node==="next"&&!this.nextButtonDisabled?(this.incrementPage(),this.onPaginationChanged()):node==="previous"&&!this.previousButtonDisabled&&(this.decrementPage(),this.onPaginationChanged())}onMouseHover(node){this.highlightActive=node,this.updateMarkers(),this.chartUpdateCallback(6)}onPaginationChanged(){this.pageUpdateCallback(this.currentPage)}incrementPage(){this.currentPage=Math.min(this.currentPage+1,this.totalPages-1)}decrementPage(){this.currentPage=Math.max(this.currentPage-1,0)}onMarkerShapeChange(){this.updatePositions(),this.updateMarkers(),this.chartUpdateCallback(6)}attachPagination(node){node.append(this.group)}getBBox(){return this.group.getBBox()}computeCSSBounds(){const prev=Transformable.toCanvas(this.previousButton),next=Transformable.toCanvas(this.nextButton);return{prev,next}}},__name(_a184,"Pagination"),_a184);Pagination.className="Pagination";__decorateClass([TempValidate()],Pagination.prototype,"marker",2);__decorateClass([TempValidate()],Pagination.prototype,"activeStyle",2);__decorateClass([TempValidate()],Pagination.prototype,"inactiveStyle",2);__decorateClass([TempValidate()],Pagination.prototype,"highlightStyle",2);__decorateClass([TempValidate()],Pagination.prototype,"label",2);var _a185,ChangeDetectableProperties=(_a185=class extends BaseProperties{constructor(){super(...arguments),this._dirty=!0}markDirty(){this._dirty=!0}markClean(_opts){this._dirty=!1}isDirty(){return this._dirty}},__name(_a185,"ChangeDetectableProperties"),_a185),MARKER_SUPPORTED_SHAPES=new Set(["circle","cross","diamond","heart","pin","plus","square","star","triangle"]);function isSupportedMarkerShape(shape){return typeof shape=="string"&&MARKER_SUPPORTED_SHAPES.has(shape)}__name(isSupportedMarkerShape,"isSupportedMarkerShape");var _a186,SeriesItemHighlightStyle=(_a186=class extends BaseProperties{constructor(){super(...arguments),this.fill="rgba(255,255,255, 0.33)",this.stroke="rgba(0, 0, 0, 0.4)",this.strokeWidth=2}},__name(_a186,"SeriesItemHighlightStyle"),_a186);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"fill",2);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"fillOpacity",2);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"stroke",2);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"strokeWidth",2);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"lineDash",2);__decorateClass([TempValidate()],SeriesItemHighlightStyle.prototype,"lineDashOffset",2);var _a187,SeriesHighlightStyle=(_a187=class extends BaseProperties{},__name(_a187,"SeriesHighlightStyle"),_a187);__decorateClass([TempValidate()],SeriesHighlightStyle.prototype,"strokeWidth",2);__decorateClass([TempValidate()],SeriesHighlightStyle.prototype,"dimOpacity",2);__decorateClass([TempValidate()],SeriesHighlightStyle.prototype,"enabled",2);var _a188,TextHighlightStyle=(_a188=class extends BaseProperties{constructor(){super(...arguments),this.color="black"}},__name(_a188,"TextHighlightStyle"),_a188);__decorateClass([TempValidate()],TextHighlightStyle.prototype,"color",2);var _a189,HighlightProperties=(_a189=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0}},__name(_a189,"HighlightProperties"),_a189);__decorateClass([TempValidate()],HighlightProperties.prototype,"enabled",2);var _a190,FillGradientDefaults=(_a190=class extends BaseProperties{constructor(){super(...arguments),this.type="gradient",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.reverse=!1}},__name(_a190,"FillGradientDefaults"),_a190);__decorateClass([TempValidate()],FillGradientDefaults.prototype,"type",2);__decorateClass([TempValidate()],FillGradientDefaults.prototype,"colorStops",2);__decorateClass([TempValidate()],FillGradientDefaults.prototype,"bounds",2);__decorateClass([TempValidate()],FillGradientDefaults.prototype,"gradient",2);__decorateClass([TempValidate()],FillGradientDefaults.prototype,"rotation",2);__decorateClass([TempValidate()],FillGradientDefaults.prototype,"reverse",2);var _a191,FillPatternDefaults=(_a191=class extends BaseProperties{constructor(){super(...arguments),this.type="pattern",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.reverse=!1,this.pattern="forward-slanted-lines",this.width=26,this.height=26,this.padding=6,this.fill="black",this.fillOpacity=1,this.backgroundFill="white",this.backgroundFillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0}},__name(_a191,"FillPatternDefaults"),_a191);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"type",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"colorStops",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"bounds",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"gradient",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"rotation",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"reverse",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"pattern",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"width",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"height",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"padding",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"fill",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"fillOpacity",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"backgroundFill",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"backgroundFillOpacity",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"stroke",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],FillPatternDefaults.prototype,"strokeWidth",2);var _a192,HighlightStyle=(_a192=class extends BaseProperties{constructor(){super(...arguments),this.item=new SeriesItemHighlightStyle,this.series=new SeriesHighlightStyle,this.text=new TextHighlightStyle}},__name(_a192,"HighlightStyle"),_a192);__decorateClass([TempValidate()],HighlightStyle.prototype,"item",2);__decorateClass([TempValidate()],HighlightStyle.prototype,"series",2);__decorateClass([TempValidate()],HighlightStyle.prototype,"text",2);var _a193,SeriesProperties=(_a193=class extends BaseProperties{constructor(){super(...arguments),this.visible=!0,this.focusPriority=1/0,this.showInLegend=!0,this.cursor="default",this.nodeClickRange="exact",this.highlight=new HighlightProperties,this.highlightStyle=new HighlightStyle}handleUnknownProperties(unknownKeys,properties){"context"in properties&&(this.context=properties.context,unknownKeys.delete("context"))}},__name(_a193,"SeriesProperties"),_a193);__decorateClass([TempValidate()],SeriesProperties.prototype,"id",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"visible",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"focusPriority",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"showInLegend",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"cursor",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"nodeClickRange",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"highlight",2);__decorateClass([TempValidate()],SeriesProperties.prototype,"highlightStyle",2);var MARKER_SHAPE=predicateWithMessage(value=>isSupportedMarkerShape(value)||typeof value=="function","a marker shape keyword such as 'circle', 'diamond' or 'square' or an object extending the Marker class"),_a194,SeriesMarker=(_a194=class extends ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.shape="circle",this.size=6,this.fillGradientDefaults=new FillGradientDefaults,this.fillPatternDefaults=new FillPatternDefaults,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{size,shape,fill,fillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,lineDash,lineDashOffset}=this;return{size,shape,fill,fillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,lineDash,lineDashOffset}}getDiameter(){return this.size+this.strokeWidth}},__name(_a194,"SeriesMarker"),_a194);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"enabled",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"shape",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"size",2);__decorateClass([TempValidate(OR(COLOR_STRING,COLOR_PATTERN,COLOR_GRADIENT)),SceneChangeDetection()],SeriesMarker.prototype,"fill",2);__decorateClass([TempValidate()],SeriesMarker.prototype,"fillGradientDefaults",2);__decorateClass([TempValidate()],SeriesMarker.prototype,"fillPatternDefaults",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"fillOpacity",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"stroke",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"strokeWidth",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],SeriesMarker.prototype,"lineDash",2);__decorateClass([TempValidate()],SeriesMarker.prototype,"lineDashOffset",2);__decorateClass([TempValidate(),SceneChangeDetection()],SeriesMarker.prototype,"itemStyler",2);var _a195,LegendDOMProxy=(_a195=class{constructor(ctx,idPrefix){this.idPrefix=idPrefix,this.dirty=!0,this.destroyFns=new DestroyFns,this.itemList=ctx.proxyInteractionService.createProxyContainer({type:"list",domManagerId:`${idPrefix}-toolbar`,classList:["ag-charts-proxy-legend-toolbar"],ariaLabel:{id:"ariaLabelLegend"}}),this.paginationGroup=ctx.proxyInteractionService.createProxyContainer({type:"group",domManagerId:`${idPrefix}-pagination`,classList:["ag-charts-proxy-legend-pagination"],ariaLabel:{id:"ariaLabelLegendPagination"},ariaOrientation:"horizontal"}),this.itemDescription=createElement("p"),this.itemDescription.style.display="none",this.itemDescription.id=`${idPrefix}-ariaDescription`,this.itemDescription.textContent=this.getItemAriaDescription(ctx.localeManager),this.itemList.getElement().append(this.itemDescription)}destroy(){this.destroyFns.destroy()}initLegendList(params){if(!this.dirty)return;const{ctx,itemSelection,datumReader,itemListener}=params,lm=ctx.localeManager,count=itemSelection.length;itemSelection.each((markerLabel,datum,index)=>{var _a294;(_a294=markerLabel.proxyButton)==null||_a294.destroy(),markerLabel.proxyButton=ctx.proxyInteractionService.createProxyElement({type:"listswitch",textContent:this.getItemAriaText(lm,datumReader.getItemLabel(datum),index,count),ariaChecked:!!markerLabel.datum.enabled,ariaDescribedBy:this.itemDescription.id,parent:this.itemList});const button=markerLabel.proxyButton;button.addListener("click",ev=>itemListener.onClick(ev.sourceEvent,markerLabel.datum,button)),button.addListener("dblclick",ev=>itemListener.onDoubleClick(ev.sourceEvent,markerLabel.datum)),button.addListener("mouseenter",ev=>itemListener.onHover(ev.sourceEvent,markerLabel)),button.addListener("mouseleave",()=>itemListener.onLeave()),button.addListener("contextmenu",ev=>itemListener.onContextClick(ev.sourceEvent,markerLabel)),button.addListener("blur",()=>itemListener.onLeave()),button.addListener("focus",ev=>itemListener.onHover(ev.sourceEvent,markerLabel)),button.addListener("drag-start",()=>{})}),this.dirty=!1}update(params){params.visible&&(this.initLegendList(params),this.updateItemProxyButtons(params),this.updatePaginationProxyButtons(params,!0)),this.updateVisibility(params.visible)}updateVisibility(visible){this.itemList.setHidden(!visible),this.paginationGroup.setHidden(!visible)}updateItemProxyButtons({itemSelection,group,pagination,interactive}){const groupBBox=Transformable.toCanvas(group);this.itemList.setBounds(groupBBox);const maxHeight=Math.max(...itemSelection.nodes().map(l=>l.getBBox().height));itemSelection.each((l,_datum)=>{if(l.proxyButton){const visible=l.pageIndex===pagination.currentPage,{x,y,height:height2,width:width2}=Transformable.toCanvas(l),margin=(maxHeight-height2)/2,bbox={x:x-groupBBox.x,y:y-margin-groupBBox.y,height:maxHeight,width:width2};l.proxyButton.setCursor("pointer"),l.proxyButton.setEnabled(interactive&&visible),l.proxyButton.setBounds(bbox)}})}updatePaginationProxyButtons(params,init){var _a294,_b,_c,_d,_e,_f,_g,_h;const{pagination}=params;if(this.paginationGroup.setHidden(!pagination.visible),init&&"ctx"in params){const{ctx,oldPages,newPages}=params,oldNeedsButtons=((oldPages==null?void 0:oldPages.length)??newPages.length)>1,newNeedsButtons=newPages.length>1;oldNeedsButtons!==newNeedsButtons&&(newNeedsButtons?(this.prevButton=ctx.proxyInteractionService.createProxyElement({type:"button",id:`${this.idPrefix}-prev-page`,textContent:{id:"ariaLabelLegendPagePrevious"},tabIndex:0,parent:this.paginationGroup}),this.prevButton.addListener("click",ev=>this.onPageButton(params,ev,"previous")),this.prevButton.addListener("mouseenter",()=>pagination.onMouseHover("previous")),this.prevButton.addListener("mouseleave",()=>pagination.onMouseHover(void 0)),this.nextButton??(this.nextButton=ctx.proxyInteractionService.createProxyElement({type:"button",id:`${this.idPrefix}-next-page`,textContent:{id:"ariaLabelLegendPageNext"},tabIndex:0,parent:this.paginationGroup})),this.nextButton.addListener("click",ev=>this.onPageButton(params,ev,"next")),this.nextButton.addListener("mouseenter",()=>pagination.onMouseHover("next")),this.nextButton.addListener("mouseleave",()=>pagination.onMouseHover(void 0))):((_a294=this.nextButton)==null||_a294.destroy(),(_b=this.prevButton)==null||_b.destroy(),this.nextButton=void 0,this.prevButton=void 0))}const{prev,next}=pagination.computeCSSBounds();(_c=this.prevButton)==null||_c.setBounds(prev),(_d=this.nextButton)==null||_d.setBounds(next),(_e=this.prevButton)==null||_e.setEnabled(pagination.currentPage!==0),(_f=this.nextButton)==null||_f.setEnabled(pagination.currentPage!==pagination.totalPages-1),(_g=this.nextButton)==null||_g.setCursor(pagination.getCursor("next")),(_h=this.prevButton)==null||_h.setCursor(pagination.getCursor("previous"))}onPageButton(params,ev,node){params.pagination.onClick(ev.sourceEvent,node),this.updatePaginationProxyButtons(params,!1)}onDataUpdate(oldData,newData){this.dirty=oldData.length!==newData.length||oldData.some((_v,index,_a294)=>{const[newValue,oldValue]=[newData[index],oldData[index]];return newValue.id!==oldValue.id})}onLocaleChanged(localeManager,itemSelection,datumReader){const count=itemSelection.length;itemSelection.each(({proxyButton},datum,index)=>{const button=proxyButton==null?void 0:proxyButton.getElement();if(button!=null){const label=datumReader.getItemLabel(datum);button.textContent=this.getItemAriaText(localeManager,label,index,count)}}),this.itemDescription.textContent=this.getItemAriaDescription(localeManager)}onPageChange(params){this.updateItemProxyButtons(params),this.updatePaginationProxyButtons(params,!1)}getItemAriaText(localeManager,label,index,count){return index>=0&&label?(index++,localeManager.t("ariaLabelLegendItem",{label,index,count})):localeManager.t("ariaLabelLegendItemUnknown")}getItemAriaDescription(localeManager){return localeManager.t("ariaDescriptionLegendItem")}},__name(_a195,"LegendDOMProxy"),_a195);function makeLegendItemEvent(type,itemId,seriesId,event){const result={defaultPrevented:!1,apiEvent:{type,itemId,seriesId,event,preventDefault:__name(()=>result.defaultPrevented=!0,"preventDefault")}};return result}__name(makeLegendItemEvent,"makeLegendItemEvent");var _a196,LegendMarkerLabel=(_a196=class extends Translatable(Group){constructor(){super({name:"markerLabelGroup"}),this.symbolsGroup=this.appendChild(new Group({name:"legend-markerLabel-symbols"})),this.label=this.appendChild(new Text),this.enabled=!0,this.pageIndex=NaN,this.spacing=0,this.length=0,this.isCustomMarker=!1,this.marker=this.symbolsGroup.appendChild(new Marker({zIndex:1})),this.line=this.symbolsGroup.appendChild(new Line({zIndex:0}));const{label,line,symbolsGroup}=this;line.visible=!1,symbolsGroup.renderToOffscreenCanvas=!0,symbolsGroup.optimizeForInfrequentRedraws=!0,label.textBaseline="middle",label.fontSize=12,label.fontFamily="Verdana, sans-serif",label.fill="black",label.y=1}destroy(){var _a294;super.destroy(),(_a294=this.proxyButton)==null||_a294.destroy()}setEnabled(enabled){this.enabled=enabled,this.refreshVisibilities()}refreshVisibilities(){const opacity=this.enabled?1:.5;this.label.opacity=opacity,this.opacity=opacity}layout(){const{marker,line,length:length2,isCustomMarker}=this;let centerTranslateX=0,centerTranslateY=0;if(marker.visible){const{size}=marker,anchor=Marker.anchor(marker.shape);centerTranslateX=(anchor.x-.5)*size+length2/2,centerTranslateY=(anchor.y-.5)*size,isCustomMarker?(marker.x=0,marker.y=0,marker.translationX=centerTranslateX,marker.translationY=centerTranslateY):(marker.x=centerTranslateX,marker.y=centerTranslateY,marker.translationX=0,marker.translationY=0)}line.visible&&(line.x1=0,line.x2=length2,line.y1=0,line.y2=0)}preRender(renderCtx){const out=super.preRender(renderCtx);return this.layout(),out}layoutLabel(){const{length:length2,spacing}=this;this.label.x=length2+spacing}computeBBox(){return this.layout(),super.computeBBox()}},__name(_a196,"LegendMarkerLabel"),_a196);LegendMarkerLabel.className="MarkerLabel";__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"text",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontStyle",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontWeight",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontSize",2);__decorateClass([ProxyPropertyOnWrite("label")],LegendMarkerLabel.prototype,"fontFamily",2);__decorateClass([ProxyPropertyOnWrite("label","fill")],LegendMarkerLabel.prototype,"color",2);__decorateClass([ObserveChanges(target=>target.layoutLabel())],LegendMarkerLabel.prototype,"spacing",2);__decorateClass([ObserveChanges(target=>target.layoutLabel())],LegendMarkerLabel.prototype,"length",2);__decorateClass([SceneChangeDetection()],LegendMarkerLabel.prototype,"isCustomMarker",2);var _a197,LegendLabel=(_a197=class extends BaseProperties{constructor(){super(...arguments),this.maxLength=void 0,this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}},__name(_a197,"LegendLabel"),_a197);__decorateClass([TempValidate()],LegendLabel.prototype,"maxLength",2);__decorateClass([TempValidate()],LegendLabel.prototype,"color",2);__decorateClass([TempValidate()],LegendLabel.prototype,"fontStyle",2);__decorateClass([TempValidate()],LegendLabel.prototype,"fontWeight",2);__decorateClass([TempValidate()],LegendLabel.prototype,"fontSize",2);__decorateClass([TempValidate()],LegendLabel.prototype,"fontFamily",2);__decorateClass([TempValidate()],LegendLabel.prototype,"formatter",2);var _a198,LegendMarker=(_a198=class extends BaseProperties{constructor(){super(...arguments),this.shape=void 0,this.size=15,this.padding=8}},__name(_a198,"LegendMarker"),_a198);__decorateClass([TempValidate()],LegendMarker.prototype,"shape",2);__decorateClass([TempValidate()],LegendMarker.prototype,"size",2);__decorateClass([TempValidate()],LegendMarker.prototype,"padding",2);__decorateClass([TempValidate()],LegendMarker.prototype,"strokeWidth",2);__decorateClass([TempValidate()],LegendMarker.prototype,"enabled",2);var _a199,LegendLine=(_a199=class extends BaseProperties{},__name(_a199,"LegendLine"),_a199);__decorateClass([TempValidate()],LegendLine.prototype,"strokeWidth",2);__decorateClass([TempValidate()],LegendLine.prototype,"length",2);var _a200,LegendItem=(_a200=class extends BaseProperties{constructor(){super(...arguments),this.paddingX=16,this.paddingY=8,this.showSeriesStroke=!1,this.marker=new LegendMarker,this.label=new LegendLabel,this.line=new LegendLine}},__name(_a200,"LegendItem"),_a200);__decorateClass([TempValidate()],LegendItem.prototype,"maxWidth",2);__decorateClass([TempValidate()],LegendItem.prototype,"paddingX",2);__decorateClass([TempValidate()],LegendItem.prototype,"paddingY",2);__decorateClass([TempValidate()],LegendItem.prototype,"showSeriesStroke",2);__decorateClass([TempValidate()],LegendItem.prototype,"marker",2);__decorateClass([TempValidate()],LegendItem.prototype,"label",2);__decorateClass([TempValidate()],LegendItem.prototype,"line",2);var _a201,LegendListeners=(_a201=class extends BaseProperties{},__name(_a201,"LegendListeners"),_a201);__decorateClass([TempValidate()],LegendListeners.prototype,"legendItemClick",2);__decorateClass([TempValidate()],LegendListeners.prototype,"legendItemDoubleClick",2);var ID_LEGEND_VISIBILITY="legend-visibility",ID_LEGEND_OTHER_SERIES="legend-other-series",fillGradientDefaults={bounds:"item",gradient:"linear",colorStops:[{color:"black"}],rotation:0,reverse:!1},fillPatternDefaults={pattern:"forward-slanted-lines",width:8,height:8,padding:1,fill:"black",fillOpacity:1,backgroundFill:"white",backgroundFillOpacity:1,stroke:"black",strokeOpacity:1,strokeWidth:0,rotation:0},_a202,Legend=(_a202=class extends BaseProperties{constructor(ctx){super(),this.ctx=ctx,this.id=createId(this),this.group=new TranslatableGroup({name:"legend",zIndex:14}),this.itemSelection=Selection.select(this.group,LegendMarkerLabel),this.oldSize=[0,0],this.pages=[],this.maxPageSize=[0,0],this.paginationTrackingIndex=0,this.truncatedItems=new Set,this._data=[],this.toggleSeries=!0,this.item=new LegendItem,this.listeners=new LegendListeners,this.enabled=!0,this.position="bottom",this.spacing=20,this.destroyFns=[],this.size=[0,0],this._visible=!0,this.pagination=new Pagination(type=>ctx.updateService.update(type),page=>this.updatePageNumber(page)),this.pagination.attachPagination(this.group),this.destroyFns.push(ctx.contextMenuRegistry.registerDefaultAction({id:ID_LEGEND_VISIBILITY,type:"legend",label:"contextMenuToggleSeriesVisibility",action:__name(params=>this.contextToggleVisibility(params),"action")}),ctx.contextMenuRegistry.registerDefaultAction({id:ID_LEGEND_OTHER_SERIES,type:"legend",label:"contextMenuToggleOtherSeries",action:__name(params=>this.contextToggleOtherSeries(params),"action")}),ctx.legendManager.addListener("legend-change",this.onLegendDataChange.bind(this))),this.destroyFns.push(ctx.layoutManager.registerElement(1,e=>this.positionLegend(e)),ctx.localeManager.addListener("locale-changed",()=>this.onLocaleChanged()),()=>this.group.remove()),this.domProxy=new LegendDOMProxy(this.ctx,this.id),this.ctx.historyManager.addMementoOriginator(ctx.legendManager)}set data(value){objectsEqual(value,this._data)||(this.domProxy.onDataUpdate(this._data,value),this._data=value,this.updateGroupVisibility())}get data(){return this._data}onLegendDataChange({legendData=[]}){this.enabled&&(this.data=legendData.filter(datum=>!datum.hideInLegend))}destroy(){this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-toolbar`),this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-pagination`),this.destroyFns.forEach(f=>f()),this.itemSelection.clear(),this.domProxy.destroy()}getOrientation(){return this.orientation??"horizontal"}set visible(value){this._visible=value,this.updateGroupVisibility()}get visible(){return this._visible}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible&&this.data.length>0}attachLegend(scene){scene.appendChild(this.group)}getItemLabel(datum){const{ctx:{callbackCache}}=this,{formatter}=this.item.label;if(formatter){const seriesDatum=datum.datum;return callbackCache.call(this,formatter,{itemId:datum.itemId,value:datum.label.text,seriesId:datum.seriesId,...seriesDatum&&{datum:seriesDatum}})}return datum.label.text}calcLayout(width2,height2){const{paddingX,paddingY,label,maxWidth,label:{maxLength=1/0,fontStyle,fontWeight,fontSize,fontFamily}}=this.item,data=[...this.data];this.reverseOrder&&data.reverse(),this.itemSelection.update(data);const bboxes=[],font2=TextUtils.toFontString(label),maxItemWidth=maxWidth??width2*.8,{markerWidth,anyLineEnabled}=this.calculateMarkerWidth();if(this.itemSelection.each((markerLabel,datum)=>{markerLabel.fontStyle=fontStyle,markerLabel.fontWeight=fontWeight,markerLabel.fontSize=fontSize,markerLabel.fontFamily=fontFamily;const paddedSymbolWidth=this.updateMarkerLabel(markerLabel,datum,markerWidth,anyLineEnabled),id=datum.itemId??datum.id,text2=(this.getItemLabel(datum)??"<unknown>").replace(/\r?\n/g," ");markerLabel.text=this.truncate(text2,maxLength,maxItemWidth,paddedSymbolWidth,font2,id),bboxes.push(markerLabel.getBBox())}),width2=Math.max(1,width2),height2=Math.max(1,height2),!isFinite(width2))return{};const size=this.size,oldSize=this.oldSize;size[0]=width2,size[1]=height2,(size[0]!==oldSize[0]||size[1]!==oldSize[1])&&(oldSize[0]=size[0],oldSize[1]=size[1]);const{pages,maxPageHeight,maxPageWidth}=this.updatePagination(bboxes,width2,height2),oldPages=this.pages;this.pages=pages,this.maxPageSize=[maxPageWidth-paddingX,maxPageHeight-paddingY];const pageNumber=this.pagination.currentPage,page=this.pages[pageNumber];return this.pages.length<1||!page?(this.visible=!1,{oldPages}):(this.visible=!0,this.updatePositions(pageNumber),this.update(),{oldPages})}isCustomMarker(markerEnabled,shape){return markerEnabled&&shape!==void 0&&typeof shape!="string"}calcSymbolsEnabled(symbol){const{showSeriesStroke,marker}=this.item,markerEnabled=!!marker.enabled||!showSeriesStroke||(symbol.marker.enabled??!0),lineEnabled=!!(symbol.line&&showSeriesStroke),isCustomMarker=this.isCustomMarker(markerEnabled,symbol.marker.shape);return{markerEnabled,lineEnabled,isCustomMarker}}calcSymbolsLengths(symbol,markerEnabled,lineEnabled){const{marker,line}=this.item;let customMarkerSize;const{shape}=symbol.marker;if(this.isCustomMarker(markerEnabled,shape)){const tmpShape=new Marker;tmpShape.shape=shape,tmpShape.updatePath();const bbox=tmpShape.getBBox();customMarkerSize=Math.max(bbox.width,bbox.height)}const markerLength=markerEnabled?marker.size:0,lineLength=lineEnabled?line.length??25:0;return{markerLength,lineLength,customMarkerSize}}calculateMarkerWidth(){let markerWidth=0,anyLineEnabled=!1;return this.itemSelection.each((_,datum)=>{const{symbol}=datum,{lineEnabled,markerEnabled}=this.calcSymbolsEnabled(symbol),{markerLength,lineLength,customMarkerSize=-1/0}=this.calcSymbolsLengths(symbol,markerEnabled,lineEnabled);markerWidth=Math.max(markerWidth,lineLength,customMarkerSize,markerLength),anyLineEnabled||(anyLineEnabled=lineEnabled)}),{markerWidth,anyLineEnabled}}updateMarkerLabel(markerLabel,datum,markerWidth,anyLineEnabled){const{marker:itemMarker,paddingX}=this.item,{symbol}=datum;let paddedSymbolWidth=paddingX;const{markerEnabled,isCustomMarker}=this.calcSymbolsEnabled(symbol),spacing=itemMarker.padding;(markerEnabled||anyLineEnabled)&&(paddedSymbolWidth+=spacing+markerWidth);const{marker,line}=markerLabel;return marker.visible=markerEnabled,marker.visible&&(marker.shape=itemMarker.shape??symbol.marker.shape??"square",marker.size=itemMarker.size,applyShapeStyle(marker,this.getMarkerStyles(symbol))),line.visible=anyLineEnabled,line.visible&&applyShapeStyle(line,this.getLineStyles(symbol)),markerLabel.length=markerWidth,markerLabel.spacing=spacing,markerLabel.isCustomMarker=isCustomMarker,paddedSymbolWidth}truncate(text2,maxCharLength,maxItemWidth,paddedMarkerWidth,font2,id){let addEllipsis=!1;text2.length>maxCharLength&&(text2=text2.substring(0,maxCharLength),addEllipsis=!0);const measurer2=CachedTextMeasurerPool.getMeasurer({font:font2}),result=TextWrapper.truncateLine(text2,measurer2,maxItemWidth-paddedMarkerWidth,addEllipsis);return result.endsWith(TextUtils.EllipsisChar)?this.truncatedItems.add(id):this.truncatedItems.delete(id),result}updatePagination(bboxes,width2,height2){const orientation=this.getOrientation(),trackingIndex=Math.min(this.paginationTrackingIndex,bboxes.length);this.pagination.orientation=orientation,this.pagination.translationX=0,this.pagination.translationY=0;const{pages,maxPageHeight,maxPageWidth,paginationBBox,paginationVertical}=this.calculatePagination(bboxes,width2,height2),newCurrentPage=pages.findIndex(p=>p.endIndex>=trackingIndex);this.pagination.currentPage=clamp(0,newCurrentPage,pages.length-1);const{paddingX:itemPaddingX,paddingY:itemPaddingY}=this.item,paginationComponentPadding=8,legendItemsWidth=maxPageWidth-itemPaddingX,legendItemsHeight=maxPageHeight-itemPaddingY;let paginationX=0,paginationY=-paginationBBox.y-this.item.marker.size/2;paginationVertical?paginationY+=legendItemsHeight+paginationComponentPadding:(paginationX+=-paginationBBox.x+legendItemsWidth+paginationComponentPadding,paginationY+=(legendItemsHeight-paginationBBox.height)/2),this.pagination.translationX=paginationX,this.pagination.translationY=paginationY,this.pagination.update(),this.pagination.updateMarkers();let pageIndex=0;return this.itemSelection.each((markerLabel,_,nodeIndex)=>{var _a294;nodeIndex>(((_a294=pages[pageIndex])==null?void 0:_a294.endIndex)??1/0)&&pageIndex++,markerLabel.pageIndex=pageIndex}),{maxPageHeight,maxPageWidth,pages}}calculatePagination(bboxes,width2,height2){const{paddingX:itemPaddingX,paddingY:itemPaddingY}=this.item,orientation=this.getOrientation(),paginationVertical=["left","right"].includes(this.position);let paginationBBox=this.pagination.getBBox(),lastPassPaginationBBox=new BBox(0,0,0,0),pages=[],maxPageWidth=0,maxPageHeight=0,count=0;const stableOutput=__name(bbox=>bbox.width===paginationBBox.width&&bbox.height===paginationBBox.height,"stableOutput"),forceResult=this.maxWidth!==void 0&&this.maxHeight!==void 0;do{if(count++>10){logger_exports.warn("unable to find stable legend layout.");break}paginationBBox=lastPassPaginationBBox;const maxWidth=width2-(paginationVertical?0:paginationBBox.width),maxHeight=height2-(paginationVertical?paginationBBox.height:0),layout=gridLayout({orientation,bboxes,maxHeight,maxWidth,itemPaddingY,itemPaddingX,forceResult});pages=(layout==null?void 0:layout.pages)??[],maxPageWidth=(layout==null?void 0:layout.maxPageWidth)??0,maxPageHeight=(layout==null?void 0:layout.maxPageHeight)??0;const totalPages=pages.length;if(this.pagination.visible=totalPages>1,this.pagination.totalPages=totalPages,this.pagination.update(),this.pagination.updateMarkers(),lastPassPaginationBBox=this.pagination.getBBox(),!this.pagination.visible)break}while(!stableOutput(lastPassPaginationBBox));return{maxPageWidth,maxPageHeight,pages,paginationBBox:lastPassPaginationBBox,paginationVertical}}updatePositions(pageNumber=0){const{item:{paddingY},itemSelection,pages}=this;if(pages.length<1||!pages[pageNumber])return;const{columns,startIndex:visibleStart,endIndex:visibleEnd}=pages[pageNumber];let x=0,y=0;const columnCount=columns.length,rowCount=columns[0].indices.length,horizontal=this.getOrientation()==="horizontal",itemHeight=columns[0].bboxes[0].height+paddingY,rowSumColumnWidths=[];itemSelection.each((markerLabel,_,i)=>{if(i<visibleStart||i>visibleEnd){markerLabel.visible=!1;return}const pageIndex=i-visibleStart;let columnIndex,rowIndex;horizontal?(columnIndex=pageIndex%columnCount,rowIndex=Math.floor(pageIndex/columnCount)):(columnIndex=Math.floor(pageIndex/rowCount),rowIndex=pageIndex%rowCount),markerLabel.visible=!0;const column=columns[columnIndex];column&&(y=Math.floor(itemHeight*rowIndex),x=Math.floor(rowSumColumnWidths[rowIndex]??0),rowSumColumnWidths[rowIndex]=(rowSumColumnWidths[rowIndex]??0)+column.columnWidth,markerLabel.translationX=x,markerLabel.translationY=y)})}updatePageNumber(pageNumber){const{itemSelection,group,pagination,pages,toggleSeries:interactive}=this,{startIndex,endIndex}=pages[pageNumber];startIndex===0?this.paginationTrackingIndex=0:pageNumber===pages.length-1?this.paginationTrackingIndex=endIndex:this.paginationTrackingIndex=Math.floor((startIndex+endIndex)/2),this.pagination.update(),this.pagination.updateMarkers(),this.updatePositions(pageNumber),this.domProxy.onPageChange({itemSelection,group,pagination,interactive}),this.ctx.updateService.update(6)}update(){const{label:{color:color6}}=this.item;this.itemSelection.each((markerLabel,datum)=>{markerLabel.setEnabled(datum.enabled),markerLabel.color=color6}),this.updateContextMenu()}updateContextMenu(){const{toggleSeries,ctx:{contextMenuRegistry}}=this;toggleSeries?(contextMenuRegistry.hideAction(ID_LEGEND_VISIBILITY),contextMenuRegistry.hideAction(ID_LEGEND_OTHER_SERIES)):(contextMenuRegistry.showAction(ID_LEGEND_VISIBILITY),contextMenuRegistry.showAction(ID_LEGEND_OTHER_SERIES))}getLineStyles(datum){const{stroke:stroke2,strokeOpacity=1,strokeWidth,lineDash}=datum.line??{},defaultLineStrokeWidth=Math.min(2,strokeWidth??1);return{stroke:stroke2,strokeOpacity,strokeWidth:this.item.line.strokeWidth??defaultLineStrokeWidth,lineDash}}getMarkerStyles({marker}){const{fill,stroke:stroke2,strokeOpacity=1,fillOpacity=1,strokeWidth,lineDash,lineDashOffset}=marker,defaultLineStrokeWidth=Math.min(2,strokeWidth??1);return isPatternFill(fill)&&(fill.width=8,fill.height=8,fill.padding=1,fill.strokeWidth=Math.min(2,fill.strokeWidth??2)),getShapeStyle({fill,stroke:stroke2,strokeOpacity,fillOpacity,strokeWidth:this.item.marker.strokeWidth??defaultLineStrokeWidth,lineDash,lineDashOffset},fillGradientDefaults,fillPatternDefaults)}computePagedBBox(){const actualBBox=Group.computeChildrenBBox(this.group.children());if(this.pages.length>1){const[maxPageWidth,maxPageHeight]=this.maxPageSize;actualBBox.height=Math.max(maxPageHeight,actualBBox.height),actualBBox.width=Math.max(maxPageWidth,actualBBox.width)}return actualBBox}findNode(params){const{datum,proxyButton}=this.itemSelection.select(ml=>{var _a294;return((_a294=ml.datum)==null?void 0:_a294.itemId)===params.itemId})[0]??{};if(datum===void 0||proxyButton===void 0)throw new Error(`AG Charts - Missing required properties { datum: ${datum}, proxyButton: ${JSON.stringify(proxyButton)} }`);return{datum,proxyButton}}contextToggleVisibility(params){const{datum,proxyButton}=this.findNode(params);this.doClick(params.event,datum,proxyButton)}contextToggleOtherSeries(params){this.doDoubleClick(params.event,this.findNode(params).datum)}onContextClick(sourceEvent,node){var _a294;const legendItem=node.datum;this.preventHidingAll&&((_a294=this.contextMenuDatum)!=null&&_a294.enabled)&&this.getVisibleItemCount()<=1?this.ctx.contextMenuRegistry.disableAction(ID_LEGEND_VISIBILITY):this.ctx.contextMenuRegistry.enableAction(ID_LEGEND_VISIBILITY);const{offsetX,offsetY}=sourceEvent,{x:canvasX,y:canvasY}=Transformable.toCanvasPoint(node,offsetX,offsetY);this.ctx.contextMenuRegistry.dispatchContext("legend",{sourceEvent,canvasX,canvasY},{legendItem})}onClick(event,datum,proxyButton){this.doClick(event,datum,proxyButton)&&event.preventDefault()}getVisibleItemCount(){return this.ctx.chartService.series.flatMap(s=>s.getLegendData("category")).filter(d=>d.enabled).length}doClick(event,datum,proxyButton){const{listeners:{legendItemClick},ctx:{chartService,highlightManager},preventHidingAll,toggleSeries}=this;if(!datum)return!1;const{legendType,seriesId,itemId,enabled}=datum,series=chartService.series.find(s=>s.id===seriesId);if(!series)return!1;let newEnabled=enabled;const clickEvent=makeLegendItemEvent("click",itemId,series.id,event);return legendItemClick==null||legendItemClick(clickEvent.apiEvent),clickEvent.defaultPrevented||(toggleSeries&&(newEnabled=!enabled,preventHidingAll&&!newEnabled&&this.getVisibleItemCount()<2&&(newEnabled=!0),proxyButton.setChecked(newEnabled),this.ctx.chartEventManager.legendItemClick(legendType,series,itemId,newEnabled,datum.legendItemName)),newEnabled?highlightManager.updateHighlight(this.id,{series,itemId,datum:void 0,datumIndex:void 0}):highlightManager.updateHighlight(this.id),this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0,skipAnimations:datum.skipAnimations??!1})),!0}onDoubleClick(event,datum){this.doDoubleClick(event,datum)&&event.preventDefault()}doDoubleClick(event,datum){const{listeners:{legendItemDoubleClick},ctx:{chartService},toggleSeries}=this;if(chartService.mode==="integrated"||!datum)return!1;const{legendType,id,itemId,seriesId}=datum,series=chartService.series.find(s=>s.id===id);if(!series)return!1;const doubleClickEvent=makeLegendItemEvent("dblclick",itemId,series.id,event);if(legendItemDoubleClick==null||legendItemDoubleClick(doubleClickEvent.apiEvent),doubleClickEvent.defaultPrevented)return!0;if(toggleSeries){const legendData=chartService.series.flatMap(s=>s.getLegendData("category"));let numVisibleItems=0;const visibleLegendItemNames=new Set;for(const d of legendData)d.enabled&&(numVisibleItems+=1,d.legendItemName!=null&&visibleLegendItemNames.add(d.legendItemName));visibleLegendItemNames.size>0&&(numVisibleItems=visibleLegendItemNames.size);const clickedItem=legendData.find(d=>d.itemId===itemId&&d.seriesId===seriesId);this.ctx.chartEventManager.legendItemDoubleClick(legendType,series,itemId,(clickedItem==null?void 0:clickedItem.enabled)??!1,numVisibleItems,clickedItem==null?void 0:clickedItem.legendItemName)}return this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),!0}toTooltipMeta(event,node){let point;return event instanceof FocusEvent?point=Transformable.toCanvas(node).computeCenter():(event.preventDefault(),point=Transformable.toCanvasPoint(node,event.offsetX,event.offsetY)),{canvasX:point.x,canvasY:point.y,showArrow:!1}}onHover(event,node){if(!this.enabled)throw new Error("AG Charts - onHover handler called on disabled legend");this.pagination.setPage(node.pageIndex);const datum=node.datum,series=datum?this.ctx.chartService.series.find(s=>s.id===(datum==null?void 0:datum.id)):void 0;if(datum&&this.truncatedItems.has(datum.itemId??datum.id)){const meta=this.toTooltipMeta(event,node);this.ctx.tooltipManager.updateTooltip(this.id,meta,[{type:"structured",title:this.getItemLabel(datum)}])}else this.ctx.tooltipManager.removeTooltip(this.id);datum!=null&&datum.enabled&&series?this.updateHighlight({series,itemId:datum==null?void 0:datum.itemId,datum:void 0,datumIndex:void 0}):this.updateHighlight()}onLeave(){this.ctx.tooltipManager.removeTooltip(this.id),this.updateHighlight()}updateHighlight(datum){this.ctx.interactionManager.isState(32)?this.ctx.highlightManager.updateHighlight(this.id,datum):this.ctx.interactionManager.isState(2)&&(this.pendingHighlightDatum=datum,this.ctx.animationManager.onBatchStop(()=>{this.ctx.highlightManager.updateHighlight(this.id,this.pendingHighlightDatum)}))}onLocaleChanged(){this.domProxy.onLocaleChanged(this.ctx.localeManager,this.itemSelection,this)}positionLegend(ctx){const oldPages=this.positionLegendScene(ctx);this.positionLegendDOM(oldPages)}positionLegendScene(ctx){if(!this.enabled||!this.data.length)return;const{layoutBox}=ctx,{x,y,width:width2,height:height2}=layoutBox,[legendWidth,legendHeight]=this.calculateLegendDimensions(layoutBox),{oldPages}=this.calcLayout(legendWidth,legendHeight),legendBBox=this.computePagedBBox(),calculateTranslationPerpendicularDimension=__name(()=>{switch(this.position){case"top":case"left":return 0;case"bottom":return height2-legendBBox.height;case"right":default:return width2-legendBBox.width}},"calculateTranslationPerpendicularDimension");if(this.visible){const legendPadding=this.spacing;let translationX,translationY;switch(this.position){case"top":case"bottom":translationX=(width2-legendBBox.width)/2,translationY=calculateTranslationPerpendicularDimension(),layoutBox.shrink(legendBBox.height+legendPadding,this.position);break;case"left":case"right":default:translationX=calculateTranslationPerpendicularDimension(),translationY=(height2-legendBBox.height)/2,layoutBox.shrink(legendBBox.width+legendPadding,this.position)}this.group.translationX=Math.floor(x+translationX-legendBBox.x),this.group.translationY=Math.floor(y+translationY-legendBBox.y)}return oldPages}positionLegendDOM(oldPages){const{ctx,itemSelection,pagination,pages:newPages,toggleSeries,group,listeners:{legendItemClick,legendItemDoubleClick}}=this,visible=this.visible&&this.enabled,interactive=toggleSeries||legendItemDoubleClick!=null||legendItemClick!=null;this.domProxy.update({visible,interactive,ctx,itemSelection,group,pagination,oldPages,newPages,datumReader:this,itemListener:this})}calculateLegendDimensions(shrinkRect){const{width:width2,height:height2}=shrinkRect,aspectRatio=width2/height2,maxCoefficient=.5,minHeightCoefficient=.2,minWidthCoefficient=.25;let legendWidth,legendHeight;switch(this.position){case"top":case"bottom":{const heightCoefficient=aspectRatio<1?Math.min(maxCoefficient,minHeightCoefficient*(1/aspectRatio)):minHeightCoefficient;legendWidth=this.maxWidth?Math.min(this.maxWidth,width2):width2,legendHeight=this.maxHeight?Math.min(this.maxHeight,height2):Math.round(height2*heightCoefficient);break}case"left":case"right":default:{const widthCoefficient=aspectRatio>1?Math.min(maxCoefficient,minWidthCoefficient*aspectRatio):minWidthCoefficient;legendWidth=this.maxWidth?Math.min(this.maxWidth,width2):Math.round(width2*widthCoefficient),legendHeight=this.maxHeight?Math.min(this.maxHeight,height2):height2}}return[legendWidth,legendHeight]}},__name(_a202,"Legend"),_a202);Legend.className="Legend";__decorateClass([TempValidate()],Legend.prototype,"toggleSeries",2);__decorateClass([TempValidate()],Legend.prototype,"pagination",2);__decorateClass([TempValidate()],Legend.prototype,"item",2);__decorateClass([TempValidate()],Legend.prototype,"listeners",2);__decorateClass([ObserveChanges((target,newValue,oldValue)=>{if(target.updateGroupVisibility(),newValue===oldValue)return;const{ctx:{legendManager,stateManager}}=target;oldValue===!1&&newValue===!0&&stateManager.restoreState(legendManager)}),TempValidate()],Legend.prototype,"enabled",2);__decorateClass([TempValidate()],Legend.prototype,"position",2);__decorateClass([TempValidate()],Legend.prototype,"maxWidth",2);__decorateClass([TempValidate()],Legend.prototype,"maxHeight",2);__decorateClass([TempValidate()],Legend.prototype,"reverseOrder",2);__decorateClass([TempValidate(UNION(["horizontal","vertical"],"an orientation"))],Legend.prototype,"orientation",2);__decorateClass([TempValidate()],Legend.prototype,"preventHidingAll",2);__decorateClass([TempValidate()],Legend.prototype,"spacing",2);var CommunityLegendModule={type:"legend",optionsKey:"legend",identifier:"category",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:__name(ctx=>new Legend(ctx),"moduleFactory"),packageType:"community",removable:"standalone-only"},constants_exports={};__export(constants_exports,{CARTESIAN_AXIS_TYPE:__name(()=>CARTESIAN_AXIS_TYPE,"CARTESIAN_AXIS_TYPE"),CARTESIAN_POSITION:__name(()=>CARTESIAN_POSITION,"CARTESIAN_POSITION"),FONT_SIZE:__name(()=>FONT_SIZE,"FONT_SIZE"),FONT_SIZE_RATIO:__name(()=>FONT_SIZE_RATIO,"FONT_SIZE_RATIO"),POLAR_AXIS_SHAPE:__name(()=>POLAR_AXIS_SHAPE,"POLAR_AXIS_SHAPE"),POLAR_AXIS_TYPE:__name(()=>POLAR_AXIS_TYPE,"POLAR_AXIS_TYPE")});var FONT_SIZE=(FONT_SIZE2=>(FONT_SIZE2[FONT_SIZE2.SMALLEST=8]="SMALLEST",FONT_SIZE2[FONT_SIZE2.SMALLER=10]="SMALLER",FONT_SIZE2[FONT_SIZE2.SMALL=12]="SMALL",FONT_SIZE2[FONT_SIZE2.MEDIUM=13]="MEDIUM",FONT_SIZE2[FONT_SIZE2.LARGE=14]="LARGE",FONT_SIZE2[FONT_SIZE2.LARGEST=17]="LARGEST",FONT_SIZE2))(FONT_SIZE||{}),FONT_SIZE_RATIO=(FONT_SIZE_RATIO2=>(FONT_SIZE_RATIO2[FONT_SIZE_RATIO2.SMALLEST=.6666666666666666]="SMALLEST",FONT_SIZE_RATIO2[FONT_SIZE_RATIO2.SMALLER=.8333333333333334]="SMALLER",FONT_SIZE_RATIO2[FONT_SIZE_RATIO2.SMALL=1]="SMALL",FONT_SIZE_RATIO2[FONT_SIZE_RATIO2.MEDIUM=1.0833333333333333]="MEDIUM",FONT_SIZE_RATIO2[FONT_SIZE_RATIO2.LARGE=1.1666666666666667]="LARGE",FONT_SIZE_RATIO2[FONT_SIZE_RATIO2.LARGEST=1.4166666666666667]="LARGEST",FONT_SIZE_RATIO2))(FONT_SIZE_RATIO||{}),CARTESIAN_POSITION=(CARTESIAN_POSITION2=>(CARTESIAN_POSITION2.TOP="top",CARTESIAN_POSITION2.RIGHT="right",CARTESIAN_POSITION2.BOTTOM="bottom",CARTESIAN_POSITION2.LEFT="left",CARTESIAN_POSITION2))(CARTESIAN_POSITION||{}),CARTESIAN_AXIS_TYPE=(CARTESIAN_AXIS_TYPE2=>(CARTESIAN_AXIS_TYPE2.CATEGORY="category",CARTESIAN_AXIS_TYPE2.GROUPED_CATEGORY="grouped-category",CARTESIAN_AXIS_TYPE2.ORDINAL_TIME="ordinal-time",CARTESIAN_AXIS_TYPE2.NUMBER="number",CARTESIAN_AXIS_TYPE2.TIME="time",CARTESIAN_AXIS_TYPE2.LOG="log",CARTESIAN_AXIS_TYPE2))(CARTESIAN_AXIS_TYPE||{}),POLAR_AXIS_TYPE=(POLAR_AXIS_TYPE2=>(POLAR_AXIS_TYPE2.ANGLE_CATEGORY="angle-category",POLAR_AXIS_TYPE2.ANGLE_NUMBER="angle-number",POLAR_AXIS_TYPE2.RADIUS_CATEGORY="radius-category",POLAR_AXIS_TYPE2.RADIUS_NUMBER="radius-number",POLAR_AXIS_TYPE2))(POLAR_AXIS_TYPE||{}),POLAR_AXIS_SHAPE=(POLAR_AXIS_SHAPE2=>(POLAR_AXIS_SHAPE2.CIRCLE="circle",POLAR_AXIS_SHAPE2.POLYGON="polygon",POLAR_AXIS_SHAPE2))(POLAR_AXIS_SHAPE||{}),symbols_exports={};__export(symbols_exports,{DEFAULT_ANNOTATION_HANDLE_FILL:__name(()=>DEFAULT_ANNOTATION_HANDLE_FILL,"DEFAULT_ANNOTATION_HANDLE_FILL"),DEFAULT_ANNOTATION_STATISTICS_COLOR:__name(()=>DEFAULT_ANNOTATION_STATISTICS_COLOR,"DEFAULT_ANNOTATION_STATISTICS_COLOR"),DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:__name(()=>DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,"DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE"),DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:__name(()=>DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,"DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL"),DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:__name(()=>DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,"DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE"),DEFAULT_ANNOTATION_STATISTICS_FILL:__name(()=>DEFAULT_ANNOTATION_STATISTICS_FILL,"DEFAULT_ANNOTATION_STATISTICS_FILL"),DEFAULT_ANNOTATION_STATISTICS_STROKE:__name(()=>DEFAULT_ANNOTATION_STATISTICS_STROKE,"DEFAULT_ANNOTATION_STATISTICS_STROKE"),DEFAULT_CAPTION_ALIGNMENT:__name(()=>DEFAULT_CAPTION_ALIGNMENT,"DEFAULT_CAPTION_ALIGNMENT"),DEFAULT_CAPTION_LAYOUT_STYLE:__name(()=>DEFAULT_CAPTION_LAYOUT_STYLE,"DEFAULT_CAPTION_LAYOUT_STYLE"),DEFAULT_FIBONACCI_STROKES:__name(()=>DEFAULT_FIBONACCI_STROKES,"DEFAULT_FIBONACCI_STROKES"),DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:__name(()=>DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,"DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL"),DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:__name(()=>DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,"DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR"),DEFAULT_GRIDLINE_ENABLED:__name(()=>DEFAULT_GRIDLINE_ENABLED,"DEFAULT_GRIDLINE_ENABLED"),DEFAULT_POLAR_SERIES_STROKE:__name(()=>DEFAULT_POLAR_SERIES_STROKE,"DEFAULT_POLAR_SERIES_STROKE"),DEFAULT_SEPARATION_LINES_COLOUR:__name(()=>DEFAULT_SEPARATION_LINES_COLOUR,"DEFAULT_SEPARATION_LINES_COLOUR"),DEFAULT_SHADOW_COLOUR:__name(()=>DEFAULT_SHADOW_COLOUR,"DEFAULT_SHADOW_COLOUR"),DEFAULT_SPARKLINE_CROSSHAIR_STROKE:__name(()=>DEFAULT_SPARKLINE_CROSSHAIR_STROKE,"DEFAULT_SPARKLINE_CROSSHAIR_STROKE"),DEFAULT_TEXTBOX_COLOR:__name(()=>DEFAULT_TEXTBOX_COLOR,"DEFAULT_TEXTBOX_COLOR"),DEFAULT_TEXTBOX_FILL:__name(()=>DEFAULT_TEXTBOX_FILL,"DEFAULT_TEXTBOX_FILL"),DEFAULT_TEXTBOX_STROKE:__name(()=>DEFAULT_TEXTBOX_STROKE,"DEFAULT_TEXTBOX_STROKE"),DEFAULT_TEXT_ANNOTATION_COLOR:__name(()=>DEFAULT_TEXT_ANNOTATION_COLOR,"DEFAULT_TEXT_ANNOTATION_COLOR"),DEFAULT_TOOLBAR_POSITION:__name(()=>DEFAULT_TOOLBAR_POSITION,"DEFAULT_TOOLBAR_POSITION"),IS_COMMUNITY:__name(()=>IS_COMMUNITY,"IS_COMMUNITY"),IS_DARK_THEME:__name(()=>IS_DARK_THEME,"IS_DARK_THEME"),IS_ENTERPRISE:__name(()=>IS_ENTERPRISE,"IS_ENTERPRISE"),PALETTE_ALT_DOWN_FILL:__name(()=>PALETTE_ALT_DOWN_FILL,"PALETTE_ALT_DOWN_FILL"),PALETTE_ALT_DOWN_STROKE:__name(()=>PALETTE_ALT_DOWN_STROKE,"PALETTE_ALT_DOWN_STROKE"),PALETTE_ALT_NEUTRAL_FILL:__name(()=>PALETTE_ALT_NEUTRAL_FILL,"PALETTE_ALT_NEUTRAL_FILL"),PALETTE_ALT_NEUTRAL_STROKE:__name(()=>PALETTE_ALT_NEUTRAL_STROKE,"PALETTE_ALT_NEUTRAL_STROKE"),PALETTE_ALT_UP_FILL:__name(()=>PALETTE_ALT_UP_FILL,"PALETTE_ALT_UP_FILL"),PALETTE_ALT_UP_STROKE:__name(()=>PALETTE_ALT_UP_STROKE,"PALETTE_ALT_UP_STROKE"),PALETTE_DOWN_FILL:__name(()=>PALETTE_DOWN_FILL,"PALETTE_DOWN_FILL"),PALETTE_DOWN_STROKE:__name(()=>PALETTE_DOWN_STROKE,"PALETTE_DOWN_STROKE"),PALETTE_NEUTRAL_FILL:__name(()=>PALETTE_NEUTRAL_FILL,"PALETTE_NEUTRAL_FILL"),PALETTE_NEUTRAL_STROKE:__name(()=>PALETTE_NEUTRAL_STROKE,"PALETTE_NEUTRAL_STROKE"),PALETTE_UP_FILL:__name(()=>PALETTE_UP_FILL,"PALETTE_UP_FILL"),PALETTE_UP_STROKE:__name(()=>PALETTE_UP_STROKE,"PALETTE_UP_STROKE")});var IS_DARK_THEME=Symbol("is-dark-theme"),IS_COMMUNITY=Symbol("is-community"),IS_ENTERPRISE=Symbol("is-enterprise"),DEFAULT_SEPARATION_LINES_COLOUR=Symbol("default-separation-lines-colour"),DEFAULT_SHADOW_COLOUR=Symbol("default-shadow-colour"),DEFAULT_CAPTION_LAYOUT_STYLE=Symbol("default-caption-layout-style"),DEFAULT_CAPTION_ALIGNMENT=Symbol("default-caption-alignment"),PALETTE_UP_STROKE=Symbol("palette-up-stroke"),PALETTE_DOWN_STROKE=Symbol("palette-down-stroke"),PALETTE_UP_FILL=Symbol("palette-up-fill"),PALETTE_DOWN_FILL=Symbol("palette-down-fill"),PALETTE_NEUTRAL_STROKE=Symbol("palette-neutral-stroke"),PALETTE_NEUTRAL_FILL=Symbol("palette-neutral-fill"),PALETTE_ALT_UP_STROKE=Symbol("palette-alt-up-stroke"),PALETTE_ALT_DOWN_STROKE=Symbol("palette-alt-down-stroke"),PALETTE_ALT_UP_FILL=Symbol("palette-alt-up-fill"),PALETTE_ALT_DOWN_FILL=Symbol("palette-alt-down-fill"),PALETTE_ALT_NEUTRAL_FILL=Symbol("palette-gray-fill"),PALETTE_ALT_NEUTRAL_STROKE=Symbol("palette-gray-stroke"),DEFAULT_POLAR_SERIES_STROKE=Symbol("default-polar-series-stroke"),DEFAULT_SPARKLINE_CROSSHAIR_STROKE=Symbol("default-sparkline-crosshair-stroke"),DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR=Symbol("default-financial-charts-annotation-stroke"),DEFAULT_FIBONACCI_STROKES=Symbol("default-hierarchy-strokes"),DEFAULT_TEXT_ANNOTATION_COLOR=Symbol("default-text-annotation-color"),DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL=Symbol("default-financial-charts-annotation-background-fill"),DEFAULT_ANNOTATION_HANDLE_FILL=Symbol("default-annotation-handle-fill"),DEFAULT_ANNOTATION_STATISTICS_FILL=Symbol("default-annotation-statistics-fill"),DEFAULT_ANNOTATION_STATISTICS_STROKE=Symbol("default-annotation-statistics-stroke"),DEFAULT_ANNOTATION_STATISTICS_COLOR=Symbol("default-annotation-statistics-color"),DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE=Symbol("default-annotation-statistics-divider-stroke"),DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL=Symbol("default-annotation-statistics-fill"),DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE=Symbol("default-annotation-statistics-stroke"),DEFAULT_TEXTBOX_FILL=Symbol("default-textbox-fill"),DEFAULT_TEXTBOX_STROKE=Symbol("default-textbox-stroke"),DEFAULT_TEXTBOX_COLOR=Symbol("default-textbox-color"),DEFAULT_TOOLBAR_POSITION=Symbol("default-toolbar-position"),DEFAULT_GRIDLINE_ENABLED=Symbol("default-gridline-enabled"),DIRECTION_SWAP_AXES=[{type:"number",position:{$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},"bottom","left"]}},{type:"category",position:{$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},"left","bottom"]}}],SAFE_FILL_OPERATION={$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]}]},{$palette:"fillFallback"},{$palette:"fill"}]},SAFE_FILLS_OPERATION={$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]}]},{$palette:"fillsFallback"},{$palette:"fills"}]},SAFE_STROKE_FILL_OPERATION={$if:[{$isGradient:[{$palette:"fill"}]},{$palette:"fillFallback"},{$if:[{$isPattern:[{$palette:"fill"}]},{$path:["./stroke",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},SAFE_RANGE2_OPERATION={$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]}]},[{$palette:"fillFallback"},{$palette:"fillFallback"}],{$palette:"range2"}]},FILL_PATTERN_DEFAULTS={type:"pattern",pattern:"forward-slanted-lines",width:10,height:10,padding:2,fill:{$if:[{$isGradient:[{$palette:"fill"}]},{$palette:"fillFallback"},{$if:[{$isPattern:[{$palette:"fill"}]},{$path:["./fill",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},fillOpacity:1,stroke:SAFE_STROKE_FILL_OPERATION,strokeOpacity:1,strokeWidth:4,backgroundFill:"transparent",backgroundFillOpacity:1,rotation:0};function getSequentialColors(colors){return mapValues(colors,value=>{const color6=Color.fromString(value);return[Color.darken(color6,.15).toString(),value,Color.lighten(color6,.15).toString()]})}__name(getSequentialColors,"getSequentialColors");function pathMotion(groupId,subId,animationManager,paths,fns){const{addPhaseFn,updatePhaseFn,removePhaseFn}=fns,animate=__name((phase,path,updateFn)=>{animationManager.animate({id:`${groupId}_${subId}_${path.id}_${phase}`,groupId,from:0,to:1,ease:easeOut,collapsable:!1,onUpdate(ratio5,preInit){preInit&&phase!=="removed"||(path.path.clear(!0),updateFn(ratio5,path),path.checkPathDirty())},onStop(){phase==="added"&&(path.path.clear(!0),updateFn(1,path),path.checkPathDirty())},phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]})},"animate");for(const path of paths)animationManager.isSkipped()||(animate("removed",path,removePhaseFn),animate("updated",path,updatePhaseFn)),animate("added",path,addPhaseFn)}__name(pathMotion,"pathMotion");function seriesLabelFadeInAnimation({id},subId,animationManager,...labelSelections){staticFromToMotion(id,subId,animationManager,labelSelections,{opacity:0},{opacity:1},{phase:"trailing"})}__name(seriesLabelFadeInAnimation,"seriesLabelFadeInAnimation");function seriesLabelFadeOutAnimation({id},subId,animationManager,...labelSelections){staticFromToMotion(id,subId,animationManager,labelSelections,{opacity:1},{opacity:0},{phase:"remove"})}__name(seriesLabelFadeOutAnimation,"seriesLabelFadeOutAnimation");function resetLabelFn(_node){return{opacity:1}}__name(resetLabelFn,"resetLabelFn");var _a203,DropShadow=(_a203=class extends ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.color="rgba(0, 0, 0, 0.5)",this.xOffset=0,this.yOffset=0,this.blur=5}},__name(_a203,"DropShadow"),_a203);__decorateClass([TempValidate(),SceneChangeDetection()],DropShadow.prototype,"enabled",2);__decorateClass([TempValidate(),SceneChangeDetection()],DropShadow.prototype,"color",2);__decorateClass([TempValidate(),SceneChangeDetection()],DropShadow.prototype,"xOffset",2);__decorateClass([TempValidate(),SceneChangeDetection()],DropShadow.prototype,"yOffset",2);__decorateClass([TempValidate(),SceneChangeDetection()],DropShadow.prototype,"blur",2);var _a204,SeriesTooltipInteraction=(_a204=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!1}},__name(_a204,"SeriesTooltipInteraction"),_a204);__decorateClass([TempValidate()],SeriesTooltipInteraction.prototype,"enabled",2);var _a205,SeriesTooltip=(_a205=class extends BaseProperties{constructor(){super(...arguments),this.interaction=new SeriesTooltipInteraction,this.position=new TooltipPosition,this.range=void 0,this.class=void 0}formatTooltip(caller,content,params){const overrides=this.renderer==null?void 0:callWithContext(caller,this.renderer,[params]);return typeof overrides=="string"?{type:"raw",rawHtmlString:overrides}:overrides!=null?{type:"structured",...content,...overrides}:{type:"structured",...content}}},__name(_a205,"SeriesTooltip"),_a205);__decorateClass([TempValidate()],SeriesTooltip.prototype,"enabled",2);__decorateClass([TempValidate()],SeriesTooltip.prototype,"showArrow",2);__decorateClass([TempValidate()],SeriesTooltip.prototype,"renderer",2);__decorateClass([TempValidate()],SeriesTooltip.prototype,"interaction",2);__decorateClass([TempValidate()],SeriesTooltip.prototype,"position",2);__decorateClass([TempValidate()],SeriesTooltip.prototype,"range",2);__decorateClass([TempValidate()],SeriesTooltip.prototype,"class",2);var _a206,QuadtreeNearest=(_a206=class{constructor(capacity,maxdepth,boundary){this.root=new QuadtreeNodeNearest(capacity,maxdepth,boundary)}clear(boundary){this.root.clear(boundary)}addValue(hitTester,value){const elem={hitTester,value,distanceSquared:__name((x,y)=>hitTester.distanceSquared(x,y),"distanceSquared")};this.root.addElem(elem)}find(x,y){const arg={best:{nearest:void 0,distanceSquared:1/0}};return this.root.find(x,y,arg),arg.best}},__name(_a206,"QuadtreeNearest"),_a206),_a207,QuadtreeSubdivisions=(_a207=class{constructor(nw,ne,sw,se){this.nw=nw,this.ne=ne,this.sw=sw,this.se=se}addElem(elem){this.nw.addElem(elem),this.ne.addElem(elem),this.sw.addElem(elem),this.se.addElem(elem)}find(x,y,arg){this.nw.find(x,y,arg),this.ne.find(x,y,arg),this.sw.find(x,y,arg),this.se.find(x,y,arg)}},__name(_a207,"QuadtreeSubdivisions"),_a207),_a208,QuadtreeNode=(_a208=class{constructor(capacity,maxdepth,boundary){this.capacity=capacity,this.maxdepth=maxdepth,this.boundary=boundary??BBox.NaN,this.elems=[],this.subdivisions=void 0}clear(boundary){this.elems.length=0,this.boundary=boundary,this.subdivisions=void 0}addElem(e){this.addCondition(e)&&(this.subdivisions===void 0?this.maxdepth===0||this.elems.length<this.capacity?this.elems.push(e):this.subdivide(e):this.subdivisions.addElem(e))}find(x,y,arg){this.findCondition(x,y,arg)&&(this.subdivisions===void 0?this.findAction(x,y,arg):this.subdivisions.find(x,y,arg))}subdivide(newElem){this.subdivisions=this.makeSubdivisions();for(const e of this.elems)this.subdivisions.addElem(e);this.subdivisions.addElem(newElem),this.elems.length=0}makeSubdivisions(){const{x,y,width:width2,height:height2}=this.boundary,{capacity}=this,depth=this.maxdepth-1,halfWidth=width2/2,halfHeight=height2/2,nwBoundary=new BBox(x,y,halfWidth,halfHeight),neBoundary=new BBox(x+halfWidth,y,halfWidth,halfHeight),swBoundary=new BBox(x,y+halfHeight,halfWidth,halfHeight),seBoundary=new BBox(x+halfWidth,y+halfHeight,halfWidth,halfHeight);return new QuadtreeSubdivisions(this.child(capacity,depth,nwBoundary),this.child(capacity,depth,neBoundary),this.child(capacity,depth,swBoundary),this.child(capacity,depth,seBoundary))}},__name(_a208,"QuadtreeNode"),_a208),_a209,QuadtreeNodeNearest=(_a209=class extends QuadtreeNode{addCondition(e){const{x,y}=e.hitTester.midPoint;return this.boundary.containsPoint(x,y)}findCondition(x,y,arg){const{best}=arg;return best.distanceSquared!==0&&this.boundary.distanceSquared(x,y)<best.distanceSquared}findAction(x,y,arg){const other=nearestSquared(x,y,this.elems,arg.best.distanceSquared);other.nearest!==void 0&&other.distanceSquared<arg.best.distanceSquared&&(arg.best=other)}child(capacity,depth,boundary){return new _a209(capacity,depth,boundary)}},__name(_a209,"_QuadtreeNodeNearest"),_a209),_a210,DataModelSeries=(_a210=class extends Series{constructor({clipFocusBox,categoryKey,...seriesOpts}){super(seriesOpts),this.categoryKey=categoryKey,this.clipFocusBox=clipFocusBox??!0}getScaleInformation({xScale,yScale}){const isContinuousX=ContinuousScale.is(xScale),isContinuousY=ContinuousScale.is(yScale);return{isContinuousX,isContinuousY,xScaleType:xScale==null?void 0:xScale.type,yScaleType:yScale==null?void 0:yScale.type}}getModulePropertyDefinitions(){var _a294,_b;const xScale=(_a294=this.axes.x)==null?void 0:_a294.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale;return this.moduleMap.mapModules(mod=>mod.getPropertyDefinitions(this.getScaleInformation({xScale,yScale}))).flat()}async requestDataModel(dataController,data,opts){opts.props.push(...this.getModulePropertyDefinitions());const{dataModel,processedData}=await dataController.request(this.id,data??[],opts);return this.dataModel=dataModel,this.processedData=processedData,this.dispatch("data-processed",{dataModel,processedData}),{dataModel,processedData}}isProcessedDataAnimatable(){var _a294,_b;const validationResults=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.animationValidation;if(!validationResults)return!0;const{orderedKeys,uniqueKeys}=validationResults;return orderedKeys&&uniqueKeys}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}pickFocus(opts){const nodeData=this.getNodeData();if(nodeData===void 0||nodeData.length===0)return;const datumIndex=this.computeFocusDatumIndex(opts,nodeData);if(datumIndex===void 0)return;const{clipFocusBox}=this,datum=nodeData[datumIndex],derivedOpts={...opts,datumIndex},bounds=this.computeFocusBounds(derivedOpts);if(bounds!==void 0)return{bounds,clipFocusBox,datum,datumIndex}}isDatumEnabled(nodeData,datumIndex){const{missing=!1,enabled=!0,focusable=!0}=nodeData[datumIndex];return!missing&&enabled&&focusable}computeFocusDatumIndex(opts,nodeData){const searchBackward=__name((datumIndex2,delta3)=>{for(;datumIndex2>=0&&!this.isDatumEnabled(nodeData,datumIndex2);)datumIndex2+=delta3;return datumIndex2===-1?void 0:datumIndex2},"searchBackward"),searchForward=__name((datumIndex2,delta3)=>{for(;datumIndex2<nodeData.length&&!this.isDatumEnabled(nodeData,datumIndex2);)datumIndex2+=delta3;return datumIndex2===nodeData.length?void 0:datumIndex2},"searchForward");let datumIndex;const clampedIndex=clamp(0,opts.datumIndex,nodeData.length-1);return opts.datumIndexDelta<0?datumIndex=searchBackward(clampedIndex,opts.datumIndexDelta):opts.datumIndexDelta>0?datumIndex=searchForward(clampedIndex,opts.datumIndexDelta):datumIndex=searchForward(clampedIndex,1)??searchBackward(clampedIndex,-1),datumIndex===void 0?opts.datumIndexDelta===0?void 0:opts.datumIndex-opts.datumIndexDelta:datumIndex}keysOrValues(xKey){var _a294,_b,_c;const key=this.dataModel.resolveProcessedDataIndexById(this,xKey);return((_b=(_a294=this.processedData)==null?void 0:_a294.keys[key])==null?void 0:_b.get(this.id))??((_c=this.processedData)==null?void 0:_c.columns[key])??[]}getCategoryKey(){return this.categoryKey}getCategoryValue(datumIndex){var _a294,_b;const{processedData,dataModel}=this,categoryKey=this.getCategoryKey();return!processedData||!dataModel||!categoryKey||(((_b=(_a294=processedData.invalidData)==null?void 0:_a294.get(this.id))==null?void 0:_b[datumIndex])??!1)?void 0:this.keysOrValues(categoryKey)[datumIndex]}datumIndexForCategoryValue(categoryValue){var _a294,_b;const{processedData,dataModel}=this,categoryKey=this.getCategoryKey();if(!processedData||!dataModel||!categoryKey)return;categoryValue=categoryValue.valueOf();const invalidValues=(_a294=processedData.invalidData)==null?void 0:_a294.get(this.id),xValues=this.keysOrValues(categoryKey);for(let datumIndex=0;datumIndex<xValues.length;datumIndex+=1){if((invalidValues==null?void 0:invalidValues[datumIndex])===!0)continue;const xValue=(_b=xValues[datumIndex])==null?void 0:_b.valueOf();if(objectsEqual(categoryValue,xValue))return datumIndex}}},__name(_a210,"DataModelSeries"),_a210),DEFAULT_CARTESIAN_DIRECTION_KEYS={x:["xKey"],y:["yKey"]},DEFAULT_CARTESIAN_DIRECTION_NAMES={x:["xName"],y:["yName"]},_a211,CartesianSeriesNodeEvent=(_a211=class extends SeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.xKey=series.properties.xKey,this.yKey=series.properties.yKey}},__name(_a211,"CartesianSeriesNodeEvent"),_a211),_a212,CartesianSeriesProperties=(_a212=class extends SeriesProperties{constructor(){super(...arguments),this.pickOutsideVisibleMinorAxis=!1}},__name(_a212,"CartesianSeriesProperties"),_a212);__decorateClass([TempValidate()],CartesianSeriesProperties.prototype,"legendItemName",2);__decorateClass([TempValidate()],CartesianSeriesProperties.prototype,"pickOutsideVisibleMinorAxis",2);var RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD=100,_a213,CartesianSeries=(_a213=class extends DataModelSeries{constructor({pathsPerSeries=["path"],hasMarkers=!1,hasHighlightedLabels=!1,pathsZIndexSubOrderOffset=[],datumSelectionGarbageCollection=!0,markerSelectionGarbageCollection=!0,animationAlwaysUpdateSelections=!1,animationResetFns,directionKeys,directionNames,...otherOpts}){if(super({directionKeys,directionNames,canHaveAxes:!0,...otherOpts}),this.NodeEvent=CartesianSeriesNodeEvent,this.dataNodeGroup=this.contentGroup.appendChild(new Group({name:`${this.id}-series-dataNodes`,zIndex:0})),this.markerGroup=this.contentGroup.appendChild(new Group({name:`${this.id}-series-markers`,zIndex:1})),this.labelGroup=this.contentGroup.appendChild(new TranslatableGroup({name:`${this.id}-series-labels`})),this.labelSelection=Selection.select(this.labelGroup,Text),this.highlightSelection=Selection.select(this.highlightNode,()=>this.opts.hasMarkers?new Marker:this.nodeFactory()),this.highlightLabelSelection=Selection.select(this.highlightLabel,Text),this.annotationSelections=new Set,this.debug=Debug.create(),!directionKeys||!directionNames)throw new Error(`Unable to initialise series type ${this.type}`);this.opts={pathsPerSeries,hasMarkers,hasHighlightedLabels,pathsZIndexSubOrderOffset,directionKeys,directionNames,animationResetFns,animationAlwaysUpdateSelections,datumSelectionGarbageCollection,markerSelectionGarbageCollection},this.paths=pathsPerSeries.map(path=>new Path({name:`${this.id}-${path}`})),this.datumSelection=Selection.select(this.dataNodeGroup,()=>this.nodeFactory(),datumSelectionGarbageCollection),this.markerSelection=Selection.select(this.markerGroup,Marker,markerSelectionGarbageCollection),this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(data=>this.animateEmptyUpdateReady(data),"action")},reset:"empty",skip:"ready",disable:"disabled"},ready:{updateData:"waiting",clear:"clearing",highlight:__name(data=>this.animateReadyHighlight(data),"highlight"),highlightMarkers:__name(data=>this.animateReadyHighlightMarkers(data),"highlightMarkers"),resize:__name(data=>this.animateReadyResize(data),"resize"),reset:"empty",skip:"ready",disable:"disabled"},waiting:{update:{target:"ready",action:__name(data=>{this.ctx.animationManager.isSkipped()?this.resetAllAnimation(data):this.animateWaitingUpdateReady(data)},"action")},reset:"empty",skip:"ready",disable:"disabled"},disabled:{update:__name(data=>this.resetAllAnimation(data),"update"),reset:"empty"},clearing:{update:{target:"empty",action:__name(data=>this.animateClearingUpdateEmpty(data),"action")},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}get contextNodeData(){return this._contextNodeData}getNodeData(){var _a294;return(_a294=this.contextNodeData)==null?void 0:_a294.nodeData}attachSeries(seriesContentNode,seriesNode,annotationNode){super.attachSeries(seriesContentNode,seriesNode,annotationNode),this.attachPaths(this.paths,seriesNode,annotationNode)}detachSeries(seriesContentNode,seriesNode,annotationNode){super.detachSeries(seriesContentNode,seriesNode,annotationNode),this.detachPaths(this.paths,seriesNode,annotationNode)}attachPaths(paths,_seriesNode,_annotationNode){for(const path of paths)this.contentGroup.appendChild(path)}detachPaths(paths,_seriesNode,_annotationNode){for(const path of paths)this.contentGroup.removeChild(path)}renderToOffscreenCanvas(){const nodeData=this.getNodeData();return nodeData!=null&&nodeData.length>RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"?this.animationState.transition("skip"):phase==="disabled"&&this.animationState.transition("disable")}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",event=>this.onLegendItemClick(event)),this.ctx.chartEventManager.addListener("legend-item-double-click",event=>this.onLegendItemDoubleClick(event)))}destroy(){super.destroy(),this._contextNodeData=void 0}update({seriesRect}){var _a294,_b;const{visible,_contextNodeData:previousContextData}=this,seriesHighlighted=((_b=(_a294=this.ctx.highlightManager)==null?void 0:_a294.getActiveHighlight())==null?void 0:_b.series)===this,resize=this.checkResize(seriesRect),highlightItems=this.updateHighlightSelection(seriesHighlighted);this.updateSelections(visible),this.updateNodes(highlightItems,seriesHighlighted,visible);const animationData=this.getAnimationData(seriesRect,previousContextData);animationData&&(resize&&this.animationState.transition("resize",animationData),this.animationState.transition("update",animationData))}updateSelections(anySeriesItemEnabled){var _a294;const animationSkipUpdate=!this.opts.animationAlwaysUpdateSelections&&this.ctx.animationManager.isSkipped();if(!(!anySeriesItemEnabled&&animationSkipUpdate)&&!(!this.nodeDataRefresh&&!this.isPathOrSelectionDirty())){if(this.nodeDataRefresh){this.nodeDataRefresh=!1,this.debug("CartesianSeries.updateSelections() - calling createNodeData() for",this.id),this.markQuadtreeDirty(),this._contextNodeData=this.createNodeData();const animationValid=this.isProcessedDataAnimatable();this._contextNodeData&&((_a294=this._contextNodeData).animationValid??(_a294.animationValid=animationValid));const{dataModel,processedData}=this;dataModel!==void 0&&processedData!==void 0&&this.dispatch("data-update",{dataModel,processedData})}this.updateSeriesSelections()}}updateSeriesSelections(seriesHighlighted){const{datumSelection,labelSelection,markerSelection,paths}=this,contextData=this._contextNodeData;if(!contextData)return;const{nodeData,labelData,itemId}=contextData;this.updatePaths({seriesHighlighted,itemId,contextData,paths}),this.datumSelection=this.updateDatumSelection({nodeData,datumSelection}),this.labelSelection=this.updateLabelSelection({labelData,labelSelection})??labelSelection,this.opts.hasMarkers&&(this.markerSelection=this.updateMarkerSelection({nodeData,markerSelection}))}getShapeFillBBox(){const{axes}=this,xAxis=axes.x,yAxis=axes.y,[axisX1,axisX2]=findMinMax((xAxis==null?void 0:xAxis.range)??[0,1]),[axisY1,axisY2]=findMinMax((yAxis==null?void 0:yAxis.range)??[0,1]),xSeriesDomain=this.getSeriesDomain("x"),xSeriesRange=[xAxis==null?void 0:xAxis.scale.convert(xSeriesDomain.at(0)),xAxis==null?void 0:xAxis.scale.convert(xSeriesDomain.at(-1))],ySeriesDomain=this.getSeriesDomain("y"),ySeriesRange=[yAxis==null?void 0:yAxis.scale.convert(ySeriesDomain.at(0)),yAxis==null?void 0:yAxis.scale.convert(ySeriesDomain.at(-1))],[seriesX1,seriesX2]=findMinMax(xSeriesRange),[seriesY1,seriesY2]=findMinMax(ySeriesRange);return{axis:new BBox(axisX1,axisY1,axisX2-axisX1,axisY2-axisY1),series:new BBox(seriesX1,seriesY1,seriesX2-seriesX1,seriesY2-seriesY1)}}updateNodes(highlightedItems,seriesHighlighted,anySeriesItemEnabled){const{highlightSelection,highlightLabelSelection,opts:{hasMarkers,hasHighlightedLabels}}=this,animationEnabled=!this.ctx.animationManager.isSkipped(),visible=this.visible&&this._contextNodeData!=null&&anySeriesItemEnabled;this.contentGroup.visible=animationEnabled||visible,this.highlightGroup.visible=(animationEnabled||visible)&&seriesHighlighted;const opacity=this.getOpacity();hasMarkers?(this.updateMarkerNodes({markerSelection:highlightSelection,isHighlight:!0}),this.animationState.transition("highlightMarkers",highlightSelection)):(this.updateDatumNodes({datumSelection:highlightSelection,isHighlight:!0}),this.animationState.transition("highlight",highlightSelection)),hasHighlightedLabels&&this.updateLabelNodes({labelSelection:highlightLabelSelection});const{dataNodeGroup,markerGroup,datumSelection,labelSelection,markerSelection,paths,labelGroup}=this,{itemId}=this.contextNodeData??{};dataNodeGroup.opacity=opacity,dataNodeGroup.visible=animationEnabled||visible,labelGroup.visible=visible,hasMarkers&&(markerGroup.opacity=opacity,markerGroup.visible=visible),labelGroup&&(labelGroup.opacity=opacity),this.updatePathNodes({seriesHighlighted,itemId,paths,opacity,visible,animationEnabled}),dataNodeGroup.visible&&(this.updateDatumNodes({datumSelection,highlightedItems,isHighlight:!1}),this.usesPlacedLabels||this.updateLabelNodes({labelSelection}),hasMarkers&&this.updateMarkerNodes({markerSelection,isHighlight:!1}))}getHighlightLabelData(labelData,highlightedItem){const labelItems=labelData.filter(ld=>ld.datum===highlightedItem.datum&&ld.itemId===highlightedItem.itemId);return labelItems.length===0?void 0:labelItems}getHighlightData(_nodeData,highlightedItem){return highlightedItem?[highlightedItem]:void 0}updateHighlightSelection(seriesHighlighted){var _a294;const{highlightSelection,highlightLabelSelection,_contextNodeData:contextNodeData}=this;if(!contextNodeData)return;const highlightedDatum=(_a294=this.ctx.highlightManager)==null?void 0:_a294.getActiveHighlight(),item=seriesHighlighted&&(highlightedDatum!=null&&highlightedDatum.datum)?highlightedDatum:void 0;let labelItems,highlightItems;if(item!=null){const labelsEnabled=this.isLabelEnabled(),{labelData,nodeData}=contextNodeData;highlightItems=this.getHighlightData(nodeData,item),labelItems=labelsEnabled?this.getHighlightLabelData(labelData,item):void 0}return this.highlightSelection=this.updateHighlightSelectionItem({items:highlightItems,highlightSelection}),this.highlightLabelSelection=this.updateHighlightSelectionLabel({items:labelItems,highlightLabelSelection}),highlightItems}markQuadtreeDirty(){this.quadtree=void 0}*datumNodesIter(){for(const{node}of this.datumSelection)node.datum.missing!==!0&&(yield node)}getQuadTree(){if(this.quadtree===void 0){const{width:width2,height:height2}=this.ctx.scene.canvas,canvasRect=new BBox(0,0,width2,height2);this.quadtree=new QuadtreeNearest(100,10,canvasRect),this.initQuadTree(this.quadtree)}return this.quadtree}initQuadTree(_quadtree){}pickNodesExactShape(point){const result=super.pickNodesExactShape(point);if(result.length!==0)return result;const{x,y}=point,{opts:{hasMarkers}}=this,{dataNodeGroup,markerGroup}=this;let matches=dataNodeGroup.pickNodes(x,y).filter(match=>match.datum.missing!==!0);if(matches.length===0&&hasMarkers&&(matches=markerGroup==null?void 0:markerGroup.pickNodes(x,y).filter(match=>match.datum.missing!==!0)),matches.length!==0)return matches.map(match=>match.datum);for(const mod of this.moduleMap.modules()){const{datum}=mod.pickNodeExact(point)??{};if(datum!=null&&(datum==null?void 0:datum.missing)!==!0)return[datum]}return[]}pickNodeClosestDatum(point){var _a294;const{x,y}=point,{axes,_contextNodeData:contextNodeData}=this;if(!contextNodeData)return;const xAxis=axes.x,yAxis=axes.y,hitPoint={x,y};let minDistance=1/0,closestDatum;for(const datum of contextNodeData.nodeData){const{point:{x:datumX=NaN,y:datumY=NaN}={}}=datum;if(isNaN(datumX)||isNaN(datumY)||!((xAxis==null?void 0:xAxis.inRange(datumX))&&(yAxis==null?void 0:yAxis.inRange(datumY))))continue;const distance2=Math.max((hitPoint.x-datumX)**2+(hitPoint.y-datumY)**2,0);distance2<minDistance&&(minDistance=distance2,closestDatum=datum)}for(const mod of this.moduleMap.modules()){const modPick=mod.pickNodeNearest(point);if(modPick!==void 0&&modPick.distanceSquared<minDistance){minDistance=modPick.distanceSquared,closestDatum=modPick.datum;break}}if(closestDatum){const distance2=Math.max(Math.sqrt(minDistance)-(((_a294=closestDatum.point)==null?void 0:_a294.size)??0)/2,0);return{datum:closestDatum,distance:distance2}}}pickNodeMainAxisFirst(point,requireCategoryAxis){var _a294;const{x,y}=point,{axes,_contextNodeData:contextNodeData}=this,{pickOutsideVisibleMinorAxis}=this.properties;if(!contextNodeData)return;const xAxis=axes.x,yAxis=axes.y,directions2=[xAxis,yAxis].filter(CategoryAxis.is).map(a=>a.direction);if(requireCategoryAxis&&directions2.length===0)return;const[majorDirection="x"]=directions2,hitPointCoords=[x,y];majorDirection!=="x"&&hitPointCoords.reverse();const minDistance=[1/0,1/0];let closestDatum;for(const datum of contextNodeData.nodeData){const{x:datumX=NaN,y:datumY=NaN}=datum.point??datum.midPoint??{};if(isNaN(datumX)||isNaN(datumY)||datum.missing===!0)continue;const visible=[xAxis==null?void 0:xAxis.inRange(datumX),yAxis==null?void 0:yAxis.inRange(datumY)];if(majorDirection!=="x"&&visible.reverse(),!visible[0]||!pickOutsideVisibleMinorAxis&&!visible[1])continue;const datumPoint=[datumX,datumY];majorDirection!=="x"&&datumPoint.reverse();let newMinDistance=!0;for(let i=0;i<datumPoint.length;i++){const dist=Math.abs(datumPoint[i]-hitPointCoords[i]);if(dist>minDistance[i]){newMinDistance=!1;break}else dist<minDistance[i]&&(minDistance[i]=dist,minDistance.fill(1/0,i+1,minDistance.length))}newMinDistance&&(closestDatum=datum)}if(closestDatum){let closestDistanceSquared=Math.max(minDistance[0]**2+minDistance[1]**2-(((_a294=closestDatum.point)==null?void 0:_a294.size)??0),0);for(const mod of this.moduleMap.modules()){const modPick=mod.pickNodeMainAxisFirst(point);if(modPick!==void 0&&modPick.distanceSquared<closestDistanceSquared){closestDatum=modPick.datum,closestDistanceSquared=modPick.distanceSquared;break}}return{datum:closestDatum,distance:Math.sqrt(closestDistanceSquared)}}}isPathOrSelectionDirty(){return!1}shouldFlipXY(){return!1}visibleRange(axisKey,visibleRange,indices){const xValues=this.keysOrValues(axisKey),pixelSize=0;return visibleRangeIndices((indices==null?void 0:indices.length)??xValues.length,visibleRange,topIndex=>{const datumIndex=(indices==null?void 0:indices[topIndex])??topIndex;return this.xCoordinateRange(xValues[datumIndex],pixelSize,datumIndex)})}domainForVisibleRange(_direction,axisKeys,crossAxisKey,visibleRange,sorted,indices){const{processedData,dataModel}=this,[r0,r1]=visibleRange,crossAxisValues=this.keysOrValues(crossAxisKey);if(sorted){const crossAxisRange=this.visibleRange(crossAxisKey,visibleRange,indices);return dataModel.getDomainBetweenRange(this,axisKeys,crossAxisRange,processedData)}const allAxisValues=axisKeys.map(axisKey=>this.keysOrValues(axisKey));let axisMin=1/0,axisMax=-1/0;return crossAxisValues.forEach((crossAxisValue,i)=>{const[x0,x1]=this.xCoordinateRange(crossAxisValue,0,i);if(!(x1<r0||x0>r1))for(let j=0;j<axisKeys.length;j++){const axisValue=allAxisValues[j][i];axisMin=Math.min(axisMin,axisValue),axisMax=Math.max(axisMax,axisValue)}}),axisMin>axisMax?[NaN,NaN]:[axisMin,axisMax]}domainForClippedRange(direction,axisKeys,crossAxisKey,sorted){const{processedData,dataModel,axes}=this,crossAxisRange=axisExtent(axes[direction==="x"?"y":"x"]);if(!crossAxisRange)return axisKeys.flatMap(axisKey=>dataModel.getDomain(this,axisKey,"value",processedData));const crossAxisValues=this.keysOrValues(crossAxisKey);if(sorted){const crossRange=clippedRangeIndices(crossAxisValues.length,crossAxisRange,index=>crossAxisValues[index]);return dataModel.getDomainBetweenRange(this,axisKeys,crossRange,processedData)}const allAxisValues=axisKeys.map(axisKey=>this.keysOrValues(axisKey)),range0=crossAxisRange[0].valueOf(),range1=crossAxisRange[1].valueOf(),axisValues=[];return crossAxisValues.forEach((crossAxisValue,i)=>{const c=crossAxisValue.valueOf();if(c<range0||c>range1)return;const values=allAxisValues.map(v=>v[i]);c>=range0&&axisValues.push(...values),c<=range1&&axisValues.push(...values)}),axisValues}countVisibleItems(crossAxisKey,axisKeys,xVisibleRange,yVisibleRange,minVisibleItems){const{dataModel,processedData}=this;if(!dataModel||!processedData)return 1/0;const crossValues=this.keysOrValues(crossAxisKey),allAxisValues=axisKeys.map(axisKey=>dataModel.resolveColumnById(this,axisKey,processedData)),crossAxis=this.axes.x,axis=this.axes.y,shouldFlipXY=this.shouldFlipXY(),crossRange=crossAxis.range,range3=axis.range,convert=__name((d,r,v)=>d[0]+(v-r[0])/(r[1]-r[0])*(d[1]-d[0]),"convert"),crossMin=convert(crossRange,crossAxis.visibleRange,xVisibleRange[0]),crossMax=convert(crossRange,crossAxis.visibleRange,xVisibleRange[1]),axisMin=convert(range3,axis.visibleRange,shouldFlipXY?yVisibleRange[0]:yVisibleRange[1]),axisMax=convert(range3,axis.visibleRange,shouldFlipXY?yVisibleRange[1]:yVisibleRange[0]),startIndex=Math.round((xVisibleRange[0]+(xVisibleRange[1]-xVisibleRange[0])/2)*crossValues.length),pixelSize=0;return countExpandingSearch(0,crossValues.length-1,startIndex,minVisibleItems,index=>{let[x0,x1]=this.xCoordinateRange(crossValues[index],pixelSize,index),[y0,y1]=this.yCoordinateRange(allAxisValues.map(axisValues=>axisValues[index]),pixelSize,index);return!isFiniteNumber(x0)||!isFiniteNumber(x1)||!isFiniteNumber(y0)||!isFiniteNumber(y1)?!1:(shouldFlipXY&&([x0,x1,y0,y1]=[y0,y1,x0,x1]),x0>=crossMin&&x1<=crossMax&&y0>=axisMin&&y1<=axisMax)})}updateHighlightSelectionItem(opts){const{opts:{hasMarkers}}=this,{items,highlightSelection}=opts,nodeData=items??[];if(hasMarkers){const markerSelection=highlightSelection;return this.updateMarkerSelection({nodeData,markerSelection})}else return this.updateDatumSelection({nodeData,datumSelection:highlightSelection})}updateHighlightSelectionLabel(opts){return this.updateLabelSelection({labelData:opts.items??[],labelSelection:opts.highlightLabelSelection})}updateDatumSelection(opts){return opts.datumSelection}updateDatumNodes(_opts){}updateMarkerSelection(opts){return opts.markerSelection}updateMarkerNodes(_opts){}updatePaths(opts){opts.paths.forEach(p=>p.visible=!1)}updatePathNodes(opts){const{paths,opacity,visible}=opts;for(const path of paths)path.opacity=opacity,path.visible=visible}resetPathAnimation(data){var _a294;const{path}=((_a294=this.opts)==null?void 0:_a294.animationResetFns)??{};path&&data.paths.forEach(paths=>{resetMotion([paths],path)})}resetDatumAnimation(data){var _a294;const{datum}=((_a294=this.opts)==null?void 0:_a294.animationResetFns)??{};datum&&resetMotion([data.datumSelection],datum)}resetLabelAnimation(data){var _a294;const{label}=((_a294=this.opts)==null?void 0:_a294.animationResetFns)??{};label&&resetMotion([data.labelSelection],label)}resetMarkerAnimation(data){var _a294;const{marker}=((_a294=this.opts)==null?void 0:_a294.animationResetFns)??{};marker&&this.opts.hasMarkers&&resetMotion([data.markerSelection],marker)}resetAllAnimation(data){var _a294;this.ctx.animationManager.stopByAnimationGroupId(this.id),this.resetPathAnimation(data),this.resetDatumAnimation(data),this.resetLabelAnimation(data),this.resetMarkerAnimation(data),((_a294=data.contextData)==null?void 0:_a294.animationValid)===!1&&this.ctx.animationManager.skipCurrentBatch()}animateEmptyUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateWaitingUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateReadyHighlight(data){var _a294;const{datum}=((_a294=this.opts)==null?void 0:_a294.animationResetFns)??{};datum&&resetMotion([data],datum)}animateReadyHighlightMarkers(data){var _a294;const{marker}=((_a294=this.opts)==null?void 0:_a294.animationResetFns)??{};marker&&resetMotion([data],marker)}animateReadyResize(data){this.resetAllAnimation(data)}animateClearingUpdateEmpty(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}getAnimationData(seriesRect,previousContextData){const{_contextNodeData:contextData}=this;return contextData?{datumSelection:this.datumSelection,markerSelection:this.markerSelection,labelSelection:this.labelSelection,annotationSelections:[...this.annotationSelections],contextData,previousContextData,paths:this.paths,seriesRect}:void 0}updateLabelSelection(opts){return opts.labelSelection}getScaling(scale2){if(scale2 instanceof LogScale){const{range:range3,domain}=scale2;return{type:"log",convert:__name(d=>scale2.convert(d),"convert"),domain:[domain[0],domain[1]],range:[range3[0],range3[1]]}}else if(scale2 instanceof ContinuousScale){const{range:range3,domain}=scale2;return{type:"continuous",domain:[domain[0],domain[1]],range:[range3[0],range3[1]]}}else if(scale2 instanceof BandScale){const{domain}=scale2;return{type:"category",domain,inset:scale2.inset,step:scale2.step}}}calculateScaling(){const result={};for(const direction of Object.values(ChartAxisDirection)){const axis=this.axes[direction];if(!axis)continue;const scalingResult=this.getScaling(axis.scale);scalingResult!=null&&(result[direction]=scalingResult)}return result}},__name(_a213,"CartesianSeries"),_a213);function axisExtent(axis){let min,max;if((axis instanceof NumberAxis||axis instanceof TimeAxis)&&({min,max}=axis),!(min==null&&max==null))return min??(min=-1/0),max??(max=1/0),[min,max]}__name(axisExtent,"axisExtent");function clippedRangeIndices(length2,range3,xValue){const range0=range3[0].valueOf(),range1=range3[1].valueOf(),xMinIndex=findMinIndex(0,length2-1,index=>{var _a294;const x=(_a294=xValue(index))==null?void 0:_a294.valueOf();return!Number.isFinite(x)||x>=range0});let xMaxIndex=findMaxIndex(0,length2-1,index=>{var _a294;const x=(_a294=xValue(index))==null?void 0:_a294.valueOf();return!Number.isFinite(x)||x<=range1});return xMinIndex==null||xMaxIndex==null?[0,0]:(xMaxIndex=Math.min(xMaxIndex+1,length2),[xMinIndex,xMaxIndex])}__name(clippedRangeIndices,"clippedRangeIndices");var INTERPOLATION_TYPE=UNION(["linear","smooth","step"],"a line style"),INTERPOLATION_STEP_POSITION=UNION(["start","middle","end"]),_a214,InterpolationProperties=(_a214=class extends BaseProperties{constructor(){super(...arguments),this.type="linear",this.tension=1,this.position="end"}},__name(_a214,"InterpolationProperties"),_a214);__decorateClass([TempValidate()],InterpolationProperties.prototype,"type",2);__decorateClass([TempValidate()],InterpolationProperties.prototype,"tension",2);__decorateClass([TempValidate()],InterpolationProperties.prototype,"position",2);var _a215,AreaSeriesProperties=(_a215=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.xName=void 0,this.fill="#c16068",this.fillGradientDefaults=new FillGradientDefaults,this.fillPatternDefaults=new FillPatternDefaults,this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new InterpolationProperties,this.shadow=new DropShadow,this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip,this.connectMissingData=!1}},__name(_a215,"AreaSeriesProperties"),_a215);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"xKey",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"xName",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"yKey",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"yName",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"yFilterKey",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"normalizedTo",2);__decorateClass([TempValidate(OR(COLOR_GRADIENT,COLOR_PATTERN,COLOR_STRING))],AreaSeriesProperties.prototype,"fill",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"fillGradientDefaults",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"fillPatternDefaults",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"fillOpacity",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"stroke",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"strokeWidth",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"lineDash",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"interpolation",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"shadow",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"marker",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"label",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"tooltip",2);__decorateClass([TempValidate()],AreaSeriesProperties.prototype,"connectMissingData",2);function spanRange(span){switch(span.type){case"linear":case"step":return[{x:span.x0,y:span.y0},{x:span.x1,y:span.y1}];case"cubic":return[{x:span.cp0x,y:span.cp0y},{x:span.cp3x,y:span.cp3y}]}}__name(spanRange,"spanRange");function spanRangeNormalized(span){const range3=spanRange(span);return range3[0].x>range3[1].x&&range3.reverse(),range3}__name(spanRangeNormalized,"spanRangeNormalized");function collapseSpanToPoint(span,point){const{x,y}=point;switch(span.type){case"linear":return{type:"linear",moveTo:span.moveTo,x0:x,y0:y,x1:x,y1:y};case"step":return{type:"step",moveTo:span.moveTo,x0:x,y0:y,x1:x,y1:y,stepX:x};case"cubic":return{type:"cubic",moveTo:span.moveTo,cp0x:x,cp0y:y,cp1x:x,cp1y:y,cp2x:x,cp2y:y,cp3x:x,cp3y:y}}}__name(collapseSpanToPoint,"collapseSpanToPoint");function rescaleSpan(span,nextStart,nextEnd){const[prevStart,prevEnd]=spanRange(span),widthScale=prevEnd.x!==prevStart.x?(nextEnd.x-nextStart.x)/(prevEnd.x-prevStart.x):0,heightScale=prevEnd.y!==prevStart.y?(nextEnd.y-nextStart.y)/(prevEnd.y-prevStart.y):0;switch(span.type){case"linear":return{type:"linear",moveTo:span.moveTo,x0:nextStart.x,y0:nextStart.y,x1:nextEnd.x,y1:nextEnd.y};case"cubic":return{type:"cubic",moveTo:span.moveTo,cp0x:nextStart.x,cp0y:nextStart.y,cp1x:nextEnd.x-(span.cp2x-prevStart.x)*widthScale,cp1y:nextEnd.y-(span.cp2y-prevStart.y)*heightScale,cp2x:nextEnd.x-(span.cp1x-prevStart.x)*widthScale,cp2y:nextEnd.y-(span.cp1y-prevStart.y)*heightScale,cp3x:nextEnd.x,cp3y:nextEnd.y};case"step":return{type:"step",moveTo:span.moveTo,x0:nextStart.x,y0:nextStart.y,x1:nextEnd.x,y1:nextEnd.y,stepX:nextEnd.x-(span.stepX-prevStart.x)*widthScale}}}__name(rescaleSpan,"rescaleSpan");function clipSpanX(span,x0,x1){const{moveTo}=span,[start2,end2]=spanRangeNormalized(span),{x:spanX0,y:spanY0}=start2,{x:spanX1,y:spanY1}=end2;if(x1<spanX0)return rescaleSpan(span,start2,start2);if(x0>spanX1)return rescaleSpan(span,end2,end2);switch(span.type){case"linear":{const m=spanY0===spanY1?void 0:(spanY1-spanY0)/(spanX1-spanX0),y0=m==null?spanY0:m*(x0-spanX0)+spanY0,y1=m==null?spanY0:m*(x1-spanX0)+spanY0;return{type:"linear",moveTo,x0,y0,x1,y1}}case"step":if(x1<=span.stepX){const y=span.y0;return{type:"step",moveTo,x0,y0:y,x1,y1:y,stepX:x1}}else if(x0>=span.stepX){const y=span.y1;return{type:"step",moveTo,x0,y0:y,x1,y1:y,stepX:x0}}else{const{y0,y1,stepX}=span;return{type:"step",moveTo,x0,y0,x1,y1,stepX}}case"cubic":{const t0=solveBezier(span.cp0x,span.cp1x,span.cp2x,span.cp3x,x0);let[_unused,bezier]=splitBezier(span.cp0x,span.cp0y,span.cp1x,span.cp1y,span.cp2x,span.cp2y,span.cp3x,span.cp3y,t0);const t1=solveBezier(bezier[0].x,bezier[1].x,bezier[2].x,bezier[3].x,x1);return[bezier,_unused]=splitBezier(bezier[0].x,bezier[0].y,bezier[1].x,bezier[1].y,bezier[2].x,bezier[2].y,bezier[3].x,bezier[3].y,t1),{type:"cubic",moveTo,cp0x:bezier[0].x,cp0y:bezier[0].y,cp1x:bezier[1].x,cp1y:bezier[1].y,cp2x:bezier[2].x,cp2y:bezier[2].y,cp3x:bezier[3].x,cp3y:bezier[3].y}}}}__name(clipSpanX,"clipSpanX");function linearPoints(points){const spans=[];let i=0,x0=NaN,y0=NaN;for(const{x:x1,y:y1}of points){if(i>0){const moveTo=i===1;spans.push({type:"linear",moveTo,x0,y0,x1,y1})}i+=1,x0=x1,y0=y1}return spans}__name(linearPoints,"linearPoints");var lineSteps={start:0,middle:.5,end:1};function stepPoints(points,position){const spans=[];let i=0,x0=NaN,y0=NaN;const p0=typeof position=="number"?position:lineSteps[position];for(const{x:x1,y:y1}of points){if(i>0){const moveTo=i===1,stepX=x0+(x1-x0)*p0;spans.push({type:"step",moveTo,x0,y0,x1,y1,stepX})}i+=1,x0=x1,y0=y1}return spans}__name(stepPoints,"stepPoints");var flatnessRatio=.05;function smoothPoints(iPoints,tension){const points=Array.isArray(iPoints)?iPoints:Array.from(iPoints);if(points.length<=1)return[];const gradients=points.map((c,i)=>{const p=i===0?c:points[i-1],n=i===points.length-1?c:points[i+1],isTerminalPoint=i===0||i===points.length-1;if(Math.sign(p.y-c.y)===Math.sign(n.y-c.y))return 0;if(!isTerminalPoint){const range3=Math.abs(p.y-n.y),prevRatio=Math.abs(c.y-p.y)/range3,nextRatio=Math.abs(c.y-n.y)/range3;if(prevRatio<=flatnessRatio||1-prevRatio<=flatnessRatio||nextRatio<=flatnessRatio||1-nextRatio<=flatnessRatio)return 0}return(n.y-p.y)/(n.x-p.x)});gradients[1]===0&&(gradients[0]*=2),gradients[gradients.length-2]===0&&(gradients[gradients.length-1]*=2);const spans=[];for(let i=1;i<points.length;i+=1){const prev=points[i-1],prevM=gradients[i-1],cur=points[i],curM=gradients[i],dx=cur.x-prev.x,dy=cur.y-prev.y;let dcp1x=dx*tension/3,dcp1y=dx*prevM*tension/3,dcp2x=dx*tension/3,dcp2y=dx*curM*tension/3;curM===0&&Math.abs(dcp1y)>Math.abs(dy)&&(dcp1x*=Math.abs(dy/dcp1y),dcp1y=Math.sign(dcp1y)*Math.abs(dy)),prevM===0&&Math.abs(dcp2y)>Math.abs(dy)&&(dcp2x*=Math.abs(dy/dcp2y),dcp2y=Math.sign(dcp2y)*Math.abs(dy)),spans.push({type:"cubic",moveTo:i===1,cp0x:prev.x,cp0y:prev.y,cp1x:prev.x+dcp1x,cp1y:prev.y+dcp1y,cp2x:cur.x-dcp2x,cp2y:cur.y-dcp2y,cp3x:cur.x,cp3y:cur.y})}return spans}__name(smoothPoints,"smoothPoints");function lerp2(a,b,ratio5){return(b-a)*ratio5+a}__name(lerp2,"lerp2");function linearSupertype(span,stepX){const{x0,y0,x1,y1}=span,stepY=(y1-y0)/(x1-x0)*(stepX-x0)+y0;return{leftCp1x:x0,leftCp1y:y0,leftCp2x:stepX,leftCp2y:stepY,stepX,stepY0:stepY,stepY1:stepY,rightCp1x:stepX,rightCp1y:stepY,rightCp2x:x1,rightCp2y:y1}}__name(linearSupertype,"linearSupertype");function bezierSupertype(span,stepX){const{cp0x,cp0y,cp1x,cp1y,cp2x,cp2y,cp3x,cp3y}=span,t=solveBezier(cp0x,cp1x,cp2x,cp3x,stepX),[left,right]=splitBezier(cp0x,cp0y,cp1x,cp1y,cp2x,cp2y,cp3x,cp3y,t),stepY=left[3].y;return{leftCp1x:left[1].x,leftCp1y:left[1].y,leftCp2x:left[2].x,leftCp2y:left[2].y,stepX,stepY0:stepY,stepY1:stepY,rightCp1x:right[1].x,rightCp1y:right[1].y,rightCp2x:right[2].x,rightCp2y:right[2].y}}__name(bezierSupertype,"bezierSupertype");function stepSupertype(span){const{x0,y0,x1,y1,stepX}=span;return{leftCp1x:(x0+stepX)/2,leftCp1y:y0,leftCp2x:(x0+stepX)/2,leftCp2y:y0,stepX,stepY0:y0,stepY1:y1,rightCp1x:(stepX+x1)/2,rightCp1y:y1,rightCp2x:(stepX+x1)/2,rightCp2y:y1}}__name(stepSupertype,"stepSupertype");function spanSupertype(span,stepX){return span.type==="linear"?linearSupertype(span,stepX):span.type==="cubic"?bezierSupertype(span,stepX):stepSupertype(span)}__name(spanSupertype,"spanSupertype");function plotStart(path,moveTo,x0,y0,x1,y1,reversed){switch(moveTo){case 0:reversed?path.moveTo(x1,y1):path.moveTo(x0,y0);break;case 1:reversed?path.lineTo(x1,y1):path.lineTo(x0,y0);break}}__name(plotStart,"plotStart");function plotLinear(path,x0,y0,x1,y1,reversed){reversed?path.lineTo(x0,y0):path.lineTo(x1,y1)}__name(plotLinear,"plotLinear");function plotCubic(path,cp0x,cp0y,cp1x,cp1y,cp2x,cp2y,cp3x,cp3y,reversed){reversed?path.cubicCurveTo(cp2x,cp2y,cp1x,cp1y,cp0x,cp0y):path.cubicCurveTo(cp1x,cp1y,cp2x,cp2y,cp3x,cp3y)}__name(plotCubic,"plotCubic");function plotStep(path,x0,y0,x1,y1,stepX,reversed){reversed?(path.lineTo(stepX,y1),path.lineTo(stepX,y0),path.lineTo(x0,y0)):(path.lineTo(stepX,y0),path.lineTo(stepX,y1),path.lineTo(x1,y1))}__name(plotStep,"plotStep");function plotSpan(path,span,moveTo,reversed){const[start2,end2]=spanRange(span);switch(plotStart(path,moveTo,start2.x,start2.y,end2.x,end2.y,reversed),span.type){case"linear":plotLinear(path,span.x0,span.y0,span.x1,span.y1,reversed);break;case"cubic":plotCubic(path,span.cp0x,span.cp0y,span.cp1x,span.cp1y,span.cp2x,span.cp2y,span.cp3x,span.cp3y,reversed);break;case"step":plotStep(path,span.x0,span.y0,span.x1,span.y1,span.stepX,reversed);break}}__name(plotSpan,"plotSpan");function interpolatedSpanRange(a,b,ratio5){const[aStart,aEnd]=spanRange(a),[bStart,bEnd]=spanRange(b),x0=lerp2(aStart.x,bStart.x,ratio5),y0=lerp2(aStart.y,bStart.y,ratio5),x1=lerp2(aEnd.x,bEnd.x,ratio5),y1=lerp2(aEnd.y,bEnd.y,ratio5);return[{x:x0,y:y0},{x:x1,y:y1}]}__name(interpolatedSpanRange,"interpolatedSpanRange");function plotInterpolatedSpans(path,a,b,ratio5,moveTo,reversed){const[{x:x0,y:y0},{x:x1,y:y1}]=interpolatedSpanRange(a,b,ratio5);if(plotStart(path,moveTo,x0,y0,x1,y1,reversed),a.type==="cubic"&&b.type==="cubic"){const cp1x=lerp2(a.cp1x,b.cp1x,ratio5),cp1y=lerp2(a.cp1y,b.cp1y,ratio5),cp2x=lerp2(a.cp2x,b.cp2x,ratio5),cp2y=lerp2(a.cp2y,b.cp2y,ratio5);plotCubic(path,x0,y0,cp1x,cp1y,cp2x,cp2y,x1,y1,reversed)}else if(a.type==="step"&&b.type==="step"){const stepX=lerp2(a.stepX,b.stepX,ratio5);plotStep(path,x0,y0,x1,y1,stepX,reversed)}else if(a.type==="linear"&&b.type==="linear")plotLinear(path,x0,y0,x1,y1,reversed);else{let defaultStepX;a.type==="step"?defaultStepX=a.stepX:b.type==="step"?defaultStepX=b.stepX:defaultStepX=(x0+x1)/2;const as=spanSupertype(a,defaultStepX),bs=spanSupertype(b,defaultStepX),leftCp1x=lerp2(as.leftCp1x,bs.leftCp1x,ratio5),leftCp1y=lerp2(as.leftCp1y,bs.leftCp1y,ratio5),leftCp2x=lerp2(as.leftCp2x,bs.leftCp2x,ratio5),leftCp2y=lerp2(as.leftCp2y,bs.leftCp2y,ratio5),stepX=lerp2(as.stepX,bs.stepX,ratio5),stepY0=lerp2(as.stepY0,bs.stepY0,ratio5),stepY1=lerp2(as.stepY1,bs.stepY1,ratio5),rightCp1x=lerp2(as.rightCp1x,bs.rightCp1x,ratio5),rightCp1y=lerp2(as.rightCp1y,bs.rightCp1y,ratio5),rightCp2x=lerp2(as.rightCp2x,bs.rightCp2x,ratio5),rightCp2y=lerp2(as.rightCp2y,bs.rightCp2y,ratio5);reversed?(path.cubicCurveTo(rightCp2x,rightCp2y,rightCp1x,rightCp1y,stepX,stepY1),path.lineTo(stepX,stepY0),path.cubicCurveTo(leftCp2x,leftCp2y,leftCp1x,leftCp1y,x0,y0)):(path.cubicCurveTo(leftCp1x,leftCp1y,leftCp2x,leftCp2y,stepX,stepY0),path.lineTo(stepX,stepY1),path.cubicCurveTo(rightCp1x,rightCp1y,rightCp2x,rightCp2y,x1,y1))}}__name(plotInterpolatedSpans,"plotInterpolatedSpans");var CollapseMode=(CollapseMode2=>(CollapseMode2[CollapseMode2.Zero=0]="Zero",CollapseMode2[CollapseMode2.Split=1]="Split",CollapseMode2))(CollapseMode||{});function integratedCategoryMatch(a,b){return a==null||b==null||typeof a!="object"||typeof b!="object"?!1:"id"in a&&"id"in b?a.id===b.id:a.toString()===b.toString()}__name(integratedCategoryMatch,"integratedCategoryMatch");function scale(val,scaling){if(!scaling)return NaN;if(val instanceof Date&&(val=val.getTime()),scaling.type==="continuous"&&typeof val=="number")return(val-scaling.domain[0])/(scaling.domain[1]-scaling.domain[0])*(scaling.range[1]-scaling.range[0])+scaling.range[0];if(scaling.type==="log"&&typeof val=="number")return scaling.convert(val);if(scaling.type!=="category")return NaN;const matchingIndex=scaling.domain.findIndex(d=>d===val);return matchingIndex>=0||scaling.domain.findIndex(d=>integratedCategoryMatch(val,d))>=0?scaling.inset+scaling.step*matchingIndex:NaN}__name(scale,"scale");function toAxisValue(value){return transformIntegratedCategoryValue(value).valueOf()}__name(toAxisValue,"toAxisValue");function getAxisIndices({data},values){return data.map((datum,datumIndex)=>({xValue0Index:values.indexOf(toAxisValue(datum.xValue0)),xValue1Index:values.indexOf(toAxisValue(datum.xValue1)),datumIndex}))}__name(getAxisIndices,"getAxisIndices");function validateCategorySorting(newData,oldData){const oldScale=oldData.scales.x,newScale=newData.scales.x;if((oldScale==null?void 0:oldScale.type)!=="category"||(newScale==null?void 0:newScale.type)!=="category")return!0;let x0=-1/0;for(const oldValue of oldScale.domain){const x=scale(oldValue,newScale);if(Number.isFinite(x)){if(x<x0)return!1;x0=x}}return!0}__name(validateCategorySorting,"validateCategorySorting");function validateAxisEntriesOrder(axisValues,data){let x0=-1/0;for(const axisValue of axisValues){const x=scale(axisValue.value,data.scales.x);if(Number.isFinite(x)){if(x<x0)return!1;x0=x}}return!0}__name(validateAxisEntriesOrder,"validateAxisEntriesOrder");function spanAxisContext(newData,oldData){const allAxisEntries=new Map;for(const{xValue0,xValue1}of newData.data){const xValue0Value=toAxisValue(xValue0),xValue1Value=toAxisValue(xValue1);allAxisEntries.set(xValue0Value,xValue0).set(xValue1Value,xValue1)}const newAxisEntries=Array.from(allAxisEntries,([axisValue,value])=>({axisValue,value}));newAxisEntries.sort((a,b)=>scale(a.value,newData.scales.x)-scale(b.value,newData.scales.x));const exclusivelyOldAxisEntries=[];for(const{xValue0,xValue1}of oldData.data){const xValue0Value=toAxisValue(xValue0),xValue1Value=toAxisValue(xValue1);allAxisEntries.has(xValue0Value)||(allAxisEntries.set(xValue0Value,xValue0),exclusivelyOldAxisEntries.push({axisValue:xValue0Value,value:xValue0})),allAxisEntries.has(xValue1Value)||(allAxisEntries.set(xValue1Value,xValue1),exclusivelyOldAxisEntries.push({axisValue:xValue1Value,value:xValue1}))}exclusivelyOldAxisEntries.sort((a,b)=>scale(a.value,oldData.scales.x)-scale(b.value,oldData.scales.x));const axisEntries=newAxisEntries;let insertionIndex=0;for(const oldAxisEntries of exclusivelyOldAxisEntries){for(let i=axisEntries.length-1;i>insertionIndex;i-=1){const oldValueX=scale(oldAxisEntries.value,oldData.scales.x),newValueX=scale(axisEntries[i].value,oldData.scales.x);if(oldValueX>newValueX){insertionIndex=i+1;break}}axisEntries.splice(insertionIndex,0,oldAxisEntries),insertionIndex+=1}if(!validateAxisEntriesOrder(axisEntries,oldData))return;const axisValues=axisEntries.map(axisEntry=>axisEntry.axisValue),oldDataAxisIndices=getAxisIndices(oldData,axisValues),newDataAxisIndices=getAxisIndices(newData,axisValues);return{axisValues,oldDataAxisIndices,newDataAxisIndices}}__name(spanAxisContext,"spanAxisContext");function clipSpan(span,xValue0Index,xIndices){if(xIndices.xValue1Index===xIndices.xValue0Index+1)return span;const range3=spanRange(span),step=(range3[1].x-range3[0].x)/(xIndices.xValue1Index-xIndices.xValue0Index),start2=range3[0].x+(xValue0Index-xIndices.xValue0Index)*step,end2=start2+step;return clipSpanX(span,start2,end2)}__name(clipSpan,"clipSpan");function axisZeroSpan(span,data){const[r0,r1]=spanRange(span),y0=scale(0,data.scales.y);return rescaleSpan(span,{x:r0.x,y:y0},{x:r1.x,y:y0})}__name(axisZeroSpan,"axisZeroSpan");function collapseSpanToMidpoint(span){const[r0,r1]=spanRange(span);return collapseSpanToPoint(span,{x:(r0.x+r1.x)/2,y:(r0.y+r1.y)/2})}__name(collapseSpanToMidpoint,"collapseSpanToMidpoint");function collapseSpan(span,collapseMode,data,axisIndices,indices,range3){var _a294,_b;let xValue,yValue;if(indices.xValue0Index>=range3.xValue1Index){const datumIndex=(_a294=axisIndices.findLast(i=>i.xValue1Index<=range3.xValue1Index))==null?void 0:_a294.datumIndex,datum=datumIndex!=null?data.data[datumIndex]:void 0;xValue=datum==null?void 0:datum.xValue1,yValue=datum==null?void 0:datum.yValue1}else if(indices.xValue0Index<=range3.xValue0Index){const datumIndex=(_b=axisIndices.find(i=>i.xValue0Index>=range3.xValue0Index))==null?void 0:_b.datumIndex,datum=datumIndex!=null?data.data[datumIndex]:void 0;xValue=datum==null?void 0:datum.xValue0,yValue=datum==null?void 0:datum.yValue0}if(xValue==null||yValue==null)switch(collapseMode){case 0:return axisZeroSpan(span,data);case 1:return collapseSpanToMidpoint(span)}const x=scale(xValue,data.scales.x),y=scale(yValue,data.scales.y),point={x,y};return rescaleSpan(span,point,point)}__name(collapseSpan,"collapseSpan");function zeroDataSpan(spanDatum,zeroData){var _a294;if(zeroData==null)return;const newSpanXValue0=toAxisValue(spanDatum.xValue0),newSpanXValue1=toAxisValue(spanDatum.xValue1);return(_a294=zeroData.find(zeroSpanDatum=>toAxisValue(zeroSpanDatum.xValue0)===newSpanXValue0&&toAxisValue(zeroSpanDatum.xValue1)===newSpanXValue1))==null?void 0:_a294.span}__name(zeroDataSpan,"zeroDataSpan");function addSpan(newData,collapseMode,newAxisIndices,newIndices,oldZeroData,range3,out){const newSpanDatum=newData.data[newIndices.datumIndex],newSpan=newSpanDatum.span,zeroSpan=zeroDataSpan(newSpanDatum,oldZeroData);if(zeroSpan!=null)out.removed.push({from:zeroSpan,to:zeroSpan}),out.moved.push({from:zeroSpan,to:newSpan}),out.added.push({from:newSpan,to:newSpan});else{const oldSpan=collapseSpan(newSpan,collapseMode,newData,newAxisIndices,newIndices,range3);out.added.push({from:oldSpan,to:newSpan})}}__name(addSpan,"addSpan");function removeSpan(oldData,collapseMode,oldAxisIndices,oldIndices,newZeroData,range3,out){const oldSpanDatum=oldData.data[oldIndices.datumIndex],oldSpan=oldSpanDatum.span,zeroSpan=zeroDataSpan(oldSpanDatum,newZeroData);if(zeroSpan!=null)out.removed.push({from:oldSpan,to:oldSpan}),out.moved.push({from:oldSpan,to:zeroSpan}),out.added.push({from:zeroSpan,to:zeroSpan});else{const newSpan=collapseSpan(oldSpan,collapseMode,oldData,oldAxisIndices,oldIndices,range3);out.removed.push({from:oldSpan,to:newSpan})}}__name(removeSpan,"removeSpan");function alignSpanToContainingSpan(span,axisValues,preData,postData,postSpanIndices){const startXValue0=axisValues[postSpanIndices.xValue0Index],startDatum=preData.data.find(spanDatum=>toAxisValue(spanDatum.xValue0)===startXValue0),endXValue1=axisValues[postSpanIndices.xValue1Index],endDatum=preData.data.find(spanDatum=>toAxisValue(spanDatum.xValue1)===endXValue1);if(startDatum==null||endDatum==null)return;const[{x:x0},{x:x1}]=spanRange(span),startX=scale(startDatum.xValue0,preData.scales.x),startY=scale(startDatum.yValue0,preData.scales.y),endX=scale(endDatum.xValue1,preData.scales.x),endY=scale(endDatum.yValue1,preData.scales.y);let altSpan=postData.data[postSpanIndices.datumIndex].span;return altSpan=rescaleSpan(altSpan,{x:startX,y:startY},{x:endX,y:endY}),altSpan=clipSpanX(altSpan,x0,x1),altSpan}__name(alignSpanToContainingSpan,"alignSpanToContainingSpan");function appendSpanPhases(newData,oldData,collapseMode,axisValues,xValue0Index,newAxisIndices,oldAxisIndices,range3,out){const xValue1Index=xValue0Index+1,oldIndices=oldAxisIndices.find(i=>i.xValue0Index<=xValue0Index&&i.xValue1Index>=xValue1Index),newIndices=newAxisIndices.find(i=>i.xValue0Index<=xValue0Index&&i.xValue1Index>=xValue1Index),oldZeroData=oldData.zeroData,newZeroData=newData.zeroData;if(oldIndices==null&&newIndices!=null){addSpan(newData,collapseMode,newAxisIndices,newIndices,oldZeroData,range3,out);return}else if(oldIndices!=null&&newIndices==null){removeSpan(oldData,collapseMode,oldAxisIndices,oldIndices,newZeroData,range3,out);return}else if(oldIndices==null||newIndices==null)return;let ordering;oldIndices.xValue0Index===newIndices.xValue0Index&&oldIndices.xValue1Index===newIndices.xValue1Index?ordering=0:oldIndices.xValue0Index<=newIndices.xValue0Index&&oldIndices.xValue1Index>=newIndices.xValue1Index?ordering=-1:oldIndices.xValue0Index>=newIndices.xValue0Index&&oldIndices.xValue1Index<=newIndices.xValue1Index?ordering=1:ordering=0;const oldSpanDatum=oldData.data[oldIndices.datumIndex],clippedOldSpanOldScale=clipSpan(oldSpanDatum.span,xValue0Index,oldIndices),newSpanDatum=newData.data[newIndices.datumIndex],clippedNewSpanNewScale=clipSpan(newSpanDatum.span,xValue0Index,newIndices);if(ordering===1){const clippedPostRemoveOldSpanOldScale=alignSpanToContainingSpan(clippedOldSpanOldScale,axisValues,oldData,newData,newIndices);clippedPostRemoveOldSpanOldScale!=null?(out.removed.push({from:clippedOldSpanOldScale,to:clippedPostRemoveOldSpanOldScale}),out.moved.push({from:clippedPostRemoveOldSpanOldScale,to:clippedNewSpanNewScale}),out.added.push({from:clippedNewSpanNewScale,to:clippedNewSpanNewScale})):removeSpan(oldData,collapseMode,oldAxisIndices,oldIndices,newZeroData,range3,out)}else if(ordering===-1){const clippedPreAddedNewSpanNewScale=alignSpanToContainingSpan(clippedNewSpanNewScale,axisValues,newData,oldData,oldIndices);clippedPreAddedNewSpanNewScale!=null?(out.removed.push({from:clippedOldSpanOldScale,to:clippedOldSpanOldScale}),out.moved.push({from:clippedOldSpanOldScale,to:clippedPreAddedNewSpanNewScale}),out.added.push({from:clippedPreAddedNewSpanNewScale,to:clippedNewSpanNewScale})):addSpan(newData,collapseMode,newAxisIndices,newIndices,oldZeroData,range3,out)}else out.removed.push({from:clippedOldSpanOldScale,to:clippedOldSpanOldScale}),out.moved.push({from:clippedOldSpanOldScale,to:clippedNewSpanNewScale}),out.added.push({from:clippedNewSpanNewScale,to:clippedNewSpanNewScale})}__name(appendSpanPhases,"appendSpanPhases");function phaseAnimation(axisContext,newData,oldData,collapseMode){var _a294,_b,_c,_d;const out={removed:[],moved:[],added:[]},{axisValues,oldDataAxisIndices,newDataAxisIndices}=axisContext,range3={xValue0Index:Math.max(((_a294=oldDataAxisIndices.at(0))==null?void 0:_a294.xValue0Index)??-1/0,((_b=newDataAxisIndices.at(0))==null?void 0:_b.xValue0Index)??-1/0),xValue1Index:Math.min(((_c=oldDataAxisIndices.at(-1))==null?void 0:_c.xValue1Index)??1/0,((_d=newDataAxisIndices.at(-1))==null?void 0:_d.xValue1Index)??1/0)};for(let xValue0Index=0;xValue0Index<axisValues.length-1;xValue0Index+=1)appendSpanPhases(newData,oldData,collapseMode,axisValues,xValue0Index,newDataAxisIndices,oldDataAxisIndices,range3,out);return out}__name(phaseAnimation,"phaseAnimation");function resetSpan(data,spanDatum,collapseMode){const{span}=spanDatum;switch(collapseMode){case 0:return zeroDataSpan(spanDatum,data.zeroData)??axisZeroSpan(span,data);case 1:return collapseSpanToMidpoint(span)}}__name(resetSpan,"resetSpan");function resetAnimation(newData,oldData,collapseMode){const added=[],removed=[];for(const oldSpanDatum of oldData.data){const oldSpan=oldSpanDatum.span,collapsedSpan=resetSpan(oldData,oldSpanDatum,collapseMode);removed.push({from:oldSpan,to:collapsedSpan})}for(const newSpanDatum of newData.data){const newSpan=newSpanDatum.span,collapsedSpan=resetSpan(newData,newSpanDatum,collapseMode);added.push({from:collapsedSpan,to:newSpan})}return{removed,moved:[],added}}__name(resetAnimation,"resetAnimation");function pairUpSpans(newData,oldData,collapseMode){if(!validateCategorySorting(newData,oldData))return;const axisContext=spanAxisContext(newData,oldData);return axisContext==null?resetAnimation(newData,oldData,collapseMode):phaseAnimation(axisContext,newData,oldData,collapseMode)}__name(pairUpSpans,"pairUpSpans");function isContinuousScaling(scaling){return scaling.type==="continuous"||scaling.type==="log"}__name(isContinuousScaling,"isContinuousScaling");function isCategoryScaling(scaling){return scaling.type==="category"}__name(isCategoryScaling,"isCategoryScaling");function areScalingEqual(a,b){return a===void 0||b===void 0?a!==void 0||b!==void 0:isContinuousScaling(a)&&isContinuousScaling(b)?a.type===b.type&&arraysEqual(a.domain,b.domain)&&arraysEqual(a.range,b.range):isCategoryScaling(a)&&isCategoryScaling(b)?a.inset===b.inset&&a.step===b.step&&arraysEqual(a.domain,b.domain):!1}__name(areScalingEqual,"areScalingEqual");function isScaleValid(scale2){return scale2==null?!1:scale2.type==="category"?scale2.domain.every(v=>v!=null):scale2.domain.every(v=>Number.isFinite(v)||v instanceof Date)&&scale2.range.every(v=>Number.isFinite(v))}__name(isScaleValid,"isScaleValid");function interpolatePoints(points,interpolation){let spans;const pointsIter=points.map(point=>point.point);switch(interpolation.type){case"linear":spans=linearPoints(pointsIter);break;case"smooth":spans=smoothPoints(pointsIter,interpolation.tension);break;case"step":spans=stepPoints(pointsIter,interpolation.position);break}return spans.map((span,i)=>({span,xValue0:points[i].xDatum,yValue0:points[i].yDatum,xValue1:points[i+1].xDatum,yValue1:points[i+1].yDatum}))}__name(interpolatePoints,"interpolatePoints");function pointsEq(a,b,delta3=.001){return Math.abs(a.x-b.x)<delta3&&Math.abs(a.y-b.y)<delta3}__name(pointsEq,"pointsEq");function plotLinePathStroke({path},spans){let lastPoint;for(const{span}of spans){const[start2,end2]=spanRange(span),join=lastPoint!=null&&pointsEq(lastPoint,start2)?1:0;plotSpan(path,span,join,!1),lastPoint=end2}}__name(plotLinePathStroke,"plotLinePathStroke");function plotInterpolatedLinePathStroke(ratio5,path,spans){let lastPoint;for(const span of spans){const[start2,end2]=interpolatedSpanRange(span.from,span.to,ratio5),join=lastPoint!=null&&pointsEq(lastPoint,start2)?1:0;plotInterpolatedSpans(path.path,span.from,span.to,ratio5,join,!1),lastPoint=end2}}__name(plotInterpolatedLinePathStroke,"plotInterpolatedLinePathStroke");function prepareLinePathStrokeAnimationFns(status,spans,visibleToggleMode){const removePhaseFn=__name((ratio5,path)=>plotInterpolatedLinePathStroke(ratio5,path,spans.removed),"removePhaseFn"),updatePhaseFn=__name((ratio5,path)=>plotInterpolatedLinePathStroke(ratio5,path,spans.moved),"updatePhaseFn"),addPhaseFn=__name((ratio5,path)=>plotInterpolatedLinePathStroke(ratio5,path,spans.added),"addPhaseFn"),pathProperties=prepareLinePathPropertyAnimation(status,visibleToggleMode);return{status,path:{addPhaseFn,updatePhaseFn,removePhaseFn},pathProperties}}__name(prepareLinePathStrokeAnimationFns,"prepareLinePathStrokeAnimationFns");function prepareLinePathPropertyAnimation(status,visibleToggleMode){const phase=visibleToggleMode==="none"?"updated":status,result={fromFn:__name(_path=>{let mixin;return status==="removed"?mixin={finish:{visible:!1}}:status==="added"?mixin={start:{visible:!0}}:mixin={},{phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase],...mixin}},"fromFn"),toFn:__name(_path=>({phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]}),"toFn")};return visibleToggleMode==="fade"?{fromFn:__name(path=>({opacity:status==="added"?0:path.opacity,...result.fromFn(path)}),"fromFn"),toFn:__name(path=>({opacity:status==="removed"?0:1,...result.toFn(path)}),"toFn")}:result}__name(prepareLinePathPropertyAnimation,"prepareLinePathPropertyAnimation");function prepareLinePathAnimation(newData,oldData,diff2){var _a294,_b;const isCategoryBased=((_a294=newData.scales.x)==null?void 0:_a294.type)==="category",wasCategoryBased=((_b=oldData.scales.x)==null?void 0:_b.type)==="category";if(isCategoryBased!==wasCategoryBased||!isScaleValid(newData.scales.x)||!isScaleValid(oldData.scales.x)||newData.strokeData==null||oldData.strokeData==null)return;let status="updated";oldData.visible&&!newData.visible?status="removed":!oldData.visible&&newData.visible&&(status="added");const strokeSpans=pairUpSpans({scales:newData.scales,data:newData.strokeData.spans},{scales:oldData.scales,data:oldData.strokeData.spans},1);if(strokeSpans==null)return;const stroke2=prepareLinePathStrokeAnimationFns(status,strokeSpans,"fade"),hasMotion=((diff2==null?void 0:diff2.changed)??!0)||!areScalingEqual(newData.scales.x,oldData.scales.x)||!areScalingEqual(newData.scales.y,oldData.scales.y)||status!=="updated";return{status,stroke:stroke2,hasMotion}}__name(prepareLinePathAnimation,"prepareLinePathAnimation");function plotAreaPathFill({path},{spans,phantomSpans}){for(let i=0;i<spans.length;i+=1){const{span}=spans[i],phantomSpan=phantomSpans[i].span;plotSpan(path,span,0,!1),plotSpan(path,phantomSpan,1,!0),path.closePath()}}__name(plotAreaPathFill,"plotAreaPathFill");function plotInterpolatedAreaSeriesFillSpans(ratio5,{path},spans,fillPhantomSpans){for(let i=0;i<spans.length;i+=1){const span=spans[i],reversedPhantomSpan=fillPhantomSpans[i];plotInterpolatedSpans(path,span.from,span.to,ratio5,0,!1),plotInterpolatedSpans(path,reversedPhantomSpan.from,reversedPhantomSpan.to,ratio5,1,!0),path.closePath()}}__name(plotInterpolatedAreaSeriesFillSpans,"plotInterpolatedAreaSeriesFillSpans");function prepareAreaFillAnimationFns(status,spans,fillPhantomSpans,visibleToggleMode){const removePhaseFn=__name((ratio5,path)=>plotInterpolatedAreaSeriesFillSpans(ratio5,path,spans.removed,fillPhantomSpans.removed),"removePhaseFn"),updatePhaseFn=__name((ratio5,path)=>plotInterpolatedAreaSeriesFillSpans(ratio5,path,spans.moved,fillPhantomSpans.moved),"updatePhaseFn"),addPhaseFn=__name((ratio5,path)=>plotInterpolatedAreaSeriesFillSpans(ratio5,path,spans.added,fillPhantomSpans.added),"addPhaseFn"),pathProperties=prepareLinePathPropertyAnimation(status,visibleToggleMode);return{status,path:{addPhaseFn,updatePhaseFn,removePhaseFn},pathProperties}}__name(prepareAreaFillAnimationFns,"prepareAreaFillAnimationFns");function prepareAreaPathAnimation(newData,oldData){var _a294,_b;const isCategoryBased=((_a294=newData.scales.x)==null?void 0:_a294.type)==="category",wasCategoryBased=((_b=oldData.scales.x)==null?void 0:_b.type)==="category";if(isCategoryBased!==wasCategoryBased||!isScaleValid(newData.scales.x)||!isScaleValid(oldData.scales.x))return;let status="updated";oldData.visible&&!newData.visible?status="removed":!oldData.visible&&newData.visible&&(status="added");const fillSpans=pairUpSpans({scales:newData.scales,data:newData.fillData.spans},{scales:oldData.scales,data:oldData.fillData.spans},0);if(fillSpans==null)return;const fillPhantomSpans=pairUpSpans({scales:newData.scales,data:newData.fillData.phantomSpans},{scales:oldData.scales,data:oldData.fillData.phantomSpans},0);if(fillPhantomSpans==null)return;const strokeSpans=pairUpSpans({scales:newData.scales,data:newData.strokeData.spans,zeroData:newData.fillData.phantomSpans},{scales:oldData.scales,data:oldData.strokeData.spans,zeroData:oldData.fillData.phantomSpans},0);if(strokeSpans==null)return;const fadeMode="none",fill=prepareAreaFillAnimationFns(status,fillSpans,fillPhantomSpans,fadeMode),stroke2=prepareLinePathStrokeAnimationFns(status,strokeSpans,fadeMode);return{status,fill,stroke:stroke2}}__name(prepareAreaPathAnimation,"prepareAreaPathAnimation");function markerFadeInAnimation({id},animationManager,status,...markerSelections){const params={phase:status?NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]:"trailing"};staticFromToMotion(id,"markers",animationManager,markerSelections,{opacity:0},{opacity:1},params),markerSelections.forEach(s=>s.cleanup())}__name(markerFadeInAnimation,"markerFadeInAnimation");function markerScaleInAnimation({id},animationManager,...markerSelections){staticFromToMotion(id,"markers",animationManager,markerSelections,{scalingX:0,scalingY:0},{scalingX:1,scalingY:1},{phase:"initial"}),markerSelections.forEach(s=>s.cleanup())}__name(markerScaleInAnimation,"markerScaleInAnimation");function markerSwipeScaleInAnimation({id,nodeDataDependencies},animationManager,...markerSelections){const seriesWidth=nodeDataDependencies.seriesRectWidth;fromToMotion(id,"markers",animationManager,markerSelections,{fromFn:__name((_,datum)=>{var _a294;const x=((_a294=datum.midPoint)==null?void 0:_a294.x)??seriesWidth;let delay=clamp(0,inverseEaseOut(x/seriesWidth),1);return isNaN(delay)&&(delay=0),{scalingX:0,scalingY:0,delay,duration:QUICK_TRANSITION,phase:"initial"}},"fromFn"),toFn:__name(()=>({scalingX:1,scalingY:1}),"toFn")})}__name(markerSwipeScaleInAnimation,"markerSwipeScaleInAnimation");function resetMarkerFn(_node){return{opacity:1,scalingX:1,scalingY:1}}__name(resetMarkerFn,"resetMarkerFn");function resetMarkerPositionFn(_node,datum){var _a294,_b,_c,_d;return{x:((_a294=datum.point)==null?void 0:_a294.x)??NaN,y:((_b=datum.point)==null?void 0:_b.y)??NaN,scalingCenterX:((_c=datum.point)==null?void 0:_c.x)??NaN,scalingCenterY:((_d=datum.point)==null?void 0:_d.y)??NaN}}__name(resetMarkerPositionFn,"resetMarkerPositionFn");function computeMarkerFocusBounds(series,{datumIndex}){const nodeData=series.getNodeData();if(nodeData===void 0)return;const datum=nodeData[datumIndex],{point}=datum??{};if(datum==null||point==null)return;const size=4+(point.focusSize??series.getFormattedMarkerStyle(datum).size),radius=size/2,x=datum.point.x-radius,y=datum.point.y-radius;return Transformable.toCanvas(series.contentGroup,new BBox(x,y,size,size))}__name(computeMarkerFocusBounds,"computeMarkerFocusBounds");function pathSwipeInAnimation({id,visible,nodeDataDependencies},animationManager,...paths){const{seriesRectWidth:width2,seriesRectHeight:height2}=nodeDataDependencies;staticFromToMotion(id,"path_properties",animationManager,paths,{clipX:0},{clipX:width2},{phase:"initial",start:{clip:!0,clipY:height2,visible},finish:{clip:!1,visible}})}__name(pathSwipeInAnimation,"pathSwipeInAnimation");function pathFadeInAnimation({id},subId,animationManager,phase="add",...selection){staticFromToMotion(id,subId,animationManager,selection,{opacity:0},{opacity:1},{phase})}__name(pathFadeInAnimation,"pathFadeInAnimation");function buildResetPathFn(opts){return _node=>({visible:opts.getVisible(),opacity:opts.getOpacity(),clipScalingX:1,clip:!1})}__name(buildResetPathFn,"buildResetPathFn");function updateClipPath({nodeDataDependencies},path){const toFinite=__name(value=>isFinite(value)?value:0,"toFinite");path.clipX=toFinite(nodeDataDependencies.seriesRectWidth),path.clipY=toFinite(nodeDataDependencies.seriesRectHeight)}__name(updateClipPath,"updateClipPath");var CROSS_FILTER_AREA_FILL_OPACITY_FACTOR=.125,CROSS_FILTER_AREA_STROKE_OPACITY_FACTOR=.25,_a216,AreaSeries=(_a216=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,categoryKey:"xValue",pathsPerSeries:["fill","stroke"],pathsZIndexSubOrderOffset:[0,1e3],hasMarkers:!0,markerSelectionGarbageCollection:!1,pickModes:[2,0],animationResetFns:{path:buildResetPathFn({getVisible:__name(()=>this.visible,"getVisible"),getOpacity:__name(()=>this.getOpacity(),"getOpacity")}),label:resetLabelFn,marker:__name((node,datum)=>({...resetMarkerFn(),...resetMarkerPositionFn(node,datum)}),"marker")},clipFocusBox:!1}),this.properties=new AreaSeriesProperties,this.connectsToYAxis=!0,this.backgroundGroup=new Group({name:`${this.id}-background`,zIndex:0}),this._isStacked=void 0}get pickModeAxis(){return"main"}renderToOffscreenCanvas(){return super.renderToOffscreenCanvas()||this.contextNodeData!=null&&(this.contextNodeData.fillData.spans.length>RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD||this.contextNodeData.strokeData.spans.length>RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD)}attachSeries(seriesContentNode,seriesNode,annotationNode){super.attachSeries(seriesContentNode,seriesNode,annotationNode),seriesContentNode.appendChild(this.backgroundGroup)}detachSeries(seriesContentNode,seriesNode,annotationNode){super.detachSeries(seriesContentNode,seriesNode,annotationNode),seriesContentNode==null||seriesContentNode.removeChild(this.backgroundGroup)}attachPaths([fill,stroke2]){this.backgroundGroup.appendChild(fill),this.contentGroup.appendChild(stroke2),stroke2.zIndex=-1}detachPaths([fill,stroke2]){this.backgroundGroup.removeChild(fill),this.contentGroup.removeChild(stroke2)}isStacked(){var _a294;return(((_a294=this.seriesGrouping)==null?void 0:_a294.stackCount)??1)>1}setSeriesIndex(index){const isStacked=this.isStacked();return!super.setSeriesIndex(index)&&this._isStacked===isStacked?!1:(this._isStacked=isStacked,isStacked?(this.backgroundGroup.zIndex=[0,index],this.contentGroup.zIndex=[1,index,0]):(this.backgroundGroup.zIndex=[1,index,0,0],this.contentGroup.zIndex=[1,index,0,1]),!0)}async processData(dataController){var _a294,_b;if(this.data==null||!this.properties.isValid())return;const{data,visible,seriesGrouping:{groupIndex=this.id,stackCount=1}={}}=this,{xKey,yKey,yFilterKey,connectMissingData,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),xScale=(_a294=this.axes.x)==null?void 0:_a294.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),idMap={value:`area-stack-${groupIndex}-yValue`,values:`area-stack-${groupIndex}-yValues`,stack:`area-stack-${groupIndex}-yValue-stack`,marker:`area-stack-${groupIndex}-yValues-marker`},extraProps=[];isDefined(normalizedTo)&&extraProps.push(normaliseGroupTo(Object.values(idMap),normalizedTo)),animationEnabled&&extraProps.push(animationValidation());const common={invalidValue:null};(isDefined(normalizedTo)||connectMissingData)&&stackCount>1&&(common.invalidValue=0),visible||(common.forceValue=0),await this.requestDataModel(dataController,data,{props:[keyProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValueRaw",...common}),...yFilterKey!=null?[valueProperty(yFilterKey,yScaleType,{id:"yFilterRaw"})]:[],...groupStackValueProperty(yKey,yScaleType,{id:"yValueStack",...common,groupId:idMap.stack}),valueProperty(yKey,yScaleType,{id:"yValue",...common,groupId:idMap.value}),...groupAccumulativeValueProperty(yKey,"window","current",{id:"yValueEnd",...common,groupId:idMap.values},yScaleType),...groupAccumulativeValueProperty(yKey,"normal","current",{id:"yValueCumulative",...common,groupId:idMap.marker},yScaleType),...extraProps],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}xCoordinateRange(xValue,pixelSize){const{marker}=this.properties,x=this.axes.x.scale.convert(xValue),r=marker.enabled?.5*marker.size*pixelSize:0;return[x-r,x+r]}yCoordinateRange(yValues,pixelSize){const{marker}=this.properties,y=this.axes.y.scale.convert(yValues[0]),r=marker.enabled?.5*marker.size*pixelSize:0;return[y-r,y+r]}getSeriesDomain(direction){const{processedData,dataModel,axes}=this;if(!processedData||!dataModel)return[];const yAxis=axes.y;if(direction==="x"){const keyDef=dataModel.resolveProcessedDataDefById(this,"xValue"),keys=dataModel.getDomain(this,"xValue","key",processedData);return(keyDef==null?void 0:keyDef.def.type)==="key"&&keyDef.def.valueType==="category"?keys:fixNumericExtent(extent(keys))}const yExtent=this.domainForClippedRange("y",["yValueCumulative"],"xValue",!0);if(yAxis instanceof LogAxis||yAxis instanceof TimeAxis)return fixNumericExtent(yExtent);{const fixedYExtent=Number.isFinite(yExtent[1]-yExtent[0])?[yExtent[0]>0?0:yExtent[0],yExtent[1]<0?0:yExtent[1]]:[];return fixNumericExtent(fixedYExtent)}}getSeriesRange(_direction,visibleRange){const[y0,y1]=this.domainForVisibleRange("y",["yValueCumulative"],"xValue",visibleRange,!0);return[Math.min(y0,0),Math.max(y1,0)]}getVisibleItems(xVisibleRange,yVisibleRange,minVisibleItems){return this.countVisibleItems("xValue",["yValueCumulative"],xVisibleRange,yVisibleRange,minVisibleItems)}createNodeData(){var _a294;const{axes,data,processedData,dataModel}=this,xAxis=axes.x,yAxis=axes.y;if(!xAxis||!yAxis||!data||!dataModel||(processedData==null?void 0:processedData.type)!=="grouped"||!this.properties.isValid())return;const{yKey,xKey,yFilterKey,marker,label,fill:seriesFill,stroke:seriesStroke,connectMissingData,interpolation}=this.properties,{scale:xScale}=xAxis,{scale:yScale}=yAxis,{isContinuousY}=this.getScaleInformation({xScale,yScale}),xOffset=(xScale.bandwidth??0)/2,xValues=dataModel.resolveKeysById(this,"xValue",processedData),yEndValues=dataModel.resolveColumnById(this,"yValueEnd",processedData),yRawValues=dataModel.resolveColumnById(this,"yValueRaw",processedData),yCumulativeValues=dataModel.resolveColumnById(this,"yValueCumulative",processedData),yFilterValues=yFilterKey!=null?dataModel.resolveColumnById(this,"yFilterRaw",processedData):void 0,yStackValues=dataModel.resolveColumnById(this,"yValueStack",processedData),createMarkerCoordinate=__name((xDatum,yEnd,rawYDatum)=>{let currY;return(isDefined(this.properties.normalizedTo)?isContinuousY&&isContinuous(rawYDatum):!isNaN(rawYDatum))&&(currY=yEnd),{x:xScale.convert(xDatum)+xOffset,y:yScale.convert(currY),size:marker.size}},"createMarkerCoordinate"),labelData=[],markerData=[],{visibleSameStackCount}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);let crossFiltering=!1;const{dataSources}=processedData,rawData=dataSources.get(this.id)??[];for(const{datumIndex}of dataModel.forEachGroupDatum(this,processedData)){const xDatum=xValues[datumIndex];if(xDatum==null)return;const seriesDatum=rawData[datumIndex],yDatum=yRawValues[datumIndex],yValueCumulative=yCumulativeValues[datumIndex],yValueEnd=yEndValues[datumIndex],validPoint=Number.isFinite(yDatum),point=createMarkerCoordinate(xDatum,+yValueCumulative,yDatum),selected=yFilterValues!=null?yFilterValues[datumIndex]===yDatum:void 0;if(selected===!1&&(crossFiltering=!0),validPoint&&marker&&markerData.push({series:this,itemId:yKey,datum:seriesDatum,datumIndex,midPoint:{x:point.x,y:point.y},cumulativeValue:yValueEnd,yValue:yDatum,xValue:xDatum,yKey,xKey,point,fill:marker.fill??seriesFill,stroke:marker.stroke??seriesStroke,strokeWidth:marker.strokeWidth??this.getStrokeWidth(this.properties.strokeWidth),selected}),validPoint&&label){const labelText=this.getLabelText(label,{value:yDatum,datum:seriesDatum,xKey,yKey,xName:this.properties.xName,yName:this.properties.yName});labelData.push({series:this,itemId:yKey,datum:seriesDatum,datumIndex,x:point.x,y:point.y,labelText})}}const spansForPoints=__name(points=>points.flatMap(p=>Array.isArray(p)?interpolatePoints(p,interpolation):new Array(p.skip).fill(null)),"spansForPoints"),createPoint=__name((xDatum,yDatum)=>({point:{x:xScale.convert(xDatum)+xOffset,y:yScale.convert(yDatum)},xDatum,yDatum}),"createPoint"),getSeriesSpans=__name(index=>{const points=[];for(const{datumIndexes:[pIdx,datumIndex,nIndx]}of dataModel.forEachGroupDatumTuple(this,processedData)){const xDatum=xValues[datumIndex],yValueStack=yStackValues[datumIndex],yDatum=yValueStack[index],yDatumIsFinite=Number.isFinite(yDatum);if(connectMissingData&&!yDatumIsFinite)continue;const lastYValueStack=pIdx!=null?yStackValues[pIdx]:void 0,nextYValueStack=nIndx!=null?yStackValues[nIndx]:void 0;let yValueEndBackwards=0,yValueEndForwards=0;for(let j=0;j<=index;j+=1){const value=yValueStack[j];if(Number.isFinite(value)){const lastWasFinite=lastYValueStack==null||Number.isFinite(lastYValueStack[j]),nextWasFinite=nextYValueStack==null||Number.isFinite(nextYValueStack[j]);lastWasFinite&&(yValueEndBackwards+=value),nextWasFinite&&(yValueEndForwards+=value)}}const currentPoints=points[points.length-1];if(!connectMissingData&&(yValueEndBackwards!==yValueEndForwards||!yDatumIsFinite))if(!yDatumIsFinite&&Array.isArray(currentPoints)&&currentPoints.length===1)points[points.length-1]={skip:1};else{const pointBackwards=createPoint(xDatum,yValueEndBackwards),pointForwards=createPoint(xDatum,yValueEndForwards);Array.isArray(currentPoints)?currentPoints.push(pointBackwards):currentPoints!=null&&(currentPoints.skip+=1),points.push(yDatumIsFinite?[pointForwards]:{skip:0})}else{const yValue=connectMissingData?yDatum:Math.max(yValueEndBackwards,yValueEndForwards),point=createPoint(xDatum,yValue);Array.isArray(currentPoints)?currentPoints.push(point):currentPoints!=null?(currentPoints.skip+=1,points.push([point])):points.push([point])}}return spansForPoints(points)},"getSeriesSpans"),stackIndex=((_a294=this.seriesGrouping)==null?void 0:_a294.stackIndex)??0,getAxisSpans=__name(()=>{const yValueZeroPoints=Array.from(dataModel.forEachGroupDatum(this,processedData),({datumIndex})=>{const xDatum=xValues[datumIndex],yDatum=yStackValues[datumIndex][stackIndex];if(!(connectMissingData&&!Number.isFinite(yDatum)))return createPoint(xDatum,0)}).filter(x=>x!=null);return interpolatePoints(yValueZeroPoints,interpolation)},"getAxisSpans"),currentSeriesSpans=getSeriesSpans(stackIndex),phantomSpans=currentSeriesSpans.map(()=>null);for(let j=stackIndex-1;j>=-1;j-=1){let spans;for(let i=0;i<phantomSpans.length;i+=1)phantomSpans[i]==null&&(spans??(spans=j!==-1?getSeriesSpans(j):getAxisSpans()),phantomSpans[i]=spans[i])}const fillSpans=currentSeriesSpans.map((span,index)=>span??phantomSpans[index]),strokeSpans=currentSeriesSpans.filter(span=>span!=null);return{itemId:yKey,fillData:{itemId:yKey,spans:fillSpans,phantomSpans},strokeData:{itemId:yKey,spans:strokeSpans},labelData,nodeData:markerData,scales:this.calculateScaling(),visible:this.visible,stackVisible:visibleSameStackCount>0,crossFiltering}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(opts){var _a294;const{opacity,visible,animationEnabled}=opts,[fill,stroke2]=opts.paths,crossFiltering=((_a294=this.contextNodeData)==null?void 0:_a294.crossFiltering)===!0,strokeWidth=this.getStrokeWidth(this.properties.strokeWidth);stroke2.setProperties({fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:1,stroke:this.properties.stroke,strokeWidth,strokeOpacity:this.properties.strokeOpacity*(crossFiltering?CROSS_FILTER_AREA_STROKE_OPACITY_FACTOR:1),lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity,visible:visible||animationEnabled});const seriesFill=getShapeFill(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults);applyShapeStyle(fill,{fill:seriesFill,stroke:void 0,fillOpacity:this.properties.fillOpacity*(crossFiltering?CROSS_FILTER_AREA_FILL_OPACITY_FACTOR:1)},void 0,this.getShapeFillBBox()),fill.setProperties({lineJoin:"round",pointerEvents:1,fillShadow:this.properties.shadow,opacity,visible:visible||animationEnabled}),updateClipPath(this,stroke2),updateClipPath(this,fill)}updatePaths(opts){this.updateAreaPaths(opts.paths,opts.contextData)}updateAreaPaths(paths,contextData){for(const path of paths)path.visible=contextData.visible;if(contextData.visible)this.updateFillPath(paths,contextData),this.updateStrokePath(paths,contextData);else for(const path of paths)path.path.clear(),path.markDirty("AreaSeries")}updateFillPath(paths,contextData){const[fill]=paths;fill.path.clear(),plotAreaPathFill(fill,contextData.fillData),fill.markDirty("AreaSeries")}updateStrokePath(paths,contextData){const{spans}=contextData.strokeData,[,stroke2]=paths;stroke2.path.clear(),plotLinePathStroke(stroke2,spans),stroke2.markDirty("AreaSeries")}updateMarkerSelection(opts){var _a294;const{nodeData,markerSelection}=opts,markersEnabled=this.properties.marker.enabled||((_a294=this.contextNodeData)==null?void 0:_a294.crossFiltering)===!0;return this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(markersEnabled?nodeData:[])}updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,marker,fill,stroke:stroke2,strokeWidth,fillOpacity,strokeOpacity,highlightStyle}=this.properties,xDomain=this.getSeriesDomain("x"),yDomain=this.getSeriesDomain("y"),baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle(),{fill,stroke:stroke2,strokeWidth,fillOpacity,strokeOpacity}),fillBBox=this.getShapeFillBBox();markerSelection.each((node,datum)=>{this.updateMarkerStyle(marker,node,datum.datum,datum.point,datumStylerProperties(datum,xKey,yKey,xDomain,yDomain),highlighted,baseStyle,fillBBox,{selected:datum.selected})}),highlighted||this.properties.marker.markClean()}updateLabelSelection(opts){const{labelData,labelSelection}=opts;return labelSelection.update(labelData)}updateLabelNodes(opts){const{labelSelection}=opts,{enabled:labelEnabled,fontStyle,fontWeight,fontSize,fontFamily,color:color6}=this.properties.label;labelSelection.each((text2,datum)=>{const{x,y,labelText}=datum;labelText&&labelEnabled&&this.visible?(text2.fontStyle=fontStyle,text2.fontWeight=fontWeight,text2.fontSize=fontSize,text2.fontFamily=fontFamily,text2.textAlign="center",text2.textBaseline="bottom",text2.text=labelText,text2.x=x,text2.y=y-10,text2.fill=color6,text2.visible=!0):text2.visible=!1})}getTooltipContent(datumIndex){var _a294;const{id:seriesId,dataModel,processedData,axes,properties}=this,{xKey,xName,yKey,yName,tooltip,marker}=properties,xAxis=axes.x,yAxis=axes.y;if(!dataModel||!processedData||!xAxis||!yAxis)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],xValue=dataModel.resolveKeysById(this,"xValue",processedData)[datumIndex],yValue=dataModel.resolveColumnById(this,"yValueRaw",processedData)[datumIndex],{xDomain,yDomain}=this.cachedDatumCallback("domain",()=>({xDomain:this.getSeriesDomain("x"),yDomain:this.getSeriesDomain("y")}));if(xValue==null)return;const style=marker.getStyle(),nodeDatum={xValue,yValue},activeStyle=this.getMarkerStyle(marker,datum,datumStylerProperties(nodeDatum,xKey,yKey,xDomain,yDomain),!1,void 0,style);return tooltip.formatTooltip(this.properties,{heading:xAxis.formatDatum(xValue),symbol:this.legendItemSymbol(),data:[{label:yName,fallbackLabel:yKey,value:yAxis.formatDatum(yValue)}]},{seriesId,datum,title:yName,xKey,xName,yKey,yName,...activeStyle,...this.getModuleTooltipParams()})}legendItemSymbol(){const{fill,stroke:stroke2,fillOpacity,strokeOpacity,strokeWidth,lineDash,marker,fillGradientDefaults:fillGradientDefaults2,fillPatternDefaults:fillPatternDefaults2}=this.properties,useAreaFill=!marker.enabled||marker.fill===void 0,legendMarkerFill=useAreaFill?getShapeFill(fill,fillGradientDefaults2,fillPatternDefaults2):getShapeFill(marker.fill,marker.fillGradientDefaults,marker.fillPatternDefaults);return{marker:{...this.getMarkerStyle(marker,void 0,void 0,!1,void 0,{fill:legendMarkerFill,fillOpacity:useAreaFill?fillOpacity:marker.fillOpacity}),enabled:marker.enabled||strokeWidth<=0},line:{stroke:stroke2,strokeOpacity,strokeWidth,lineDash}}}getLegendData(legendType){if(!this.properties.isValid()||legendType!=="category")return[];const{id:seriesId,ctx:{legendManager},visible}=this,{yKey:itemId,yName,legendItemName,showInLegend}=this.properties;return[{legendType,id:seriesId,itemId,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId}),label:{text:legendItemName??yName??itemId},symbol:this.legendItemSymbol(),legendItemName,hideInLegend:!showInLegend}]}animateEmptyUpdateReady(animationData){const{markerSelection,labelSelection,contextData,paths}=animationData,{animationManager}=this.ctx;this.updateAreaPaths(paths,contextData),pathSwipeInAnimation(this,animationManager,...paths),resetMotion([markerSelection],resetMarkerPositionFn),markerSwipeScaleInAnimation(this,animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection)}animateReadyResize(animationData){const{contextData,paths}=animationData;this.updateAreaPaths(paths,contextData),super.animateReadyResize(animationData)}animateWaitingUpdateReady(animationData){const{animationManager}=this.ctx,{markerSelection,labelSelection,contextData,paths,previousContextData}=animationData,[fill,stroke2]=paths;if(fill==null&&stroke2==null)return;this.resetMarkerAnimation(animationData),this.resetLabelAnimation(animationData);const update=__name(()=>{this.resetPathAnimation(animationData),this.updateAreaPaths(paths,contextData)},"update"),skip=__name(()=>{animationManager.skipCurrentBatch(),update()},"skip");if(contextData==null||previousContextData==null){update(),markerFadeInAnimation(this,animationManager,"added",markerSelection),pathFadeInAnimation(this,"fill_path_properties",animationManager,"add",fill),pathFadeInAnimation(this,"stroke_path_properties",animationManager,"add",stroke2),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection);return}if(contextData.crossFiltering!==previousContextData.crossFiltering){skip();return}const fns=prepareAreaPathAnimation(contextData,previousContextData);if(fns===void 0){skip();return}else if(fns.status==="no-op")return;markerFadeInAnimation(this,animationManager,void 0,markerSelection),fromToMotion(this.id,"fill_path_properties",animationManager,[fill],fns.fill.pathProperties),pathMotion(this.id,"fill_path_update",animationManager,[fill],fns.fill.path),fromToMotion(this.id,"stroke_path_properties",animationManager,[stroke2],fns.stroke.pathProperties),pathMotion(this.id,"stroke_path_update",animationManager,[stroke2],fns.stroke.path),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:__name(()=>this.updateAreaPaths(paths,contextData),"onComplete")})}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey}=datum,xDomain=this.getSeriesDomain("x"),yDomain=this.getSeriesDomain("y");return this.getMarkerStyle(this.properties.marker,datum.datum,datumStylerProperties(datum,xKey,yKey,xDomain,yDomain),!0)}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a216,"AreaSeries"),_a216);AreaSeries.className="AreaSeries";AreaSeries.type="area";var numberFormatValidator=attachDescription(isValidNumberFormat,"a valid number format string"),commonCrossLineLabelOptionsDefs={enabled:boolean,text:string,padding:number,...fontOptionsDef},commonCrossLineOptionsDefs=attachDescription({enabled:boolean,type:required(union("line","range")),range:and(attachDescription((_,{options})=>options.type==="range","crossLine type to be 'range'"),arrayOf(defined),arrayLength(2,2)),value:and(attachDescription((_,{options})=>options.type==="line","crossLine type to be 'line'"),defined),label:commonCrossLineLabelOptionsDefs,fill:string,fillOpacity:ratio,...strokeOptionsDef,...lineDashOptionsDef},"cross-line options"),cartesianCrossLineOptionsDefs={...commonCrossLineOptionsDefs,label:{...commonCrossLineLabelOptionsDefs,position:union("top","left","right","bottom","top-left","top-right","bottom-left","bottom-right","inside","inside-left","inside-right","inside-top","inside-bottom","inside-top-left","inside-bottom-left","inside-top-right","inside-bottom-right"),rotation:number}},commonAxisLabelOptionsDefs={enabled:boolean,rotation:number,avoidCollisions:boolean,minSpacing:positiveNumber,spacing:positiveNumber,formatter:callback,itemStyler:callback,...fontOptionsDef},cartesianAxisLabelOptionsDefs={autoRotate:boolean,autoRotateAngle:number,...commonAxisLabelOptionsDefs},commonAxisOptionsDefs={reverse:boolean,gridLine:{enabled:boolean,width:positiveNumber,style:arrayOfDefs({stroke:color,lineDash:arrayOf(positiveNumber)},"a grid-line style object array")},interval:{values:arrayOf(defined),minSpacing:positiveNumber},label:commonAxisLabelOptionsDefs,line:{enabled:boolean,width:positiveNumber,stroke:color},tick:{enabled:boolean,width:positiveNumber,size:positiveNumber,stroke:color}};commonAxisOptionsDefs.context=defined;commonAxisOptionsDefs.layoutConstraints={stacked:required(boolean),align:required(union("start","end")),unit:required(union("percent","px")),width:required(positiveNumber)};var cartesianAxisOptionsDefs={...commonAxisOptionsDefs,keys:arrayOf(string),crossLines:arrayOfDefs(cartesianCrossLineOptionsDefs,"a cross-line options array"),position:union("top","right","bottom","left"),thickness:positiveNumber,title:{enabled:boolean,text:string,spacing:positiveNumber,formatter:callback,...fontOptionsDef}};function cartesianAxisCrosshairOptions(canFormat){const crosshairLabel={enabled:boolean,xOffset:number,yOffset:number,renderer:callback};return canFormat&&(crosshairLabel.format=string),{enabled:boolean,snap:boolean,label:crosshairLabel,...strokeOptionsDef,...lineDashOptionsDef}}__name(cartesianAxisCrosshairOptions,"cartesianAxisCrosshairOptions");function continuousAxisOptions(validDatum,supportTimeInterval){return{min:and(validDatum,lessThan("max")),max:and(validDatum,greaterThan("min")),nice:boolean,interval:{step:supportTimeInterval?or(positiveNumberNonZero,or(positiveNumberNonZero,instanceOf(TimeInterval))):positiveNumberNonZero,values:arrayOf(validDatum),minSpacing:and(positiveNumber,lessThan("maxSpacing")),maxSpacing:and(positiveNumber,greaterThan("minSpacing"))}}}__name(continuousAxisOptions,"continuousAxisOptions");var shapeValidator=or(union("circle","cross","diamond","heart","plus","pin","square","star","triangle"),callback),textWrapValidator=union("never","always","hyphenate","on-space"),tooltipPlacementValidator=union("top","right","bottom","left","top-right","bottom-right","bottom-left","top-left","center"),tooltipDeprecatedTypeValidator=union("pointer","node","top","right","bottom","left","top-left","top-right","bottom-left","bottom-right"),rangeValidator2=or(positiveNumber,union("exact","nearest")),zoomAnchorPoint=union("pointer","start","middle","end"),chartCaptionOptionsDefs={enabled:boolean,text:string,textAlign:union("left","center","right"),wrapping:union("never","always","hyphenate","on-space"),spacing:positiveNumber,maxWidth:positiveNumber,maxHeight:positiveNumber,...fontOptionsDef},chartOverlayOptionsDefs={enabled:boolean,text:string,renderer:callback},contextMenuActionsArray=arrayOfDefs({label:string,action:callback},"a context menu actions array"),toolbarButtonOptionsDefs={label:string,ariaLabel:string,tooltip:string,icon:union("align-center","align-left","align-right","arrow-drawing","arrow-down-drawing","arrow-up-drawing","callout-annotation","candlestick-series","close","comment-annotation","date-range-drawing","date-price-range-drawing","delete","disjoint-channel-drawing","drag-handle","fill-color","line-style-solid","line-style-dashed","line-style-dotted","high-low-series","hlc-series","hollow-candlestick-series","horizontal-line-drawing","line-color","line-series","line-with-markers-series","locked","measurer-drawing","note-annotation","ohlc-series","pan-end","pan-left","pan-right","pan-start","parallel-channel-drawing","position-bottom","position-center","position-top","price-label-annotation","price-range-drawing","reset","settings","step-line-series","text-annotation","trend-line-drawing","fibonacci-retracement-drawing","fibonacci-retracement-trend-based-drawing","unlocked","vertical-line-drawing","zoom-in","zoom-out")},commonChartOptionsDefs={width:positiveNumber,height:positiveNumber,minWidth:positiveNumber,minHeight:positiveNumber,suppressFieldDotNotation:boolean,title:chartCaptionOptionsDefs,subtitle:chartCaptionOptionsDefs,footnote:chartCaptionOptionsDefs,padding:{top:positiveNumber,right:positiveNumber,bottom:positiveNumber,left:positiveNumber},seriesArea:{clip:boolean,padding:{top:positiveNumber,right:positiveNumber,bottom:positiveNumber,left:positiveNumber}},legend:{enabled:boolean,position:union("top","right","bottom","left"),orientation:union("horizontal","vertical"),maxWidth:positiveNumber,maxHeight:positiveNumber,spacing:positiveNumber,preventHidingAll:boolean,reverseOrder:boolean,toggleSeries:boolean,item:{marker:{size:positiveNumber,shape:shapeValidator,padding:positiveNumber,strokeWidth:positiveNumber},line:{length:positiveNumber,strokeWidth:positiveNumber},label:{maxLength:positiveNumber,formatter:callback,...fontOptionsDef},maxWidth:positiveNumber,paddingX:positiveNumber,paddingY:positiveNumber,showSeriesStroke:boolean},pagination:{marker:{size:positiveNumber,shape:shapeValidator,padding:positiveNumber},activeStyle:{...fillOptionsDef,...strokeOptionsDef},inactiveStyle:{...fillOptionsDef,...strokeOptionsDef},highlightStyle:{...fillOptionsDef,...strokeOptionsDef},label:fontOptionsDef},listeners:{legendItemClick:callback,legendItemDoubleClick:callback}},gradientLegend:{enabled:boolean,position:union("top","right","bottom","left"),spacing:positiveNumber,reverseOrder:boolean,gradient:{preferredLength:positiveNumber,thickness:positiveNumber},scale:{label:{...fontOptionsDef,format:numberFormatValidator,formatter:callback},padding:positiveNumber,interval:{step:number,values:array,minSpacing:and(positiveNumber,lessThan("maxSpacing")),maxSpacing:and(positiveNumber,greaterThan("minSpacing"))}}},listeners:{seriesNodeClick:callback,seriesNodeDoubleClick:callback,seriesVisibilityChange:callback,click:callback,doubleClick:callback,annotations:callback,zoom:callback},highlight:{range:union("tooltip","node")},overlays:{loading:chartOverlayOptionsDefs,noData:chartOverlayOptionsDefs,noVisibleSeries:chartOverlayOptionsDefs,unsupportedBrowser:chartOverlayOptionsDefs},tooltip:{enabled:boolean,showArrow:boolean,pagination:boolean,delay:positiveNumber,range:rangeValidator2,wrapping:textWrapValidator,mode:union("single","shared","compact"),position:{type:tooltipDeprecatedTypeValidator,anchorTo:union("pointer","node","chart"),placement:or(tooltipPlacementValidator,arrayOf(tooltipPlacementValidator)),xOffset:number,yOffset:number}},animation:{enabled:boolean,duration:positiveNumber},contextMenu:{enabled:boolean,extraActions:contextMenuActionsArray,extraSeriesAreaActions:contextMenuActionsArray,extraNodeActions:contextMenuActionsArray,extraLegendItemActions:contextMenuActionsArray},dataSource:{getData:callback},keyboard:{enabled:boolean,tabIndex:number},touch:{dragAction:union("none","drag","hover")},ranges:{enabled:boolean,buttons:arrayOfDefs({...toolbarButtonOptionsDefs,value:or(number,and(arrayOf(or(number,date)),arrayLength(2,2)),callback)},"range button options array")},locale:{localeText:object,getLocaleText:callback},background:{visible:boolean,fill:color,image:{url:string,top:number,right:number,bottom:number,left:number,width:positiveNumber,height:positiveNumber,opacity:ratio}},sync:{enabled:boolean,groupId:string,axes:union("x","y","xy"),nodeInteraction:boolean,zoom:boolean},zoom:{enabled:boolean,enableAxisDragging:boolean,enableDoubleClickToReset:boolean,enablePanning:boolean,enableScrolling:boolean,enableSelecting:boolean,enableTwoFingerZoom:boolean,keepAspectRatio:boolean,anchorPointX:zoomAnchorPoint,anchorPointY:zoomAnchorPoint,axes:union("x","y","xy"),deceleration:or(union("off","short","long"),ratio),minVisibleItems:positiveNumber,minVisibleItemsX:positiveNumber,minVisibleItemsY:positiveNumber,panKey:union("alt","ctrl","meta","shift"),scrollingStep:ratio,autoScaling:{enabled:boolean,padding:ratio},buttons:{enabled:boolean,buttons:arrayOfDefs({...toolbarButtonOptionsDefs,value:union("reset","zoom-in","zoom-out","pan-left","pan-right","pan-start","pan-end"),section:string},"zoom button options array"),visible:union("always","zoomed","hover")}}};commonChartOptionsDefs.dataSource.requestThrottle=positiveNumber;commonChartOptionsDefs.dataSource.updateThrottle=positiveNumber;commonChartOptionsDefs.dataSource.updateDuringInteraction=boolean;commonChartOptionsDefs.zoom.enableIndependentAxes=boolean;commonChartOptionsDefs.statusBar=defined;commonChartOptionsDefs.foreground={visible:boolean,text:string,image:{url:string,top:number,right:number,bottom:number,left:number,width:positiveNumber,height:positiveNumber,opacity:ratio},...fillOptionsDef};commonChartOptionsDefs.overrideDevicePixelRatio=number;var commonSeriesOptionsDefs={id:string,cursor:string,visible:boolean,data:arrayOf(object),showInLegend:boolean,nodeClickRange:rangeValidator2,listeners:{nodeClick:callback,nodeDoubleClick:callback},highlightStyle:{item:{...fillOptionsDef,...strokeOptionsDef},series:{enabled:boolean,dimOpacity:ratio,strokeWidth:positiveNumber}}};commonSeriesOptionsDefs.context=defined;commonSeriesOptionsDefs.seriesGrouping=defined;commonSeriesOptionsDefs.highlight={enabled:boolean};var markerOptionsDefs={enabled:boolean,shape:shapeValidator,size:positiveNumber,itemStyler:callback,...fillOptionsDef,...strokeOptionsDef,...lineDashOptionsDef},seriesLabelOptionsDefs={enabled:boolean,formatter:callback,...fontOptionsDef},autoSizedLabelOptionsDefs={...seriesLabelOptionsDefs,lineHeight:positiveNumber,minimumFontSize:positiveNumber,wrapping:textWrapValidator,overflowStrategy:union("ellipsis","hide")},errorBarOptionsDefs={visible:boolean,xLowerKey:string,xUpperKey:string,yLowerKey:string,yUpperKey:string,xLowerName:string,xUpperName:string,yLowerName:string,yUpperName:string,itemStyler:callback,cap:{visible:boolean,length:positiveNumber,lengthRatio:ratio,...strokeOptionsDef,...lineDashOptionsDef},...strokeOptionsDef,...lineDashOptionsDef},tooltipOptionsDefs={enabled:boolean,showArrow:boolean,range:rangeValidator2,renderer:callback,position:{type:tooltipDeprecatedTypeValidator,anchorTo:union("node","pointer","chart"),placement:or(tooltipPlacementValidator,arrayOf(tooltipPlacementValidator)),xOffset:number,yOffset:number},interaction:{enabled:boolean}};tooltipOptionsDefs.position._seriesOverrideType=tooltipDeprecatedTypeValidator;var shadowOptionsDefs={enabled:boolean,xOffset:number,yOffset:number,blur:positiveNumber,color},interpolationValidator=typeUnion({linear:{},smooth:{tension:ratio},step:{position:union("start","middle","end")}},"interpolation line options"),areaSeriesOptionsDef={type:required(constant("area")),xKey:required(string),yKey:required(string),xName:string,yName:string,stacked:boolean,stackGroup:string,normalizedTo:number,showInMiniChart:boolean,connectMissingData:boolean,interpolation:interpolationValidator,label:seriesLabelOptionsDefs,marker:markerOptionsDefs,tooltip:tooltipOptionsDefs,shadow:shadowOptionsDefs,...commonSeriesOptionsDefs,...fillOptionsDef,...strokeOptionsDef,...lineDashOptionsDef},AreaSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"area",moduleFactory:__name(ctx=>new AreaSeries(ctx),"moduleFactory"),stackable:!0,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{nodeClickRange:"nearest",tooltip:{position:{_seriesOverrideType:"node"}},fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:FILL_PATTERN_DEFAULTS,stroke:{$palette:"stroke"},fillOpacity:.8,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},interpolation:{type:"linear"},marker:{enabled:!1,shape:"circle",size:7,strokeWidth:0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:FILL_PATTERN_DEFAULTS},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}}}},NewAreaSeriesModule={type:"series",name:"area",chartType:"cartesian",options:areaSeriesOptionsDef,create:__name(ctx=>new AreaSeries(ctx),"create")};function addHitTestersToQuadtree(quadtree,hitTesters){for(const node of hitTesters){const datum=node.datum;datum===void 0?logger_exports.error("undefined datum"):quadtree.addValue(node,datum)}}__name(addHitTestersToQuadtree,"addHitTestersToQuadtree");function findQuadtreeMatch(series,point){const{x,y}=point,{nearest,distanceSquared:distanceSquared2}=series.getQuadTree().find(x,y);if(nearest!==void 0)return{datum:nearest.value,distance:Math.sqrt(distanceSquared2)}}__name(findQuadtreeMatch,"findQuadtreeMatch");var _a217,AbstractBarSeriesProperties=(_a217=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.direction="vertical"}},__name(_a217,"AbstractBarSeriesProperties"),_a217);__decorateClass([TempValidate()],AbstractBarSeriesProperties.prototype,"direction",2);var _a218,AbstractBarSeries=(_a218=class extends CartesianSeries{constructor(){super(...arguments),this.groupScale=new CategoryScale,this.smallestDataInterval=void 0,this.largestDataInterval=void 0}padBandExtent(keys,alignStart){const ratio5=typeof alignStart=="boolean"?1:.5,scalePadding=isFiniteNumber(this.smallestDataInterval)?this.smallestDataInterval*ratio5:0,keysExtent=extent(keys)??[NaN,NaN];return typeof alignStart=="boolean"?keysExtent[alignStart?0:1]-=(alignStart?1:-1)*scalePadding:(keysExtent[0]-=scalePadding,keysExtent[1]+=scalePadding),fixNumericExtent(keysExtent)}getBandScalePadding(){return{inner:.3,outer:.15}}shouldFlipXY(){return!this.isVertical()}isVertical(){return this.properties.direction==="vertical"}getBarDirection(){return this.shouldFlipXY()?"x":"y"}getCategoryDirection(){return this.shouldFlipXY()?"y":"x"}getValueAxis(){const direction=this.getBarDirection();return this.axes[direction]}getCategoryAxis(){const direction=this.getCategoryDirection();return this.axes[direction]}getBandwidth(xAxis){return ContinuousScale.is(xAxis.scale)?xAxis.scale.calcBandwidth(this.smallestDataInterval):xAxis.scale.bandwidth}xCoordinateRange(xValue){const xAxis=this.axes[this.getCategoryDirection()],xScale=xAxis.scale,bandWidth=this.getBandwidth(xAxis)??0,barOffset=ContinuousScale.is(xScale)?bandWidth*-.5:0,x=xScale.convert(xValue)+barOffset;return[x,x+bandWidth]}yCoordinateRange(yValues){const yScale=this.axes[this.getBarDirection()].scale,ys=yValues.map(yValue=>yScale.convert(yValue));if(ys.length===1){const y0=yScale.convert(0);return[Math.min(ys[0],y0),Math.max(ys[0],y0)]}return[Math.min(...ys),Math.max(...ys)]}updateGroupScale(xAxis){const domain=[],{groupScale}=this,xBandWidth=this.getBandwidth(xAxis),{index:groupIndex,visibleGroupCount}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);for(let groupIdx=0;groupIdx<visibleGroupCount;groupIdx++)domain.push(String(groupIdx));return groupScale.domain=domain,groupScale.range=[0,xBandWidth??0],xAxis instanceof GroupedCategoryAxis?groupScale.paddingInner=xAxis.groupPaddingInner:xAxis instanceof CategoryAxis?(groupScale.paddingInner=xAxis.groupPaddingInner,groupScale.round=groupScale.padding!==0):groupScale.padding=0,{barWidth:groupScale.bandwidth>=1?groupScale.bandwidth:groupScale.rawBandwidth,groupIndex}}resolveKeyDirection(direction){return this.getBarDirection()==="x"?direction==="x"?"y":"x":direction}initQuadTree(quadtree){addHitTestersToQuadtree(quadtree,this.datumNodesIter())}pickNodeClosestDatum(point){return findQuadtreeMatch(this,point)}},__name(_a218,"AbstractBarSeries"),_a218),_a219,BarSeriesLabel=(_a219=class extends Label{constructor(){super(...arguments),this.placement="inside-center",this.padding=0}},__name(_a219,"BarSeriesLabel"),_a219);__decorateClass([TempValidate(UNION(["inside-center","inside-start","inside-end","outside-start","outside-end"],"a placement"))],BarSeriesLabel.prototype,"placement",2);__decorateClass([TempValidate()],BarSeriesLabel.prototype,"padding",2);var _a220,BarSeriesProperties=(_a220=class extends AbstractBarSeriesProperties{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new FillGradientDefaults,this.fillPatternDefaults=new FillPatternDefaults,this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.crisp=void 0,this.shadow=new DropShadow,this.label=new BarSeriesLabel,this.tooltip=new SeriesTooltip,this.sparklineMode=!1,this.fastDataProcessing=!1}},__name(_a220,"BarSeriesProperties"),_a220);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"xKey",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"xName",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"yKey",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"yName",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"yFilterKey",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"stackGroup",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"normalizedTo",2);__decorateClass([TempValidate(OR(COLOR_GRADIENT,COLOR_PATTERN,COLOR_STRING))],BarSeriesProperties.prototype,"fill",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"fillGradientDefaults",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"fillPatternDefaults",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"fillOpacity",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"stroke",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"strokeWidth",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"lineDash",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"cornerRadius",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"crisp",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"itemStyler",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"shadow",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"label",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"tooltip",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"sparklineMode",2);__decorateClass([TempValidate()],BarSeriesProperties.prototype,"fastDataProcessing",2);function checkCrisp(scale2,visibleRange,smallestDataInterval,largestDataInterval){if(visibleRange!=null){const[visibleMin,visibleMax]=visibleRange;if(visibleMin!==0||visibleMax!==1)return!1}if(ContinuousScale.is(scale2)){const spacing=scale2.calcBandwidth(largestDataInterval)-scale2.calcBandwidth(smallestDataInterval);if(spacing>0&&spacing<1)return!1}return!0}__name(checkCrisp,"checkCrisp");var isDatumNegative=__name(datum=>isNegative(datum.yValue??0),"isDatumNegative");function collapsedStartingBarPosition(isVertical,axes,mode){const{startingX,startingY}=getStartingValues(isVertical,axes);return{isVertical,calculate:__name((datum,prevDatum)=>{let x=isVertical?datum.x:startingX,y=isVertical?startingY:datum.y,width2=isVertical?datum.width:0,height2=isVertical?0:datum.height;const{opacity=1}=datum;prevDatum&&(isNaN(x)||isNaN(y))&&({x,y}=prevDatum,width2=isVertical?prevDatum.width:0,height2=isVertical?0:prevDatum.height,isVertical&&!isDatumNegative(prevDatum)?y+=prevDatum.height:!isVertical&&isDatumNegative(prevDatum)&&(x+=prevDatum.width));let clipBBox;return datum.clipBBox==null?clipBBox=void 0:isDatumNegative(datum)?clipBBox=isVertical?new BBox(x,y-height2,width2,height2):new BBox(x-width2,y,width2,height2):clipBBox=new BBox(x,y,width2,height2),{x,y,width:width2,height:height2,clipBBox,opacity}},"calculate"),mode}}__name(collapsedStartingBarPosition,"collapsedStartingBarPosition");function midpointStartingBarPosition(isVertical,mode){return{isVertical,calculate:__name(datum=>({x:isVertical?datum.x:datum.x+datum.width/2,y:isVertical?datum.y+datum.height/2:datum.y,width:isVertical?datum.width:0,height:isVertical?0:datum.height,clipBBox:datum.clipBBox,opacity:datum.opacity??1}),"calculate"),mode}}__name(midpointStartingBarPosition,"midpointStartingBarPosition");function prepareBarAnimationFunctions(initPos){const isRemoved=__name(datum=>datum==null||isNaN(datum.x)||isNaN(datum.y),"isRemoved");return{toFn:__name((rect,datum,status)=>status==="removed"&&rect.datum==null&&initPos.mode==="fade"?{...resetBarSelectionsFn(rect,datum),opacity:0}:status==="removed"||isRemoved(datum)?initPos.calculate(datum,rect.previousDatum):{x:datum.x,y:datum.y,width:datum.width,height:datum.height,clipBBox:datum.clipBBox,opacity:datum.opacity??1},"toFn"),fromFn:__name((rect,datum,status)=>{status==="updated"&&isRemoved(datum)?status="removed":status==="updated"&&isRemoved(rect.previousDatum)&&(status="added");let source;status==="added"&&rect.previousDatum==null&&initPos.mode==="fade"?source={...resetBarSelectionsFn(rect,datum),opacity:0}:status==="unknown"||status==="added"?source=initPos.calculate(datum,rect.previousDatum):source={x:rect.x,y:rect.y,width:rect.width,height:rect.height,clipBBox:rect.clipBBox,opacity:rect.opacity??1};const phase=NODE_UPDATE_STATE_TO_PHASE_MAPPING[status];return{...source,phase}},"fromFn"),applyFn:__name((rect,datum,status)=>{var _a294;rect.setProperties(datum),rect.crisp=status==="end"&&(((_a294=rect.datum)==null?void 0:_a294.crisp)??!1)},"applyFn")}}__name(prepareBarAnimationFunctions,"prepareBarAnimationFunctions");function getStartingValues(isVertical,axes){const axis=axes[isVertical?"y":"x"];let startingX=1/0,startingY=0;return axis?(isVertical?startingY=axis.scale.convert(ContinuousScale.is(axis.scale)?0:Math.max(...axis.range)):startingX=axis.scale.convert(ContinuousScale.is(axis.scale)?0:Math.min(...axis.range)),{startingX,startingY}):{startingX,startingY}}__name(getStartingValues,"getStartingValues");function resetBarSelectionsFn(rect,{x,y,width:width2,height:height2,clipBBox,opacity=1}){var _a294;return{x,y,width:width2,height:height2,clipBBox,opacity,crisp:((_a294=rect.datum)==null?void 0:_a294.crisp)??!1}}__name(resetBarSelectionsFn,"resetBarSelectionsFn");function computeBarFocusBounds(series,datum){if(datum===void 0)return;const{x,y,width:width2,height:height2}=datum;return Transformable.toCanvas(series.contentGroup,new BBox(x,y,width2,height2))}__name(computeBarFocusBounds,"computeBarFocusBounds");function updateLabelNode(textNode,label,labelDatum){if(label.enabled&&labelDatum){const{x,y,text:text2,textAlign,textBaseline}=labelDatum,{color:fill,fontStyle,fontWeight,fontSize,fontFamily}=label;textNode.setProperties({visible:!0,x,y,text:text2,fill,fontStyle,fontWeight,fontSize,fontFamily,textAlign,textBaseline})}else textNode.visible=!1}__name(updateLabelNode,"updateLabelNode");var placements={"inside-start":{inside:!0,direction:-1,textAlignment:1},"inside-end":{inside:!0,direction:1,textAlignment:-1},"outside-start":{inside:!1,direction:-1,textAlignment:-1},"outside-end":{inside:!1,direction:1,textAlignment:1}};function adjustLabelPlacement({isUpward,isVertical,placement,padding=0,rect}){let x=rect.x+rect.width/2,y=rect.y+rect.height/2,textAlign="center",textBaseline="middle";if(placement!=="inside-center"){const barDirection=(isUpward?1:-1)*(isVertical?-1:1),{direction,textAlignment}=placements[placement],displacementRatio=(direction+1)*.5;if(isVertical){const y0=isUpward?rect.y+rect.height:rect.y,height2=rect.height*barDirection;y=y0+height2*displacementRatio+padding*textAlignment*barDirection,textBaseline=textAlignment===barDirection?"top":"bottom"}else{const x0=isUpward?rect.x:rect.x+rect.width,width2=rect.width*barDirection;x=x0+width2*displacementRatio+padding*textAlignment*barDirection,textAlign=textAlignment===barDirection?"left":"right"}}return{x,y,textAlign,textBaseline}}__name(adjustLabelPlacement,"adjustLabelPlacement");var X_MIN=0,X_MAX=1,Y_MIN=2,Y_MAX=3,SPAN2=4,_a221,BarSeries=(_a221=class extends AbstractBarSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,categoryKey:"xValue",pickModes:[2,1,0],pathsPerSeries:[],hasHighlightedLabels:!0,datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:resetBarSelectionsFn,label:resetLabelFn}}),this.properties=new BarSeriesProperties,this.connectsToYAxis=!0,this.dataAggregationFilters=void 0}get pickModeAxis(){return this.properties.sparklineMode?"main":void 0}crossFilteringEnabled(){return this.properties.yFilterKey!=null&&(this.seriesGrouping==null||this.seriesGrouping.stackIndex===0)}async processData(dataController){var _a294,_b,_c,_d,_e,_f;if(!this.properties.isValid()||!this.data)return;const{xKey,yKey,yFilterKey,normalizedTo,fastDataProcessing}=this.properties,{seriesGrouping:{groupIndex=this.id}={},data}=this,groupCount2=((_a294=this.seriesGrouping)==null?void 0:_a294.groupCount)??0,stacked=(((_b=this.seriesGrouping)==null?void 0:_b.stackCount)??0)>=1||normalizedTo!=null,grouped=!fastDataProcessing||groupCount2>1||stacked,animationEnabled=!this.ctx.animationManager.isSkipped(),xScale=(_c=this.getCategoryAxis())==null?void 0:_c.scale,yScale=(_d=this.getValueAxis())==null?void 0:_d.scale,{isContinuousX,xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),stackGroupName=`bar-stack-${groupIndex}-yValues`,stackGroupTrailingName=`${stackGroupName}-trailing`,visibleProps=this.visible?{}:{forceValue:0},props=[keyProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValue-raw",invalidValue:null,...visibleProps})];this.crossFilteringEnabled()&&props.push(valueProperty(yFilterKey,yScaleType,{id:"yFilterValue",invalidValue:null,...visibleProps})),stacked&&props.push(...groupAccumulativeValueProperty(yKey,"normal","current",{id:"yValue-end",rangeId:"yValue-range",invalidValue:null,missingValue:0,groupId:stackGroupName,separateNegative:!0,...visibleProps},yScaleType),...groupAccumulativeValueProperty(yKey,"trailing","current",{id:"yValue-start",invalidValue:null,missingValue:0,groupId:stackGroupTrailingName,separateNegative:!0,...visibleProps},yScaleType)),isContinuousX&&props.push(SMALLEST_KEY_INTERVAL,LARGEST_KEY_INTERVAL),isFiniteNumber(normalizedTo)&&props.push(normaliseGroupTo([stackGroupName,stackGroupTrailingName],Math.abs(normalizedTo))),animationEnabled&&this.processedData&&props.push(diff(this.id,this.processedData)),(animationEnabled||!grouped)&&props.push(animationValidation());const{dataModel,processedData}=await this.requestDataModel(dataController,data,{props,groupByKeys:grouped,groupByData:!grouped});this.dataAggregationFilters=this.aggregateData(dataModel,processedData),this.smallestDataInterval=(_e=processedData.reduced)==null?void 0:_e.smallestKeyInterval,this.largestDataInterval=(_f=processedData.reduced)==null?void 0:_f.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(direction){var _a294;const{processedData,dataModel}=this;if(dataModel==null||processedData==null)return[];if(direction===this.getCategoryDirection()){const keyDef=dataModel.resolveProcessedDataDefById(this,"xValue"),keys=dataModel.getDomain(this,"xValue","key",processedData);return(keyDef==null?void 0:keyDef.def.type)==="key"&&keyDef.def.valueType==="category"?keys:this.padBandExtent(keys)}const yKey=(_a294=this.dataModel)!=null&&_a294.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw";let yExtent=this.domainForClippedRange("y",[yKey],"xValue",!0);const yFilterExtent=this.crossFilteringEnabled()?dataModel.getDomain(this,"yFilterValue","value",processedData):void 0;if(yFilterExtent!=null&&(yExtent=[Math.min(yExtent[0],yFilterExtent[0]),Math.max(yExtent[1],yFilterExtent[1])]),this.getValueAxis()instanceof LogAxis)return fixNumericExtent(yExtent);{const fixedYExtent=Number.isFinite(yExtent[1]-yExtent[0])?[Math.min(0,yExtent[0]),Math.max(0,yExtent[1])]:[];return fixNumericExtent(fixedYExtent)}}getSeriesRange(_direction,visibleRange){var _a294;const yKey=(_a294=this.dataModel)!=null&&_a294.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw",[y0,y1]=this.domainForVisibleRange("y",[yKey],"xValue",visibleRange,!0);return[Math.min(y0,0),Math.max(y1,0)]}getVisibleItems(xVisibleRange,yVisibleRange,minVisibleItems){var _a294;const yKey=(_a294=this.dataModel)!=null&&_a294.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw";return this.countVisibleItems("xValue",[yKey],xVisibleRange,yVisibleRange,minVisibleItems)}aggregateData(_dataModel,_processedData){}createNodeData(){var _a294;const{dataModel,processedData,groupScale,dataAggregationFilters}=this,xAxis=this.getCategoryAxis(),yAxis=this.getValueAxis();if(!dataModel||!processedData||!xAxis||!yAxis||!this.properties.isValid())return;const rawData=(_a294=processedData.dataSources)==null?void 0:_a294.get(this.id);if(rawData==null)return;const xScale=xAxis.scale,yScale=yAxis.scale,{xKey,yKey,xName,yName,legendItemName,label}=this.properties,yReversed=yAxis.isReversed(),{barWidth,groupIndex:groupScaleIndex}=this.updateGroupScale(xAxis),groupOffset=groupScale.convert(String(groupScaleIndex)),barOffset=ContinuousScale.is(xScale)?barWidth*-.5:0,xValues=dataModel.resolveKeysById(this,"xValue",processedData),yRawValues=dataModel.resolveColumnById(this,"yValue-raw",processedData),yFilterValues=this.crossFilteringEnabled()?dataModel.resolveColumnById(this,"yFilterValue",processedData):void 0,animationEnabled=!this.ctx.animationManager.isSkipped(),xPosition=__name(index=>xScale.convert(xValues[index])+groupOffset+barOffset,"xPosition"),crisp=this.properties.crisp??checkCrisp(xAxis==null?void 0:xAxis.scale,xAxis==null?void 0:xAxis.visibleRange,this.smallestDataInterval,this.largestDataInterval),bboxBottom=yScale.convert(0),nodeDatum=__name(({datum,datumIndex,valueIndex,xValue,yValue,cumulativeValue,phantom,currY,prevY,x,width:width2,isPositive,yRange,labelText,opacity,crossScale=1})=>{const isUpward=isPositive!==yReversed,y=yScale.convert(currY),bottomY=yScale.convert(prevY),bboxHeight=yScale.convert(yRange),barAlongX=this.getBarDirection()==="x",xOffset=width2*.5*(1-crossScale),rect={x:barAlongX?Math.min(y,bottomY):x+xOffset,y:barAlongX?x+xOffset:Math.min(y,bottomY),width:barAlongX?Math.abs(bottomY-y):width2*crossScale,height:barAlongX?width2*crossScale:Math.abs(bottomY-y)},clipBBox=new BBox(rect.x,rect.y,rect.width,rect.height),barRect={x:barAlongX?Math.min(bboxBottom,bboxHeight):x+xOffset,y:barAlongX?x+xOffset:Math.min(bboxBottom,bboxHeight),width:barAlongX?Math.abs(bboxBottom-bboxHeight):width2*crossScale,height:barAlongX?width2*crossScale:Math.abs(bboxBottom-bboxHeight)},lengthRatioMultiplier=this.shouldFlipXY()?rect.height:rect.width;return{series:this,itemId:phantom?createDatumId(yKey,phantom):yKey,datum,datumIndex,valueIndex,cumulativeValue,phantom,xValue,yValue,yKey,xKey,capDefaults:{lengthRatioMultiplier,lengthMax:lengthRatioMultiplier},x:barRect.x,y:barRect.y,width:barRect.width,height:barRect.height,midPoint:{x:rect.x+rect.width/2,y:rect.y+rect.height/2},opacity,topLeftCornerRadius:barAlongX!==isUpward,topRightCornerRadius:isUpward,bottomRightCornerRadius:barAlongX===isUpward,bottomLeftCornerRadius:!isUpward,clipBBox,crisp,label:labelText!=null?{text:labelText,...adjustLabelPlacement({isUpward,isVertical:!barAlongX,placement:label.placement,padding:label.padding,rect})}:void 0,missing:yValue==null,focusable:!phantom}},"nodeDatum"),phantomNodes=[],nodes=[],labels=[],handleDatum=__name((datumIndex,valueIndex,x,width2,yStart,yEnd,yRange,opacity)=>{const xValue=xValues[datumIndex];if(xValue==null)return;const yRawValue=yRawValues[datumIndex],yFilterValue=yFilterValues!=null?Number(yFilterValues[datumIndex]):void 0,isPositive=yRawValue>=0&&!Object.is(yRawValue,-0);if(!Number.isFinite(yEnd)||yFilterValue!=null&&!Number.isFinite(yFilterValue))return;const labelText=yRawValue!=null?this.getLabelText(this.properties.label,{datum:rawData[datumIndex],value:yFilterValue??yRawValue,xKey,yKey,xName,yName,legendItemName}):void 0,inset=yFilterValue!=null&&yFilterValue>yRawValue,nodeData=nodeDatum({datum:rawData[datumIndex],datumIndex,valueIndex,xValue,yValue:yFilterValue??yRawValue,cumulativeValue:yFilterValue??yEnd,phantom:!1,currY:yFilterValue!=null?yStart+yFilterValue:yEnd,prevY:yStart,x,width:width2,isPositive,yRange:Math.max(yStart+(yFilterValue??-1/0),yRange),labelText,opacity,crossScale:inset?.6:void 0});if(nodes.push(nodeData),labels.push(nodeData),yFilterValue!=null){const phantomNodeData=nodeDatum({datum:rawData[datumIndex],datumIndex,valueIndex,xValue,yValue:yFilterValue,cumulativeValue:yFilterValue,phantom:!0,currY:yEnd,prevY:yStart,x,width:width2,isPositive,yRange,labelText:void 0,opacity,crossScale:void 0});phantomNodes.push(phantomNodeData)}},"handleDatum"),[r0,r1]=xScale.range,range3=r1-r0,dataAggregationFilter=dataAggregationFilters==null?void 0:dataAggregationFilters.find(f=>f.maxRange>range3);if(processedData.type==="grouped"){const width2=barWidth,stacked=dataModel.hasColumnById(this,"yValue-start"),yStartValues=stacked?dataModel.resolveColumnById(this,"yValue-start",processedData):void 0,yEndValues=stacked?dataModel.resolveColumnById(this,"yValue-end",processedData):void 0,yRangeIndex=stacked?dataModel.resolveProcessedDataIndexById(this,"yValue-range"):-1;for(const{datumIndex,valueIndex,group:{aggregation}}of dataModel.forEachGroupDatum(this,processedData)){const x=xPosition(datumIndex),yRawValue=yRawValues[datumIndex],isPositive=yRawValue>=0&&!Object.is(yRawValue,-0),yStart=stacked?Number(yStartValues==null?void 0:yStartValues[datumIndex]):0,yEnd=stacked?Number(yEndValues==null?void 0:yEndValues[datumIndex]):yRawValue;let yRange=yEnd;stacked&&(yRange=aggregation[yRangeIndex][isPositive?1:0]),handleDatum(datumIndex,valueIndex,x,width2,yStart,yEnd,yRange,1)}}else if(dataAggregationFilter==null){const width2=barWidth;let[start2,end2]=this.visibleRange("xValue",xAxis.range);processedData.input.count<1e3&&(start2=0,end2=processedData.input.count);for(let datumIndex=start2;datumIndex<end2;datumIndex+=1){const x=xPosition(datumIndex),yEnd=Number(yRawValues[datumIndex]);handleDatum(datumIndex,0,x,width2,0,yEnd,yEnd,1)}}else{const{indexData,indices}=dataAggregationFilter,[start2,end2]=this.visibleRange("xValue",xAxis.range,indices);for(let i=start2;i<end2;i+=1){const aggIndex=i*SPAN2,xMinIndex=indexData[aggIndex+X_MIN],xMaxIndex=indexData[aggIndex+X_MAX],yMinIndex=indexData[aggIndex+Y_MIN],yMaxIndex=indexData[aggIndex+Y_MAX];if(xMinIndex===-1)continue;const x=xPosition((xMinIndex+xMaxIndex)/2|0),width2=Math.abs(xPosition(xMaxIndex)-xPosition(xMinIndex))+barWidth,yEndMax=xValues[yMaxIndex]!=null?Number(yRawValues[yMaxIndex]):NaN,yEndMin=xValues[yMinIndex]!=null?Number(yRawValues[yMinIndex]):NaN;if(yEndMax>0){const opacity=yEndMin>=0?yEndMin/yEndMax:1;handleDatum(yMaxIndex,0,x,width2,0,yEndMax,yEndMax,opacity)}if(yEndMin<0){const opacity=yEndMax<=0?yEndMax/yEndMin:1;handleDatum(yMinIndex,1,x,width2,0,yEndMin,yEndMin,opacity)}}}return{itemId:yKey,nodeData:phantomNodes.length>0?[...phantomNodes,...nodes]:nodes,labelData:labels,scales:this.calculateScaling(),visible:this.visible||animationEnabled,groupScale:this.getScaling(this.groupScale)}}nodeFactory(){return new Rect}getHighlightData(nodeData,highlightedItem){const highlightItem=nodeData.find(nodeDatum=>nodeDatum.datum===highlightedItem.datum&&!nodeDatum.phantom);return highlightItem!=null?[highlightItem]:void 0}updateDatumSelection(opts){return opts.datumSelection.update(opts.nodeData,void 0,datum=>this.getDatumId(datum))}getItemBaseStyle(highlighted){const{properties}=this,{cornerRadius,fillGradientDefaults:fillGradientDefaults2,fillPatternDefaults:fillPatternDefaults2}=properties,highlightStyle=highlighted?properties.highlightStyle.item:void 0;return getShapeStyle({fill:(highlightStyle==null?void 0:highlightStyle.fill)??properties.fill,fillOpacity:(highlightStyle==null?void 0:highlightStyle.fillOpacity)??properties.fillOpacity,stroke:(highlightStyle==null?void 0:highlightStyle.stroke)??properties.stroke,strokeWidth:(highlightStyle==null?void 0:highlightStyle.strokeWidth)??this.getStrokeWidth(properties.strokeWidth),strokeOpacity:(highlightStyle==null?void 0:highlightStyle.strokeOpacity)??properties.strokeOpacity,lineDash:(highlightStyle==null?void 0:highlightStyle.lineDash)??properties.lineDash??[],lineDashOffset:(highlightStyle==null?void 0:highlightStyle.lineDashOffset)??properties.lineDashOffset,cornerRadius},fillGradientDefaults2,fillPatternDefaults2)}getItemStyleOverrides(datumId,datum,xValue,yValue,format,highlighted){const{id:seriesId,properties}=this,{xKey,yKey,itemStyler,fillGradientDefaults:fillGradientDefaults2,fillPatternDefaults:fillPatternDefaults2}=properties;if(itemStyler==null)return;const{xDomain,yDomain}=this.cachedDatumCallback("domain",()=>({xDomain:this.getSeriesDomain("x"),yDomain:this.getSeriesDomain("y")})),overrides=this.cachedDatumCallback(createDatumId(datumId,highlighted?"highlight":"node"),()=>this.callWithContext(itemStyler,{seriesId,...datumStylerProperties(datum,xKey,yKey,xDomain,yDomain),datum,xValue,yValue,highlighted,...format}));return getShapeStyle(overrides,fillGradientDefaults2,fillPatternDefaults2)}updateDatumNodes(opts){if(!this.properties.isValid())return;const{shadow}=this.properties,categoryAlongX=this.getCategoryDirection()==="x",style=this.getItemBaseStyle(opts.isHighlight),fillBBox=this.getShapeFillBBox();opts.datumSelection.each((rect,datum)=>{var _a294,_b;const overrides=this.getItemStyleOverrides(String(datum.datumIndex),datum.datum,datum.xValue,datum.yValue,style,opts.isHighlight);rect.opacity=datum.opacity??0,applyShapeStyle(rect,style,overrides,fillBBox);const cornerRadius=(overrides==null?void 0:overrides.cornerRadius)??style.cornerRadius;rect.topLeftCornerRadius=datum.topLeftCornerRadius?cornerRadius:0,rect.topRightCornerRadius=datum.topRightCornerRadius?cornerRadius:0,rect.bottomRightCornerRadius=datum.bottomRightCornerRadius?cornerRadius:0,rect.bottomLeftCornerRadius=datum.bottomLeftCornerRadius?cornerRadius:0,rect.visible=categoryAlongX?(((_a294=datum.clipBBox)==null?void 0:_a294.width)??datum.width)>0:(((_b=datum.clipBBox)==null?void 0:_b.height)??datum.height)>0,rect.crisp=datum.crisp,rect.fillShadow=shadow})}updateLabelSelection(opts){const data=this.isLabelEnabled()?opts.labelData:[];return opts.labelSelection.update(data,text2=>{text2.pointerEvents=1})}updateLabelNodes(opts){opts.labelSelection.each((textNode,datum)=>{updateLabelNode(textNode,this.properties.label,datum.label)})}getTooltipContent(datumIndex){var _a294;const{id:seriesId,dataModel,processedData,properties}=this,{xKey,xName,yKey,yName,legendItemName,stackGroup,tooltip}=properties,xAxis=this.getCategoryAxis(),yAxis=this.getValueAxis();if(!dataModel||!processedData||!xAxis||!yAxis)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],xValue=dataModel.resolveKeysById(this,"xValue",processedData)[datumIndex],yValue=dataModel.resolveColumnById(this,"yValue-raw",processedData)[datumIndex];if(xValue==null)return;const format=this.getItemBaseStyle(!1);return Object.assign(format,this.getItemStyleOverrides(String(datumIndex),datum,xValue,yValue,format,!1)),tooltip.formatTooltip(this.properties,{heading:xAxis.formatDatum(xValue),symbol:this.legendItemSymbol(),data:[{label:yName,fallbackLabel:yKey,value:yAxis.formatDatum(yValue)}]},{seriesId,datum,title:yName,xKey,xName,yKey,yName,legendItemName,stackGroup,...format,...this.getModuleTooltipParams()})}legendItemSymbol(){const{fill,stroke:stroke2,strokeWidth,fillOpacity,strokeOpacity,lineDash,lineDashOffset,fillGradientDefaults:fillGradientDefaults2,fillPatternDefaults:fillPatternDefaults2}=this.properties;return{marker:getShapeStyle({fill:fill??"rgba(0, 0, 0, 0)",stroke:stroke2??"rgba(0, 0, 0, 0)",fillOpacity,strokeOpacity,strokeWidth,lineDash,lineDashOffset},fillGradientDefaults2,fillPatternDefaults2)}}getLegendData(legendType){const{showInLegend}=this.properties;if(legendType!=="category"||!this.properties.isValid())return[];const{id:seriesId,ctx:{legendManager},visible}=this,{yKey:itemId,yName,legendItemName}=this.properties;return[{legendType:"category",id:seriesId,itemId,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId}),label:{text:legendItemName??yName??itemId},symbol:this.legendItemSymbol(),legendItemName,hideInLegend:!showInLegend}]}animateEmptyUpdateReady({datumSelection,labelSelection,annotationSelections}){const fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(this.isVertical(),this.axes,"normal"));fromToMotion(this.id,"nodes",this.ctx.animationManager,[datumSelection],fns),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,...annotationSelections)}animateWaitingUpdateReady(data){var _a294,_b,_c,_d,_e;const{datumSelection,labelSelection,annotationSelections,previousContextData}=data;this.ctx.animationManager.stopByAnimationGroupId(this.id);let dataDiff=(_c=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.diff)==null?void 0:_c[this.id];dataDiff==null&&((_e=(_d=this.processedData)==null?void 0:_d.reduced)==null?void 0:_e.diff)!=null&&(dataDiff={changed:!0,added:new Set(Array.from(datumSelection,({datum})=>this.getDatumId(datum))),updated:new Set,removed:new Set,moved:new Set});const mode=previousContextData==null?"fade":"normal",fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(this.isVertical(),this.axes,mode));fromToMotion(this.id,"nodes",this.ctx.animationManager,[datumSelection],fns,(_,datum)=>this.getDatumId(datum),dataDiff);const scalingChanged=previousContextData!=null&&(!areScalingEqual(data.contextData.scales.x,previousContextData.scales.x)||!areScalingEqual(data.contextData.scales.y,previousContextData.scales.y)||!areScalingEqual(data.contextData.groupScale,data.previousContextData.groupScale));(((dataDiff==null?void 0:dataDiff.changed)??!1)||scalingChanged)&&(seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,...annotationSelections))}getDatumId(datum){return createDatumId(datum.xValue,datum.valueIndex,datum.phantom)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex}){var _a294;const datumBox=(_a294=this.contextNodeData)==null?void 0:_a294.nodeData[datumIndex].clipBBox;return computeBarFocusBounds(this,datumBox)}},__name(_a221,"BarSeries"),_a221);BarSeries.className="BarSeries";BarSeries.type="bar";var barSeriesOptionsDef={type:required(constant("bar")),xKey:required(string),yKey:required(string),xName:string,yName:string,direction:union("horizontal","vertical"),grouped:boolean,stacked:boolean,stackGroup:string,normalizedTo:number,legendItemName:string,showInMiniChart:boolean,cornerRadius:positiveNumber,itemStyler:callback,crisp:boolean,label:{...seriesLabelOptionsDefs,placement:union("inside-center","inside-start","inside-end","outside-start","outside-end"),padding:positiveNumber},errorBar:errorBarOptionsDefs,shadow:shadowOptionsDefs,tooltip:tooltipOptionsDefs,...commonSeriesOptionsDefs,...fillOptionsDef,...strokeOptionsDef,...lineDashOptionsDef};barSeriesOptionsDef.pickOutsideVisibleMinorAxis=boolean;barSeriesOptionsDef.fastDataProcessing=boolean;barSeriesOptionsDef.focusPriority=number;barSeriesOptionsDef.sparklineMode=boolean;var BarSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bar",moduleFactory:__name(ctx=>new BarSeries(ctx),"moduleFactory"),stackable:!0,groupable:!0,tooltipDefaults:{range:"exact"},defaultAxes:DIRECTION_SWAP_AXES,themeTemplate:{series:{direction:"vertical",fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:FILL_PATTERN_DEFAULTS,fillOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$if:[{$or:[{$eq:[{$path:"./placement"},"outside-start"]},{$eq:[{$path:"./placement"},"outside-end"]}]},{$ref:"textColor"},{$ref:"backgroundColor"}]},placement:"inside-center"},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},errorBar:{cap:{lengthRatio:.3}}}}},NewBarSeriesModule={type:"series",name:"bar",chartType:"cartesian",options:barSeriesOptionsDef,create:__name(ctx=>new BarSeries(ctx),"create")},_a222,BubbleSeriesMarker=(_a222=class extends SeriesMarker{constructor(){super(...arguments),this.maxSize=30}},__name(_a222,"BubbleSeriesMarker"),_a222);__decorateClass([TempValidate(),SceneChangeDetection()],BubbleSeriesMarker.prototype,"maxSize",2);__decorateClass([TempValidate(),SceneChangeDetection()],BubbleSeriesMarker.prototype,"domain",2);var _a223,BubbleSeriesLabel=(_a223=class extends Label{constructor(){super(...arguments),this.placement="top"}},__name(_a223,"BubbleSeriesLabel"),_a223);__decorateClass([TempValidate()],BubbleSeriesLabel.prototype,"placement",2);var _a224,BubbleSeriesProperties=(_a224=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.label=new BubbleSeriesLabel,this.tooltip=new SeriesTooltip,this.marker=new BubbleSeriesMarker}},__name(_a224,"BubbleSeriesProperties"),_a224);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"xKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"yKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"sizeKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"labelKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"xFilterKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"yFilterKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"sizeFilterKey",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"xName",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"yName",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"sizeName",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"labelName",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"title",2);__decorateClass([ProxyProperty("marker.shape")],BubbleSeriesProperties.prototype,"shape",2);__decorateClass([ProxyProperty("marker.size")],BubbleSeriesProperties.prototype,"size",2);__decorateClass([ProxyProperty("marker.maxSize")],BubbleSeriesProperties.prototype,"maxSize",2);__decorateClass([ProxyProperty("marker.domain",{optional:!0})],BubbleSeriesProperties.prototype,"domain",2);__decorateClass([ProxyProperty("marker.fillGradientDefaults")],BubbleSeriesProperties.prototype,"fillGradientDefaults",2);__decorateClass([ProxyProperty("marker.fillPatternDefaults")],BubbleSeriesProperties.prototype,"fillPatternDefaults",2);__decorateClass([ProxyProperty("marker.fill",{optional:!0})],BubbleSeriesProperties.prototype,"fill",2);__decorateClass([ProxyProperty("marker.fillOpacity")],BubbleSeriesProperties.prototype,"fillOpacity",2);__decorateClass([ProxyProperty("marker.stroke",{optional:!0})],BubbleSeriesProperties.prototype,"stroke",2);__decorateClass([ProxyProperty("marker.strokeWidth")],BubbleSeriesProperties.prototype,"strokeWidth",2);__decorateClass([ProxyProperty("marker.strokeOpacity")],BubbleSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([ProxyProperty("marker.lineDash")],BubbleSeriesProperties.prototype,"lineDash",2);__decorateClass([ProxyProperty("marker.lineDashOffset")],BubbleSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([ProxyProperty("marker.itemStyler",{optional:!0})],BubbleSeriesProperties.prototype,"itemStyler",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"label",2);__decorateClass([TempValidate()],BubbleSeriesProperties.prototype,"tooltip",2);var _a225,BubbleSeriesNodeEvent=(_a225=class extends CartesianSeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.sizeKey=series.properties.sizeKey}},__name(_a225,"BubbleSeriesNodeEvent"),_a225),_a226,BubbleSeries=(_a226=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,categoryKey:void 0,pickModes:[2,1,0],pathsPerSeries:[],hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{label:resetLabelFn,marker:resetMarkerFn},usesPlacedLabels:!0,clipFocusBox:!1}),this.NodeEvent=BubbleSeriesNodeEvent,this.properties=new BubbleSeriesProperties,this.sizeScale=new LinearScale}get pickModeAxis(){return"main-category"}async processData(dataController){var _a294,_b;if(!this.properties.isValid()||this.data==null||!this.visible)return;const xScale=(_a294=this.axes.x)==null?void 0:_a294.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),sizeScaleType=this.sizeScale.type,{xKey,yKey,sizeKey,xFilterKey,yFilterKey,sizeFilterKey,labelKey,marker}=this.properties,{dataModel,processedData}=await this.requestDataModel(dataController,this.data,{props:[valueProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValue"}),...xFilterKey!=null?[valueProperty(xFilterKey,xScaleType,{id:"xFilterValue"})]:[],...yFilterKey!=null?[valueProperty(yFilterKey,yScaleType,{id:"yFilterValue"})]:[],...sizeFilterKey!=null?[valueProperty(sizeFilterKey,sizeScaleType,{id:"sizeFilterValue"})]:[],valueProperty(sizeKey,sizeScaleType,{id:"sizeValue"}),...labelKey?[valueProperty(labelKey,"band",{id:"labelValue"})]:[]]}),sizeKeyIdx=dataModel.resolveProcessedDataIndexById(this,"sizeValue");this.sizeScale.domain=marker.domain??processedData.domain.values[sizeKeyIdx]??[],this.animationState.transition("updateData")}xCoordinateRange(xValue,pixelSize,index){const{properties,sizeScale}=this,{size,sizeKey}=properties,x=this.axes.x.scale.convert(xValue),sizeValues=sizeKey!=null?this.dataModel.resolveColumnById(this,"sizeValue",this.processedData):void 0,r=.5*(sizeValues!=null?sizeScale.convert(sizeValues[index]):size)*pixelSize;return[x-r,x+r]}yCoordinateRange(yValues,pixelSize,index){const{properties,sizeScale}=this,{size,sizeKey}=properties,y=this.axes.y.scale.convert(yValues[0]),sizeValues=sizeKey!=null?this.dataModel.resolveColumnById(this,"sizeValue",this.processedData):void 0,r=.5*(sizeValues!=null?sizeScale.convert(sizeValues[index]):size)*pixelSize;return[y-r,y+r]}getSeriesDomain(direction){const{dataModel,processedData}=this;if(!processedData||!dataModel)return[];const dataValues={x:"xValue",y:"yValue"},id=dataValues[direction],dataDef=dataModel.resolveProcessedDataDefById(this,id),domain=dataModel.getDomain(this,id,"value",processedData);if((dataDef==null?void 0:dataDef.def.type)==="value"&&(dataDef==null?void 0:dataDef.def.valueType)==="category")return domain;const crossId=dataValues[direction==="x"?"y":"x"],ext=this.domainForClippedRange(direction,[id],crossId,!1);return fixNumericExtent(extent(ext))}getSeriesRange(_direction,visibleRange){return this.domainForVisibleRange("y",["yValue"],"xValue",visibleRange,!1)}getVisibleItems(xVisibleRange,yVisibleRange,minVisibleItems){return this.countVisibleItems("xValue",["yValue"],xVisibleRange,yVisibleRange,minVisibleItems)}createNodeData(){var _a294;const{axes,dataModel,processedData,sizeScale,visible}=this,{xKey,yKey,sizeKey,xFilterKey,yFilterKey,sizeFilterKey,labelKey,xName,yName,sizeName,labelName,label,marker}=this.properties,{placement}=label,anchor=Marker.anchor(marker.shape),xAxis=axes.x,yAxis=axes.y;if(!(dataModel&&processedData&&visible&&xAxis&&yAxis))return;const xDataValues=dataModel.resolveColumnById(this,"xValue",processedData),yDataValues=dataModel.resolveColumnById(this,"yValue",processedData),sizeDataValues=sizeKey!=null?dataModel.resolveColumnById(this,"sizeValue",processedData):void 0,labelDataValues=labelKey!=null?dataModel.resolveColumnById(this,"labelValue",processedData):void 0,xFilterDataValues=xFilterKey!=null?dataModel.resolveColumnById(this,"xFilterValue",processedData):void 0,yFilterDataValues=yFilterKey!=null?dataModel.resolveColumnById(this,"yFilterValue",processedData):void 0,sizeFilterDataValues=sizeFilterKey!=null?dataModel.resolveColumnById(this,"sizeFilterValue",processedData):void 0,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=(xScale.bandwidth??0)/2,yOffset=(yScale.bandwidth??0)/2,nodeData=[];sizeScale.range=[marker.size,marker.maxSize];const font2=label.getFont(),textMeasurer=CachedTextMeasurerPool.getMeasurer({font:font2});return(_a294=processedData.dataSources.get(this.id))==null||_a294.forEach((datum,datumIndex)=>{const xDatum=xDataValues[datumIndex],yDatum=yDataValues[datumIndex],sizeValue=sizeDataValues==null?void 0:sizeDataValues[datumIndex],x=xScale.convert(xDatum)+xOffset,y=yScale.convert(yDatum)+yOffset;let selected;xFilterDataValues!=null&&yFilterDataValues!=null&&(selected=xFilterDataValues[datumIndex]===xDatum&&yFilterDataValues[datumIndex]===yDatum,sizeFilterDataValues!=null&&selected&&(selected=sizeFilterDataValues[datumIndex]===sizeValue));const labelText=this.getLabelText(label,{value:labelDataValues!=null?labelDataValues[datumIndex]:yDatum,datum,xKey,yKey,sizeKey,labelKey,xName,yName,sizeName,labelName}),size=textMeasurer.measureText(String(labelText)),markerSize=sizeValue!=null?sizeScale.convert(sizeValue):marker.size;nodeData.push({series:this,itemId:yKey,yKey,xKey,datum,datumIndex,xValue:xDatum,yValue:yDatum,sizeValue,point:{x,y,size:markerSize},midPoint:{x,y},label:{text:labelText,...size},anchor,placement,selected})}),{itemId:yKey,nodeData,labelData:nodeData,scales:this.calculateScaling(),visible:this.visible}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var _a294;return this.isLabelEnabled()?((_a294=this.contextNodeData)==null?void 0:_a294.labelData)??[]:[]}updateMarkerSelection(opts){const{nodeData,markerSelection}=opts;this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup());const data=this.properties.marker.enabled?nodeData:[];return markerSelection.update(data,void 0,datum=>createDatumId([datum.xValue,datum.yValue,datum.sizeValue,datum.label.text]))}updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,sizeKey,labelKey,marker}=this.properties,baseStyle=mergeDefaults(highlighted&&this.properties.highlightStyle.item,marker.getStyle());this.sizeScale.range=[marker.size,marker.maxSize];const fillBBox=this.getShapeFillBBox();markerSelection.each((node,datum)=>{this.updateMarkerStyle(marker,node,datum.datum,datum.point,{xKey,yKey,sizeKey,labelKey},highlighted,baseStyle,fillBBox,{selected:datum.selected})}),highlighted||this.properties.marker.markClean()}updatePlacedLabelData(labelData){this.labelSelection.update(labelData.map(v=>({...v.datum,point:{x:v.x,y:v.y,size:v.datum.point.size}})),text2=>{text2.pointerEvents=1}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(opts){const{label}=this.properties;opts.labelSelection.each((text2,datum)=>{var _a294,_b;text2.text=datum.label.text,text2.fill=label.color,text2.x=((_a294=datum.point)==null?void 0:_a294.x)??0,text2.y=((_b=datum.point)==null?void 0:_b.y)??0,text2.fontStyle=label.fontStyle,text2.fontWeight=label.fontWeight,text2.fontSize=label.fontSize,text2.fontFamily=label.fontFamily,text2.textAlign="left",text2.textBaseline="top"})}getTooltipContent(datumIndex){var _a294,_b;const{id:seriesId,dataModel,processedData,axes,properties}=this,{xKey,xName,yKey,yName,sizeKey,sizeName,labelKey,labelName,title,tooltip,marker}=properties,xAxis=axes.x,yAxis=axes.y;if(!dataModel||!processedData||!xAxis||!yAxis)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],xValue=dataModel.resolveColumnById(this,"xValue",processedData)[datumIndex],yValue=dataModel.resolveColumnById(this,"yValue",processedData)[datumIndex],nodeDatum=(_b=this.contextNodeData)==null?void 0:_b.nodeData[datumIndex];if(xValue==null||nodeDatum==null)return;const data=[{label:xName,fallbackLabel:xKey,value:xAxis.formatDatum(xValue)},{label:yName,fallbackLabel:yKey,value:yAxis.formatDatum(yValue)}];if(sizeKey!=null){const sizeValue=dataModel.resolveColumnById(this,"sizeValue",processedData)[datumIndex];data.push({label:sizeName,fallbackLabel:sizeKey,value:String(sizeValue)})}const style=marker.getStyle(),activeStyle=this.getMarkerStyle(marker,datum,{xKey,yKey,sizeKey,labelKey,highlighted:!0},!1,void 0,style);return tooltip.formatTooltip(this.properties,{title,symbol:this.legendItemSymbol(),data},{seriesId,datum,title:yKey,xKey,xName,yKey,yName,sizeKey,sizeName,labelKey,labelName,...activeStyle,...this.getModuleTooltipParams()})}legendItemSymbol(){return{marker:this.getMarkerStyle(this.properties.marker)}}getLegendData(){if(!this.properties.isValid())return[];const{id:seriesId,ctx:{legendManager},visible}=this,{yKey:itemId,yName,title}=this.properties;return[{legendType:"category",id:seriesId,itemId,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId}),label:{text:title??yName??itemId},symbol:this.legendItemSymbol()}]}animateEmptyUpdateReady({markerSelection,labelSelection}){markerScaleInAnimation(this,this.ctx.animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey,sizeKey,labelKey,marker}=this.properties;return this.getMarkerStyle(marker,datum,{xKey,yKey,sizeKey,labelKey},!1,datum.point.size)}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a226,"BubbleSeries"),_a226);BubbleSeries.className="BubbleSeries";BubbleSeries.type="bubble";var bubbleSeriesOptionsDef={type:required(constant("bubble")),xKey:required(string),yKey:required(string),sizeKey:required(string),labelKey:string,xName:string,yName:string,sizeName:string,labelName:string,title:string,domain:arrayOf(number),maxSize:positiveNumber,showInMiniChart:boolean,label:{placement:union("top","right","bottom","left"),...seriesLabelOptionsDefs},tooltip:tooltipOptionsDefs,...commonSeriesOptionsDefs,...without(markerOptionsDefs,["enabled"])},BubbleSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bubble",moduleFactory:__name(ctx=>new BubbleSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,maxSize:30,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:FILL_PATTERN_DEFAULTS,fillOpacity:.8,tooltip:{position:{_seriesOverrideType:"node"}},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}}}},NewBubbleSeriesModule={type:"series",name:"bubble",chartType:"cartesian",options:bubbleSeriesOptionsDef,create:__name(ctx=>new BubbleSeries(ctx),"create")},_a227,HistogramSeriesProperties=(_a227=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.fillGradientDefaults=new FillGradientDefaults,this.fillPatternDefaults=new FillPatternDefaults,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.areaPlot=!1,this.aggregation="sum",this.shadow=new DropShadow,this.label=new Label,this.tooltip=new SeriesTooltip}},__name(_a227,"HistogramSeriesProperties"),_a227);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"xKey",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"yKey",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"xName",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"yName",2);__decorateClass([TempValidate(OR(COLOR_GRADIENT,COLOR_PATTERN,COLOR_STRING))],HistogramSeriesProperties.prototype,"fill",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"fillGradientDefaults",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"fillPatternDefaults",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"fillOpacity",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"stroke",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"strokeWidth",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"lineDash",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"cornerRadius",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"areaPlot",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"bins",2);__decorateClass([TempValidate(UNION(["count","sum","mean"],"a histogram aggregation"))],HistogramSeriesProperties.prototype,"aggregation",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"binCount",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"shadow",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"label",2);__decorateClass([TempValidate()],HistogramSeriesProperties.prototype,"tooltip",2);var defaultBinCount=10,_a228,HistogramSeries=(_a228=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,categoryKey:void 0,pickModes:[1,0],datumSelectionGarbageCollection:!1,animationResetFns:{datum:resetBarSelectionsFn,label:resetLabelFn}}),this.properties=new HistogramSeriesProperties,this.calculatedBins=[]}deriveBins(xDomain){const binStarts=createTicks(xDomain[0],xDomain[1],defaultBinCount),binSize=tickStep(xDomain[0],xDomain[1],defaultBinCount),[firstBinEnd]=binStarts,expandStartToBin=__name(n=>[n,n+binSize],"expandStartToBin");return[[firstBinEnd-binSize,firstBinEnd],...binStarts.map(expandStartToBin)]}calculateNiceBins(domain,binCount){const startGuess=Math.floor(domain[0]),stop=domain[1],segments=binCount||1,{start:start2,binSize}=this.calculateNiceStart(startGuess,stop,segments);return this.getBins(start2,stop,binSize,segments)}getBins(start2,stop,step,count){const bins=[],precision=this.calculatePrecision(step);for(let i=0;i<count;i++){const a=Math.round((start2+i*step)*precision)/precision;let b=Math.round((start2+(i+1)*step)*precision)/precision;i===count-1&&(b=Math.max(b,stop)),bins[i]=[a,b]}return bins}calculatePrecision(step){let precision=10;if(isFinite(step)&&step>0)for(;step<1;)precision*=10,step*=10;return precision}calculateNiceStart(a,b,segments){const binSize=Math.abs(b-a)/segments,order=Math.floor(Math.log10(binSize)),magnitude=Math.pow(10,order);return{start:Math.floor(a/magnitude)*magnitude,binSize}}async processData(dataController){var _a294,_b;this.visible||(this.processedData=void 0,this.animationState.transition("updateData"));const{xKey,yKey,areaPlot,aggregation}=this.properties,xScale=(_a294=this.axes.x)==null?void 0:_a294.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({yScale,xScale}),props=[keyProperty(xKey,xScaleType),SORT_DOMAIN_GROUPS];if(yKey){let aggProp=groupCount("groupAgg");aggregation==="count"||(aggregation==="sum"?aggProp=groupSum("groupAgg"):aggregation==="mean"&&(aggProp=groupAverage("groupAgg"))),areaPlot&&(aggProp=area("groupAgg",aggProp)),props.push(valueProperty(yKey,yScaleType,{invalidValue:void 0}),aggProp)}else{props.push(rowCountProperty("count"));let aggProp=groupCount("groupAgg");areaPlot&&(aggProp=area("groupAgg",aggProp)),props.push(aggProp)}const groupByFn=__name(dataSet=>{const xExtent=fixNumericExtent(dataSet.domain.keys[0]);if(xExtent.length===0)return dataSet.domain.groups=[],()=>[];const bins=isNumber(this.properties.binCount)?this.calculateNiceBins(xExtent,this.properties.binCount):this.properties.bins??this.deriveBins(xExtent),binCount=bins.length;return this.calculatedBins=[...bins],keys=>{let xValue=keys[0];if(isDate(xValue)&&(xValue=xValue.getTime()),!isNumber(xValue))return[];for(let i=0;i<binCount;i++){const nextBin=bins[i];if(xValue>=nextBin[0]&&xValue<nextBin[1]||i===binCount-1&&xValue<=nextBin[1])return nextBin}return[]}},"groupByFn");!this.ctx.animationManager.isSkipped()&&this.processedData&&props.push(diff(this.id,this.processedData,!1)),await this.requestDataModel(dataController,this.data,{props,groupByFn}),this.animationState.transition("updateData")}xCoordinateRange(){return[NaN,NaN]}yCoordinateRange(){return[NaN,NaN]}getSeriesDomain(direction){var _a294,_b,_c;const{processedData,dataModel}=this;if(!processedData||!dataModel||!this.calculatedBins.length)return[];const yDomain=dataModel.getDomain(this,"groupAgg","aggregate",processedData),xDomainMin=(_a294=this.calculatedBins)==null?void 0:_a294[0][0],xDomainMax=(_c=this.calculatedBins)==null?void 0:_c[(((_b=this.calculatedBins)==null?void 0:_b.length)??0)-1][1];return fixNumericExtent(direction==="x"?[xDomainMin,xDomainMax]:yDomain)}getSeriesRange(_direction,[r0,r1]){const{dataModel,processedData}=this;if(!dataModel||(processedData==null?void 0:processedData.type)!=="grouped")return[NaN,NaN];const xScale=this.axes.x.scale,yMin=0;let yMax=-1/0;return processedData.groups.forEach(({keys,aggregation})=>{const[[negativeAgg,positiveAgg]=[0,0]]=aggregation,[xDomainMin,xDomainMax]=keys,[x0,x1]=findMinMax([xScale.convert(xDomainMin),xScale.convert(xDomainMax)]);if(x1>=r0&&x0<=r1){const total=negativeAgg+positiveAgg;yMax=Math.max(yMax,total)}}),yMin>yMax?[NaN,NaN]:[yMin,yMax]}createNodeData(){const{id:seriesId,axes,processedData,dataModel}=this,xAxis=axes.x,yAxis=axes.y;if(!xAxis||!yAxis||!dataModel)return;const{scale:xScale}=xAxis,{scale:yScale}=yAxis,{xKey,yKey,xName,yName}=this.properties,labelFormatter=this.properties.label.formatter,nodeData=[],context={itemId:this.properties.yKey??this.id,nodeData,labelData:nodeData,scales:this.calculateScaling(),animationValid:!0,visible:this.visible};return!this.visible||processedData==null||processedData.type!=="grouped"||(processedData.groups.forEach((group,groupIndex)=>{const{keys,datumIndices,aggregation}=group,[[negativeAgg,positiveAgg]=[0,0]]=aggregation,frequency=datumIndices.length,domain=keys,[xDomainMin,xDomainMax]=domain,datum=[...dataModel.forEachDatum(this,processedData,group)],xMinPx=xScale.convert(xDomainMin),xMaxPx=xScale.convert(xDomainMax),total=negativeAgg+positiveAgg,yZeroPx=yScale.convert(0),yMaxPx=yScale.convert(total),w=Math.abs(xMaxPx-xMinPx),h=Math.abs(yMaxPx-yZeroPx),x=Math.min(xMinPx,xMaxPx),y=Math.min(yZeroPx,yMaxPx);let selectionDatumLabel;total!==0&&(selectionDatumLabel={x:x+w/2,y:y+h/2,text:this.cachedDatumCallback(createDatumId(groupIndex,"label"),()=>labelFormatter==null?void 0:labelFormatter({value:total,datum,seriesId,xKey,yKey,xName,yName}))??yAxis.formatDatum(total)});const nodeMidPoint={x:x+w/2,y:y+h/2},yAxisReversed=yAxis.isReversed();nodeData.push({series:this,datumIndex:groupIndex,datum,aggregatedValue:total,frequency,domain,yKey,xKey,x,y,xValue:xMinPx,yValue:yMaxPx,width:w,height:h,midPoint:nodeMidPoint,topLeftCornerRadius:!yAxisReversed,topRightCornerRadius:!yAxisReversed,bottomRightCornerRadius:yAxisReversed,bottomLeftCornerRadius:yAxisReversed,label:selectionDatumLabel,crisp:!0})}),nodeData.sort((a,b)=>a.x-b.x)),context}nodeFactory(){return new Rect}updateDatumSelection(opts){const{nodeData,datumSelection}=opts;return datumSelection.update(nodeData,void 0,datum=>datum.domain.join("_"))}getItemBaseStyle(highlighted){const{properties}=this,highlightStyle=highlighted?properties.highlightStyle.item:void 0;return getShapeStyle({fill:(highlightStyle==null?void 0:highlightStyle.fill)??properties.fill,fillOpacity:(highlightStyle==null?void 0:highlightStyle.fillOpacity)??properties.fillOpacity,stroke:(highlightStyle==null?void 0:highlightStyle.stroke)??properties.stroke,strokeWidth:(highlightStyle==null?void 0:highlightStyle.strokeWidth)??this.getStrokeWidth(properties.strokeWidth),strokeOpacity:(highlightStyle==null?void 0:highlightStyle.strokeOpacity)??properties.strokeOpacity,lineDash:(highlightStyle==null?void 0:highlightStyle.lineDash)??properties.lineDash,lineDashOffset:(highlightStyle==null?void 0:highlightStyle.lineDashOffset)??properties.lineDashOffset,cornerRadius:properties.cornerRadius},properties.fillGradientDefaults,properties.fillPatternDefaults)}updateDatumNodes(opts){const{isHighlight:isDatumHighlighted}=opts,{shadow}=this.properties,style=this.getItemBaseStyle(isDatumHighlighted),fillBBox=this.getShapeFillBBox();opts.datumSelection.each((rect,datum)=>{const{cornerRadius}=style,{topLeftCornerRadius,topRightCornerRadius,bottomRightCornerRadius,bottomLeftCornerRadius}=datum;applyShapeStyle(rect,style,void 0,fillBBox),rect.topLeftCornerRadius=topLeftCornerRadius?cornerRadius:0,rect.topRightCornerRadius=topRightCornerRadius?cornerRadius:0,rect.bottomRightCornerRadius=bottomRightCornerRadius?cornerRadius:0,rect.bottomLeftCornerRadius=bottomLeftCornerRadius?cornerRadius:0,rect.crisp=datum.crisp,rect.fillShadow=shadow,rect.visible=datum.height>0})}updateLabelSelection(opts){const{labelData,labelSelection}=opts;return labelSelection.update(labelData,text2=>{text2.pointerEvents=1,text2.textAlign="center",text2.textBaseline="middle"})}updateLabelNodes(opts){const{fontStyle,fontWeight,fontFamily,fontSize,color:color6}=this.properties.label,labelEnabled=this.isLabelEnabled();opts.labelSelection.each((text2,datum)=>{labelEnabled&&(datum!=null&&datum.label)?(text2.text=datum.label.text,text2.x=datum.label.x,text2.y=datum.label.y,text2.fontStyle=fontStyle,text2.fontWeight=fontWeight,text2.fontFamily=fontFamily,text2.fontSize=fontSize,text2.fill=color6,text2.visible=!0):text2.visible=!1})}initQuadTree(quadtree){const{value:childNode}=this.contentGroup.children().next();childNode&&addHitTestersToQuadtree(quadtree,childNode.children())}pickNodeClosestDatum(point){return findQuadtreeMatch(this,point)}getTooltipContent(datumIndex){const{id:seriesId,dataModel,processedData,axes,properties,ctx:{localeManager}}=this,{xKey,xName,yKey,yName,tooltip}=properties,xAxis=axes.x,yAxis=axes.y;if(!dataModel||(processedData==null?void 0:processedData.type)!=="grouped"||!xAxis||!yAxis)return;const group=processedData.groups[datumIndex],{aggregation,datumIndices,keys}=group,[[negativeAgg,positiveAgg]=[0,0]]=aggregation,frequency=datumIndices.length,domain=keys,[rangeMin,rangeMax]=domain,aggregatedValue=negativeAgg+positiveAgg,datum={data:[...dataModel.forEachDatum(this,processedData,group)],aggregatedValue,frequency,domain},data=[{label:xName,fallbackLabel:xKey,value:`${xAxis.formatDatum(rangeMin)} - ${xAxis.formatDatum(rangeMax)}`},{label:localeManager.t("seriesHistogramTooltipFrequency"),value:yAxis.formatDatum(frequency)}];if(yKey!=null){let label;switch(properties.aggregation){case"sum":label=localeManager.t("seriesHistogramTooltipSum",{yName:yName??yKey});break;case"mean":label=localeManager.t("seriesHistogramTooltipMean",{yName:yName??yKey});break;case"count":label=localeManager.t("seriesHistogramTooltipCount",{yName:yName??yKey});break}data.push({label,value:yAxis.formatDatum(aggregatedValue)})}return tooltip.formatTooltip(this.properties,{symbol:this.legendItemSymbol(),data},{seriesId,datum,title:yName,xKey,xName,yKey,yName,xRange:[rangeMin,rangeMax],frequency,...this.getItemBaseStyle(!1)})}legendItemSymbol(){const{fill,fillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,lineDash,lineDashOffset,fillGradientDefaults:fillGradientDefaults2,fillPatternDefaults:fillPatternDefaults2}=this.properties;return{marker:getShapeStyle({fill:fill??"rgba(0, 0, 0, 0)",stroke:stroke2??"rgba(0, 0, 0, 0)",fillOpacity,strokeOpacity,strokeWidth,lineDash,lineDashOffset},fillGradientDefaults2,fillPatternDefaults2)}}getLegendData(legendType){if(legendType!=="category")return[];const{id:seriesId,ctx:{legendManager},visible}=this,{xKey:itemId,yName,showInLegend}=this.properties;return[{legendType:"category",id:seriesId,itemId,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId}),label:{text:yName??itemId??"Frequency"},symbol:this.legendItemSymbol(),hideInLegend:!showInLegend}]}animateEmptyUpdateReady({datumSelection,labelSelection}){const fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(!0,this.axes,"normal"));fromToMotion(this.id,"datums",this.ctx.animationManager,[datumSelection],fns),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection)}animateWaitingUpdateReady(data){var _a294,_b,_c;const dataDiff=(_c=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.diff)==null?void 0:_c[this.id],fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(!0,this.axes,"normal"));fromToMotion(this.id,"datums",this.ctx.animationManager,[data.datumSelection],fns,(_,datum)=>createDatumId(datum.domain),dataDiff),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,data.labelSelection)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex}){var _a294;return computeBarFocusBounds(this,(_a294=this.contextNodeData)==null?void 0:_a294.nodeData[datumIndex])}},__name(_a228,"HistogramSeries"),_a228);HistogramSeries.className="HistogramSeries";HistogramSeries.type="histogram";var histogramSeriesOptionsDef={type:required(constant("histogram")),xKey:required(string),yKey:string,xName:string,yName:string,areaPlot:boolean,aggregation:union("count","sum","mean"),bins:arrayOf(arrayOf(number)),binCount:positiveNumber,showInMiniChart:boolean,cornerRadius:positiveNumber,label:seriesLabelOptionsDefs,tooltip:tooltipOptionsDefs,shadow:shadowOptionsDefs,...commonSeriesOptionsDefs,...fillOptionsDef,...strokeOptionsDef,...lineDashOptionsDef},HistogramSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"histogram",moduleFactory:__name(ctx=>new HistogramSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"exact"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:FILL_PATTERN_DEFAULTS,strokeWidth:1,fillOpacity:1,strokeOpacity:1,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5}}}},NewHistogramSeriesModule={type:"series",name:"histogram",chartType:"cartesian",enterprise:!0,options:histogramSeriesOptionsDef,create:__name(ctx=>new HistogramSeries(ctx),"create")},_a229,LineSeriesProperties=(_a229=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new InterpolationProperties,this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip,this.connectMissingData=!1,this.sparklineMode=!1}},__name(_a229,"LineSeriesProperties"),_a229);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"xKey",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"yKey",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"xName",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"yName",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"yFilterKey",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"stackGroup",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"normalizedTo",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"title",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"stroke",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"strokeWidth",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"lineDash",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"interpolation",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"marker",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"label",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"tooltip",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"connectMissingData",2);__decorateClass([TempValidate()],LineSeriesProperties.prototype,"sparklineMode",2);var CROSS_FILTER_LINE_STROKE_OPACITY_FACTOR=.25,_a230,LineSeries=(_a230=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,categoryKey:"xValue",hasMarkers:!0,pickModes:[2,1,0],markerSelectionGarbageCollection:!1,animationResetFns:{path:buildResetPathFn({getVisible:__name(()=>this.visible,"getVisible"),getOpacity:__name(()=>this.getOpacity(),"getOpacity")}),label:resetLabelFn,marker:__name((node,datum)=>({...resetMarkerFn(),...resetMarkerPositionFn(node,datum)}),"marker")},clipFocusBox:!1}),this.properties=new LineSeriesProperties,this.dataAggregationFilters=void 0}get pickModeAxis(){return this.properties.sparklineMode?"main":"main-category"}async processData(dataController){var _a294,_b;if(this.data==null||!this.properties.isValid())return;const{data,visible,seriesGrouping:{groupIndex=this.id,stackCount=0}={}}=this,{xKey,yKey,yFilterKey,connectMissingData,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),xScale=(_a294=this.axes.x)==null?void 0:_a294.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{isContinuousX,xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),stacked=stackCount>=1||normalizedTo!=null,common={invalidValue:null};connectMissingData&&stacked&&(common.invalidValue=0),stacked&&!visible&&(common.forceValue=0);const props=[];if((!isContinuousX||stacked)&&props.push(keyProperty(xKey,xScaleType,{id:"xKey"})),props.push(valueProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValueRaw",...common,invalidValue:void 0})),yFilterKey!=null&&props.push(valueProperty(yFilterKey,yScaleType,{id:"yFilterRaw"})),stacked){const ids=[`line-stack-${groupIndex}-yValues`,`line-stack-${groupIndex}-yValues-trailing`,`line-stack-${groupIndex}-yValues-marker`];props.push(...groupAccumulativeValueProperty(yKey,"window","current",{id:"yValueEnd",...common,groupId:ids[0]},yScaleType),...groupAccumulativeValueProperty(yKey,"window-trailing","current",{id:"yValueStart",...common,groupId:ids[1]},yScaleType),...groupAccumulativeValueProperty(yKey,"normal","current",{id:"yValueCumulative",...common,groupId:ids[2]},yScaleType)),isDefined(normalizedTo)&&props.push(normaliseGroupTo([ids[0],ids[1],ids[2]],normalizedTo))}animationEnabled&&(props.push(animationValidation(isContinuousX?["xValue"]:void 0)),this.processedData&&props.push(diff(this.id,this.processedData)));const{dataModel,processedData}=await this.requestDataModel(dataController,data,{props,groupByKeys:stacked,groupByData:!stacked});this.dataAggregationFilters=this.aggregateData(dataModel,processedData),this.animationState.transition("updateData")}xCoordinateRange(xValue,pixelSize){const{marker}=this.properties,x=this.axes.x.scale.convert(xValue),r=marker.enabled?.5*marker.size*pixelSize:0;return[x-r,x+r]}yCoordinateRange(yValues,pixelSize){const{marker}=this.properties,y=this.axes.y.scale.convert(yValues[0]),r=marker.enabled?.5*marker.size*pixelSize:0;return[y-r,y+r]}getSeriesDomain(direction){var _a294;const{dataModel,processedData}=this;if(!dataModel||!processedData)return[];if(direction==="x"){const xDef=dataModel.resolveProcessedDataDefById(this,"xValue"),domain=dataModel.getDomain(this,"xValue","value",processedData);return(xDef==null?void 0:xDef.def.type)==="value"&&xDef.def.valueType==="category"?domain:fixNumericExtent(extent(domain))}const yKey=(_a294=this.dataModel)!=null&&_a294.hasColumnById(this,"yValueEnd")?"yValueEnd":"yValueRaw",yExtent=this.domainForClippedRange("y",[yKey],"xValue",!0);return fixNumericExtent(yExtent)}getSeriesRange(_direction,visibleRange){var _a294;const yKey=(_a294=this.dataModel)!=null&&_a294.hasColumnById(this,"yValueEnd")?"yValueEnd":"yValueRaw";return this.domainForVisibleRange("y",[yKey],"xValue",visibleRange,!0)}getVisibleItems(xVisibleRange,yVisibleRange,minVisibleItems){var _a294;const yKey=(_a294=this.dataModel)!=null&&_a294.hasColumnById(this,"yValueEnd")?"yValueEnd":"yValueRaw";return this.countVisibleItems("xValue",[yKey],xVisibleRange,yVisibleRange,minVisibleItems)}aggregateData(_dataModel,_processedData){}createNodeData(){var _a294;const{dataModel,processedData,axes,dataAggregationFilters}=this,xAxis=axes.x,yAxis=axes.y;if(!dataModel||!processedData||!xAxis||!yAxis)return;const{xKey,yKey,yFilterKey,xName,yName,marker,label,connectMissingData,interpolation,legendItemName}=this.properties,stacked=(_a294=this.dataModel)==null?void 0:_a294.hasColumnById(this,"yValueEnd"),xScale=xAxis.scale,yScale=yAxis.scale,xOffset=(xScale.bandwidth??0)/2,yOffset=(yScale.bandwidth??0)/2,size=marker.enabled?marker.size:0,rawData=processedData.dataSources.get(this.id)??[],xValues=dataModel.resolveColumnById(this,"xValue",processedData),yValues=dataModel.resolveColumnById(this,"yValueRaw",processedData),yEndValues=stacked?dataModel.resolveColumnById(this,"yValueEnd",processedData):void 0,yCumulativeValues=stacked?dataModel.resolveColumnById(this,"yValueCumulative",processedData):yValues,selectionValues=yFilterKey!=null?dataModel.resolveColumnById(this,"yFilterRaw",processedData):void 0,xPosition=__name(index=>xScale.convert(xValues[index])+xOffset,"xPosition"),yPosition=__name(index=>yScale.convert(yCumulativeValues[index])+yOffset,"yPosition"),capDefaults={lengthRatioMultiplier:this.properties.marker.getDiameter(),lengthMax:1/0},nodeData=[];let spanPoints;const handleDatum=__name(datumIndex=>{const datum=rawData[datumIndex],xDatum=xValues[datumIndex],yDatum=yValues[datumIndex],yEndDatum=yEndValues==null?void 0:yEndValues[datumIndex],selected=selectionValues==null?void 0:selectionValues[datumIndex],x=xPosition(datumIndex),y=yPosition(datumIndex);if(!Number.isFinite(x))return;if(yDatum!=null){const labelText=label.enabled?this.getLabelText(label,{value:yDatum,datum,xKey,yKey,xName,yName,legendItemName}):void 0;nodeData.push({series:this,datum,datumIndex,yKey,xKey,point:{x,y,size},midPoint:{x,y},cumulativeValue:yEndDatum,yValue:yDatum,xValue:xDatum,capDefaults,labelText,selected})}if(spanPoints==null)return;const currentSpanPoints=spanPoints[spanPoints.length-1];if(yDatum!=null){const spanPoint={point:{x,y},xDatum,yDatum};Array.isArray(currentSpanPoints)?currentSpanPoints.push(spanPoint):currentSpanPoints!=null?(currentSpanPoints.skip+=1,spanPoints.push([spanPoint])):spanPoints.push([spanPoint])}else connectMissingData||(Array.isArray(currentSpanPoints)||currentSpanPoints==null?spanPoints.push({skip:0}):currentSpanPoints.skip+=1)},"handleDatum"),[r0,r1]=xScale.range,range3=r1-r0,dataAggregationFilter=dataAggregationFilters==null?void 0:dataAggregationFilters.find(f=>f.maxRange>range3),indices=dataAggregationFilter==null?void 0:dataAggregationFilter.indices;let[start2,end2]=this.visibleRange("xValue",xAxis.range,indices);start2=Math.max(start2-1,0),end2=Math.min(end2+1,(indices==null?void 0:indices.length)??xValues.length),processedData.input.count<1e3&&(start2=0,end2=processedData.input.count),indices==null&&(spanPoints=[]);for(let i=start2;i<end2;i+=1)handleDatum((indices==null?void 0:indices[i])??i);const strokeSpans=spanPoints==null?void 0:spanPoints.flatMap(p=>Array.isArray(p)?interpolatePoints(p,interpolation):[]),strokeData=strokeSpans!=null?{itemId:yKey,spans:strokeSpans}:void 0,crossFiltering=(selectionValues==null?void 0:selectionValues.some((selectionValue,index)=>selectionValue===yValues[index]))??!1;return{itemId:yKey,nodeData,labelData:nodeData,strokeData,scales:this.calculateScaling(),visible:this.visible,crossFiltering}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(opts){var _a294;const{paths:[lineNode],opacity,visible,animationEnabled}=opts,crossFiltering=((_a294=this.contextNodeData)==null?void 0:_a294.crossFiltering)===!0;lineNode.setProperties({fill:void 0,lineJoin:"round",pointerEvents:1,opacity,stroke:this.properties.stroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.properties.strokeOpacity*(crossFiltering?CROSS_FILTER_LINE_STROKE_OPACITY_FACTOR:1),lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset}),animationEnabled||(lineNode.visible=visible),updateClipPath(this,lineNode)}getMarkerItemBaseStyle(highlighted){const{properties}=this,{marker}=properties,highlightStyle=highlighted?properties.highlightStyle.item:void 0;return getShapeStyle({size:marker.size,shape:marker.shape,fill:(highlightStyle==null?void 0:highlightStyle.fill)??marker.fill,fillOpacity:(highlightStyle==null?void 0:highlightStyle.fillOpacity)??marker.fillOpacity,stroke:(highlightStyle==null?void 0:highlightStyle.stroke)??marker.stroke,strokeWidth:(highlightStyle==null?void 0:highlightStyle.strokeWidth)??marker.strokeWidth,strokeOpacity:(highlightStyle==null?void 0:highlightStyle.strokeOpacity)??marker.strokeOpacity,lineDash:(highlightStyle==null?void 0:highlightStyle.lineDash)??marker.lineDash,lineDashOffset:(highlightStyle==null?void 0:highlightStyle.lineDashOffset)??marker.lineDashOffset},marker.fillGradientDefaults,marker.fillPatternDefaults)}getMarkerItemStyleOverrides(datumId,datum,format,highlighted){const{id:seriesId,properties}=this,{xKey,yKey,marker}=properties,{itemStyler}=marker;if(itemStyler!=null)return this.cachedDatumCallback(createDatumId(datumId,highlighted?"highlight":"node"),()=>{const xDomain=this.getSeriesDomain("x"),yDomain=this.getSeriesDomain("y");return this.callWithContext(itemStyler,{seriesId,...datumStylerProperties(datum,xKey,yKey,xDomain,yDomain),datum,highlighted,...format})})}updateMarkerSelection(opts){var _a294;let{nodeData}=opts;const{markerSelection}=opts;return nodeData=this.properties.marker.enabled||((_a294=this.contextNodeData)==null?void 0:_a294.crossFiltering)===!0?nodeData:[],this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(nodeData,void 0,datum=>createDatumId(datum.xValue))}updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,stroke:stroke2,strokeWidth,strokeOpacity,marker,highlightStyle}=this.properties,xDomain=this.getSeriesDomain("x"),yDomain=this.getSeriesDomain("y"),baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle(),{stroke:stroke2,strokeWidth,strokeOpacity}),applyTranslation=this.ctx.animationManager.isSkipped(),fillBBox=this.getShapeFillBBox();markerSelection.each((node,datum)=>{this.updateMarkerStyle(marker,node,datum.datum,datum.point,datumStylerProperties(datum,xKey,yKey,xDomain,yDomain),highlighted,baseStyle,fillBBox,{applyTranslation,selected:datum.selected})}),highlighted||marker.markClean()}updateLabelSelection(opts){return opts.labelSelection.update(this.isLabelEnabled()?opts.labelData:[])}updateLabelNodes(opts){const{enabled,fontStyle,fontWeight,fontSize,fontFamily,color:color6}=this.properties.label;opts.labelSelection.each((text2,datum)=>{enabled&&(datum!=null&&datum.labelText)?(text2.fontStyle=fontStyle,text2.fontWeight=fontWeight,text2.fontSize=fontSize,text2.fontFamily=fontFamily,text2.textAlign="center",text2.textBaseline="bottom",text2.text=datum.labelText,text2.x=datum.point.x,text2.y=datum.point.y-10,text2.fill=color6,text2.visible=!0):text2.visible=!1})}getTooltipContent(datumIndex){var _a294;const{id:seriesId,dataModel,processedData,axes,properties}=this,{xKey,xName,yKey,yName,tooltip}=properties,xAxis=axes.x,yAxis=axes.y;if(!dataModel||!processedData||!xAxis||!yAxis)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],xValue=dataModel.resolveColumnById(this,"xValue",processedData)[datumIndex],yValue=dataModel.resolveColumnById(this,"yValueRaw",processedData)[datumIndex];if(xValue==null)return;const format=this.getMarkerItemBaseStyle(!1);return Object.assign(format,this.getMarkerItemStyleOverrides(String(datumIndex),datum,format,!1)),tooltip.formatTooltip(this.properties,{heading:xAxis.formatDatum(xValue),symbol:this.legendItemSymbol(),data:[{label:yName,fallbackLabel:yKey,value:yAxis.formatDatum(yValue)}]},{seriesId,datum,title:yName,xKey,xName,yKey,yName,...format,...this.getModuleTooltipParams()})}legendItemSymbol(){const color0="rgba(0, 0, 0, 0)",{stroke:stroke2,strokeOpacity,strokeWidth,lineDash,marker}=this.properties;return{marker:{...this.getMarkerStyle(marker,void 0,void 0,!1,void 0,{fill:marker.fill??color0,stroke:marker.stroke??stroke2??color0}),enabled:marker.enabled},line:{stroke:stroke2??color0,strokeOpacity,strokeWidth,lineDash}}}getLegendData(legendType){if(!(this.properties.isValid()&&legendType==="category"))return[];const{id:seriesId,ctx:{legendManager},visible}=this,{yKey:itemId,yName,title,legendItemName,showInLegend}=this.properties;return[{legendType:"category",id:seriesId,itemId,legendItemName,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId}),label:{text:legendItemName??title??yName??itemId},symbol:this.legendItemSymbol(),hideInLegend:!showInLegend}]}updatePaths(opts){this.updateLinePaths(opts.paths,opts.contextData)}plotNodeDataPoints(path,nodeData){if(nodeData.length===0)return;const initialPoint=nodeData[0].point;path.moveTo(initialPoint.x,initialPoint.y);for(let i=1;i<nodeData.length;i+=1){const{x,y}=nodeData[i].point;path.lineTo(x,y)}}updateLinePaths(paths,contextData){var _a294;const spans=(_a294=contextData.strokeData)==null?void 0:_a294.spans,[lineNode]=paths;lineNode.path.clear(),spans!=null?plotLinePathStroke(lineNode,spans):this.plotNodeDataPoints(lineNode.path,contextData.nodeData),lineNode.markDirty("LineSeries")}animateEmptyUpdateReady(animationData){const{markerSelection,labelSelection,annotationSelections,contextData,paths}=animationData,{animationManager}=this.ctx;this.updateLinePaths(paths,contextData),pathSwipeInAnimation(this,animationManager,...paths),resetMotion([markerSelection],resetMarkerPositionFn),markerSwipeScaleInAnimation(this,animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",animationManager,...annotationSelections)}animateReadyResize(animationData){const{contextData,paths}=animationData;this.updateLinePaths(paths,contextData),super.animateReadyResize(animationData)}animateWaitingUpdateReady(animationData){var _a294,_b,_c;const{animationManager}=this.ctx,{markerSelection:markerSelections,labelSelection:labelSelections,annotationSelections,contextData,paths,previousContextData}=animationData,[path]=paths;this.resetMarkerAnimation(animationData),this.resetLabelAnimation(animationData);const update=__name(()=>{this.resetPathAnimation(animationData),this.updateLinePaths(paths,contextData)},"update"),skip=__name(()=>{animationManager.skipCurrentBatch(),update()},"skip");if(contextData==null||previousContextData==null){update(),markerFadeInAnimation(this,animationManager,"added",markerSelections),pathFadeInAnimation(this,"path_properties",animationManager,"add",path),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,...annotationSelections);return}if(contextData.crossFiltering!==previousContextData.crossFiltering){skip();return}const fns=prepareLinePathAnimation(contextData,previousContextData,(_c=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.diff)==null?void 0:_c[this.id]);if(fns===void 0){skip();return}else if(fns.status==="no-op")return;fromToMotion(this.id,"path_properties",animationManager,[path],fns.stroke.pathProperties),fns.status==="added"?this.updateLinePaths(paths,contextData):fns.status==="removed"?this.updateLinePaths(paths,previousContextData):pathMotion(this.id,"path_update",animationManager,[path],fns.stroke.path),fns.hasMotion&&(markerFadeInAnimation(this,animationManager,void 0,markerSelections),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,...annotationSelections))}isLabelEnabled(){return this.properties.label.enabled}getBandScalePadding(){return{inner:1,outer:.1}}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey}=this.properties,xDomain=this.getSeriesDomain("x"),yDomain=this.getSeriesDomain("y");return this.getMarkerStyle(this.properties.marker,datum.datum,datumStylerProperties(datum,xKey,yKey,xDomain,yDomain),!0)}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a230,"LineSeries"),_a230);LineSeries.className="LineSeries";LineSeries.type="line";var lineSeriesOptionsDef={type:constant("line"),xKey:required(string),yKey:required(string),xName:string,yName:string,title:string,stacked:boolean,stackGroup:string,normalizedTo:number,legendItemName:string,showInMiniChart:boolean,connectMissingData:boolean,interpolation:interpolationValidator,label:seriesLabelOptionsDefs,marker:markerOptionsDefs,tooltip:tooltipOptionsDefs,errorBar:errorBarOptionsDefs,...commonSeriesOptionsDefs,...strokeOptionsDef,...lineDashOptionsDef};lineSeriesOptionsDef.pickOutsideVisibleMinorAxis=boolean;lineSeriesOptionsDef.focusPriority=number;lineSeriesOptionsDef.sparklineMode=boolean;var LineSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"line",moduleFactory:__name(ctx=>new LineSeries(ctx),"moduleFactory"),stackable:!0,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{tooltip:{position:{_seriesOverrideType:"node"}},stroke:SAFE_STROKE_FILL_OPERATION,strokeWidth:2,strokeOpacity:1,lineDash:[0],lineDashOffset:0,interpolation:{type:"linear"},marker:{shape:"circle",size:7,strokeWidth:0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:FILL_PATTERN_DEFAULTS},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},errorBar:{cap:{lengthRatio:1}}}}},NewLineSeriesModule={type:"series",name:"line",chartType:"cartesian",options:lineSeriesOptionsDef,create:__name(ctx=>new LineSeries(ctx),"create")},_a231,ScatterSeriesLabel=(_a231=class extends Label{constructor(){super(...arguments),this.placement="top"}},__name(_a231,"ScatterSeriesLabel"),_a231);__decorateClass([TempValidate()],ScatterSeriesLabel.prototype,"placement",2);var _a232,ScatterSeriesProperties=(_a232=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.label=new ScatterSeriesLabel,this.tooltip=new SeriesTooltip,this.marker=new SeriesMarker}},__name(_a232,"ScatterSeriesProperties"),_a232);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"xKey",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"yKey",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"labelKey",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"xFilterKey",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"yFilterKey",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"xName",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"yName",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"labelName",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"title",2);__decorateClass([ProxyProperty("marker.shape")],ScatterSeriesProperties.prototype,"shape",2);__decorateClass([ProxyProperty("marker.size")],ScatterSeriesProperties.prototype,"size",2);__decorateClass([ProxyProperty("marker.fill",{optional:!0})],ScatterSeriesProperties.prototype,"fill",2);__decorateClass([ProxyProperty("marker.fillGradientDefaults")],ScatterSeriesProperties.prototype,"fillGradientDefaults",2);__decorateClass([ProxyProperty("marker.fillPatternDefaults")],ScatterSeriesProperties.prototype,"fillPatternDefaults",2);__decorateClass([ProxyProperty("marker.fillOpacity")],ScatterSeriesProperties.prototype,"fillOpacity",2);__decorateClass([ProxyProperty("marker.stroke")],ScatterSeriesProperties.prototype,"stroke",2);__decorateClass([ProxyProperty("marker.strokeWidth")],ScatterSeriesProperties.prototype,"strokeWidth",2);__decorateClass([ProxyProperty("marker.strokeOpacity")],ScatterSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([ProxyProperty("marker.lineDash")],ScatterSeriesProperties.prototype,"lineDash",2);__decorateClass([ProxyProperty("marker.lineDashOffset")],ScatterSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([ProxyProperty("marker.itemStyler",{optional:!0})],ScatterSeriesProperties.prototype,"itemStyler",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"label",2);__decorateClass([TempValidate()],ScatterSeriesProperties.prototype,"tooltip",2);var _a233,ScatterSeries=(_a233=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,directionKeys:DEFAULT_CARTESIAN_DIRECTION_KEYS,directionNames:DEFAULT_CARTESIAN_DIRECTION_NAMES,categoryKey:void 0,pickModes:[2,1,0],pathsPerSeries:[],hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{marker:resetMarkerFn,label:resetLabelFn},usesPlacedLabels:!0,clipFocusBox:!1}),this.properties=new ScatterSeriesProperties}get pickModeAxis(){return"main-category"}async processData(dataController){var _a294,_b;if(!this.properties.isValid()||this.data==null||!this.visible)return;const xScale=(_a294=this.axes.x)==null?void 0:_a294.scale,yScale=(_b=this.axes.y)==null?void 0:_b.scale,{xScaleType,yScaleType}=this.getScaleInformation({xScale,yScale}),{xKey,yKey,xFilterKey,yFilterKey,labelKey}=this.properties;await this.requestDataModel(dataController,this.data,{props:[valueProperty(xKey,xScaleType,{id:"xValue"}),valueProperty(yKey,yScaleType,{id:"yValue"}),...xFilterKey!=null?[valueProperty(xFilterKey,xScaleType,{id:"xFilterValue"})]:[],...yFilterKey!=null?[valueProperty(yFilterKey,yScaleType,{id:"yFilterValue"})]:[],...labelKey?[valueProperty(labelKey,"band",{id:"labelValue"})]:[]]}),this.animationState.transition("updateData")}xCoordinateRange(xValue,pixelSize){const x=this.axes.x.scale.convert(xValue),r=.5*this.properties.size*pixelSize;return[x-r,x+r]}yCoordinateRange(yValues,pixelSize){const y=this.axes.y.scale.convert(yValues[0]),r=.5*this.properties.size*pixelSize;return[y-r,y+r]}getSeriesDomain(direction){const{dataModel,processedData}=this;if(!processedData||!dataModel)return[];const dataValues={x:"xValue",y:"yValue"},id=dataValues[direction],dataDef=dataModel.resolveProcessedDataDefById(this,id),domain=dataModel.getDomain(this,id,"value",processedData);if((dataDef==null?void 0:dataDef.def.type)==="value"&&(dataDef==null?void 0:dataDef.def.valueType)==="category")return domain;const crossId=dataValues[direction==="x"?"y":"x"],ext=this.domainForClippedRange(direction,[id],crossId,!1);return fixNumericExtent(extent(ext))}getSeriesRange(_direction,visibleRange){return this.domainForVisibleRange("y",["yValue"],"xValue",visibleRange,!1)}getVisibleItems(xVisibleRange,yVisibleRange,minVisibleItems){return this.countVisibleItems("xValue",["yValue"],xVisibleRange,yVisibleRange,minVisibleItems)}createNodeData(){const{axes,dataModel,processedData,visible}=this,{xKey,yKey,xFilterKey,yFilterKey,labelKey,xName,yName,labelName,marker,label}=this.properties,{placement}=label,anchor=Marker.anchor(marker.shape),xAxis=axes.x,yAxis=axes.y;if(!(dataModel&&processedData&&visible&&xAxis&&yAxis))return;const xDataValues=dataModel.resolveColumnById(this,"xValue",processedData),yDataValues=dataModel.resolveColumnById(this,"yValue",processedData),labelDataValues=labelKey!=null?dataModel.resolveColumnById(this,"labelValue",processedData):void 0,xFilterDataValues=xFilterKey!=null?dataModel.resolveColumnById(this,"xFilterValue",processedData):void 0,yFilterDataValues=yFilterKey!=null?dataModel.resolveColumnById(this,"yFilterValue",processedData):void 0,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=(xScale.bandwidth??0)/2,yOffset=(yScale.bandwidth??0)/2,nodeData=[],font2=label.getFont(),textMeasurer=CachedTextMeasurerPool.getMeasurer({font:font2});return(processedData.dataSources.get(this.id)??[]).forEach((datum,datumIndex)=>{const xDatum=xDataValues[datumIndex],yDatum=yDataValues[datumIndex],x=xScale.convert(xDatum)+xOffset,y=yScale.convert(yDatum)+yOffset,selected=xFilterDataValues!=null&&yFilterDataValues!=null?xFilterDataValues[datumIndex]===xDatum&&yFilterDataValues[datumIndex]===yDatum:void 0,labelText=this.getLabelText(label,{value:labelDataValues!=null?labelDataValues==null?void 0:labelDataValues[datumIndex]:yDatum,datum,xKey,yKey,labelKey,xName,yName,labelName}),size=textMeasurer.measureText(labelText);nodeData.push({series:this,itemId:yKey,yKey,xKey,datum,datumIndex,xValue:xDatum,yValue:yDatum,capDefaults:{lengthRatioMultiplier:marker.getDiameter(),lengthMax:1/0},point:{x,y,size:marker.size},midPoint:{x,y},label:{text:labelText,...size},anchor,placement,selected})}),{itemId:yKey,nodeData,labelData:nodeData,scales:this.calculateScaling(),visible:this.visible}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var _a294;return this.isLabelEnabled()?((_a294=this.contextNodeData)==null?void 0:_a294.labelData)??[]:[]}updateMarkerSelection(opts){const{nodeData,markerSelection}=opts;return this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(this.properties.marker.enabled?nodeData:[])}updateMarkerNodes(opts){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,labelKey,marker,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle()),fillBBox=this.getShapeFillBBox();markerSelection.each((node,datum)=>{this.updateMarkerStyle(marker,node,datum.datum,datum.point,{xKey,yKey,labelKey},highlighted,baseStyle,fillBBox,{selected:datum.selected})}),highlighted||marker.markClean()}updatePlacedLabelData(labelData){this.labelSelection.update(labelData.map(v=>({...v.datum,point:{x:v.x,y:v.y,size:v.datum.point.size}})),text2=>{text2.pointerEvents=1}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(opts){const{label}=this.properties;opts.labelSelection.each((text2,datum)=>{var _a294,_b;text2.text=datum.label.text,text2.fill=label.color,text2.x=((_a294=datum.point)==null?void 0:_a294.x)??0,text2.y=((_b=datum.point)==null?void 0:_b.y)??0,text2.fontStyle=label.fontStyle,text2.fontWeight=label.fontWeight,text2.fontSize=label.fontSize,text2.fontFamily=label.fontFamily,text2.textAlign="left",text2.textBaseline="top"})}getTooltipContent(datumIndex){var _a294,_b;const{id:seriesId,dataModel,processedData,axes,properties}=this,{xKey,xName,yKey,yName,labelKey,labelName,title,tooltip,marker}=properties,xAxis=axes.x,yAxis=axes.y;if(!dataModel||!processedData||!xAxis||!yAxis)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],xValue=dataModel.resolveColumnById(this,"xValue",processedData)[datumIndex],yValue=dataModel.resolveColumnById(this,"yValue",processedData)[datumIndex],nodeDatum=(_b=this.contextNodeData)==null?void 0:_b.nodeData[datumIndex];if(xValue==null||nodeDatum==null)return;const activeStyle=this.getMarkerStyle(marker,nodeDatum.datum,{xKey,yKey,labelKey,highlighted:!0});return tooltip.formatTooltip(this.properties,{symbol:this.legendItemSymbol(),title,data:[{label:xName,fallbackLabel:xKey,value:xAxis.formatDatum(xValue)},{label:yName,fallbackLabel:yKey,value:yAxis.formatDatum(yValue)}]},{seriesId,datum,title:yName,xKey,xName,yKey,yName,labelKey,labelName,...activeStyle,...this.getModuleTooltipParams()})}legendItemSymbol(){return{marker:this.getMarkerStyle(this.properties.marker)}}getLegendData(legendType){if(!this.properties.isValid()||legendType!=="category")return[];const{yKey:itemId,yName,title,showInLegend}=this.properties,{id:seriesId,ctx:{legendManager},visible}=this;return[{legendType:"category",id:seriesId,itemId,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId}),label:{text:title??yName??itemId},symbol:this.legendItemSymbol(),hideInLegend:!showInLegend}]}animateEmptyUpdateReady(data){const{markerSelection,labelSelection,annotationSelections}=data;markerScaleInAnimation(this,this.ctx.animationManager,markerSelection),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelection),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,...annotationSelections)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}getFormattedMarkerStyle(datum){const{xKey,yKey,labelKey}=this.properties;return this.getMarkerStyle(this.properties.marker,datum.datum,{xKey,yKey,labelKey},!0)}computeFocusBounds(opts){return computeMarkerFocusBounds(this,opts)}},__name(_a233,"ScatterSeries"),_a233);ScatterSeries.className="ScatterSeries";ScatterSeries.type="scatter";var scatterSeriesOptionsDef={type:required(constant("scatter")),xKey:required(string),yKey:required(string),labelKey:string,xName:string,yName:string,labelName:string,title:string,showInMiniChart:boolean,label:{placement:union("top","right","bottom","left"),...seriesLabelOptionsDefs},tooltip:tooltipOptionsDefs,errorBar:errorBarOptionsDefs,...commonSeriesOptionsDefs,...without(markerOptionsDefs,["enabled"])},ScatterSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"scatter",moduleFactory:__name(ctx=>new ScatterSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:FILL_PATTERN_DEFAULTS,fillOpacity:.8,tooltip:{position:{_seriesOverrideType:"node"}},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},errorBar:{cap:{lengthRatio:1}}}}},NewScatterSeriesModule={type:"series",name:"scatter",chartType:"cartesian",options:scatterSeriesOptionsDef,create:__name(ctx=>new ScatterSeries(ctx),"create")},_a234,SectorBox=(_a234=class{constructor(startAngle,endAngle,innerRadius,outerRadius){this.startAngle=startAngle,this.endAngle=endAngle,this.innerRadius=innerRadius,this.outerRadius=outerRadius}clone(){const{startAngle,endAngle,innerRadius,outerRadius}=this;return new _a234(startAngle,endAngle,innerRadius,outerRadius)}equals(other){return this.startAngle===other.startAngle&&this.endAngle===other.endAngle&&this.innerRadius===other.innerRadius&&this.outerRadius===other.outerRadius}[interpolate](other,d){return new _a234(this.startAngle*(1-d)+other.startAngle*d,this.endAngle*(1-d)+other.endAngle*d,this.innerRadius*(1-d)+other.innerRadius*d,this.outerRadius*(1-d)+other.outerRadius*d)}},__name(_a234,"_SectorBox"),_a234);function sectorBox({startAngle,endAngle,innerRadius,outerRadius}){let x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;const addPoint=__name((x,y)=>{x0=Math.min(x,x0),y0=Math.min(y,y0),x1=Math.max(x,x1),y1=Math.max(y,y1)},"addPoint");return addPoint(innerRadius*Math.cos(startAngle),innerRadius*Math.sin(startAngle)),addPoint(innerRadius*Math.cos(endAngle),innerRadius*Math.sin(endAngle)),addPoint(outerRadius*Math.cos(startAngle),outerRadius*Math.sin(startAngle)),addPoint(outerRadius*Math.cos(endAngle),outerRadius*Math.sin(endAngle)),isBetweenAngles(0,startAngle,endAngle)&&addPoint(outerRadius,0),isBetweenAngles(Math.PI*.5,startAngle,endAngle)&&addPoint(0,outerRadius),isBetweenAngles(Math.PI,startAngle,endAngle)&&addPoint(-outerRadius,0),isBetweenAngles(Math.PI*1.5,startAngle,endAngle)&&addPoint(0,-outerRadius),new BBox(x0,y0,x1-x0,y1-y0)}__name(sectorBox,"sectorBox");function isPointInSector(x,y,sector){const radius=Math.sqrt(Math.pow(x,2)+Math.pow(y,2)),{innerRadius,outerRadius}=sector;if(sector.startAngle===sector.endAngle||radius<Math.min(innerRadius,outerRadius)||radius>Math.max(innerRadius,outerRadius))return!1;const startAngle=normalizeAngle180(sector.startAngle),endAngle=normalizeAngle180(sector.endAngle),angle2=Math.atan2(y,x);return startAngle<endAngle?angle2<=endAngle&&angle2>=startAngle:angle2<=endAngle&&angle2>=-Math.PI||angle2>=startAngle&&angle2<=Math.PI}__name(isPointInSector,"isPointInSector");function lineCollidesSector(line,sector){const{startAngle,endAngle,innerRadius,outerRadius}=sector,outerStart={x:outerRadius*Math.cos(startAngle),y:outerRadius*Math.sin(startAngle)},outerEnd={x:outerRadius*Math.cos(endAngle),y:outerRadius*Math.sin(endAngle)},innerStart=innerRadius===0?{x:0,y:0}:{x:innerRadius*Math.cos(startAngle),y:innerRadius*Math.sin(startAngle)},innerEnd=innerRadius===0?{x:0,y:0}:{x:innerRadius*Math.cos(endAngle),y:innerRadius*Math.sin(endAngle)};return segmentIntersection(line.start.x,line.start.y,line.end.x,line.end.y,outerStart.x,outerStart.y,innerStart.x,innerStart.y)||segmentIntersection(line.start.x,line.start.y,line.end.x,line.end.y,outerEnd.x,outerEnd.y,innerEnd.x,innerEnd.y)||arcIntersections(0,0,outerRadius,startAngle,endAngle,!0,line.start.x,line.start.y,line.end.x,line.end.y)}__name(lineCollidesSector,"lineCollidesSector");function boxCollidesSector(box,sector){const topLeft={x:box.x,y:box.y},topRight={x:box.x+box.width,y:box.y},bottomLeft={x:box.x,y:box.y+box.height},bottomRight={x:box.x+box.width,y:box.y+box.height};return lineCollidesSector({start:topLeft,end:topRight},sector)||lineCollidesSector({start:bottomLeft,end:bottomRight},sector)}__name(boxCollidesSector,"boxCollidesSector");function radiiScalingFactor(r,sweep,a,b){if(a===0&&b===0)return 0;if(Math.asin(Math.abs(1*a)/(r+1*a))+Math.asin(Math.abs(1*b)/(r+1*b))-sweep<0)return 1;let start2=0,end2=1;for(let i=0;i<8;i+=1){const s=(start2+end2)/2;Math.asin(Math.abs(s*a)/(r+s*a))+Math.asin(Math.abs(s*b)/(r+s*b))-sweep<0?start2=s:end2=s}return start2}__name(radiiScalingFactor,"radiiScalingFactor");var delta2=1e-6;function clockwiseAngle(angle2,relativeToStartAngle){return angleBetween(angle2,relativeToStartAngle)<delta2?relativeToStartAngle:normalizeAngle360(angle2-relativeToStartAngle)+relativeToStartAngle}__name(clockwiseAngle,"clockwiseAngle");function clockwiseAngles(startAngle,endAngle,relativeToStartAngle=0){const sweepAngle=Math.abs(endAngle-startAngle)>=2*Math.PI?2*Math.PI:normalizeAngle360(endAngle-startAngle);return startAngle=clockwiseAngle(startAngle,relativeToStartAngle),endAngle=startAngle+sweepAngle,{startAngle,endAngle}}__name(clockwiseAngles,"clockwiseAngles");function arcRadialLineIntersectionAngle(cx,cy,r,startAngle,endAngle,clipAngle){const sinA=Math.sin(clipAngle),cosA=Math.cos(clipAngle),c=cx**2+cy**2-r**2;let p0x,p0y,p1x,p1y;if(cosA>.5){const tanA=sinA/cosA,a=1+tanA**2,b=-2*(cx+cy*tanA),d=b**2-4*a*c;if(d<0)return;const x0=(-b+Math.sqrt(d))/(2*a),x1=(-b-Math.sqrt(d))/(2*a);p0x=x0,p0y=x0*tanA,p1x=x1,p1y=x1*tanA}else{const cotA=cosA/sinA,a=1+cotA**2,b=-2*(cy+cx*cotA),d=b**2-4*a*c;if(d<0)return;const y0=(-b+Math.sqrt(d))/(2*a),y1=(-b-Math.sqrt(d))/(2*a);p0x=y0*cotA,p0y=y0,p1x=y1*cotA,p1y=y1}const normalisedX=cosA,normalisedY=sinA,p0DotNormalized=p0x*normalisedX+p0y*normalisedY,p1DotNormalized=p1x*normalisedX+p1y*normalisedY,a0=p0DotNormalized>0?clockwiseAngle(Math.atan2(p0y-cy,p0x-cx),startAngle):NaN,a1=p1DotNormalized>0?clockwiseAngle(Math.atan2(p1y-cy,p1x-cx),startAngle):NaN;if(a0>=startAngle&&a0<=endAngle)return a0;if(a1>=startAngle&&a1<=endAngle)return a1}__name(arcRadialLineIntersectionAngle,"arcRadialLineIntersectionAngle");function arcCircleIntersectionAngle(cx,cy,r,startAngle,endAngle,circleR){const d=Math.hypot(cx,cy),d1=(d**2-r**2+circleR**2)/(2*d),d2=d-d1,theta=Math.atan2(cy,cx),deltaTheta=Math.acos(-d2/r),a0=clockwiseAngle(theta+deltaTheta,startAngle),a1=clockwiseAngle(theta-deltaTheta,startAngle);if(a0>=startAngle&&a0<=endAngle)return a0;if(a1>=startAngle&&a1<=endAngle)return a1}__name(arcCircleIntersectionAngle,"arcCircleIntersectionAngle");var _a235,Arc=(_a235=class{constructor(cx,cy,r,a0,a1){this.cx=cx,this.cy=cy,this.r=r,this.a0=a0,this.a1=a1,this.a0>=this.a1&&(this.a0=NaN,this.a1=NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(a){return{x:this.cx+this.r*Math.cos(a),y:this.cy+this.r*Math.sin(a)}}clipStart(a){a==null||!this.isValid()||a<this.a0||(this.a0=a,(Number.isNaN(a)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}clipEnd(a){a==null||!this.isValid()||a>this.a1||(this.a1=a,(Number.isNaN(a)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}},__name(_a235,"Arc"),_a235),_a236,Sector=(_a236=class extends Path{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(value){this.concentricEdgeInset=value,this.radialEdgeInset=value}set cornerRadius(value){this.startOuterCornerRadius=value,this.endOuterCornerRadius=value,this.startInnerCornerRadius=value,this.endInnerCornerRadius=value}computeBBox(){return sectorBox(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset}=this;let{innerRadius,outerRadius}=this;return innerRadius=innerRadius>0?innerRadius+concentricEdgeInset:0,outerRadius=Math.max(outerRadius-concentricEdgeInset,0),{innerRadius,outerRadius}}normalizedClipSector(){const{clipSector}=this;if(clipSector==null)return;const{startAngle,endAngle}=clockwiseAngles(this.startAngle,this.endAngle),{innerRadius,outerRadius}=this.normalizedRadii(),clipAngles=clockwiseAngles(clipSector.startAngle,clipSector.endAngle,startAngle);return new SectorBox(Math.max(startAngle,clipAngles.startAngle),Math.min(endAngle,clipAngles.endAngle),Math.max(innerRadius,clipSector.innerRadius),Math.min(outerRadius,clipSector.outerRadius))}getAngleOffset(radius){return radius>0?this.radialEdgeInset/radius:0}arc(r,angleSweep,a0,a1,outerArc,innerArc,start2,inner){if(r<=0)return;const{startAngle,endAngle}=clockwiseAngles(this.startAngle,this.endAngle),{innerRadius,outerRadius}=this.normalizedRadii(),clipSector=this.normalizedClipSector();if(inner&&innerRadius<=0)return;const angleOffset=inner?this.getAngleOffset(innerRadius+r):this.getAngleOffset(outerRadius-r),angle2=start2?startAngle+angleOffset+angleSweep:endAngle-angleOffset-angleSweep,radius=inner?innerRadius+r:outerRadius-r,cx=radius*Math.cos(angle2),cy=radius*Math.sin(angle2);if(clipSector!=null&&(!start2&&!(angle2>=startAngle-1e-6&&angle2<=clipSector.endAngle-1e-6)||start2&&!(angle2>=clipSector.startAngle+1e-6&&angle2<=endAngle-1e-6)||inner&&radius<clipSector.innerRadius-1e-6||!inner&&radius>clipSector.outerRadius+1e-6))return;const arc=new Arc(cx,cy,r,a0,a1);if(clipSector!=null){inner?(arc.clipStart(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.endAngle)),arc.clipEnd(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.startAngle))):(arc.clipStart(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.startAngle)),arc.clipEnd(arcRadialLineIntersectionAngle(cx,cy,r,a0,a1,clipSector.endAngle)));let circleClipStart,circleClipEnd;if(start2?(circleClipStart=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.innerRadius),circleClipEnd=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.outerRadius)):(circleClipStart=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.outerRadius),circleClipEnd=arcCircleIntersectionAngle(cx,cy,r,a0,a1,clipSector.innerRadius)),arc.clipStart(circleClipStart),arc.clipEnd(circleClipEnd),circleClipStart!=null){const{x:x2,y:y2}=arc.pointAt(circleClipStart),theta2=clockwiseAngle(Math.atan2(y2,x2),startAngle);start2?innerArc==null||innerArc.clipStart(theta2):outerArc.clipEnd(theta2)}if(circleClipEnd!=null){const{x:x2,y:y2}=arc.pointAt(circleClipEnd),theta2=clockwiseAngle(Math.atan2(y2,x2),startAngle);start2?outerArc.clipStart(theta2):innerArc==null||innerArc.clipEnd(theta2)}}if(clipSector!=null){const{x:x2,y:y2}=arc.pointAt((arc.a0+arc.a1)/2);if(!isPointInSector(x2,y2,clipSector))return}const{x,y}=arc.pointAt(start2===inner?arc.a0:arc.a1),theta=clockwiseAngle(Math.atan2(y,x),startAngle),radialArc=inner?innerArc:outerArc;return start2?radialArc==null||radialArc.clipStart(theta):radialArc==null||radialArc.clipEnd(theta),arc}updatePath(){const{path,centerX,centerY,concentricEdgeInset,radialEdgeInset}=this;let{startOuterCornerRadius,endOuterCornerRadius,startInnerCornerRadius,endInnerCornerRadius}=this;const{startAngle,endAngle}=clockwiseAngles(this.startAngle,this.endAngle),{innerRadius,outerRadius}=this.normalizedRadii(),clipSector=this.normalizedClipSector(),sweepAngle=endAngle-startAngle,fullPie=sweepAngle>=2*Math.PI-1e-6;if(path.clear(),innerRadius===0&&outerRadius===0||innerRadius>outerRadius)return;if(((clipSector==null?void 0:clipSector.startAngle)??startAngle)===((clipSector==null?void 0:clipSector.endAngle)??endAngle))return;if(fullPie&&this.clipSector==null&&startOuterCornerRadius===0&&endOuterCornerRadius===0&&startInnerCornerRadius===0&&endInnerCornerRadius===0){path.moveTo(centerX+outerRadius*Math.cos(startAngle),centerY+outerRadius*Math.sin(startAngle)),path.arc(centerX,centerY,outerRadius,startAngle,endAngle),innerRadius>concentricEdgeInset&&(path.moveTo(centerX+innerRadius*Math.cos(endAngle),centerY+innerRadius*Math.sin(endAngle)),path.arc(centerX,centerY,innerRadius,endAngle,startAngle,!0)),path.closePath();return}else if(this.clipSector==null&&Math.abs(innerRadius-outerRadius)<1e-6){path.arc(centerX,centerY,outerRadius,startAngle,endAngle,!1),path.arc(centerX,centerY,outerRadius,endAngle,startAngle,!0),path.closePath();return}const innerAngleOffset=this.getAngleOffset(innerRadius),outerAngleOffset=this.getAngleOffset(outerRadius);if(sweepAngle<2*outerAngleOffset)return;const hasInnerSweep=((clipSector==null?void 0:clipSector.innerRadius)??innerRadius)>concentricEdgeInset,innerAngleExceeded=innerRadius<concentricEdgeInset||sweepAngle<2*innerAngleOffset,radialLength=outerRadius-innerRadius,maxRadialLength=Math.max(startOuterCornerRadius,startInnerCornerRadius,endOuterCornerRadius,endInnerCornerRadius),initialScalingFactor=maxRadialLength>0?Math.min(radialLength/maxRadialLength,1):1;startOuterCornerRadius*=initialScalingFactor,endOuterCornerRadius*=initialScalingFactor,startInnerCornerRadius*=initialScalingFactor,endInnerCornerRadius*=initialScalingFactor;const outerScalingFactor=radiiScalingFactor(outerRadius,sweepAngle-2*outerAngleOffset,-startOuterCornerRadius,-endOuterCornerRadius);if(startOuterCornerRadius*=outerScalingFactor,endOuterCornerRadius*=outerScalingFactor,!innerAngleExceeded&&hasInnerSweep){const innerScalingFactor=radiiScalingFactor(innerRadius,sweepAngle-2*innerAngleOffset,startInnerCornerRadius,endInnerCornerRadius);startInnerCornerRadius*=innerScalingFactor,endInnerCornerRadius*=innerScalingFactor}else startInnerCornerRadius=0,endInnerCornerRadius=0;const maxCombinedRadialLength=Math.max(startOuterCornerRadius+startInnerCornerRadius,endOuterCornerRadius+endInnerCornerRadius),edgesScalingFactor=maxCombinedRadialLength>0?Math.min(radialLength/maxCombinedRadialLength,1):1;startOuterCornerRadius*=edgesScalingFactor,endOuterCornerRadius*=edgesScalingFactor,startInnerCornerRadius*=edgesScalingFactor,endInnerCornerRadius*=edgesScalingFactor;let startOuterCornerRadiusAngleSweep=0,endOuterCornerRadiusAngleSweep=0;const startOuterCornerRadiusSweep=startOuterCornerRadius/(outerRadius-startOuterCornerRadius),endOuterCornerRadiusSweep=endOuterCornerRadius/(outerRadius-endOuterCornerRadius);if(startOuterCornerRadiusSweep>=0&&startOuterCornerRadiusSweep<1-1e-6)startOuterCornerRadiusAngleSweep=Math.asin(startOuterCornerRadiusSweep);else{startOuterCornerRadiusAngleSweep=sweepAngle/2;const maxStartOuterCornerRadius=outerRadius/(1/Math.sin(startOuterCornerRadiusAngleSweep)+1);startOuterCornerRadius=Math.min(maxStartOuterCornerRadius,startOuterCornerRadius)}if(endOuterCornerRadiusSweep>=0&&endOuterCornerRadiusSweep<1-1e-6)endOuterCornerRadiusAngleSweep=Math.asin(endOuterCornerRadiusSweep);else{endOuterCornerRadiusAngleSweep=sweepAngle/2;const maxEndOuterCornerRadius=outerRadius/(1/Math.sin(endOuterCornerRadiusAngleSweep)+1);endOuterCornerRadius=Math.min(maxEndOuterCornerRadius,endOuterCornerRadius)}const startInnerCornerRadiusAngleSweep=Math.asin(startInnerCornerRadius/(innerRadius+startInnerCornerRadius)),endInnerCornerRadiusAngleSweep=Math.asin(endInnerCornerRadius/(innerRadius+endInnerCornerRadius)),outerArcRadius=(clipSector==null?void 0:clipSector.outerRadius)??outerRadius,outerArcRadiusOffset=this.getAngleOffset(outerArcRadius),outerArc=new Arc(0,0,outerArcRadius,startAngle+outerArcRadiusOffset,endAngle-outerArcRadiusOffset),innerArcRadius=(clipSector==null?void 0:clipSector.innerRadius)??innerRadius,innerArcRadiusOffset=this.getAngleOffset(innerArcRadius),innerArc=hasInnerSweep?new Arc(0,0,innerArcRadius,startAngle+innerArcRadiusOffset,endAngle-innerArcRadiusOffset):void 0;clipSector!=null&&(outerArc.clipStart(clipSector.startAngle),outerArc.clipEnd(clipSector.endAngle),innerArc==null||innerArc.clipStart(clipSector.startAngle),innerArc==null||innerArc.clipEnd(clipSector.endAngle));const startOuterArc=this.arc(startOuterCornerRadius,startOuterCornerRadiusAngleSweep,startAngle-Math.PI*.5,startAngle+startOuterCornerRadiusAngleSweep,outerArc,innerArc,!0,!1),endOuterArc=this.arc(endOuterCornerRadius,endOuterCornerRadiusAngleSweep,endAngle-endOuterCornerRadiusAngleSweep,endAngle+Math.PI*.5,outerArc,innerArc,!1,!1),endInnerArc=this.arc(endInnerCornerRadius,endInnerCornerRadiusAngleSweep,endAngle+Math.PI*.5,endAngle+Math.PI-endInnerCornerRadiusAngleSweep,outerArc,innerArc,!1,!0),startInnerArc=this.arc(startInnerCornerRadius,startInnerCornerRadiusAngleSweep,startAngle+Math.PI+startInnerCornerRadiusAngleSweep,startAngle+Math.PI*1.5,outerArc,innerArc,!0,!0);if(innerAngleExceeded){const x=sweepAngle<Math.PI*.5?radialEdgeInset*(1+Math.cos(sweepAngle))/Math.sin(sweepAngle):NaN;let r;x>0&&x<outerRadius?r=Math.max(Math.hypot(radialEdgeInset,x),innerRadius):r=radialEdgeInset,r=Math.max(r,innerRadius);const midAngle=startAngle+sweepAngle*.5;path.moveTo(centerX+r*Math.cos(midAngle),centerY+r*Math.sin(midAngle))}else if(!((startInnerArc==null?void 0:startInnerArc.isValid())===!0||(innerArc==null?void 0:innerArc.isValid())===!0)){const midAngle=startAngle+sweepAngle/2,cx=innerRadius*Math.cos(midAngle),cy=innerRadius*Math.sin(midAngle);path.moveTo(centerX+cx,centerY+cy)}if((startOuterArc==null?void 0:startOuterArc.isValid())===!0){const{cx,cy,r,a0,a1}=startOuterArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}if(outerArc.isValid()){const{r,a0,a1}=outerArc;path.arc(centerX,centerY,r,a0,a1)}if((endOuterArc==null?void 0:endOuterArc.isValid())===!0){const{cx,cy,r,a0,a1}=endOuterArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}if(!innerAngleExceeded){if((endInnerArc==null?void 0:endInnerArc.isValid())===!0){const{cx,cy,r,a0,a1}=endInnerArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}if((innerArc==null?void 0:innerArc.isValid())===!0){const{r,a0,a1}=innerArc;path.arc(centerX,centerY,r,a1,a0,!0)}if((startInnerArc==null?void 0:startInnerArc.isValid())===!0){const{cx,cy,r,a0,a1}=startInnerArc;path.arc(centerX+cx,centerY+cy,r,a0,a1)}}path.closePath()}isPointInPath(x,y){const{startAngle,endAngle,innerRadius,outerRadius}=this.clipSector??this;return isPointInSector(x-this.centerX,y-this.centerY,{startAngle,endAngle,innerRadius:Math.min(innerRadius,outerRadius),outerRadius:Math.max(innerRadius,outerRadius)})}},__name(_a236,"Sector"),_a236);Sector.className="Sector";__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerX",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerY",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"innerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"outerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"clipSector",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"concentricEdgeInset",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"radialEdgeInset",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startOuterCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endOuterCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startInnerCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endInnerCornerRadius",2);var DEFAULT_FILLS={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},DEFAULT_STROKES={BLUE:"#2b5c95",ORANGE:"#cc6f10",GREEN:"#1e652e",CYAN:"#18859e",YELLOW:"#a69400",VIOLET:"#603c88",GRAY:"#575757",MAGENTA:"#7d2f6d",BROWN:"#4f3508",RED:"#a82529"},_a237,DonutTitle=(_a237=class extends Caption{constructor(){super(...arguments),this.showInLegend=!1}},__name(_a237,"DonutTitle"),_a237);__decorateClass([TempValidate()],DonutTitle.prototype,"showInLegend",2);var _a238,DonutInnerLabel=(_a238=class extends Label{constructor(){super(...arguments),this.spacing=2}set(properties,_reset){return super.set(properties)}},__name(_a238,"DonutInnerLabel"),_a238);__decorateClass([TempValidate()],DonutInnerLabel.prototype,"text",2);__decorateClass([TempValidate()],DonutInnerLabel.prototype,"spacing",2);var _a239,DonutInnerCircle=(_a239=class extends BaseProperties{constructor(){super(...arguments),this.fill="transparent",this.fillOpacity=1}},__name(_a239,"DonutInnerCircle"),_a239);__decorateClass([TempValidate()],DonutInnerCircle.prototype,"fill",2);__decorateClass([TempValidate()],DonutInnerCircle.prototype,"fillOpacity",2);var _a240,DonutSeriesCalloutLabel=(_a240=class extends Label{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}},__name(_a240,"DonutSeriesCalloutLabel"),_a240);__decorateClass([TempValidate()],DonutSeriesCalloutLabel.prototype,"offset",2);__decorateClass([TempValidate(NUMBER.restrict({min:0,max:360}))],DonutSeriesCalloutLabel.prototype,"minAngle",2);__decorateClass([TempValidate()],DonutSeriesCalloutLabel.prototype,"minSpacing",2);__decorateClass([TempValidate()],DonutSeriesCalloutLabel.prototype,"maxCollisionOffset",2);__decorateClass([TempValidate()],DonutSeriesCalloutLabel.prototype,"avoidCollisions",2);var _a241,DonutSeriesSectorLabel=(_a241=class extends Label{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}},__name(_a241,"DonutSeriesSectorLabel"),_a241);__decorateClass([TempValidate()],DonutSeriesSectorLabel.prototype,"positionOffset",2);__decorateClass([TempValidate()],DonutSeriesSectorLabel.prototype,"positionRatio",2);var _a242,DonutSeriesCalloutLine=(_a242=class extends BaseProperties{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}},__name(_a242,"DonutSeriesCalloutLine"),_a242);__decorateClass([TempValidate(ARRAY_OF(OR(COLOR_GRADIENT,COLOR_STRING,COLOR_PATTERN)))],DonutSeriesCalloutLine.prototype,"colors",2);__decorateClass([TempValidate()],DonutSeriesCalloutLine.prototype,"length",2);__decorateClass([TempValidate()],DonutSeriesCalloutLine.prototype,"strokeWidth",2);var _a243,DonutSeriesProperties=(_a243=class extends SeriesProperties{constructor(){super(...arguments),this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.hideZeroValueSectorsInLegend=!1,this.innerLabels=new PropertiesArray(DonutInnerLabel),this.title=new DonutTitle,this.innerCircle=new DonutInnerCircle,this.shadow=new DropShadow,this.calloutLabel=new DonutSeriesCalloutLabel,this.sectorLabel=new DonutSeriesSectorLabel,this.calloutLine=new DonutSeriesCalloutLine,this.tooltip=new SeriesTooltip}},__name(_a243,"DonutSeriesProperties"),_a243);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"angleKey",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"angleName",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"angleFilterKey",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"radiusKey",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"radiusName",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"radiusMin",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"radiusMax",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"calloutLabelKey",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"calloutLabelName",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"sectorLabelKey",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"sectorLabelName",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"legendItemKey",2);__decorateClass([TempValidate(ARRAY_OF(COLOR_STRING_ARRAY))],DonutSeriesProperties.prototype,"defaultColorRange",2);__decorateClass([TempValidate(ARRAY_OF(COLOR_STRING))],DonutSeriesProperties.prototype,"defaultPatternFills",2);__decorateClass([TempValidate(ARRAY_OF(OR(COLOR_GRADIENT,COLOR_STRING,COLOR_PATTERN)))],DonutSeriesProperties.prototype,"fills",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"strokes",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"fillOpacity",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"lineDash",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"cornerRadius",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"itemStyler",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"rotation",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"outerRadiusOffset",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"outerRadiusRatio",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"innerRadiusOffset",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"innerRadiusRatio",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"strokeWidth",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"sectorSpacing",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"hideZeroValueSectorsInLegend",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"innerLabels",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"title",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"innerCircle",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"shadow",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"calloutLabel",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"sectorLabel",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"calloutLine",2);__decorateClass([TempValidate()],DonutSeriesProperties.prototype,"tooltip",2);function preparePieSeriesAnimationFunctions(initialLoad,rotationDegrees,scaleFn,oldScaleFn){const scale2=[scaleFn.convert(0),scaleFn.convert(1)],oldScale=[oldScaleFn.convert(0),oldScaleFn.convert(1)],rotation=Math.PI/-2+toRadians(rotationDegrees),phase=initialLoad?"initial":"update",scaleToNewRadius=__name(({radius})=>({innerRadius:scale2[0],outerRadius:scale2[0]+(scale2[1]-scale2[0])*radius}),"scaleToNewRadius"),scaleToOldRadius=__name(({radius})=>({innerRadius:oldScale[0],outerRadius:oldScale[0]+(oldScale[1]-oldScale[0])*radius}),"scaleToOldRadius");return{nodes:{toFn:__name((_sect,datum,status,{prevLive})=>{var _a294,_b;let{startAngle,endAngle,innerRadius,outerRadius}=datum;const{stroke:stroke2,fill}=datum.sectorFormat;if(status==="removed"&&prevLive?(startAngle=(_a294=prevLive.datum)==null?void 0:_a294.endAngle,endAngle=(_b=prevLive.datum)==null?void 0:_b.endAngle):status==="removed"&&!prevLive&&(startAngle=rotation,endAngle=rotation),status==="removed"){const radii=scaleToNewRadius(datum);innerRadius=radii.innerRadius,outerRadius=radii.outerRadius}return{startAngle,endAngle,outerRadius,innerRadius,stroke:stroke2,fill}},"toFn"),fromFn:__name((sect,datum,status,{prevFromProps})=>{let{startAngle,endAngle,innerRadius,outerRadius}=sect,{fill,stroke:stroke2}=datum.sectorFormat;if(status==="updated"&&sect.previousDatum==null&&(status="added"),status==="unknown"||status==="added"&&!prevFromProps?(startAngle=rotation,endAngle=rotation,innerRadius=datum.innerRadius,outerRadius=datum.outerRadius):status==="added"&&prevFromProps&&(startAngle=prevFromProps.endAngle??rotation,endAngle=prevFromProps.endAngle??rotation,innerRadius=prevFromProps.innerRadius??datum.innerRadius,outerRadius=prevFromProps.outerRadius??datum.outerRadius),status==="added"&&!initialLoad){const radii=scaleToOldRadius(datum);innerRadius=radii.innerRadius,outerRadius=radii.outerRadius}return status==="updated"&&(fill=sect.fill??fill,stroke2=(typeof sect.stroke=="string"?sect.stroke:void 0)??stroke2),{startAngle,endAngle,innerRadius,outerRadius,fill,stroke:stroke2,phase}},"fromFn")},innerCircle:{fromFn:__name((node,_)=>{var _a294;return{size:((_a294=node.previousDatum)==null?void 0:_a294.radius)??node.size??0,phase}},"innerCircleFromFn"),toFn:__name((_,datum)=>({size:datum.radius??0}),"innerCircleToFn")}}}__name(preparePieSeriesAnimationFunctions,"preparePieSeriesAnimationFunctions");function resetPieSelectionsFn(_node,datum){return{startAngle:datum.startAngle,endAngle:datum.endAngle,innerRadius:datum.innerRadius,outerRadius:datum.outerRadius,stroke:datum.sectorFormat.stroke}}__name(resetPieSelectionsFn,"resetPieSelectionsFn");function pickByMatchingAngle(series,point){const dy=point.y-series.centerY,dx=point.x-series.centerX,angle2=Math.atan2(dy,dx),sectors=series.getItemNodes();for(const sector of sectors)if(sector.datum.missing!==!0&&isBetweenAngles(angle2,sector.startAngle,sector.endAngle)){const radius=Math.sqrt(dx*dx+dy*dy);let distance2=0;return radius<sector.innerRadius?distance2=sector.innerRadius-radius:radius>sector.outerRadius&&(distance2=radius-sector.outerRadius),{datum:sector.datum,distance:distance2}}}__name(pickByMatchingAngle,"pickByMatchingAngle");var PolarZIndexMap=(PolarZIndexMap2=>(PolarZIndexMap2[PolarZIndexMap2.BACKGROUND=0]="BACKGROUND",PolarZIndexMap2[PolarZIndexMap2.FOREGROUND=1]="FOREGROUND",PolarZIndexMap2[PolarZIndexMap2.HIGHLIGHT=2]="HIGHLIGHT",PolarZIndexMap2[PolarZIndexMap2.LABEL=3]="LABEL",PolarZIndexMap2))(PolarZIndexMap||{}),_a244,PolarSeries=(_a244=class extends DataModelSeries{constructor({categoryKey,useLabelLayer=!1,pickModes=[1,0],canHaveAxes=!1,animationResetFns,...opts}){super({...opts,categoryKey,useLabelLayer,pickModes,directionKeys:{x:["angleKey"],y:["radiusKey"]},directionNames:{x:["angleName"],y:["radiusName"]},canHaveAxes}),this.itemGroup=this.contentGroup.appendChild(new Group),this.nodeData=[],this.itemSelection=Selection.select(this.itemGroup,()=>this.nodeFactory(),!1),this.labelSelection=Selection.select(this.labelGroup,()=>this.labelFactory(),!1),this.highlightSelection=Selection.select(this.highlightGroup,()=>this.nodeFactory()),this.highlightLabelSelection=Selection.select(this.highlightLabel,()=>this.labelFactory()),this.centerX=0,this.centerY=0,this.radius=0,this.animationResetFns=animationResetFns,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(data=>this.animateEmptyUpdateReady(data),"action")},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:__name(data=>this.animateReadyHighlight(data),"highlight"),highlightMarkers:__name(data=>this.animateReadyHighlightMarkers(data),"highlightMarkers"),resize:__name(data=>this.animateReadyResize(data),"resize"),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:__name(data=>this.animateWaitingUpdateReady(data),"action")},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:__name(data=>this.animateClearingUpdateEmpty(data),"action")},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getItemNodes(){return[...this.itemGroup.children()]}getNodeData(){return this.nodeData}setSeriesIndex(index){return super.setSeriesIndex(index)?(this.contentGroup.zIndex=[index,1],this.highlightGroup.zIndex=[index,2],this.labelGroup.zIndex=[index,3],!0):!1}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}labelFactory(){const text2=new Text;return text2.pointerEvents=1,text2}addChartEventListeners(){var _a294,_b;this.destroyFns.push((_a294=this.ctx.chartEventManager)==null?void 0:_a294.addListener("legend-item-click",event=>this.onLegendItemClick(event)),(_b=this.ctx.chartEventManager)==null?void 0:_b.addListener("legend-item-double-click",event=>this.onLegendItemDoubleClick(event)))}getInnerRadius(){return 0}computeLabelsBBox(_options,_seriesRect){return null}getShapeFillBBox(){const outerRadius=this.radius;return{series:new BBox(-outerRadius,-outerRadius,outerRadius*2,outerRadius*2),axis:new BBox(-outerRadius,-outerRadius,outerRadius*2,outerRadius*2)}}resetAllAnimation(){const{item,label}=this.animationResetFns??{};this.ctx.animationManager.stopByAnimationGroupId(this.id),item&&resetMotion([this.itemSelection,this.highlightSelection],item),label&&resetMotion([this.labelSelection,this.highlightLabelSelection],label),this.itemSelection.cleanup(),this.labelSelection.cleanup(),this.highlightSelection.cleanup(),this.highlightLabelSelection.cleanup()}animateEmptyUpdateReady(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateWaitingUpdateReady(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateReadyHighlight(_data){const{item,label}=this.animationResetFns??{};item&&resetMotion([this.highlightSelection],item),label&&resetMotion([this.highlightLabelSelection],label)}animateReadyHighlightMarkers(_data){}animateReadyResize(_data){this.resetAllAnimation()}animateClearingUpdateEmpty(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}computeFocusBounds(opts){var _a294;const datum=(_a294=this.getNodeData())==null?void 0:_a294[opts.datumIndex];if(datum!==void 0)return this.itemSelection.select(node=>node instanceof Path&&node.datum===datum)[0]}getSeriesRange(_direction,_visibleRange){return[NaN,NaN]}},__name(_a244,"PolarSeries"),_a244),_a245,DonutSeriesNodeEvent=(_a245=class extends SeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.angleKey=series.properties.angleKey,this.radiusKey=series.properties.radiusKey,this.calloutLabelKey=series.properties.calloutLabelKey,this.sectorLabelKey=series.properties.sectorLabelKey}},__name(_a245,"DonutSeriesNodeEvent"),_a245),_a246,DonutSeries=(_a246=class extends PolarSeries{constructor(moduleCtx){super({moduleCtx,categoryKey:void 0,pickModes:[1,0],useLabelLayer:!0,animationResetFns:{item:resetPieSelectionsFn,label:resetLabelFn}}),this.properties=new DonutSeriesProperties,this.phantomNodeData=void 0,this.backgroundGroup=new TranslatableGroup({name:`${this.id}-background`,zIndex:0}),this.noVisibleData=!1,this.previousRadiusScale=new LinearScale,this.radiusScale=new LinearScale,this.phantomGroup=this.backgroundGroup.appendChild(new Group({name:"phantom"})),this.phantomSelection=Selection.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Group({name:"pieCalloutLabels"})),this.calloutLabelSelection=new Selection(this.calloutLabelGroup,Group),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Marker({shape:"circle"})),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new Marker({shape:"circle"})),this.innerLabelsGroup=this.contentGroup.appendChild(new Group({name:"innerLabels"})),this.innerCircleGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-innerCircle`})),this.innerLabelsSelection=Selection.select(this.innerLabelsGroup,Text),this.innerCircleSelection=Selection.select(this.innerCircleGroup,()=>new Marker({shape:"circle"})),this.surroundingRadius=void 0,this.NodeEvent=DonutSeriesNodeEvent,this.angleScale=new LinearScale,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(angle2=>angle2+Math.PI/2),this.phantomGroup.opacity=.2}get calloutNodeData(){return this.phantomNodeData??this.nodeData}attachSeries(seriesContentNode,seriesNode,annotationNode){super.attachSeries(seriesContentNode,seriesNode,annotationNode),seriesContentNode==null||seriesContentNode.appendChild(this.backgroundGroup)}detachSeries(seriesContentNode,seriesNode,annotationNode){super.detachSeries(seriesContentNode,seriesNode,annotationNode),seriesContentNode==null||seriesContentNode.removeChild(this.backgroundGroup)}setSeriesIndex(index){return super.setSeriesIndex(index)?(this.backgroundGroup.zIndex=[0,index],!0):!1}nodeFactory(){return new Sector}getSeriesDomain(direction){return direction==="x"?this.angleScale.domain:this.radiusScale.domain}async processData(dataController){var _a294,_b;if(this.data==null||!this.properties.isValid())return;const{visible,id:seriesId,ctx:{legendManager}}=this,{angleKey,angleFilterKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,processor=__name(()=>(value,index)=>visible&&legendManager.getItemEnabled({seriesId,itemId:index})?value:0,"processor"),animationEnabled=!this.ctx.animationManager.isSkipped(),extraKeyProps=[],extraProps=[];legendItemKey?extraKeyProps.push(keyProperty(legendItemKey,"band",{id:"legendItemKey"})):calloutLabelKey?extraKeyProps.push(keyProperty(calloutLabelKey,"band",{id:"calloutLabelKey"})):sectorLabelKey&&extraKeyProps.push(keyProperty(sectorLabelKey,"band",{id:"sectorLabelKey"}));const radiusScaleType=this.radiusScale.type,angleScaleType=this.angleScale.type;radiusKey&&extraProps.push(rangedValueProperty(radiusKey,{id:"radiusValue",min:this.properties.radiusMin??0,max:this.properties.radiusMax,processor}),valueProperty(radiusKey,radiusScaleType,{id:"radiusRaw",processor}),normalisePropertyTo("radiusValue",[0,1],1,this.properties.radiusMin??0,this.properties.radiusMax)),calloutLabelKey&&extraProps.push(valueProperty(calloutLabelKey,"band",{id:"calloutLabelValue"})),sectorLabelKey&&extraProps.push(valueProperty(sectorLabelKey,"band",{id:"sectorLabelValue"})),legendItemKey&&extraProps.push(valueProperty(legendItemKey,"band",{id:"legendItemValue"})),angleFilterKey&&extraProps.push(accumulativeValueProperty(angleFilterKey,angleScaleType,{id:"angleFilterValue",onlyPositive:!0,invalidValue:0,processor}),valueProperty(angleFilterKey,angleScaleType,{id:"angleFilterRaw"}),normalisePropertyTo("angleFilterValue",[0,1],0,0)),animationEnabled&&this.processedData&&extraKeyProps.length>0&&extraProps.push(diff(this.id,this.processedData)),extraProps.push(animationValidation()),await this.requestDataModel(dataController,this.data,{props:[...extraKeyProps,accumulativeValueProperty(angleKey,angleScaleType,{id:"angleValue",onlyPositive:!0,invalidValue:0,processor}),valueProperty(angleKey,angleScaleType,{id:"angleRaw"}),normalisePropertyTo("angleValue",[0,1],0,0),...extraProps]});for(const valueDef of((_b=(_a294=this.processedData)==null?void 0:_a294.defs)==null?void 0:_b.values)??[]){const{id,missing,property}=valueDef,missCount=getMissCount(this,missing);id!=="angleRaw"&&missCount>0&&logger_exports.warnOnce(`no value was found for the key '${String(property)}' on ${missCount} data element${missCount>1?"s":""}`)}this.animationState.transition("updateData")}maybeRefreshNodeData(){if(!this.nodeDataRefresh)return;const{nodeData=[],phantomNodeData}=this.createNodeData()??{};this.nodeData=nodeData,this.phantomNodeData=phantomNodeData,this.nodeDataRefresh=!1}getProcessedDataValues(dataModel,processedData){const angleValues=dataModel.resolveColumnById(this,"angleValue",processedData),angleRawValues=dataModel.resolveColumnById(this,"angleRaw",processedData),angleFilterValues=this.properties.angleFilterKey!=null?dataModel.resolveColumnById(this,"angleFilterValue",processedData):void 0,angleFilterRawValues=this.properties.angleFilterKey!=null?dataModel.resolveColumnById(this,"angleFilterRaw",processedData):void 0,radiusValues=this.properties.radiusKey?dataModel.resolveColumnById(this,"radiusValue",processedData):void 0,radiusRawValues=this.properties.radiusKey?dataModel.resolveColumnById(this,"radiusRaw",processedData):void 0,calloutLabelValues=this.properties.calloutLabelKey?dataModel.resolveColumnById(this,"calloutLabelValue",processedData):void 0,sectorLabelValues=this.properties.sectorLabelKey?dataModel.resolveColumnById(this,"sectorLabelValue",processedData):void 0,legendItemValues=this.properties.legendItemKey?dataModel.resolveColumnById(this,"legendItemValue",processedData):void 0;return{angleValues,angleRawValues,angleFilterValues,angleFilterRawValues,radiusValues,radiusRawValues,calloutLabelValues,sectorLabelValues,legendItemValues}}createNodeData(){var _a294;const{id:seriesId,processedData,dataModel,angleScale,ctx:{legendManager},visible}=this,{rotation,innerRadiusRatio}=this.properties;if(!this.properties.isValid())return this.zerosumOuterRing.visible=!0,this.zerosumInnerRing.visible=!0,{itemId:seriesId,nodeData:[],labelData:[]};if(!dataModel||(processedData==null?void 0:processedData.type)!=="ungrouped")return;const{angleValues,angleRawValues,angleFilterValues,angleFilterRawValues,radiusValues,radiusRawValues,calloutLabelValues,sectorLabelValues,legendItemValues}=this.getProcessedDataValues(dataModel,processedData),useFilterAngles=(angleFilterRawValues==null?void 0:angleFilterRawValues.some((filterRawValue,index)=>filterRawValue>angleRawValues[index]))??!1;let currentStart=0,sum2=0;const nodes=[],phantomNodes=angleFilterRawValues!=null?[]:void 0,rawData=processedData.dataSources.get(this.id)??[],invalidData=(_a294=processedData.invalidData)==null?void 0:_a294.get(this.id);return rawData.forEach((datum,datumIndex)=>{if((invalidData==null?void 0:invalidData[datumIndex])===!0)return;const currentValue=useFilterAngles?angleFilterValues[datumIndex]:angleValues[datumIndex],crossFilterScale=angleFilterRawValues!=null&&!useFilterAngles?Math.sqrt(angleFilterRawValues[datumIndex]/angleRawValues[datumIndex]):1,startAngle=angleScale.convert(currentStart)+toRadians(rotation);currentStart=currentValue,sum2+=currentValue;const endAngle=angleScale.convert(currentStart)+toRadians(rotation),span=Math.abs(endAngle-startAngle),midAngle=startAngle+span/2,angleValue=angleRawValues[datumIndex],radius=((radiusValues==null?void 0:radiusValues[datumIndex])??1)*crossFilterScale,radiusValue=radiusRawValues==null?void 0:radiusRawValues[datumIndex],legendItemValue=legendItemValues==null?void 0:legendItemValues[datumIndex],nodeLabels=this.getLabels(datum,midAngle,span,!0,calloutLabelValues==null?void 0:calloutLabelValues[datumIndex],sectorLabelValues==null?void 0:sectorLabelValues[datumIndex],legendItemValue),sectorFormat=this.getSectorFormat(datum,datumIndex,!1),node={itemId:datumIndex,series:this,datum,datumIndex,angleValue,midAngle,midCos:Math.cos(midAngle),midSin:Math.sin(midAngle),startAngle,endAngle,radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0),sectorFormat,radiusValue,legendItemValue,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId:datumIndex}),focusable:!0,...nodeLabels};nodes.push(node),phantomNodes!=null&&phantomNodes.push({...node,radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0),focusable:!1})}),this.zerosumOuterRing.visible=sum2===0,this.zerosumInnerRing.visible=sum2===0&&innerRadiusRatio!=null&&innerRadiusRatio!==1&&innerRadiusRatio>0,{itemId:seriesId,nodeData:nodes,labelData:nodes,phantomNodeData:phantomNodes}}getLabels(datum,midAngle,span,skipDisabled,calloutLabelValue,sectorLabelValue,legendItemValue){const{calloutLabel,sectorLabel,legendItemKey}=this.properties,calloutLabelKey=!skipDisabled||calloutLabel.enabled?this.properties.calloutLabelKey:void 0,sectorLabelKey=!skipDisabled||sectorLabel.enabled?this.properties.sectorLabelKey:void 0;if(!calloutLabelKey&&!sectorLabelKey&&!legendItemKey)return{};const labelFormatterParams={datum,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},result={};return calloutLabelKey&&span>=toRadians(calloutLabel.minAngle)&&(result.calloutLabel={...this.getTextAlignment(midAngle),text:this.getLabelText(calloutLabel,{...labelFormatterParams,value:calloutLabelValue}),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0}),sectorLabelKey&&(result.sectorLabel={text:this.getLabelText(sectorLabel,{...labelFormatterParams,value:sectorLabelValue})}),legendItemKey!=null&&legendItemValue!=null&&(result.legendItem={key:legendItemKey,text:legendItemValue}),result}getTextAlignment(midAngle){const quadrantTextOpts=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],midAngle180=normalizeAngle180(midAngle),quadrantStart=-.75*Math.PI,quadrantOffset=midAngle180-quadrantStart,quadrant=Math.floor(quadrantOffset/(Math.PI/2)),quadrantIndex=modulus(quadrant,quadrantTextOpts.length);return quadrantTextOpts[quadrantIndex]}getNodeFill(fill,defaultColorRange,defaultPatternFill){return getShapeFill(fill,{bounds:"series",colorStops:defaultColorRange.map(color6=>({color:color6})),gradient:"radial",rotation:0,reverse:!0},{pattern:"forward-slanted-lines",fill:defaultPatternFill,fillOpacity:1,backgroundFill:"transparent",backgroundFillOpacity:1,stroke:defaultPatternFill,strokeOpacity:1,strokeWidth:4,rotation:0})}getFillParams(fill,innerRadius,outerRadius){if(!(!isGradientFill(fill)||fill.bounds==="item"))return{centerX:0,centerY:0,innerRadius,outerRadius}}getSectorFormat(datum,datumIndex,highlighted){const{angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fills,strokes,defaultColorRange,defaultPatternFills,itemStyler}=this.properties,defaultStroke=strokes[datumIndex%strokes.length],{fill,fillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius}=mergeDefaults(highlighted&&this.properties.highlightStyle.item,{fill:fills.length>0?fills[datumIndex%fills.length]:void 0,stroke:defaultStroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()},this.properties),defaultColors=defaultColorRange[datumIndex%defaultColorRange.length],defaultPatternFill=defaultPatternFills[datumIndex%defaultPatternFills.length],sectorFill=fill??"black";let format;return itemStyler&&(format=this.cachedDatumCallback(this.getDatumId(datum,datumIndex)+(highlighted?"-highlight":"-hide"),()=>this.callWithContext(itemStyler,{datum,angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fill:this.getNodeFill(sectorFill,defaultColors,defaultPatternFill),fillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius,highlighted,seriesId:this.id}))),{fill:this.getNodeFill((format==null?void 0:format.fill)??sectorFill,defaultColors,defaultPatternFill),fillOpacity:(format==null?void 0:format.fillOpacity)??fillOpacity,stroke:(format==null?void 0:format.stroke)??stroke2,strokeWidth:(format==null?void 0:format.strokeWidth)??strokeWidth,strokeOpacity:(format==null?void 0:format.strokeOpacity)??strokeOpacity,lineDash:(format==null?void 0:format.lineDash)??lineDash,lineDashOffset:(format==null?void 0:format.lineDashOffset)??lineDashOffset,cornerRadius:(format==null?void 0:format.cornerRadius)??cornerRadius}}getInnerRadius(){const{radius}=this,{innerRadiusRatio=1,innerRadiusOffset=0}=this.properties,innerRadius=radius*innerRadiusRatio+innerRadiusOffset;return innerRadius===radius||innerRadius<0?0:innerRadius}getOuterRadius(){const{outerRadiusRatio,outerRadiusOffset}=this.properties;return Math.max(this.radius*outerRadiusRatio+outerRadiusOffset,0)}updateRadiusScale(resize){var _a294;const newRange=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=newRange,resize&&(this.previousRadiusScale.range=newRange);const setRadii=__name(d=>({...d,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(d.radius),0)}),"setRadii");this.nodeData=this.nodeData.map(setRadii),this.phantomNodeData=(_a294=this.phantomNodeData)==null?void 0:_a294.map(setRadii)}getTitleTranslationY(){var _a294;const outerRadius=Math.max(0,this.radiusScale.range[1]);if(outerRadius===0)return NaN;const titleOffset=2+(((_a294=this.properties.title)==null?void 0:_a294.spacing)??0),dy=Math.max(0,-outerRadius);return-outerRadius-titleOffset-dy}update({seriesRect}){const{title}=this.properties,newNodeDataDependencies={seriesRectWidth:seriesRect==null?void 0:seriesRect.width,seriesRectHeight:seriesRect==null?void 0:seriesRect.height},resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;if(resize&&(this._nodeDataDependencies=newNodeDataDependencies),this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(resize),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),title){const dy=this.getTitleTranslationY();title.node.y=isFinite(dy)?dy:0;const titleBox=title.node.getBBox();title.node.visible=title.enabled&&isFinite(dy)&&!this.bboxIntersectsSurroundingSeries(titleBox)}for(const circle of[this.zerosumInnerRing,this.zerosumOuterRing])circle.fillOpacity=0,circle.stroke=this.properties.calloutLabel.color,circle.strokeWidth=1,circle.strokeOpacity=1;this.updateNodeMidPoint(),this.updateSelections(),this.updateNodes(seriesRect)}updateTitleNodes(){var _a294,_b;const{oldTitle}=this,{title}=this.properties;oldTitle!==title&&(oldTitle&&((_a294=this.labelGroup)==null||_a294.removeChild(oldTitle.node)),title&&(title.node.textBaseline="bottom",(_b=this.labelGroup)==null||_b.appendChild(title.node)),this.oldTitle=title)}updateNodeMidPoint(){var _a294;const setMidPoint=__name(d=>{const radius=d.innerRadius+(d.outerRadius-d.innerRadius)/2;d.midPoint={x:d.midCos*Math.max(0,radius),y:d.midSin*Math.max(0,radius)}},"setMidPoint");this.nodeData.forEach(setMidPoint),(_a294=this.phantomNodeData)==null||_a294.forEach(setMidPoint)}updateSelections(){this.updateGroupSelection(),this.updateInnerCircleSelection()}updateGroupSelection(){const{itemSelection,highlightSelection,phantomSelection,highlightLabelSelection,calloutLabelSelection,labelSelection,innerLabelsSelection}=this,highlightedNodeData=this.nodeData.map(datum=>({...datum,sectorFormat:{...datum.sectorFormat}})),update=__name((selection,nodeData)=>{selection.update(nodeData,void 0,datum=>this.getDatumId(datum.datum,datum.datumIndex)),this.ctx.animationManager.isSkipped()&&selection.cleanup()},"update");update(itemSelection,this.nodeData),update(highlightSelection,highlightedNodeData),update(phantomSelection,this.phantomNodeData??[]),calloutLabelSelection.update(this.calloutNodeData,group=>{const line=new Line;line.tag=0,line.pointerEvents=1,group.appendChild(line);const text2=new Text;text2.tag=1,text2.pointerEvents=1,group.appendChild(text2)}),labelSelection.update(this.nodeData),highlightLabelSelection.update(highlightedNodeData),innerLabelsSelection.update(this.properties.innerLabels,node=>{node.pointerEvents=1})}updateInnerCircleSelection(){const{innerCircle}=this.properties;let radius=0;const innerRadius=this.getInnerRadius();if(innerRadius>0){const circleRadius=Math.min(innerRadius,this.getOuterRadius());radius=Math.ceil(circleRadius*2+1)}const datums=innerCircle?[{radius}]:[];this.innerCircleSelection.update(datums)}updateNodes(seriesRect){const highlightedDatum=this.ctx.highlightManager.getActiveHighlight(),{visible}=this;this.backgroundGroup.visible=visible,this.contentGroup.visible=visible,this.highlightGroup.visible=visible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.highlightLabel.visible=visible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.labelGroup.visible=visible,this.contentGroup.opacity=this.getOpacity(),this.innerCircleSelection.each((node,{radius})=>{var _a294,_b;node.setProperties({fill:this.getNodeFill((_a294=this.properties.innerCircle)==null?void 0:_a294.fill,["black"],"black"),opacity:(_b=this.properties.innerCircle)==null?void 0:_b.fillOpacity,size:radius})});const innerRadius=this.radiusScale.range[0],outerRadius=this.radiusScale.range[1],fillBBox=this.getShapeFillBBox(),animationDisabled=this.ctx.animationManager.isSkipped(),updateSectorFn=__name((sector,datum,_index,isDatumHighlighted)=>{const format=this.getSectorFormat(datum.datum,datum.itemId,isDatumHighlighted);datum.sectorFormat.fill=format.fill,datum.sectorFormat.stroke=format.stroke,animationDisabled&&(sector.startAngle=datum.startAngle,sector.endAngle=datum.endAngle,sector.innerRadius=datum.innerRadius,sector.outerRadius=datum.outerRadius),(isDatumHighlighted||animationDisabled)&&(sector.fill=format.fill,sector.stroke=format.stroke);const fillParams=this.getFillParams(format.fill,innerRadius,outerRadius);applyShapeFillBBox(sector,format.fill,fillBBox,fillParams),sector.strokeWidth=format.strokeWidth,sector.fillOpacity=format.fillOpacity,sector.strokeOpacity=format.strokeOpacity,sector.lineDash=format.lineDash,sector.lineDashOffset=format.lineDashOffset,sector.cornerRadius=format.cornerRadius,sector.fillShadow=this.properties.shadow;const inset=Math.max((this.properties.sectorSpacing+(format.stroke!=null?format.strokeWidth:0))/2,0);sector.inset=inset,sector.lineJoin=this.properties.sectorSpacing>=0||inset>0?"miter":"round"},"updateSectorFn");this.itemSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.highlightSelection.each((node,datum,index)=>{updateSectorFn(node,datum,index,!0),node.visible=datum.itemId===(highlightedDatum==null?void 0:highlightedDatum.itemId)}),this.phantomSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(seriesRect),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{calloutLine:{length:calloutLength,strokeWidth,colors},strokes}=this.properties,calloutStrokeWidth=strokeWidth,calloutColors=isStringFillArray(colors)?colors??this.properties.strokes:strokes,{offset:offset4}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(0).forEach((line,index)=>{const datum=line.closestDatum(),{calloutLabel:label,outerRadius}=datum;if(label!=null&&label.text&&!label.hidden&&outerRadius!==0){line.visible=!0,line.strokeWidth=calloutStrokeWidth,line.stroke=calloutColors[index%calloutColors.length],line.fill=void 0;const x1=datum.midCos*outerRadius,y1=datum.midSin*outerRadius;let x2=datum.midCos*(outerRadius+calloutLength),y2=datum.midSin*(outerRadius+calloutLength);if((label.collisionTextAlign??label.collisionOffsetY!==0)&&label.box!=null){const box=label.box;let cx=x2,cy=y2;x2<box.x?cx=box.x:x2>box.x+box.width&&(cx=box.x+box.width),y2<box.y?cy=box.y:y2>box.y+box.height&&(cy=box.y+box.height);const dx=cx-x2,dy=cy-y2,length2=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),paddedLength=length2-offset4;paddedLength>0&&(x2=x2+dx*paddedLength/length2,y2=y2+dy*paddedLength/length2)}line.x1=x1,line.y1=y1,line.x2=x2,line.y2=y2}else line.visible=!1})}getLabelOverflow(text2,box,seriesRect){const seriesLeft=-this.centerX,seriesRight=seriesLeft+seriesRect.width,seriesTop=-this.centerY,seriesBottom=seriesTop+seriesRect.height,errPx=1;let visibleTextPart=1;box.x+errPx<seriesLeft?visibleTextPart=(box.x+box.width-seriesLeft)/box.width:box.x+box.width-errPx>seriesRight&&(visibleTextPart=(seriesRight-box.x)/box.width);const hasVerticalOverflow=box.y+errPx<seriesTop||box.y+box.height-errPx>seriesBottom,textLength=visibleTextPart===1?text2.length:Math.floor(text2.length*visibleTextPart)-1,hasSurroundingSeriesOverflow=this.bboxIntersectsSurroundingSeries(box);return{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}}bboxIntersectsSurroundingSeries(box){const{surroundingRadius}=this;if(surroundingRadius==null)return!1;const corners=[{x:box.x,y:box.y},{x:box.x+box.width,y:box.y},{x:box.x+box.width,y:box.y+box.height},{x:box.x,y:box.y+box.height}],sur2=surroundingRadius**2;return corners.some(corner=>corner.x**2+corner.y**2>sur2)}computeCalloutLabelCollisionOffsets(){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,{offset:offset4,minSpacing}=calloutLabel,innerRadius=radiusScale.convert(0),shouldSkip=__name(datum=>!datum.calloutLabel||datum.outerRadius===0,"shouldSkip"),fullData=this.calloutNodeData,data=fullData.filter(t=>!shouldSkip(t));if(data.forEach(datum=>{const label=datum.calloutLabel;label!=null&&(label.hidden=!1,label.collisionTextAlign=void 0,label.collisionOffsetY=0)}),data.length<=1)return;const leftLabels=data.filter(d=>d.midCos<0).sort((a,b)=>a.midSin-b.midSin),rightLabels=data.filter(d=>d.midCos>=0).sort((a,b)=>a.midSin-b.midSin),topLabels=data.filter(d=>{var _a294;return d.midSin<0&&((_a294=d.calloutLabel)==null?void 0:_a294.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),bottomLabels=data.filter(d=>{var _a294;return d.midSin>=0&&((_a294=d.calloutLabel)==null?void 0:_a294.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),getTextBBox=__name(datum=>{const label=datum.calloutLabel;if(label==null)return BBox.zero.clone();const labelRadius=datum.outerRadius+calloutLine.length+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,textAlign=label.collisionTextAlign??label.textAlign,textBaseline=label.textBaseline;return Text.computeBBox(label.text,x,y,{font:this.properties.calloutLabel,textAlign,textBaseline})},"getTextBBox"),avoidNeighbourYCollision=__name((label,next,direction)=>{const box=getTextBBox(label).grow(minSpacing/2),other=getTextBBox(next).grow(minSpacing/2);box.x<other.x+other.width&&box.x+box.width>other.x&&(direction==="to-top"?box.y<other.y+other.height:box.y+box.height>other.y)&&(next.calloutLabel.collisionOffsetY=direction==="to-top"?box.y-other.y-other.height:box.y+box.height-other.y)},"avoidNeighbourYCollision"),avoidYCollisions=__name(labels=>{const midLabel=labels.slice().sort((a,b)=>Math.abs(a.midSin)-Math.abs(b.midSin))[0],midIndex=labels.indexOf(midLabel);for(let i=midIndex-1;i>=0;i--){const prev=labels[i+1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-top")}for(let i=midIndex+1;i<labels.length;i++){const prev=labels[i-1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-bottom")}},"avoidYCollisions"),avoidXCollisions=__name(labels=>{const labelsCollideLabelsByY=data.some(datum=>datum.calloutLabel.collisionOffsetY!==0),boxes=labels.map(label=>getTextBBox(label)),paddedBoxes=boxes.map(box=>box.clone().grow(minSpacing/2));let labelsCollideLabelsByX=!1;for(let i=0;i<paddedBoxes.length&&!labelsCollideLabelsByX;i++){const box=paddedBoxes[i];for(let j=i+1;j<labels.length;j++){const other=paddedBoxes[j];if(box.collidesBBox(other)){labelsCollideLabelsByX=!0;break}}}const sectors=fullData.map(datum=>{const{startAngle,endAngle,outerRadius}=datum;return{startAngle,endAngle,innerRadius,outerRadius}}),labelsCollideSectors=boxes.some(box=>sectors.some(sector=>boxCollidesSector(box,sector)));!labelsCollideLabelsByX&&!labelsCollideLabelsByY&&!labelsCollideSectors||labels.filter(d=>d.calloutLabel.textAlign==="center").forEach(d=>{const label=d.calloutLabel;d.midCos<0?label.collisionTextAlign="right":d.midCos>0?label.collisionTextAlign="left":label.collisionTextAlign="center"})},"avoidXCollisions");avoidYCollisions(leftLabels),avoidYCollisions(rightLabels),avoidXCollisions(topLabels),avoidXCollisions(bottomLabels)}updateCalloutLabelNodes(seriesRect){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,color:color6}=calloutLabel,tempTextNode=new Text;this.calloutLabelSelection.selectByTag(1).forEach(text2=>{const datum=text2.closestDatum(),label=datum.calloutLabel,radius=radiusScale.convert(datum.radius),outerRadius=Math.max(0,radius);if(!(label!=null&&label.text)||outerRadius===0||label.hidden){text2.visible=!1;return}const labelRadius=outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,align2={textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline};tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign(align2);const box=tempTextNode.getBBox();let displayText=label.text,visible=!0;if(calloutLabel.avoidCollisions){const{textLength,hasVerticalOverflow}=this.getLabelOverflow(label.text,box,seriesRect);displayText=label.text.length===textLength?label.text:`${label.text.substring(0,textLength)}`,visible=!hasVerticalOverflow}text2.text=displayText,text2.x=x,text2.y=y,text2.setFont(this.properties.calloutLabel),text2.setAlign(align2),text2.fill=color6,text2.visible=visible})}computeLabelsBBox(options,seriesRect){const{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,maxCollisionOffset,minSpacing}=calloutLabel;if(!calloutLabel.avoidCollisions)return null;this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const textBoxes=[],text2=new Text;let titleBox;const{title}=this.properties;if(title!=null&&title.text&&title.enabled){const dy=this.getTitleTranslationY();isFinite(dy)&&(text2.text=title.text,text2.x=0,text2.y=dy,text2.setFont(title),text2.setAlign({textBaseline:"bottom",textAlign:"center"}),titleBox=text2.getBBox(),textBoxes.push(titleBox))}return this.calloutNodeData.forEach(datum=>{const label=datum.calloutLabel;if(!label||datum.outerRadius===0)return null;const labelRadius=datum.outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;text2.text=label.text,text2.x=x,text2.y=y,text2.setFont(this.properties.calloutLabel),text2.setAlign({textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline});const box=text2.getBBox();if(label.box=box,Math.abs(label.collisionOffsetY)>maxCollisionOffset){label.hidden=!0;return}if(titleBox){const seriesTop=-this.centerY,titleCleanArea=new BBox(titleBox.x-minSpacing,seriesTop,titleBox.width+2*minSpacing,titleBox.y+titleBox.height+minSpacing-seriesTop);if(box.collidesBBox(titleCleanArea)){label.hidden=!0;return}}if(options.hideWhenNecessary){const{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}=this.getLabelOverflow(label.text,box,seriesRect),isTooShort=label.text.length>2&&textLength<2;if(hasVerticalOverflow||isTooShort||hasSurroundingSeriesOverflow){label.hidden=!0;return}}label.hidden=!1,textBoxes.push(box)}),textBoxes.length===0?null:BBox.merge(textBoxes)}updateSectorLabelNodes(){const{radiusScale}=this,innerRadius=radiusScale.convert(0),{fontSize,fontStyle,fontWeight,fontFamily,positionOffset,positionRatio,color:color6}=this.properties.sectorLabel,updateSectorLabel=__name((text2,datum)=>{const{sectorLabel,outerRadius}=datum;let isTextVisible=!1;if(sectorLabel&&outerRadius!==0){const labelRadius=innerRadius*(1-positionRatio)+outerRadius*positionRatio+positionOffset;text2.fill=color6,text2.fontStyle=fontStyle,text2.fontWeight=fontWeight,text2.fontSize=fontSize,text2.fontFamily=fontFamily,text2.text=sectorLabel.text,text2.x=datum.midCos*labelRadius,text2.y=datum.midSin*labelRadius,text2.textAlign="center",text2.textBaseline="middle";const bbox=text2.getBBox(),corners=[[bbox.x,bbox.y],[bbox.x+bbox.width,bbox.y],[bbox.x+bbox.width,bbox.y+bbox.height],[bbox.x,bbox.y+bbox.height]],{startAngle,endAngle}=datum,sectorBounds={startAngle,endAngle,innerRadius,outerRadius};corners.every(([x,y])=>isPointInSector(x,y,sectorBounds))&&(isTextVisible=!0)}text2.visible=isTextVisible},"updateSectorLabel");this.labelSelection.each(updateSectorLabel),this.highlightLabelSelection.each(updateSectorLabel)}updateInnerLabelNodes(){const textBBoxes=[],margins=[];this.innerLabelsSelection.each((text2,datum)=>{const{fontStyle,fontWeight,fontSize,fontFamily,color:color6}=datum;text2.fontStyle=fontStyle,text2.fontWeight=fontWeight,text2.fontSize=fontSize,text2.fontFamily=fontFamily,text2.text=datum.text,text2.x=0,text2.y=0,text2.fill=color6,text2.textAlign="center",text2.textBaseline="alphabetic",textBBoxes.push(text2.getBBox()),margins.push(datum.spacing)});const getMarginTop=__name(index=>index===0?0:margins[index],"getMarginTop"),getMarginBottom=__name(index=>index===margins.length-1?0:margins[index],"getMarginBottom"),totalHeight=textBBoxes.reduce((sum2,bbox,i)=>sum2+bbox.height+getMarginTop(i)+getMarginBottom(i),0),totalWidth=Math.max(...textBBoxes.map(bbox=>bbox.width)),innerRadius=this.getInnerRadius(),labelsVisible=Math.sqrt(Math.pow(totalWidth/2,2)+Math.pow(totalHeight/2,2))<=(innerRadius>0?innerRadius:this.getOuterRadius()),textBottoms=[];for(let i=0,prev=-totalHeight/2;i<textBBoxes.length;i++){const bottom=textBBoxes[i].height+prev+getMarginTop(i);textBottoms.push(bottom),prev=bottom+getMarginBottom(i)}this.innerLabelsSelection.each((text2,_datum,index)=>{text2.y=textBottoms[index],text2.visible=labelsVisible})}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2,this.zerosumInnerRing.size=this.getInnerRadius()*2}pickNodeClosestDatum(point){return pickByMatchingAngle(this,point)}getTooltipContent(datumIndex){var _a294;const{id:seriesId,dataModel,processedData,properties}=this,{legendItemKey,calloutLabelKey,calloutLabelName,sectorLabelKey,sectorLabelName,angleKey,angleName,radiusKey,radiusName,tooltip}=properties,title=this.properties.title.text;if(!dataModel||!processedData)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],{angleRawValues,legendItemValues,calloutLabelValues,sectorLabelValues}=this.getProcessedDataValues(dataModel,processedData),angleRawValue=angleRawValues[datumIndex],label=(legendItemValues==null?void 0:legendItemValues[datumIndex])??(calloutLabelKey===angleKey||calloutLabelValues==null?void 0:calloutLabelValues[datumIndex])??(sectorLabelKey===angleKey||sectorLabelValues==null?void 0:sectorLabelValues[datumIndex])??angleName;return tooltip.formatTooltip(this.properties,{title,symbol:this.legendItemSymbol(datumIndex),data:[{label,fallbackLabel:angleKey,value:formatValue(angleRawValue,3)}]},{seriesId,datum,title:angleName,legendItemKey,calloutLabelKey,calloutLabelName,sectorLabelKey,sectorLabelName,angleKey,angleName,radiusKey,radiusName,...this.getSectorFormat(datum,datumIndex,!1)})}legendItemSymbol(datumIndex){var _a294,_b;const datum=(_b=(_a294=this.processedData)==null?void 0:_a294.dataSources.get(this.id))==null?void 0:_b[datumIndex],sectorFormat=this.getSectorFormat(datum,datumIndex,!1),{fillOpacity,strokeOpacity,strokeWidth,lineDash,lineDashOffset}=this.properties;let{fill}=sectorFormat;const{stroke:stroke2}=sectorFormat;return isGradientFill(fill)&&(fill={...fill,gradient:"linear",rotation:0,reverse:!1}),{marker:{fill,stroke:stroke2,fillOpacity,strokeOpacity,strokeWidth,lineDash,lineDashOffset}}}getLegendData(legendType){var _a294,_b,_c,_d,_e,_f;const{visible,processedData,dataModel,id:seriesId,ctx:{legendManager}}=this;if(!dataModel||!processedData||!this.properties.isValid()||legendType!=="category")return[];const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey,showInLegend}=this.properties;if(!legendItemKey&&(!calloutLabelKey||calloutLabelKey===angleKey)&&(!sectorLabelKey||sectorLabelKey===angleKey))return[];const{angleRawValues,calloutLabelValues,sectorLabelValues,legendItemValues}=this.getProcessedDataValues(dataModel,processedData),titleText=((_a294=this.properties.title)==null?void 0:_a294.showInLegend)&&this.properties.title.text,legendData=[],hideZeros=this.properties.hideZeroValueSectorsInLegend,rawData=processedData.dataSources.get(this.id),invalidData=(_b=processedData.invalidData)==null?void 0:_b.get(this.id);for(let datumIndex=0;datumIndex<processedData.input.count;datumIndex++){const datum=rawData==null?void 0:rawData[datumIndex],angleRawValue=angleRawValues[datumIndex];if((invalidData==null?void 0:invalidData[datumIndex])===!0||hideZeros&&angleRawValue===0)continue;const labelParts=[];titleText&&labelParts.push(titleText);const labels=this.getLabels(datum,2*Math.PI,2*Math.PI,!1,calloutLabelValues==null?void 0:calloutLabelValues[datumIndex],sectorLabelValues==null?void 0:sectorLabelValues[datumIndex],legendItemValues==null?void 0:legendItemValues[datumIndex]);legendItemKey&&labels.legendItem!==void 0?labelParts.push(labels.legendItem.text):calloutLabelKey&&calloutLabelKey!==angleKey&&((_c=labels.calloutLabel)==null?void 0:_c.text)!==void 0?labelParts.push((_d=labels.calloutLabel)==null?void 0:_d.text):sectorLabelKey&&sectorLabelKey!==angleKey&&((_e=labels.sectorLabel)==null?void 0:_e.text)!==void 0&&labelParts.push((_f=labels.sectorLabel)==null?void 0:_f.text),labelParts.length!==0&&legendData.push({legendType:"category",id:seriesId,datum,itemId:datumIndex,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId:datumIndex}),label:{text:labelParts.join(" - ")},symbol:this.legendItemSymbol(datumIndex),legendItemName:legendItemKey!=null?datum[legendItemKey]:void 0,hideInLegend:!showInLegend})}return legendData}setLegendState(enabledItems){const{id:seriesId,ctx:{legendManager,updateService}}=this;enabledItems.forEach((enabled,itemId)=>legendManager.toggleItem(enabled,seriesId,itemId)),legendManager.update(),updateService.update(4)}animateEmptyUpdateReady(_data){const{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[this.itemSelection,this.highlightSelection,this.phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum.datum,datum.datumIndex)),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",animationManager,this.highlightLabelSelection),seriesLabelFadeInAnimation(this,"inner",animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var _a294,_b,_c,_d;const{itemSelection,highlightSelection,phantomSelection,processedData,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,dataDiff=(_b=(_a294=processedData==null?void 0:processedData.reduced)==null?void 0:_a294.diff)==null?void 0:_b[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const supportedDiff=((dataDiff==null?void 0:dataDiff.moved.size)??0)===0,hasKeys=((processedData==null?void 0:processedData.defs.keys.length)??0)>0,hasUniqueKeys=((_d=(_c=processedData==null?void 0:processedData.reduced)==null?void 0:_c.animationValidation)==null?void 0:_d.uniqueKeys)??!0;(!supportedDiff||!hasKeys||!hasUniqueKeys)&&this.ctx.animationManager.skipCurrentBatch();const noVisibleData=!this.nodeData.some(n=>n.enabled),fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum.datum,datum.datumIndex),dataDiff),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.noVisibleData!==noVisibleData&&(this.noVisibleData=noVisibleData,seriesLabelFadeInAnimation(this,"inner",this.ctx.animationManager,this.innerLabelsSelection)),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection,highlightSelection,phantomSelection,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum.datum,datum.datumIndex)),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeOutAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeOutAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeOutAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),seriesLabelFadeOutAnimation(this,"inner",this.ctx.animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumId(datum,datumIndex){var _a294,_b,_c;const{calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;return(_c=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys?legendItemKey?createDatumId(datum[legendItemKey]):calloutLabelKey?createDatumId(datum[calloutLabelKey]):sectorLabelKey?createDatumId(datum[sectorLabelKey]):`${datumIndex}`:`${datumIndex}`}},__name(_a246,"DonutSeries"),_a246);DonutSeries.className="DonutSeries";DonutSeries.type="donut";var pieSeriesOptionsDef={type:required(constant("pie")),angleKey:required(string),radiusKey:string,calloutLabelKey:string,sectorLabelKey:string,legendItemKey:string,angleName:string,radiusName:string,calloutLabelName:string,sectorLabelName:string,radiusMin:positiveNumber,radiusMax:positiveNumber,rotation:number,outerRadiusOffset:number,outerRadiusRatio:ratio,hideZeroValueSectorsInLegend:boolean,sectorSpacing:positiveNumber,cornerRadius:positiveNumber,itemStyler:callback,title:{enabled:boolean,text:string,showInLegend:boolean,spacing:positiveNumber,...fontOptionsDef},calloutLabel:{enabled:boolean,offset:number,minAngle:positiveNumber,avoidCollisions:boolean,formatter:callback,...fontOptionsDef},sectorLabel:{enabled:boolean,positionOffset:number,positionRatio:ratio,formatter:callback,...fontOptionsDef},calloutLine:{colors:arrayOf(color),length:positiveNumber,strokeWidth:positiveNumber},fills:arrayOf(colorUnion),strokes:arrayOf(color),tooltip:tooltipOptionsDefs,shadow:shadowOptionsDefs,...commonSeriesOptionsDefs,...lineDashOptionsDef,...without(fillOptionsDef,["fill"]),...without(strokeOptionsDef,["stroke"])};pieSeriesOptionsDef.defaultColorRange=arrayOf(arrayOf(color));pieSeriesOptionsDef.defaultPatternFills=arrayOf(color);var donutSeriesOptionsDef={...pieSeriesOptionsDef,type:required(constant("donut")),innerRadiusOffset:number,innerRadiusRatio:ratio,innerCircle:{fill:string,fillOpacity:ratio},innerLabels:arrayOfDefs({text:required(string),spacing:positiveNumber,...fontOptionsDef},"inner label options array")},donutTheme={series:{title:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.1666666666666667]},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},spacing:5},calloutLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},offset:3,minAngle:.001},sectorLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"backgroundColor"},positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2,colors:{$map:[{$if:[{$or:[{$isGradient:[{$value:"$1"}]},{$isPattern:[{$value:"$1"}]}]},{$path:["../../strokes/$index",{$ref:"foregroundColor"}]},{$value:"$1"}]},{$if:[{$eq:[{$path:"../strokeWidth"},0]},{$path:"../fills"},{$path:"../strokes"}]}]}},fills:{$palette:"fills"},strokes:{$palette:"strokes"},defaultColorRange:{$palette:"gradients"},defaultPatternFills:SAFE_FILLS_OPERATION,fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,innerRadiusRatio:{$if:[{$eq:[{$path:["./innerRadiusOffset",void 0]},void 0]},.7,void 0]},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},innerLabels:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:2}},legend:{enabled:!0}},DonutSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"donut",moduleFactory:__name(ctx=>new DonutSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"exact"},themeTemplate:donutTheme},NewDonutSeriesModule={type:"series",name:"donut",chartType:"polar",options:donutSeriesOptionsDef,create:__name(ctx=>new DonutSeries(ctx),"create")},_a247,PieTitle=(_a247=class extends Caption{constructor(){super(...arguments),this.showInLegend=!1}},__name(_a247,"PieTitle"),_a247);__decorateClass([TempValidate()],PieTitle.prototype,"showInLegend",2);var _a248,PieSeriesCalloutLabel=(_a248=class extends Label{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}},__name(_a248,"PieSeriesCalloutLabel"),_a248);__decorateClass([TempValidate()],PieSeriesCalloutLabel.prototype,"offset",2);__decorateClass([TempValidate(NUMBER.restrict({min:0,max:360}))],PieSeriesCalloutLabel.prototype,"minAngle",2);__decorateClass([TempValidate()],PieSeriesCalloutLabel.prototype,"minSpacing",2);__decorateClass([TempValidate()],PieSeriesCalloutLabel.prototype,"maxCollisionOffset",2);__decorateClass([TempValidate()],PieSeriesCalloutLabel.prototype,"avoidCollisions",2);var _a249,PieSeriesSectorLabel=(_a249=class extends Label{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}},__name(_a249,"PieSeriesSectorLabel"),_a249);__decorateClass([TempValidate()],PieSeriesSectorLabel.prototype,"positionOffset",2);__decorateClass([TempValidate()],PieSeriesSectorLabel.prototype,"positionRatio",2);var _a250,PieSeriesCalloutLine=(_a250=class extends BaseProperties{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}},__name(_a250,"PieSeriesCalloutLine"),_a250);__decorateClass([TempValidate(ARRAY_OF(OR(COLOR_GRADIENT,COLOR_STRING,COLOR_PATTERN)))],PieSeriesCalloutLine.prototype,"colors",2);__decorateClass([TempValidate()],PieSeriesCalloutLine.prototype,"length",2);__decorateClass([TempValidate()],PieSeriesCalloutLine.prototype,"strokeWidth",2);var _a251,PieSeriesProperties=(_a251=class extends SeriesProperties{constructor(){super(...arguments),this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.hideZeroValueSectorsInLegend=!1,this.title=new PieTitle,this.shadow=new DropShadow,this.calloutLabel=new PieSeriesCalloutLabel,this.sectorLabel=new PieSeriesSectorLabel,this.calloutLine=new PieSeriesCalloutLine,this.tooltip=new SeriesTooltip}},__name(_a251,"PieSeriesProperties"),_a251);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"angleKey",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"angleName",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"angleFilterKey",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"radiusKey",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"radiusName",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"radiusMin",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"radiusMax",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"calloutLabelKey",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"calloutLabelName",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"sectorLabelKey",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"sectorLabelName",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"legendItemKey",2);__decorateClass([TempValidate(ARRAY_OF(COLOR_STRING_ARRAY))],PieSeriesProperties.prototype,"defaultColorRange",2);__decorateClass([TempValidate(ARRAY_OF(COLOR_STRING))],PieSeriesProperties.prototype,"defaultPatternFills",2);__decorateClass([TempValidate(ARRAY_OF(OR(COLOR_GRADIENT,COLOR_STRING,COLOR_PATTERN)))],PieSeriesProperties.prototype,"fills",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"strokes",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"fillOpacity",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"lineDash",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"cornerRadius",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"itemStyler",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"rotation",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"outerRadiusOffset",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"outerRadiusRatio",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"strokeWidth",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"sectorSpacing",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"hideZeroValueSectorsInLegend",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"title",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"shadow",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"calloutLabel",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"sectorLabel",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"calloutLine",2);__decorateClass([TempValidate()],PieSeriesProperties.prototype,"tooltip",2);var _a252,PieSeriesNodeEvent=(_a252=class extends SeriesNodeEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.angleKey=series.properties.angleKey,this.radiusKey=series.properties.radiusKey,this.calloutLabelKey=series.properties.calloutLabelKey,this.sectorLabelKey=series.properties.sectorLabelKey}},__name(_a252,"PieSeriesNodeEvent"),_a252),_a253,PieSeries=(_a253=class extends PolarSeries{constructor(moduleCtx){super({moduleCtx,categoryKey:void 0,pickModes:[1,0],useLabelLayer:!0,animationResetFns:{item:resetPieSelectionsFn,label:resetLabelFn}}),this.properties=new PieSeriesProperties,this.phantomNodeData=void 0,this.backgroundGroup=new TranslatableGroup({name:`${this.id}-background`,zIndex:0}),this.previousRadiusScale=new LinearScale,this.radiusScale=new LinearScale,this.phantomGroup=this.backgroundGroup.appendChild(new Group({name:"phantom"})),this.phantomSelection=Selection.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Group({name:"pieCalloutLabels"})),this.calloutLabelSelection=new Selection(this.calloutLabelGroup,Group),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Marker({shape:"circle"})),this.surroundingRadius=void 0,this.NodeEvent=PieSeriesNodeEvent,this.angleScale=new LinearScale,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(angle2=>angle2+Math.PI/2),this.phantomGroup.opacity=.2}get calloutNodeData(){return this.phantomNodeData??this.nodeData}attachSeries(seriesContentNode,seriesNode,annotationNode){super.attachSeries(seriesContentNode,seriesNode,annotationNode),seriesContentNode.appendChild(this.backgroundGroup)}detachSeries(seriesContentNode,seriesNode,annotationNode){super.detachSeries(seriesContentNode,seriesNode,annotationNode),seriesContentNode==null||seriesContentNode.removeChild(this.backgroundGroup)}setSeriesIndex(index){return super.setSeriesIndex(index)?(this.backgroundGroup.zIndex=[0,index],!0):!1}nodeFactory(){const sector=new Sector;return sector.miterLimit=1e9,sector}getSeriesDomain(direction){return direction==="x"?this.angleScale.domain:this.radiusScale.domain}async processData(dataController){var _a294,_b,_c,_d,_e;if(this.data==null||!this.properties.isValid())return;const{visible,id:seriesId,ctx:{legendManager}}=this,{angleKey,angleFilterKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,processor=__name(()=>(value,index)=>visible&&legendManager.getItemEnabled({seriesId,itemId:index})?value:0,"processor"),animationEnabled=!this.ctx.animationManager.isSkipped(),extraKeyProps=[],extraProps=[];legendItemKey?extraKeyProps.push(keyProperty(legendItemKey,"band",{id:"legendItemKey"})):calloutLabelKey?extraKeyProps.push(keyProperty(calloutLabelKey,"band",{id:"calloutLabelKey"})):sectorLabelKey&&extraKeyProps.push(keyProperty(sectorLabelKey,"band",{id:"sectorLabelKey"}));const radiusScaleType=this.radiusScale.type,angleScaleType=this.angleScale.type;radiusKey&&extraProps.push(rangedValueProperty(radiusKey,{id:"radiusValue",min:this.properties.radiusMin??0,max:this.properties.radiusMax,processor}),valueProperty(radiusKey,radiusScaleType,{id:"radiusRaw",processor}),normalisePropertyTo("radiusValue",[0,1],1,this.properties.radiusMin??0,this.properties.radiusMax)),calloutLabelKey&&extraProps.push(valueProperty(calloutLabelKey,"band",{id:"calloutLabelValue"})),sectorLabelKey&&extraProps.push(valueProperty(sectorLabelKey,"band",{id:"sectorLabelValue"})),legendItemKey&&extraProps.push(valueProperty(legendItemKey,"band",{id:"legendItemValue"})),angleFilterKey&&extraProps.push(accumulativeValueProperty(angleFilterKey,angleScaleType,{id:"angleFilterValue",onlyPositive:!0,invalidValue:0,processor}),valueProperty(angleFilterKey,angleScaleType,{id:"angleFilterRaw"}),normalisePropertyTo("angleFilterValue",[0,1],0,0)),animationEnabled&&((_c=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys)&&extraKeyProps.length>0&&extraProps.push(diff(this.id,this.processedData)),extraProps.push(animationValidation()),await this.requestDataModel(dataController,this.data,{props:[...extraKeyProps,accumulativeValueProperty(angleKey,angleScaleType,{id:"angleValue",onlyPositive:!0,invalidValue:0,processor}),valueProperty(angleKey,angleScaleType,{id:"angleRaw"}),normalisePropertyTo("angleValue",[0,1],0,0),...extraProps]});for(const valueDef of((_e=(_d=this.processedData)==null?void 0:_d.defs)==null?void 0:_e.values)??[]){const{id,missing,property}=valueDef,missCount=getMissCount(this,missing);id!=="angleRaw"&&missCount>0&&logger_exports.warnOnce(`no value was found for the key '${String(property)}' on ${missCount} data element${missCount>1?"s":""}`)}this.animationState.transition("updateData")}maybeRefreshNodeData(){if(!this.nodeDataRefresh)return;const{nodeData=[],phantomNodeData}=this.createNodeData()??{};this.nodeData=nodeData,this.phantomNodeData=phantomNodeData,this.nodeDataRefresh=!1}getProcessedDataValues(dataModel,processedData){const angleValues=dataModel.resolveColumnById(this,"angleValue",processedData),angleRawValues=dataModel.resolveColumnById(this,"angleRaw",processedData),angleFilterValues=this.properties.angleFilterKey!=null?dataModel.resolveColumnById(this,"angleFilterValue",processedData):void 0,angleFilterRawValues=this.properties.angleFilterKey!=null?dataModel.resolveColumnById(this,"angleFilterRaw",processedData):void 0,radiusValues=this.properties.radiusKey?dataModel.resolveColumnById(this,"radiusValue",processedData):void 0,radiusRawValues=this.properties.radiusKey?dataModel.resolveColumnById(this,"radiusRaw",processedData):void 0,calloutLabelValues=this.properties.calloutLabelKey?dataModel.resolveColumnById(this,"calloutLabelValue",processedData):void 0,sectorLabelValues=this.properties.sectorLabelKey?dataModel.resolveColumnById(this,"sectorLabelValue",processedData):void 0,legendItemValues=this.properties.legendItemKey?dataModel.resolveColumnById(this,"legendItemValue",processedData):void 0;return{angleValues,angleRawValues,angleFilterValues,angleFilterRawValues,radiusValues,radiusRawValues,calloutLabelValues,sectorLabelValues,legendItemValues}}createNodeData(){var _a294;const{id:seriesId,processedData,dataModel,angleScale,ctx:{legendManager},visible}=this,{rotation}=this.properties;if(!dataModel||(processedData==null?void 0:processedData.type)!=="ungrouped")return;const{angleValues,angleRawValues,angleFilterValues,angleFilterRawValues,radiusValues,radiusRawValues,calloutLabelValues,sectorLabelValues,legendItemValues}=this.getProcessedDataValues(dataModel,processedData),useFilterAngles=(angleFilterRawValues==null?void 0:angleFilterRawValues.some((filterRawValue,index)=>filterRawValue>angleRawValues[index]))??!1;let currentStart=0,sum2=0;const nodes=[],phantomNodes=angleFilterRawValues!=null?[]:void 0,rawData=processedData.dataSources.get(this.id)??[],invalidData=(_a294=processedData.invalidData)==null?void 0:_a294.get(this.id);return rawData.forEach((datum,datumIndex)=>{if((invalidData==null?void 0:invalidData[datumIndex])===!0)return;const currentValue=useFilterAngles?angleFilterValues[datumIndex]:angleValues[datumIndex],crossFilterScale=angleFilterRawValues!=null&&!useFilterAngles?Math.sqrt(angleFilterRawValues[datumIndex]/angleRawValues[datumIndex]):1,startAngle=angleScale.convert(currentStart)+toRadians(rotation);currentStart=currentValue,sum2+=currentValue;const endAngle=angleScale.convert(currentStart)+toRadians(rotation),span=Math.abs(endAngle-startAngle),midAngle=startAngle+span/2,angleValue=angleRawValues[datumIndex],radius=((radiusValues==null?void 0:radiusValues[datumIndex])??1)*crossFilterScale,radiusValue=radiusRawValues==null?void 0:radiusRawValues[datumIndex],legendItemValue=legendItemValues==null?void 0:legendItemValues[datumIndex],nodeLabels=this.getLabels(datum,midAngle,span,!0,calloutLabelValues==null?void 0:calloutLabelValues[datumIndex],sectorLabelValues==null?void 0:sectorLabelValues[datumIndex],legendItemValue),sectorFormat=this.getSectorFormat(datum,datumIndex,!1),node={itemId:datumIndex,series:this,datum,datumIndex,angleValue,midAngle,midCos:Math.cos(midAngle),midSin:Math.sin(midAngle),startAngle,endAngle,radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0),sectorFormat,radiusValue,legendItemValue,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId:datumIndex}),...nodeLabels};nodes.push(node),phantomNodes!=null&&phantomNodes.push({...node,radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0)})}),this.zerosumOuterRing.visible=sum2===0,{itemId:seriesId,nodeData:nodes,labelData:nodes,phantomNodeData:phantomNodes}}getLabels(datum,midAngle,span,skipDisabled,calloutLabelValue,sectorLabelValue,legendItemValue){const{calloutLabel,sectorLabel,legendItemKey}=this.properties,calloutLabelKey=!skipDisabled||calloutLabel.enabled?this.properties.calloutLabelKey:void 0,sectorLabelKey=!skipDisabled||sectorLabel.enabled?this.properties.sectorLabelKey:void 0;if(!calloutLabelKey&&!sectorLabelKey&&!legendItemKey)return{};const labelFormatterParams={datum,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},result={};return calloutLabelKey&&span>=toRadians(calloutLabel.minAngle)&&(result.calloutLabel={...this.getTextAlignment(midAngle),text:this.getLabelText(calloutLabel,{...labelFormatterParams,value:calloutLabelValue}),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0}),sectorLabelKey&&(result.sectorLabel={text:this.getLabelText(sectorLabel,{...labelFormatterParams,value:sectorLabelValue})}),legendItemKey!=null&&legendItemValue!=null&&(result.legendItem={key:legendItemKey,text:legendItemValue}),result}getTextAlignment(midAngle){const quadrantTextOpts=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],midAngle180=normalizeAngle180(midAngle),quadrantStart=-.75*Math.PI,quadrantOffset=midAngle180-quadrantStart,quadrant=Math.floor(quadrantOffset/(Math.PI/2)),quadrantIndex=modulus(quadrant,quadrantTextOpts.length);return quadrantTextOpts[quadrantIndex]}getNodeFill(fill,defaultColorRange,defaultPatternFill){return getShapeFill(fill,{bounds:"series",colorStops:defaultColorRange.map(color6=>({color:color6})),gradient:"radial",rotation:0,reverse:!0},{pattern:"forward-slanted-lines",fill:defaultPatternFill,fillOpacity:1,backgroundFill:"transparent",backgroundFillOpacity:1,stroke:defaultPatternFill,strokeOpacity:1,strokeWidth:4,rotation:0})}getFillParams(fill,innerRadius,outerRadius){if(!(!isGradientFill(fill)||fill.bounds==="item"))return{centerX:0,centerY:0,innerRadius,outerRadius}}getSectorFormat(datum,datumIndex,highlighted){const{angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fills,strokes,defaultColorRange,defaultPatternFills,itemStyler}=this.properties,defaultStroke=strokes[datumIndex%strokes.length],{fill,fillOpacity,stroke:stroke2,strokeWidth,strokeOpacity,lineDash,lineDashOffset,cornerRadius}=mergeDefaults(highlighted&&this.properties.highlightStyle.item,{fill:fills.length>0?fills[datumIndex%fills.length]:void 0,stroke:defaultStroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()},this.properties),defaultColors=defaultColorRange[datumIndex%defaultColorRange.length],defaultPatternFill=defaultPatternFills[datumIndex%defaultPatternFills.length],sectorFill=fill??"black";let format;return itemStyler&&(format=this.cachedDatumCallback(this.getDatumId(datum,datumIndex)+(highlighted?"-highlight":"-hide"),()=>this.callWithContext(itemStyler,{datum,angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey,fill:this.getNodeFill(sectorFill,defaultColors,defaultPatternFill),strokeOpacity,stroke:stroke2,strokeWidth,fillOpacity,lineDash,lineDashOffset,cornerRadius,highlighted,seriesId:this.id}))),{fill:this.getNodeFill((format==null?void 0:format.fill)??sectorFill,defaultColors,defaultPatternFill),fillOpacity:(format==null?void 0:format.fillOpacity)??fillOpacity,stroke:(format==null?void 0:format.stroke)??stroke2,strokeWidth:(format==null?void 0:format.strokeWidth)??strokeWidth,strokeOpacity:(format==null?void 0:format.strokeOpacity)??strokeOpacity,lineDash:(format==null?void 0:format.lineDash)??lineDash,lineDashOffset:(format==null?void 0:format.lineDashOffset)??lineDashOffset,cornerRadius:(format==null?void 0:format.cornerRadius)??cornerRadius}}getOuterRadius(){return Math.max(this.radius*this.properties.outerRadiusRatio+this.properties.outerRadiusOffset,0)}updateRadiusScale(resize){var _a294;const newRange=[0,this.getOuterRadius()];this.radiusScale.range=newRange,resize&&(this.previousRadiusScale.range=newRange);const setRadii=__name(d=>({...d,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(d.radius),0)}),"setRadii");this.nodeData=this.nodeData.map(setRadii),this.phantomNodeData=(_a294=this.phantomNodeData)==null?void 0:_a294.map(setRadii)}getTitleTranslationY(){var _a294;const outerRadius=Math.max(0,this.radiusScale.range[1]);if(outerRadius===0)return NaN;const titleOffset=2+(((_a294=this.properties.title)==null?void 0:_a294.spacing)??0),dy=Math.max(0,-outerRadius);return-outerRadius-titleOffset-dy}update({seriesRect}){const{title}=this.properties,newNodeDataDependencies={seriesRectWidth:seriesRect==null?void 0:seriesRect.width,seriesRectHeight:seriesRect==null?void 0:seriesRect.height},resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;if(resize&&(this._nodeDataDependencies=newNodeDataDependencies),this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(resize),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),title){const dy=this.getTitleTranslationY();title.node.y=isFinite(dy)?dy:0;const titleBox=title.node.getBBox();title.node.visible=title.enabled&&isFinite(dy)&&!this.bboxIntersectsSurroundingSeries(titleBox)}this.zerosumOuterRing.fillOpacity=0,this.zerosumOuterRing.stroke=this.properties.calloutLabel.color,this.zerosumOuterRing.strokeWidth=1,this.zerosumOuterRing.strokeOpacity=1,this.updateNodeMidPoint(),this.updateSelections(),this.updateNodes(seriesRect)}updateTitleNodes(){var _a294,_b;const{oldTitle}=this,{title}=this.properties;oldTitle!==title&&(oldTitle&&((_a294=this.labelGroup)==null||_a294.removeChild(oldTitle.node)),title&&(title.node.textBaseline="bottom",(_b=this.labelGroup)==null||_b.appendChild(title.node)),this.oldTitle=title)}updateNodeMidPoint(){var _a294;const setMidPoint=__name(d=>{const radius=d.innerRadius+(d.outerRadius-d.innerRadius)/2;d.midPoint={x:d.midCos*Math.max(0,radius),y:d.midSin*Math.max(0,radius)}},"setMidPoint");this.nodeData.forEach(setMidPoint),(_a294=this.phantomNodeData)==null||_a294.forEach(setMidPoint)}updateSelections(){const{itemSelection,highlightSelection,phantomSelection,highlightLabelSelection,calloutLabelSelection,labelSelection}=this,highlightedNodeData=this.nodeData.map(datum=>({...datum,sectorFormat:{...datum.sectorFormat}})),update=__name((selection,nodeData)=>{selection.update(nodeData,void 0,datum=>this.getDatumId(datum.datum,datum.datumIndex)),this.ctx.animationManager.isSkipped()&&selection.cleanup()},"update");update(itemSelection,this.nodeData),update(highlightSelection,highlightedNodeData),update(phantomSelection,this.phantomNodeData??[]),calloutLabelSelection.update(this.calloutNodeData,group=>{const line=new Line;line.tag=0,line.pointerEvents=1,group.appendChild(line);const text2=new Text;text2.tag=1,text2.pointerEvents=1,group.appendChild(text2)}),labelSelection.update(this.nodeData),highlightLabelSelection.update(highlightedNodeData)}updateNodes(seriesRect){const highlightedDatum=this.ctx.highlightManager.getActiveHighlight(),{visible}=this;this.backgroundGroup.visible=visible,this.contentGroup.visible=visible,this.highlightGroup.visible=visible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.highlightLabel.visible=visible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.labelGroup&&(this.labelGroup.visible=visible),this.contentGroup.opacity=this.getOpacity();const innerRadius=this.radiusScale.range[0],outerRadius=this.radiusScale.range[1],fillBBox=this.getShapeFillBBox(),animationDisabled=this.ctx.animationManager.isSkipped(),updateSectorFn=__name((sector,datum,_index,isDatumHighlighted)=>{const format=this.getSectorFormat(datum.datum,datum.itemId,isDatumHighlighted);datum.sectorFormat.fill=format.fill,datum.sectorFormat.stroke=format.stroke,animationDisabled&&(sector.startAngle=datum.startAngle,sector.endAngle=datum.endAngle,sector.innerRadius=datum.innerRadius,sector.outerRadius=datum.outerRadius),(isDatumHighlighted||animationDisabled)&&(sector.fill=format.fill,sector.stroke=format.stroke);const fillParams=this.getFillParams(format.fill,innerRadius,outerRadius);applyShapeFillBBox(sector,format.fill,fillBBox,fillParams),sector.strokeWidth=format.strokeWidth,sector.fillOpacity=format.fillOpacity,sector.strokeOpacity=format.strokeOpacity,sector.lineDash=format.lineDash,sector.lineDashOffset=format.lineDashOffset,sector.cornerRadius=format.cornerRadius,sector.fillShadow=this.properties.shadow;const inset=Math.max((this.properties.sectorSpacing+(format.stroke!=null?format.strokeWidth:0))/2,0);sector.inset=inset,sector.lineJoin=this.properties.sectorSpacing>=0||inset>0?"miter":"round"},"updateSectorFn");this.itemSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.highlightSelection.each((node,datum,index)=>{updateSectorFn(node,datum,index,!0),node.visible=datum.itemId===(highlightedDatum==null?void 0:highlightedDatum.itemId)}),this.phantomSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(seriesRect),this.updateSectorLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{calloutLine:{length:calloutLength,strokeWidth,colors},strokes}=this.properties,calloutStrokeWidth=strokeWidth,calloutColors=isStringFillArray(colors)?colors:strokes,{offset:offset4}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(0).forEach((line,index)=>{const datum=line.closestDatum(),{calloutLabel:label,outerRadius}=datum;if(label!=null&&label.text&&!label.hidden&&outerRadius!==0){line.visible=!0,line.strokeWidth=calloutStrokeWidth,line.stroke=calloutColors[index%calloutColors.length],line.fill=void 0;const x1=datum.midCos*outerRadius,y1=datum.midSin*outerRadius;let x2=datum.midCos*(outerRadius+calloutLength),y2=datum.midSin*(outerRadius+calloutLength);if((label.collisionTextAlign??label.collisionOffsetY!==0)&&label.box!=null){const box=label.box;let cx=x2,cy=y2;x2<box.x?cx=box.x:x2>box.x+box.width&&(cx=box.x+box.width),y2<box.y?cy=box.y:y2>box.y+box.height&&(cy=box.y+box.height);const dx=cx-x2,dy=cy-y2,length2=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),paddedLength=length2-offset4;paddedLength>0&&(x2=x2+dx*paddedLength/length2,y2=y2+dy*paddedLength/length2)}line.x1=x1,line.y1=y1,line.x2=x2,line.y2=y2}else line.visible=!1})}getLabelOverflow(text2,box,seriesRect){const seriesLeft=-this.centerX,seriesRight=seriesLeft+seriesRect.width,seriesTop=-this.centerY,seriesBottom=seriesTop+seriesRect.height,errPx=1;let visibleTextPart=1;box.x+errPx<seriesLeft?visibleTextPart=(box.x+box.width-seriesLeft)/box.width:box.x+box.width-errPx>seriesRight&&(visibleTextPart=(seriesRight-box.x)/box.width);const hasVerticalOverflow=box.y+errPx<seriesTop||box.y+box.height-errPx>seriesBottom,textLength=visibleTextPart===1?text2.length:Math.floor(text2.length*visibleTextPart)-1,hasSurroundingSeriesOverflow=this.bboxIntersectsSurroundingSeries(box);return{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}}bboxIntersectsSurroundingSeries(box){const{surroundingRadius}=this;if(surroundingRadius==null)return!1;const corners=[{x:box.x,y:box.y},{x:box.x+box.width,y:box.y},{x:box.x+box.width,y:box.y+box.height},{x:box.x,y:box.y+box.height}],sur2=surroundingRadius**2;return corners.some(corner=>corner.x**2+corner.y**2>sur2)}computeCalloutLabelCollisionOffsets(){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,{offset:offset4,minSpacing}=calloutLabel,innerRadius=radiusScale.convert(0),shouldSkip=__name(datum=>!datum.calloutLabel||datum.outerRadius===0,"shouldSkip"),fullData=this.calloutNodeData,data=fullData.filter(t=>!shouldSkip(t));if(data.forEach(datum=>{const label=datum.calloutLabel;label!=null&&(label.hidden=!1,label.collisionTextAlign=void 0,label.collisionOffsetY=0)}),data.length<=1)return;const leftLabels=data.filter(d=>d.midCos<0).sort((a,b)=>a.midSin-b.midSin),rightLabels=data.filter(d=>d.midCos>=0).sort((a,b)=>a.midSin-b.midSin),topLabels=data.filter(d=>{var _a294;return d.midSin<0&&((_a294=d.calloutLabel)==null?void 0:_a294.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),bottomLabels=data.filter(d=>{var _a294;return d.midSin>=0&&((_a294=d.calloutLabel)==null?void 0:_a294.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),getTextBBox=__name(datum=>{const label=datum.calloutLabel;if(label==null)return BBox.zero.clone();const labelRadius=datum.outerRadius+calloutLine.length+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,textAlign=label.collisionTextAlign??label.textAlign,textBaseline=label.textBaseline;return Text.computeBBox(label.text,x,y,{font:this.properties.calloutLabel,textAlign,textBaseline})},"getTextBBox"),avoidNeighbourYCollision=__name((label,next,direction)=>{const box=getTextBBox(label).grow(minSpacing/2),other=getTextBBox(next).grow(minSpacing/2);box.x<other.x+other.width&&box.x+box.width>other.x&&(direction==="to-top"?box.y<other.y+other.height:box.y+box.height>other.y)&&(next.calloutLabel.collisionOffsetY=direction==="to-top"?box.y-other.y-other.height:box.y+box.height-other.y)},"avoidNeighbourYCollision"),avoidYCollisions=__name(labels=>{const midLabel=labels.slice().sort((a,b)=>Math.abs(a.midSin)-Math.abs(b.midSin))[0],midIndex=labels.indexOf(midLabel);for(let i=midIndex-1;i>=0;i--){const prev=labels[i+1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-top")}for(let i=midIndex+1;i<labels.length;i++){const prev=labels[i-1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-bottom")}},"avoidYCollisions"),avoidXCollisions=__name(labels=>{const labelsCollideLabelsByY=data.some(datum=>datum.calloutLabel.collisionOffsetY!==0),boxes=labels.map(label=>getTextBBox(label)),paddedBoxes=boxes.map(box=>box.clone().grow(minSpacing/2));let labelsCollideLabelsByX=!1;for(let i=0;i<paddedBoxes.length&&!labelsCollideLabelsByX;i++){const box=paddedBoxes[i];for(let j=i+1;j<labels.length;j++){const other=paddedBoxes[j];if(box.collidesBBox(other)){labelsCollideLabelsByX=!0;break}}}const sectors=fullData.map(datum=>{const{startAngle,endAngle,outerRadius}=datum;return{startAngle,endAngle,innerRadius,outerRadius}}),labelsCollideSectors=boxes.some(box=>sectors.some(sector=>boxCollidesSector(box,sector)));!labelsCollideLabelsByX&&!labelsCollideLabelsByY&&!labelsCollideSectors||labels.filter(d=>d.calloutLabel.textAlign==="center").forEach(d=>{const label=d.calloutLabel;d.midCos<0?label.collisionTextAlign="right":d.midCos>0?label.collisionTextAlign="left":label.collisionTextAlign="center"})},"avoidXCollisions");avoidYCollisions(leftLabels),avoidYCollisions(rightLabels),avoidXCollisions(topLabels),avoidXCollisions(bottomLabels)}updateCalloutLabelNodes(seriesRect){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,color:color6}=calloutLabel,tempTextNode=new Text;this.calloutLabelSelection.selectByTag(1).forEach(text2=>{const datum=text2.closestDatum(),label=datum.calloutLabel,radius=radiusScale.convert(datum.radius),outerRadius=Math.max(0,radius);if(!(label!=null&&label.text)||outerRadius===0||label.hidden){text2.visible=!1;return}const labelRadius=outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,align2={textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline};tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign(align2);const box=tempTextNode.getBBox();let displayText=label.text,visible=!0;if(calloutLabel.avoidCollisions){const{textLength,hasVerticalOverflow}=this.getLabelOverflow(label.text,box,seriesRect);displayText=label.text.length===textLength?label.text:`${label.text.substring(0,textLength)}`,visible=!hasVerticalOverflow}text2.text=displayText,text2.x=x,text2.y=y,text2.setFont(this.properties.calloutLabel),text2.setAlign(align2),text2.fill=color6,text2.visible=visible})}computeLabelsBBox(options,seriesRect){const{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,maxCollisionOffset,minSpacing}=calloutLabel;if(!calloutLabel.avoidCollisions)return null;this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const textBoxes=[],text2=new Text;let titleBox;const{title}=this.properties;if(title!=null&&title.text&&title.enabled){const dy=this.getTitleTranslationY();isFinite(dy)&&(text2.text=title.text,text2.x=0,text2.y=dy,text2.setFont(title),text2.setAlign({textBaseline:"bottom",textAlign:"center"}),titleBox=text2.getBBox(),textBoxes.push(titleBox))}return this.calloutNodeData.forEach(datum=>{const label=datum.calloutLabel;if(!label||datum.outerRadius===0)return null;const labelRadius=datum.outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;text2.text=label.text,text2.x=x,text2.y=y,text2.setFont(this.properties.calloutLabel),text2.setAlign({textAlign:label.collisionTextAlign??label.textAlign,textBaseline:label.textBaseline});const box=text2.getBBox();if(label.box=box,Math.abs(label.collisionOffsetY)>maxCollisionOffset){label.hidden=!0;return}if(titleBox){const seriesTop=-this.centerY,titleCleanArea=new BBox(titleBox.x-minSpacing,seriesTop,titleBox.width+2*minSpacing,titleBox.y+titleBox.height+minSpacing-seriesTop);if(box.collidesBBox(titleCleanArea)){label.hidden=!0;return}}if(options.hideWhenNecessary){const{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}=this.getLabelOverflow(label.text,box,seriesRect),isTooShort=label.text.length>2&&textLength<2;if(hasVerticalOverflow||isTooShort||hasSurroundingSeriesOverflow){label.hidden=!0;return}}label.hidden=!1,textBoxes.push(box)}),textBoxes.length===0?null:BBox.merge(textBoxes)}updateSectorLabelNodes(){var _a294;const{radiusScale}=this,innerRadius=radiusScale.convert(0),{fontSize,fontStyle,fontWeight,fontFamily,positionOffset,positionRatio,color:color6}=this.properties.sectorLabel,isDonut=innerRadius>0,singleVisibleSector=((_a294=this.ctx.legendManager.getData(this.id))==null?void 0:_a294.filter(d=>d.enabled).length)===1,updateSectorLabel=__name((text2,datum)=>{const{sectorLabel,outerRadius,startAngle,endAngle}=datum;let isTextVisible=!1;if(sectorLabel&&outerRadius!==0){const labelRadius=innerRadius*(1-positionRatio)+outerRadius*positionRatio+positionOffset;text2.fill=color6,text2.fontStyle=fontStyle,text2.fontWeight=fontWeight,text2.fontSize=fontSize,text2.fontFamily=fontFamily,text2.text=sectorLabel.text,!isDonut&&singleVisibleSector?(text2.x=0,text2.y=0):(text2.x=datum.midCos*labelRadius,text2.y=datum.midSin*labelRadius),text2.textAlign="center",text2.textBaseline="middle";const bbox=text2.getBBox(),corners=[[bbox.x,bbox.y],[bbox.x+bbox.width,bbox.y],[bbox.x+bbox.width,bbox.y+bbox.height],[bbox.x,bbox.y+bbox.height]],sectorBounds={startAngle,endAngle,innerRadius,outerRadius};corners.every(([x,y])=>isPointInSector(x,y,sectorBounds))&&(isTextVisible=!0)}text2.visible=isTextVisible},"updateSectorLabel");this.labelSelection.each(updateSectorLabel),this.highlightLabelSelection.each(updateSectorLabel)}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2}pickNodeClosestDatum(point){return pickByMatchingAngle(this,point)}getTooltipContent(datumIndex){var _a294;const{id:seriesId,dataModel,processedData,properties}=this,{legendItemKey,calloutLabelKey,calloutLabelName,sectorLabelKey,sectorLabelName,angleKey,angleName,radiusKey,radiusName,tooltip}=properties,title=this.properties.title.text;if(!dataModel||!processedData)return;const datum=(_a294=processedData.dataSources.get(this.id))==null?void 0:_a294[datumIndex],{angleRawValues,legendItemValues,calloutLabelValues,sectorLabelValues}=this.getProcessedDataValues(dataModel,processedData),angleRawValue=angleRawValues[datumIndex],label=(legendItemValues==null?void 0:legendItemValues[datumIndex])??(calloutLabelKey===angleKey||calloutLabelValues==null?void 0:calloutLabelValues[datumIndex])??(sectorLabelKey===angleKey||sectorLabelValues==null?void 0:sectorLabelValues[datumIndex])??angleName;return tooltip.formatTooltip(this.properties,{title,symbol:this.legendItemSymbol(datumIndex),data:[{label,fallbackLabel:angleKey,value:formatValue(angleRawValue,3)}]},{seriesId,datum,title:angleName,legendItemKey,calloutLabelKey,calloutLabelName,sectorLabelKey,sectorLabelName,angleKey,angleName,radiusKey,radiusName,...this.getSectorFormat(datum,datumIndex,!1)})}legendItemSymbol(datumIndex){var _a294,_b;const datum=(_b=(_a294=this.processedData)==null?void 0:_a294.dataSources.get(this.id))==null?void 0:_b[datumIndex],sectorFormat=this.getSectorFormat(datum,datumIndex,!1),{fillOpacity,strokeOpacity,strokeWidth,lineDash,lineDashOffset}=this.properties;let{fill}=sectorFormat;const{stroke:stroke2}=sectorFormat;return isGradientFill(fill)&&(fill={...fill,gradient:"linear",rotation:0,reverse:!1}),{marker:{fill,stroke:stroke2,fillOpacity,strokeOpacity,strokeWidth,lineDash,lineDashOffset}}}getLegendData(legendType){var _a294,_b,_c,_d,_e,_f;const{id:seriesId,visible,processedData,dataModel,ctx:{legendManager}}=this;if(!dataModel||!processedData||legendType!=="category")return[];const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey,showInLegend}=this.properties;if(!legendItemKey&&(!calloutLabelKey||calloutLabelKey===angleKey)&&(!sectorLabelKey||sectorLabelKey===angleKey))return[];const{calloutLabelValues,sectorLabelValues,legendItemValues,angleRawValues}=this.getProcessedDataValues(dataModel,processedData),titleText=((_a294=this.properties.title)==null?void 0:_a294.showInLegend)&&this.properties.title.text,legendData=[],hideZeros=this.properties.hideZeroValueSectorsInLegend,rawData=processedData.dataSources.get(this.id),invalidData=(_b=processedData.invalidData)==null?void 0:_b.get(this.id);for(let datumIndex=0;datumIndex<processedData.input.count;datumIndex++){const datum=rawData==null?void 0:rawData[datumIndex],angleRawValue=angleRawValues[datumIndex];if((invalidData==null?void 0:invalidData[datumIndex])===!0||hideZeros&&angleRawValue===0)continue;const labelParts=[];titleText&&labelParts.push(titleText);const labels=this.getLabels(datum,2*Math.PI,2*Math.PI,!1,calloutLabelValues==null?void 0:calloutLabelValues[datumIndex],sectorLabelValues==null?void 0:sectorLabelValues[datumIndex],legendItemValues==null?void 0:legendItemValues[datumIndex]);legendItemKey&&labels.legendItem!==void 0?labelParts.push(labels.legendItem.text):calloutLabelKey&&calloutLabelKey!==angleKey&&((_c=labels.calloutLabel)==null?void 0:_c.text)!==void 0?labelParts.push((_d=labels.calloutLabel)==null?void 0:_d.text):sectorLabelKey&&sectorLabelKey!==angleKey&&((_e=labels.sectorLabel)==null?void 0:_e.text)!==void 0&&labelParts.push((_f=labels.sectorLabel)==null?void 0:_f.text),labelParts.length!==0&&legendData.push({legendType:"category",id:seriesId,datum,itemId:datumIndex,seriesId,enabled:visible&&legendManager.getItemEnabled({seriesId,itemId:datumIndex}),label:{text:labelParts.join(" - ")},symbol:this.legendItemSymbol(datumIndex),legendItemName:legendItemKey!=null?datum[legendItemKey]:void 0,hideInLegend:!showInLegend})}return legendData}setLegendState(enabledItems){const{id:seriesId,ctx:{legendManager,updateService}}=this;enabledItems.forEach((enabled,itemId)=>legendManager.toggleItem(enabled,seriesId,itemId)),legendManager.update(),updateService.update(4)}animateEmptyUpdateReady(_data){const{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[this.itemSelection,this.highlightSelection,this.phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum.datum,datum.datumIndex)),seriesLabelFadeInAnimation(this,"callout",animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var _a294,_b,_c,_d;const{itemSelection,highlightSelection,phantomSelection,processedData,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,dataDiff=(_b=(_a294=processedData==null?void 0:processedData.reduced)==null?void 0:_a294.diff)==null?void 0:_b[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const supportedDiff=((dataDiff==null?void 0:dataDiff.moved.size)??0)===0,hasKeys=((processedData==null?void 0:processedData.defs.keys.length)??0)>0,hasUniqueKeys=((_d=(_c=processedData==null?void 0:processedData.reduced)==null?void 0:_c.animationValidation)==null?void 0:_d.uniqueKeys)??!0;(!supportedDiff||!hasKeys||!hasUniqueKeys)&&this.ctx.animationManager.skipCurrentBatch();const fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum.datum,datum.datumIndex),dataDiff),seriesLabelFadeInAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeInAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeInAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection,highlightSelection,phantomSelection,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection,phantomSelection],fns.nodes,(_,datum)=>this.getDatumId(datum.datum,datum.datumIndex)),seriesLabelFadeOutAnimation(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),seriesLabelFadeOutAnimation(this,"sector",this.ctx.animationManager,this.labelSelection),seriesLabelFadeOutAnimation(this,"highlight",this.ctx.animationManager,this.highlightLabelSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumId(datum,datumIndex){var _a294,_b,_c;const{calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;return(_c=(_b=(_a294=this.processedData)==null?void 0:_a294.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys?legendItemKey?createDatumId(datum[legendItemKey]):calloutLabelKey?createDatumId(datum[calloutLabelKey]):sectorLabelKey?createDatumId(datum[sectorLabelKey]):`${datumIndex}`:`${datumIndex}`}},__name(_a253,"PieSeries"),_a253);PieSeries.className="PieSeries";PieSeries.type="pie";var pieTheme={series:{title:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.1666666666666667]},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},spacing:5},calloutLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},offset:3,minAngle:.001},sectorLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"backgroundColor"},positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2,colors:{$map:[{$if:[{$or:[{$isGradient:[{$value:"$1"}]},{$isPattern:[{$value:"$1"}]}]},{$path:["../../strokes/$index",{$ref:"foregroundColor"}]},{$value:"$1"}]},{$if:[{$eq:[{$path:"../strokeWidth"},0]},{$path:"../fills"},{$path:"../strokes"}]}]}},fills:{$palette:"fills"},strokes:{$palette:"strokes"},defaultColorRange:{$palette:"gradients"},defaultPatternFills:SAFE_FILLS_OPERATION,fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5}},legend:{enabled:!0}},PieSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"pie",moduleFactory:__name(ctx=>new PieSeries(ctx),"moduleFactory"),tooltipDefaults:{range:"exact"},themeTemplate:pieTheme},NewPieSeriesModule={type:"series",name:"pie",chartType:"polar",options:pieSeriesOptionsDef,create:__name(ctx=>new PieSeries(ctx),"create")};function registerInbuiltModules(){moduleRegistry.register(BackgroundModule,CommunityLegendModule,LocaleModule,AreaSeriesModule,BarSeriesModule,BubbleSeriesModule,LineSeriesModule,ScatterSeriesModule,DonutSeriesModule,PieSeriesModule,HistogramSeriesModule);for(const AxisConstructor of[NumberAxis,CategoryAxis,TimeAxis,GroupedCategoryAxis,LogAxis])axisRegistry.register(AxisConstructor.type,{moduleFactory:__name(ctx=>new AxisConstructor(ctx),"moduleFactory")})}__name(registerInbuiltModules,"registerInbuiltModules");function setupModules(){for(const m of moduleRegistry.modules){if(m.packageType==="enterprise"&&!verifyIfModuleExpected(m)&&logger_exports.errorOnce("Unexpected enterprise module registered: "+m.identifier),m.type==="root"&&m.themeTemplate)for(const chartType of m.chartTypes)chartDefaults.set(chartType,m.themeTemplate);if(m.type==="series"){if(m.chartTypes.length>1)throw new Error(`AG Charts - Module definition error: ${m.identifier}`);seriesRegistry.register(m.identifier,m)}if(m.type==="series-option"&&m.themeTemplate)for(const seriesType of m.seriesTypes)seriesRegistry.setThemeTemplate(seriesType,m.themeTemplate);if(m.type==="axis-option"&&m.themeTemplate)for(const axisType of m.axisTypes){const axisTypeTheme=axisRegistry.getThemeTemplate(axisType),theme=mergeDefaults(m.themeTemplate,axisTypeTheme);axisRegistry.setThemeTemplate(axisType,theme)}m.type==="axis"&&axisRegistry.register(m.identifier,m),m.type==="legend"&&legendRegistry.register(m.identifier,m)}if(moduleRegistry.hasEnterpriseModules()){const expectedButUnused=getUnusedExpectedModules();expectedButUnused.length>0&&logger_exports.errorOnce("Enterprise modules expected but not registered: ",expectedButUnused)}}__name(setupModules,"setupModules");var directions=["top","right","bottom","left"],_a254,_CartesianChart=(_a254=class extends Chart{constructor(options,resources){super(options,resources),this.paired=!0,this.lastUpdateClipRect=void 0,this.lastLayoutWidth=NaN,this.lastLayoutHeight=NaN}onAxisChange(newValue,oldValue){super.onAxisChange(newValue,oldValue),this.ctx!=null&&this.ctx.zoomManager.updateAxes(newValue)}destroySeries(series){super.destroySeries(series),this.lastLayoutWidth=NaN,this.lastLayoutHeight=NaN}getChartType(){return"cartesian"}setRootClipRects(clipRect){const{seriesRoot,annotationRoot}=this;seriesRoot.setClipRect(clipRect),annotationRoot.setClipRect(clipRect)}async processData(){await super.processData();for(const axis of this.axes){const syncedDomain=this.getSyncedDomain(axis);syncedDomain!=null&&axis.setDomains(syncedDomain)}this.ctx.updateService.dispatchProcessData({series:{shouldFlipXY:this.shouldFlipXY()}})}performLayout(ctx){const{seriesRoot,annotationRoot}=this,{clipSeries,seriesRect,visible}=this.updateAxes(ctx.layoutBox);this.seriesRoot.visible=visible,this.seriesRect=seriesRect,this.animationRect=ctx.layoutBox;const{x,y}=seriesRect;if(ctx.width!==this.lastLayoutWidth||ctx.height!==this.lastLayoutHeight)for(const group of[seriesRoot,annotationRoot])group.translationX=Math.floor(x),group.translationY=Math.floor(y);else{const{translationX,translationY}=seriesRoot;staticFromToMotion(this.id,"seriesRect",this.ctx.animationManager,[seriesRoot,annotationRoot],{translationX,translationY},{translationX:Math.floor(x),translationY:Math.floor(y)},{phase:"update"})}this.lastLayoutWidth=ctx.width,this.lastLayoutHeight=ctx.height;const seriesPaddedRect=seriesRect.clone().grow(this.seriesArea.padding),clipRect=this.seriesArea.clip||clipSeries?seriesPaddedRect:void 0,{lastUpdateClipRect}=this;this.lastUpdateClipRect=clipRect,this.ctx.animationManager.isActive()&&lastUpdateClipRect!=null?this.ctx.animationManager.animate({id:this.id,groupId:"clip-rect",phase:"update",from:lastUpdateClipRect,to:seriesPaddedRect,onUpdate:__name(interpolatedClipRect=>this.setRootClipRects(interpolatedClipRect),"onUpdate"),onComplete:__name(()=>this.setRootClipRects(clipRect),"onComplete")}):this.setRootClipRects(clipRect),this.ctx.layoutManager.emitLayoutComplete(ctx,{axes:this.axes.map(axis=>axis.getLayoutState()),series:{visible,rect:seriesRect,paddedRect:seriesPaddedRect},clipSeries})}updateAxes(layoutBox){const{clipSeries,seriesRect,overflows}=this.resolveAxesLayout(layoutBox);for(const axis of this.axes)axis.update(),axis.setCrossLinesVisible(!overflows),this.clipAxis(axis,seriesRect,layoutBox);return{clipSeries,seriesRect,visible:!overflows}}resolveAxesLayout(layoutBox){let newState,prevState,iterations=0;const maxIterations=10;do if(prevState=newState??this.getDefaultState(),newState=this.updateAxesPass(new Map(prevState.axisAreaWidths),layoutBox.clone()),iterations++>maxIterations){logger_exports.warn("Max iterations reached. Unable to stabilize axes layout.");break}while(!this.isLayoutStable(newState,prevState));return this.lastAreaWidths=newState.axisAreaWidths,newState}updateAxesPass(axisAreaWidths,axisAreaBound){const axisWidths=new Map,primaryTickCounts={};let overflows=!1,clipSeries=!1;for(const dir of directions){const padding=this.seriesArea.padding[dir],axis=this.axes.findLast(a=>a.position===dir);axis?axis.seriesAreaPadding=padding:axisAreaBound.shrink(padding,dir)}const totalWidth=(axisAreaWidths.get("left")??0)+(axisAreaWidths.get("right")??0),totalHeight=(axisAreaWidths.get("top")??0)+(axisAreaWidths.get("bottom")??0),crossLinePadding=this.buildCrossLinePadding(axisAreaWidths);axisAreaBound.width<=totalWidth+crossLinePadding.hPadding||axisAreaBound.height<=totalHeight+crossLinePadding.vPadding?overflows=!0:axisAreaBound.shrink(crossLinePadding);const seriesRect=axisAreaBound.clone().shrink(Object.fromEntries(axisAreaWidths));for(const axis of this.axes){const{position="left",direction}=axis;this.sizeAxis(axis,seriesRect,position);const isVertical=direction==="y",{primaryTickCount,bbox}=axis.calculateLayout(axis.nice?primaryTickCounts[direction]:void 0);primaryTickCounts[direction]??(primaryTickCounts[direction]=primaryTickCount),clipSeries||(clipSeries=axis.dataDomain.clipped||axis.visibleRange[0]>0||axis.visibleRange[1]<1),axisWidths.set(axis.id,Math.ceil(axis.thickness??(isVertical?bbox==null?void 0:bbox.width:bbox==null?void 0:bbox.height)??0))}const axisGroups=groupBy(this.axes,axis=>axis.position??"left"),{width:width2,height:height2,pixelRatio}=this.ctx.scene,newAxisAreaWidths=new Map,axisOffsets=new Map;for(const[position,axes]of entries(axisGroups)){let currentOffset=position==="left"||position==="right"?height2%pixelRatio:width2%pixelRatio,totalAxisWidth=0;for(const axis of axes??[]){axisOffsets.set(axis.id,currentOffset);const axisThickness=axisWidths.get(axis.id)??0;totalAxisWidth=Math.max(totalAxisWidth,currentOffset+axisThickness),axis.layoutConstraints.stacked&&(currentOffset+=axisThickness+_a254.AxesPadding)}newAxisAreaWidths.set(position,Math.ceil(totalAxisWidth))}for(const[position,axes]of entries(axisGroups))this.positionAxes({axes:axes??[],position,axisWidths,axisOffsets,axisAreaWidths:newAxisAreaWidths,axisBound:axisAreaBound,seriesRect});return{clipSeries,seriesRect,axisAreaWidths:newAxisAreaWidths,overflows}}buildCrossLinePadding(axisAreaSize){const crossLinePadding={top:0,right:0,bottom:0,left:0,hPadding:0,vPadding:0};this.axes.forEach(axis=>{var _a294;(_a294=axis.crossLines)==null||_a294.forEach(crossLine=>{var _a295;(_a295=crossLine.calculatePadding)==null||_a295.call(crossLine,crossLinePadding)})});for(const[side,padding=0]of entries(crossLinePadding))crossLinePadding[side]=Math.max(padding-(axisAreaSize.get(side)??0),0);return crossLinePadding.hPadding=crossLinePadding.left+crossLinePadding.right,crossLinePadding.vPadding=crossLinePadding.top+crossLinePadding.bottom,crossLinePadding}clampToOutsideSeriesRect(seriesRect,value,dimension,direction){const bound=dimension==="x"?seriesRect.x:seriesRect.y,size=dimension==="x"?seriesRect.width:seriesRect.height;return direction===1?Math.min(value,bound+size):Math.max(value,bound)}getSyncedDomain(axis){const syncModule=this.modulesManager.getModule("sync");if(!(syncModule!=null&&syncModule.enabled))return;const syncedDomain=syncModule.getSyncedDomain(axis);if(syncedDomain&&axis.dataDomain.domain.length){let shouldUpdate;const{domain}=axis.scale;if(ContinuousScale.is(axis.scale)){const[min,max]=findMinMax(syncedDomain);shouldUpdate=min!==domain[0]||max!==domain[1]}else shouldUpdate=!arraysEqual(syncedDomain,domain);shouldUpdate&&!this.skipSync&&syncModule.updateSiblings()}return syncedDomain}sizeAxis(axis,seriesRect,position){const isCategory=axis instanceof CategoryAxis,isLeftRight=position==="left"||position==="right",{width:width2,height:height2}=seriesRect,maxEnd=isLeftRight?height2:width2;let start2=0,end2=maxEnd,{min,max}=this.ctx.zoomManager.getAxisZoom(axis.id);const{width:axisWidth,unit,align:align2}=axis.layoutConstraints;unit==="px"?end2=start2+axisWidth:end2=end2*axisWidth/100,align2==="end"&&(start2=maxEnd-(end2-start2),end2=maxEnd),isLeftRight&&(isCategory?[min,max]=[1-max,1-min]:[start2,end2]=[end2,start2]),axis.range=[start2,end2],axis.visibleRange=[min,max],axis.gridLength=isLeftRight?width2:height2}positionAxes(opts){const{axes,axisBound,axisWidths,axisOffsets,axisAreaWidths,seriesRect,position}=opts,axisAreaWidth=axisAreaWidths.get(position)??0;let mainDimension="x",minorDimension="y",direction=1;(position==="top"||position==="bottom")&&(mainDimension="y",minorDimension="x");let axisBoundMainOffset=axisBound[mainDimension];(position==="right"||position==="bottom")&&(direction=-1,axisBoundMainOffset+=mainDimension==="x"?axisBound.width:axisBound.height);for(const axis of axes){const minorOffset=axisAreaWidths.get(minorDimension==="x"?"left":"top")??0,axisThickness=axisWidths.get(axis.id)??0,axisOffset=axisOffsets.get(axis.id)??0;axis.gridPadding=axisAreaWidth-axisOffset-axisThickness,axis.translation[minorDimension]=axisBound[minorDimension]+minorOffset,axis.translation[mainDimension]=this.clampToOutsideSeriesRect(seriesRect,axisBoundMainOffset+direction*(axisOffset+axisThickness),mainDimension,direction)}}shouldFlipXY(){return this.series.every(series=>series instanceof CartesianSeries&&series.shouldFlipXY())}getDefaultState(){const axisAreaWidths=new Map;if(this.lastAreaWidths)for(const{position="left"}of this.axes){const areaWidth=this.lastAreaWidths.get(position);areaWidth!=null&&axisAreaWidths.set(position,areaWidth)}return{axisAreaWidths,clipSeries:!1,overflows:!1}}isLayoutStable(newState,prevState){if(prevState.overflows!==newState.overflows||prevState.clipSeries!==newState.clipSeries)return!1;for(const key of newState.axisAreaWidths.keys())if(!prevState.axisAreaWidths.has(key))return!1;for(const[p,w]of prevState.axisAreaWidths.entries()){const otherW=newState.axisAreaWidths.get(p);if((w!=null||otherW!=null)&&w!==otherW)return!1}return!0}clipAxis(axis,seriesRect,layoutBBox){var _a294,_b;const gridLinePadding=Math.ceil(((_a294=axis.gridLine)==null?void 0:_a294.width)??0),axisLinePadding=Math.ceil(((_b=axis.line)==null?void 0:_b.width)??0);let{width:width2,height:height2}=seriesRect;switch(width2+=axis.direction==="x"?gridLinePadding:axisLinePadding,height2+=axis.direction==="y"?gridLinePadding:axisLinePadding,axis.clipGrid(seriesRect.x,seriesRect.y,width2,height2),axis.position){case"left":case"right":axis.clipTickLines(layoutBBox.x,seriesRect.y-gridLinePadding,layoutBBox.width+gridLinePadding,seriesRect.height+gridLinePadding*2);break;case"top":case"bottom":axis.clipTickLines(seriesRect.x-gridLinePadding,layoutBBox.y,seriesRect.width+gridLinePadding*2,layoutBBox.height+gridLinePadding);const{label,labelNodes,scale:scale2}=axis;if(ContinuousScale.is(scale2)&&label.enabled&&label.avoidCollisions&&labelNodes.length>1){const sortedLabels=labelNodes.toSorted((a,b)=>a.translationY-b.translationY),lastLabel=sortedLabels.at(-1),lastLabelBBox=lastLabel.getBBox(),lastLabelInBounds=seriesRect.x+lastLabelBBox.y+lastLabelBBox.height<=layoutBBox.x+layoutBBox.width+this.padding.right;if(lastLabel.visible=lastLabelInBounds,lastLabelInBounds||axis.visibleRange[0]>0||axis.visibleRange[1]<1)sortedLabels[0].visible=!0;else{const firstLabelBBox=sortedLabels[0].getBBox();sortedLabels[0].visible=firstLabelBBox.y>=0}}break}}},__name(_a254,"_CartesianChart"),_a254);_CartesianChart.className="CartesianChart";_CartesianChart.type="cartesian";_CartesianChart.AxesPadding=15;var CartesianChart=_CartesianChart,htmlElement=attachDescription(value=>typeof HTMLElement>"u"||value instanceof HTMLElement,"an html element"),commonChartOptions={mode:union("integrated","standalone"),container:htmlElement,theme:defined,series:array,annotations:defined,navigator:defined,initialState:defined},cartesianChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,axes:defined,data:array},polarChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,axes:defined,data:array},topologyChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,data:array,topology:object},standaloneChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,data:array},hierarchyChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,data:array},flowProportionChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,data:array,nodes:array},gaugeChartOptionsDefs={...commonChartOptionsDefs,...commonChartOptions,data:array},CartesianChartModule={type:"chart",name:"cartesian",options:cartesianChartOptionsDefs,detect:isAgCartesianChartOptions,create(options,resources){return new CartesianChart(options,resources)}},placeholderCreate=__name(()=>{throw new Error("Enterprise module placeholder cannot be initialised")},"placeholderCreate"),FlowProportionChartModule={type:"chart",name:"flow-proportion",placeholder:!0,options:{},detect:isAgFlowProportionChartOptions,create:placeholderCreate},GaugeChartModule={type:"chart",name:"gauge",placeholder:!0,options:{},detect:isAgGaugeChartOptions,create:placeholderCreate},HierarchyChartModule={type:"chart",name:"hierarchy",placeholder:!0,options:{},detect:isAgHierarchyChartOptions,create:placeholderCreate},StandaloneChartModule={type:"chart",name:"standalone",placeholder:!0,options:{},detect:isAgStandaloneChartOptions,create:placeholderCreate},TopologyChartModule={type:"chart",name:"topology",placeholder:!0,options:{},detect:isAgTopologyChartOptions,create:placeholderCreate},_a255,PolarAxis=(_a255=class extends Axis{constructor(){super(...arguments),this.shape="polygon",this.innerRadiusRatio=0,this.defaultTickMinSpacing=20}updatePosition(){super.updatePosition();const selectionCtx=prepareAxisAnimationContext(this),resetAxisFn=resetAxisSelectionFn(selectionCtx);this.axisGroup.setProperties(this.getAxisTransform()),this.gridLineGroupSelection.each(resetAxisFn),this.tickLineGroupSelection.each(resetAxisFn),this.tickLabelGroupSelection.each(resetAxisLabelSelectionFn())}computeLabelsBBox(_options,_seriesRect){return null}computeRange(){}getAxisLinePoints(){}},__name(_a255,"PolarAxis"),_a255);__decorateClass([TempValidate(UNION(["polygon","circle"],"a polar axis shape"))],PolarAxis.prototype,"shape",2);__decorateClass([TempValidate()],PolarAxis.prototype,"innerRadiusRatio",2);var _a256,PolarChart=(_a256=class extends Chart{constructor(options,resources){super(options,resources),this.padding=new Padding(40),this.ctx.axisManager.axisGroup.zIndex=6}getChartType(){return"polar"}async performLayout(ctx){const{layoutBox}=ctx;layoutBox.shrink(this.seriesArea.padding.toJson());const seriesRect=layoutBox.clone();this.seriesRect=seriesRect,this.animationRect=seriesRect,this.seriesRoot.translationX=seriesRect.x,this.seriesRoot.translationY=seriesRect.y,await this.computeCircle(seriesRect),this.axes.forEach(axis=>axis.update()),this.ctx.layoutManager.emitLayoutComplete(ctx,{series:{visible:!0,rect:seriesRect,paddedRect:seriesRect}})}updateAxes(seriesBox,cx,cy,radius){var _a294;const angleAxis=this.axes.find(axis=>axis.direction==="x"),radiusAxis=this.axes.find(axis=>axis.direction==="y");if(!(angleAxis instanceof PolarAxis)||!(radiusAxis instanceof PolarAxis))return;const angleScale=angleAxis.scale,innerRadiusRatio=radiusAxis.innerRadiusRatio;angleAxis.innerRadiusRatio=innerRadiusRatio,angleAxis.computeRange(),angleAxis.gridLength=radius,radiusAxis.gridAngles=(_a294=angleScale.ticks({nice:angleAxis.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0}))==null?void 0:_a294.map(value=>angleScale.convert(value)),radiusAxis.gridRange=angleAxis.range,radiusAxis.range=[radius,radius*innerRadiusRatio],[angleAxis,radiusAxis].forEach(axis=>{axis.translation.x=seriesBox.x+cx,axis.translation.y=seriesBox.y+cy,axis.calculateLayout()})}async computeCircle(seriesBox){const polarSeries=this.series.filter(isPolarSeries),polarAxes=this.axes.filter(isPolarAxis),setSeriesCircle=__name((cx,cy,r)=>{this.updateAxes(seriesBox,cx,cy,r),polarSeries.forEach(series=>{series.centerX=cx,series.centerY=cy,series.radius=r});const pieSeries=polarSeries.filter(s=>s.type==="donut"||s.type==="pie");if(pieSeries.length>1){const innerRadii=pieSeries.map(series=>{const innerRadius=series.getInnerRadius();return{series,innerRadius}}).sort((a,b)=>a.innerRadius-b.innerRadius);innerRadii.at(-1).series.surroundingRadius=void 0;for(let i=0;i<innerRadii.length-1;i++)innerRadii[i].series.surroundingRadius=innerRadii[i+1].innerRadius}},"setSeriesCircle"),centerX=seriesBox.width/2,centerY=seriesBox.height/2,initialRadius=Math.max(0,Math.min(seriesBox.width,seriesBox.height)/2);let radius=initialRadius;setSeriesCircle(centerX,centerY,radius);const shake=__name(async({hideWhenNecessary=!1}={})=>{const labelBoxes=[];for(const series of iterate(polarAxes,polarSeries)){const box=await series.computeLabelsBBox({hideWhenNecessary},seriesBox);box&&labelBoxes.push(box)}if(labelBoxes.length===0){setSeriesCircle(centerX,centerY,initialRadius);return}const labelBox=BBox.merge(labelBoxes),refined=this.refineCircle(labelBox,radius,seriesBox);setSeriesCircle(refined.centerX,refined.centerY,refined.radius),radius=refined.radius},"shake");await shake(),await shake(),await shake(),await shake({hideWhenNecessary:!0}),await shake({hideWhenNecessary:!0});for(const series of iterate(polarAxes,polarSeries))await series.computeLabelsBBox({hideWhenNecessary:!0},seriesBox);return{radius,centerX,centerY}}refineCircle(labelsBox,radius,seriesBox){const circleLeft=-radius,circleTop=-radius,circleRight=radius,circleBottom=radius;let padLeft=Math.max(0,circleLeft-labelsBox.x),padTop=Math.max(0,circleTop-labelsBox.y),padRight=Math.max(0,labelsBox.x+labelsBox.width-circleRight),padBottom=Math.max(0,labelsBox.y+labelsBox.height-circleBottom);padLeft=padRight=Math.max(padLeft,padRight),padTop=padBottom=Math.max(padTop,padBottom);const availCircleWidth=seriesBox.width-padLeft-padRight,availCircleHeight=seriesBox.height-padTop-padBottom;let newRadius=Math.min(availCircleWidth,availCircleHeight)/2;const minHorizontalRadius=.5*seriesBox.width/2,minVerticalRadius=.5*seriesBox.height/2,minRadius=Math.min(minHorizontalRadius,minVerticalRadius);if(newRadius<minRadius){newRadius=minRadius;const horizontalPadding=padLeft+padRight,verticalPadding=padTop+padBottom;if(2*newRadius+verticalPadding>seriesBox.height){const padHeight=seriesBox.height-2*newRadius;Math.min(padTop,padBottom)*2>padHeight?(padTop=padHeight/2,padBottom=padHeight/2):padTop>padBottom?padTop=padHeight-padBottom:padBottom=padHeight-padTop}if(2*newRadius+horizontalPadding>seriesBox.width){const padWidth=seriesBox.width-2*newRadius;Math.min(padLeft,padRight)*2>padWidth?(padLeft=padWidth/2,padRight=padWidth/2):padLeft>padRight?padLeft=padWidth-padRight:padRight=padWidth-padLeft}}const newWidth=padLeft+2*newRadius+padRight,newHeight=padTop+2*newRadius+padBottom;return{centerX:(seriesBox.width-newWidth)/2+padLeft+newRadius,centerY:(seriesBox.height-newHeight)/2+padTop+newRadius,radius:newRadius}}},__name(_a256,"PolarChart"),_a256);PolarChart.className="PolarChart";PolarChart.type="polar";function isPolarSeries(series){return series instanceof PolarSeries}__name(isPolarSeries,"isPolarSeries");function isPolarAxis(axis){return axis instanceof PolarAxis}__name(isPolarAxis,"isPolarAxis");var PolarChartModule={type:"chart",name:"polar",options:polarChartOptionsDefs,detect:isAgPolarChartOptions,create(options,resources){return new PolarChart(options,resources)}},numberAxisOptionsDefs={...cartesianAxisOptionsDefs,...continuousAxisOptions(number),type:required(constant("number")),label:{format:numberFormatValidator,...cartesianAxisLabelOptionsDefs},crosshair:cartesianAxisCrosshairOptions(!0)},logAxisOptionsDefs={...cartesianAxisOptionsDefs,...continuousAxisOptions(number),type:required(constant("log")),base:and(positiveNumberNonZero,attachDescription(value=>value!==1,"not equal to 1")),label:{format:numberFormatValidator,...cartesianAxisLabelOptionsDefs},crosshair:cartesianAxisCrosshairOptions(!0)},timeAxisOptionsDefs={...cartesianAxisOptionsDefs,...continuousAxisOptions(or(number,date),!0),type:required(constant("time")),label:{...cartesianAxisLabelOptionsDefs,format:string},crosshair:cartesianAxisCrosshairOptions(!0)},categoryAxisOptionsDefs={...cartesianAxisOptionsDefs,type:required(constant("category")),label:cartesianAxisLabelOptionsDefs,paddingInner:positiveNumber,paddingOuter:positiveNumber,groupPaddingInner:positiveNumber,crosshair:cartesianAxisCrosshairOptions()},groupedCategoryAxisOptionsDefs={...cartesianAxisOptionsDefs,type:required(constant("grouped-category")),label:cartesianAxisLabelOptionsDefs,crosshair:cartesianAxisCrosshairOptions(),paddingInner:positiveNumber,groupPaddingInner:positiveNumber,depthOptions:arrayOfDefs({label:{enabled:boolean,avoidCollisions:boolean,...fontOptionsDef},tick:{enabled:boolean,stroke:color,width:positiveNumber}},"depth options objects array")},NumberAxisModule={type:"axis",name:"number",chartType:"cartesian",options:numberAxisOptionsDefs,create:__name(ctx=>new NumberAxis(ctx),"create")},LogAxisModule={type:"axis",name:"log",chartType:"cartesian",options:logAxisOptionsDefs,create:__name(ctx=>new LogAxis(ctx),"create")},TimeAxisModule={type:"axis",name:"time",chartType:"cartesian",options:timeAxisOptionsDefs,create:__name(ctx=>new TimeAxis(ctx),"create")},CategoryAxisModule={type:"axis",name:"category",chartType:"cartesian",options:categoryAxisOptionsDefs,create:__name(ctx=>new CategoryAxis(ctx),"create")},GroupedCategoryAxisModule={type:"axis",name:"grouped-category",chartType:"cartesian",options:groupedCategoryAxisOptionsDefs,create:__name(ctx=>new GroupedCategoryAxis(ctx),"create")},AllCartesianCommunityModules=[CartesianChartModule,NumberAxisModule,LogAxisModule,TimeAxisModule,CategoryAxisModule,GroupedCategoryAxisModule,NewAreaSeriesModule,NewBarSeriesModule,NewBubbleSeriesModule,NewHistogramSeriesModule,NewLineSeriesModule,NewScatterSeriesModule],AllPolarCommunityModules=[PolarChartModule,NewDonutSeriesModule,NewPieSeriesModule],AllCommunityModules=[...AllCartesianCommunityModules,...AllPolarCommunityModules,FlowProportionChartModule,GaugeChartModule,HierarchyChartModule,StandaloneChartModule,TopologyChartModule],enterpriseModule={isEnterprise:!1},AgTooltipAnchorToType=(AgTooltipAnchorToType2=>(AgTooltipAnchorToType2.POINTER="pointer",AgTooltipAnchorToType2.NODE="node",AgTooltipAnchorToType2.CHART="chart",AgTooltipAnchorToType2))(AgTooltipAnchorToType||{}),AgTooltipPlacementType=(AgTooltipPlacementType2=>(AgTooltipPlacementType2.TOP="top",AgTooltipPlacementType2.RIGHT="right",AgTooltipPlacementType2.BOTTOM="bottom",AgTooltipPlacementType2.LEFT="left",AgTooltipPlacementType2.TOP_RIGHT="top-right",AgTooltipPlacementType2.BOTTOM_RIGHT="bottom-right",AgTooltipPlacementType2.BOTTOM_LEFT="bottom-left",AgTooltipPlacementType2.TOP_LEFT="top-left",AgTooltipPlacementType2.CENTER="center",AgTooltipPlacementType2))(AgTooltipPlacementType||{}),AgTooltipPositionType=(AgTooltipPositionType2=>(AgTooltipPositionType2.POINTER="pointer",AgTooltipPositionType2.NODE="node",AgTooltipPositionType2.TOP="top",AgTooltipPositionType2.RIGHT="right",AgTooltipPositionType2.BOTTOM="bottom",AgTooltipPositionType2.LEFT="left",AgTooltipPositionType2.TOP_LEFT="top-left",AgTooltipPositionType2.TOP_RIGHT="top-right",AgTooltipPositionType2.BOTTOM_RIGHT="bottom-right",AgTooltipPositionType2.BOTTOM_LEFT="bottom-left",AgTooltipPositionType2))(AgTooltipPositionType||{}),IGNORED_PROP=Symbol("IGNORED_PROP");function pickProps(opts,values){const out={};for(const key of Object.keys(values)){const value=values[key];value!==IGNORED_PROP&&Object.hasOwn(opts,key)&&(out[key]=value)}return out}__name(pickProps,"pickProps");function isRadialGauge(opts){return opts.type==="radial-gauge"}__name(isRadialGauge,"isRadialGauge");function isLinearGauge(opts){return opts.type==="linear-gauge"}__name(isLinearGauge,"isLinearGauge");function tooltipOptions(opts){const{enabled,mode,showArrow,range:range3,position,pagination,delay,wrapping,interaction,renderer,...rest}=opts,seriesTooltipOptions=pickProps(opts,{enabled,showArrow,range:range3,position,interaction,renderer,...rest});return{chartTooltipOptions:pickProps(opts,{enabled:IGNORED_PROP,showArrow:IGNORED_PROP,range:IGNORED_PROP,position:IGNORED_PROP,mode,pagination,delay,wrapping,...rest}),seriesTooltipOptions}}__name(tooltipOptions,"tooltipOptions");function radialGaugeOptions(opts){const{animation,background,container,contextMenu,footnote,height:height2,listeners,locale,minHeight,minWidth,overrideDevicePixelRatio,padding,subtitle,theme,title,width:width2,type,cursor,nodeClickRange,tooltip={},value,scale:scale2={},startAngle,endAngle,highlightStyle,segmentation,bar,needle,targets,outerRadius,innerRadius,outerRadiusRatio,innerRadiusRatio,cornerRadius,cornerMode,label,secondaryLabel,spacing,...rest}=opts,{chartTooltipOptions,seriesTooltipOptions}=tooltipOptions(tooltip),chartOpts=pickProps(opts,{animation,background,container,contextMenu,footnote,height:height2,listeners,locale,minHeight,minWidth,overrideDevicePixelRatio,padding,subtitle,theme,title,tooltip:chartTooltipOptions,width:width2}),seriesOpts=pickProps(opts,{needle:needle!=null?{enabled:!0,...needle}:IGNORED_PROP,startAngle,endAngle,scale:scale2,type,cursor,nodeClickRange,listeners,tooltip:seriesTooltipOptions,value,highlightStyle,segmentation,bar,targets,outerRadius,innerRadius,outerRadiusRatio,innerRadiusRatio,cornerRadius,cornerMode,label,secondaryLabel,spacing,...rest});return{...chartOpts,series:[seriesOpts]}}__name(radialGaugeOptions,"radialGaugeOptions");function linearGaugeOptions(opts){const{animation,background,container,contextMenu,footnote,height:height2,listeners,locale,minHeight,minWidth,overrideDevicePixelRatio,padding,subtitle,theme,title,width:width2,type,cursor,nodeClickRange,tooltip={},value,scale:scale2={},direction="vertical",thickness,highlightStyle,segmentation,bar,targets,cornerRadius,cornerMode,label,...rest}=opts,{chartTooltipOptions,seriesTooltipOptions}=tooltipOptions(tooltip),chartOpts=pickProps(opts,{animation,background,container,contextMenu,footnote,height:height2,listeners,locale,minHeight,minWidth,overrideDevicePixelRatio,padding,subtitle,theme,title,tooltip:chartTooltipOptions,width:width2}),seriesOpts=pickProps(opts,{scale:scale2,type,cursor,nodeClickRange,listeners,tooltip:seriesTooltipOptions,value,direction,thickness,highlightStyle,segmentation,bar,targets,cornerRadius,cornerMode,label,...rest});return{...chartOpts,series:[seriesOpts]}}__name(linearGaugeOptions,"linearGaugeOptions");function applyThemeDefaults(opts,presetTheme){if(presetTheme==null)return opts;const{targets:targetsTheme,...gaugeTheme}=presetTheme;return opts=mergeDefaults(opts,gaugeTheme),opts.targets!=null&&targetsTheme!=null&&(opts.targets=mergeArrayDefaults(opts.targets,targetsTheme)),opts}__name(applyThemeDefaults,"applyThemeDefaults");function gauge(opts,presetTheme){if(isRadialGauge(opts)){const radialGaugeOpts=applyThemeDefaults(opts,presetTheme);return radialGaugeOptions(radialGaugeOpts)}else if(isLinearGauge(opts)){const linearGaugeOpts=applyThemeDefaults(opts,presetTheme);return linearGaugeOptions(linearGaugeOpts)}const{animation,background,container,contextMenu,footnote,height:height2,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,tooltip,width:width2}=opts;return pickProps(opts,{animation,background,container,contextMenu,footnote,height:height2,listeners,locale,minHeight,minWidth,padding,subtitle,theme,title,tooltip,width:width2})}__name(gauge,"gauge");var stroke={stroke:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR},handle={fill:DEFAULT_ANNOTATION_HANDLE_FILL},axisLabel={color:"white",fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR},lineText={color:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR},font={color:DEFAULT_TEXT_ANNOTATION_COLOR,fontSize:{$rem:[1.1666666666666667]},fontFamily:{$ref:"fontFamily"}},text={...font,textAlign:"left"},measurerStatistics={...font,fontSize:{$ref:"fontSize"},color:DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}},measurer={...stroke,background:{fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...handle},text:{...lineText},statistics:{...measurerStatistics}},annotationsTheme={line:{...stroke,handle:{...handle},text:{...lineText}},"horizontal-line":{...stroke,handle:{...handle},axisLabel:{...axisLabel},text:{...lineText}},"vertical-line":{...stroke,handle:{...handle},axisLabel:{...axisLabel},text:{...lineText}},"disjoint-channel":{...stroke,background:{fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...handle},text:{...lineText}},"parallel-channel":{...stroke,background:{fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...handle},text:{...lineText}},"fibonacci-retracement":{...stroke,strokes:DEFAULT_FIBONACCI_STROKES,rangeStroke:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,handle:{...handle},text:{...lineText,position:"center"},label:{...font,color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}}},"fibonacci-retracement-trend-based":{...stroke,strokes:DEFAULT_FIBONACCI_STROKES,rangeStroke:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,handle:{...handle},text:{...lineText,position:"center"},label:{...font,color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}}},callout:{...stroke,...text,color:{$ref:"textColor"},handle:{...handle},fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},comment:{...text,color:"white",fontWeight:700,handle:{...handle},fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR},note:{...text,color:DEFAULT_TEXTBOX_COLOR,fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,stroke:{$ref:"backgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...handle},background:{fill:DEFAULT_TEXTBOX_FILL,stroke:DEFAULT_TEXTBOX_STROKE,strokeWidth:1}},text:{...text,handle:{...handle}},arrow:{...stroke,handle:{...handle},text:{...lineText}},"arrow-up":{fill:PALETTE_UP_FILL,handle:{...handle,stroke:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR}},"arrow-down":{fill:PALETTE_DOWN_FILL,handle:{...handle,stroke:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR}},"date-range":{...measurer},"price-range":{...measurer},"date-price-range":{...measurer},"quick-date-price-range":{up:{...stroke,fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:{...handle},statistics:{...measurerStatistics,color:"#fff",fill:DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...stroke,stroke:DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:{...handle,stroke:DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE},statistics:{...measurerStatistics,color:"#fff",fill:DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{enabled:!0}},chartTypes3=["ohlc","line","step-line","hlc","high-low","candlestick","hollow-candlestick"],toolbarButtons=[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"fibonacci-retracement-drawing",tooltip:"toolbarAnnotationsFibonacciAnnotations",value:"fibonacci-menu"},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"measurer-drawing",tooltip:"toolbarAnnotationsMeasurerAnnotations",value:"measurer-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}];function priceVolume(opts,_presetTheme,getTheme){const{dateKey="date",highKey="high",openKey="open",lowKey="low",closeKey="close",volumeKey="volume",chartType="candlestick",navigator=!1,volume=!0,rangeButtons=!0,statusBar=!0,toolbar=!0,zoom=!0,theme,data,...unusedOpts}=opts,priceSeries=createPriceSeries(chartType,dateKey,highKey,lowKey,openKey,closeKey),volumeSeries=createVolumeSeries(getTheme,openKey,closeKey,volume,volumeKey),navigatorOpts={navigator:{enabled:navigator,...volume?{miniChart:{enabled:navigator,series:[{type:"line",xKey:dateKey,yKey:volumeKey,stroke:SAFE_STROKE_FILL_OPERATION,marker:{enabled:!1}}]},height:40,minHandle:{height:46},maxHandle:{height:46}}:null}},annotationOpts={annotations:{enabled:toolbar,optionsToolbar:{enabled:toolbar},snap:!0,toolbar:{enabled:toolbar,buttons:toolbarButtons,padding:0},data,xKey:dateKey,volumeKey:volume?volumeKey:void 0}},statusBarOpts=statusBar?{statusBar:{enabled:!0,data,highKey,openKey,lowKey,closeKey,volumeKey:volume?volumeKey:void 0}}:null,zoomOpts={zoom:{enabled:zoom,autoScaling:{enabled:!0},enableIndependentAxes:!0}},toolbarOpts={ranges:{enabled:rangeButtons}},volumeAxis=volume?[{type:"number",position:"left",keys:[volumeKey],label:{enabled:!1},crosshair:{enabled:!1},gridLine:{enabled:!1},nice:!1,layoutConstraints:{stacked:!1,width:20,unit:"percent",align:"end"}}]:[];return{theme:{baseTheme:typeof theme=="string"?theme:"ag-financial",...mergeDefaults(typeof theme=="object"?theme:null,{overrides:{common:{title:{padding:4},padding:{top:6,right:8,bottom:5},chartToolbar:{enabled:toolbar},annotations:{...annotationsTheme},axes:{number:{interval:{maxSpacing:45},label:{format:".2f"}}}},bar:{series:{fillOpacity:.5}},line:{series:{marker:{enabled:!1},...inlineSwitch(chartType,{hlc:{stroke:PALETTE_ALT_NEUTRAL_STROKE,strokeWidth:2},line:{stroke:PALETTE_NEUTRAL_STROKE},"step-line":{stroke:PALETTE_NEUTRAL_STROKE,interpolation:{type:"step"}}})}},candlestick:{series:{...inlineSwitch(chartType,{"hollow-candlestick":{item:{up:{fill:"transparent"}}}})}},"range-area":{series:{fillOpacity:.3,strokeWidth:2}}}})},animation:{enabled:!1},legend:{enabled:!1},series:[...volumeSeries,...priceSeries],axes:[{type:"number",position:"right",keys:[openKey,closeKey,highKey,lowKey],crosshair:{enabled:!0,snap:!1},layoutConstraints:{stacked:!1,width:100,unit:"percent",align:"start"}},...volumeAxis,{type:"ordinal-time",position:"bottom",line:{enabled:!1},label:{enabled:!0},crosshair:{enabled:!0}}],tooltip:{enabled:!1},data,...annotationOpts,...navigatorOpts,...statusBarOpts,...zoomOpts,...toolbarOpts,...unusedOpts}}__name(priceVolume,"priceVolume");function createVolumeSeries(getTheme,openKey,closeKey,volume,volumeKey){return volume?[{type:"bar",xKey:"date",yKey:volumeKey,tooltip:{enabled:!1},itemStyler({datum}){const{up,down}=getTheme().palette;return{fill:datum[openKey]<datum[closeKey]?up==null?void 0:up.fill:down==null?void 0:down.fill}},focusPriority:1,fastDataProcessing:!0,highlight:{enabled:!1}}]:[]}__name(createVolumeSeries,"createVolumeSeries");var RANGE_AREA_TYPE="range-area";function createPriceSeries(chartType,xKey,highKey,lowKey,openKey,closeKey){const keys={xKey,openKey,closeKey,highKey,lowKey},singleKeys={xKey,yKey:closeKey},common={pickOutsideVisibleMinorAxis:!0};switch(chartType??"candlestick"){case"ohlc":return createPriceSeriesOHLC(common,keys);case"line":case"step-line":return createPriceSeriesLine(common,singleKeys);case"hlc":return createPriceSeriesHLC(common,singleKeys,keys);case"high-low":return createPriceSeriesHighLow(common,keys);case"candlestick":case"hollow-candlestick":return createPriceSeriesCandlestick(common,keys);default:return logger_exports.warnOnce(`unknown chart type: ${chartType}; expected one of: ${chartTypes3.join(", ")}`),createPriceSeriesCandlestick(common,keys)}}__name(createPriceSeries,"createPriceSeries");function createPriceSeriesOHLC(common,keys){return[{type:"ohlc",focusPriority:0,...common,...keys}]}__name(createPriceSeriesOHLC,"createPriceSeriesOHLC");function createPriceSeriesLine(common,singleKeys){return[{type:"line",focusPriority:0,...common,...singleKeys}]}__name(createPriceSeriesLine,"createPriceSeriesLine");function createPriceSeriesHLC(common,singleKeys,{xKey,highKey,closeKey,lowKey}){return[{type:RANGE_AREA_TYPE,focusPriority:0,...common,xKey,yHighKey:highKey,yLowKey:closeKey,fill:PALETTE_UP_FILL,stroke:PALETTE_UP_STROKE},{type:RANGE_AREA_TYPE,focusPriority:0,...common,xKey,yHighKey:closeKey,yLowKey:lowKey,fill:PALETTE_DOWN_FILL,stroke:PALETTE_DOWN_STROKE},{type:"line",...common,...singleKeys}]}__name(createPriceSeriesHLC,"createPriceSeriesHLC");function createPriceSeriesHighLow(common,{xKey,highKey,lowKey}){return[{type:"range-bar",...common,xKey,yHighKey:highKey,yLowKey:lowKey,fill:PALETTE_NEUTRAL_FILL,stroke:PALETTE_NEUTRAL_STROKE,tooltip:{range:"nearest"},focusPriority:0,fastDataProcessing:!0}]}__name(createPriceSeriesHighLow,"createPriceSeriesHighLow");function createPriceSeriesCandlestick(common,keys){return[{type:"candlestick",focusPriority:0,...common,...keys}]}__name(createPriceSeriesCandlestick,"createPriceSeriesCandlestick");function inlineSwitch(caseName,switchCases){return switchCases[caseName]??switchCases.default}__name(inlineSwitch,"inlineSwitch");var commonAxisProperties={title:{enabled:!1},label:{enabled:!1},line:{enabled:!1},gridLine:{enabled:!1},crosshair:{enabled:!1,stroke:DEFAULT_SPARKLINE_CROSSHAIR_STROKE,lineDash:[0],label:{enabled:!1}}},numericAxisProperties={...commonAxisProperties,nice:!1},chartTooltipDefaults={mode:"compact",position:{anchorTo:"node",placement:["right","left"]},showArrow:!1},barGridLineDefaults={style:[{stroke:{$ref:"gridLineColor"}}],width:2},barAxisDefaults={number:{gridLine:barGridLineDefaults},time:{gridLine:barGridLineDefaults},category:{gridLine:barGridLineDefaults}},SPARKLINE_THEME={overrides:{common:{animation:{enabled:!1},contextMenu:{enabled:!1},keyboard:{enabled:!1},background:{visible:!1},navigator:{enabled:!1},padding:{top:0,right:0,bottom:0,left:0},axes:{number:{...numericAxisProperties,interval:{values:[0]}},log:{...numericAxisProperties},time:{...numericAxisProperties},category:{...commonAxisProperties}}},bar:{series:{crisp:!1,label:{placement:"inside-end",padding:4},sparklineMode:!0},tooltip:{...chartTooltipDefaults,position:{...chartTooltipDefaults.position,anchorTo:"pointer"},range:"nearest"},axes:barAxisDefaults},line:{seriesArea:{padding:{top:2,right:2,bottom:2,left:2}},series:{sparklineMode:!0,strokeWidth:1,marker:{enabled:!1,size:3}},tooltip:chartTooltipDefaults},area:{seriesArea:{padding:{top:1,right:0,bottom:1,left:0}},series:{strokeWidth:1,fillOpacity:.4},tooltip:chartTooltipDefaults}}},setInitialBaseTheme=simpleMemorize(createInitialBaseTheme);function createInitialBaseTheme(baseTheme,initialBaseTheme){return typeof baseTheme=="string"?{...initialBaseTheme,baseTheme}:baseTheme!=null?{...baseTheme,baseTheme:setInitialBaseTheme(baseTheme.baseTheme,initialBaseTheme)}:initialBaseTheme}__name(createInitialBaseTheme,"createInitialBaseTheme");function sparklineDataPreset(data){if(Array.isArray(data)&&data.length!==0){const firstItem=data[0];if(typeof firstItem=="number")return{data:data.map((y,x)=>({x,y})),series:[{xKey:"x",yKey:"y"}],datumKey:"y"};if(Array.isArray(firstItem))return{data:data.map(datum=>({x:datum[0],y:datum[1],datum})),series:[{xKey:"x",yKey:"y"}],datumKey:"datum"}}return{data}}__name(sparklineDataPreset,"sparklineDataPreset");function axisPreset(opts,defaultType){switch(opts==null?void 0:opts.type){case"number":{const{type,min,max,reverse}=opts;return pickProps(opts,{type,reverse,min,max})}case"time":{const{type,min,max,reverse}=opts;return pickProps(opts,{type,reverse,min,max})}case"category":{const{type,paddingInner,paddingOuter,reverse}=opts;return pickProps(opts,{type,reverse,paddingInner,paddingOuter})}}return{type:defaultType}}__name(axisPreset,"axisPreset");function gridLinePreset(opts,defaultEnabled,sparkOpts){const gridLineOpts={};return(opts==null?void 0:opts.stroke)!=null&&(gridLineOpts.style=[{stroke:opts==null?void 0:opts.stroke}],gridLineOpts.enabled??(gridLineOpts.enabled=!0)),(opts==null?void 0:opts.strokeWidth)!=null&&(gridLineOpts.width=opts==null?void 0:opts.strokeWidth,gridLineOpts.enabled??(gridLineOpts.enabled=!0)),sparkOpts.type==="bar"&&sparkOpts.direction!=="horizontal"&&(gridLineOpts.enabled??(gridLineOpts.enabled=!0)),(opts==null?void 0:opts.visible)!=null&&(gridLineOpts.enabled=opts.visible),gridLineOpts.enabled??(gridLineOpts.enabled=defaultEnabled),gridLineOpts}__name(gridLinePreset,"gridLinePreset");var tooltipRendererFn=simpleMemorize((context,tooltip,datumKey)=>params=>{var _a294;const xValue=params.datum[params.xKey],yValue=params.datum[params.yKey],datum=datumKey!=null?params.datum[datumKey]:params.datum,userContent=(_a294=tooltip==null?void 0:tooltip.renderer)==null?void 0:_a294.call(tooltip,{context,datum,xValue,yValue});return typeof userContent=="string"?userContent:{heading:void 0,title:void 0,data:[{label:userContent==null?void 0:userContent.title,value:(userContent==null?void 0:userContent.content)??yValue.toFixed(2)}]}});function sparkline(opts){const{background,container,height:height2,listeners,locale,minHeight,minWidth,overrideDevicePixelRatio,padding,width:width2,theme:baseTheme,data:baseData,crosshair,axis,min,max,tooltip,context,...optsRest}=opts,chartOpts=pickProps(opts,{background,container,height:height2,listeners,locale,minHeight,minWidth,overrideDevicePixelRatio,padding,width:width2,tooltip:IGNORED_PROP,context:IGNORED_PROP,data:IGNORED_PROP,crosshair:IGNORED_PROP,axis:IGNORED_PROP,min:IGNORED_PROP,max:IGNORED_PROP,theme:IGNORED_PROP}),{data,series:[seriesOverrides]=[],datumKey}=sparklineDataPreset(baseData),seriesOptions=optsRest;seriesOverrides!=null&&Object.assign(seriesOptions,seriesOverrides),seriesOptions.tooltip={...tooltip,renderer:tooltipRendererFn(context,tooltip,datumKey)},chartOpts.theme=setInitialBaseTheme(baseTheme,SPARKLINE_THEME),chartOpts.data=data,chartOpts.series=[seriesOptions];const swapAxes=seriesOptions.type!=="bar"||seriesOptions.direction!=="horizontal",[xAxisPosition,yAxisPosition]=swapAxes?["bottom","left"]:["left","bottom"],xAxis={...axisPreset(axis,"category"),position:xAxisPosition,...pickProps(opts,{crosshair})},yAxis={type:"number",gridLine:gridLinePreset(axis,!1,opts),position:yAxisPosition,...pickProps(opts,{min,max})};return chartOpts.axes=swapAxes?[yAxis,xAxis]:[xAxis,yAxis],chartOpts}__name(sparkline,"sparkline");var PRESETS={"price-volume":priceVolume,gauge,sparkline},PRESET_DATA_PROCESSORS={sparkline:sparklineDataPreset};function removeUsedEnterpriseOptions(options,silent){var _a294,_b,_c,_d;let usedOptions=[];const isGaugeChart=isAgGaugeChartOptions(options),optsType=optionsType(options),optionsChartType=optsType?chartTypes2.get(optsType):"unknown";for(const module of EXPECTED_ENTERPRISE_MODULES)if(!(optionsChartType!=="unknown"&&!module.chartTypes.includes(optionsChartType))){if(module.type==="root"||module.type==="legend"){const optionValue=options[module.optionsKey];if(optionValue==null)continue;module.optionsInnerKey?optionValue[module.optionsInnerKey]&&(usedOptions.push(`${module.optionsKey}.${module.optionsInnerKey}`),delete optionValue[module.optionsInnerKey]):(usedOptions.push(module.optionsKey),delete options[module.optionsKey])}else if(module.type==="axis"){if(!("axes"in options)||!isArray(options.axes)||!((_a294=options.axes)!=null&&_a294.some(axis=>axis.type===module.identifier)))continue;usedOptions.push(`axis[type=${module.identifier}]`),options.axes=options.axes.filter(axis=>axis.type!==module.identifier)}else if(module.type==="axis-option"){if(!("axes"in options)||!isArray(options.axes)||!((_b=options.axes)!=null&&_b.some(axis=>axis[module.optionsKey])))continue;usedOptions.push(`axis.${module.optionsKey}`),options.axes.forEach(axis=>{axis[module.optionsKey]&&delete axis[module.optionsKey]})}else if(module.type==="series"){if(module.community||!isArray(options.series)||!((_c=options.series)!=null&&_c.some(series=>series.type===module.identifier)))continue;usedOptions.push(`series[type=${module.identifier}]`),options.series=options.series.filter(series=>series.type!==module.identifier)}else if(module.type==="series-option"){if(!isArray(options.series)||!((_d=options.series)!=null&&_d.some(series=>series[module.optionsKey])))continue;usedOptions.push(`series.${module.optionsKey}`),options.series.forEach(series=>{series[module.optionsKey]&&delete series[module.optionsKey]})}}if(usedOptions.length&&!silent){isGaugeChart&&(usedOptions=["AgCharts.createGauge"]);let enterprisePackageName="ag-charts-enterprise",enterpriseReferenceUrl="https://www.ag-grid.com/charts/javascript/installation/";options.mode==="integrated"&&(enterprisePackageName="ag-grid-charts-enterprise' or 'ag-grid-enterprise/charts-enterprise",enterpriseReferenceUrl="https://www.ag-grid.com/javascript-data-grid/integrated-charts-installation/"),logger_exports.warnOnce([`unable to use these enterprise features as '${enterprisePackageName}' has not been loaded:`,"",...usedOptions,"",`See: ${enterpriseReferenceUrl}`].join(`
`))}}__name(removeUsedEnterpriseOptions,"removeUsedEnterpriseOptions");function removeUnusedEnterpriseOptions(options){const integratedMode="mode"in options&&options.mode==="integrated";for(const module of moduleRegistry.byType("root","legend")){const moduleOptions=options[module.optionsKey],isPresentAndDisabled=moduleOptions!=null&&moduleOptions.enabled===!1,removable=!("removable"in module)||module.removable===!0||module.removable==="standalone-only"&&!integratedMode;isPresentAndDisabled&&removable&&delete options[module.optionsKey]}}__name(removeUnusedEnterpriseOptions,"removeUnusedEnterpriseOptions");function paletteType(partial){return partial!=null&&partial.up||partial!=null&&partial.down||partial!=null&&partial.neutral?"user-full":partial!=null&&partial.fills||partial!=null&&partial.strokes?"user-indexed":"inbuilt"}__name(paletteType,"paletteType");var DEFAULT_BACKGROUND_FILL="white",CHART_TYPE_CONFIG={get cartesian(){return{seriesTypes:chartTypes2.cartesianTypes,commonOptions:["zoom","navigator"]}},get polar(){return{seriesTypes:chartTypes2.polarTypes,commonOptions:[]}},get hierarchy(){return{seriesTypes:chartTypes2.hierarchyTypes,commonOptions:[]}},get topology(){return{seriesTypes:chartTypes2.topologyTypes,commonOptions:[]}},get"flow-proportion"(){return{seriesTypes:chartTypes2.flowProportionTypes,commonOptions:[]}},get standalone(){return{seriesTypes:chartTypes2.standaloneTypes,commonOptions:[]}},get gauge(){return{seriesTypes:chartTypes2.gaugeTypes,commonOptions:[]}}},PRESET_OVERRIDES_TYPES={"radial-gauge":!0,"linear-gauge":!0};function isPresetOverridesType(type){return PRESET_OVERRIDES_TYPES[type]===!0}__name(isPresetOverridesType,"isPresetOverridesType");var CHART_TYPE_SPECIFIC_COMMON_OPTIONS=Object.values(CHART_TYPE_CONFIG).reduce((r,{commonOptions})=>r.concat(commonOptions),[]),_a257,_ChartTheme=(_a257=class{static getDefaultColors(){return{fills:DEFAULT_FILLS,fillsFallback:Object.values(DEFAULT_FILLS),strokes:DEFAULT_STROKES,sequentialColors:getSequentialColors(DEFAULT_FILLS),divergingColors:[DEFAULT_FILLS.ORANGE,DEFAULT_FILLS.YELLOW,DEFAULT_FILLS.GREEN],hierarchyColors:["#fff","#e0e5ea","#c1ccd5","#a3b4c1","#859cad"],secondSequentialColors:Color.interpolate([Color.fromHexString(DEFAULT_FILLS.BLUE),Color.fromHexString("#cbdef5")],8).map(color6=>color6.toString()),secondDivergingColors:[DEFAULT_FILLS.GREEN,DEFAULT_FILLS.YELLOW,DEFAULT_FILLS.RED],secondHierarchyColors:["#fff","#c5cbd1","#a4b1bd","#8498a9","#648096"],up:{fill:DEFAULT_FILLS.GREEN,stroke:DEFAULT_STROKES.GREEN},down:{fill:DEFAULT_FILLS.RED,stroke:DEFAULT_STROKES.RED},neutral:{fill:DEFAULT_FILLS.GRAY,stroke:DEFAULT_STROKES.GRAY},altUp:{fill:DEFAULT_FILLS.BLUE,stroke:DEFAULT_STROKES.BLUE},altDown:{fill:DEFAULT_FILLS.ORANGE,stroke:DEFAULT_STROKES.ORANGE},altNeutral:{fill:DEFAULT_FILLS.GRAY,stroke:DEFAULT_STROKES.GRAY}}}static getDefaultPublicParameters(){return{accentColor:"#2196f3",axisColor:{$foregroundBackgroundMix:[.675]},backgroundColor:DEFAULT_BACKGROUND_FILL,borderColor:{$foregroundBackgroundMix:[.818]},foregroundColor:"#464646",fontFamily:"Verdana, sans-serif",fontSize:12,fontWeight:400,gridLineColor:{$foregroundBackgroundAccentMix:[.93,.085]},padding:20,subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"backgroundColor"},.38]},textColor:{$ref:"foregroundColor"},chromeBackgroundColor:{$foregroundBackgroundMix:[.975]},chromeFontFamily:{$ref:"fontFamily"},chromeFontSize:{$ref:"fontSize"},chromeFontWeight:{$ref:"fontWeight"},chromeTextColor:"#181d1f",chromeSubtleTextColor:{$mix:[{$ref:"chromeTextColor"},{$ref:"backgroundColor"},.38]},inputBackgroundColor:{$ref:"backgroundColor"},inputTextColor:{$ref:"textColor"},crosshairLabelBackgroundColor:{$ref:"foregroundColor"},crosshairLabelTextColor:{$ref:"backgroundColor"}}}static getAxisDefaults(overrideDefaults,withTitle=!0){return mergeDefaults(overrideDefaults,withTitle&&{title:{enabled:!1,text:"Axis Title",spacing:25,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.0833333333333333]},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},{label:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:11,color:{$ref:"textColor"},avoidCollisions:!0},line:{enabled:!0,width:1,stroke:{$ref:"axisColor"}},tick:{enabled:!1,width:1,stroke:{$ref:"axisColor"}},gridLine:{enabled:!0,style:[{stroke:{$ref:"gridLineColor"},lineDash:[]}]},crossLines:{enabled:!0,fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},fillOpacity:.1,strokeWidth:1,label:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},padding:5,color:{$ref:"textColor"}}}})}getChartDefaults(){return{minHeight:300,minWidth:300,background:{visible:!0,fill:{$ref:"backgroundColor"}},padding:{top:{$ref:"padding"},right:{$ref:"padding"},bottom:{$ref:"padding"},left:{$ref:"padding"}},seriesArea:{padding:{top:0,right:0,bottom:0,left:0}},keyboard:{enabled:!0},title:{enabled:!1,text:"Title",spacing:{$if:[{$path:"../subtitle/enabled"},10,20]},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.4166666666666667]},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},wrapping:"hyphenate",layoutStyle:DEFAULT_CAPTION_LAYOUT_STYLE,textAlign:DEFAULT_CAPTION_ALIGNMENT},subtitle:{enabled:!1,text:"Subtitle",spacing:20,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.0833333333333333]},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:DEFAULT_CAPTION_LAYOUT_STYLE,textAlign:DEFAULT_CAPTION_ALIGNMENT},footnote:{enabled:!1,text:"Footnote",spacing:20,fontSize:{$rem:[1.0833333333333333]},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:DEFAULT_CAPTION_LAYOUT_STYLE,textAlign:DEFAULT_CAPTION_ALIGNMENT},legend:{position:"bottom",orientation:{$if:[{$or:[{$eq:[{$path:"./position"},"left"]},{$eq:[{$path:"./position"},"right"]}]},"vertical","horizontal"]},spacing:30,listeners:{},toggleSeries:!0,item:{paddingX:16,paddingY:8,marker:{size:15,padding:8},showSeriesStroke:!0,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"}}},reverseOrder:!1,pagination:{marker:{size:12},activeStyle:{fill:{$ref:"foregroundColor"}},inactiveStyle:{fill:{$ref:"subtleTextColor"}},highlightStyle:{fill:{$ref:"foregroundColor"}},label:{color:{$ref:"textColor"}}}},tooltip:{enabled:!0,darkTheme:IS_DARK_THEME,delay:0,pagination:!1},overlays:{darkTheme:IS_DARK_THEME},listeners:{}}}constructor(options={}){const{overrides,palette:palette2}=deepClone(options),defaults=this.createChartConfigPerChartType(this.getDefaults()),presets={};overrides&&this.mergeOverrides(defaults,presets,overrides);const{fills,strokes,sequentialColors,...otherColors}=this.getDefaultColors();this.palette=deepFreeze(mergeDefaults(palette2,{fills:Object.values(fills),strokes:Object.values(strokes),sequentialColors:Object.values(sequentialColors),...otherColors})),this.paletteType=paletteType(palette2),this.config=deepFreeze(this.templateTheme(defaults)),this.presets=deepFreeze(presets)}mergeOverrides(defaults,presets,overrides){for(const{seriesTypes,commonOptions}of Object.values(CHART_TYPE_CONFIG)){const cleanedCommon={...overrides.common};for(const commonKey of CHART_TYPE_SPECIFIC_COMMON_OPTIONS)commonOptions.includes(commonKey)||delete cleanedCommon[commonKey];if(cleanedCommon)for(const s of seriesTypes){const seriesType=s;isPresetOverridesType(seriesType)||(defaults[seriesType]=mergeDefaults(cleanedCommon,defaults[seriesType]))}}chartTypes2.seriesTypes.forEach(s=>{const seriesType=s,seriesOverrides=overrides[seriesType];isPresetOverridesType(seriesType)?presets[seriesType]=seriesOverrides:defaults[seriesType]=mergeDefaults(seriesOverrides,defaults[seriesType])})}createChartConfigPerChartType(config){for(const[nextType,{seriesTypes}]of entries(CHART_TYPE_CONFIG)){const typeDefaults=chartDefaults.get(nextType);for(const seriesType of seriesTypes)config[seriesType]??(config[seriesType]=deepClone(typeDefaults))}return config}getDefaults(){const getOverridesByType=__name((chartType,seriesTypes)=>{const result={},chartTypeDefaults={axes:{},...legendRegistry.getThemeTemplates(),...this.getChartDefaults(),...chartDefaults.get(chartType)};for(const seriesType of seriesTypes){result[seriesType]=mergeDefaults(seriesRegistry.getThemeTemplate(seriesType),result[seriesType]??deepClone(chartTypeDefaults));const{axes}=result[seriesType];for(const axisType of axisRegistry.keys())axes[axisType]=mergeDefaults(axes[axisType],axisRegistry.getThemeTemplate(axisType),_a257.axisDefault[axisType])}return result},"getOverridesByType");return mergeDefaults(getOverridesByType("cartesian",chartTypes2.cartesianTypes),getOverridesByType("polar",chartTypes2.polarTypes),getOverridesByType("hierarchy",chartTypes2.hierarchyTypes),getOverridesByType("topology",chartTypes2.topologyTypes),getOverridesByType("flow-proportion",chartTypes2.flowProportionTypes),getOverridesByType("standalone",chartTypes2.standaloneTypes),getOverridesByType("gauge",chartTypes2.gaugeTypes))}static applyTemplateTheme(node,_other,params){if(isArray(node))for(let i=0;i<node.length;i++){const symbol=node[i];typeof symbol=="symbol"&&(params!=null&&params.has(symbol))&&(node[i]=params.get(symbol))}else for(const name of Object.keys(node)){const value=node[name];typeof value=="symbol"&&(params!=null&&params.has(value))&&(node[name]=params.get(value))}}templateTheme(themeTemplate,clone2=!0){const themeInstance=clone2?deepClone(themeTemplate):themeTemplate,params=this.getTemplateParameters();return jsonWalk(themeInstance,_a257.applyTemplateTheme,void 0,void 0,params),themeInstance}getDefaultColors(){return _a257.getDefaultColors()}getPublicParameters(){return _a257.getDefaultPublicParameters()}getTemplateParameters(){var _a294,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l;const{isEnterprise}=enterpriseModule,params=new Map;params.set(IS_DARK_THEME,!1),params.set(IS_ENTERPRISE,isEnterprise),params.set(IS_COMMUNITY,!isEnterprise),params.set(DEFAULT_SEPARATION_LINES_COLOUR,"#d9d9d9"),params.set(DEFAULT_SHADOW_COLOUR,"#00000080"),params.set(DEFAULT_SPARKLINE_CROSSHAIR_STROKE,"#aaa"),params.set(DEFAULT_CAPTION_LAYOUT_STYLE,"block"),params.set(DEFAULT_CAPTION_ALIGNMENT,"center"),params.set(DEFAULT_FIBONACCI_STROKES,["#797b86","#e24c4a","#f49d2d","#65ab58","#409682","#4db9d2","#5090dc","#3068f9","#e24c4a","#913aac","#d93e64"]),params.set(DEFAULT_POLAR_SERIES_STROKE,DEFAULT_BACKGROUND_FILL),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,DEFAULT_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,DEFAULT_FILLS.BLUE),params.set(DEFAULT_TEXT_ANNOTATION_COLOR,DEFAULT_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_HANDLE_FILL,DEFAULT_BACKGROUND_FILL),params.set(DEFAULT_ANNOTATION_STATISTICS_FILL,"#fafafa"),params.set(DEFAULT_ANNOTATION_STATISTICS_STROKE,"#ddd"),params.set(DEFAULT_ANNOTATION_STATISTICS_COLOR,"#000"),params.set(DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,"#181d1f"),params.set(DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,"#e35c5c"),params.set(DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,"#e35c5c"),params.set(DEFAULT_TEXTBOX_FILL,"#fafafa"),params.set(DEFAULT_TEXTBOX_STROKE,"#ddd"),params.set(DEFAULT_TEXTBOX_COLOR,"#000"),params.set(DEFAULT_TOOLBAR_POSITION,"top"),params.set(DEFAULT_GRIDLINE_ENABLED,!1);const defaultColors=this.getDefaultColors();return params.set(PALETTE_UP_STROKE,((_a294=this.palette.up)==null?void 0:_a294.stroke)??defaultColors.up.stroke),params.set(PALETTE_UP_FILL,((_b=this.palette.up)==null?void 0:_b.fill)??defaultColors.up.fill),params.set(PALETTE_DOWN_STROKE,((_c=this.palette.down)==null?void 0:_c.stroke)??defaultColors.down.stroke),params.set(PALETTE_DOWN_FILL,((_d=this.palette.down)==null?void 0:_d.fill)??defaultColors.down.fill),params.set(PALETTE_NEUTRAL_STROKE,((_e=this.palette.neutral)==null?void 0:_e.stroke)??defaultColors.neutral.stroke),params.set(PALETTE_NEUTRAL_FILL,((_f=this.palette.neutral)==null?void 0:_f.fill)??defaultColors.neutral.fill),params.set(PALETTE_ALT_UP_STROKE,((_g=this.palette.altUp)==null?void 0:_g.stroke)??defaultColors.up.stroke),params.set(PALETTE_ALT_UP_FILL,((_h=this.palette.altUp)==null?void 0:_h.fill)??defaultColors.up.fill),params.set(PALETTE_ALT_DOWN_STROKE,((_i=this.palette.altDown)==null?void 0:_i.stroke)??defaultColors.down.stroke),params.set(PALETTE_ALT_DOWN_FILL,((_j=this.palette.altDown)==null?void 0:_j.fill)??defaultColors.down.fill),params.set(PALETTE_ALT_NEUTRAL_FILL,((_k=this.palette.altNeutral)==null?void 0:_k.fill)??defaultColors.altNeutral.fill),params.set(PALETTE_ALT_NEUTRAL_STROKE,((_l=this.palette.altNeutral)==null?void 0:_l.stroke)??defaultColors.altNeutral.stroke),params}},__name(_a257,"_ChartTheme"),_a257);_ChartTheme.axisDefault={number:_ChartTheme.getAxisDefaults({keys:[],line:{enabled:!1},crosshair:{enabled:!0}}),log:_ChartTheme.getAxisDefaults({keys:[],base:10,line:{enabled:!1},crosshair:{enabled:!0}}),category:_ChartTheme.getAxisDefaults({keys:[],groupPaddingInner:.1,label:{autoRotate:!0},gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED},crosshair:{enabled:!1}}),"grouped-category":_ChartTheme.getAxisDefaults({keys:[],tick:{enabled:!0,stroke:DEFAULT_SEPARATION_LINES_COLOUR},label:{spacing:10,rotation:270},paddingInner:.4,groupPaddingInner:.2,crosshair:{enabled:!1}}),time:_ChartTheme.getAxisDefaults({keys:[],gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED},crosshair:{enabled:!0}}),"ordinal-time":_ChartTheme.getAxisDefaults({keys:[],groupPaddingInner:0,label:{autoRotate:!1},gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED},crosshair:{enabled:!0}}),"angle-category":_ChartTheme.getAxisDefaults({label:{spacing:5},gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED},shape:{$path:["./shape",void 0,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]}},!1),"angle-number":_ChartTheme.getAxisDefaults({label:{spacing:5},gridLine:{enabled:DEFAULT_GRIDLINE_ENABLED}},!1),"radius-category":_ChartTheme.getAxisDefaults({positionAngle:0,line:{enabled:!1}}),"radius-number":_ChartTheme.getAxisDefaults({positionAngle:0,line:{enabled:!1},shape:{$path:["./shape",void 0,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]}})};var ChartTheme=_ChartTheme,DEFAULT_DARK_BACKGROUND_FILL="#192232",DEFAULT_DARK_FILLS={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},DEFAULT_DARK_STROKES={BLUE:"#74a8e6",ORANGE:"#ffbe70",GREEN:"#6cb176",CYAN:"#75d4ef",YELLOW:"#f6e559",VIOLET:"#aa86d8",GRAY:"#a1a1a1",MAGENTA:"#ce7ab9",BROWN:"#997b52",RED:"#ff7872"},_a258,DarkTheme=(_a258=class extends ChartTheme{getDefaultColors(){return{fills:DEFAULT_DARK_FILLS,fillsFallback:Object.values(DEFAULT_DARK_FILLS),strokes:DEFAULT_DARK_STROKES,sequentialColors:getSequentialColors(DEFAULT_DARK_FILLS),divergingColors:[DEFAULT_DARK_FILLS.ORANGE,DEFAULT_DARK_FILLS.YELLOW,DEFAULT_DARK_FILLS.GREEN],hierarchyColors:["#192834","#253746","#324859","#3f596c","#4d6a80"],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[DEFAULT_DARK_FILLS.GREEN,DEFAULT_DARK_FILLS.YELLOW,DEFAULT_DARK_FILLS.RED],secondHierarchyColors:["#192834","#3b5164","#496275","#577287","#668399"],up:{fill:DEFAULT_DARK_FILLS.GREEN,stroke:DEFAULT_DARK_STROKES.GREEN},down:{fill:DEFAULT_DARK_FILLS.RED,stroke:DEFAULT_DARK_STROKES.RED},neutral:{fill:DEFAULT_DARK_FILLS.GRAY,stroke:DEFAULT_DARK_STROKES.GRAY},altUp:{fill:DEFAULT_DARK_FILLS.BLUE,stroke:DEFAULT_DARK_STROKES.BLUE},altDown:{fill:DEFAULT_DARK_FILLS.ORANGE,stroke:DEFAULT_DARK_STROKES.ORANGE},altNeutral:{fill:DEFAULT_DARK_FILLS.GRAY,stroke:DEFAULT_DARK_STROKES.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),axisColor:{$foregroundBackgroundMix:[.263]},backgroundColor:DEFAULT_DARK_BACKGROUND_FILL,borderColor:{$foregroundBackgroundMix:[.784]},chromeBackgroundColor:{$foregroundBackgroundMix:[.93]},foregroundColor:"#fff",gridLineColor:{$foregroundBackgroundAccentMix:[.743,.01]},subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"backgroundColor"},.57]},chromeTextColor:{$ref:"textColor"},crosshairLabelBackgroundColor:{$foregroundBackgroundAccentMix:[.35,.1]}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(IS_DARK_THEME,!0),params.set(DEFAULT_POLAR_SERIES_STROKE,DEFAULT_DARK_BACKGROUND_FILL),params.set(DEFAULT_SEPARATION_LINES_COLOUR,"#7f8389"),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,DEFAULT_DARK_FILLS.BLUE),params.set(DEFAULT_TEXT_ANNOTATION_COLOR,"#fff"),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,DEFAULT_DARK_FILLS.BLUE),params.set(DEFAULT_ANNOTATION_HANDLE_FILL,DEFAULT_DARK_BACKGROUND_FILL),params.set(DEFAULT_ANNOTATION_STATISTICS_FILL,"#28313e"),params.set(DEFAULT_ANNOTATION_STATISTICS_STROKE,"#4b525d"),params.set(DEFAULT_ANNOTATION_STATISTICS_COLOR,"#fff"),params.set(DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,"#fff"),params.set(DEFAULT_TEXTBOX_FILL,"#28313e"),params.set(DEFAULT_TEXTBOX_STROKE,"#4b525d"),params.set(DEFAULT_TEXTBOX_COLOR,"#fff"),params}constructor(options){super(options)}},__name(_a258,"DarkTheme"),_a258),FINANCIAL_DARK_FILLS={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},FINANCIAL_DARK_STROKES={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},_a259,FinancialDark=(_a259=class extends DarkTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:{...FINANCIAL_DARK_FILLS},fillsFallback:Object.values({...FINANCIAL_DARK_FILLS}),strokes:{...FINANCIAL_DARK_STROKES},sequentialColors:getSequentialColors(FINANCIAL_DARK_FILLS),divergingColors:[FINANCIAL_DARK_FILLS.GREEN,FINANCIAL_DARK_FILLS.BLUE,FINANCIAL_DARK_FILLS.RED],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],up:{fill:FINANCIAL_DARK_FILLS.GREEN,stroke:FINANCIAL_DARK_STROKES.GREEN},down:{fill:FINANCIAL_DARK_FILLS.RED,stroke:FINANCIAL_DARK_STROKES.RED},neutral:{fill:FINANCIAL_DARK_FILLS.BLUE,stroke:FINANCIAL_DARK_STROKES.BLUE},altUp:{fill:FINANCIAL_DARK_FILLS.GREEN,stroke:FINANCIAL_DARK_STROKES.GREEN},altDown:{fill:FINANCIAL_DARK_FILLS.RED,stroke:FINANCIAL_DARK_STROKES.RED},altNeutral:{fill:FINANCIAL_DARK_FILLS.GRAY,stroke:FINANCIAL_DARK_STROKES.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),gridLineColor:{$foregroundBackgroundAccentMix:[.88,.01]},padding:0}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,FINANCIAL_DARK_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,FINANCIAL_DARK_FILLS.BLUE),params.set(DEFAULT_CAPTION_LAYOUT_STYLE,"overlay"),params.set(DEFAULT_CAPTION_ALIGNMENT,"left"),params.set(DEFAULT_TOOLBAR_POSITION,"bottom"),params.set(DEFAULT_GRIDLINE_ENABLED,!0),params}},__name(_a259,"FinancialDark"),_a259),FINANCIAL_LIGHT_FILLS={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},FINANCIAL_LIGHT_STROKES={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},_a260,FinancialLight=(_a260=class extends ChartTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:{...FINANCIAL_LIGHT_FILLS},fillsFallback:Object.values({...FINANCIAL_LIGHT_FILLS}),strokes:{...FINANCIAL_LIGHT_STROKES},sequentialColors:getSequentialColors(FINANCIAL_LIGHT_FILLS),divergingColors:[FINANCIAL_LIGHT_FILLS.GREEN,FINANCIAL_LIGHT_FILLS.BLUE,FINANCIAL_LIGHT_FILLS.RED],up:{fill:FINANCIAL_LIGHT_FILLS.GREEN,stroke:FINANCIAL_LIGHT_STROKES.GREEN},down:{fill:FINANCIAL_LIGHT_FILLS.RED,stroke:FINANCIAL_LIGHT_STROKES.RED},neutral:{fill:FINANCIAL_LIGHT_FILLS.BLUE,stroke:FINANCIAL_LIGHT_STROKES.BLUE},altUp:{fill:FINANCIAL_LIGHT_FILLS.GREEN,stroke:FINANCIAL_LIGHT_STROKES.GREEN},altDown:{fill:FINANCIAL_LIGHT_FILLS.RED,stroke:FINANCIAL_LIGHT_STROKES.RED},altNeutral:{fill:FINANCIAL_LIGHT_FILLS.GRAY,stroke:FINANCIAL_LIGHT_STROKES.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),gridLineColor:{$foregroundBackgroundAccentMix:[.94,.01]},padding:0}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,FINANCIAL_LIGHT_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,FINANCIAL_LIGHT_FILLS.BLUE),params.set(DEFAULT_CAPTION_LAYOUT_STYLE,"overlay"),params.set(DEFAULT_CAPTION_ALIGNMENT,"left"),params.set(DEFAULT_TOOLBAR_POSITION,"bottom"),params.set(DEFAULT_GRIDLINE_ENABLED,!0),params}},__name(_a260,"FinancialLight"),_a260),MATERIAL_DARK_FILLS={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},MATERIAL_DARK_STROKES={BLUE:"#90CAF9",ORANGE:"#FFCC80",GREEN:"#A5D6A7",CYAN:"#80DEEA",YELLOW:"#FFF9C4",VIOLET:"#B39DDB",GRAY:"#E0E0E0",MAGENTA:"#F48FB1",BROWN:"#A1887F",RED:"#EF9A9A"},_a261,MaterialDark=(_a261=class extends DarkTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:MATERIAL_DARK_FILLS,fillsFallback:Object.values(MATERIAL_DARK_FILLS),strokes:MATERIAL_DARK_STROKES,sequentialColors:getSequentialColors(MATERIAL_DARK_FILLS),divergingColors:[MATERIAL_DARK_FILLS.ORANGE,MATERIAL_DARK_FILLS.YELLOW,MATERIAL_DARK_FILLS.GREEN],secondSequentialColors:["#2196f3","#208FEC","#1E88E5","#1C7FDC","#1976d2","#176EC9","#1565c0"],secondDivergingColors:[MATERIAL_DARK_FILLS.GREEN,MATERIAL_DARK_FILLS.YELLOW,MATERIAL_DARK_FILLS.RED],up:{fill:MATERIAL_DARK_FILLS.GREEN,stroke:MATERIAL_DARK_STROKES.GREEN},down:{fill:MATERIAL_DARK_FILLS.RED,stroke:MATERIAL_DARK_STROKES.RED},neutral:{fill:MATERIAL_DARK_FILLS.GRAY,stroke:MATERIAL_DARK_STROKES.GRAY},altUp:{fill:MATERIAL_DARK_FILLS.BLUE,stroke:MATERIAL_DARK_STROKES.BLUE},altDown:{fill:MATERIAL_DARK_FILLS.RED,stroke:MATERIAL_DARK_STROKES.RED},altNeutral:{fill:MATERIAL_DARK_FILLS.GRAY,stroke:MATERIAL_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,MATERIAL_DARK_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,MATERIAL_DARK_FILLS.BLUE),params}},__name(_a261,"MaterialDark"),_a261),MATERIAL_LIGHT_FILLS={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},MATERIAL_LIGHT_STROKES={BLUE:"#1565C0",ORANGE:"#E65100",GREEN:"#2E7D32",CYAN:"#00838F",YELLOW:"#F9A825",VIOLET:"#4527A0",GRAY:"#616161",MAGENTA:"#C2185B",BROWN:"#4E342E",RED:"#B71C1C"},_a262,MaterialLight=(_a262=class extends ChartTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:MATERIAL_LIGHT_FILLS,fillsFallback:Object.values(MATERIAL_LIGHT_FILLS),strokes:MATERIAL_LIGHT_STROKES,sequentialColors:getSequentialColors(MATERIAL_LIGHT_FILLS),divergingColors:[MATERIAL_LIGHT_FILLS.ORANGE,MATERIAL_LIGHT_FILLS.YELLOW,MATERIAL_LIGHT_FILLS.GREEN],secondSequentialColors:["#2196f3","#329EF4","#42a5f5","#53ADF6","#64b5f6","#7AC0F8","#90caf9"],secondDivergingColors:[MATERIAL_LIGHT_FILLS.GREEN,MATERIAL_LIGHT_FILLS.YELLOW,MATERIAL_LIGHT_FILLS.RED],up:{fill:MATERIAL_LIGHT_FILLS.GREEN,stroke:MATERIAL_LIGHT_STROKES.GREEN},down:{fill:MATERIAL_LIGHT_FILLS.RED,stroke:MATERIAL_LIGHT_STROKES.RED},neutral:{fill:MATERIAL_LIGHT_FILLS.GRAY,stroke:MATERIAL_LIGHT_STROKES.GRAY},altUp:{fill:MATERIAL_LIGHT_FILLS.BLUE,stroke:MATERIAL_LIGHT_STROKES.BLUE},altDown:{fill:MATERIAL_LIGHT_FILLS.RED,stroke:MATERIAL_LIGHT_STROKES.RED},altNeutral:{fill:MATERIAL_LIGHT_FILLS.GRAY,stroke:MATERIAL_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,MATERIAL_LIGHT_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,MATERIAL_LIGHT_FILLS.BLUE),params}},__name(_a262,"MaterialLight"),_a262),POLYCHROMA_DARK_FILLS={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},POLYCHROMA_DARK_STROKES={BLUE:"#6698ff",PURPLE:"#c0a3ff",MAGENTA:"#fc8dfc",PINK:"#ff82b1",RED:"#ff9b70",ORANGE:"#ffcf4e",YELLOW:"#ffff58",GREEN:"#58dd70",CYAN:"#51e2c9",MODERATE_BLUE:"#4fd7ff",GRAY:"#eeeeee"},_a263,PolychromaDark=(_a263=class extends DarkTheme{getDefaultColors(){return{fills:POLYCHROMA_DARK_FILLS,fillsFallback:Object.values(POLYCHROMA_DARK_FILLS),strokes:POLYCHROMA_DARK_STROKES,sequentialColors:getSequentialColors(POLYCHROMA_DARK_FILLS),divergingColors:[POLYCHROMA_DARK_FILLS.BLUE,POLYCHROMA_DARK_FILLS.RED],hierarchyColors:[],secondSequentialColors:[POLYCHROMA_DARK_FILLS.BLUE,POLYCHROMA_DARK_FILLS.PURPLE,POLYCHROMA_DARK_FILLS.MAGENTA,POLYCHROMA_DARK_FILLS.PINK,POLYCHROMA_DARK_FILLS.RED,POLYCHROMA_DARK_FILLS.ORANGE,POLYCHROMA_DARK_FILLS.YELLOW,POLYCHROMA_DARK_FILLS.GREEN],secondDivergingColors:[POLYCHROMA_DARK_FILLS.BLUE,POLYCHROMA_DARK_FILLS.RED],secondHierarchyColors:[],up:{fill:POLYCHROMA_DARK_FILLS.GREEN,stroke:POLYCHROMA_DARK_STROKES.GREEN},down:{fill:POLYCHROMA_DARK_FILLS.RED,stroke:POLYCHROMA_DARK_STROKES.RED},neutral:{fill:POLYCHROMA_DARK_FILLS.GRAY,stroke:POLYCHROMA_DARK_STROKES.GRAY},altUp:{fill:POLYCHROMA_DARK_FILLS.BLUE,stroke:POLYCHROMA_DARK_STROKES.BLUE},altDown:{fill:POLYCHROMA_DARK_FILLS.RED,stroke:POLYCHROMA_DARK_STROKES.RED},altNeutral:{fill:POLYCHROMA_DARK_FILLS.GRAY,stroke:POLYCHROMA_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,POLYCHROMA_DARK_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,POLYCHROMA_DARK_FILLS.BLUE),params}},__name(_a263,"PolychromaDark"),_a263),POLYCHROMA_LIGHT_FILLS={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},POLYCHROMA_LIGHT_STROKES={BLUE:"#2346c9",PURPLE:"#7653d4",MAGENTA:"#a73da9",PINK:"#c32d66",RED:"#c84b1c",ORANGE:"#c87f00",YELLOW:"#c1b900",GREEN:"#008c1c",CYAN:"#00927c",MODERATE_BLUE:"#0087bb",GRAY:"#888888"},_a264,PolychromaLight=(_a264=class extends ChartTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:POLYCHROMA_LIGHT_FILLS,fillsFallback:Object.values(POLYCHROMA_LIGHT_FILLS),strokes:POLYCHROMA_LIGHT_STROKES,sequentialColors:getSequentialColors(POLYCHROMA_LIGHT_FILLS),divergingColors:[POLYCHROMA_LIGHT_FILLS.BLUE,POLYCHROMA_LIGHT_FILLS.RED],hierarchyColors:[],secondSequentialColors:[POLYCHROMA_LIGHT_FILLS.BLUE,POLYCHROMA_LIGHT_FILLS.PURPLE,POLYCHROMA_LIGHT_FILLS.MAGENTA,POLYCHROMA_LIGHT_FILLS.PINK,POLYCHROMA_LIGHT_FILLS.RED,POLYCHROMA_LIGHT_FILLS.ORANGE,POLYCHROMA_LIGHT_FILLS.YELLOW,POLYCHROMA_LIGHT_FILLS.GREEN],secondDivergingColors:[POLYCHROMA_LIGHT_FILLS.BLUE,POLYCHROMA_LIGHT_FILLS.RED],secondHierarchyColors:[],up:{fill:POLYCHROMA_LIGHT_FILLS.GREEN,stroke:POLYCHROMA_LIGHT_STROKES.GREEN},down:{fill:POLYCHROMA_LIGHT_FILLS.RED,stroke:POLYCHROMA_LIGHT_STROKES.RED},neutral:{fill:POLYCHROMA_LIGHT_FILLS.GRAY,stroke:POLYCHROMA_LIGHT_STROKES.GRAY},altUp:{fill:POLYCHROMA_LIGHT_FILLS.BLUE,stroke:POLYCHROMA_LIGHT_STROKES.BLUE},altDown:{fill:POLYCHROMA_LIGHT_FILLS.RED,stroke:POLYCHROMA_LIGHT_STROKES.RED},altNeutral:{fill:POLYCHROMA_LIGHT_FILLS.GRAY,stroke:POLYCHROMA_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,POLYCHROMA_LIGHT_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,POLYCHROMA_LIGHT_FILLS.BLUE),params}},__name(_a264,"PolychromaLight"),_a264),SHEETS_DARK_FILLS={BLUE:"#4472C4",ORANGE:"#ED7D31",GRAY:"#A5A5A5",YELLOW:"#FFC000",MODERATE_BLUE:"#5B9BD5",GREEN:"#70AD47",DARK_GRAY:"#7B7B7B",DARK_BLUE:"#264478",VERY_DARK_GRAY:"#636363",DARK_YELLOW:"#997300"},SHEETS_DARK_STROKES={BLUE:"#6899ee",ORANGE:"#ffa55d",GRAY:"#cdcdcd",YELLOW:"#ffea53",MODERATE_BLUE:"#82c3ff",GREEN:"#96d56f",DARK_GRAY:"#a1a1a1",DARK_BLUE:"#47689f",VERY_DARK_GRAY:"#878787",DARK_YELLOW:"#c0993d"},_a265,SheetsDark=(_a265=class extends DarkTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:{...SHEETS_DARK_FILLS,RED:SHEETS_DARK_FILLS.ORANGE},fillsFallback:Object.values({...SHEETS_DARK_FILLS,RED:SHEETS_DARK_FILLS.ORANGE}),strokes:{...SHEETS_DARK_STROKES,RED:SHEETS_DARK_STROKES.ORANGE},sequentialColors:getSequentialColors({...SHEETS_DARK_FILLS,RED:SHEETS_DARK_FILLS.ORANGE}),divergingColors:[SHEETS_DARK_FILLS.ORANGE,SHEETS_DARK_FILLS.YELLOW,SHEETS_DARK_FILLS.GREEN],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[SHEETS_DARK_FILLS.GREEN,SHEETS_DARK_FILLS.YELLOW,SHEETS_DARK_FILLS.ORANGE],up:{fill:SHEETS_DARK_FILLS.GREEN,stroke:SHEETS_DARK_STROKES.GREEN},down:{fill:SHEETS_DARK_FILLS.ORANGE,stroke:SHEETS_DARK_STROKES.ORANGE},neutral:{fill:SHEETS_DARK_FILLS.GRAY,stroke:SHEETS_DARK_STROKES.GRAY},altUp:{fill:SHEETS_DARK_FILLS.BLUE,stroke:SHEETS_DARK_STROKES.BLUE},altDown:{fill:SHEETS_DARK_FILLS.ORANGE,stroke:SHEETS_DARK_STROKES.ORANGE},altNeutral:{fill:SHEETS_DARK_FILLS.GRAY,stroke:SHEETS_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,SHEETS_DARK_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,SHEETS_DARK_FILLS.BLUE),params}},__name(_a265,"SheetsDark"),_a265),SHEETS_LIGHT_FILLS={BLUE:"#5281d5",ORANGE:"#ff8d44",GRAY:"#b5b5b5",YELLOW:"#ffd02f",MODERATE_BLUE:"#6aabe6",GREEN:"#7fbd57",DARK_GRAY:"#8a8a8a",DARK_BLUE:"#335287",VERY_DARK_GRAY:"#717171",DARK_YELLOW:"#a98220"},SHEETS_LIGHT_STROKES={BLUE:"#214d9b",ORANGE:"#c25600",GRAY:"#7f7f7f",YELLOW:"#d59800",MODERATE_BLUE:"#3575ac",GREEN:"#4b861a",DARK_GRAY:"#575757",DARK_BLUE:"#062253",VERY_DARK_GRAY:"#414141",DARK_YELLOW:"#734f00"},_a266,SheetsLight=(_a266=class extends ChartTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:{...SHEETS_LIGHT_FILLS,RED:SHEETS_LIGHT_FILLS.ORANGE},fillsFallback:Object.values({...SHEETS_LIGHT_FILLS,RED:SHEETS_LIGHT_FILLS.ORANGE}),strokes:{...SHEETS_LIGHT_STROKES,RED:SHEETS_LIGHT_STROKES.ORANGE},sequentialColors:getSequentialColors({...SHEETS_LIGHT_FILLS,RED:SHEETS_LIGHT_FILLS.ORANGE}),divergingColors:[SHEETS_LIGHT_FILLS.ORANGE,SHEETS_LIGHT_FILLS.YELLOW,SHEETS_LIGHT_FILLS.GREEN],secondSequentialColors:["#5090dc","#629be0","#73a6e3","#85b1e7","#96bcea","#a8c8ee","#b9d3f1","#cbdef5"],secondDivergingColors:[SHEETS_LIGHT_FILLS.GREEN,SHEETS_LIGHT_FILLS.YELLOW,SHEETS_LIGHT_FILLS.ORANGE],secondHierarchyColors:[],up:{fill:SHEETS_LIGHT_FILLS.GREEN,stroke:SHEETS_LIGHT_STROKES.GREEN},down:{fill:SHEETS_LIGHT_FILLS.ORANGE,stroke:SHEETS_LIGHT_STROKES.ORANGE},neutral:{fill:SHEETS_LIGHT_STROKES.GRAY,stroke:SHEETS_LIGHT_STROKES.GRAY},altUp:{fill:SHEETS_LIGHT_FILLS.BLUE,stroke:SHEETS_LIGHT_STROKES.BLUE},altDown:{fill:SHEETS_LIGHT_FILLS.ORANGE,stroke:SHEETS_LIGHT_STROKES.ORANGE},altNeutral:{fill:SHEETS_LIGHT_FILLS.GRAY,stroke:SHEETS_LIGHT_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,SHEETS_LIGHT_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,SHEETS_LIGHT_FILLS.BLUE),params}},__name(_a266,"SheetsLight"),_a266),VIVID_DARK_FILLS={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},VIVID_DARK_STROKES={BLUE:"#67b7ff",ORANGE:"#ffc24d",GREEN:"#5cc86f",CYAN:"#54ebff",VIOLET:"#fff653",YELLOW:"#c18aff",GRAY:"#aeaeae",MAGENTA:"#f078d4",BROWN:"#ba8438",RED:"#ff726e"},_a267,VividDark=(_a267=class extends DarkTheme{getDefaultColors(){return{fills:VIVID_DARK_FILLS,fillsFallback:Object.values(VIVID_DARK_FILLS),strokes:VIVID_DARK_STROKES,sequentialColors:getSequentialColors(VIVID_DARK_FILLS),divergingColors:[VIVID_DARK_FILLS.ORANGE,VIVID_DARK_FILLS.YELLOW,VIVID_DARK_FILLS.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#0076e6","#0069cc","#005cb3","#004f99","#004280","#003466","#00274c"],secondDivergingColors:[VIVID_DARK_FILLS.GREEN,VIVID_DARK_FILLS.YELLOW,VIVID_DARK_FILLS.RED],secondHierarchyColors:[],up:{fill:VIVID_DARK_FILLS.GREEN,stroke:VIVID_DARK_STROKES.GREEN},down:{fill:VIVID_DARK_FILLS.RED,stroke:VIVID_DARK_STROKES.RED},neutral:{fill:VIVID_DARK_FILLS.GRAY,stroke:VIVID_DARK_STROKES.GRAY},altUp:{fill:VIVID_DARK_FILLS.BLUE,stroke:VIVID_DARK_STROKES.BLUE},altDown:{fill:VIVID_DARK_FILLS.ORANGE,stroke:VIVID_DARK_STROKES.ORANGE},altNeutral:{fill:VIVID_DARK_FILLS.GRAY,stroke:VIVID_DARK_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,VIVID_DARK_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,VIVID_DARK_FILLS.BLUE),params}},__name(_a267,"VividDark"),_a267),VIVID_FILLS={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},VIVID_STROKES={BLUE:"#0f68c0",ORANGE:"#d47100",GREEN:"#007922",CYAN:"#009ac2",VIOLET:"#bca400",YELLOW:"#753cac",GRAY:"#646464",MAGENTA:"#9b2685",BROWN:"#6c3b00",RED:"#cb0021"},_a268,VividLight=(_a268=class extends ChartTheme{getDefaultColors(){return{...super.getDefaultColors(),fills:VIVID_FILLS,fillsFallback:Object.values(VIVID_FILLS),strokes:VIVID_STROKES,sequentialColors:getSequentialColors(VIVID_FILLS),divergingColors:[VIVID_FILLS.ORANGE,VIVID_FILLS.YELLOW,VIVID_FILLS.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#1a8fff","#339cff","#4da8ff","#66b5ff","#80c1ff","#99cdff","#b3daff"],secondDivergingColors:[VIVID_FILLS.GREEN,VIVID_FILLS.YELLOW,VIVID_FILLS.RED],secondHierarchyColors:[],up:{fill:VIVID_FILLS.GREEN,stroke:VIVID_STROKES.GREEN},down:{fill:VIVID_FILLS.RED,stroke:VIVID_STROKES.RED},neutral:{fill:VIVID_FILLS.GRAY,stroke:VIVID_STROKES.GRAY},altUp:{fill:VIVID_FILLS.BLUE,stroke:VIVID_STROKES.BLUE},altDown:{fill:VIVID_FILLS.ORANGE,stroke:VIVID_STROKES.ORANGE},altNeutral:{fill:VIVID_FILLS.GRAY,stroke:VIVID_STROKES.GRAY}}}getTemplateParameters(){const params=super.getTemplateParameters();return params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,VIVID_FILLS.BLUE),params.set(DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,VIVID_FILLS.BLUE),params}},__name(_a268,"VividLight"),_a268),lightTheme=simpleMemorize(()=>new ChartTheme),darkTheme=simpleMemorize(()=>new DarkTheme),themeCacheDebug=Debug.create(!0,"perf"),cacheCallback=__name((status,fn,keys)=>{themeCacheDebug("[CACHE] ChartTheme",status,fn.name,keys)},"cacheCallback"),themes={"ag-default-dark":darkTheme,"ag-sheets-dark":simpleMemorize(()=>new SheetsDark,cacheCallback),"ag-polychroma-dark":simpleMemorize(()=>new PolychromaDark,cacheCallback),"ag-vivid-dark":simpleMemorize(()=>new VividDark,cacheCallback),"ag-material-dark":simpleMemorize(()=>new MaterialDark,cacheCallback),"ag-financial-dark":simpleMemorize(()=>new FinancialDark,cacheCallback),null:lightTheme,undefined:lightTheme,"ag-default":lightTheme,"ag-sheets":simpleMemorize(()=>new SheetsLight,cacheCallback),"ag-polychroma":simpleMemorize(()=>new PolychromaLight,cacheCallback),"ag-vivid":simpleMemorize(()=>new VividLight,cacheCallback),"ag-material":simpleMemorize(()=>new MaterialLight,cacheCallback),"ag-financial":simpleMemorize(()=>new FinancialLight,cacheCallback)},getChartTheme=simpleMemorize(createChartTheme,cacheCallback);function createChartTheme(value){if(value instanceof ChartTheme)return value;if(value==null||typeof value=="string"){const stockTheme=themes[value];return stockTheme?stockTheme():(logger_exports.warnOnce(`the theme [${value}] is invalid, using [ag-default] instead.`),lightTheme())}const{errors}=validate(value,themeOptionsDef,"theme");if(!errors.length){const flattenedTheme=reduceThemeOptions(value),baseTheme=flattenedTheme.baseTheme?getChartTheme(flattenedTheme.baseTheme):lightTheme();return new baseTheme.constructor(flattenedTheme)}for(const{message}of errors)logger_exports.warnOnce(message);return lightTheme()}__name(createChartTheme,"createChartTheme");function reduceThemeOptions(options){let maybeNested=options,palette2,params;const overrides=[];for(;typeof maybeNested=="object";)palette2??(palette2=maybeNested.palette),params??(params=maybeNested.params),maybeNested.overrides&&overrides.push(maybeNested.overrides),maybeNested=maybeNested.baseTheme;return{baseTheme:maybeNested,overrides:mergeDefaults(...overrides),params,palette:palette2}}__name(reduceThemeOptions,"reduceThemeOptions");var themeOptionsDef={baseTheme:or(string,object),overrides:object,params:{accentColor:color,axisColor:color,backgroundColor:color,borderColor:color,foregroundColor:color,fontFamily:string,fontSize:number,fontWeight:or(string,number),gridLineColor:color,padding:number,subtleTextColor:color,textColor:color,chromeBackgroundColor:color,chromeFontFamily:string,chromeFontSize:number,chromeFontWeight:or(string,number),chromeSubtleTextColor:color,chromeTextColor:color,inputBackgroundColor:color,inputTextColor:color,crosshairLabelBackgroundColor:color,crosshairLabelTextColor:color},palette:{fills:arrayOf(colorUnion),strokes:arrayOf(color),up:{fill:or(color,gradientStrict),stroke:color},down:{fill:or(color,gradientStrict),stroke:color},neutral:{fill:or(color,gradientStrict),stroke:color}}},stringFormat=__name(value=>`'${value}'`,"stringFormat"),_a269,_ChartOptions=(_a269=class{constructor(currentUserOptions,newUserOptions,processedOverrides,specialOverrides,metadata,deltaOptions,stripSymbols=!1){this.themeParameters={},this.optionMetadata=metadata??{},this.processedOverrides=processedOverrides??{};let baseChartOptions=null;currentUserOptions instanceof _a269?(baseChartOptions=currentUserOptions,this.specialOverrides=baseChartOptions.specialOverrides,deltaOptions===void 0&&(deltaOptions=jsonDiff(baseChartOptions.userOptions,newUserOptions,_a269.JSON_DIFF_OPTS)),this.userOptions=deepClone(merge(deltaOptions,baseChartOptions.userOptions),_a269.OPTIONS_CLONE_OPTS)):(this.userOptions=deepClone(currentUserOptions??newUserOptions,_a269.OPTIONS_CLONE_OPTS),this.specialOverrides=this.specialOverridesDefaults({...specialOverrides})),stripSymbols&&this.removeLeftoverSymbols(this.userOptions);let activeTheme,processedOptions,defaultAxes,fastDelta,themeParameters,annotationThemes;!stripSymbols&&deltaOptions!==void 0&&_a269.isFastPathDelta(deltaOptions)&&baseChartOptions!=null?({activeTheme,processedOptions,defaultAxes,fastDelta}=this.fastSetup(deltaOptions,baseChartOptions),themeParameters=baseChartOptions.themeParameters,annotationThemes=baseChartOptions.annotationThemes):(_a269.perfDebug("ChartOptions.slowSetup()"),{activeTheme,processedOptions,defaultAxes,themeParameters,annotationThemes}=this.slowSetup(processedOverrides,deltaOptions,stripSymbols)),this.activeTheme=activeTheme,this.processedOptions=processedOptions,this.defaultAxes=defaultAxes,this.fastDelta=fastDelta??void 0,this.themeParameters=themeParameters,this.annotationThemes=annotationThemes,Debug.inDevelopmentMode(()=>deepFreeze(this))}static isFastPathDelta(deltaOptions){for(const key of Object.keys(deltaOptions??{}))if(!this.FAST_PATH_OPTIONS.has(key))return _a269.perfDebug("ChartOptions.isFastPathDelta() - slow path required due to presence of: ",key),!1;return _a269.perfDebug("ChartOptions.isFastPathDelta() - fast path possible."),!0}fastSetup(deltaOptions,baseChartOptions){const{activeTheme,defaultAxes,processedOptions:baseOptions}=baseChartOptions,{presetType}=this.optionMetadata,processor=presetType?PRESET_DATA_PROCESSORS[presetType]:void 0;if(presetType!=null&&(deltaOptions==null?void 0:deltaOptions.data)!=null&&processor!=null){const{series,data}=processor(deltaOptions.data);deltaOptions=mergeDefaults({series,data},deltaOptions)}this.fastSeriesSetup(deltaOptions,baseOptions);const processedOptions=mergeDefaults(deltaOptions,baseOptions);return _a269.debug("ChartOptions.fastSetup() - processed options",processedOptions),{activeTheme,defaultAxes,processedOptions,fastDelta:deltaOptions}}fastSeriesSetup(deltaOptions,baseOptions){var _a294;deltaOptions!=null&&deltaOptions.series&&((_a294=deltaOptions.series)!=null&&_a294.every((s,i)=>{var _a295;return jsonPropertyCompare(s,((_a295=baseOptions.series)==null?void 0:_a295[i])??{})})?delete deltaOptions.series:deltaOptions.series=deltaOptions.series.map((s,i)=>{var _a295;return merge(s,((_a295=baseOptions.series)==null?void 0:_a295[i])??{})}))}slowSetup(processedOverrides,deltaOptions,stripSymbols=!1){var _a294,_b;let options=deepClone(this.userOptions,_a269.OPTIONS_CLONE_OPTS);deltaOptions&&(options=mergeDefaults(deltaOptions,options),stripSymbols&&this.removeLeftoverSymbols(options));const{presetType}=this.optionMetadata;if(presetType!=null){const presetConstructor=PRESETS[presetType],presetParams=options,presetSubType=options.type,presetTheme=presetSubType!=null?getChartTheme(options.theme).presets[presetSubType]:void 0;_a269.debug(">>> AgCharts.createOrUpdate() - applying preset",presetParams),options=(presetConstructor==null?void 0:presetConstructor(presetParams,presetTheme,()=>this.activeTheme))??options}this.soloSeriesIntegrity(options),enterpriseModule.isEnterprise||removeUsedEnterpriseOptions(options);const activeTheme=getChartTheme(options.theme);if(presetType!=null&&activeTheme.templateTheme(options,!1),this.validateSeriesOptions(options),this.chartDef=moduleRegistry_exports.detectChartDefinition(options),!this.chartDef.placeholder){const{valid,errors}=validate(options,this.chartDef.options);errors.forEach(error=>logger_exports.warn(error)),options=valid}this.validatePluginOptions(options),this.validateAxesOptions(options),this.removeDisabledOptions(options);const seriesType=this.optionsType(options),{annotations={},axes:axesThemes={},series:seriesTheme,...themeDefaults}=this.getSeriesThemeConfig(seriesType,activeTheme),[annotationsOptions,annotationsThemes]=this.splitAnnotationsOptions(annotations),annotationThemes=deepClone(annotationsThemes),defaultAxes=this.getDefaultAxes(options,seriesTheme);let processedOptions=mergeDefaults(processedOverrides,options,annotationsOptions,themeDefaults,defaultAxes);this.processAxesOptions(processedOptions,axesThemes),this.processSeriesOptions(processedOptions,activeTheme),processedOptions=deepClone(processedOptions,_a269.OPTIONS_CLONE_OPTS),(isAgCartesianChartOptions(processedOptions)||isAgStandaloneChartOptions(processedOptions)||isAgPolarChartOptionsWithSeriesBasedLegend(processedOptions))&&((_a294=processedOptions.legend)==null?void 0:_a294.enabled)==null&&(processedOptions.legend??(processedOptions.legend={}),processedOptions.legend.enabled=processedOptions.series.length>1),this.enableConfiguredOptions(processedOptions,options);const themeParameters=this.getThemeParameters(activeTheme,processedOptions);return themeParameters.__palette=deepClone(activeTheme.palette),themeParameters.__palette.type=isObject(options.theme)?paletteType((_b=options.theme)==null?void 0:_b.palette):"inbuilt",this.resolveThemeOperations(themeParameters,themeParameters),this.resolveThemeOperations(themeParameters,processedOptions),this.resolveThemeOperations(themeParameters,annotationThemes),this.processMiniChartSeriesOptions(processedOptions),activeTheme.templateTheme(processedOptions,!1),removeUnusedEnterpriseOptions(processedOptions),enterpriseModule.isEnterprise||removeUsedEnterpriseOptions(processedOptions,!0),this.validateSeriesOptions(processedOptions),this.validateAxesOptions(processedOptions),_a269.debug(()=>["ChartOptions.slowSetup() - processed options",deepClone(processedOptions)]),{activeTheme,processedOptions,defaultAxes,themeParameters,annotationThemes}}validatePluginOptions(options){var _a294;for(const pluginDef of moduleRegistry_exports.listModulesByType(ModuleType.Plugin)){const pluginKey=pluginDef.name;if(pluginKey in options&&(!pluginDef.chartType||pluginDef.chartType===((_a294=this.chartDef)==null?void 0:_a294.name))){const{valid,errors}=validate(options[pluginKey],pluginDef.options,pluginDef.name);errors.forEach(error=>logger_exports.warn(error)),options[pluginKey]=valid}}}validateSeriesOptions(options){var _a294,_b;const chartType=(_a294=this.chartDef)==null?void 0:_a294.name,validatedSeriesOptions=[],seriesCount=((_b=options.series)==null?void 0:_b.length)??0;let validSeriesTypes;for(let index=0;index<seriesCount;index++){const keyPath=`series[${index}]`,seriesOptions=options.series[index],seriesDef=moduleRegistry_exports.getSeriesModule(seriesOptions.type??"line");if(seriesDef==null){validSeriesTypes??(validSeriesTypes=joinFormatted(Array.from(moduleRegistry_exports.listModulesByType(ModuleType.Series)).filter(def=>!chartType||def.chartType===chartType).map(def=>def.name),"or",stringFormat)),logger_exports.warn(`Unknown type \`${seriesOptions.type}\` at \`${keyPath}.type\`; expecting ${validSeriesTypes}, ignoring.`);continue}else if(chartType&&seriesDef.chartType!==chartType){logger_exports.warn(`Series type \`${seriesDef.name}\` at \`${keyPath}.type\` is not supported by chart type \`${chartType}\`, ignoring.`);continue}const{validate:validateSeries=validate}=seriesDef,{valid,errors}=validateSeries(seriesOptions,seriesDef.options,keyPath);errors.forEach(error=>logger_exports.warn(error)),errors.some(e=>e.required&&e.path===keyPath)||validatedSeriesOptions.push(valid)}options.series=validatedSeriesOptions}validateAxesOptions(options){var _a294;if(!("axes"in options)||!options.axes)return;const chartType=(_a294=this.chartDef)==null?void 0:_a294.name,validatedAxesOptions=[],axesCount=options.axes.length??0;let validAxesTypes;for(let index=0;index<axesCount;index++){const keyPath=`axes[${index}]`,axisOptions=options.axes[index],axisDef=moduleRegistry_exports.getAxisModule(axisOptions.type);if(axisDef==null){validAxesTypes??(validAxesTypes=joinFormatted(Array.from(moduleRegistry_exports.listModulesByType(ModuleType.Axis)).filter(def=>def.chartType===chartType).map(def=>def.name),"or",stringFormat)),logger_exports.warn(`Unknown type \`${axisOptions.type}\` at  \`${keyPath}.type\`; expecting one of ${validAxesTypes}, ignoring all axes options.`),delete options.axes;break}else if(axisDef.chartType!==chartType){logger_exports.warn(`Axis type \`${axisDef.name}\` at  \`${keyPath}.type\` is not supported by chart type \`${chartType}\`, ignoring.`);break}const{validate:validateAxis=validate}=axisDef,{valid,errors}=validateAxis(axisOptions,axisDef.options,keyPath);errors.forEach(error=>logger_exports.warn(error)),errors.some(e=>e.required&&e.path===keyPath)||validatedAxesOptions.push(valid)}options.axes=validatedAxesOptions}diffOptions(other){return this===other?{}:other==null?this.processedOptions:this.fastDelta??jsonDiff(other.processedOptions,this.processedOptions,_a269.JSON_DIFF_OPTS)}getSeriesThemeConfig(seriesType,activeTheme){return(activeTheme==null?void 0:activeTheme.config[seriesType])??{}}getDefaultAxes(options,seriesTheme){var _a294;const optionsType2=this.optionsType(options),firstSeriesOptions=((_a294=options.series)==null?void 0:_a294.find(series=>(series.type??"line")===optionsType2))??{},axes=seriesRegistry.cloneDefaultAxes(optionsType2);return jsonResolveOperations(axes,{},void 0,mergeDefaults(firstSeriesOptions,seriesTheme)),axes}optionsType(options){var _a294,_b;return((_b=(_a294=options.series)==null?void 0:_a294[0])==null?void 0:_b.type)??"line"}splitAnnotationsOptions(annotations){const{axesButtons=null,enabled=null,optionsToolbar=null,toolbar=null,...annotationsThemes}=annotations;return axesButtons==null&&enabled==null&&optionsToolbar==null&&toolbar==null?[{},annotationsThemes]:[{annotations:{axesButtons,enabled,optionsToolbar,toolbar}},annotationsThemes]}processAxesOptions(options,axesThemes){var _a294;"axes"in options&&(options.axes=(_a294=options.axes)==null?void 0:_a294.map(axis=>{var _a295,_b,_c;const{crossLines:crossLinesTheme,...axisTheme}=mergeDefaults((_a295=axesThemes[axis.type])==null?void 0:_a295[axis.position],axesThemes[axis.type]);axis.crossLines&&(axis.crossLines=mergeArrayDefaults(axis.crossLines,crossLinesTheme));const gridLineStyle=(_b=axisTheme.gridLine)==null?void 0:_b.style;(_c=axis.gridLine)!=null&&_c.style&&(gridLineStyle!=null&&gridLineStyle.length)&&(axis.gridLine.style=axis.gridLine.style.map((style,index)=>style.stroke!=null||style.lineDash!=null?mergeDefaults(style,gridLineStyle.at(index%gridLineStyle.length)):style));const{top:_1,right:_2,bottom:_3,left:_4,...axisOptions}=mergeDefaults(axis,axisTheme);return axisOptions}))}processSeriesOptions(options,activeTheme){var _a294;const defaultTooltipPosition=this.getTooltipPositionDefaults(options),processedSeries=(_a294=options.series)==null?void 0:_a294.map(series=>{series.type??(series.type="line");const{innerLabels:innerLabelsTheme,...seriesTheme}=this.getSeriesThemeConfig(series.type,activeTheme).series??{},seriesDef=moduleRegistry_exports.getSeriesModule(series.type),tooltipDefined=!!(seriesDef!=null&&seriesDef.options.tooltip),visibleDefined=!!(seriesDef!=null&&seriesDef.options.visible),defaultTooltipRange=tooltipDefined&&this.getTooltipRangeDefaults(options,series.type),seriesOptions=mergeDefaults(this.getSeriesGroupingOptions(series),series,tooltipDefined&&defaultTooltipPosition,defaultTooltipRange,seriesTheme,visibleDefined&&{visible:!0});return seriesOptions.innerLabels&&(seriesOptions.innerLabels=mergeArrayDefaults(seriesOptions.innerLabels,innerLabelsTheme)),seriesOptions});options.series=this.setSeriesGroupingOptions(processedSeries??[])}processMiniChartSeriesOptions(options){var _a294,_b;let miniChartSeries=(_b=(_a294=options.navigator)==null?void 0:_a294.miniChart)==null?void 0:_b.series;miniChartSeries!=null&&(miniChartSeries=miniChartSeries.map(series=>(series.type??(series.type="line"),series)),options.navigator.miniChart.series=this.setSeriesGroupingOptions(miniChartSeries))}getThemeParameters(theme,options){const defaultParameters=theme.getPublicParameters();if(!isPlainObject(options.theme)||!options.theme.params)return defaultParameters;const{valid,errors}=validate(options.theme.params,themeOptionsDef.params);for(const{message}of errors)logger_exports.warnOnce(message);return mergeDefaults(valid,defaultParameters)}resolveThemeOperations(params,options){const modifiedPaths=jsonResolveOperations(options,params,new Set(["palette","data","theme"]));_a269.debug("ChartOptions.resolveTheme()",modifiedPaths)}getSeriesGroupingOptions(series){const groupable=seriesRegistry.isGroupable(series.type),stackable=seriesRegistry.isStackable(series.type),stackedByDefault=seriesRegistry.isStackedByDefault(series.type);series.grouped&&!groupable&&logger_exports.warnOnce(`unsupported grouping of series type "${series.type}".`),(series.stacked||series.stackGroup)&&!stackable&&logger_exports.warnOnce(`unsupported stacking of series type "${series.type}".`);let{grouped,stacked}=series;return stacked??(stacked=(stackedByDefault||series.stackGroup!=null)&&!(groupable&&grouped)),grouped??(grouped=!0),{stacked:stackable&&stacked,grouped:groupable&&grouped&&!(stackable&&stacked)}}setSeriesGroupingOptions(allSeries){const seriesGroups=this.getSeriesGrouping(allSeries);_a269.debug("ChartOptions.setSeriesGroupingOptions() - series grouping: ",seriesGroups);const groupIdx={},groupCount2=seriesGroups.reduce((countMap,seriesGroup)=>{var _a294;return seriesGroup.groupType==="default"||(countMap[_a294=seriesGroup.seriesType]??(countMap[_a294]=0),countMap[seriesGroup.seriesType]+=seriesGroup.groupType==="stack"?1:seriesGroup.series.length),countMap},{});return seriesGroups.flatMap(seriesGroup=>{var _a294;switch(groupIdx[_a294=seriesGroup.seriesType]??(groupIdx[_a294]=0),seriesGroup.groupType){case"stack":{const groupIndex=groupIdx[seriesGroup.seriesType]++;return seriesGroup.series.map((series,stackIndex)=>Object.assign(series,{seriesGrouping:{groupId:seriesGroup.groupId,groupIndex,groupCount:groupCount2[seriesGroup.seriesType],stackIndex,stackCount:seriesGroup.series.length}}))}case"group":return seriesGroup.series.map(series=>Object.assign(series,{seriesGrouping:{groupId:seriesGroup.groupId,groupIndex:groupIdx[seriesGroup.seriesType]++,groupCount:groupCount2[seriesGroup.seriesType],stackIndex:0,stackCount:0}}))}return seriesGroup.series}).map(({stacked:_,grouped:__,...seriesOptions})=>seriesOptions)}getSeriesGroupId(series){return[series.type,series.xKey,series.stacked?series.stackGroup??"stacked":"grouped"].filter(Boolean).join("-")}getSeriesGrouping(allSeries){const groupMap=new Map;return allSeries.reduce((result,series)=>{const seriesType=series.type;if(!series.stacked&&!series.grouped)result.push({groupType:"default",seriesType,series:[series],groupId:"__default__"});else{const groupId=this.getSeriesGroupId(series);if(!groupMap.has(groupId)){const record={groupType:series.stacked?"stack":"group",seriesType,series:[],groupId};groupMap.set(groupId,record),result.push(record)}groupMap.get(groupId).series.push(series)}return result},[])}getTooltipPositionDefaults(options){var _a294;const position=(_a294=options.tooltip)==null?void 0:_a294.position;if(!isPlainObject(position))return;const{type,anchorTo,placement,xOffset,yOffset}=position,result={};return isString(type)&&isEnumValue(AgTooltipPositionType,type)&&(result.type=type),isString(anchorTo)&&isEnumValue(AgTooltipAnchorToType,anchorTo)&&(result.anchorTo=anchorTo),isString(placement)&&isEnumValue(AgTooltipPlacementType,placement)&&(result.placement=placement),isFiniteNumber(xOffset)&&(result.xOffset=xOffset),isFiniteNumber(yOffset)&&(result.yOffset=yOffset),{tooltip:{position:result}}}getTooltipRangeDefaults(options,seriesType){var _a294,_b;return{tooltip:{range:((_a294=options.tooltip)==null?void 0:_a294.range)??((_b=seriesRegistry.getTooltipDefauls(seriesType))==null?void 0:_b.range)}}}soloSeriesIntegrity(options){if(!isArray(options.series))return;const allSeries=options.series;if(allSeries&&allSeries.length>1&&allSeries.some(series=>seriesRegistry.isSolo(series.type))){const mainSeriesType=this.optionsType(options);if(seriesRegistry.isSolo(mainSeriesType))logger_exports.warn(`series[0] of type '${mainSeriesType}' is incompatible with other series types. Only processing series[0]`),options.series=allSeries.slice(0,1);else{const{solo,nonSolo}=groupBy(allSeries,s=>seriesRegistry.isSolo(s.type)?"solo":"nonSolo"),rejects=unique(solo.map(s=>s.type)).join(", ");logger_exports.warn(`Unable to mix these series types with the lead series type: ${rejects}`),options.series=nonSolo}}}static enableConfiguredJsonOptions(visitingUserOpts,visitingMergedOpts){typeof visitingMergedOpts=="object"&&"enabled"in visitingMergedOpts&&!visitingMergedOpts._enabledFromTheme&&visitingUserOpts.enabled==null&&(visitingMergedOpts.enabled=!0)}static cleanupEnabledFromThemeJsonOptions(visitingMergedOpts){visitingMergedOpts._enabledFromTheme!=null&&delete visitingMergedOpts._enabledFromTheme}enableConfiguredOptions(options,userOptions){jsonWalk(userOptions,_a269.enableConfiguredJsonOptions,new Set(["data","theme"]),options),jsonWalk(options,_a269.cleanupEnabledFromThemeJsonOptions,new Set(["data","theme"]))}static removeDisabledOptionJson(optionsNode){"enabled"in optionsNode&&optionsNode.enabled===!1&&Object.keys(optionsNode).forEach(key=>{key!=="enabled"&&delete optionsNode[key]})}removeDisabledOptions(options){jsonWalk(options,_a269.removeDisabledOptionJson,new Set(["data","theme"]))}static removeLeftoverSymbolsJson(optionsNode){if(!(!optionsNode||!isObject(optionsNode)))for(const key of Object.keys(optionsNode)){const value=optionsNode[key];isSymbol(value)&&delete optionsNode[key]}}removeLeftoverSymbols(options){jsonWalk(options,_a269.removeLeftoverSymbolsJson,new Set(["data"]))}specialOverridesDefaults(options){if(options.window==null?options.window=getWindow():setWindow(options.window),options.document==null?options.document=getDocument():setDocument(options.document),options.window==null)throw new Error("AG Charts - unable to resolve global window");if(options.document==null)throw new Error("AG Charts - unable to resolve global document");return options}},__name(_a269,"_ChartOptions"),_a269);_ChartOptions.OPTIONS_CLONE_OPTS={shallow:new Set(["data","container"]),assign:new Set(["context","theme"])};_ChartOptions.JSON_DIFF_OPTS=new Set(["data"]);_ChartOptions.perfDebug=Debug.create(!0,"perf");_ChartOptions.FAST_PATH_OPTIONS=new Set(["data","width","height","container"]);_ChartOptions.debug=Debug.create(!0,"opts");var ChartOptions=_ChartOptions,CLEANUP_TIMEOUT_MS=1e3,_a270,_Pool=(_a270=class{constructor(name,buildItem,releaseItem,destroyItem,maxPoolSize,cleanupTimeMs=CLEANUP_TIMEOUT_MS){this.name=name,this.buildItem=buildItem,this.releaseItem=releaseItem,this.destroyItem=destroyItem,this.maxPoolSize=maxPoolSize,this.cleanupTimeMs=cleanupTimeMs,this.freePool=[],this.busyPool=new Set}static getPool(name,buildItem,releaseItem,destroyItem,maxPoolSize){return this.pools.has(name)||this.pools.set(name,new _a270(name,buildItem,releaseItem,destroyItem,maxPoolSize)),this.pools.get(name)}isFull(){return this.freePool.length+this.busyPool.size>=this.maxPoolSize}hasFree(){return this.freePool.length>0}obtain(params){if(!this.hasFree()&&this.isFull())throw new Error("AG Charts - pool exhausted");let nextFree=this.freePool.pop();return nextFree==null?(nextFree=this.buildItem(params),_a270.debug(()=>[`Pool[name=${this.name}]: Created instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,nextFree])):_a270.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,nextFree]),this.busyPool.add(nextFree),{item:nextFree,release:__name(()=>this.release(nextFree),"release")}}obtainFree(){const nextFree=this.freePool.pop();if(nextFree==null)throw new Error("AG Charts - pool has no free instances");return _a270.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,nextFree]),this.busyPool.add(nextFree),{item:nextFree,release:__name(()=>this.release(nextFree),"release")}}release(item){if(!this.busyPool.has(item))throw new Error("AG Charts - cannot free item from pool which is not tracked as busy.");_a270.debug(()=>[`Pool[name=${this.name}]: Releasing instance (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,item]),this.releaseItem(item),this.busyPool.delete(item),this.freePool.push(item),_a270.debug(()=>[`Pool[name=${this.name}]: Returned instance to free pool (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,item]);const now=Date.now(),earliestClean=now+this.cleanupTimeMs*.5;this.cleanPoolTimer&&(this.cleanPoolDue??1/0)<earliestClean&&(clearTimeout(this.cleanPoolTimer),this.cleanPoolTimer=void 0),this.cleanPoolTimer||(this.cleanPoolDue=now+this.cleanupTimeMs,this.cleanPoolTimer=setTimeout(this.cleanPool.bind(this),this.cleanupTimeMs))}cleanPool(){const itemsToFree=this.freePool.splice(0);for(const item of itemsToFree)this.destroyItem(item);_a270.debug(()=>[`Pool[name=${this.name}]: Cleaned pool of ${itemsToFree.length} items (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`])}destroy(){this.cleanPool();for(const item of this.busyPool.values())this.destroyItem(item);this.busyPool.clear()}},__name(_a270,"_Pool"),_a270);_Pool.pools=new Map;_Pool.debug=Debug.create(!0,"pool");var Pool=_Pool;moduleRegistry_exports.registerMany(AllCommunityModules);var debug3=Debug.create(!0,"opts"),_a271,AgCharts=(_a271=class{static licenseCheck(options){var _a294,_b;this.licenseChecked||(this.licenseManager=(_a294=enterpriseModule.licenseManager)==null?void 0:_a294.call(enterpriseModule,options),(_b=this.licenseManager)==null||_b.validateLicense(),this.licenseChecked=!0)}static getLicenseDetails(licenseKey){var _a294;return(_a294=enterpriseModule.licenseManager)==null?void 0:_a294.call(enterpriseModule,{}).getLicenseDetails(licenseKey)}static getInstance(element2){return AgChartsInternal.getInstance(element2)}static create(userOptions,optionsMetadata){return debug3.group("AgCharts.create()",()=>{var _a294,_b;userOptions=Debug.inDevelopmentMode(()=>deepFreeze(deepClone(userOptions)))??userOptions,this.licenseCheck(userOptions);const chart=AgChartsInternal.createOrUpdate({userOptions,licenseManager:this.licenseManager,optionsMetadata});return(_a294=this.licenseManager)!=null&&_a294.isDisplayWatermark()&&this.licenseManager&&((_b=enterpriseModule.injectWatermark)==null||_b.call(enterpriseModule,chart.chart.ctx.domManager,this.licenseManager.getWatermarkMessage())),chart})}static createFinancialChart(options){return debug3.group("AgCharts.createFinancialChart()",()=>this.create(options,{presetType:"price-volume"}))}static createGauge(options){return debug3.group("AgCharts.createGauge()",()=>this.create(options,{presetType:"gauge"}))}static __createSparkline(options){return debug3.group("AgCharts.__createSparkline()",()=>{const{pool,...normalOptions}=options;return this.create(normalOptions,{presetType:"sparkline",pool:pool??!0,domMode:"minimal"})})}},__name(_a271,"AgCharts"),_a271);AgCharts.licenseChecked=!1;var _a272,_AgChartsInternal=(_a272=class{static getInstance(element2){const chart=Chart.getInstance(element2);return chart?AgChartInstanceProxy.chartInstances.get(chart):void 0}static initialiseModules(){_a272.initialised||(registerInbuiltModules(),setupModules(),_a272.initialised=!0)}static createOrUpdate(opts){var _a294,_b,_c,_d,_e;let{proxy}=opts;const{userOptions,licenseManager,processedOverrides=((_a294=proxy==null?void 0:proxy.chart)==null?void 0:_a294.chartOptions.processedOverrides)??{},specialOverrides=((_b=proxy==null?void 0:proxy.chart)==null?void 0:_b.chartOptions.specialOverrides)??{},optionsMetadata=((_c=proxy==null?void 0:proxy.chart)==null?void 0:_c.chartOptions.optionMetadata)??{},deltaOptions,stripSymbols=!1}=opts,styles=enterpriseModule.styles!=null?[["ag-charts-enterprise",enterpriseModule.styles]]:[],{presetType}=optionsMetadata;_a272.initialiseModules(),debug3(()=>[">>> AgCharts.createOrUpdate() user options",deepClone(userOptions)]);let mutableOptions=userOptions;AgCharts.optionsMutationFn&&mutableOptions&&(mutableOptions=AgCharts.optionsMutationFn(deepClone(mutableOptions),presetType),debug3(()=>[">>> AgCharts.createOrUpdate() MUTATED user options",deepClone(mutableOptions)]));const pool=this.getPool(optionsMetadata);let create=!1,poolResult,chart=proxy==null?void 0:proxy.chart;chart==null&&(pool!=null&&pool.hasFree())&&(poolResult=pool.obtainFree(),chart=poolResult.item);const{document:document2,window:userWindow,styleContainer,...options}=mutableOptions??{},baseOptions=chart==null?void 0:chart.getChartOptions(),chartOptions=new ChartOptions(baseOptions,options,processedOverrides,{...specialOverrides,document:document2,window:userWindow,styleContainer},optionsMetadata,deltaOptions,stripSymbols);return(chart==null||moduleRegistry_exports.detectChartDefinition(chartOptions.processedOptions)!==moduleRegistry_exports.detectChartDefinition(chart.chartOptions.processedOptions))&&(poolResult==null||poolResult.release(),poolResult=(_d=this.getPool(chartOptions.optionMetadata))==null?void 0:_d.obtain(chartOptions),poolResult?chart=poolResult.item:(create=!0,chart=_a272.createChartInstance(chartOptions,chart))),styles.forEach(([id,css])=>{chart.ctx.domManager.addStyles(id,css)}),proxy==null?(proxy=new AgChartInstanceProxy(chart,_a272.callbackApi,licenseManager),proxy.releaseChart=poolResult==null?void 0:poolResult.release):(poolResult||create)&&((_e=proxy.releaseChart)==null||_e.call(proxy),proxy.chart=chart,proxy.releaseChart=poolResult==null?void 0:poolResult.release),debug3.check()&&typeof window<"u"&&(window.agChartInstances??(window.agChartInstances={}),window.agChartInstances[chart.id]=chart),chart.queuedUserOptions.push(chartOptions.userOptions),chart.queuedChartOptions.push(chartOptions),chart.requestFactoryUpdate(chartRef=>{debug3.group(">>>> Chart.applyOptions()",()=>{chartRef.applyOptions(chartOptions);const queueIdx=chartRef.queuedUserOptions.indexOf(chartOptions.userOptions)+1;chartRef.queuedUserOptions.splice(0,queueIdx),chartRef.queuedChartOptions.splice(0,queueIdx)})}),proxy}static markRemovedProperties(node,_,modified=!1){if(typeof node!="object")return modified;for(const key of Object.keys(node))typeof node[key]>"u"&&(Object.assign(node,{[key]:Symbol("UNSET")}),modified||(modified=!0));return modified}static updateUserDelta(proxy,deltaOptions){deltaOptions=deepClone(deltaOptions,ChartOptions.OPTIONS_CLONE_OPTS);const stripSymbols=jsonWalk(deltaOptions,_a272.markRemovedProperties,new Set(["data"]),void 0,void 0,!1);debug3(()=>[">>> AgCharts.updateUserDelta() user delta",deepClone(deltaOptions)]),_a272.createOrUpdate({proxy,deltaOptions,stripSymbols})}static createChartInstance(options,oldChart){const transferableResource=oldChart==null?void 0:oldChart.destroy({keepTransferableResources:!0});return moduleRegistry_exports.detectChartDefinition(options.processedOptions).create(options,transferableResource)}static getPool(optionMetadata){if(optionMetadata.pool===!0)return Pool.getPool(optionMetadata.presetType??"default",this.createChartInstance,this.detachAndClear,this.destroy,1/0)}},__name(_a272,"_AgChartsInternal"),_a272);_AgChartsInternal.caretaker=new MementoCaretaker(VERSION);_AgChartsInternal.initialised=!1;_AgChartsInternal.callbackApi={caretaker:_AgChartsInternal.caretaker,create(userOptions,processedOverrides,specialOverrides,optionsMetadata){return _AgChartsInternal.createOrUpdate({userOptions,processedOverrides,specialOverrides,optionsMetadata})},update(opts,chart){return _AgChartsInternal.createOrUpdate({userOptions:opts,proxy:chart})},updateUserDelta(chart,deltaOptions){return _AgChartsInternal.updateUserDelta(chart,deltaOptions)}};_AgChartsInternal.detachAndClear=chart=>chart.detachAndClear();_AgChartsInternal.destroy=chart=>chart.destroy();var AgChartsInternal=_AgChartsInternal,integrated_charts_scene_exports={};__export(integrated_charts_scene_exports,{Arc:__name(()=>Arc2,"Arc"),BBox:__name(()=>BBox,"BBox"),Caption:__name(()=>Caption,"Caption"),CategoryScale:__name(()=>CategoryScale,"CategoryScale"),Group:__name(()=>Group,"Group"),Line:__name(()=>Line,"Line"),LinearScale:__name(()=>LinearScale,"LinearScale"),Marker:__name(()=>Marker,"Marker"),Path:__name(()=>Path,"Path"),RadialColumnShape:__name(()=>RadialColumnShape,"RadialColumnShape"),Rect:__name(()=>Rect,"Rect"),Scene:__name(()=>Scene,"Scene"),Sector:__name(()=>Sector,"Sector"),Shape:__name(()=>Shape,"Shape"),TranslatableGroup:__name(()=>TranslatableGroup,"TranslatableGroup"),getRadialColumnWidth:__name(()=>getRadialColumnWidth,"getRadialColumnWidth"),toRadians:__name(()=>toRadians,"toRadians")});var _a273,Arc2=(_a273=class extends Path{constructor(){super(),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0,this.restoreOwnStyles()}get fullPie(){return isNumberEqual(normalizeAngle360(this.startAngle),normalizeAngle360(this.endAngle))}updatePath(){const path=this.path;path.clear(),path.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?path.closePath():this.type===2&&!this.fullPie&&(path.lineTo(this.centerX,this.centerY),path.closePath())}computeBBox(){return new BBox(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(x,y){const bbox=this.getBBox();return this.type!==0&&bbox.containsPoint(x,y)&&this.path.isPointInPath(x,y)}},__name(_a273,"Arc2"),_a273);Arc2.className="Arc";__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"centerX",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"centerY",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"radius",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"counterClockwise",2);__decorateClass([ScenePathChangeDetection()],Arc2.prototype,"type",2);function rotatePoint(x,y,rotation){const radius=Math.sqrt(x**2+y**2),rotated=Math.atan2(y,x)+rotation;return{x:Math.cos(rotated)*radius,y:Math.sin(rotated)*radius}}__name(rotatePoint,"rotatePoint");var _a274,RadialColumnShape=(_a274=class extends Path{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}set cornerRadius(_value){}computeBBox(){const{innerRadius,outerRadius,columnWidth}=this,rotation=this.getRotation(),left=-columnWidth/2,right=columnWidth/2,top=-outerRadius,bottom=-innerRadius;let x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(let i=0;i<4;i+=1){const{x,y}=rotatePoint(i%2===0?left:right,i<2?top:bottom,rotation);x0=Math.min(x,x0),y0=Math.min(y,y0),x1=Math.max(x,x1),y1=Math.max(y,y1)}return new BBox(x0,y0,x1-x0,y1-y0)}getRotation(){const{startAngle,endAngle}=this,midAngle=angleBetween(startAngle,endAngle);return normalizeAngle360(startAngle+midAngle/2+Math.PI/2)}updatePath(){const{isBeveled}=this;isBeveled?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth,innerRadius,outerRadius,path}=this,left=-columnWidth/2,right=columnWidth/2,top=-outerRadius,bottom=-innerRadius,rotation=this.getRotation(),points=[[left,bottom],[left,top],[right,top],[right,bottom]].map(([x,y])=>rotatePoint(x,y,rotation));path.clear(!0),path.moveTo(points[0].x,points[0].y),path.lineTo(points[1].x,points[1].y),path.lineTo(points[2].x,points[2].y),path.lineTo(points[3].x,points[3].y),path.closePath()}updateBeveledPath(){const{columnWidth,path,outerRadius,innerRadius,axisInnerRadius,axisOuterRadius,isRadiusAxisReversed}=this,isStackBottom=isNumberEqual(innerRadius,axisInnerRadius),sideRotation=Math.asin(columnWidth/2/innerRadius),pointRotation=this.getRotation(),rotate2=__name((x,y)=>rotatePoint(x,y,pointRotation),"rotate2"),getTriangleHypotenuse=__name((leg,otherLeg)=>Math.sqrt(leg**2+otherLeg**2),"getTriangleHypotenuse"),getTriangleLeg=__name((hypotenuse,otherLeg)=>otherLeg>hypotenuse?0:Math.sqrt(hypotenuse**2-otherLeg**2),"getTriangleLeg"),compare=__name((value,otherValue,lessThan4)=>lessThan4?value<otherValue:value>otherValue,"compare"),shouldConnectBottomCircle=isStackBottom&&!isNaN(sideRotation)&&sideRotation<Math.PI/6;let left=-columnWidth/2,right=columnWidth/2;const top=-outerRadius,bottom=-innerRadius*(shouldConnectBottomCircle?Math.cos(sideRotation):1),hasBottomIntersection=compare(axisOuterRadius,getTriangleHypotenuse(innerRadius,columnWidth/2),!isRadiusAxisReversed);if(hasBottomIntersection){const bottomIntersectionX=getTriangleLeg(axisOuterRadius,innerRadius);left=-bottomIntersectionX,right=bottomIntersectionX}path.clear(!0);const bottomLeftPt=rotate2(left,bottom);path.moveTo(bottomLeftPt.x,bottomLeftPt.y);const isEmpty2=isNumberEqual(innerRadius,outerRadius),hasSideIntersection=compare(axisOuterRadius,getTriangleHypotenuse(outerRadius,columnWidth/2),!isRadiusAxisReversed);if(isEmpty2&&shouldConnectBottomCircle)path.arc(0,0,innerRadius,normalizeAngle360(-sideRotation-Math.PI/2)+pointRotation,normalizeAngle360(sideRotation-Math.PI/2)+pointRotation,!1);else if(hasSideIntersection){const sideIntersectionY=-getTriangleLeg(axisOuterRadius,columnWidth/2),topIntersectionX=getTriangleLeg(axisOuterRadius,outerRadius);if(!hasBottomIntersection){const topLeftPt=rotate2(left,sideIntersectionY);path.lineTo(topLeftPt.x,topLeftPt.y)}if(path.arc(0,0,axisOuterRadius,Math.atan2(sideIntersectionY,left)+pointRotation,Math.atan2(top,-topIntersectionX)+pointRotation,!1),!isNumberEqual(topIntersectionX,0)){const topRightBevelPt=rotate2(topIntersectionX,top);path.lineTo(topRightBevelPt.x,topRightBevelPt.y)}path.arc(0,0,axisOuterRadius,Math.atan2(top,topIntersectionX)+pointRotation,Math.atan2(sideIntersectionY,right)+pointRotation,!1)}else{const topLeftPt=rotate2(left,top),topRightPt=rotate2(right,top);path.lineTo(topLeftPt.x,topLeftPt.y),path.lineTo(topRightPt.x,topRightPt.y)}const bottomRightPt=rotate2(right,bottom);if(path.lineTo(bottomRightPt.x,bottomRightPt.y),shouldConnectBottomCircle)path.arc(0,0,innerRadius,normalizeAngle360(sideRotation-Math.PI/2)+pointRotation,normalizeAngle360(-sideRotation-Math.PI/2)+pointRotation,!0);else{const rotatedBottomLeftPt=rotate2(left,bottom);path.lineTo(rotatedBottomLeftPt.x,rotatedBottomLeftPt.y)}path.closePath()}},__name(_a274,"RadialColumnShape"),_a274);RadialColumnShape.className="RadialColumnShape";__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isBeveled",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"columnWidth",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"outerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"innerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisInnerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisOuterRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isRadiusAxisReversed",2);function getRadialColumnWidth(startAngle,endAngle,axisOuterRadius,columnWidthRatio,maxColumnWidthRatio){const rotation=angleBetween(startAngle,endAngle),pad2=rotation*(1-columnWidthRatio)/2;if(startAngle+=pad2,endAngle-=pad2,rotation<.001)return 2*axisOuterRadius*maxColumnWidthRatio;if(rotation>=2*Math.PI){const midAngle=startAngle+rotation/2;startAngle=midAngle-Math.PI,endAngle=midAngle+Math.PI}const startX=axisOuterRadius*Math.cos(startAngle),startY=axisOuterRadius*Math.sin(startAngle),endX=axisOuterRadius*Math.cos(endAngle),endY=axisOuterRadius*Math.sin(endAngle),colWidth=Math.floor(Math.sqrt((startX-endX)**2+(startY-endY)**2)),maxWidth=2*axisOuterRadius*maxColumnWidthRatio;return Math.max(1,Math.min(maxWidth,colWidth))}__name(getRadialColumnWidth,"getRadialColumnWidth");var integrated_charts_theme_exports={};__export(integrated_charts_theme_exports,{ChartTheme:__name(()=>ChartTheme,"ChartTheme"),DEFAULT_ANNOTATION_HANDLE_FILL:__name(()=>DEFAULT_ANNOTATION_HANDLE_FILL,"DEFAULT_ANNOTATION_HANDLE_FILL"),DEFAULT_ANNOTATION_STATISTICS_COLOR:__name(()=>DEFAULT_ANNOTATION_STATISTICS_COLOR,"DEFAULT_ANNOTATION_STATISTICS_COLOR"),DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:__name(()=>DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,"DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE"),DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:__name(()=>DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,"DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL"),DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:__name(()=>DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,"DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE"),DEFAULT_ANNOTATION_STATISTICS_FILL:__name(()=>DEFAULT_ANNOTATION_STATISTICS_FILL,"DEFAULT_ANNOTATION_STATISTICS_FILL"),DEFAULT_ANNOTATION_STATISTICS_STROKE:__name(()=>DEFAULT_ANNOTATION_STATISTICS_STROKE,"DEFAULT_ANNOTATION_STATISTICS_STROKE"),DEFAULT_CAPTION_ALIGNMENT:__name(()=>DEFAULT_CAPTION_ALIGNMENT,"DEFAULT_CAPTION_ALIGNMENT"),DEFAULT_CAPTION_LAYOUT_STYLE:__name(()=>DEFAULT_CAPTION_LAYOUT_STYLE,"DEFAULT_CAPTION_LAYOUT_STYLE"),DEFAULT_FIBONACCI_STROKES:__name(()=>DEFAULT_FIBONACCI_STROKES,"DEFAULT_FIBONACCI_STROKES"),DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:__name(()=>DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,"DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL"),DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:__name(()=>DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,"DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR"),DEFAULT_GRIDLINE_ENABLED:__name(()=>DEFAULT_GRIDLINE_ENABLED,"DEFAULT_GRIDLINE_ENABLED"),DEFAULT_POLAR_SERIES_STROKE:__name(()=>DEFAULT_POLAR_SERIES_STROKE,"DEFAULT_POLAR_SERIES_STROKE"),DEFAULT_SEPARATION_LINES_COLOUR:__name(()=>DEFAULT_SEPARATION_LINES_COLOUR,"DEFAULT_SEPARATION_LINES_COLOUR"),DEFAULT_SHADOW_COLOUR:__name(()=>DEFAULT_SHADOW_COLOUR,"DEFAULT_SHADOW_COLOUR"),DEFAULT_SPARKLINE_CROSSHAIR_STROKE:__name(()=>DEFAULT_SPARKLINE_CROSSHAIR_STROKE,"DEFAULT_SPARKLINE_CROSSHAIR_STROKE"),DEFAULT_TEXTBOX_COLOR:__name(()=>DEFAULT_TEXTBOX_COLOR,"DEFAULT_TEXTBOX_COLOR"),DEFAULT_TEXTBOX_FILL:__name(()=>DEFAULT_TEXTBOX_FILL,"DEFAULT_TEXTBOX_FILL"),DEFAULT_TEXTBOX_STROKE:__name(()=>DEFAULT_TEXTBOX_STROKE,"DEFAULT_TEXTBOX_STROKE"),DEFAULT_TEXT_ANNOTATION_COLOR:__name(()=>DEFAULT_TEXT_ANNOTATION_COLOR,"DEFAULT_TEXT_ANNOTATION_COLOR"),DEFAULT_TOOLBAR_POSITION:__name(()=>DEFAULT_TOOLBAR_POSITION,"DEFAULT_TOOLBAR_POSITION"),IS_COMMUNITY:__name(()=>IS_COMMUNITY,"IS_COMMUNITY"),IS_DARK_THEME:__name(()=>IS_DARK_THEME,"IS_DARK_THEME"),IS_ENTERPRISE:__name(()=>IS_ENTERPRISE,"IS_ENTERPRISE"),PALETTE_ALT_DOWN_FILL:__name(()=>PALETTE_ALT_DOWN_FILL,"PALETTE_ALT_DOWN_FILL"),PALETTE_ALT_DOWN_STROKE:__name(()=>PALETTE_ALT_DOWN_STROKE,"PALETTE_ALT_DOWN_STROKE"),PALETTE_ALT_NEUTRAL_FILL:__name(()=>PALETTE_ALT_NEUTRAL_FILL,"PALETTE_ALT_NEUTRAL_FILL"),PALETTE_ALT_NEUTRAL_STROKE:__name(()=>PALETTE_ALT_NEUTRAL_STROKE,"PALETTE_ALT_NEUTRAL_STROKE"),PALETTE_ALT_UP_FILL:__name(()=>PALETTE_ALT_UP_FILL,"PALETTE_ALT_UP_FILL"),PALETTE_ALT_UP_STROKE:__name(()=>PALETTE_ALT_UP_STROKE,"PALETTE_ALT_UP_STROKE"),PALETTE_DOWN_FILL:__name(()=>PALETTE_DOWN_FILL,"PALETTE_DOWN_FILL"),PALETTE_DOWN_STROKE:__name(()=>PALETTE_DOWN_STROKE,"PALETTE_DOWN_STROKE"),PALETTE_NEUTRAL_FILL:__name(()=>PALETTE_NEUTRAL_FILL,"PALETTE_NEUTRAL_FILL"),PALETTE_NEUTRAL_STROKE:__name(()=>PALETTE_NEUTRAL_STROKE,"PALETTE_NEUTRAL_STROKE"),PALETTE_UP_FILL:__name(()=>PALETTE_UP_FILL,"PALETTE_UP_FILL"),PALETTE_UP_STROKE:__name(()=>PALETTE_UP_STROKE,"PALETTE_UP_STROKE"),getChartTheme:__name(()=>getChartTheme,"getChartTheme"),resolveOperation:__name(()=>resolveOperation2,"resolveOperation"),themeNames:__name(()=>themeNames,"themeNames"),themeSymbols:__name(()=>symbols_exports,"themeSymbols"),themes:__name(()=>themes,"themes")});var themeNames=Object.keys(themes);function resolveOperation2(operation){const params=ChartTheme.getDefaultPublicParameters();params.__palette=ChartTheme.getDefaultColors();const source={operation};return jsonResolveOperations(source,params),source.operation}__name(resolveOperation2,"resolveOperation2");var integrated_charts_util_exports={};__export(integrated_charts_util_exports,{Color:__name(()=>Color,"Color"),interpolateColor:__name(()=>interpolateColor,"interpolateColor")});var module_support_exports={};__export(module_support_exports,{AND:__name(()=>AND,"AND"),ARRAY:__name(()=>ARRAY,"ARRAY"),ARRAY_OF:__name(()=>ARRAY_OF,"ARRAY_OF"),AbstractBarSeries:__name(()=>AbstractBarSeries,"AbstractBarSeries"),AbstractBarSeriesProperties:__name(()=>AbstractBarSeriesProperties,"AbstractBarSeriesProperties"),ActionOnSet:__name(()=>ActionOnSet,"ActionOnSet"),AnchoredPopover:__name(()=>AnchoredPopover,"AnchoredPopover"),Animation:__name(()=>Animation,"Animation"),AnimationManager:__name(()=>AnimationManager,"AnimationManager"),Arc:__name(()=>Arc2,"Arc"),Axis:__name(()=>Axis,"Axis"),AxisGroupZIndexMap:__name(()=>AxisGroupZIndexMap,"AxisGroupZIndexMap"),AxisInterval:__name(()=>AxisInterval,"AxisInterval"),AxisLabel:__name(()=>AxisLabel,"AxisLabel"),AxisTick:__name(()=>AxisTick,"AxisTick"),AxisTickGenerator:__name(()=>AxisTickGenerator,"AxisTickGenerator"),AxisTicks:__name(()=>AxisTicks,"AxisTicks"),BBox:__name(()=>BBox,"BBox"),BBoxValues:__name(()=>BBoxValues,"BBoxValues"),BOOLEAN:__name(()=>BOOLEAN,"BOOLEAN"),BOOLEAN_ARRAY:__name(()=>BOOLEAN_ARRAY,"BOOLEAN_ARRAY"),Background:__name(()=>Background,"Background"),BackgroundModule:__name(()=>BackgroundModule,"BackgroundModule"),BandScale:__name(()=>BandScale,"BandScale"),BarSeries:__name(()=>BarSeries,"BarSeries"),BarSeriesModule:__name(()=>BarSeriesModule,"BarSeriesModule"),BaseModuleInstance:__name(()=>BaseModuleInstance,"BaseModuleInstance"),BaseProperties:__name(()=>BaseProperties,"BaseProperties"),BaseToolbar:__name(()=>BaseToolbar,"BaseToolbar"),ButtonWidget:__name(()=>ButtonWidget,"ButtonWidget"),COLOR_GRADIENT:__name(()=>COLOR_GRADIENT,"COLOR_GRADIENT"),COLOR_PATTERN:__name(()=>COLOR_PATTERN,"COLOR_PATTERN"),COLOR_STRING:__name(()=>COLOR_STRING,"COLOR_STRING"),COLOR_STRING_ARRAY:__name(()=>COLOR_STRING_ARRAY,"COLOR_STRING_ARRAY"),CachedTextMeasurer:__name(()=>CachedTextMeasurer,"CachedTextMeasurer"),CachedTextMeasurerPool:__name(()=>CachedTextMeasurerPool,"CachedTextMeasurerPool"),Caption:__name(()=>Caption,"Caption"),CartesianAxis:__name(()=>CartesianAxis,"CartesianAxis"),CartesianSeries:__name(()=>CartesianSeries,"CartesianSeries"),CartesianSeriesNodeEvent:__name(()=>CartesianSeriesNodeEvent,"CartesianSeriesNodeEvent"),CartesianSeriesProperties:__name(()=>CartesianSeriesProperties,"CartesianSeriesProperties"),CategoryAxis:__name(()=>CategoryAxis,"CategoryAxis"),CategoryScale:__name(()=>CategoryScale,"CategoryScale"),ChangeDetectableProperties:__name(()=>ChangeDetectableProperties,"ChangeDetectableProperties"),Chart:__name(()=>Chart,"Chart"),ChartAxisDirection:__name(()=>ChartAxisDirection,"ChartAxisDirection"),ChartEventManager:__name(()=>ChartEventManager,"ChartEventManager"),ChartOptions:__name(()=>ChartOptions,"ChartOptions"),ChartUpdateType:__name(()=>ChartUpdateType,"ChartUpdateType"),CollapseMode:__name(()=>CollapseMode,"CollapseMode"),Color:__name(()=>Color,"Color"),ColorScale:__name(()=>ColorScale,"ColorScale"),ConicGradient:__name(()=>ConicGradient,"ConicGradient"),ContextMenuRegistry:__name(()=>ContextMenuRegistry,"ContextMenuRegistry"),ContinuousScale:__name(()=>ContinuousScale,"ContinuousScale"),DATE:__name(()=>DATE,"DATE"),DATE_ARRAY:__name(()=>DATE_ARRAY,"DATE_ARRAY"),DATE_OR_DATETIME_MS:__name(()=>DATE_OR_DATETIME_MS,"DATE_OR_DATETIME_MS"),DEFAULT_CARTESIAN_DIRECTION_KEYS:__name(()=>DEFAULT_CARTESIAN_DIRECTION_KEYS,"DEFAULT_CARTESIAN_DIRECTION_KEYS"),DEFAULT_CARTESIAN_DIRECTION_NAMES:__name(()=>DEFAULT_CARTESIAN_DIRECTION_NAMES,"DEFAULT_CARTESIAN_DIRECTION_NAMES"),DEFAULT_TOOLTIP_CLASS:__name(()=>DEFAULT_TOOLTIP_CLASS,"DEFAULT_TOOLTIP_CLASS"),DEFAULT_TOOLTIP_DARK_CLASS:__name(()=>DEFAULT_TOOLTIP_DARK_CLASS,"DEFAULT_TOOLTIP_DARK_CLASS"),DIRECTION:__name(()=>DIRECTION,"DIRECTION"),DIRECTION_SWAP_AXES:__name(()=>DIRECTION_SWAP_AXES,"DIRECTION_SWAP_AXES"),DOMManager:__name(()=>DOMManager,"DOMManager"),DataController:__name(()=>DataController,"DataController"),DataModel:__name(()=>DataModel,"DataModel"),DataModelSeries:__name(()=>DataModelSeries,"DataModelSeries"),DataService:__name(()=>DataService,"DataService"),Debug:__name(()=>Debug,"Debug"),Deprecated:__name(()=>Deprecated,"Deprecated"),DeprecatedAndRenamedTo:__name(()=>DeprecatedAndRenamedTo,"DeprecatedAndRenamedTo"),DragInterpreter:__name(()=>DragInterpreter,"DragInterpreter"),DraggablePopover:__name(()=>DraggablePopover,"DraggablePopover"),DropShadow:__name(()=>DropShadow,"DropShadow"),ExtendedPath2D:__name(()=>ExtendedPath2D,"ExtendedPath2D"),FILL_PATTERN_DEFAULTS:__name(()=>FILL_PATTERN_DEFAULTS,"FILL_PATTERN_DEFAULTS"),FONT_SIZE_RATIO:__name(()=>FONT_SIZE_RATIO,"FONT_SIZE_RATIO"),FONT_STYLE:__name(()=>FONT_STYLE,"FONT_STYLE"),FONT_WEIGHT:__name(()=>FONT_WEIGHT,"FONT_WEIGHT"),FUNCTION:__name(()=>FUNCTION,"FUNCTION"),FillGradientDefaults:__name(()=>FillGradientDefaults,"FillGradientDefaults"),FillPatternDefaults:__name(()=>FillPatternDefaults,"FillPatternDefaults"),FloatingToolbar:__name(()=>FloatingToolbar,"FloatingToolbar"),GREATER_THAN:__name(()=>GREATER_THAN,"GREATER_THAN"),Gradient:__name(()=>Gradient,"Gradient"),Group:__name(()=>Group,"Group"),GroupedCategoryAxis:__name(()=>GroupedCategoryAxis,"GroupedCategoryAxis"),HdpiCanvas:__name(()=>HdpiCanvas,"HdpiCanvas"),HierarchyNode:__name(()=>HierarchyNode,"HierarchyNode"),HierarchySeries:__name(()=>HierarchySeries,"HierarchySeries"),HierarchySeriesProperties:__name(()=>HierarchySeriesProperties,"HierarchySeriesProperties"),HighlightManager:__name(()=>HighlightManager,"HighlightManager"),HighlightProperties:__name(()=>HighlightProperties,"HighlightProperties"),HighlightStyle:__name(()=>HighlightStyle,"HighlightStyle"),INTERACTION_RANGE:__name(()=>INTERACTION_RANGE,"INTERACTION_RANGE"),INTERPOLATION_STEP_POSITION:__name(()=>INTERPOLATION_STEP_POSITION,"INTERPOLATION_STEP_POSITION"),INTERPOLATION_TYPE:__name(()=>INTERPOLATION_TYPE,"INTERPOLATION_TYPE"),Image:__name(()=>Image,"Image"),InteractionManager:__name(()=>InteractionManager,"InteractionManager"),InteractionState:__name(()=>InteractionState,"InteractionState"),InterpolationProperties:__name(()=>InterpolationProperties,"InterpolationProperties"),Invalidating:__name(()=>Invalidating,"Invalidating"),LABEL_PLACEMENT:__name(()=>LABEL_PLACEMENT,"LABEL_PLACEMENT"),LARGEST_KEY_INTERVAL:__name(()=>LARGEST_KEY_INTERVAL,"LARGEST_KEY_INTERVAL"),LESS_THAN:__name(()=>LESS_THAN,"LESS_THAN"),LINE_CAP:__name(()=>LINE_CAP,"LINE_CAP"),LINE_DASH:__name(()=>LINE_DASH,"LINE_DASH"),LINE_JOIN:__name(()=>LINE_JOIN,"LINE_JOIN"),LINE_STYLE:__name(()=>LINE_STYLE,"LINE_STYLE"),Label:__name(()=>Label,"Label"),LayoutElement:__name(()=>LayoutElement,"LayoutElement"),LayoutManager:__name(()=>LayoutManager,"LayoutManager"),LegendMarkerLabel:__name(()=>LegendMarkerLabel,"LegendMarkerLabel"),Line:__name(()=>Line,"Line"),LineSeries:__name(()=>LineSeries,"LineSeries"),LineSeriesModule:__name(()=>LineSeriesModule,"LineSeriesModule"),LinearGradient:__name(()=>LinearGradient,"LinearGradient"),LinearScale:__name(()=>LinearScale,"LinearScale"),Listeners:__name(()=>Listeners,"Listeners"),LogScale:__name(()=>LogScale,"LogScale"),LonLatBBox:__name(()=>LonLatBBox,"LonLatBBox"),MARKER_SHAPE:__name(()=>MARKER_SHAPE,"MARKER_SHAPE"),MATCHING_CROSSLINE_TYPE:__name(()=>MATCHING_CROSSLINE_TYPE,"MATCHING_CROSSLINE_TYPE"),MAX_SPACING:__name(()=>MAX_SPACING,"MAX_SPACING"),MIN_SPACING:__name(()=>MIN_SPACING,"MIN_SPACING"),Marker:__name(()=>Marker,"Marker"),Menu:__name(()=>Menu,"Menu"),MercatorScale:__name(()=>MercatorScale,"MercatorScale"),ModuleRegistry:__name(()=>moduleRegistry_exports,"ModuleRegistry"),Motion:__name(()=>easing_exports,"Motion"),NAN:__name(()=>NAN,"NAN"),NODE_UPDATE_STATE_TO_PHASE_MAPPING:__name(()=>NODE_UPDATE_STATE_TO_PHASE_MAPPING,"NODE_UPDATE_STATE_TO_PHASE_MAPPING"),NUMBER:__name(()=>NUMBER,"NUMBER"),NUMBER_ARRAY:__name(()=>NUMBER_ARRAY,"NUMBER_ARRAY"),NUMBER_OR_NAN:__name(()=>NUMBER_OR_NAN,"NUMBER_OR_NAN"),NativeWidget:__name(()=>NativeWidget,"NativeWidget"),NewAreaSeriesModule:__name(()=>NewAreaSeriesModule,"NewAreaSeriesModule"),NewBarSeriesModule:__name(()=>NewBarSeriesModule,"NewBarSeriesModule"),NewBubbleSeriesModule:__name(()=>NewBubbleSeriesModule,"NewBubbleSeriesModule"),NewHistogramSeriesModule:__name(()=>NewHistogramSeriesModule,"NewHistogramSeriesModule"),NewLineSeriesModule:__name(()=>NewLineSeriesModule,"NewLineSeriesModule"),NewScatterSeriesModule:__name(()=>NewScatterSeriesModule,"NewScatterSeriesModule"),NiceMode:__name(()=>NiceMode,"NiceMode"),Node:__name(()=>Node,"Node"),NumberAxis:__name(()=>NumberAxis,"NumberAxis"),OBJECT:__name(()=>OBJECT,"OBJECT"),OBJECT_ARRAY:__name(()=>OBJECT_ARRAY,"OBJECT_ARRAY"),OR:__name(()=>OR,"OR"),OVERFLOW_STRATEGY:__name(()=>OVERFLOW_STRATEGY,"OVERFLOW_STRATEGY"),ObserveChanges:__name(()=>ObserveChanges,"ObserveChanges"),OrdinalTimeScale:__name(()=>OrdinalTimeScale,"OrdinalTimeScale"),PHASE_METADATA:__name(()=>PHASE_METADATA,"PHASE_METADATA"),PHASE_ORDER:__name(()=>PHASE_ORDER,"PHASE_ORDER"),PLACEMENT:__name(()=>PLACEMENT,"PLACEMENT"),PLAIN_OBJECT:__name(()=>PLAIN_OBJECT,"PLAIN_OBJECT"),POSITION:__name(()=>POSITION,"POSITION"),POSITION_TOP_COORDINATES:__name(()=>POSITION_TOP_COORDINATES,"POSITION_TOP_COORDINATES"),POSITIVE_NUMBER:__name(()=>POSITIVE_NUMBER,"POSITIVE_NUMBER"),PREV_NEXT_KEYS:__name(()=>PREV_NEXT_KEYS,"PREV_NEXT_KEYS"),Padding:__name(()=>Padding,"Padding"),ParallelStateMachine:__name(()=>ParallelStateMachine,"ParallelStateMachine"),Path:__name(()=>Path,"Path"),PointerEvents:__name(()=>PointerEvents,"PointerEvents"),PolarAxis:__name(()=>PolarAxis,"PolarAxis"),PolarSeries:__name(()=>PolarSeries,"PolarSeries"),PolarZIndexMap:__name(()=>PolarZIndexMap,"PolarZIndexMap"),Popover:__name(()=>Popover,"Popover"),PropertiesArray:__name(()=>PropertiesArray,"PropertiesArray"),ProxyInteractionService:__name(()=>ProxyInteractionService,"ProxyInteractionService"),ProxyOnWrite:__name(()=>ProxyOnWrite,"ProxyOnWrite"),ProxyProperty:__name(()=>ProxyProperty,"ProxyProperty"),ProxyPropertyOnWrite:__name(()=>ProxyPropertyOnWrite,"ProxyPropertyOnWrite"),QUICK_TRANSITION:__name(()=>QUICK_TRANSITION,"QUICK_TRANSITION"),RATIO:__name(()=>RATIO,"RATIO"),REAL_NUMBER:__name(()=>REAL_NUMBER,"REAL_NUMBER"),RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD:__name(()=>RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD,"RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD"),RadialColumnShape:__name(()=>RadialColumnShape,"RadialColumnShape"),Range:__name(()=>Range,"Range"),Rect:__name(()=>Rect,"Rect"),RepeatType:__name(()=>RepeatType,"RepeatType"),Rotatable:__name(()=>Rotatable,"Rotatable"),RotatableGroup:__name(()=>RotatableGroup,"RotatableGroup"),RotatableText:__name(()=>RotatableText,"RotatableText"),SAFE_FILLS_OPERATION:__name(()=>SAFE_FILLS_OPERATION,"SAFE_FILLS_OPERATION"),SAFE_FILL_OPERATION:__name(()=>SAFE_FILL_OPERATION,"SAFE_FILL_OPERATION"),SAFE_RANGE2_OPERATION:__name(()=>SAFE_RANGE2_OPERATION,"SAFE_RANGE2_OPERATION"),SAFE_STROKE_FILL_OPERATION:__name(()=>SAFE_STROKE_FILL_OPERATION,"SAFE_STROKE_FILL_OPERATION"),SKIP_JS_BUILTINS:__name(()=>SKIP_JS_BUILTINS,"SKIP_JS_BUILTINS"),SMALLEST_KEY_INTERVAL:__name(()=>SMALLEST_KEY_INTERVAL,"SMALLEST_KEY_INTERVAL"),SORT_DOMAIN_GROUPS:__name(()=>SORT_DOMAIN_GROUPS,"SORT_DOMAIN_GROUPS"),STRING:__name(()=>STRING,"STRING"),STRING_ARRAY:__name(()=>STRING_ARRAY,"STRING_ARRAY"),Scalable:__name(()=>Scalable,"Scalable"),ScalableGroup:__name(()=>ScalableGroup,"ScalableGroup"),Scene:__name(()=>Scene,"Scene"),SceneChangeDetection:__name(()=>SceneChangeDetection,"SceneChangeDetection"),ScenePathChangeDetection:__name(()=>ScenePathChangeDetection,"ScenePathChangeDetection"),Sector:__name(()=>Sector,"Sector"),SectorBox:__name(()=>SectorBox,"SectorBox"),Selection:__name(()=>Selection,"Selection"),Series:__name(()=>Series,"Series"),SeriesContentZIndexMap:__name(()=>SeriesContentZIndexMap,"SeriesContentZIndexMap"),SeriesGroupingChangedEvent:__name(()=>SeriesGroupingChangedEvent,"SeriesGroupingChangedEvent"),SeriesItemHighlightStyle:__name(()=>SeriesItemHighlightStyle,"SeriesItemHighlightStyle"),SeriesMarker:__name(()=>SeriesMarker,"SeriesMarker"),SeriesNodeEvent:__name(()=>SeriesNodeEvent,"SeriesNodeEvent"),SeriesNodePickMode:__name(()=>SeriesNodePickMode,"SeriesNodePickMode"),SeriesProperties:__name(()=>SeriesProperties,"SeriesProperties"),SeriesTooltip:__name(()=>SeriesTooltip,"SeriesTooltip"),SeriesZIndexMap:__name(()=>SeriesZIndexMap,"SeriesZIndexMap"),Shape:__name(()=>Shape,"Shape"),SimpleTextMeasurer:__name(()=>SimpleTextMeasurer,"SimpleTextMeasurer"),SliderWidget:__name(()=>SliderWidget,"SliderWidget"),StateMachine:__name(()=>StateMachine,"StateMachine"),StateMachineProperty:__name(()=>StateMachineProperty,"StateMachineProperty"),StopProperties:__name(()=>StopProperties,"StopProperties"),SvgPath:__name(()=>SvgPath,"SvgPath"),TEXT_ALIGN:__name(()=>TEXT_ALIGN,"TEXT_ALIGN"),TEXT_WRAP:__name(()=>TEXT_WRAP,"TEXT_WRAP"),TICK_INTERVAL:__name(()=>TICK_INTERVAL,"TICK_INTERVAL"),TempValidate:__name(()=>TempValidate,"TempValidate"),Text:__name(()=>Text,"Text"),TextUtils:__name(()=>TextUtils,"TextUtils"),TextWrapper:__name(()=>TextWrapper,"TextWrapper"),ThemeConstants:__name(()=>constants_exports,"ThemeConstants"),ThemeSymbols:__name(()=>symbols_exports,"ThemeSymbols"),TimeScale:__name(()=>TimeScale,"TimeScale"),Toolbar:__name(()=>Toolbar,"Toolbar"),ToolbarButtonProperties:__name(()=>ToolbarButtonProperties,"ToolbarButtonProperties"),ToolbarButtonWidget:__name(()=>ToolbarButtonWidget,"ToolbarButtonWidget"),ToolbarWidget:__name(()=>ToolbarWidget,"ToolbarWidget"),Tooltip:__name(()=>Tooltip,"Tooltip"),TooltipManager:__name(()=>TooltipManager,"TooltipManager"),TooltipPosition:__name(()=>TooltipPosition,"TooltipPosition"),Transformable:__name(()=>Transformable,"Transformable"),TransformableText:__name(()=>TransformableText,"TransformableText"),Translatable:__name(()=>Translatable,"Translatable"),TranslatableGroup:__name(()=>TranslatableGroup,"TranslatableGroup"),TranslatableLine:__name(()=>TranslatableLine,"TranslatableLine"),UNION:__name(()=>UNION,"UNION"),UpdateService:__name(()=>UpdateService,"UpdateService"),VERTICAL_ALIGN:__name(()=>VERTICAL_ALIGN,"VERTICAL_ALIGN"),Validate:__name(()=>Validate,"Validate"),Vec2:__name(()=>Vec2,"Vec2"),Vec4:__name(()=>Vec4,"Vec4"),WIDGET_HTML_EVENTS:__name(()=>WIDGET_HTML_EVENTS,"WIDGET_HTML_EVENTS"),Widget:__name(()=>Widget,"Widget"),WidgetEventUtil:__name(()=>WidgetEventUtil,"WidgetEventUtil"),ZIndexMap:__name(()=>ZIndexMap,"ZIndexMap"),ZoomManager:__name(()=>ZoomManager,"ZoomManager"),accumulateGroup:__name(()=>accumulateGroup,"accumulateGroup"),accumulateStack:__name(()=>accumulateStack,"accumulateStack"),accumulatedValue:__name(()=>accumulatedValue,"accumulatedValue"),accumulativeValueProperty:__name(()=>accumulativeValueProperty,"accumulativeValueProperty"),addHitTestersToQuadtree:__name(()=>addHitTestersToQuadtree,"addHitTestersToQuadtree"),adjustLabelPlacement:__name(()=>adjustLabelPlacement,"adjustLabelPlacement"),angleBetween:__name(()=>angleBetween,"angleBetween"),animationValidation:__name(()=>animationValidation,"animationValidation"),applyShapeFillBBox:__name(()=>applyShapeFillBBox,"applyShapeFillBBox"),applyShapeStyle:__name(()=>applyShapeStyle,"applyShapeStyle"),areScalingEqual:__name(()=>areScalingEqual,"areScalingEqual"),area:__name(()=>area,"area"),autoSizedLabelOptionsDefs:__name(()=>autoSizedLabelOptionsDefs,"autoSizedLabelOptionsDefs"),buildFormatter:__name(()=>buildFormatter,"buildFormatter"),buildResetPathFn:__name(()=>buildResetPathFn,"buildResetPathFn"),calculateDefaultTimeTickFormat:__name(()=>calculateDefaultTimeTickFormat,"calculateDefaultTimeTickFormat"),calculateDerivativeExtrema:__name(()=>calculateDerivativeExtrema,"calculateDerivativeExtrema"),calculateDerivativeExtremaXY:__name(()=>calculateDerivativeExtremaXY,"calculateDerivativeExtremaXY"),calculateLabelChartPadding:__name(()=>calculateLabelChartPadding,"calculateLabelChartPadding"),calculateLabelTranslation:__name(()=>calculateLabelTranslation,"calculateLabelTranslation"),calculatePlacement:__name(()=>calculatePlacement,"calculatePlacement"),cartesianAxisCrosshairOptions:__name(()=>cartesianAxisCrosshairOptions,"cartesianAxisCrosshairOptions"),cartesianAxisLabelOptionsDefs:__name(()=>cartesianAxisLabelOptionsDefs,"cartesianAxisLabelOptionsDefs"),cartesianAxisOptionsDefs:__name(()=>cartesianAxisOptionsDefs,"cartesianAxisOptionsDefs"),cartesianChartOptionsDefs:__name(()=>cartesianChartOptionsDefs,"cartesianChartOptionsDefs"),cartesianCrossLineOptionsDefs:__name(()=>cartesianCrossLineOptionsDefs,"cartesianCrossLineOptionsDefs"),checkCrisp:__name(()=>checkCrisp,"checkCrisp"),clampArray:__name(()=>clampArray,"clampArray"),clippedRoundRect:__name(()=>clippedRoundRect,"clippedRoundRect"),collapsedStartingBarPosition:__name(()=>collapsedStartingBarPosition,"collapsedStartingBarPosition"),commonAxisLabelOptionsDefs:__name(()=>commonAxisLabelOptionsDefs,"commonAxisLabelOptionsDefs"),commonAxisOptionsDefs:__name(()=>commonAxisOptionsDefs,"commonAxisOptionsDefs"),commonChartOptionsDefs:__name(()=>commonChartOptionsDefs,"commonChartOptionsDefs"),commonCrossLineLabelOptionsDefs:__name(()=>commonCrossLineLabelOptionsDefs,"commonCrossLineLabelOptionsDefs"),commonCrossLineOptionsDefs:__name(()=>commonCrossLineOptionsDefs,"commonCrossLineOptionsDefs"),commonSeriesOptionsDefs:__name(()=>commonSeriesOptionsDefs,"commonSeriesOptionsDefs"),compareDates:__name(()=>compareDates,"compareDates"),computeBarFocusBounds:__name(()=>computeBarFocusBounds,"computeBarFocusBounds"),computeMarkerFocusBounds:__name(()=>computeMarkerFocusBounds,"computeMarkerFocusBounds"),continuousAxisOptions:__name(()=>continuousAxisOptions,"continuousAxisOptions"),countExpandingSearch:__name(()=>countExpandingSearch,"countExpandingSearch"),createButton:__name(()=>createButton,"createButton"),createCheckbox:__name(()=>createCheckbox,"createCheckbox"),createDatumId:__name(()=>createDatumId,"createDatumId"),createDeprecationWarning:__name(()=>createDeprecationWarning,"createDeprecationWarning"),createElementId:__name(()=>createElementId,"createElementId"),createIcon:__name(()=>createIcon,"createIcon"),createId:__name(()=>createId,"createId"),createSelect:__name(()=>createSelect,"createSelect"),createTextArea:__name(()=>createTextArea,"createTextArea"),dateToNumber:__name(()=>dateToNumber,"dateToNumber"),datesSortOrder:__name(()=>datesSortOrder,"datesSortOrder"),datumKeys:__name(()=>datumKeys,"datumKeys"),datumStylerProperties:__name(()=>datumStylerProperties,"datumStylerProperties"),deconstructSelectionsOrNodes:__name(()=>deconstructSelectionsOrNodes,"deconstructSelectionsOrNodes"),deepClone:__name(()=>deepClone,"deepClone"),deepFreeze:__name(()=>deepFreeze,"deepFreeze"),defaultTimeTickFormat:__name(()=>defaultTimeTickFormat,"defaultTimeTickFormat"),diff:__name(()=>diff,"diff"),drawCorner:__name(()=>drawCorner,"drawCorner"),drawMarkerUnitPolygon:__name(()=>drawMarkerUnitPolygon,"drawMarkerUnitPolygon"),easing:__name(()=>easing_exports,"easing"),enterpriseModule:__name(()=>enterpriseModule,"enterpriseModule"),errorBarOptionsDefs:__name(()=>errorBarOptionsDefs,"errorBarOptionsDefs"),evaluateBezier:__name(()=>evaluateBezier,"evaluateBezier"),extent:__name(()=>extent,"extent"),extractDecoratedProperties:__name(()=>extractDecoratedProperties,"extractDecoratedProperties"),findMinMax:__name(()=>findMinMax,"findMinMax"),findQuadtreeMatch:__name(()=>findQuadtreeMatch,"findQuadtreeMatch"),findRangeExtent:__name(()=>findRangeExtent,"findRangeExtent"),fixNumericExtent:__name(()=>fixNumericExtent,"fixNumericExtent"),flowProportionChartOptionsDefs:__name(()=>flowProportionChartOptionsDefs,"flowProportionChartOptionsDefs"),focusCursorAtEnd:__name(()=>focusCursorAtEnd,"focusCursorAtEnd"),formatNumber:__name(()=>formatNumber,"formatNumber"),formatPercent:__name(()=>formatPercent,"formatPercent"),formatValue:__name(()=>formatValue,"formatValue"),fromToMotion:__name(()=>fromToMotion,"fromToMotion"),gaugeChartOptionsDefs:__name(()=>gaugeChartOptionsDefs,"gaugeChartOptionsDefs"),generateUUID:__name(()=>generateUUID,"generateUUID"),getAngleRatioRadians:__name(()=>getAngleRatioRadians,"getAngleRatioRadians"),getColorStops:__name(()=>getColorStops,"getColorStops"),getCrossLineValue:__name(()=>getCrossLineValue,"getCrossLineValue"),getDateTicksForInterval:__name(()=>getDateTicksForInterval,"getDateTicksForInterval"),getDatumRefPoint:__name(()=>getDatumRefPoint,"getDatumRefPoint"),getElementBBox:__name(()=>getElementBBox,"getElementBBox"),getIconClassNames:__name(()=>getIconClassNames,"getIconClassNames"),getLastFocus:__name(()=>getLastFocus,"getLastFocus"),getMissCount:__name(()=>getMissCount,"getMissCount"),getPath:__name(()=>getPath,"getPath"),getPathComponents:__name(()=>getPathComponents,"getPathComponents"),getRadialColumnWidth:__name(()=>getRadialColumnWidth,"getRadialColumnWidth"),getSequentialColors:__name(()=>getSequentialColors,"getSequentialColors"),getShapeFill:__name(()=>getShapeFill,"getShapeFill"),getShapeStyle:__name(()=>getShapeStyle,"getShapeStyle"),groupAccumulativeValueProperty:__name(()=>groupAccumulativeValueProperty,"groupAccumulativeValueProperty"),groupAverage:__name(()=>groupAverage,"groupAverage"),groupCount:__name(()=>groupCount,"groupCount"),groupStackValueProperty:__name(()=>groupStackValueProperty,"groupStackValueProperty"),groupSum:__name(()=>groupSum,"groupSum"),hasNoModifiers:__name(()=>hasNoModifiers,"hasNoModifiers"),hierarchyChartOptionsDefs:__name(()=>hierarchyChartOptionsDefs,"hierarchyChartOptionsDefs"),initMenuKeyNav:__name(()=>initMenuKeyNav,"initMenuKeyNav"),initRovingTabIndex:__name(()=>initRovingTabIndex,"initRovingTabIndex"),interpolatePoints:__name(()=>interpolatePoints,"interpolatePoints"),interpolationValidator:__name(()=>interpolationValidator,"interpolationValidator"),isAgFlowProportionChartOptions:__name(()=>isAgFlowProportionChartOptions,"isAgFlowProportionChartOptions"),isAgGaugeChartOptions:__name(()=>isAgGaugeChartOptions,"isAgGaugeChartOptions"),isAgHierarchyChartOptions:__name(()=>isAgHierarchyChartOptions,"isAgHierarchyChartOptions"),isAgStandaloneChartOptions:__name(()=>isAgStandaloneChartOptions,"isAgStandaloneChartOptions"),isAgTopologyChartOptions:__name(()=>isAgTopologyChartOptions,"isAgTopologyChartOptions"),isBetweenAngles:__name(()=>isBetweenAngles,"isBetweenAngles"),isButtonClickEvent:__name(()=>isButtonClickEvent,"isButtonClickEvent"),isContinuous:__name(()=>isContinuous,"isContinuous"),isDecoratedObject:__name(()=>isDecoratedObject,"isDecoratedObject"),isDenseInterval:__name(()=>isDenseInterval,"isDenseInterval"),isGradientFill:__name(()=>isGradientFill,"isGradientFill"),isGradientOrPatternFill:__name(()=>isGradientOrPatternFill,"isGradientOrPatternFill"),isInputPending:__name(()=>isInputPending,"isInputPending"),isPatternFill:__name(()=>isPatternFill,"isPatternFill"),isProperties:__name(()=>isProperties,"isProperties"),isScaleValid:__name(()=>isScaleValid,"isScaleValid"),jsonApply:__name(()=>jsonApply,"jsonApply"),jsonDiff:__name(()=>jsonDiff,"jsonDiff"),jsonPropertyCompare:__name(()=>jsonPropertyCompare,"jsonPropertyCompare"),jsonResolveOperations:__name(()=>jsonResolveOperations,"jsonResolveOperations"),jsonWalk:__name(()=>jsonWalk,"jsonWalk"),keyProperty:__name(()=>keyProperty,"keyProperty"),labelDirectionHandling:__name(()=>labelDirectionHandling,"labelDirectionHandling"),legendSymbolSvg:__name(()=>legendSymbolSvg,"legendSymbolSvg"),lineDistanceSquared:__name(()=>lineDistanceSquared,"lineDistanceSquared"),listDecoratedProperties:__name(()=>listDecoratedProperties,"listDecoratedProperties"),makeAccessibleClickListener:__name(()=>makeAccessibleClickListener,"makeAccessibleClickListener"),mapValues:__name(()=>mapValues,"mapValues"),markerFadeInAnimation:__name(()=>markerFadeInAnimation,"markerFadeInAnimation"),markerOptionsDefs:__name(()=>markerOptionsDefs,"markerOptionsDefs"),markerScaleInAnimation:__name(()=>markerScaleInAnimation,"markerScaleInAnimation"),markerSwipeScaleInAnimation:__name(()=>markerSwipeScaleInAnimation,"markerSwipeScaleInAnimation"),merge:__name(()=>merge,"merge"),mergeArrayDefaults:__name(()=>mergeArrayDefaults,"mergeArrayDefaults"),mergeDefaults:__name(()=>mergeDefaults,"mergeDefaults"),midpointStartingBarPosition:__name(()=>midpointStartingBarPosition,"midpointStartingBarPosition"),moduleRegistry:__name(()=>moduleRegistry,"moduleRegistry"),motion:__name(()=>motion,"motion"),nearestSquared:__name(()=>nearestSquared,"nearestSquared"),nearestSquaredInContainer:__name(()=>nearestSquaredInContainer,"nearestSquaredInContainer"),normaliseGroupTo:__name(()=>normaliseGroupTo,"normaliseGroupTo"),normalisePropertyTo:__name(()=>normalisePropertyTo,"normalisePropertyTo"),normalisedExtentWithMetadata:__name(()=>normalisedExtentWithMetadata,"normalisedExtentWithMetadata"),normalizeAngle180:__name(()=>normalizeAngle180,"normalizeAngle180"),normalizeAngle360:__name(()=>normalizeAngle360,"normalizeAngle360"),normalizeAngle360Inclusive:__name(()=>normalizeAngle360Inclusive,"normalizeAngle360Inclusive"),numberFormatValidator:__name(()=>numberFormatValidator,"numberFormatValidator"),objectsEqual:__name(()=>objectsEqual,"objectsEqual"),objectsEqualWith:__name(()=>objectsEqualWith,"objectsEqualWith"),pairUpSpans:__name(()=>pairUpSpans,"pairUpSpans"),partialAssign:__name(()=>partialAssign,"partialAssign"),pathFadeInAnimation:__name(()=>pathFadeInAnimation,"pathFadeInAnimation"),pathMotion:__name(()=>pathMotion,"pathMotion"),pathSwipeInAnimation:__name(()=>pathSwipeInAnimation,"pathSwipeInAnimation"),pickByMatchingAngle:__name(()=>pickByMatchingAngle,"pickByMatchingAngle"),plotAreaPathFill:__name(()=>plotAreaPathFill,"plotAreaPathFill"),plotInterpolatedAreaSeriesFillSpans:__name(()=>plotInterpolatedAreaSeriesFillSpans,"plotInterpolatedAreaSeriesFillSpans"),plotInterpolatedLinePathStroke:__name(()=>plotInterpolatedLinePathStroke,"plotInterpolatedLinePathStroke"),plotLinePathStroke:__name(()=>plotLinePathStroke,"plotLinePathStroke"),polarChartOptionsDefs:__name(()=>polarChartOptionsDefs,"polarChartOptionsDefs"),predicateWithMessage:__name(()=>predicateWithMessage,"predicateWithMessage"),prepareAreaFillAnimationFns:__name(()=>prepareAreaFillAnimationFns,"prepareAreaFillAnimationFns"),prepareAreaPathAnimation:__name(()=>prepareAreaPathAnimation,"prepareAreaPathAnimation"),prepareAxisAnimationContext:__name(()=>prepareAxisAnimationContext,"prepareAxisAnimationContext"),prepareAxisAnimationFunctions:__name(()=>prepareAxisAnimationFunctions,"prepareAxisAnimationFunctions"),prepareBarAnimationFunctions:__name(()=>prepareBarAnimationFunctions,"prepareBarAnimationFunctions"),prepareLinePathAnimation:__name(()=>prepareLinePathAnimation,"prepareLinePathAnimation"),prepareLinePathPropertyAnimation:__name(()=>prepareLinePathPropertyAnimation,"prepareLinePathPropertyAnimation"),prepareLinePathStrokeAnimationFns:__name(()=>prepareLinePathStrokeAnimationFns,"prepareLinePathStrokeAnimationFns"),preparePieSeriesAnimationFunctions:__name(()=>preparePieSeriesAnimationFunctions,"preparePieSeriesAnimationFunctions"),range:__name(()=>range,"range"),rangedValueProperty:__name(()=>rangedValueProperty,"rangedValueProperty"),resetAxisGroupFn:__name(()=>resetAxisGroupFn,"resetAxisGroupFn"),resetAxisLabelSelectionFn:__name(()=>resetAxisLabelSelectionFn,"resetAxisLabelSelectionFn"),resetAxisLineSelectionFn:__name(()=>resetAxisLineSelectionFn,"resetAxisLineSelectionFn"),resetAxisSelectionFn:__name(()=>resetAxisSelectionFn,"resetAxisSelectionFn"),resetBarSelectionsFn:__name(()=>resetBarSelectionsFn,"resetBarSelectionsFn"),resetIds:__name(()=>resetIds,"resetIds"),resetLabelFn:__name(()=>resetLabelFn,"resetLabelFn"),resetMarkerFn:__name(()=>resetMarkerFn,"resetMarkerFn"),resetMarkerPositionFn:__name(()=>resetMarkerPositionFn,"resetMarkerPositionFn"),resetMotion:__name(()=>resetMotion,"resetMotion"),resetPieSelectionsFn:__name(()=>resetPieSelectionsFn,"resetPieSelectionsFn"),rowCountProperty:__name(()=>rowCountProperty,"rowCountProperty"),scale:__name(()=>scale,"scale"),sectorBox:__name(()=>sectorBox,"sectorBox"),seriesLabelFadeInAnimation:__name(()=>seriesLabelFadeInAnimation,"seriesLabelFadeInAnimation"),seriesLabelFadeOutAnimation:__name(()=>seriesLabelFadeOutAnimation,"seriesLabelFadeOutAnimation"),seriesLabelOptionsDefs:__name(()=>seriesLabelOptionsDefs,"seriesLabelOptionsDefs"),setAttribute:__name(()=>setAttribute,"setAttribute"),setAttributes:__name(()=>setAttributes,"setAttributes"),setElementBBox:__name(()=>setElementBBox,"setElementBBox"),setElementStyle:__name(()=>setElementStyle,"setElementStyle"),setPath:__name(()=>setPath,"setPath"),shadowOptionsDefs:__name(()=>shadowOptionsDefs,"shadowOptionsDefs"),shallowClone:__name(()=>shallowClone,"shallowClone"),solveBezier:__name(()=>solveBezier,"solveBezier"),sortAndUniqueDates:__name(()=>sortAndUniqueDates,"sortAndUniqueDates"),splitBezier:__name(()=>splitBezier,"splitBezier"),standaloneChartOptionsDefs:__name(()=>standaloneChartOptionsDefs,"standaloneChartOptionsDefs"),staticFromToMotion:__name(()=>staticFromToMotion,"staticFromToMotion"),stopPageScrolling:__name(()=>stopPageScrolling,"stopPageScrolling"),sum:__name(()=>sum,"sum"),sumValues:__name(()=>sumValues,"sumValues"),toDegrees:__name(()=>toDegrees,"toDegrees"),toRadians:__name(()=>toRadians,"toRadians"),toolbarButtonOptionsDefs:__name(()=>toolbarButtonOptionsDefs,"toolbarButtonOptionsDefs"),tooltipContentAriaLabel:__name(()=>tooltipContentAriaLabel,"tooltipContentAriaLabel"),tooltipHtml:__name(()=>tooltipHtml,"tooltipHtml"),tooltipOptionsDefs:__name(()=>tooltipOptionsDefs,"tooltipOptionsDefs"),topologyChartOptionsDefs:__name(()=>topologyChartOptionsDefs,"topologyChartOptionsDefs"),trailingAccumulatedValue:__name(()=>trailingAccumulatedValue,"trailingAccumulatedValue"),trailingAccumulatedValueProperty:__name(()=>trailingAccumulatedValueProperty,"trailingAccumulatedValueProperty"),updateClipPath:__name(()=>updateClipPath,"updateClipPath"),updateLabelNode:__name(()=>updateLabelNode,"updateLabelNode"),validateCrossLineValue:__name(()=>validateCrossLineValue,"validateCrossLineValue"),valueProperty:__name(()=>valueProperty,"valueProperty"),visibleRangeIndices:__name(()=>visibleRangeIndices,"visibleRangeIndices"),without:__name(()=>without,"without")});var Vec2={add,angle,apply,equal,distance,distanceSquared,from:from2,gradient,intercept,intersectAtX,intersectAtY,length,lengthSquared,multiply,normalized,origin:origin2,required:required11,rotate,round:round3,sub};function add(a,b){return typeof b=="number"?{x:a.x+b,y:a.y+b}:{x:a.x+b.x,y:a.y+b.y}}__name(add,"add");function sub(a,b){return typeof b=="number"?{x:a.x-b,y:a.y-b}:{x:a.x-b.x,y:a.y-b.y}}__name(sub,"sub");function multiply(a,b){return typeof b=="number"?{x:a.x*b,y:a.y*b}:{x:a.x*b.x,y:a.y*b.y}}__name(multiply,"multiply");function length(a){return Math.sqrt(a.x*a.x+a.y*a.y)}__name(length,"length");function lengthSquared(a){return a.x*a.x+a.y*a.y}__name(lengthSquared,"lengthSquared");function distance(a,b){const d=sub(a,b);return Math.sqrt(d.x*d.x+d.y*d.y)}__name(distance,"distance");function distanceSquared(a,b){const d=sub(a,b);return d.x*d.x+d.y*d.y}__name(distanceSquared,"distanceSquared");function normalized(a){const l=length(a);return{x:a.x/l,y:a.y/l}}__name(normalized,"normalized");function angle(a,b){return b==null?Math.atan2(a.y,a.x):Math.atan2(a.y,a.x)-Math.atan2(b.y,b.x)}__name(angle,"angle");function rotate(a,theta,b=origin2()){const l=length(a);return{x:b.x+l*Math.cos(theta),y:b.y+l*Math.sin(theta)}}__name(rotate,"rotate");function gradient(a,b,reflection){const dx=b.x-a.x;return(reflection==null?b.y-a.y:reflection-b.y-(reflection-a.y))/dx}__name(gradient,"gradient");function intercept(a,gradient2,reflection){return(reflection==null?a.y:reflection-a.y)-gradient2*a.x}__name(intercept,"intercept");function intersectAtY(gradient2,coefficient,y=0,reflection){return{x:gradient2===1/0?1/0:(y-coefficient)/gradient2,y:reflection==null?y:reflection-y}}__name(intersectAtY,"intersectAtY");function intersectAtX(gradient2,coefficient,x=0,reflection){const y=gradient2===1/0?1/0:gradient2*x+coefficient;return{x,y:reflection==null?y:reflection-y}}__name(intersectAtX,"intersectAtX");function round3(a,decimals=2){return{x:roundTo(a.x,decimals),y:roundTo(a.y,decimals)}}__name(round3,"round3");function equal(a,b){return a.x===b.x&&a.y===b.y}__name(equal,"equal");function from2(a,b){if(typeof a=="number")return{x:a,y:b};if("currentX"in a)return{x:a.currentX,y:a.currentY};if("offsetWidth"in a)return{x:a.offsetWidth,y:a.offsetHeight};if("width"in a)return[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y+a.height}];if("x1"in a)return[{x:a.x1,y:a.y1},{x:a.x2,y:a.y2}];throw new Error(`Values can not be converted into a vector: [${JSON.stringify(a)}] [${b}]`)}__name(from2,"from2");function apply(a,b){return a.x=b.x,a.y=b.y,a}__name(apply,"apply");function required11(a){return{x:(a==null?void 0:a.x)??0,y:(a==null?void 0:a.y)??0}}__name(required11,"required11");function origin2(){return{x:0,y:0}}__name(origin2,"origin2");var _a275,_HierarchyNode=(_a275=class{constructor(series,datumIndex,datum,sizeValue,colorValue,sumSize,depth,parent,children){this.series=series,this.datumIndex=datumIndex,this.datum=datum,this.sizeValue=sizeValue,this.colorValue=colorValue,this.sumSize=sumSize,this.depth=depth,this.parent=parent,this.children=children,this.midPoint={x:0,y:0}}get hasChildren(){return this.children.length>0}walk(callback5,order=_a275.Walk.PreOrder){order===_a275.Walk.PreOrder&&callback5(this),this.children.forEach(child=>{child.walk(callback5,order)}),order===_a275.Walk.PostOrder&&callback5(this)}*[Symbol.iterator](){yield this;for(const child of this.children)yield*child}},__name(_a275,"_HierarchyNode"),_a275);_HierarchyNode.Walk={PreOrder:0,PostOrder:1};var HierarchyNode=_HierarchyNode,_a276,HierarchySeries=(_a276=class extends Series{constructor(moduleCtx){super({moduleCtx,pickModes:[1,0]}),this.colorDomain=[0,0],this.maxDepth=0,this.colorScale=new ColorScale,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:__name(data=>this.animateEmptyUpdateReady(data),"action")},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:__name(data=>this.animateReadyHighlight(data),"highlight"),resize:__name(data=>this.animateReadyResize(data),"resize"),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:__name(data=>this.animateWaitingUpdateReady(data),"action")},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:__name(data=>this.animateClearingUpdateEmpty(data),"action")},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}processData(){const{NodeClass}=this,{childrenKey,sizeKey,colorKey,colorRange}=this.properties;let maxDepth=0,minColor=1/0,maxColor=-1/0;const createNode=__name((datum,indexPath,parent)=>{const depth=parent.depth!=null?parent.depth+1:0,children=childrenKey!=null?datum[childrenKey]:void 0,isLeaf=children==null||children.length===0;let sizeValue=sizeKey!=null?datum[sizeKey]:void 0;Number.isFinite(sizeValue)?sizeValue=Math.max(sizeValue,0):sizeValue=isLeaf?1:0;const sumSize=sizeValue;maxDepth=Math.max(maxDepth,depth);const colorValue=colorKey!=null?datum[colorKey]:void 0;return typeof colorValue=="number"&&(minColor=Math.min(minColor,colorValue),maxColor=Math.max(maxColor,colorValue)),appendChildren(new NodeClass(this,indexPath,datum,sizeValue,colorValue,sumSize,depth,parent,[]),children)},"createNode"),appendChildren=__name((node,data)=>{const{datumIndex}=node;return data==null||data.forEach((datum,childIndex)=>{const child=createNode(datum,datumIndex.concat(childIndex),node);node.children.push(child),node.sumSize+=child.sumSize}),node},"appendChildren"),rootNode=appendChildren(new NodeClass(this,[],void 0,0,void 0,0,void 0,void 0,[]),this.data),colorDomain=[minColor,maxColor];this.colorScale.domain=minColor<maxColor?[minColor,maxColor]:[0,1],this.colorScale.range=colorRange??["black"],this.colorScale.update(),this.rootNode=rootNode,this.maxDepth=maxDepth,this.colorDomain=colorDomain}update({seriesRect}){this.updateSelections(),this.updateNodes();const animationData=this.getAnimationData();this.checkResize(seriesRect)&&this.animationState.transition("resize",animationData),this.animationState.transition("update",animationData)}resetAllAnimation(_data){this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateWaitingUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateReadyHighlight(_data){}animateReadyResize(data){this.resetAllAnimation(data)}animateClearingUpdateEmpty(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}getAnimationData(){return{}}isProcessedDataAnimatable(){return!0}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(_direction,_visibleRange){return[NaN,NaN]}getLegendData(legendType){const{colorKey,colorName,colorRange}=this.properties,{id:seriesId,ctx:{legendManager},visible}=this;return legendType==="gradient"&&colorKey!=null&&colorRange!=null?[{legendType:"gradient",enabled:visible&&legendManager.getItemEnabled({seriesId}),seriesId,colorName,colorRange,colorDomain:this.colorDomain}]:[]}getDatumIdFromData(node){return node.datumIndex.join(":")}getDatumId(node){return this.getDatumIdFromData(node)}removeMeIndexPathForIndex(index){var _a294;return((_a294=this.datumSelection.at(index+1))==null?void 0:_a294.datum.datumIndex)??[]}removeMeIndexForIndexPath(indexPath){for(const{index,datum}of this.datumSelection)if(arraysEqual(datum.datumIndex,indexPath))return index-1;return 0}pickFocus(opts){var _a294;if(!((_a294=this.rootNode)!=null&&_a294.children.length))return;const index=clamp(0,opts.datumIndex-opts.datumIndexDelta,this.datumSelection.length-1),{datumIndexDelta:childDelta,otherIndexDelta:depthDelta}=opts;let path=this.removeMeIndexPathForIndex(index);const currentNode=path.reduce((n,childIndex)=>n.children[childIndex],this.rootNode);if(depthDelta>0&&currentNode.hasChildren)path=[...path,0];else if(depthDelta<0&&path.length>1)path=path.slice(0,-1);else if(depthDelta===0&&childDelta!==0){const maxIndex=currentNode.parent.children.length-1;path=path.slice(),path[path.length-1]=clamp(0,path[path.length-1]+childDelta,maxIndex)}const nextNode=path.reduce((n,childIndex)=>n.children[childIndex],this.rootNode),bounds=this.computeFocusBounds(this.datumSelection.at(index+1));if(bounds!=null)return{datum:nextNode,datumIndex:this.removeMeIndexForIndexPath(path),otherIndex:nextNode.depth,bounds,clipFocusBox:!0}}getDatumAriaText(datum,description){if(!(datum instanceof this.NodeClass)){logger_exports.error(`datum is not HierarchyNode: ${JSON.stringify(datum)}`);return}return this.ctx.localeManager.t("ariaAnnounceHierarchyDatum",{level:(datum.depth??-1)+1,count:datum.children.length,description})}getCategoryValue(_datumIndex){}datumIndexForCategoryValue(_categoryValue){}},__name(_a276,"HierarchySeries"),_a276),_a277,HierarchySeriesProperties=(_a277=class extends SeriesProperties{constructor(){super(...arguments),this.childrenKey="children",this.fills=Object.values(DEFAULT_FILLS),this.fillGradientDefaults=new FillGradientDefaults,this.fillPatternDefaults=new FillPatternDefaults,this.strokes=Object.values(DEFAULT_STROKES)}},__name(_a277,"HierarchySeriesProperties"),_a277);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"childrenKey",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"sizeKey",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"colorKey",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"colorName",2);__decorateClass([TempValidate(ARRAY_OF(OR(COLOR_GRADIENT,COLOR_PATTERN,COLOR_STRING)))],HierarchySeriesProperties.prototype,"fills",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"fillGradientDefaults",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"fillPatternDefaults",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"strokes",2);__decorateClass([TempValidate()],HierarchySeriesProperties.prototype,"colorRange",2);var _a278,LonLatBBox=(_a278=class{constructor(lon0,lat0,lon1,lat1){this.lon0=lon0,this.lat0=lat0,this.lon1=lon1,this.lat1=lat1}merge(other){this.lon0=Math.min(this.lon0,other.lon0),this.lat0=Math.min(this.lat0,other.lat0),this.lon1=Math.max(this.lon1,other.lon1),this.lat1=Math.max(this.lat1,other.lat1)}},__name(_a278,"LonLatBBox"),_a278),radsInDeg=Math.PI/180,lonX=__name(lon=>lon*radsInDeg,"lonX"),latY=__name(lat=>-Math.log(Math.tan(Math.PI*.25+lat*radsInDeg*.5)),"latY"),xLon=__name(x=>x/radsInDeg,"xLon"),yLat=__name(y=>(Math.atan(Math.exp(-y))-Math.PI*.25)/(radsInDeg*.5),"yLat"),_a279,MercatorScale=(_a279=class extends AbstractScale{constructor(domain,range3){super(),this.domain=domain,this.range=range3,this.type="mercator",this.bounds=_a279.bounds(domain)}static bounds(domain){const[[lon0,lat0],[lon1,lat1]]=domain,x0=lonX(lon0),y0=latY(lat0),x1=lonX(lon1),y1=latY(lat1);return new BBox(Math.min(x0,x1),Math.min(y0,y1),Math.abs(x1-x0),Math.abs(y1-y0))}static fixedScale(){return new _a279([[xLon(0),yLat(0)],[xLon(1),yLat(1)]],[[0,0],[1,1]])}toDomain(){}normalizeDomains(...domains){let x0=-1/0,x1=1/0,y0=-1/0,y1=1/0;for(const domain of domains)for(const[x,y]of domain)x0=Math.min(x,x0),x1=Math.max(x,x1),y0=Math.min(y,y0),y1=Math.max(y,y1);return{domain:[[x0,y0],[x1,y1]],animatable:!0}}convert([lon,lat]){const[[x0,y0],[x1,y1]]=this.range,xScale=(x1-x0)/this.bounds.width,yScale=(y1-y0)/this.bounds.height;return[(lonX(lon)-this.bounds.x)*xScale+x0,(latY(lat)-this.bounds.y)*yScale+y0]}invert([x,y]){const[[x0,y0],[x1,y1]]=this.range,xScale=(x1-x0)/this.bounds.width,yScale=(y1-y0)/this.bounds.height;return[xLon((x-x0)/xScale+this.bounds.x),yLat((y-y0)/yScale+this.bounds.y)]}},__name(_a279,"_MercatorScale"),_a279),_a280,_AxisTicks=(_a280=class{constructor(){this.id=createId(this),this.axisGroup=new TranslatableGroup({name:`${this.id}-AxisTicks`,zIndex:2}),this.labelSelection=Selection.select(this.axisGroup,Text),this.interval=new AxisInterval,this.label=new AxisLabel,this.scale=new LinearScale,this.position="bottom",this.translationX=0,this.translationY=0,this.padding=0}attachAxis(axisNode){axisNode.appendChild(this.axisGroup)}calculateLayout(){const boxes=[],tickData=this.generateTicks(),{translationX,translationY}=this;return this.labelSelection.update(tickData.ticks.map(d=>this.createLabelDatum(d)),void 0,datum=>datum.tickId),this.labelSelection.each((node,datum)=>{node.setProperties(datum),datum.visible&&boxes.push(node.getBBox())}),this.axisGroup.setProperties({translationX,translationY}),boxes.length>0?BBox.merge(boxes):void 0}getLabelParams(datum){const{padding}=this,{translate}=datum;switch(this.position){case"top":case"bottom":return{x:translate,y:padding,textAlign:"center",textBaseline:"top"};case"left":case"right":return{x:padding,y:translate,textAlign:"start",textBaseline:"middle"}}}inRange(x,tolerance=.001){const[min,max]=findMinMax(this.scale.range);return x>=min-tolerance&&x<=max+tolerance}createLabelDatum(datum){const{x,y,textBaseline,textAlign}=this.getLabelParams(datum);return{visible:!!datum.tickLabel,tickId:datum.tickId,fill:this.label.color,fontFamily:this.label.fontFamily,fontSize:this.label.fontSize,fontStyle:this.label.fontStyle,fontWeight:this.label.fontWeight,rotation:0,rotationCenterX:0,text:datum.tickLabel,textAlign,textBaseline,x,y}}generateTicks(){const{minSpacing,maxSpacing}=this.interval,{maxTickCount,minTickCount,tickCount}=estimateTickCount(findRangeExtent(this.scale.range),1,minSpacing,maxSpacing,_a280.DefaultTickCount,_a280.DefaultMinSpacing),tickData=this.getTicksData({nice:!0,interval:this.interval.step,tickCount,minTickCount,maxTickCount});if(this.position==="bottom"||this.position==="top"){const measurer2=CachedTextMeasurerPool.getMeasurer({font:this.label}),{domain}=this.scale,direction=domain[0]>domain[1]?-1:1;let lastTickPosition=-1/0*direction;tickData.ticks=tickData.ticks.filter(data=>Math.sign(data.translate-lastTickPosition)!==direction?!1:(lastTickPosition=data.translate+measurer2.textWidth(data.tickLabel,!0)*direction,!0))}return tickData}getTicksData(tickParams){var _a294,_b;const ticks=[],niceDomain=tickParams.nice?this.scale.niceDomain(tickParams):this.scale.domain,rawTicks=this.scale.ticks(tickParams,niceDomain),fractionDigits=rawTicks.reduce((max,tick)=>Math.max(max,countFractionDigits(tick)),0),boundSeries=[],idGenerator=createIdsGenerator(),labelFormatter=this.label.format?this.scale.tickFormatter({domain:niceDomain,ticks:rawTicks,fractionDigits,specifier:this.label.format}):x=>formatValue(x,fractionDigits);for(let index=0;index<rawTicks.length;index++){const tick=rawTicks[index],translate=this.scale.convert(tick);if(!this.inRange(translate))continue;const tickLabel=((_b=(_a294=this.label).formatter)==null?void 0:_b.call(_a294,{value:tick,index,domain:niceDomain,fractionDigits,boundSeries}))??labelFormatter(tick),tickId=idGenerator(tickLabel);ticks.push({tick,tickId,tickLabel,translate})}return{rawTicks,fractionDigits,ticks}}},__name(_a280,"_AxisTicks"),_a280);_AxisTicks.DefaultTickCount=5;_AxisTicks.DefaultMinSpacing=10;var AxisTicks=_AxisTicks;function createButton(options,attrs){const button=createElement("button",getClassName("ag-charts-input ag-charts-button",attrs));return options.label!==void 0?button.append(options.label):(button.append(createIcon(options.icon)),button.ariaLabel=options.altText),button.addEventListener("click",options.onPress),setAttributes(button,attrs),button}__name(createButton,"createButton");function createCheckbox(options,attrs){const checkbox=createElement("input",getClassName("ag-charts-input ag-charts-checkbox",attrs));return checkbox.type="checkbox",checkbox.checked=options.checked,checkbox.addEventListener("change",event=>options.onChange(checkbox.checked,event)),checkbox.addEventListener("keydown",event=>{isButtonClickEvent(event)&&(event.preventDefault(),checkbox.click())}),setAttributes(checkbox,attrs),checkbox}__name(createCheckbox,"createCheckbox");function createSelect(options,attrs){const select=createElement("select",getClassName("ag-charts-input ag-charts-select",attrs));return select.append(...options.options.map(option=>{const optionEl=createElement("option");return optionEl.value=option.value,optionEl.textContent=option.label,optionEl})),setAttribute(select,"data-preventdefault",!1),select.value=options.value,select.addEventListener("change",event=>options.onChange(select.value,event)),setAttributes(select,attrs),select}__name(createSelect,"createSelect");function createTextArea(options,attrs){const textArea=createElement("textarea",getClassName("ag-charts-input ag-charts-textarea",attrs));return textArea.value=options.value,textArea.addEventListener("input",event=>options.onChange(textArea.value,event)),setAttributes(textArea,attrs),setAttribute(textArea,"data-preventdefault",!1),textArea}__name(createTextArea,"createTextArea");function createIcon(icon){const el=createElement("span",`ag-charts-icon ag-charts-icon-${icon}`);return setAttribute(el,"aria-hidden",!0),el}__name(createIcon,"createIcon");function getClassName(baseClass,attrs){return attrs==null?baseClass:`${baseClass} ${attrs.class}`}__name(getClassName,"getClassName");var _a281,SvgPath=(_a281=class extends Path{constructor(d=""){super(),this.x=0,this.y=0,this.commands=[],this._d="",this.d=d}get d(){return this._d}set d(d){if(d!==this._d){this._d=d,this.commands.length=0;for(const[_,command,paramsString]of d.matchAll(/([A-Z])([0-9. ]*)/g)){const params=paramsString.split(/\s+/g).map(Number);this.commands.push([command,params])}this.checkPathDirty()}}updatePath(){const{path,x,y}=this;path.clear();let lastX=x,lastY=y;for(const[command,params]of this.commands)switch(command){case"M":path.moveTo(x+params[0],y+params[1]),lastX=x+params[0];break;case"C":path.cubicCurveTo(x+params[0],y+params[1],x+params[2],y+params[3],x+params[4],y+params[5]),lastX=x+params[4],lastY=y+params[5];break;case"H":path.lineTo(x+params[0],lastY),lastX=y+params[0];break;case"L":path.lineTo(x+params[0],y+params[1]),lastX=x+params[0],lastY=y+params[1];break;case"V":path.lineTo(lastX,y+params[0]),lastY=y+params[0];break;case"Z":path.closePath();break;default:throw new Error(`Could not translate command '${command}' with '${params.join(" ")}'`)}path.closePath()}},__name(_a281,"SvgPath"),_a281);__decorateClass([ScenePathChangeDetection()],SvgPath.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],SvgPath.prototype,"y",2);var _a282,Image=(_a282=class extends Node{constructor(sourceImage){super(),this.sourceImage=sourceImage,this.x=0,this.y=0,this.width=0,this.height=0,this.opacity=1}render(renderCtx){const{ctx}=renderCtx,image=this.sourceImage;image&&(ctx.globalAlpha=this.opacity,ctx.drawImage(image,0,0,image.width,image.height,this.x,this.y,this.width,this.height)),super.render(renderCtx)}},__name(_a282,"Image"),_a282);__decorateClass([SceneChangeDetection()],Image.prototype,"x",2);__decorateClass([SceneChangeDetection()],Image.prototype,"y",2);__decorateClass([SceneChangeDetection()],Image.prototype,"width",2);__decorateClass([SceneChangeDetection()],Image.prototype,"height",2);__decorateClass([SceneChangeDetection()],Image.prototype,"opacity",2);var exports_exports={};__export(exports_exports,{ButtonWidget:__name(()=>ButtonWidget,"ButtonWidget"),NativeWidget:__name(()=>NativeWidget,"NativeWidget"),SliderWidget:__name(()=>SliderWidget,"SliderWidget"),ToolbarWidget:__name(()=>ToolbarWidget,"ToolbarWidget"),WIDGET_HTML_EVENTS:__name(()=>WIDGET_HTML_EVENTS,"WIDGET_HTML_EVENTS"),Widget:__name(()=>Widget,"Widget"),WidgetEventUtil:__name(()=>WidgetEventUtil,"WidgetEventUtil")});var canvasOverlay="canvas-overlay",_a283,Popover=(_a283=class extends BaseModuleInstance{constructor(ctx,id,options){super(),this.ctx=ctx,this.hideFns=[],this.moduleId=`popover-${id}`,options!=null&&options.detached?this.element=createElement("div"):this.element=ctx.domManager.addChild(canvasOverlay,this.moduleId),this.element.setAttribute("role","presentation"),this.destroyFns.push(()=>ctx.domManager.removeChild(canvasOverlay,this.moduleId))}attachTo(popover){this.element.parentElement||popover.element.append(this.element)}hide(opts){const{lastFocus=this.lastFocus}=opts??{};this.element.children.length!==0&&(this.hideFns.forEach(fn=>fn()),lastFocus==null||lastFocus.focus(),this.lastFocus=void 0)}removeChildren(){this.element.replaceChildren()}showWithChildren(children,options){if(!this.element.parentElement)throw new Error("Can not show popover that has not been attached to a parent.");const popover=createElement("div","ag-charts-popover");if(options.ariaLabel!=null&&popover.setAttribute("aria-label",options.ariaLabel),options.class!=null&&popover.classList.add(options.class),popover.replaceChildren(...children),this.element.replaceChildren(popover),this.hideFns.push(()=>this.removeChildren()),options.onHide&&this.hideFns.push(options.onHide),options.initialFocus&&options.sourceEvent){const lastFocus=getLastFocus(options.sourceEvent);lastFocus!==void 0&&(this.lastFocus=lastFocus,this.initialFocus=options.initialFocus)}return popover}getPopoverElement(){return this.element.firstElementChild}updatePosition(position){var _a294;const popover=this.getPopoverElement();popover&&(popover.style.setProperty("right","unset"),popover.style.setProperty("bottom","unset"),position.x!=null&&popover.style.setProperty("left",`${Math.floor(position.x)}px`),position.y!=null&&popover.style.setProperty("top",`${Math.floor(position.y)}px`),(_a294=this.initialFocus)==null||_a294.focus(),this.initialFocus=void 0)}},__name(_a283,"Popover"),_a283),_a284,AnchoredPopover=(_a284=class extends Popover{setAnchor(anchor,fallbackAnchor){this.anchor=anchor,this.fallbackAnchor=fallbackAnchor,this.updatePosition(anchor),this.repositionWithinBounds()}showWithChildren(children,options){const anchor=options.anchor??this.anchor,fallbackAnchor=options.fallbackAnchor??this.fallbackAnchor,popover=super.showWithChildren(children,options);return anchor&&this.setAnchor(anchor,fallbackAnchor),getWindow().requestAnimationFrame(()=>{this.repositionWithinBounds()}),popover}repositionWithinBounds(){const{anchor,ctx,fallbackAnchor}=this,popover=this.getPopoverElement();if(!anchor||!popover)return;const canvasRect=ctx.domManager.getBoundingClientRect(),{offsetWidth:width2,offsetHeight:height2}=popover;let x=clamp(0,anchor.x,canvasRect.width-width2),y=clamp(0,anchor.y,canvasRect.height-height2);x!==anchor.x&&(fallbackAnchor==null?void 0:fallbackAnchor.x)!=null&&(x=clamp(0,fallbackAnchor.x-width2,canvasRect.width-width2)),y!==anchor.y&&(fallbackAnchor==null?void 0:fallbackAnchor.y)!=null&&(y=clamp(0,fallbackAnchor.y-height2,canvasRect.height-height2)),this.updatePosition({x,y})}},__name(_a284,"AnchoredPopover"),_a284),_a285,Menu=(_a285=class extends AnchoredPopover{show(options){const rows=options.items.map(item=>this.createRow(options,item)),popover=this.showWithChildren(rows,options);popover.classList.add("ag-charts-menu"),popover.setAttribute("role","menu"),this.menuCloser=initMenuKeyNav({orientation:"vertical",menu:popover,buttons:rows,sourceEvent:options.sourceEvent,closeCallback:__name(()=>this.hide(),"closeCallback")}),this.hideFns.push(()=>{var _a294;(_a294=this.menuCloser)==null||_a294.finishClosing(),this.menuCloser=void 0})}createRow(options,item){const{menuItemRole="menuitem"}=options,active=item.value===options.value,row=createElement("div","ag-charts-menu__row");if(row.setAttribute("role",menuItemRole),menuItemRole==="menuitemradio"&&row.setAttribute("aria-checked",(options.value===item.value).toString()),typeof item.value=="string"&&(row.dataset.popoverId=item.value),row.classList.toggle("ag-charts-menu__row--active",active),item.icon!=null){const icon=createElement("span",`ag-charts-menu__icon ${getIconClassNames(item.icon)}`);row.appendChild(icon)}const strokeWidthVisible=item.strokeWidth!=null;if(strokeWidthVisible&&(row.classList.toggle("ag-charts-menu__row--stroke-width-visible",strokeWidthVisible),row.style.setProperty("--strokeWidth",strokeWidthVisible?`${item.strokeWidth}px`:null)),item.label!=null){const label=createElement("span","ag-charts-menu__label");label.textContent=this.ctx.localeManager.t(item.label),row.appendChild(label)}"altText"in item&&(row.ariaLabel=this.ctx.localeManager.t(item.altText));const select=__name(()=>{var _a294;(_a294=options.onPress)==null||_a294.call(options,item)},"select"),onclick=__name(e=>{isButtonClickEvent(e)&&(select(),e.preventDefault(),e.stopPropagation())},"onclick");return row.addEventListener("keydown",onclick),row.addEventListener("click",onclick),row.addEventListener("mousemove",()=>{row.focus({preventScroll:!0})}),row}},__name(_a285,"Menu"),_a285),_a286,DraggablePopover=(_a286=class extends Popover{constructor(){super(...arguments),this.dragged=!1}setDragHandle(dragHandle){dragHandle.addListener("drag-start",event=>{dragHandle.addClass(this.dragHandleDraggingClass),this.onDragStart(event)}),dragHandle.addListener("drag-move",this.onDragMove.bind(this)),dragHandle.addListener("drag-end",()=>{dragHandle.removeClass(this.dragHandleDraggingClass),this.onDragEnd.bind(this)})}onDragStart(event){const popover=this.getPopoverElement();popover&&(event.sourceEvent.preventDefault(),this.dragged=!0,this.dragStartState={client:Vec2.from(event.clientX,event.clientY),position:Vec2.from(Number(popover.style.getPropertyValue("left").replace("px","")),Number(popover.style.getPropertyValue("top").replace("px","")))})}onDragMove(event){const{dragStartState}=this,popover=this.getPopoverElement();if(!dragStartState||!popover)return;const offset4=Vec2.sub(Vec2.from(event.clientX,event.clientY),dragStartState.client),position=Vec2.add(dragStartState.position,offset4),bounds=this.ctx.domManager.getBoundingClientRect(),partialPosition={};position.x>=0&&position.x+popover.offsetWidth<=bounds.width&&(partialPosition.x=position.x),position.y>=0&&position.y+popover.offsetHeight<=bounds.height&&(partialPosition.y=position.y),this.updatePosition(partialPosition)}onDragEnd(){this.dragStartState=void 0}},__name(_a286,"DraggablePopover"),_a286),_a287,ToolbarButtonProperties=(_a287=class extends BaseProperties{},__name(_a287,"ToolbarButtonProperties"),_a287);__decorateClass([TempValidate()],ToolbarButtonProperties.prototype,"icon",2);__decorateClass([TempValidate()],ToolbarButtonProperties.prototype,"label",2);__decorateClass([TempValidate()],ToolbarButtonProperties.prototype,"ariaLabel",2);__decorateClass([TempValidate()],ToolbarButtonProperties.prototype,"tooltip",2);var _a288,ToolbarButtonWidget=(_a288=class extends ButtonWidget{constructor(localeManager){super(),this.localeManager=localeManager}update(options){const{localeManager}=this;options.tooltip&&(this.elem.title=localeManager.t(options.tooltip));let innerHTML="";if(options.icon!=null&&(innerHTML=`<span class="${getIconClassNames(options.icon)} ag-charts-toolbar__icon"></span>`),options.label!=null){const label=localeManager.t(options.label);innerHTML=`${innerHTML}<span class="ag-charts-toolbar__label">${label}</span>`}this.elem.innerHTML=innerHTML}setChecked(checked){setAttribute(this.elem,"aria-checked",checked)}},__name(_a288,"ToolbarButtonWidget"),_a288),BUTTON_ACTIVE_CLASS="ag-charts-toolbar__button--active",_a289,BaseToolbar=(_a289=class extends ToolbarWidget{constructor(localeManager,orientation="horizontal"){super(orientation),this.localeManager=localeManager,this.horizontalSpacing=10,this.verticalSpacing=10,this.events=new Listeners,this.hasPrefix=!1,this.buttonWidgets=[],this.addClass("ag-charts-toolbar"),this.toggleClass("ag-charts-toolbar--horizontal",orientation==="horizontal"),this.toggleClass("ag-charts-toolbar--vertical",orientation==="vertical")}addToolbarListener(eventType,handler){return this.events.addListener(eventType,handler)}clearButtons(){for(const button of this.buttonWidgets)button.destroy();this.buttonWidgets.splice(0)}updateButtons(buttons){const{buttonWidgets}=this;for(const[index,button]of buttons.entries())(this.buttonWidgets.at(index)??this.createButton(index,button)).update(button);for(let index=buttons.length;index<buttonWidgets.length;index++){const button=this.buttonWidgets.at(index);button==null||button.destroy()}this.buttonWidgets.splice(buttons.length),this.refreshButtonClasses()}updateButtonByIndex(index,button){var _a294;(_a294=this.buttonWidgets.at(index))==null||_a294.update(button)}clearActiveButton(){for(const button of this.buttonWidgets)button.toggleClass(BUTTON_ACTIVE_CLASS,!1)}toggleActiveButtonByIndex(index){if(index!==-1)for(const[buttonIndex,button]of this.buttonWidgets.entries())button.toggleClass(BUTTON_ACTIVE_CLASS,index!=null&&index===buttonIndex)}toggleButtonEnabledByIndex(index,enabled){var _a294;index!==-1&&((_a294=this.buttonWidgets.at(index))==null||_a294.setEnabled(enabled))}toggleSwitchCheckedByIndex(index,checked){var _a294;index!==-1&&((_a294=this.buttonWidgets.at(index))==null||_a294.setChecked(checked))}getButtonBounds(){return this.buttonWidgets.map(buttonWidget=>this.getButtonWidgetBounds(buttonWidget))}setButtonHiddenByIndex(index,hidden){var _a294;(_a294=this.buttonWidgets.at(index))==null||_a294.setHidden(hidden)}getButtonWidgetBounds(buttonWidget){const parent=this.getBounds(),bounds=buttonWidget.getBounds();return new BBox(bounds.x+parent.x,bounds.y+parent.y,bounds.width,bounds.height)}refreshButtonClasses(){var _a294;const{buttonWidgets,hasPrefix}=this;let first2,last,section;for(const[index,buttonWidget]of buttonWidgets.entries())first2=!hasPrefix&&index===0||section!=buttonWidget.section,last=index===buttonWidgets.length-1||buttonWidget.section!=((_a294=buttonWidgets.at(index+1))==null?void 0:_a294.section),buttonWidget.toggleClass("ag-charts-toolbar__button--first",first2),buttonWidget.toggleClass("ag-charts-toolbar__button--last",last),buttonWidget.toggleClass("ag-charts-toolbar__button--gap",index>0&&first2),section=buttonWidget.section}createButton(index,button){const buttonWidget=this.createButtonWidget();return buttonWidget.addClass("ag-charts-toolbar__button"),buttonWidget.addListener("click",event=>{const buttonOptions={index,...button instanceof BaseProperties?button.toJson():button},buttonBounds=this.getButtonWidgetBounds(buttonWidget);this.events.dispatch("button-pressed",{event,button:buttonOptions,buttonBounds})}),buttonWidget.addListener("focus",()=>{this.events.dispatch("button-focused",{button:{index}})}),button.section&&(buttonWidget.section=button.section),this.buttonWidgets.push(buttonWidget),this.addChild(buttonWidget),buttonWidget}},__name(_a289,"BaseToolbar"),_a289),_a290,Toolbar=(_a290=class extends BaseToolbar{createButtonWidget(){return new ToolbarButtonWidget(this.localeManager)}},__name(_a290,"Toolbar"),_a290),_a291,FloatingToolbarPopover=(_a291=class extends DraggablePopover{constructor(ctx,id,onPopoverMoved){super(ctx,id),this.onPopoverMoved=onPopoverMoved,this.dragHandleDraggingClass="ag-charts-floating-toolbar__drag-handle--dragging"}show(children,options={}){this.showWithChildren(children,{...options,class:"ag-charts-floating-toolbar"})}hide(){this.dragged=!1,super.hide()}getBounds(){const element2=this.getPopoverElement();return new BBox((element2==null?void 0:element2.offsetLeft)??0,(element2==null?void 0:element2.offsetTop)??0,(element2==null?void 0:element2.offsetWidth)??0,(element2==null?void 0:element2.offsetHeight)??0)}hasBeenDragged(){return this.dragged}setAnchor(anchor,horizontalSpacing,verticalSpacing){const element2=this.getPopoverElement();if(!element2)return;const position=anchor.position??"above",{offsetWidth:width2,offsetHeight:height2}=element2;let top=anchor.y-height2-verticalSpacing,left=anchor.x-width2/2;position==="below"?top=anchor.y+verticalSpacing:position==="right"?(top=anchor.y-height2/2,left=anchor.x+horizontalSpacing):position==="above-left"&&(left=anchor.x),this.updatePosition({x:left,y:top})}ignorePointerEvents(){const element2=this.getPopoverElement();element2&&(element2.style.pointerEvents="none")}capturePointerEvents(){const element2=this.getPopoverElement();element2&&(element2.style.pointerEvents="unset")}updatePosition(position){const bounds=this.getBounds(),canvasRect=this.ctx.domManager.getBoundingClientRect();position.x=Math.floor(clamp(0,position.x,canvasRect.width-bounds.width)),position.y=Math.floor(clamp(0,position.y,canvasRect.height-bounds.height)),super.updatePosition(position),this.onPopoverMoved()}},__name(_a291,"FloatingToolbarPopover"),_a291),_a292,FloatingToolbar=(_a292=class extends BaseToolbar{constructor(ctx,id){super(ctx.localeManager),this.hasPrefix=!0,this.popover=new FloatingToolbarPopover(ctx,id,this.onPopoverMoved.bind(this)),this.dragHandle=new DragHandleWidget(ctx.localeManager.t("toolbarAnnotationsDragHandle")),this.popover.setDragHandle(this.dragHandle)}show(options={}){this.popover.show([this.dragHandle.getElement(),this.getElement()],options)}hide(){this.popover.hide()}setAnchor(anchor){this.popover.setAnchor(anchor,this.horizontalSpacing,this.verticalSpacing)}hasBeenDragged(){return this.popover.hasBeenDragged()}ignorePointerEvents(){this.popover.ignorePointerEvents()}capturePointerEvents(){this.popover.capturePointerEvents()}onPopoverMoved(){var _a294;const popoverBounds=this.popover.getBounds();if((_a294=this.popoverBounds)!=null&&_a294.equals(popoverBounds))return;this.popoverBounds=popoverBounds.clone();const buttonBounds=this.getButtonBounds();this.events.dispatch("toolbar-moved",{popoverBounds,buttonBounds})}getButtonWidgetBounds(buttonWidget){const popoverBounds=this.popover.getBounds(),bounds=super.getButtonWidgetBounds(buttonWidget),dragHandleBounds=this.dragHandle.getBounds();return new BBox(bounds.x+popoverBounds.x-dragHandleBounds.width,bounds.y+popoverBounds.y,bounds.width,bounds.height)}},__name(_a292,"FloatingToolbar"),_a292),_a293,DragHandleWidget=(_a293=class extends NativeWidget{constructor(title){super(createElement("div","ag-charts-floating-toolbar__drag-handle"));const icon=new NativeWidget(createElement("span",`${getIconClassNames("drag-handle")} ag-charts-toolbar__icon`));icon.setAriaHidden(!0),this.addChild(icon),this.elem.title=title}},__name(_a293,"DragHandleWidget"),_a293),motion={...fromToMotion_exports,...resetMotion_exports};AgCharts.create.bind(AgCharts),AgCharts.__createSparkline.bind(AgCharts);export{AgCharts as A,time_exports as t};
//# sourceMappingURL=ag-charts-community-CvQJrZXY.js.map
